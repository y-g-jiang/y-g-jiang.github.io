var WO=Object.defineProperty;var HO=(e,t,r)=>t in e?WO(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r;var Xt=(e,t,r)=>HO(e,typeof t!="symbol"?t+"":t,r);(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))n(a);new MutationObserver(a=>{for(const i of a)if(i.type==="childList")for(const o of i.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&n(o)}).observe(document,{childList:!0,subtree:!0});function r(a){const i={};return a.integrity&&(i.integrity=a.integrity),a.referrerPolicy&&(i.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?i.credentials="include":a.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function n(a){if(a.ep)return;a.ep=!0;const i=r(a);fetch(a.href,i)}})();var R0=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function on(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var aj={exports:{}},Sg={},ij={exports:{}},vr={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var u0=Symbol.for("react.element"),VO=Symbol.for("react.portal"),XO=Symbol.for("react.fragment"),KO=Symbol.for("react.strict_mode"),YO=Symbol.for("react.profiler"),qO=Symbol.for("react.provider"),ZO=Symbol.for("react.context"),JO=Symbol.for("react.forward_ref"),QO=Symbol.for("react.suspense"),e6=Symbol.for("react.memo"),t6=Symbol.for("react.lazy"),pw=Symbol.iterator;function r6(e){return e===null||typeof e!="object"?null:(e=pw&&e[pw]||e["@@iterator"],typeof e=="function"?e:null)}var oj={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},sj=Object.assign,lj={};function Uu(e,t,r){this.props=e,this.context=t,this.refs=lj,this.updater=r||oj}Uu.prototype.isReactComponent={};Uu.prototype.setState=function(e,t){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")};Uu.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function cj(){}cj.prototype=Uu.prototype;function H1(e,t,r){this.props=e,this.context=t,this.refs=lj,this.updater=r||oj}var V1=H1.prototype=new cj;V1.constructor=H1;sj(V1,Uu.prototype);V1.isPureReactComponent=!0;var gw=Array.isArray,uj=Object.prototype.hasOwnProperty,X1={current:null},dj={key:!0,ref:!0,__self:!0,__source:!0};function fj(e,t,r){var n,a={},i=null,o=null;if(t!=null)for(n in t.ref!==void 0&&(o=t.ref),t.key!==void 0&&(i=""+t.key),t)uj.call(t,n)&&!dj.hasOwnProperty(n)&&(a[n]=t[n]);var s=arguments.length-2;if(s===1)a.children=r;else if(1<s){for(var l=Array(s),u=0;u<s;u++)l[u]=arguments[u+2];a.children=l}if(e&&e.defaultProps)for(n in s=e.defaultProps,s)a[n]===void 0&&(a[n]=s[n]);return{$$typeof:u0,type:e,key:i,ref:o,props:a,_owner:X1.current}}function n6(e,t){return{$$typeof:u0,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}function K1(e){return typeof e=="object"&&e!==null&&e.$$typeof===u0}function a6(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(r){return t[r]})}var mw=/\/+/g;function Ym(e,t){return typeof e=="object"&&e!==null&&e.key!=null?a6(""+e.key):t.toString(36)}function Ch(e,t,r,n,a){var i=typeof e;(i==="undefined"||i==="boolean")&&(e=null);var o=!1;if(e===null)o=!0;else switch(i){case"string":case"number":o=!0;break;case"object":switch(e.$$typeof){case u0:case VO:o=!0}}if(o)return o=e,a=a(o),e=n===""?"."+Ym(o,0):n,gw(a)?(r="",e!=null&&(r=e.replace(mw,"$&/")+"/"),Ch(a,t,r,"",function(u){return u})):a!=null&&(K1(a)&&(a=n6(a,r+(!a.key||o&&o.key===a.key?"":(""+a.key).replace(mw,"$&/")+"/")+e)),t.push(a)),1;if(o=0,n=n===""?".":n+":",gw(e))for(var s=0;s<e.length;s++){i=e[s];var l=n+Ym(i,s);o+=Ch(i,t,r,l,a)}else if(l=r6(e),typeof l=="function")for(e=l.call(e),s=0;!(i=e.next()).done;)i=i.value,l=n+Ym(i,s++),o+=Ch(i,t,r,l,a);else if(i==="object")throw t=String(e),Error("Objects are not valid as a React child (found: "+(t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return o}function B0(e,t,r){if(e==null)return e;var n=[],a=0;return Ch(e,n,"","",function(i){return t.call(r,i,a++)}),n}function i6(e){if(e._status===-1){var t=e._result;t=t(),t.then(function(r){(e._status===0||e._status===-1)&&(e._status=1,e._result=r)},function(r){(e._status===0||e._status===-1)&&(e._status=2,e._result=r)}),e._status===-1&&(e._status=0,e._result=t)}if(e._status===1)return e._result.default;throw e._result}var qa={current:null},Mh={transition:null},o6={ReactCurrentDispatcher:qa,ReactCurrentBatchConfig:Mh,ReactCurrentOwner:X1};function hj(){throw Error("act(...) is not supported in production builds of React.")}vr.Children={map:B0,forEach:function(e,t,r){B0(e,function(){t.apply(this,arguments)},r)},count:function(e){var t=0;return B0(e,function(){t++}),t},toArray:function(e){return B0(e,function(t){return t})||[]},only:function(e){if(!K1(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};vr.Component=Uu;vr.Fragment=XO;vr.Profiler=YO;vr.PureComponent=H1;vr.StrictMode=KO;vr.Suspense=QO;vr.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=o6;vr.act=hj;vr.cloneElement=function(e,t,r){if(e==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var n=sj({},e.props),a=e.key,i=e.ref,o=e._owner;if(t!=null){if(t.ref!==void 0&&(i=t.ref,o=X1.current),t.key!==void 0&&(a=""+t.key),e.type&&e.type.defaultProps)var s=e.type.defaultProps;for(l in t)uj.call(t,l)&&!dj.hasOwnProperty(l)&&(n[l]=t[l]===void 0&&s!==void 0?s[l]:t[l])}var l=arguments.length-2;if(l===1)n.children=r;else if(1<l){s=Array(l);for(var u=0;u<l;u++)s[u]=arguments[u+2];n.children=s}return{$$typeof:u0,type:e.type,key:a,ref:i,props:n,_owner:o}};vr.createContext=function(e){return e={$$typeof:ZO,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},e.Provider={$$typeof:qO,_context:e},e.Consumer=e};vr.createElement=fj;vr.createFactory=function(e){var t=fj.bind(null,e);return t.type=e,t};vr.createRef=function(){return{current:null}};vr.forwardRef=function(e){return{$$typeof:JO,render:e}};vr.isValidElement=K1;vr.lazy=function(e){return{$$typeof:t6,_payload:{_status:-1,_result:e},_init:i6}};vr.memo=function(e,t){return{$$typeof:e6,type:e,compare:t===void 0?null:t}};vr.startTransition=function(e){var t=Mh.transition;Mh.transition={};try{e()}finally{Mh.transition=t}};vr.unstable_act=hj;vr.useCallback=function(e,t){return qa.current.useCallback(e,t)};vr.useContext=function(e){return qa.current.useContext(e)};vr.useDebugValue=function(){};vr.useDeferredValue=function(e){return qa.current.useDeferredValue(e)};vr.useEffect=function(e,t){return qa.current.useEffect(e,t)};vr.useId=function(){return qa.current.useId()};vr.useImperativeHandle=function(e,t,r){return qa.current.useImperativeHandle(e,t,r)};vr.useInsertionEffect=function(e,t){return qa.current.useInsertionEffect(e,t)};vr.useLayoutEffect=function(e,t){return qa.current.useLayoutEffect(e,t)};vr.useMemo=function(e,t){return qa.current.useMemo(e,t)};vr.useReducer=function(e,t,r){return qa.current.useReducer(e,t,r)};vr.useRef=function(e){return qa.current.useRef(e)};vr.useState=function(e){return qa.current.useState(e)};vr.useSyncExternalStore=function(e,t,r){return qa.current.useSyncExternalStore(e,t,r)};vr.useTransition=function(){return qa.current.useTransition()};vr.version="18.3.1";ij.exports=vr;var _=ij.exports;const oe=on(_);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var s6=_,l6=Symbol.for("react.element"),c6=Symbol.for("react.fragment"),u6=Object.prototype.hasOwnProperty,d6=s6.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,f6={key:!0,ref:!0,__self:!0,__source:!0};function pj(e,t,r){var n,a={},i=null,o=null;r!==void 0&&(i=""+r),t.key!==void 0&&(i=""+t.key),t.ref!==void 0&&(o=t.ref);for(n in t)u6.call(t,n)&&!f6.hasOwnProperty(n)&&(a[n]=t[n]);if(e&&e.defaultProps)for(n in t=e.defaultProps,t)a[n]===void 0&&(a[n]=t[n]);return{$$typeof:l6,type:e,key:i,ref:o,props:a,_owner:d6.current}}Sg.Fragment=c6;Sg.jsx=pj;Sg.jsxs=pj;aj.exports=Sg;var c=aj.exports,fx={},gj={exports:{}},ki={},mj={exports:{}},yj={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(e){function t(U,V){var J=U.length;U.push(V);e:for(;0<J;){var K=J-1>>>1,Q=U[K];if(0<a(Q,V))U[K]=V,U[J]=Q,J=K;else break e}}function r(U){return U.length===0?null:U[0]}function n(U){if(U.length===0)return null;var V=U[0],J=U.pop();if(J!==V){U[0]=J;e:for(var K=0,Q=U.length,te=Q>>>1;K<te;){var ee=2*(K+1)-1,me=U[ee],re=ee+1,De=U[re];if(0>a(me,J))re<Q&&0>a(De,me)?(U[K]=De,U[re]=J,K=re):(U[K]=me,U[ee]=J,K=ee);else if(re<Q&&0>a(De,J))U[K]=De,U[re]=J,K=re;else break e}}return V}function a(U,V){var J=U.sortIndex-V.sortIndex;return J!==0?J:U.id-V.id}if(typeof performance=="object"&&typeof performance.now=="function"){var i=performance;e.unstable_now=function(){return i.now()}}else{var o=Date,s=o.now();e.unstable_now=function(){return o.now()-s}}var l=[],u=[],d=1,f=null,h=3,g=!1,b=!1,w=!1,v=typeof setTimeout=="function"?setTimeout:null,x=typeof clearTimeout=="function"?clearTimeout:null,m=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function k(U){for(var V=r(u);V!==null;){if(V.callback===null)n(u);else if(V.startTime<=U)n(u),V.sortIndex=V.expirationTime,t(l,V);else break;V=r(u)}}function P(U){if(w=!1,k(U),!b)if(r(l)!==null)b=!0,$(j);else{var V=r(u);V!==null&&L(P,V.startTime-U)}}function j(U,V){b=!1,w&&(w=!1,x(O),O=-1),g=!0;var J=h;try{for(k(V),f=r(l);f!==null&&(!(f.expirationTime>V)||U&&!D());){var K=f.callback;if(typeof K=="function"){f.callback=null,h=f.priorityLevel;var Q=K(f.expirationTime<=V);V=e.unstable_now(),typeof Q=="function"?f.callback=Q:f===r(l)&&n(l),k(V)}else n(l);f=r(l)}if(f!==null)var te=!0;else{var ee=r(u);ee!==null&&L(P,ee.startTime-V),te=!1}return te}finally{f=null,h=J,g=!1}}var S=!1,M=null,O=-1,E=5,I=-1;function D(){return!(e.unstable_now()-I<E)}function B(){if(M!==null){var U=e.unstable_now();I=U;var V=!0;try{V=M(!0,U)}finally{V?z():(S=!1,M=null)}}else S=!1}var z;if(typeof m=="function")z=function(){m(B)};else if(typeof MessageChannel<"u"){var Y=new MessageChannel,G=Y.port2;Y.port1.onmessage=B,z=function(){G.postMessage(null)}}else z=function(){v(B,0)};function $(U){M=U,S||(S=!0,z())}function L(U,V){O=v(function(){U(e.unstable_now())},V)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(U){U.callback=null},e.unstable_continueExecution=function(){b||g||(b=!0,$(j))},e.unstable_forceFrameRate=function(U){0>U||125<U?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):E=0<U?Math.floor(1e3/U):5},e.unstable_getCurrentPriorityLevel=function(){return h},e.unstable_getFirstCallbackNode=function(){return r(l)},e.unstable_next=function(U){switch(h){case 1:case 2:case 3:var V=3;break;default:V=h}var J=h;h=V;try{return U()}finally{h=J}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(U,V){switch(U){case 1:case 2:case 3:case 4:case 5:break;default:U=3}var J=h;h=U;try{return V()}finally{h=J}},e.unstable_scheduleCallback=function(U,V,J){var K=e.unstable_now();switch(typeof J=="object"&&J!==null?(J=J.delay,J=typeof J=="number"&&0<J?K+J:K):J=K,U){case 1:var Q=-1;break;case 2:Q=250;break;case 5:Q=1073741823;break;case 4:Q=1e4;break;default:Q=5e3}return Q=J+Q,U={id:d++,callback:V,priorityLevel:U,startTime:J,expirationTime:Q,sortIndex:-1},J>K?(U.sortIndex=J,t(u,U),r(l)===null&&U===r(u)&&(w?(x(O),O=-1):w=!0,L(P,J-K))):(U.sortIndex=Q,t(l,U),b||g||(b=!0,$(j))),U},e.unstable_shouldYield=D,e.unstable_wrapCallback=function(U){var V=h;return function(){var J=h;h=V;try{return U.apply(this,arguments)}finally{h=J}}}})(yj);mj.exports=yj;var h6=mj.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var p6=_,wi=h6;function Re(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,r=1;r<arguments.length;r++)t+="&args[]="+encodeURIComponent(arguments[r]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var xj=new Set,cf={};function pc(e,t){ou(e,t),ou(e+"Capture",t)}function ou(e,t){for(cf[e]=t,e=0;e<t.length;e++)xj.add(t[e])}var ls=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),hx=Object.prototype.hasOwnProperty,g6=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,yw={},xw={};function m6(e){return hx.call(xw,e)?!0:hx.call(yw,e)?!1:g6.test(e)?xw[e]=!0:(yw[e]=!0,!1)}function y6(e,t,r,n){if(r!==null&&r.type===0)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return n?!1:r!==null?!r.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function x6(e,t,r,n){if(t===null||typeof t>"u"||y6(e,t,r,n))return!0;if(n)return!1;if(r!==null)switch(r.type){case 3:return!t;case 4:return t===!1;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}function Za(e,t,r,n,a,i,o){this.acceptsBooleans=t===2||t===3||t===4,this.attributeName=n,this.attributeNamespace=a,this.mustUseProperty=r,this.propertyName=e,this.type=t,this.sanitizeURL=i,this.removeEmptyString=o}var ja={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){ja[e]=new Za(e,0,!1,e,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];ja[t]=new Za(t,1,!1,e[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(e){ja[e]=new Za(e,2,!1,e.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){ja[e]=new Za(e,2,!1,e,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){ja[e]=new Za(e,3,!1,e.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(e){ja[e]=new Za(e,3,!0,e,null,!1,!1)});["capture","download"].forEach(function(e){ja[e]=new Za(e,4,!1,e,null,!1,!1)});["cols","rows","size","span"].forEach(function(e){ja[e]=new Za(e,6,!1,e,null,!1,!1)});["rowSpan","start"].forEach(function(e){ja[e]=new Za(e,5,!1,e.toLowerCase(),null,!1,!1)});var Y1=/[\-:]([a-z])/g;function q1(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(Y1,q1);ja[t]=new Za(t,1,!1,e,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(Y1,q1);ja[t]=new Za(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(Y1,q1);ja[t]=new Za(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(e){ja[e]=new Za(e,1,!1,e.toLowerCase(),null,!1,!1)});ja.xlinkHref=new Za("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(e){ja[e]=new Za(e,1,!1,e.toLowerCase(),null,!0,!0)});function Z1(e,t,r,n){var a=ja.hasOwnProperty(t)?ja[t]:null;(a!==null?a.type!==0:n||!(2<t.length)||t[0]!=="o"&&t[0]!=="O"||t[1]!=="n"&&t[1]!=="N")&&(x6(t,r,a,n)&&(r=null),n||a===null?m6(t)&&(r===null?e.removeAttribute(t):e.setAttribute(t,""+r)):a.mustUseProperty?e[a.propertyName]=r===null?a.type===3?!1:"":r:(t=a.attributeName,n=a.attributeNamespace,r===null?e.removeAttribute(t):(a=a.type,r=a===3||a===4&&r===!0?"":""+r,n?e.setAttributeNS(n,t,r):e.setAttribute(t,r))))}var gs=p6.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,L0=Symbol.for("react.element"),$c=Symbol.for("react.portal"),Dc=Symbol.for("react.fragment"),J1=Symbol.for("react.strict_mode"),px=Symbol.for("react.profiler"),vj=Symbol.for("react.provider"),bj=Symbol.for("react.context"),Q1=Symbol.for("react.forward_ref"),gx=Symbol.for("react.suspense"),mx=Symbol.for("react.suspense_list"),eb=Symbol.for("react.memo"),Ns=Symbol.for("react.lazy"),wj=Symbol.for("react.offscreen"),vw=Symbol.iterator;function xd(e){return e===null||typeof e!="object"?null:(e=vw&&e[vw]||e["@@iterator"],typeof e=="function"?e:null)}var Mn=Object.assign,qm;function Ld(e){if(qm===void 0)try{throw Error()}catch(r){var t=r.stack.trim().match(/\n( *(at )?)/);qm=t&&t[1]||""}return`
`+qm+e}var Zm=!1;function Jm(e,t){if(!e||Zm)return"";Zm=!0;var r=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(t,[])}catch(u){var n=u}Reflect.construct(e,[],t)}else{try{t.call()}catch(u){n=u}e.call(t.prototype)}else{try{throw Error()}catch(u){n=u}e()}}catch(u){if(u&&n&&typeof u.stack=="string"){for(var a=u.stack.split(`
`),i=n.stack.split(`
`),o=a.length-1,s=i.length-1;1<=o&&0<=s&&a[o]!==i[s];)s--;for(;1<=o&&0<=s;o--,s--)if(a[o]!==i[s]){if(o!==1||s!==1)do if(o--,s--,0>s||a[o]!==i[s]){var l=`
`+a[o].replace(" at new "," at ");return e.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",e.displayName)),l}while(1<=o&&0<=s);break}}}finally{Zm=!1,Error.prepareStackTrace=r}return(e=e?e.displayName||e.name:"")?Ld(e):""}function v6(e){switch(e.tag){case 5:return Ld(e.type);case 16:return Ld("Lazy");case 13:return Ld("Suspense");case 19:return Ld("SuspenseList");case 0:case 2:case 15:return e=Jm(e.type,!1),e;case 11:return e=Jm(e.type.render,!1),e;case 1:return e=Jm(e.type,!0),e;default:return""}}function yx(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case Dc:return"Fragment";case $c:return"Portal";case px:return"Profiler";case J1:return"StrictMode";case gx:return"Suspense";case mx:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case bj:return(e.displayName||"Context")+".Consumer";case vj:return(e._context.displayName||"Context")+".Provider";case Q1:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case eb:return t=e.displayName||null,t!==null?t:yx(e.type)||"Memo";case Ns:t=e._payload,e=e._init;try{return yx(e(t))}catch{}}return null}function b6(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=t.render,e=e.displayName||e.name||"",t.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return yx(t);case 8:return t===J1?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t}return null}function nl(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function kj(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function w6(e){var t=kj(e)?"checked":"value",r=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),n=""+e[t];if(!e.hasOwnProperty(t)&&typeof r<"u"&&typeof r.get=="function"&&typeof r.set=="function"){var a=r.get,i=r.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return a.call(this)},set:function(o){n=""+o,i.call(this,o)}}),Object.defineProperty(e,t,{enumerable:r.enumerable}),{getValue:function(){return n},setValue:function(o){n=""+o},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function F0(e){e._valueTracker||(e._valueTracker=w6(e))}function Sj(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var r=t.getValue(),n="";return e&&(n=kj(e)?e.checked?"true":"false":e.value),e=n,e!==r?(t.setValue(e),!0):!1}function zh(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function xx(e,t){var r=t.checked;return Mn({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:r??e._wrapperState.initialChecked})}function bw(e,t){var r=t.defaultValue==null?"":t.defaultValue,n=t.checked!=null?t.checked:t.defaultChecked;r=nl(t.value!=null?t.value:r),e._wrapperState={initialChecked:n,initialValue:r,controlled:t.type==="checkbox"||t.type==="radio"?t.checked!=null:t.value!=null}}function jj(e,t){t=t.checked,t!=null&&Z1(e,"checked",t,!1)}function vx(e,t){jj(e,t);var r=nl(t.value),n=t.type;if(r!=null)n==="number"?(r===0&&e.value===""||e.value!=r)&&(e.value=""+r):e.value!==""+r&&(e.value=""+r);else if(n==="submit"||n==="reset"){e.removeAttribute("value");return}t.hasOwnProperty("value")?bx(e,t.type,r):t.hasOwnProperty("defaultValue")&&bx(e,t.type,nl(t.defaultValue)),t.checked==null&&t.defaultChecked!=null&&(e.defaultChecked=!!t.defaultChecked)}function ww(e,t,r){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var n=t.type;if(!(n!=="submit"&&n!=="reset"||t.value!==void 0&&t.value!==null))return;t=""+e._wrapperState.initialValue,r||t===e.value||(e.value=t),e.defaultValue=t}r=e.name,r!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,r!==""&&(e.name=r)}function bx(e,t,r){(t!=="number"||zh(e.ownerDocument)!==e)&&(r==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+r&&(e.defaultValue=""+r))}var Fd=Array.isArray;function qc(e,t,r,n){if(e=e.options,t){t={};for(var a=0;a<r.length;a++)t["$"+r[a]]=!0;for(r=0;r<e.length;r++)a=t.hasOwnProperty("$"+e[r].value),e[r].selected!==a&&(e[r].selected=a),a&&n&&(e[r].defaultSelected=!0)}else{for(r=""+nl(r),t=null,a=0;a<e.length;a++){if(e[a].value===r){e[a].selected=!0,n&&(e[a].defaultSelected=!0);return}t!==null||e[a].disabled||(t=e[a])}t!==null&&(t.selected=!0)}}function wx(e,t){if(t.dangerouslySetInnerHTML!=null)throw Error(Re(91));return Mn({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function kw(e,t){var r=t.value;if(r==null){if(r=t.children,t=t.defaultValue,r!=null){if(t!=null)throw Error(Re(92));if(Fd(r)){if(1<r.length)throw Error(Re(93));r=r[0]}t=r}t==null&&(t=""),r=t}e._wrapperState={initialValue:nl(r)}}function Pj(e,t){var r=nl(t.value),n=nl(t.defaultValue);r!=null&&(r=""+r,r!==e.value&&(e.value=r),t.defaultValue==null&&e.defaultValue!==r&&(e.defaultValue=r)),n!=null&&(e.defaultValue=""+n)}function Sw(e){var t=e.textContent;t===e._wrapperState.initialValue&&t!==""&&t!==null&&(e.value=t)}function _j(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function kx(e,t){return e==null||e==="http://www.w3.org/1999/xhtml"?_j(t):e==="http://www.w3.org/2000/svg"&&t==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var G0,Cj=function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(t,r,n,a){MSApp.execUnsafeLocalFunction(function(){return e(t,r,n,a)})}:e}(function(e,t){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=t;else{for(G0=G0||document.createElement("div"),G0.innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=G0.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}});function uf(e,t){if(t){var r=e.firstChild;if(r&&r===e.lastChild&&r.nodeType===3){r.nodeValue=t;return}}e.textContent=t}var Wd={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},k6=["Webkit","ms","Moz","O"];Object.keys(Wd).forEach(function(e){k6.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),Wd[t]=Wd[e]})});function Mj(e,t,r){return t==null||typeof t=="boolean"||t===""?"":r||typeof t!="number"||t===0||Wd.hasOwnProperty(e)&&Wd[e]?(""+t).trim():t+"px"}function Nj(e,t){e=e.style;for(var r in t)if(t.hasOwnProperty(r)){var n=r.indexOf("--")===0,a=Mj(r,t[r],n);r==="float"&&(r="cssFloat"),n?e.setProperty(r,a):e[r]=a}}var S6=Mn({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Sx(e,t){if(t){if(S6[e]&&(t.children!=null||t.dangerouslySetInnerHTML!=null))throw Error(Re(137,e));if(t.dangerouslySetInnerHTML!=null){if(t.children!=null)throw Error(Re(60));if(typeof t.dangerouslySetInnerHTML!="object"||!("__html"in t.dangerouslySetInnerHTML))throw Error(Re(61))}if(t.style!=null&&typeof t.style!="object")throw Error(Re(62))}}function jx(e,t){if(e.indexOf("-")===-1)return typeof t.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Px=null;function tb(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var _x=null,Zc=null,Jc=null;function jw(e){if(e=h0(e)){if(typeof _x!="function")throw Error(Re(280));var t=e.stateNode;t&&(t=Mg(t),_x(e.stateNode,e.type,t))}}function Oj(e){Zc?Jc?Jc.push(e):Jc=[e]:Zc=e}function Aj(){if(Zc){var e=Zc,t=Jc;if(Jc=Zc=null,jw(e),t)for(e=0;e<t.length;e++)jw(t[e])}}function Tj(e,t){return e(t)}function Ej(){}var Qm=!1;function Ij(e,t,r){if(Qm)return e(t,r);Qm=!0;try{return Tj(e,t,r)}finally{Qm=!1,(Zc!==null||Jc!==null)&&(Ej(),Aj())}}function df(e,t){var r=e.stateNode;if(r===null)return null;var n=Mg(r);if(n===null)return null;r=n[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(n=!n.disabled)||(e=e.type,n=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!n;break e;default:e=!1}if(e)return null;if(r&&typeof r!="function")throw Error(Re(231,t,typeof r));return r}var Cx=!1;if(ls)try{var vd={};Object.defineProperty(vd,"passive",{get:function(){Cx=!0}}),window.addEventListener("test",vd,vd),window.removeEventListener("test",vd,vd)}catch{Cx=!1}function j6(e,t,r,n,a,i,o,s,l){var u=Array.prototype.slice.call(arguments,3);try{t.apply(r,u)}catch(d){this.onError(d)}}var Hd=!1,Wh=null,Hh=!1,Mx=null,P6={onError:function(e){Hd=!0,Wh=e}};function _6(e,t,r,n,a,i,o,s,l){Hd=!1,Wh=null,j6.apply(P6,arguments)}function C6(e,t,r,n,a,i,o,s,l){if(_6.apply(this,arguments),Hd){if(Hd){var u=Wh;Hd=!1,Wh=null}else throw Error(Re(198));Hh||(Hh=!0,Mx=u)}}function gc(e){var t=e,r=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,t.flags&4098&&(r=t.return),e=t.return;while(e)}return t.tag===3?r:null}function $j(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function Pw(e){if(gc(e)!==e)throw Error(Re(188))}function M6(e){var t=e.alternate;if(!t){if(t=gc(e),t===null)throw Error(Re(188));return t!==e?null:e}for(var r=e,n=t;;){var a=r.return;if(a===null)break;var i=a.alternate;if(i===null){if(n=a.return,n!==null){r=n;continue}break}if(a.child===i.child){for(i=a.child;i;){if(i===r)return Pw(a),e;if(i===n)return Pw(a),t;i=i.sibling}throw Error(Re(188))}if(r.return!==n.return)r=a,n=i;else{for(var o=!1,s=a.child;s;){if(s===r){o=!0,r=a,n=i;break}if(s===n){o=!0,n=a,r=i;break}s=s.sibling}if(!o){for(s=i.child;s;){if(s===r){o=!0,r=i,n=a;break}if(s===n){o=!0,n=i,r=a;break}s=s.sibling}if(!o)throw Error(Re(189))}}if(r.alternate!==n)throw Error(Re(190))}if(r.tag!==3)throw Error(Re(188));return r.stateNode.current===r?e:t}function Dj(e){return e=M6(e),e!==null?Rj(e):null}function Rj(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var t=Rj(e);if(t!==null)return t;e=e.sibling}return null}var Bj=wi.unstable_scheduleCallback,_w=wi.unstable_cancelCallback,N6=wi.unstable_shouldYield,O6=wi.unstable_requestPaint,In=wi.unstable_now,A6=wi.unstable_getCurrentPriorityLevel,rb=wi.unstable_ImmediatePriority,Lj=wi.unstable_UserBlockingPriority,Vh=wi.unstable_NormalPriority,T6=wi.unstable_LowPriority,Fj=wi.unstable_IdlePriority,jg=null,No=null;function E6(e){if(No&&typeof No.onCommitFiberRoot=="function")try{No.onCommitFiberRoot(jg,e,void 0,(e.current.flags&128)===128)}catch{}}var lo=Math.clz32?Math.clz32:D6,I6=Math.log,$6=Math.LN2;function D6(e){return e>>>=0,e===0?32:31-(I6(e)/$6|0)|0}var U0=64,z0=4194304;function Gd(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function Xh(e,t){var r=e.pendingLanes;if(r===0)return 0;var n=0,a=e.suspendedLanes,i=e.pingedLanes,o=r&268435455;if(o!==0){var s=o&~a;s!==0?n=Gd(s):(i&=o,i!==0&&(n=Gd(i)))}else o=r&~a,o!==0?n=Gd(o):i!==0&&(n=Gd(i));if(n===0)return 0;if(t!==0&&t!==n&&!(t&a)&&(a=n&-n,i=t&-t,a>=i||a===16&&(i&4194240)!==0))return t;if(n&4&&(n|=r&16),t=e.entangledLanes,t!==0)for(e=e.entanglements,t&=n;0<t;)r=31-lo(t),a=1<<r,n|=e[r],t&=~a;return n}function R6(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function B6(e,t){for(var r=e.suspendedLanes,n=e.pingedLanes,a=e.expirationTimes,i=e.pendingLanes;0<i;){var o=31-lo(i),s=1<<o,l=a[o];l===-1?(!(s&r)||s&n)&&(a[o]=R6(s,t)):l<=t&&(e.expiredLanes|=s),i&=~s}}function Nx(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function Gj(){var e=U0;return U0<<=1,!(U0&4194240)&&(U0=64),e}function ey(e){for(var t=[],r=0;31>r;r++)t.push(e);return t}function d0(e,t,r){e.pendingLanes|=t,t!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,t=31-lo(t),e[t]=r}function L6(e,t){var r=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var n=e.eventTimes;for(e=e.expirationTimes;0<r;){var a=31-lo(r),i=1<<a;t[a]=0,n[a]=-1,e[a]=-1,r&=~i}}function nb(e,t){var r=e.entangledLanes|=t;for(e=e.entanglements;r;){var n=31-lo(r),a=1<<n;a&t|e[n]&t&&(e[n]|=t),r&=~a}}var Qr=0;function Uj(e){return e&=-e,1<e?4<e?e&268435455?16:536870912:4:1}var zj,ab,Wj,Hj,Vj,Ox=!1,W0=[],Vs=null,Xs=null,Ks=null,ff=new Map,hf=new Map,Es=[],F6="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Cw(e,t){switch(e){case"focusin":case"focusout":Vs=null;break;case"dragenter":case"dragleave":Xs=null;break;case"mouseover":case"mouseout":Ks=null;break;case"pointerover":case"pointerout":ff.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":hf.delete(t.pointerId)}}function bd(e,t,r,n,a,i){return e===null||e.nativeEvent!==i?(e={blockedOn:t,domEventName:r,eventSystemFlags:n,nativeEvent:i,targetContainers:[a]},t!==null&&(t=h0(t),t!==null&&ab(t)),e):(e.eventSystemFlags|=n,t=e.targetContainers,a!==null&&t.indexOf(a)===-1&&t.push(a),e)}function G6(e,t,r,n,a){switch(t){case"focusin":return Vs=bd(Vs,e,t,r,n,a),!0;case"dragenter":return Xs=bd(Xs,e,t,r,n,a),!0;case"mouseover":return Ks=bd(Ks,e,t,r,n,a),!0;case"pointerover":var i=a.pointerId;return ff.set(i,bd(ff.get(i)||null,e,t,r,n,a)),!0;case"gotpointercapture":return i=a.pointerId,hf.set(i,bd(hf.get(i)||null,e,t,r,n,a)),!0}return!1}function Xj(e){var t=Tl(e.target);if(t!==null){var r=gc(t);if(r!==null){if(t=r.tag,t===13){if(t=$j(r),t!==null){e.blockedOn=t,Vj(e.priority,function(){Wj(r)});return}}else if(t===3&&r.stateNode.current.memoizedState.isDehydrated){e.blockedOn=r.tag===3?r.stateNode.containerInfo:null;return}}}e.blockedOn=null}function Nh(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var r=Ax(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(r===null){r=e.nativeEvent;var n=new r.constructor(r.type,r);Px=n,r.target.dispatchEvent(n),Px=null}else return t=h0(r),t!==null&&ab(t),e.blockedOn=r,!1;t.shift()}return!0}function Mw(e,t,r){Nh(e)&&r.delete(t)}function U6(){Ox=!1,Vs!==null&&Nh(Vs)&&(Vs=null),Xs!==null&&Nh(Xs)&&(Xs=null),Ks!==null&&Nh(Ks)&&(Ks=null),ff.forEach(Mw),hf.forEach(Mw)}function wd(e,t){e.blockedOn===t&&(e.blockedOn=null,Ox||(Ox=!0,wi.unstable_scheduleCallback(wi.unstable_NormalPriority,U6)))}function pf(e){function t(a){return wd(a,e)}if(0<W0.length){wd(W0[0],e);for(var r=1;r<W0.length;r++){var n=W0[r];n.blockedOn===e&&(n.blockedOn=null)}}for(Vs!==null&&wd(Vs,e),Xs!==null&&wd(Xs,e),Ks!==null&&wd(Ks,e),ff.forEach(t),hf.forEach(t),r=0;r<Es.length;r++)n=Es[r],n.blockedOn===e&&(n.blockedOn=null);for(;0<Es.length&&(r=Es[0],r.blockedOn===null);)Xj(r),r.blockedOn===null&&Es.shift()}var Qc=gs.ReactCurrentBatchConfig,Kh=!0;function z6(e,t,r,n){var a=Qr,i=Qc.transition;Qc.transition=null;try{Qr=1,ib(e,t,r,n)}finally{Qr=a,Qc.transition=i}}function W6(e,t,r,n){var a=Qr,i=Qc.transition;Qc.transition=null;try{Qr=4,ib(e,t,r,n)}finally{Qr=a,Qc.transition=i}}function ib(e,t,r,n){if(Kh){var a=Ax(e,t,r,n);if(a===null)uy(e,t,n,Yh,r),Cw(e,n);else if(G6(a,e,t,r,n))n.stopPropagation();else if(Cw(e,n),t&4&&-1<F6.indexOf(e)){for(;a!==null;){var i=h0(a);if(i!==null&&zj(i),i=Ax(e,t,r,n),i===null&&uy(e,t,n,Yh,r),i===a)break;a=i}a!==null&&n.stopPropagation()}else uy(e,t,n,null,r)}}var Yh=null;function Ax(e,t,r,n){if(Yh=null,e=tb(n),e=Tl(e),e!==null)if(t=gc(e),t===null)e=null;else if(r=t.tag,r===13){if(e=$j(t),e!==null)return e;e=null}else if(r===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return Yh=e,null}function Kj(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(A6()){case rb:return 1;case Lj:return 4;case Vh:case T6:return 16;case Fj:return 536870912;default:return 16}default:return 16}}var Ds=null,ob=null,Oh=null;function Yj(){if(Oh)return Oh;var e,t=ob,r=t.length,n,a="value"in Ds?Ds.value:Ds.textContent,i=a.length;for(e=0;e<r&&t[e]===a[e];e++);var o=r-e;for(n=1;n<=o&&t[r-n]===a[i-n];n++);return Oh=a.slice(e,1<n?1-n:void 0)}function Ah(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function H0(){return!0}function Nw(){return!1}function Si(e){function t(r,n,a,i,o){this._reactName=r,this._targetInst=a,this.type=n,this.nativeEvent=i,this.target=o,this.currentTarget=null;for(var s in e)e.hasOwnProperty(s)&&(r=e[s],this[s]=r?r(i):i[s]);return this.isDefaultPrevented=(i.defaultPrevented!=null?i.defaultPrevented:i.returnValue===!1)?H0:Nw,this.isPropagationStopped=Nw,this}return Mn(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var r=this.nativeEvent;r&&(r.preventDefault?r.preventDefault():typeof r.returnValue!="unknown"&&(r.returnValue=!1),this.isDefaultPrevented=H0)},stopPropagation:function(){var r=this.nativeEvent;r&&(r.stopPropagation?r.stopPropagation():typeof r.cancelBubble!="unknown"&&(r.cancelBubble=!0),this.isPropagationStopped=H0)},persist:function(){},isPersistent:H0}),t}var zu={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},sb=Si(zu),f0=Mn({},zu,{view:0,detail:0}),H6=Si(f0),ty,ry,kd,Pg=Mn({},f0,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:lb,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==kd&&(kd&&e.type==="mousemove"?(ty=e.screenX-kd.screenX,ry=e.screenY-kd.screenY):ry=ty=0,kd=e),ty)},movementY:function(e){return"movementY"in e?e.movementY:ry}}),Ow=Si(Pg),V6=Mn({},Pg,{dataTransfer:0}),X6=Si(V6),K6=Mn({},f0,{relatedTarget:0}),ny=Si(K6),Y6=Mn({},zu,{animationName:0,elapsedTime:0,pseudoElement:0}),q6=Si(Y6),Z6=Mn({},zu,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),J6=Si(Z6),Q6=Mn({},zu,{data:0}),Aw=Si(Q6),eA={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},tA={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},rA={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function nA(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=rA[e])?!!t[e]:!1}function lb(){return nA}var aA=Mn({},f0,{key:function(e){if(e.key){var t=eA[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=Ah(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?tA[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:lb,charCode:function(e){return e.type==="keypress"?Ah(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?Ah(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),iA=Si(aA),oA=Mn({},Pg,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Tw=Si(oA),sA=Mn({},f0,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:lb}),lA=Si(sA),cA=Mn({},zu,{propertyName:0,elapsedTime:0,pseudoElement:0}),uA=Si(cA),dA=Mn({},Pg,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),fA=Si(dA),hA=[9,13,27,32],cb=ls&&"CompositionEvent"in window,Vd=null;ls&&"documentMode"in document&&(Vd=document.documentMode);var pA=ls&&"TextEvent"in window&&!Vd,qj=ls&&(!cb||Vd&&8<Vd&&11>=Vd),Ew=" ",Iw=!1;function Zj(e,t){switch(e){case"keyup":return hA.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Jj(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var Rc=!1;function gA(e,t){switch(e){case"compositionend":return Jj(t);case"keypress":return t.which!==32?null:(Iw=!0,Ew);case"textInput":return e=t.data,e===Ew&&Iw?null:e;default:return null}}function mA(e,t){if(Rc)return e==="compositionend"||!cb&&Zj(e,t)?(e=Yj(),Oh=ob=Ds=null,Rc=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return qj&&t.locale!=="ko"?null:t.data;default:return null}}var yA={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function $w(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!yA[e.type]:t==="textarea"}function Qj(e,t,r,n){Oj(n),t=qh(t,"onChange"),0<t.length&&(r=new sb("onChange","change",null,r,n),e.push({event:r,listeners:t}))}var Xd=null,gf=null;function xA(e){uP(e,0)}function _g(e){var t=Fc(e);if(Sj(t))return e}function vA(e,t){if(e==="change")return t}var eP=!1;if(ls){var ay;if(ls){var iy="oninput"in document;if(!iy){var Dw=document.createElement("div");Dw.setAttribute("oninput","return;"),iy=typeof Dw.oninput=="function"}ay=iy}else ay=!1;eP=ay&&(!document.documentMode||9<document.documentMode)}function Rw(){Xd&&(Xd.detachEvent("onpropertychange",tP),gf=Xd=null)}function tP(e){if(e.propertyName==="value"&&_g(gf)){var t=[];Qj(t,gf,e,tb(e)),Ij(xA,t)}}function bA(e,t,r){e==="focusin"?(Rw(),Xd=t,gf=r,Xd.attachEvent("onpropertychange",tP)):e==="focusout"&&Rw()}function wA(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return _g(gf)}function kA(e,t){if(e==="click")return _g(t)}function SA(e,t){if(e==="input"||e==="change")return _g(t)}function jA(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var uo=typeof Object.is=="function"?Object.is:jA;function mf(e,t){if(uo(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var r=Object.keys(e),n=Object.keys(t);if(r.length!==n.length)return!1;for(n=0;n<r.length;n++){var a=r[n];if(!hx.call(t,a)||!uo(e[a],t[a]))return!1}return!0}function Bw(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function Lw(e,t){var r=Bw(e);e=0;for(var n;r;){if(r.nodeType===3){if(n=e+r.textContent.length,e<=t&&n>=t)return{node:r,offset:t-e};e=n}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=Bw(r)}}function rP(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?rP(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function nP(){for(var e=window,t=zh();t instanceof e.HTMLIFrameElement;){try{var r=typeof t.contentWindow.location.href=="string"}catch{r=!1}if(r)e=t.contentWindow;else break;t=zh(e.document)}return t}function ub(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}function PA(e){var t=nP(),r=e.focusedElem,n=e.selectionRange;if(t!==r&&r&&r.ownerDocument&&rP(r.ownerDocument.documentElement,r)){if(n!==null&&ub(r)){if(t=n.start,e=n.end,e===void 0&&(e=t),"selectionStart"in r)r.selectionStart=t,r.selectionEnd=Math.min(e,r.value.length);else if(e=(t=r.ownerDocument||document)&&t.defaultView||window,e.getSelection){e=e.getSelection();var a=r.textContent.length,i=Math.min(n.start,a);n=n.end===void 0?i:Math.min(n.end,a),!e.extend&&i>n&&(a=n,n=i,i=a),a=Lw(r,i);var o=Lw(r,n);a&&o&&(e.rangeCount!==1||e.anchorNode!==a.node||e.anchorOffset!==a.offset||e.focusNode!==o.node||e.focusOffset!==o.offset)&&(t=t.createRange(),t.setStart(a.node,a.offset),e.removeAllRanges(),i>n?(e.addRange(t),e.extend(o.node,o.offset)):(t.setEnd(o.node,o.offset),e.addRange(t)))}}for(t=[],e=r;e=e.parentNode;)e.nodeType===1&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof r.focus=="function"&&r.focus(),r=0;r<t.length;r++)e=t[r],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var _A=ls&&"documentMode"in document&&11>=document.documentMode,Bc=null,Tx=null,Kd=null,Ex=!1;function Fw(e,t,r){var n=r.window===r?r.document:r.nodeType===9?r:r.ownerDocument;Ex||Bc==null||Bc!==zh(n)||(n=Bc,"selectionStart"in n&&ub(n)?n={start:n.selectionStart,end:n.selectionEnd}:(n=(n.ownerDocument&&n.ownerDocument.defaultView||window).getSelection(),n={anchorNode:n.anchorNode,anchorOffset:n.anchorOffset,focusNode:n.focusNode,focusOffset:n.focusOffset}),Kd&&mf(Kd,n)||(Kd=n,n=qh(Tx,"onSelect"),0<n.length&&(t=new sb("onSelect","select",null,t,r),e.push({event:t,listeners:n}),t.target=Bc)))}function V0(e,t){var r={};return r[e.toLowerCase()]=t.toLowerCase(),r["Webkit"+e]="webkit"+t,r["Moz"+e]="moz"+t,r}var Lc={animationend:V0("Animation","AnimationEnd"),animationiteration:V0("Animation","AnimationIteration"),animationstart:V0("Animation","AnimationStart"),transitionend:V0("Transition","TransitionEnd")},oy={},aP={};ls&&(aP=document.createElement("div").style,"AnimationEvent"in window||(delete Lc.animationend.animation,delete Lc.animationiteration.animation,delete Lc.animationstart.animation),"TransitionEvent"in window||delete Lc.transitionend.transition);function Cg(e){if(oy[e])return oy[e];if(!Lc[e])return e;var t=Lc[e],r;for(r in t)if(t.hasOwnProperty(r)&&r in aP)return oy[e]=t[r];return e}var iP=Cg("animationend"),oP=Cg("animationiteration"),sP=Cg("animationstart"),lP=Cg("transitionend"),cP=new Map,Gw="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function il(e,t){cP.set(e,t),pc(t,[e])}for(var sy=0;sy<Gw.length;sy++){var ly=Gw[sy],CA=ly.toLowerCase(),MA=ly[0].toUpperCase()+ly.slice(1);il(CA,"on"+MA)}il(iP,"onAnimationEnd");il(oP,"onAnimationIteration");il(sP,"onAnimationStart");il("dblclick","onDoubleClick");il("focusin","onFocus");il("focusout","onBlur");il(lP,"onTransitionEnd");ou("onMouseEnter",["mouseout","mouseover"]);ou("onMouseLeave",["mouseout","mouseover"]);ou("onPointerEnter",["pointerout","pointerover"]);ou("onPointerLeave",["pointerout","pointerover"]);pc("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));pc("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));pc("onBeforeInput",["compositionend","keypress","textInput","paste"]);pc("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));pc("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));pc("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Ud="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),NA=new Set("cancel close invalid load scroll toggle".split(" ").concat(Ud));function Uw(e,t,r){var n=e.type||"unknown-event";e.currentTarget=r,C6(n,t,void 0,e),e.currentTarget=null}function uP(e,t){t=(t&4)!==0;for(var r=0;r<e.length;r++){var n=e[r],a=n.event;n=n.listeners;e:{var i=void 0;if(t)for(var o=n.length-1;0<=o;o--){var s=n[o],l=s.instance,u=s.currentTarget;if(s=s.listener,l!==i&&a.isPropagationStopped())break e;Uw(a,s,u),i=l}else for(o=0;o<n.length;o++){if(s=n[o],l=s.instance,u=s.currentTarget,s=s.listener,l!==i&&a.isPropagationStopped())break e;Uw(a,s,u),i=l}}}if(Hh)throw e=Mx,Hh=!1,Mx=null,e}function fn(e,t){var r=t[Bx];r===void 0&&(r=t[Bx]=new Set);var n=e+"__bubble";r.has(n)||(dP(t,e,2,!1),r.add(n))}function cy(e,t,r){var n=0;t&&(n|=4),dP(r,e,n,t)}var X0="_reactListening"+Math.random().toString(36).slice(2);function yf(e){if(!e[X0]){e[X0]=!0,xj.forEach(function(r){r!=="selectionchange"&&(NA.has(r)||cy(r,!1,e),cy(r,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[X0]||(t[X0]=!0,cy("selectionchange",!1,t))}}function dP(e,t,r,n){switch(Kj(t)){case 1:var a=z6;break;case 4:a=W6;break;default:a=ib}r=a.bind(null,t,r,e),a=void 0,!Cx||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(a=!0),n?a!==void 0?e.addEventListener(t,r,{capture:!0,passive:a}):e.addEventListener(t,r,!0):a!==void 0?e.addEventListener(t,r,{passive:a}):e.addEventListener(t,r,!1)}function uy(e,t,r,n,a){var i=n;if(!(t&1)&&!(t&2)&&n!==null)e:for(;;){if(n===null)return;var o=n.tag;if(o===3||o===4){var s=n.stateNode.containerInfo;if(s===a||s.nodeType===8&&s.parentNode===a)break;if(o===4)for(o=n.return;o!==null;){var l=o.tag;if((l===3||l===4)&&(l=o.stateNode.containerInfo,l===a||l.nodeType===8&&l.parentNode===a))return;o=o.return}for(;s!==null;){if(o=Tl(s),o===null)return;if(l=o.tag,l===5||l===6){n=i=o;continue e}s=s.parentNode}}n=n.return}Ij(function(){var u=i,d=tb(r),f=[];e:{var h=cP.get(e);if(h!==void 0){var g=sb,b=e;switch(e){case"keypress":if(Ah(r)===0)break e;case"keydown":case"keyup":g=iA;break;case"focusin":b="focus",g=ny;break;case"focusout":b="blur",g=ny;break;case"beforeblur":case"afterblur":g=ny;break;case"click":if(r.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":g=Ow;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":g=X6;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":g=lA;break;case iP:case oP:case sP:g=q6;break;case lP:g=uA;break;case"scroll":g=H6;break;case"wheel":g=fA;break;case"copy":case"cut":case"paste":g=J6;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":g=Tw}var w=(t&4)!==0,v=!w&&e==="scroll",x=w?h!==null?h+"Capture":null:h;w=[];for(var m=u,k;m!==null;){k=m;var P=k.stateNode;if(k.tag===5&&P!==null&&(k=P,x!==null&&(P=df(m,x),P!=null&&w.push(xf(m,P,k)))),v)break;m=m.return}0<w.length&&(h=new g(h,b,null,r,d),f.push({event:h,listeners:w}))}}if(!(t&7)){e:{if(h=e==="mouseover"||e==="pointerover",g=e==="mouseout"||e==="pointerout",h&&r!==Px&&(b=r.relatedTarget||r.fromElement)&&(Tl(b)||b[cs]))break e;if((g||h)&&(h=d.window===d?d:(h=d.ownerDocument)?h.defaultView||h.parentWindow:window,g?(b=r.relatedTarget||r.toElement,g=u,b=b?Tl(b):null,b!==null&&(v=gc(b),b!==v||b.tag!==5&&b.tag!==6)&&(b=null)):(g=null,b=u),g!==b)){if(w=Ow,P="onMouseLeave",x="onMouseEnter",m="mouse",(e==="pointerout"||e==="pointerover")&&(w=Tw,P="onPointerLeave",x="onPointerEnter",m="pointer"),v=g==null?h:Fc(g),k=b==null?h:Fc(b),h=new w(P,m+"leave",g,r,d),h.target=v,h.relatedTarget=k,P=null,Tl(d)===u&&(w=new w(x,m+"enter",b,r,d),w.target=k,w.relatedTarget=v,P=w),v=P,g&&b)t:{for(w=g,x=b,m=0,k=w;k;k=Mc(k))m++;for(k=0,P=x;P;P=Mc(P))k++;for(;0<m-k;)w=Mc(w),m--;for(;0<k-m;)x=Mc(x),k--;for(;m--;){if(w===x||x!==null&&w===x.alternate)break t;w=Mc(w),x=Mc(x)}w=null}else w=null;g!==null&&zw(f,h,g,w,!1),b!==null&&v!==null&&zw(f,v,b,w,!0)}}e:{if(h=u?Fc(u):window,g=h.nodeName&&h.nodeName.toLowerCase(),g==="select"||g==="input"&&h.type==="file")var j=vA;else if($w(h))if(eP)j=SA;else{j=wA;var S=bA}else(g=h.nodeName)&&g.toLowerCase()==="input"&&(h.type==="checkbox"||h.type==="radio")&&(j=kA);if(j&&(j=j(e,u))){Qj(f,j,r,d);break e}S&&S(e,h,u),e==="focusout"&&(S=h._wrapperState)&&S.controlled&&h.type==="number"&&bx(h,"number",h.value)}switch(S=u?Fc(u):window,e){case"focusin":($w(S)||S.contentEditable==="true")&&(Bc=S,Tx=u,Kd=null);break;case"focusout":Kd=Tx=Bc=null;break;case"mousedown":Ex=!0;break;case"contextmenu":case"mouseup":case"dragend":Ex=!1,Fw(f,r,d);break;case"selectionchange":if(_A)break;case"keydown":case"keyup":Fw(f,r,d)}var M;if(cb)e:{switch(e){case"compositionstart":var O="onCompositionStart";break e;case"compositionend":O="onCompositionEnd";break e;case"compositionupdate":O="onCompositionUpdate";break e}O=void 0}else Rc?Zj(e,r)&&(O="onCompositionEnd"):e==="keydown"&&r.keyCode===229&&(O="onCompositionStart");O&&(qj&&r.locale!=="ko"&&(Rc||O!=="onCompositionStart"?O==="onCompositionEnd"&&Rc&&(M=Yj()):(Ds=d,ob="value"in Ds?Ds.value:Ds.textContent,Rc=!0)),S=qh(u,O),0<S.length&&(O=new Aw(O,e,null,r,d),f.push({event:O,listeners:S}),M?O.data=M:(M=Jj(r),M!==null&&(O.data=M)))),(M=pA?gA(e,r):mA(e,r))&&(u=qh(u,"onBeforeInput"),0<u.length&&(d=new Aw("onBeforeInput","beforeinput",null,r,d),f.push({event:d,listeners:u}),d.data=M))}uP(f,t)})}function xf(e,t,r){return{instance:e,listener:t,currentTarget:r}}function qh(e,t){for(var r=t+"Capture",n=[];e!==null;){var a=e,i=a.stateNode;a.tag===5&&i!==null&&(a=i,i=df(e,r),i!=null&&n.unshift(xf(e,i,a)),i=df(e,t),i!=null&&n.push(xf(e,i,a))),e=e.return}return n}function Mc(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function zw(e,t,r,n,a){for(var i=t._reactName,o=[];r!==null&&r!==n;){var s=r,l=s.alternate,u=s.stateNode;if(l!==null&&l===n)break;s.tag===5&&u!==null&&(s=u,a?(l=df(r,i),l!=null&&o.unshift(xf(r,l,s))):a||(l=df(r,i),l!=null&&o.push(xf(r,l,s)))),r=r.return}o.length!==0&&e.push({event:t,listeners:o})}var OA=/\r\n?/g,AA=/\u0000|\uFFFD/g;function Ww(e){return(typeof e=="string"?e:""+e).replace(OA,`
`).replace(AA,"")}function K0(e,t,r){if(t=Ww(t),Ww(e)!==t&&r)throw Error(Re(425))}function Zh(){}var Ix=null,$x=null;function Dx(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var Rx=typeof setTimeout=="function"?setTimeout:void 0,TA=typeof clearTimeout=="function"?clearTimeout:void 0,Hw=typeof Promise=="function"?Promise:void 0,EA=typeof queueMicrotask=="function"?queueMicrotask:typeof Hw<"u"?function(e){return Hw.resolve(null).then(e).catch(IA)}:Rx;function IA(e){setTimeout(function(){throw e})}function dy(e,t){var r=t,n=0;do{var a=r.nextSibling;if(e.removeChild(r),a&&a.nodeType===8)if(r=a.data,r==="/$"){if(n===0){e.removeChild(a),pf(t);return}n--}else r!=="$"&&r!=="$?"&&r!=="$!"||n++;r=a}while(r);pf(t)}function Ys(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?")break;if(t==="/$")return null}}return e}function Vw(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="$"||r==="$!"||r==="$?"){if(t===0)return e;t--}else r==="/$"&&t++}e=e.previousSibling}return null}var Wu=Math.random().toString(36).slice(2),Po="__reactFiber$"+Wu,vf="__reactProps$"+Wu,cs="__reactContainer$"+Wu,Bx="__reactEvents$"+Wu,$A="__reactListeners$"+Wu,DA="__reactHandles$"+Wu;function Tl(e){var t=e[Po];if(t)return t;for(var r=e.parentNode;r;){if(t=r[cs]||r[Po]){if(r=t.alternate,t.child!==null||r!==null&&r.child!==null)for(e=Vw(e);e!==null;){if(r=e[Po])return r;e=Vw(e)}return t}e=r,r=e.parentNode}return null}function h0(e){return e=e[Po]||e[cs],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function Fc(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(Re(33))}function Mg(e){return e[vf]||null}var Lx=[],Gc=-1;function ol(e){return{current:e}}function gn(e){0>Gc||(e.current=Lx[Gc],Lx[Gc]=null,Gc--)}function un(e,t){Gc++,Lx[Gc]=e.current,e.current=t}var al={},$a=ol(al),ii=ol(!1),ql=al;function su(e,t){var r=e.type.contextTypes;if(!r)return al;var n=e.stateNode;if(n&&n.__reactInternalMemoizedUnmaskedChildContext===t)return n.__reactInternalMemoizedMaskedChildContext;var a={},i;for(i in r)a[i]=t[i];return n&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=a),a}function oi(e){return e=e.childContextTypes,e!=null}function Jh(){gn(ii),gn($a)}function Xw(e,t,r){if($a.current!==al)throw Error(Re(168));un($a,t),un(ii,r)}function fP(e,t,r){var n=e.stateNode;if(t=t.childContextTypes,typeof n.getChildContext!="function")return r;n=n.getChildContext();for(var a in n)if(!(a in t))throw Error(Re(108,b6(e)||"Unknown",a));return Mn({},r,n)}function Qh(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||al,ql=$a.current,un($a,e),un(ii,ii.current),!0}function Kw(e,t,r){var n=e.stateNode;if(!n)throw Error(Re(169));r?(e=fP(e,t,ql),n.__reactInternalMemoizedMergedChildContext=e,gn(ii),gn($a),un($a,e)):gn(ii),un(ii,r)}var Jo=null,Ng=!1,fy=!1;function hP(e){Jo===null?Jo=[e]:Jo.push(e)}function RA(e){Ng=!0,hP(e)}function sl(){if(!fy&&Jo!==null){fy=!0;var e=0,t=Qr;try{var r=Jo;for(Qr=1;e<r.length;e++){var n=r[e];do n=n(!0);while(n!==null)}Jo=null,Ng=!1}catch(a){throw Jo!==null&&(Jo=Jo.slice(e+1)),Bj(rb,sl),a}finally{Qr=t,fy=!1}}return null}var Uc=[],zc=0,ep=null,tp=0,Ai=[],Ti=0,Zl=null,Qo=1,es="";function Cl(e,t){Uc[zc++]=tp,Uc[zc++]=ep,ep=e,tp=t}function pP(e,t,r){Ai[Ti++]=Qo,Ai[Ti++]=es,Ai[Ti++]=Zl,Zl=e;var n=Qo;e=es;var a=32-lo(n)-1;n&=~(1<<a),r+=1;var i=32-lo(t)+a;if(30<i){var o=a-a%5;i=(n&(1<<o)-1).toString(32),n>>=o,a-=o,Qo=1<<32-lo(t)+a|r<<a|n,es=i+e}else Qo=1<<i|r<<a|n,es=e}function db(e){e.return!==null&&(Cl(e,1),pP(e,1,0))}function fb(e){for(;e===ep;)ep=Uc[--zc],Uc[zc]=null,tp=Uc[--zc],Uc[zc]=null;for(;e===Zl;)Zl=Ai[--Ti],Ai[Ti]=null,es=Ai[--Ti],Ai[Ti]=null,Qo=Ai[--Ti],Ai[Ti]=null}var bi=null,vi=null,bn=!1,no=null;function gP(e,t){var r=Ei(5,null,null,0);r.elementType="DELETED",r.stateNode=t,r.return=e,t=e.deletions,t===null?(e.deletions=[r],e.flags|=16):t.push(r)}function Yw(e,t){switch(e.tag){case 5:var r=e.type;return t=t.nodeType!==1||r.toLowerCase()!==t.nodeName.toLowerCase()?null:t,t!==null?(e.stateNode=t,bi=e,vi=Ys(t.firstChild),!0):!1;case 6:return t=e.pendingProps===""||t.nodeType!==3?null:t,t!==null?(e.stateNode=t,bi=e,vi=null,!0):!1;case 13:return t=t.nodeType!==8?null:t,t!==null?(r=Zl!==null?{id:Qo,overflow:es}:null,e.memoizedState={dehydrated:t,treeContext:r,retryLane:1073741824},r=Ei(18,null,null,0),r.stateNode=t,r.return=e,e.child=r,bi=e,vi=null,!0):!1;default:return!1}}function Fx(e){return(e.mode&1)!==0&&(e.flags&128)===0}function Gx(e){if(bn){var t=vi;if(t){var r=t;if(!Yw(e,t)){if(Fx(e))throw Error(Re(418));t=Ys(r.nextSibling);var n=bi;t&&Yw(e,t)?gP(n,r):(e.flags=e.flags&-4097|2,bn=!1,bi=e)}}else{if(Fx(e))throw Error(Re(418));e.flags=e.flags&-4097|2,bn=!1,bi=e}}}function qw(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;bi=e}function Y0(e){if(e!==bi)return!1;if(!bn)return qw(e),bn=!0,!1;var t;if((t=e.tag!==3)&&!(t=e.tag!==5)&&(t=e.type,t=t!=="head"&&t!=="body"&&!Dx(e.type,e.memoizedProps)),t&&(t=vi)){if(Fx(e))throw mP(),Error(Re(418));for(;t;)gP(e,t),t=Ys(t.nextSibling)}if(qw(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(Re(317));e:{for(e=e.nextSibling,t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="/$"){if(t===0){vi=Ys(e.nextSibling);break e}t--}else r!=="$"&&r!=="$!"&&r!=="$?"||t++}e=e.nextSibling}vi=null}}else vi=bi?Ys(e.stateNode.nextSibling):null;return!0}function mP(){for(var e=vi;e;)e=Ys(e.nextSibling)}function lu(){vi=bi=null,bn=!1}function hb(e){no===null?no=[e]:no.push(e)}var BA=gs.ReactCurrentBatchConfig;function Sd(e,t,r){if(e=r.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(r._owner){if(r=r._owner,r){if(r.tag!==1)throw Error(Re(309));var n=r.stateNode}if(!n)throw Error(Re(147,e));var a=n,i=""+e;return t!==null&&t.ref!==null&&typeof t.ref=="function"&&t.ref._stringRef===i?t.ref:(t=function(o){var s=a.refs;o===null?delete s[i]:s[i]=o},t._stringRef=i,t)}if(typeof e!="string")throw Error(Re(284));if(!r._owner)throw Error(Re(290,e))}return e}function q0(e,t){throw e=Object.prototype.toString.call(t),Error(Re(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function Zw(e){var t=e._init;return t(e._payload)}function yP(e){function t(x,m){if(e){var k=x.deletions;k===null?(x.deletions=[m],x.flags|=16):k.push(m)}}function r(x,m){if(!e)return null;for(;m!==null;)t(x,m),m=m.sibling;return null}function n(x,m){for(x=new Map;m!==null;)m.key!==null?x.set(m.key,m):x.set(m.index,m),m=m.sibling;return x}function a(x,m){return x=Qs(x,m),x.index=0,x.sibling=null,x}function i(x,m,k){return x.index=k,e?(k=x.alternate,k!==null?(k=k.index,k<m?(x.flags|=2,m):k):(x.flags|=2,m)):(x.flags|=1048576,m)}function o(x){return e&&x.alternate===null&&(x.flags|=2),x}function s(x,m,k,P){return m===null||m.tag!==6?(m=vy(k,x.mode,P),m.return=x,m):(m=a(m,k),m.return=x,m)}function l(x,m,k,P){var j=k.type;return j===Dc?d(x,m,k.props.children,P,k.key):m!==null&&(m.elementType===j||typeof j=="object"&&j!==null&&j.$$typeof===Ns&&Zw(j)===m.type)?(P=a(m,k.props),P.ref=Sd(x,m,k),P.return=x,P):(P=Bh(k.type,k.key,k.props,null,x.mode,P),P.ref=Sd(x,m,k),P.return=x,P)}function u(x,m,k,P){return m===null||m.tag!==4||m.stateNode.containerInfo!==k.containerInfo||m.stateNode.implementation!==k.implementation?(m=by(k,x.mode,P),m.return=x,m):(m=a(m,k.children||[]),m.return=x,m)}function d(x,m,k,P,j){return m===null||m.tag!==7?(m=Hl(k,x.mode,P,j),m.return=x,m):(m=a(m,k),m.return=x,m)}function f(x,m,k){if(typeof m=="string"&&m!==""||typeof m=="number")return m=vy(""+m,x.mode,k),m.return=x,m;if(typeof m=="object"&&m!==null){switch(m.$$typeof){case L0:return k=Bh(m.type,m.key,m.props,null,x.mode,k),k.ref=Sd(x,null,m),k.return=x,k;case $c:return m=by(m,x.mode,k),m.return=x,m;case Ns:var P=m._init;return f(x,P(m._payload),k)}if(Fd(m)||xd(m))return m=Hl(m,x.mode,k,null),m.return=x,m;q0(x,m)}return null}function h(x,m,k,P){var j=m!==null?m.key:null;if(typeof k=="string"&&k!==""||typeof k=="number")return j!==null?null:s(x,m,""+k,P);if(typeof k=="object"&&k!==null){switch(k.$$typeof){case L0:return k.key===j?l(x,m,k,P):null;case $c:return k.key===j?u(x,m,k,P):null;case Ns:return j=k._init,h(x,m,j(k._payload),P)}if(Fd(k)||xd(k))return j!==null?null:d(x,m,k,P,null);q0(x,k)}return null}function g(x,m,k,P,j){if(typeof P=="string"&&P!==""||typeof P=="number")return x=x.get(k)||null,s(m,x,""+P,j);if(typeof P=="object"&&P!==null){switch(P.$$typeof){case L0:return x=x.get(P.key===null?k:P.key)||null,l(m,x,P,j);case $c:return x=x.get(P.key===null?k:P.key)||null,u(m,x,P,j);case Ns:var S=P._init;return g(x,m,k,S(P._payload),j)}if(Fd(P)||xd(P))return x=x.get(k)||null,d(m,x,P,j,null);q0(m,P)}return null}function b(x,m,k,P){for(var j=null,S=null,M=m,O=m=0,E=null;M!==null&&O<k.length;O++){M.index>O?(E=M,M=null):E=M.sibling;var I=h(x,M,k[O],P);if(I===null){M===null&&(M=E);break}e&&M&&I.alternate===null&&t(x,M),m=i(I,m,O),S===null?j=I:S.sibling=I,S=I,M=E}if(O===k.length)return r(x,M),bn&&Cl(x,O),j;if(M===null){for(;O<k.length;O++)M=f(x,k[O],P),M!==null&&(m=i(M,m,O),S===null?j=M:S.sibling=M,S=M);return bn&&Cl(x,O),j}for(M=n(x,M);O<k.length;O++)E=g(M,x,O,k[O],P),E!==null&&(e&&E.alternate!==null&&M.delete(E.key===null?O:E.key),m=i(E,m,O),S===null?j=E:S.sibling=E,S=E);return e&&M.forEach(function(D){return t(x,D)}),bn&&Cl(x,O),j}function w(x,m,k,P){var j=xd(k);if(typeof j!="function")throw Error(Re(150));if(k=j.call(k),k==null)throw Error(Re(151));for(var S=j=null,M=m,O=m=0,E=null,I=k.next();M!==null&&!I.done;O++,I=k.next()){M.index>O?(E=M,M=null):E=M.sibling;var D=h(x,M,I.value,P);if(D===null){M===null&&(M=E);break}e&&M&&D.alternate===null&&t(x,M),m=i(D,m,O),S===null?j=D:S.sibling=D,S=D,M=E}if(I.done)return r(x,M),bn&&Cl(x,O),j;if(M===null){for(;!I.done;O++,I=k.next())I=f(x,I.value,P),I!==null&&(m=i(I,m,O),S===null?j=I:S.sibling=I,S=I);return bn&&Cl(x,O),j}for(M=n(x,M);!I.done;O++,I=k.next())I=g(M,x,O,I.value,P),I!==null&&(e&&I.alternate!==null&&M.delete(I.key===null?O:I.key),m=i(I,m,O),S===null?j=I:S.sibling=I,S=I);return e&&M.forEach(function(B){return t(x,B)}),bn&&Cl(x,O),j}function v(x,m,k,P){if(typeof k=="object"&&k!==null&&k.type===Dc&&k.key===null&&(k=k.props.children),typeof k=="object"&&k!==null){switch(k.$$typeof){case L0:e:{for(var j=k.key,S=m;S!==null;){if(S.key===j){if(j=k.type,j===Dc){if(S.tag===7){r(x,S.sibling),m=a(S,k.props.children),m.return=x,x=m;break e}}else if(S.elementType===j||typeof j=="object"&&j!==null&&j.$$typeof===Ns&&Zw(j)===S.type){r(x,S.sibling),m=a(S,k.props),m.ref=Sd(x,S,k),m.return=x,x=m;break e}r(x,S);break}else t(x,S);S=S.sibling}k.type===Dc?(m=Hl(k.props.children,x.mode,P,k.key),m.return=x,x=m):(P=Bh(k.type,k.key,k.props,null,x.mode,P),P.ref=Sd(x,m,k),P.return=x,x=P)}return o(x);case $c:e:{for(S=k.key;m!==null;){if(m.key===S)if(m.tag===4&&m.stateNode.containerInfo===k.containerInfo&&m.stateNode.implementation===k.implementation){r(x,m.sibling),m=a(m,k.children||[]),m.return=x,x=m;break e}else{r(x,m);break}else t(x,m);m=m.sibling}m=by(k,x.mode,P),m.return=x,x=m}return o(x);case Ns:return S=k._init,v(x,m,S(k._payload),P)}if(Fd(k))return b(x,m,k,P);if(xd(k))return w(x,m,k,P);q0(x,k)}return typeof k=="string"&&k!==""||typeof k=="number"?(k=""+k,m!==null&&m.tag===6?(r(x,m.sibling),m=a(m,k),m.return=x,x=m):(r(x,m),m=vy(k,x.mode,P),m.return=x,x=m),o(x)):r(x,m)}return v}var cu=yP(!0),xP=yP(!1),rp=ol(null),np=null,Wc=null,pb=null;function gb(){pb=Wc=np=null}function mb(e){var t=rp.current;gn(rp),e._currentValue=t}function Ux(e,t,r){for(;e!==null;){var n=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,n!==null&&(n.childLanes|=t)):n!==null&&(n.childLanes&t)!==t&&(n.childLanes|=t),e===r)break;e=e.return}}function eu(e,t){np=e,pb=Wc=null,e=e.dependencies,e!==null&&e.firstContext!==null&&(e.lanes&t&&(ni=!0),e.firstContext=null)}function Bi(e){var t=e._currentValue;if(pb!==e)if(e={context:e,memoizedValue:t,next:null},Wc===null){if(np===null)throw Error(Re(308));Wc=e,np.dependencies={lanes:0,firstContext:e}}else Wc=Wc.next=e;return t}var El=null;function yb(e){El===null?El=[e]:El.push(e)}function vP(e,t,r,n){var a=t.interleaved;return a===null?(r.next=r,yb(t)):(r.next=a.next,a.next=r),t.interleaved=r,us(e,n)}function us(e,t){e.lanes|=t;var r=e.alternate;for(r!==null&&(r.lanes|=t),r=e,e=e.return;e!==null;)e.childLanes|=t,r=e.alternate,r!==null&&(r.childLanes|=t),r=e,e=e.return;return r.tag===3?r.stateNode:null}var Os=!1;function xb(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function bP(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function as(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function qs(e,t,r){var n=e.updateQueue;if(n===null)return null;if(n=n.shared,Dr&2){var a=n.pending;return a===null?t.next=t:(t.next=a.next,a.next=t),n.pending=t,us(e,r)}return a=n.interleaved,a===null?(t.next=t,yb(n)):(t.next=a.next,a.next=t),n.interleaved=t,us(e,r)}function Th(e,t,r){if(t=t.updateQueue,t!==null&&(t=t.shared,(r&4194240)!==0)){var n=t.lanes;n&=e.pendingLanes,r|=n,t.lanes=r,nb(e,r)}}function Jw(e,t){var r=e.updateQueue,n=e.alternate;if(n!==null&&(n=n.updateQueue,r===n)){var a=null,i=null;if(r=r.firstBaseUpdate,r!==null){do{var o={eventTime:r.eventTime,lane:r.lane,tag:r.tag,payload:r.payload,callback:r.callback,next:null};i===null?a=i=o:i=i.next=o,r=r.next}while(r!==null);i===null?a=i=t:i=i.next=t}else a=i=t;r={baseState:n.baseState,firstBaseUpdate:a,lastBaseUpdate:i,shared:n.shared,effects:n.effects},e.updateQueue=r;return}e=r.lastBaseUpdate,e===null?r.firstBaseUpdate=t:e.next=t,r.lastBaseUpdate=t}function ap(e,t,r,n){var a=e.updateQueue;Os=!1;var i=a.firstBaseUpdate,o=a.lastBaseUpdate,s=a.shared.pending;if(s!==null){a.shared.pending=null;var l=s,u=l.next;l.next=null,o===null?i=u:o.next=u,o=l;var d=e.alternate;d!==null&&(d=d.updateQueue,s=d.lastBaseUpdate,s!==o&&(s===null?d.firstBaseUpdate=u:s.next=u,d.lastBaseUpdate=l))}if(i!==null){var f=a.baseState;o=0,d=u=l=null,s=i;do{var h=s.lane,g=s.eventTime;if((n&h)===h){d!==null&&(d=d.next={eventTime:g,lane:0,tag:s.tag,payload:s.payload,callback:s.callback,next:null});e:{var b=e,w=s;switch(h=t,g=r,w.tag){case 1:if(b=w.payload,typeof b=="function"){f=b.call(g,f,h);break e}f=b;break e;case 3:b.flags=b.flags&-65537|128;case 0:if(b=w.payload,h=typeof b=="function"?b.call(g,f,h):b,h==null)break e;f=Mn({},f,h);break e;case 2:Os=!0}}s.callback!==null&&s.lane!==0&&(e.flags|=64,h=a.effects,h===null?a.effects=[s]:h.push(s))}else g={eventTime:g,lane:h,tag:s.tag,payload:s.payload,callback:s.callback,next:null},d===null?(u=d=g,l=f):d=d.next=g,o|=h;if(s=s.next,s===null){if(s=a.shared.pending,s===null)break;h=s,s=h.next,h.next=null,a.lastBaseUpdate=h,a.shared.pending=null}}while(!0);if(d===null&&(l=f),a.baseState=l,a.firstBaseUpdate=u,a.lastBaseUpdate=d,t=a.shared.interleaved,t!==null){a=t;do o|=a.lane,a=a.next;while(a!==t)}else i===null&&(a.shared.lanes=0);Ql|=o,e.lanes=o,e.memoizedState=f}}function Qw(e,t,r){if(e=t.effects,t.effects=null,e!==null)for(t=0;t<e.length;t++){var n=e[t],a=n.callback;if(a!==null){if(n.callback=null,n=r,typeof a!="function")throw Error(Re(191,a));a.call(n)}}}var p0={},Oo=ol(p0),bf=ol(p0),wf=ol(p0);function Il(e){if(e===p0)throw Error(Re(174));return e}function vb(e,t){switch(un(wf,t),un(bf,e),un(Oo,p0),e=t.nodeType,e){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:kx(null,"");break;default:e=e===8?t.parentNode:t,t=e.namespaceURI||null,e=e.tagName,t=kx(t,e)}gn(Oo),un(Oo,t)}function uu(){gn(Oo),gn(bf),gn(wf)}function wP(e){Il(wf.current);var t=Il(Oo.current),r=kx(t,e.type);t!==r&&(un(bf,e),un(Oo,r))}function bb(e){bf.current===e&&(gn(Oo),gn(bf))}var _n=ol(0);function ip(e){for(var t=e;t!==null;){if(t.tag===13){var r=t.memoizedState;if(r!==null&&(r=r.dehydrated,r===null||r.data==="$?"||r.data==="$!"))return t}else if(t.tag===19&&t.memoizedProps.revealOrder!==void 0){if(t.flags&128)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var hy=[];function wb(){for(var e=0;e<hy.length;e++)hy[e]._workInProgressVersionPrimary=null;hy.length=0}var Eh=gs.ReactCurrentDispatcher,py=gs.ReactCurrentBatchConfig,Jl=0,Cn=null,ta=null,da=null,op=!1,Yd=!1,kf=0,LA=0;function Na(){throw Error(Re(321))}function kb(e,t){if(t===null)return!1;for(var r=0;r<t.length&&r<e.length;r++)if(!uo(e[r],t[r]))return!1;return!0}function Sb(e,t,r,n,a,i){if(Jl=i,Cn=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,Eh.current=e===null||e.memoizedState===null?zA:WA,e=r(n,a),Yd){i=0;do{if(Yd=!1,kf=0,25<=i)throw Error(Re(301));i+=1,da=ta=null,t.updateQueue=null,Eh.current=HA,e=r(n,a)}while(Yd)}if(Eh.current=sp,t=ta!==null&&ta.next!==null,Jl=0,da=ta=Cn=null,op=!1,t)throw Error(Re(300));return e}function jb(){var e=kf!==0;return kf=0,e}function jo(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return da===null?Cn.memoizedState=da=e:da=da.next=e,da}function Li(){if(ta===null){var e=Cn.alternate;e=e!==null?e.memoizedState:null}else e=ta.next;var t=da===null?Cn.memoizedState:da.next;if(t!==null)da=t,ta=e;else{if(e===null)throw Error(Re(310));ta=e,e={memoizedState:ta.memoizedState,baseState:ta.baseState,baseQueue:ta.baseQueue,queue:ta.queue,next:null},da===null?Cn.memoizedState=da=e:da=da.next=e}return da}function Sf(e,t){return typeof t=="function"?t(e):t}function gy(e){var t=Li(),r=t.queue;if(r===null)throw Error(Re(311));r.lastRenderedReducer=e;var n=ta,a=n.baseQueue,i=r.pending;if(i!==null){if(a!==null){var o=a.next;a.next=i.next,i.next=o}n.baseQueue=a=i,r.pending=null}if(a!==null){i=a.next,n=n.baseState;var s=o=null,l=null,u=i;do{var d=u.lane;if((Jl&d)===d)l!==null&&(l=l.next={lane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),n=u.hasEagerState?u.eagerState:e(n,u.action);else{var f={lane:d,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null};l===null?(s=l=f,o=n):l=l.next=f,Cn.lanes|=d,Ql|=d}u=u.next}while(u!==null&&u!==i);l===null?o=n:l.next=s,uo(n,t.memoizedState)||(ni=!0),t.memoizedState=n,t.baseState=o,t.baseQueue=l,r.lastRenderedState=n}if(e=r.interleaved,e!==null){a=e;do i=a.lane,Cn.lanes|=i,Ql|=i,a=a.next;while(a!==e)}else a===null&&(r.lanes=0);return[t.memoizedState,r.dispatch]}function my(e){var t=Li(),r=t.queue;if(r===null)throw Error(Re(311));r.lastRenderedReducer=e;var n=r.dispatch,a=r.pending,i=t.memoizedState;if(a!==null){r.pending=null;var o=a=a.next;do i=e(i,o.action),o=o.next;while(o!==a);uo(i,t.memoizedState)||(ni=!0),t.memoizedState=i,t.baseQueue===null&&(t.baseState=i),r.lastRenderedState=i}return[i,n]}function kP(){}function SP(e,t){var r=Cn,n=Li(),a=t(),i=!uo(n.memoizedState,a);if(i&&(n.memoizedState=a,ni=!0),n=n.queue,Pb(_P.bind(null,r,n,e),[e]),n.getSnapshot!==t||i||da!==null&&da.memoizedState.tag&1){if(r.flags|=2048,jf(9,PP.bind(null,r,n,a,t),void 0,null),fa===null)throw Error(Re(349));Jl&30||jP(r,t,a)}return a}function jP(e,t,r){e.flags|=16384,e={getSnapshot:t,value:r},t=Cn.updateQueue,t===null?(t={lastEffect:null,stores:null},Cn.updateQueue=t,t.stores=[e]):(r=t.stores,r===null?t.stores=[e]:r.push(e))}function PP(e,t,r,n){t.value=r,t.getSnapshot=n,CP(t)&&MP(e)}function _P(e,t,r){return r(function(){CP(t)&&MP(e)})}function CP(e){var t=e.getSnapshot;e=e.value;try{var r=t();return!uo(e,r)}catch{return!0}}function MP(e){var t=us(e,1);t!==null&&co(t,e,1,-1)}function ek(e){var t=jo();return typeof e=="function"&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Sf,lastRenderedState:e},t.queue=e,e=e.dispatch=UA.bind(null,Cn,e),[t.memoizedState,e]}function jf(e,t,r,n){return e={tag:e,create:t,destroy:r,deps:n,next:null},t=Cn.updateQueue,t===null?(t={lastEffect:null,stores:null},Cn.updateQueue=t,t.lastEffect=e.next=e):(r=t.lastEffect,r===null?t.lastEffect=e.next=e:(n=r.next,r.next=e,e.next=n,t.lastEffect=e)),e}function NP(){return Li().memoizedState}function Ih(e,t,r,n){var a=jo();Cn.flags|=e,a.memoizedState=jf(1|t,r,void 0,n===void 0?null:n)}function Og(e,t,r,n){var a=Li();n=n===void 0?null:n;var i=void 0;if(ta!==null){var o=ta.memoizedState;if(i=o.destroy,n!==null&&kb(n,o.deps)){a.memoizedState=jf(t,r,i,n);return}}Cn.flags|=e,a.memoizedState=jf(1|t,r,i,n)}function tk(e,t){return Ih(8390656,8,e,t)}function Pb(e,t){return Og(2048,8,e,t)}function OP(e,t){return Og(4,2,e,t)}function AP(e,t){return Og(4,4,e,t)}function TP(e,t){if(typeof t=="function")return e=e(),t(e),function(){t(null)};if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function EP(e,t,r){return r=r!=null?r.concat([e]):null,Og(4,4,TP.bind(null,t,e),r)}function _b(){}function IP(e,t){var r=Li();t=t===void 0?null:t;var n=r.memoizedState;return n!==null&&t!==null&&kb(t,n[1])?n[0]:(r.memoizedState=[e,t],e)}function $P(e,t){var r=Li();t=t===void 0?null:t;var n=r.memoizedState;return n!==null&&t!==null&&kb(t,n[1])?n[0]:(e=e(),r.memoizedState=[e,t],e)}function DP(e,t,r){return Jl&21?(uo(r,t)||(r=Gj(),Cn.lanes|=r,Ql|=r,e.baseState=!0),t):(e.baseState&&(e.baseState=!1,ni=!0),e.memoizedState=r)}function FA(e,t){var r=Qr;Qr=r!==0&&4>r?r:4,e(!0);var n=py.transition;py.transition={};try{e(!1),t()}finally{Qr=r,py.transition=n}}function RP(){return Li().memoizedState}function GA(e,t,r){var n=Js(e);if(r={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null},BP(e))LP(t,r);else if(r=vP(e,t,r,n),r!==null){var a=Ya();co(r,e,n,a),FP(r,t,n)}}function UA(e,t,r){var n=Js(e),a={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null};if(BP(e))LP(t,a);else{var i=e.alternate;if(e.lanes===0&&(i===null||i.lanes===0)&&(i=t.lastRenderedReducer,i!==null))try{var o=t.lastRenderedState,s=i(o,r);if(a.hasEagerState=!0,a.eagerState=s,uo(s,o)){var l=t.interleaved;l===null?(a.next=a,yb(t)):(a.next=l.next,l.next=a),t.interleaved=a;return}}catch{}finally{}r=vP(e,t,a,n),r!==null&&(a=Ya(),co(r,e,n,a),FP(r,t,n))}}function BP(e){var t=e.alternate;return e===Cn||t!==null&&t===Cn}function LP(e,t){Yd=op=!0;var r=e.pending;r===null?t.next=t:(t.next=r.next,r.next=t),e.pending=t}function FP(e,t,r){if(r&4194240){var n=t.lanes;n&=e.pendingLanes,r|=n,t.lanes=r,nb(e,r)}}var sp={readContext:Bi,useCallback:Na,useContext:Na,useEffect:Na,useImperativeHandle:Na,useInsertionEffect:Na,useLayoutEffect:Na,useMemo:Na,useReducer:Na,useRef:Na,useState:Na,useDebugValue:Na,useDeferredValue:Na,useTransition:Na,useMutableSource:Na,useSyncExternalStore:Na,useId:Na,unstable_isNewReconciler:!1},zA={readContext:Bi,useCallback:function(e,t){return jo().memoizedState=[e,t===void 0?null:t],e},useContext:Bi,useEffect:tk,useImperativeHandle:function(e,t,r){return r=r!=null?r.concat([e]):null,Ih(4194308,4,TP.bind(null,t,e),r)},useLayoutEffect:function(e,t){return Ih(4194308,4,e,t)},useInsertionEffect:function(e,t){return Ih(4,2,e,t)},useMemo:function(e,t){var r=jo();return t=t===void 0?null:t,e=e(),r.memoizedState=[e,t],e},useReducer:function(e,t,r){var n=jo();return t=r!==void 0?r(t):t,n.memoizedState=n.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},n.queue=e,e=e.dispatch=GA.bind(null,Cn,e),[n.memoizedState,e]},useRef:function(e){var t=jo();return e={current:e},t.memoizedState=e},useState:ek,useDebugValue:_b,useDeferredValue:function(e){return jo().memoizedState=e},useTransition:function(){var e=ek(!1),t=e[0];return e=FA.bind(null,e[1]),jo().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,r){var n=Cn,a=jo();if(bn){if(r===void 0)throw Error(Re(407));r=r()}else{if(r=t(),fa===null)throw Error(Re(349));Jl&30||jP(n,t,r)}a.memoizedState=r;var i={value:r,getSnapshot:t};return a.queue=i,tk(_P.bind(null,n,i,e),[e]),n.flags|=2048,jf(9,PP.bind(null,n,i,r,t),void 0,null),r},useId:function(){var e=jo(),t=fa.identifierPrefix;if(bn){var r=es,n=Qo;r=(n&~(1<<32-lo(n)-1)).toString(32)+r,t=":"+t+"R"+r,r=kf++,0<r&&(t+="H"+r.toString(32)),t+=":"}else r=LA++,t=":"+t+"r"+r.toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},WA={readContext:Bi,useCallback:IP,useContext:Bi,useEffect:Pb,useImperativeHandle:EP,useInsertionEffect:OP,useLayoutEffect:AP,useMemo:$P,useReducer:gy,useRef:NP,useState:function(){return gy(Sf)},useDebugValue:_b,useDeferredValue:function(e){var t=Li();return DP(t,ta.memoizedState,e)},useTransition:function(){var e=gy(Sf)[0],t=Li().memoizedState;return[e,t]},useMutableSource:kP,useSyncExternalStore:SP,useId:RP,unstable_isNewReconciler:!1},HA={readContext:Bi,useCallback:IP,useContext:Bi,useEffect:Pb,useImperativeHandle:EP,useInsertionEffect:OP,useLayoutEffect:AP,useMemo:$P,useReducer:my,useRef:NP,useState:function(){return my(Sf)},useDebugValue:_b,useDeferredValue:function(e){var t=Li();return ta===null?t.memoizedState=e:DP(t,ta.memoizedState,e)},useTransition:function(){var e=my(Sf)[0],t=Li().memoizedState;return[e,t]},useMutableSource:kP,useSyncExternalStore:SP,useId:RP,unstable_isNewReconciler:!1};function Ji(e,t){if(e&&e.defaultProps){t=Mn({},t),e=e.defaultProps;for(var r in e)t[r]===void 0&&(t[r]=e[r]);return t}return t}function zx(e,t,r,n){t=e.memoizedState,r=r(n,t),r=r==null?t:Mn({},t,r),e.memoizedState=r,e.lanes===0&&(e.updateQueue.baseState=r)}var Ag={isMounted:function(e){return(e=e._reactInternals)?gc(e)===e:!1},enqueueSetState:function(e,t,r){e=e._reactInternals;var n=Ya(),a=Js(e),i=as(n,a);i.payload=t,r!=null&&(i.callback=r),t=qs(e,i,a),t!==null&&(co(t,e,a,n),Th(t,e,a))},enqueueReplaceState:function(e,t,r){e=e._reactInternals;var n=Ya(),a=Js(e),i=as(n,a);i.tag=1,i.payload=t,r!=null&&(i.callback=r),t=qs(e,i,a),t!==null&&(co(t,e,a,n),Th(t,e,a))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var r=Ya(),n=Js(e),a=as(r,n);a.tag=2,t!=null&&(a.callback=t),t=qs(e,a,n),t!==null&&(co(t,e,n,r),Th(t,e,n))}};function rk(e,t,r,n,a,i,o){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(n,i,o):t.prototype&&t.prototype.isPureReactComponent?!mf(r,n)||!mf(a,i):!0}function GP(e,t,r){var n=!1,a=al,i=t.contextType;return typeof i=="object"&&i!==null?i=Bi(i):(a=oi(t)?ql:$a.current,n=t.contextTypes,i=(n=n!=null)?su(e,a):al),t=new t(r,i),e.memoizedState=t.state!==null&&t.state!==void 0?t.state:null,t.updater=Ag,e.stateNode=t,t._reactInternals=e,n&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=a,e.__reactInternalMemoizedMaskedChildContext=i),t}function nk(e,t,r,n){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(r,n),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(r,n),t.state!==e&&Ag.enqueueReplaceState(t,t.state,null)}function Wx(e,t,r,n){var a=e.stateNode;a.props=r,a.state=e.memoizedState,a.refs={},xb(e);var i=t.contextType;typeof i=="object"&&i!==null?a.context=Bi(i):(i=oi(t)?ql:$a.current,a.context=su(e,i)),a.state=e.memoizedState,i=t.getDerivedStateFromProps,typeof i=="function"&&(zx(e,t,i,r),a.state=e.memoizedState),typeof t.getDerivedStateFromProps=="function"||typeof a.getSnapshotBeforeUpdate=="function"||typeof a.UNSAFE_componentWillMount!="function"&&typeof a.componentWillMount!="function"||(t=a.state,typeof a.componentWillMount=="function"&&a.componentWillMount(),typeof a.UNSAFE_componentWillMount=="function"&&a.UNSAFE_componentWillMount(),t!==a.state&&Ag.enqueueReplaceState(a,a.state,null),ap(e,r,a,n),a.state=e.memoizedState),typeof a.componentDidMount=="function"&&(e.flags|=4194308)}function du(e,t){try{var r="",n=t;do r+=v6(n),n=n.return;while(n);var a=r}catch(i){a=`
Error generating stack: `+i.message+`
`+i.stack}return{value:e,source:t,stack:a,digest:null}}function yy(e,t,r){return{value:e,source:null,stack:r??null,digest:t??null}}function Hx(e,t){try{console.error(t.value)}catch(r){setTimeout(function(){throw r})}}var VA=typeof WeakMap=="function"?WeakMap:Map;function UP(e,t,r){r=as(-1,r),r.tag=3,r.payload={element:null};var n=t.value;return r.callback=function(){cp||(cp=!0,tv=n),Hx(e,t)},r}function zP(e,t,r){r=as(-1,r),r.tag=3;var n=e.type.getDerivedStateFromError;if(typeof n=="function"){var a=t.value;r.payload=function(){return n(a)},r.callback=function(){Hx(e,t)}}var i=e.stateNode;return i!==null&&typeof i.componentDidCatch=="function"&&(r.callback=function(){Hx(e,t),typeof n!="function"&&(Zs===null?Zs=new Set([this]):Zs.add(this));var o=t.stack;this.componentDidCatch(t.value,{componentStack:o!==null?o:""})}),r}function ak(e,t,r){var n=e.pingCache;if(n===null){n=e.pingCache=new VA;var a=new Set;n.set(t,a)}else a=n.get(t),a===void 0&&(a=new Set,n.set(t,a));a.has(r)||(a.add(r),e=oT.bind(null,e,t,r),t.then(e,e))}function ik(e){do{var t;if((t=e.tag===13)&&(t=e.memoizedState,t=t!==null?t.dehydrated!==null:!0),t)return e;e=e.return}while(e!==null);return null}function ok(e,t,r,n,a){return e.mode&1?(e.flags|=65536,e.lanes=a,e):(e===t?e.flags|=65536:(e.flags|=128,r.flags|=131072,r.flags&=-52805,r.tag===1&&(r.alternate===null?r.tag=17:(t=as(-1,1),t.tag=2,qs(r,t,1))),r.lanes|=1),e)}var XA=gs.ReactCurrentOwner,ni=!1;function Wa(e,t,r,n){t.child=e===null?xP(t,null,r,n):cu(t,e.child,r,n)}function sk(e,t,r,n,a){r=r.render;var i=t.ref;return eu(t,a),n=Sb(e,t,r,n,i,a),r=jb(),e!==null&&!ni?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~a,ds(e,t,a)):(bn&&r&&db(t),t.flags|=1,Wa(e,t,n,a),t.child)}function lk(e,t,r,n,a){if(e===null){var i=r.type;return typeof i=="function"&&!Ib(i)&&i.defaultProps===void 0&&r.compare===null&&r.defaultProps===void 0?(t.tag=15,t.type=i,WP(e,t,i,n,a)):(e=Bh(r.type,null,n,t,t.mode,a),e.ref=t.ref,e.return=t,t.child=e)}if(i=e.child,!(e.lanes&a)){var o=i.memoizedProps;if(r=r.compare,r=r!==null?r:mf,r(o,n)&&e.ref===t.ref)return ds(e,t,a)}return t.flags|=1,e=Qs(i,n),e.ref=t.ref,e.return=t,t.child=e}function WP(e,t,r,n,a){if(e!==null){var i=e.memoizedProps;if(mf(i,n)&&e.ref===t.ref)if(ni=!1,t.pendingProps=n=i,(e.lanes&a)!==0)e.flags&131072&&(ni=!0);else return t.lanes=e.lanes,ds(e,t,a)}return Vx(e,t,r,n,a)}function HP(e,t,r){var n=t.pendingProps,a=n.children,i=e!==null?e.memoizedState:null;if(n.mode==="hidden")if(!(t.mode&1))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},un(Vc,mi),mi|=r;else{if(!(r&1073741824))return e=i!==null?i.baseLanes|r:r,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,un(Vc,mi),mi|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},n=i!==null?i.baseLanes:r,un(Vc,mi),mi|=n}else i!==null?(n=i.baseLanes|r,t.memoizedState=null):n=r,un(Vc,mi),mi|=n;return Wa(e,t,a,r),t.child}function VP(e,t){var r=t.ref;(e===null&&r!==null||e!==null&&e.ref!==r)&&(t.flags|=512,t.flags|=2097152)}function Vx(e,t,r,n,a){var i=oi(r)?ql:$a.current;return i=su(t,i),eu(t,a),r=Sb(e,t,r,n,i,a),n=jb(),e!==null&&!ni?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~a,ds(e,t,a)):(bn&&n&&db(t),t.flags|=1,Wa(e,t,r,a),t.child)}function ck(e,t,r,n,a){if(oi(r)){var i=!0;Qh(t)}else i=!1;if(eu(t,a),t.stateNode===null)$h(e,t),GP(t,r,n),Wx(t,r,n,a),n=!0;else if(e===null){var o=t.stateNode,s=t.memoizedProps;o.props=s;var l=o.context,u=r.contextType;typeof u=="object"&&u!==null?u=Bi(u):(u=oi(r)?ql:$a.current,u=su(t,u));var d=r.getDerivedStateFromProps,f=typeof d=="function"||typeof o.getSnapshotBeforeUpdate=="function";f||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(s!==n||l!==u)&&nk(t,o,n,u),Os=!1;var h=t.memoizedState;o.state=h,ap(t,n,o,a),l=t.memoizedState,s!==n||h!==l||ii.current||Os?(typeof d=="function"&&(zx(t,r,d,n),l=t.memoizedState),(s=Os||rk(t,r,s,n,h,l,u))?(f||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount()),typeof o.componentDidMount=="function"&&(t.flags|=4194308)):(typeof o.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=n,t.memoizedState=l),o.props=n,o.state=l,o.context=u,n=s):(typeof o.componentDidMount=="function"&&(t.flags|=4194308),n=!1)}else{o=t.stateNode,bP(e,t),s=t.memoizedProps,u=t.type===t.elementType?s:Ji(t.type,s),o.props=u,f=t.pendingProps,h=o.context,l=r.contextType,typeof l=="object"&&l!==null?l=Bi(l):(l=oi(r)?ql:$a.current,l=su(t,l));var g=r.getDerivedStateFromProps;(d=typeof g=="function"||typeof o.getSnapshotBeforeUpdate=="function")||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(s!==f||h!==l)&&nk(t,o,n,l),Os=!1,h=t.memoizedState,o.state=h,ap(t,n,o,a);var b=t.memoizedState;s!==f||h!==b||ii.current||Os?(typeof g=="function"&&(zx(t,r,g,n),b=t.memoizedState),(u=Os||rk(t,r,u,n,h,b,l)||!1)?(d||typeof o.UNSAFE_componentWillUpdate!="function"&&typeof o.componentWillUpdate!="function"||(typeof o.componentWillUpdate=="function"&&o.componentWillUpdate(n,b,l),typeof o.UNSAFE_componentWillUpdate=="function"&&o.UNSAFE_componentWillUpdate(n,b,l)),typeof o.componentDidUpdate=="function"&&(t.flags|=4),typeof o.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof o.componentDidUpdate!="function"||s===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||s===e.memoizedProps&&h===e.memoizedState||(t.flags|=1024),t.memoizedProps=n,t.memoizedState=b),o.props=n,o.state=b,o.context=l,n=u):(typeof o.componentDidUpdate!="function"||s===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||s===e.memoizedProps&&h===e.memoizedState||(t.flags|=1024),n=!1)}return Xx(e,t,r,n,i,a)}function Xx(e,t,r,n,a,i){VP(e,t);var o=(t.flags&128)!==0;if(!n&&!o)return a&&Kw(t,r,!1),ds(e,t,i);n=t.stateNode,XA.current=t;var s=o&&typeof r.getDerivedStateFromError!="function"?null:n.render();return t.flags|=1,e!==null&&o?(t.child=cu(t,e.child,null,i),t.child=cu(t,null,s,i)):Wa(e,t,s,i),t.memoizedState=n.state,a&&Kw(t,r,!0),t.child}function XP(e){var t=e.stateNode;t.pendingContext?Xw(e,t.pendingContext,t.pendingContext!==t.context):t.context&&Xw(e,t.context,!1),vb(e,t.containerInfo)}function uk(e,t,r,n,a){return lu(),hb(a),t.flags|=256,Wa(e,t,r,n),t.child}var Kx={dehydrated:null,treeContext:null,retryLane:0};function Yx(e){return{baseLanes:e,cachePool:null,transitions:null}}function KP(e,t,r){var n=t.pendingProps,a=_n.current,i=!1,o=(t.flags&128)!==0,s;if((s=o)||(s=e!==null&&e.memoizedState===null?!1:(a&2)!==0),s?(i=!0,t.flags&=-129):(e===null||e.memoizedState!==null)&&(a|=1),un(_n,a&1),e===null)return Gx(t),e=t.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?(t.mode&1?e.data==="$!"?t.lanes=8:t.lanes=1073741824:t.lanes=1,null):(o=n.children,e=n.fallback,i?(n=t.mode,i=t.child,o={mode:"hidden",children:o},!(n&1)&&i!==null?(i.childLanes=0,i.pendingProps=o):i=Ig(o,n,0,null),e=Hl(e,n,r,null),i.return=t,e.return=t,i.sibling=e,t.child=i,t.child.memoizedState=Yx(r),t.memoizedState=Kx,e):Cb(t,o));if(a=e.memoizedState,a!==null&&(s=a.dehydrated,s!==null))return KA(e,t,o,n,s,a,r);if(i){i=n.fallback,o=t.mode,a=e.child,s=a.sibling;var l={mode:"hidden",children:n.children};return!(o&1)&&t.child!==a?(n=t.child,n.childLanes=0,n.pendingProps=l,t.deletions=null):(n=Qs(a,l),n.subtreeFlags=a.subtreeFlags&14680064),s!==null?i=Qs(s,i):(i=Hl(i,o,r,null),i.flags|=2),i.return=t,n.return=t,n.sibling=i,t.child=n,n=i,i=t.child,o=e.child.memoizedState,o=o===null?Yx(r):{baseLanes:o.baseLanes|r,cachePool:null,transitions:o.transitions},i.memoizedState=o,i.childLanes=e.childLanes&~r,t.memoizedState=Kx,n}return i=e.child,e=i.sibling,n=Qs(i,{mode:"visible",children:n.children}),!(t.mode&1)&&(n.lanes=r),n.return=t,n.sibling=null,e!==null&&(r=t.deletions,r===null?(t.deletions=[e],t.flags|=16):r.push(e)),t.child=n,t.memoizedState=null,n}function Cb(e,t){return t=Ig({mode:"visible",children:t},e.mode,0,null),t.return=e,e.child=t}function Z0(e,t,r,n){return n!==null&&hb(n),cu(t,e.child,null,r),e=Cb(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function KA(e,t,r,n,a,i,o){if(r)return t.flags&256?(t.flags&=-257,n=yy(Error(Re(422))),Z0(e,t,o,n)):t.memoizedState!==null?(t.child=e.child,t.flags|=128,null):(i=n.fallback,a=t.mode,n=Ig({mode:"visible",children:n.children},a,0,null),i=Hl(i,a,o,null),i.flags|=2,n.return=t,i.return=t,n.sibling=i,t.child=n,t.mode&1&&cu(t,e.child,null,o),t.child.memoizedState=Yx(o),t.memoizedState=Kx,i);if(!(t.mode&1))return Z0(e,t,o,null);if(a.data==="$!"){if(n=a.nextSibling&&a.nextSibling.dataset,n)var s=n.dgst;return n=s,i=Error(Re(419)),n=yy(i,n,void 0),Z0(e,t,o,n)}if(s=(o&e.childLanes)!==0,ni||s){if(n=fa,n!==null){switch(o&-o){case 4:a=2;break;case 16:a=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:a=32;break;case 536870912:a=268435456;break;default:a=0}a=a&(n.suspendedLanes|o)?0:a,a!==0&&a!==i.retryLane&&(i.retryLane=a,us(e,a),co(n,e,a,-1))}return Eb(),n=yy(Error(Re(421))),Z0(e,t,o,n)}return a.data==="$?"?(t.flags|=128,t.child=e.child,t=sT.bind(null,e),a._reactRetry=t,null):(e=i.treeContext,vi=Ys(a.nextSibling),bi=t,bn=!0,no=null,e!==null&&(Ai[Ti++]=Qo,Ai[Ti++]=es,Ai[Ti++]=Zl,Qo=e.id,es=e.overflow,Zl=t),t=Cb(t,n.children),t.flags|=4096,t)}function dk(e,t,r){e.lanes|=t;var n=e.alternate;n!==null&&(n.lanes|=t),Ux(e.return,t,r)}function xy(e,t,r,n,a){var i=e.memoizedState;i===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:n,tail:r,tailMode:a}:(i.isBackwards=t,i.rendering=null,i.renderingStartTime=0,i.last=n,i.tail=r,i.tailMode=a)}function YP(e,t,r){var n=t.pendingProps,a=n.revealOrder,i=n.tail;if(Wa(e,t,n.children,r),n=_n.current,n&2)n=n&1|2,t.flags|=128;else{if(e!==null&&e.flags&128)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&dk(e,r,t);else if(e.tag===19)dk(e,r,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}n&=1}if(un(_n,n),!(t.mode&1))t.memoizedState=null;else switch(a){case"forwards":for(r=t.child,a=null;r!==null;)e=r.alternate,e!==null&&ip(e)===null&&(a=r),r=r.sibling;r=a,r===null?(a=t.child,t.child=null):(a=r.sibling,r.sibling=null),xy(t,!1,a,r,i);break;case"backwards":for(r=null,a=t.child,t.child=null;a!==null;){if(e=a.alternate,e!==null&&ip(e)===null){t.child=a;break}e=a.sibling,a.sibling=r,r=a,a=e}xy(t,!0,r,null,i);break;case"together":xy(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function $h(e,t){!(t.mode&1)&&e!==null&&(e.alternate=null,t.alternate=null,t.flags|=2)}function ds(e,t,r){if(e!==null&&(t.dependencies=e.dependencies),Ql|=t.lanes,!(r&t.childLanes))return null;if(e!==null&&t.child!==e.child)throw Error(Re(153));if(t.child!==null){for(e=t.child,r=Qs(e,e.pendingProps),t.child=r,r.return=t;e.sibling!==null;)e=e.sibling,r=r.sibling=Qs(e,e.pendingProps),r.return=t;r.sibling=null}return t.child}function YA(e,t,r){switch(t.tag){case 3:XP(t),lu();break;case 5:wP(t);break;case 1:oi(t.type)&&Qh(t);break;case 4:vb(t,t.stateNode.containerInfo);break;case 10:var n=t.type._context,a=t.memoizedProps.value;un(rp,n._currentValue),n._currentValue=a;break;case 13:if(n=t.memoizedState,n!==null)return n.dehydrated!==null?(un(_n,_n.current&1),t.flags|=128,null):r&t.child.childLanes?KP(e,t,r):(un(_n,_n.current&1),e=ds(e,t,r),e!==null?e.sibling:null);un(_n,_n.current&1);break;case 19:if(n=(r&t.childLanes)!==0,e.flags&128){if(n)return YP(e,t,r);t.flags|=128}if(a=t.memoizedState,a!==null&&(a.rendering=null,a.tail=null,a.lastEffect=null),un(_n,_n.current),n)break;return null;case 22:case 23:return t.lanes=0,HP(e,t,r)}return ds(e,t,r)}var qP,qx,ZP,JP;qP=function(e,t){for(var r=t.child;r!==null;){if(r.tag===5||r.tag===6)e.appendChild(r.stateNode);else if(r.tag!==4&&r.child!==null){r.child.return=r,r=r.child;continue}if(r===t)break;for(;r.sibling===null;){if(r.return===null||r.return===t)return;r=r.return}r.sibling.return=r.return,r=r.sibling}};qx=function(){};ZP=function(e,t,r,n){var a=e.memoizedProps;if(a!==n){e=t.stateNode,Il(Oo.current);var i=null;switch(r){case"input":a=xx(e,a),n=xx(e,n),i=[];break;case"select":a=Mn({},a,{value:void 0}),n=Mn({},n,{value:void 0}),i=[];break;case"textarea":a=wx(e,a),n=wx(e,n),i=[];break;default:typeof a.onClick!="function"&&typeof n.onClick=="function"&&(e.onclick=Zh)}Sx(r,n);var o;r=null;for(u in a)if(!n.hasOwnProperty(u)&&a.hasOwnProperty(u)&&a[u]!=null)if(u==="style"){var s=a[u];for(o in s)s.hasOwnProperty(o)&&(r||(r={}),r[o]="")}else u!=="dangerouslySetInnerHTML"&&u!=="children"&&u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&u!=="autoFocus"&&(cf.hasOwnProperty(u)?i||(i=[]):(i=i||[]).push(u,null));for(u in n){var l=n[u];if(s=a!=null?a[u]:void 0,n.hasOwnProperty(u)&&l!==s&&(l!=null||s!=null))if(u==="style")if(s){for(o in s)!s.hasOwnProperty(o)||l&&l.hasOwnProperty(o)||(r||(r={}),r[o]="");for(o in l)l.hasOwnProperty(o)&&s[o]!==l[o]&&(r||(r={}),r[o]=l[o])}else r||(i||(i=[]),i.push(u,r)),r=l;else u==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,s=s?s.__html:void 0,l!=null&&s!==l&&(i=i||[]).push(u,l)):u==="children"?typeof l!="string"&&typeof l!="number"||(i=i||[]).push(u,""+l):u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&(cf.hasOwnProperty(u)?(l!=null&&u==="onScroll"&&fn("scroll",e),i||s===l||(i=[])):(i=i||[]).push(u,l))}r&&(i=i||[]).push("style",r);var u=i;(t.updateQueue=u)&&(t.flags|=4)}};JP=function(e,t,r,n){r!==n&&(t.flags|=4)};function jd(e,t){if(!bn)switch(e.tailMode){case"hidden":t=e.tail;for(var r=null;t!==null;)t.alternate!==null&&(r=t),t=t.sibling;r===null?e.tail=null:r.sibling=null;break;case"collapsed":r=e.tail;for(var n=null;r!==null;)r.alternate!==null&&(n=r),r=r.sibling;n===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:n.sibling=null}}function Oa(e){var t=e.alternate!==null&&e.alternate.child===e.child,r=0,n=0;if(t)for(var a=e.child;a!==null;)r|=a.lanes|a.childLanes,n|=a.subtreeFlags&14680064,n|=a.flags&14680064,a.return=e,a=a.sibling;else for(a=e.child;a!==null;)r|=a.lanes|a.childLanes,n|=a.subtreeFlags,n|=a.flags,a.return=e,a=a.sibling;return e.subtreeFlags|=n,e.childLanes=r,t}function qA(e,t,r){var n=t.pendingProps;switch(fb(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Oa(t),null;case 1:return oi(t.type)&&Jh(),Oa(t),null;case 3:return n=t.stateNode,uu(),gn(ii),gn($a),wb(),n.pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),(e===null||e.child===null)&&(Y0(t)?t.flags|=4:e===null||e.memoizedState.isDehydrated&&!(t.flags&256)||(t.flags|=1024,no!==null&&(av(no),no=null))),qx(e,t),Oa(t),null;case 5:bb(t);var a=Il(wf.current);if(r=t.type,e!==null&&t.stateNode!=null)ZP(e,t,r,n,a),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!n){if(t.stateNode===null)throw Error(Re(166));return Oa(t),null}if(e=Il(Oo.current),Y0(t)){n=t.stateNode,r=t.type;var i=t.memoizedProps;switch(n[Po]=t,n[vf]=i,e=(t.mode&1)!==0,r){case"dialog":fn("cancel",n),fn("close",n);break;case"iframe":case"object":case"embed":fn("load",n);break;case"video":case"audio":for(a=0;a<Ud.length;a++)fn(Ud[a],n);break;case"source":fn("error",n);break;case"img":case"image":case"link":fn("error",n),fn("load",n);break;case"details":fn("toggle",n);break;case"input":bw(n,i),fn("invalid",n);break;case"select":n._wrapperState={wasMultiple:!!i.multiple},fn("invalid",n);break;case"textarea":kw(n,i),fn("invalid",n)}Sx(r,i),a=null;for(var o in i)if(i.hasOwnProperty(o)){var s=i[o];o==="children"?typeof s=="string"?n.textContent!==s&&(i.suppressHydrationWarning!==!0&&K0(n.textContent,s,e),a=["children",s]):typeof s=="number"&&n.textContent!==""+s&&(i.suppressHydrationWarning!==!0&&K0(n.textContent,s,e),a=["children",""+s]):cf.hasOwnProperty(o)&&s!=null&&o==="onScroll"&&fn("scroll",n)}switch(r){case"input":F0(n),ww(n,i,!0);break;case"textarea":F0(n),Sw(n);break;case"select":case"option":break;default:typeof i.onClick=="function"&&(n.onclick=Zh)}n=a,t.updateQueue=n,n!==null&&(t.flags|=4)}else{o=a.nodeType===9?a:a.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=_j(r)),e==="http://www.w3.org/1999/xhtml"?r==="script"?(e=o.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof n.is=="string"?e=o.createElement(r,{is:n.is}):(e=o.createElement(r),r==="select"&&(o=e,n.multiple?o.multiple=!0:n.size&&(o.size=n.size))):e=o.createElementNS(e,r),e[Po]=t,e[vf]=n,qP(e,t,!1,!1),t.stateNode=e;e:{switch(o=jx(r,n),r){case"dialog":fn("cancel",e),fn("close",e),a=n;break;case"iframe":case"object":case"embed":fn("load",e),a=n;break;case"video":case"audio":for(a=0;a<Ud.length;a++)fn(Ud[a],e);a=n;break;case"source":fn("error",e),a=n;break;case"img":case"image":case"link":fn("error",e),fn("load",e),a=n;break;case"details":fn("toggle",e),a=n;break;case"input":bw(e,n),a=xx(e,n),fn("invalid",e);break;case"option":a=n;break;case"select":e._wrapperState={wasMultiple:!!n.multiple},a=Mn({},n,{value:void 0}),fn("invalid",e);break;case"textarea":kw(e,n),a=wx(e,n),fn("invalid",e);break;default:a=n}Sx(r,a),s=a;for(i in s)if(s.hasOwnProperty(i)){var l=s[i];i==="style"?Nj(e,l):i==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,l!=null&&Cj(e,l)):i==="children"?typeof l=="string"?(r!=="textarea"||l!=="")&&uf(e,l):typeof l=="number"&&uf(e,""+l):i!=="suppressContentEditableWarning"&&i!=="suppressHydrationWarning"&&i!=="autoFocus"&&(cf.hasOwnProperty(i)?l!=null&&i==="onScroll"&&fn("scroll",e):l!=null&&Z1(e,i,l,o))}switch(r){case"input":F0(e),ww(e,n,!1);break;case"textarea":F0(e),Sw(e);break;case"option":n.value!=null&&e.setAttribute("value",""+nl(n.value));break;case"select":e.multiple=!!n.multiple,i=n.value,i!=null?qc(e,!!n.multiple,i,!1):n.defaultValue!=null&&qc(e,!!n.multiple,n.defaultValue,!0);break;default:typeof a.onClick=="function"&&(e.onclick=Zh)}switch(r){case"button":case"input":case"select":case"textarea":n=!!n.autoFocus;break e;case"img":n=!0;break e;default:n=!1}}n&&(t.flags|=4)}t.ref!==null&&(t.flags|=512,t.flags|=2097152)}return Oa(t),null;case 6:if(e&&t.stateNode!=null)JP(e,t,e.memoizedProps,n);else{if(typeof n!="string"&&t.stateNode===null)throw Error(Re(166));if(r=Il(wf.current),Il(Oo.current),Y0(t)){if(n=t.stateNode,r=t.memoizedProps,n[Po]=t,(i=n.nodeValue!==r)&&(e=bi,e!==null))switch(e.tag){case 3:K0(n.nodeValue,r,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&K0(n.nodeValue,r,(e.mode&1)!==0)}i&&(t.flags|=4)}else n=(r.nodeType===9?r:r.ownerDocument).createTextNode(n),n[Po]=t,t.stateNode=n}return Oa(t),null;case 13:if(gn(_n),n=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(bn&&vi!==null&&t.mode&1&&!(t.flags&128))mP(),lu(),t.flags|=98560,i=!1;else if(i=Y0(t),n!==null&&n.dehydrated!==null){if(e===null){if(!i)throw Error(Re(318));if(i=t.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(Re(317));i[Po]=t}else lu(),!(t.flags&128)&&(t.memoizedState=null),t.flags|=4;Oa(t),i=!1}else no!==null&&(av(no),no=null),i=!0;if(!i)return t.flags&65536?t:null}return t.flags&128?(t.lanes=r,t):(n=n!==null,n!==(e!==null&&e.memoizedState!==null)&&n&&(t.child.flags|=8192,t.mode&1&&(e===null||_n.current&1?na===0&&(na=3):Eb())),t.updateQueue!==null&&(t.flags|=4),Oa(t),null);case 4:return uu(),qx(e,t),e===null&&yf(t.stateNode.containerInfo),Oa(t),null;case 10:return mb(t.type._context),Oa(t),null;case 17:return oi(t.type)&&Jh(),Oa(t),null;case 19:if(gn(_n),i=t.memoizedState,i===null)return Oa(t),null;if(n=(t.flags&128)!==0,o=i.rendering,o===null)if(n)jd(i,!1);else{if(na!==0||e!==null&&e.flags&128)for(e=t.child;e!==null;){if(o=ip(e),o!==null){for(t.flags|=128,jd(i,!1),n=o.updateQueue,n!==null&&(t.updateQueue=n,t.flags|=4),t.subtreeFlags=0,n=r,r=t.child;r!==null;)i=r,e=n,i.flags&=14680066,o=i.alternate,o===null?(i.childLanes=0,i.lanes=e,i.child=null,i.subtreeFlags=0,i.memoizedProps=null,i.memoizedState=null,i.updateQueue=null,i.dependencies=null,i.stateNode=null):(i.childLanes=o.childLanes,i.lanes=o.lanes,i.child=o.child,i.subtreeFlags=0,i.deletions=null,i.memoizedProps=o.memoizedProps,i.memoizedState=o.memoizedState,i.updateQueue=o.updateQueue,i.type=o.type,e=o.dependencies,i.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),r=r.sibling;return un(_n,_n.current&1|2),t.child}e=e.sibling}i.tail!==null&&In()>fu&&(t.flags|=128,n=!0,jd(i,!1),t.lanes=4194304)}else{if(!n)if(e=ip(o),e!==null){if(t.flags|=128,n=!0,r=e.updateQueue,r!==null&&(t.updateQueue=r,t.flags|=4),jd(i,!0),i.tail===null&&i.tailMode==="hidden"&&!o.alternate&&!bn)return Oa(t),null}else 2*In()-i.renderingStartTime>fu&&r!==1073741824&&(t.flags|=128,n=!0,jd(i,!1),t.lanes=4194304);i.isBackwards?(o.sibling=t.child,t.child=o):(r=i.last,r!==null?r.sibling=o:t.child=o,i.last=o)}return i.tail!==null?(t=i.tail,i.rendering=t,i.tail=t.sibling,i.renderingStartTime=In(),t.sibling=null,r=_n.current,un(_n,n?r&1|2:r&1),t):(Oa(t),null);case 22:case 23:return Tb(),n=t.memoizedState!==null,e!==null&&e.memoizedState!==null!==n&&(t.flags|=8192),n&&t.mode&1?mi&1073741824&&(Oa(t),t.subtreeFlags&6&&(t.flags|=8192)):Oa(t),null;case 24:return null;case 25:return null}throw Error(Re(156,t.tag))}function ZA(e,t){switch(fb(t),t.tag){case 1:return oi(t.type)&&Jh(),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return uu(),gn(ii),gn($a),wb(),e=t.flags,e&65536&&!(e&128)?(t.flags=e&-65537|128,t):null;case 5:return bb(t),null;case 13:if(gn(_n),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(Re(340));lu()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return gn(_n),null;case 4:return uu(),null;case 10:return mb(t.type._context),null;case 22:case 23:return Tb(),null;case 24:return null;default:return null}}var J0=!1,Ta=!1,JA=typeof WeakSet=="function"?WeakSet:Set,st=null;function Hc(e,t){var r=e.ref;if(r!==null)if(typeof r=="function")try{r(null)}catch(n){An(e,t,n)}else r.current=null}function Zx(e,t,r){try{r()}catch(n){An(e,t,n)}}var fk=!1;function QA(e,t){if(Ix=Kh,e=nP(),ub(e)){if("selectionStart"in e)var r={start:e.selectionStart,end:e.selectionEnd};else e:{r=(r=e.ownerDocument)&&r.defaultView||window;var n=r.getSelection&&r.getSelection();if(n&&n.rangeCount!==0){r=n.anchorNode;var a=n.anchorOffset,i=n.focusNode;n=n.focusOffset;try{r.nodeType,i.nodeType}catch{r=null;break e}var o=0,s=-1,l=-1,u=0,d=0,f=e,h=null;t:for(;;){for(var g;f!==r||a!==0&&f.nodeType!==3||(s=o+a),f!==i||n!==0&&f.nodeType!==3||(l=o+n),f.nodeType===3&&(o+=f.nodeValue.length),(g=f.firstChild)!==null;)h=f,f=g;for(;;){if(f===e)break t;if(h===r&&++u===a&&(s=o),h===i&&++d===n&&(l=o),(g=f.nextSibling)!==null)break;f=h,h=f.parentNode}f=g}r=s===-1||l===-1?null:{start:s,end:l}}else r=null}r=r||{start:0,end:0}}else r=null;for($x={focusedElem:e,selectionRange:r},Kh=!1,st=t;st!==null;)if(t=st,e=t.child,(t.subtreeFlags&1028)!==0&&e!==null)e.return=t,st=e;else for(;st!==null;){t=st;try{var b=t.alternate;if(t.flags&1024)switch(t.tag){case 0:case 11:case 15:break;case 1:if(b!==null){var w=b.memoizedProps,v=b.memoizedState,x=t.stateNode,m=x.getSnapshotBeforeUpdate(t.elementType===t.type?w:Ji(t.type,w),v);x.__reactInternalSnapshotBeforeUpdate=m}break;case 3:var k=t.stateNode.containerInfo;k.nodeType===1?k.textContent="":k.nodeType===9&&k.documentElement&&k.removeChild(k.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(Re(163))}}catch(P){An(t,t.return,P)}if(e=t.sibling,e!==null){e.return=t.return,st=e;break}st=t.return}return b=fk,fk=!1,b}function qd(e,t,r){var n=t.updateQueue;if(n=n!==null?n.lastEffect:null,n!==null){var a=n=n.next;do{if((a.tag&e)===e){var i=a.destroy;a.destroy=void 0,i!==void 0&&Zx(t,r,i)}a=a.next}while(a!==n)}}function Tg(e,t){if(t=t.updateQueue,t=t!==null?t.lastEffect:null,t!==null){var r=t=t.next;do{if((r.tag&e)===e){var n=r.create;r.destroy=n()}r=r.next}while(r!==t)}}function Jx(e){var t=e.ref;if(t!==null){var r=e.stateNode;switch(e.tag){case 5:e=r;break;default:e=r}typeof t=="function"?t(e):t.current=e}}function QP(e){var t=e.alternate;t!==null&&(e.alternate=null,QP(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&(delete t[Po],delete t[vf],delete t[Bx],delete t[$A],delete t[DA])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function e_(e){return e.tag===5||e.tag===3||e.tag===4}function hk(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||e_(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function Qx(e,t,r){var n=e.tag;if(n===5||n===6)e=e.stateNode,t?r.nodeType===8?r.parentNode.insertBefore(e,t):r.insertBefore(e,t):(r.nodeType===8?(t=r.parentNode,t.insertBefore(e,r)):(t=r,t.appendChild(e)),r=r._reactRootContainer,r!=null||t.onclick!==null||(t.onclick=Zh));else if(n!==4&&(e=e.child,e!==null))for(Qx(e,t,r),e=e.sibling;e!==null;)Qx(e,t,r),e=e.sibling}function ev(e,t,r){var n=e.tag;if(n===5||n===6)e=e.stateNode,t?r.insertBefore(e,t):r.appendChild(e);else if(n!==4&&(e=e.child,e!==null))for(ev(e,t,r),e=e.sibling;e!==null;)ev(e,t,r),e=e.sibling}var ba=null,eo=!1;function Ss(e,t,r){for(r=r.child;r!==null;)t_(e,t,r),r=r.sibling}function t_(e,t,r){if(No&&typeof No.onCommitFiberUnmount=="function")try{No.onCommitFiberUnmount(jg,r)}catch{}switch(r.tag){case 5:Ta||Hc(r,t);case 6:var n=ba,a=eo;ba=null,Ss(e,t,r),ba=n,eo=a,ba!==null&&(eo?(e=ba,r=r.stateNode,e.nodeType===8?e.parentNode.removeChild(r):e.removeChild(r)):ba.removeChild(r.stateNode));break;case 18:ba!==null&&(eo?(e=ba,r=r.stateNode,e.nodeType===8?dy(e.parentNode,r):e.nodeType===1&&dy(e,r),pf(e)):dy(ba,r.stateNode));break;case 4:n=ba,a=eo,ba=r.stateNode.containerInfo,eo=!0,Ss(e,t,r),ba=n,eo=a;break;case 0:case 11:case 14:case 15:if(!Ta&&(n=r.updateQueue,n!==null&&(n=n.lastEffect,n!==null))){a=n=n.next;do{var i=a,o=i.destroy;i=i.tag,o!==void 0&&(i&2||i&4)&&Zx(r,t,o),a=a.next}while(a!==n)}Ss(e,t,r);break;case 1:if(!Ta&&(Hc(r,t),n=r.stateNode,typeof n.componentWillUnmount=="function"))try{n.props=r.memoizedProps,n.state=r.memoizedState,n.componentWillUnmount()}catch(s){An(r,t,s)}Ss(e,t,r);break;case 21:Ss(e,t,r);break;case 22:r.mode&1?(Ta=(n=Ta)||r.memoizedState!==null,Ss(e,t,r),Ta=n):Ss(e,t,r);break;default:Ss(e,t,r)}}function pk(e){var t=e.updateQueue;if(t!==null){e.updateQueue=null;var r=e.stateNode;r===null&&(r=e.stateNode=new JA),t.forEach(function(n){var a=lT.bind(null,e,n);r.has(n)||(r.add(n),n.then(a,a))})}}function Yi(e,t){var r=t.deletions;if(r!==null)for(var n=0;n<r.length;n++){var a=r[n];try{var i=e,o=t,s=o;e:for(;s!==null;){switch(s.tag){case 5:ba=s.stateNode,eo=!1;break e;case 3:ba=s.stateNode.containerInfo,eo=!0;break e;case 4:ba=s.stateNode.containerInfo,eo=!0;break e}s=s.return}if(ba===null)throw Error(Re(160));t_(i,o,a),ba=null,eo=!1;var l=a.alternate;l!==null&&(l.return=null),a.return=null}catch(u){An(a,t,u)}}if(t.subtreeFlags&12854)for(t=t.child;t!==null;)r_(t,e),t=t.sibling}function r_(e,t){var r=e.alternate,n=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(Yi(t,e),So(e),n&4){try{qd(3,e,e.return),Tg(3,e)}catch(w){An(e,e.return,w)}try{qd(5,e,e.return)}catch(w){An(e,e.return,w)}}break;case 1:Yi(t,e),So(e),n&512&&r!==null&&Hc(r,r.return);break;case 5:if(Yi(t,e),So(e),n&512&&r!==null&&Hc(r,r.return),e.flags&32){var a=e.stateNode;try{uf(a,"")}catch(w){An(e,e.return,w)}}if(n&4&&(a=e.stateNode,a!=null)){var i=e.memoizedProps,o=r!==null?r.memoizedProps:i,s=e.type,l=e.updateQueue;if(e.updateQueue=null,l!==null)try{s==="input"&&i.type==="radio"&&i.name!=null&&jj(a,i),jx(s,o);var u=jx(s,i);for(o=0;o<l.length;o+=2){var d=l[o],f=l[o+1];d==="style"?Nj(a,f):d==="dangerouslySetInnerHTML"?Cj(a,f):d==="children"?uf(a,f):Z1(a,d,f,u)}switch(s){case"input":vx(a,i);break;case"textarea":Pj(a,i);break;case"select":var h=a._wrapperState.wasMultiple;a._wrapperState.wasMultiple=!!i.multiple;var g=i.value;g!=null?qc(a,!!i.multiple,g,!1):h!==!!i.multiple&&(i.defaultValue!=null?qc(a,!!i.multiple,i.defaultValue,!0):qc(a,!!i.multiple,i.multiple?[]:"",!1))}a[vf]=i}catch(w){An(e,e.return,w)}}break;case 6:if(Yi(t,e),So(e),n&4){if(e.stateNode===null)throw Error(Re(162));a=e.stateNode,i=e.memoizedProps;try{a.nodeValue=i}catch(w){An(e,e.return,w)}}break;case 3:if(Yi(t,e),So(e),n&4&&r!==null&&r.memoizedState.isDehydrated)try{pf(t.containerInfo)}catch(w){An(e,e.return,w)}break;case 4:Yi(t,e),So(e);break;case 13:Yi(t,e),So(e),a=e.child,a.flags&8192&&(i=a.memoizedState!==null,a.stateNode.isHidden=i,!i||a.alternate!==null&&a.alternate.memoizedState!==null||(Ob=In())),n&4&&pk(e);break;case 22:if(d=r!==null&&r.memoizedState!==null,e.mode&1?(Ta=(u=Ta)||d,Yi(t,e),Ta=u):Yi(t,e),So(e),n&8192){if(u=e.memoizedState!==null,(e.stateNode.isHidden=u)&&!d&&e.mode&1)for(st=e,d=e.child;d!==null;){for(f=st=d;st!==null;){switch(h=st,g=h.child,h.tag){case 0:case 11:case 14:case 15:qd(4,h,h.return);break;case 1:Hc(h,h.return);var b=h.stateNode;if(typeof b.componentWillUnmount=="function"){n=h,r=h.return;try{t=n,b.props=t.memoizedProps,b.state=t.memoizedState,b.componentWillUnmount()}catch(w){An(n,r,w)}}break;case 5:Hc(h,h.return);break;case 22:if(h.memoizedState!==null){mk(f);continue}}g!==null?(g.return=h,st=g):mk(f)}d=d.sibling}e:for(d=null,f=e;;){if(f.tag===5){if(d===null){d=f;try{a=f.stateNode,u?(i=a.style,typeof i.setProperty=="function"?i.setProperty("display","none","important"):i.display="none"):(s=f.stateNode,l=f.memoizedProps.style,o=l!=null&&l.hasOwnProperty("display")?l.display:null,s.style.display=Mj("display",o))}catch(w){An(e,e.return,w)}}}else if(f.tag===6){if(d===null)try{f.stateNode.nodeValue=u?"":f.memoizedProps}catch(w){An(e,e.return,w)}}else if((f.tag!==22&&f.tag!==23||f.memoizedState===null||f===e)&&f.child!==null){f.child.return=f,f=f.child;continue}if(f===e)break e;for(;f.sibling===null;){if(f.return===null||f.return===e)break e;d===f&&(d=null),f=f.return}d===f&&(d=null),f.sibling.return=f.return,f=f.sibling}}break;case 19:Yi(t,e),So(e),n&4&&pk(e);break;case 21:break;default:Yi(t,e),So(e)}}function So(e){var t=e.flags;if(t&2){try{e:{for(var r=e.return;r!==null;){if(e_(r)){var n=r;break e}r=r.return}throw Error(Re(160))}switch(n.tag){case 5:var a=n.stateNode;n.flags&32&&(uf(a,""),n.flags&=-33);var i=hk(e);ev(e,i,a);break;case 3:case 4:var o=n.stateNode.containerInfo,s=hk(e);Qx(e,s,o);break;default:throw Error(Re(161))}}catch(l){An(e,e.return,l)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function eT(e,t,r){st=e,n_(e)}function n_(e,t,r){for(var n=(e.mode&1)!==0;st!==null;){var a=st,i=a.child;if(a.tag===22&&n){var o=a.memoizedState!==null||J0;if(!o){var s=a.alternate,l=s!==null&&s.memoizedState!==null||Ta;s=J0;var u=Ta;if(J0=o,(Ta=l)&&!u)for(st=a;st!==null;)o=st,l=o.child,o.tag===22&&o.memoizedState!==null?yk(a):l!==null?(l.return=o,st=l):yk(a);for(;i!==null;)st=i,n_(i),i=i.sibling;st=a,J0=s,Ta=u}gk(e)}else a.subtreeFlags&8772&&i!==null?(i.return=a,st=i):gk(e)}}function gk(e){for(;st!==null;){var t=st;if(t.flags&8772){var r=t.alternate;try{if(t.flags&8772)switch(t.tag){case 0:case 11:case 15:Ta||Tg(5,t);break;case 1:var n=t.stateNode;if(t.flags&4&&!Ta)if(r===null)n.componentDidMount();else{var a=t.elementType===t.type?r.memoizedProps:Ji(t.type,r.memoizedProps);n.componentDidUpdate(a,r.memoizedState,n.__reactInternalSnapshotBeforeUpdate)}var i=t.updateQueue;i!==null&&Qw(t,i,n);break;case 3:var o=t.updateQueue;if(o!==null){if(r=null,t.child!==null)switch(t.child.tag){case 5:r=t.child.stateNode;break;case 1:r=t.child.stateNode}Qw(t,o,r)}break;case 5:var s=t.stateNode;if(r===null&&t.flags&4){r=s;var l=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":l.autoFocus&&r.focus();break;case"img":l.src&&(r.src=l.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(t.memoizedState===null){var u=t.alternate;if(u!==null){var d=u.memoizedState;if(d!==null){var f=d.dehydrated;f!==null&&pf(f)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(Re(163))}Ta||t.flags&512&&Jx(t)}catch(h){An(t,t.return,h)}}if(t===e){st=null;break}if(r=t.sibling,r!==null){r.return=t.return,st=r;break}st=t.return}}function mk(e){for(;st!==null;){var t=st;if(t===e){st=null;break}var r=t.sibling;if(r!==null){r.return=t.return,st=r;break}st=t.return}}function yk(e){for(;st!==null;){var t=st;try{switch(t.tag){case 0:case 11:case 15:var r=t.return;try{Tg(4,t)}catch(l){An(t,r,l)}break;case 1:var n=t.stateNode;if(typeof n.componentDidMount=="function"){var a=t.return;try{n.componentDidMount()}catch(l){An(t,a,l)}}var i=t.return;try{Jx(t)}catch(l){An(t,i,l)}break;case 5:var o=t.return;try{Jx(t)}catch(l){An(t,o,l)}}}catch(l){An(t,t.return,l)}if(t===e){st=null;break}var s=t.sibling;if(s!==null){s.return=t.return,st=s;break}st=t.return}}var tT=Math.ceil,lp=gs.ReactCurrentDispatcher,Mb=gs.ReactCurrentOwner,Di=gs.ReactCurrentBatchConfig,Dr=0,fa=null,Hn=null,Sa=0,mi=0,Vc=ol(0),na=0,Pf=null,Ql=0,Eg=0,Nb=0,Zd=null,ti=null,Ob=0,fu=1/0,Zo=null,cp=!1,tv=null,Zs=null,Q0=!1,Rs=null,up=0,Jd=0,rv=null,Dh=-1,Rh=0;function Ya(){return Dr&6?In():Dh!==-1?Dh:Dh=In()}function Js(e){return e.mode&1?Dr&2&&Sa!==0?Sa&-Sa:BA.transition!==null?(Rh===0&&(Rh=Gj()),Rh):(e=Qr,e!==0||(e=window.event,e=e===void 0?16:Kj(e.type)),e):1}function co(e,t,r,n){if(50<Jd)throw Jd=0,rv=null,Error(Re(185));d0(e,r,n),(!(Dr&2)||e!==fa)&&(e===fa&&(!(Dr&2)&&(Eg|=r),na===4&&Is(e,Sa)),si(e,n),r===1&&Dr===0&&!(t.mode&1)&&(fu=In()+500,Ng&&sl()))}function si(e,t){var r=e.callbackNode;B6(e,t);var n=Xh(e,e===fa?Sa:0);if(n===0)r!==null&&_w(r),e.callbackNode=null,e.callbackPriority=0;else if(t=n&-n,e.callbackPriority!==t){if(r!=null&&_w(r),t===1)e.tag===0?RA(xk.bind(null,e)):hP(xk.bind(null,e)),EA(function(){!(Dr&6)&&sl()}),r=null;else{switch(Uj(n)){case 1:r=rb;break;case 4:r=Lj;break;case 16:r=Vh;break;case 536870912:r=Fj;break;default:r=Vh}r=d_(r,a_.bind(null,e))}e.callbackPriority=t,e.callbackNode=r}}function a_(e,t){if(Dh=-1,Rh=0,Dr&6)throw Error(Re(327));var r=e.callbackNode;if(tu()&&e.callbackNode!==r)return null;var n=Xh(e,e===fa?Sa:0);if(n===0)return null;if(n&30||n&e.expiredLanes||t)t=dp(e,n);else{t=n;var a=Dr;Dr|=2;var i=o_();(fa!==e||Sa!==t)&&(Zo=null,fu=In()+500,Wl(e,t));do try{aT();break}catch(s){i_(e,s)}while(!0);gb(),lp.current=i,Dr=a,Hn!==null?t=0:(fa=null,Sa=0,t=na)}if(t!==0){if(t===2&&(a=Nx(e),a!==0&&(n=a,t=nv(e,a))),t===1)throw r=Pf,Wl(e,0),Is(e,n),si(e,In()),r;if(t===6)Is(e,n);else{if(a=e.current.alternate,!(n&30)&&!rT(a)&&(t=dp(e,n),t===2&&(i=Nx(e),i!==0&&(n=i,t=nv(e,i))),t===1))throw r=Pf,Wl(e,0),Is(e,n),si(e,In()),r;switch(e.finishedWork=a,e.finishedLanes=n,t){case 0:case 1:throw Error(Re(345));case 2:Ml(e,ti,Zo);break;case 3:if(Is(e,n),(n&130023424)===n&&(t=Ob+500-In(),10<t)){if(Xh(e,0)!==0)break;if(a=e.suspendedLanes,(a&n)!==n){Ya(),e.pingedLanes|=e.suspendedLanes&a;break}e.timeoutHandle=Rx(Ml.bind(null,e,ti,Zo),t);break}Ml(e,ti,Zo);break;case 4:if(Is(e,n),(n&4194240)===n)break;for(t=e.eventTimes,a=-1;0<n;){var o=31-lo(n);i=1<<o,o=t[o],o>a&&(a=o),n&=~i}if(n=a,n=In()-n,n=(120>n?120:480>n?480:1080>n?1080:1920>n?1920:3e3>n?3e3:4320>n?4320:1960*tT(n/1960))-n,10<n){e.timeoutHandle=Rx(Ml.bind(null,e,ti,Zo),n);break}Ml(e,ti,Zo);break;case 5:Ml(e,ti,Zo);break;default:throw Error(Re(329))}}}return si(e,In()),e.callbackNode===r?a_.bind(null,e):null}function nv(e,t){var r=Zd;return e.current.memoizedState.isDehydrated&&(Wl(e,t).flags|=256),e=dp(e,t),e!==2&&(t=ti,ti=r,t!==null&&av(t)),e}function av(e){ti===null?ti=e:ti.push.apply(ti,e)}function rT(e){for(var t=e;;){if(t.flags&16384){var r=t.updateQueue;if(r!==null&&(r=r.stores,r!==null))for(var n=0;n<r.length;n++){var a=r[n],i=a.getSnapshot;a=a.value;try{if(!uo(i(),a))return!1}catch{return!1}}}if(r=t.child,t.subtreeFlags&16384&&r!==null)r.return=t,t=r;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function Is(e,t){for(t&=~Nb,t&=~Eg,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var r=31-lo(t),n=1<<r;e[r]=-1,t&=~n}}function xk(e){if(Dr&6)throw Error(Re(327));tu();var t=Xh(e,0);if(!(t&1))return si(e,In()),null;var r=dp(e,t);if(e.tag!==0&&r===2){var n=Nx(e);n!==0&&(t=n,r=nv(e,n))}if(r===1)throw r=Pf,Wl(e,0),Is(e,t),si(e,In()),r;if(r===6)throw Error(Re(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,Ml(e,ti,Zo),si(e,In()),null}function Ab(e,t){var r=Dr;Dr|=1;try{return e(t)}finally{Dr=r,Dr===0&&(fu=In()+500,Ng&&sl())}}function ec(e){Rs!==null&&Rs.tag===0&&!(Dr&6)&&tu();var t=Dr;Dr|=1;var r=Di.transition,n=Qr;try{if(Di.transition=null,Qr=1,e)return e()}finally{Qr=n,Di.transition=r,Dr=t,!(Dr&6)&&sl()}}function Tb(){mi=Vc.current,gn(Vc)}function Wl(e,t){e.finishedWork=null,e.finishedLanes=0;var r=e.timeoutHandle;if(r!==-1&&(e.timeoutHandle=-1,TA(r)),Hn!==null)for(r=Hn.return;r!==null;){var n=r;switch(fb(n),n.tag){case 1:n=n.type.childContextTypes,n!=null&&Jh();break;case 3:uu(),gn(ii),gn($a),wb();break;case 5:bb(n);break;case 4:uu();break;case 13:gn(_n);break;case 19:gn(_n);break;case 10:mb(n.type._context);break;case 22:case 23:Tb()}r=r.return}if(fa=e,Hn=e=Qs(e.current,null),Sa=mi=t,na=0,Pf=null,Nb=Eg=Ql=0,ti=Zd=null,El!==null){for(t=0;t<El.length;t++)if(r=El[t],n=r.interleaved,n!==null){r.interleaved=null;var a=n.next,i=r.pending;if(i!==null){var o=i.next;i.next=a,n.next=o}r.pending=n}El=null}return e}function i_(e,t){do{var r=Hn;try{if(gb(),Eh.current=sp,op){for(var n=Cn.memoizedState;n!==null;){var a=n.queue;a!==null&&(a.pending=null),n=n.next}op=!1}if(Jl=0,da=ta=Cn=null,Yd=!1,kf=0,Mb.current=null,r===null||r.return===null){na=1,Pf=t,Hn=null;break}e:{var i=e,o=r.return,s=r,l=t;if(t=Sa,s.flags|=32768,l!==null&&typeof l=="object"&&typeof l.then=="function"){var u=l,d=s,f=d.tag;if(!(d.mode&1)&&(f===0||f===11||f===15)){var h=d.alternate;h?(d.updateQueue=h.updateQueue,d.memoizedState=h.memoizedState,d.lanes=h.lanes):(d.updateQueue=null,d.memoizedState=null)}var g=ik(o);if(g!==null){g.flags&=-257,ok(g,o,s,i,t),g.mode&1&&ak(i,u,t),t=g,l=u;var b=t.updateQueue;if(b===null){var w=new Set;w.add(l),t.updateQueue=w}else b.add(l);break e}else{if(!(t&1)){ak(i,u,t),Eb();break e}l=Error(Re(426))}}else if(bn&&s.mode&1){var v=ik(o);if(v!==null){!(v.flags&65536)&&(v.flags|=256),ok(v,o,s,i,t),hb(du(l,s));break e}}i=l=du(l,s),na!==4&&(na=2),Zd===null?Zd=[i]:Zd.push(i),i=o;do{switch(i.tag){case 3:i.flags|=65536,t&=-t,i.lanes|=t;var x=UP(i,l,t);Jw(i,x);break e;case 1:s=l;var m=i.type,k=i.stateNode;if(!(i.flags&128)&&(typeof m.getDerivedStateFromError=="function"||k!==null&&typeof k.componentDidCatch=="function"&&(Zs===null||!Zs.has(k)))){i.flags|=65536,t&=-t,i.lanes|=t;var P=zP(i,s,t);Jw(i,P);break e}}i=i.return}while(i!==null)}l_(r)}catch(j){t=j,Hn===r&&r!==null&&(Hn=r=r.return);continue}break}while(!0)}function o_(){var e=lp.current;return lp.current=sp,e===null?sp:e}function Eb(){(na===0||na===3||na===2)&&(na=4),fa===null||!(Ql&268435455)&&!(Eg&268435455)||Is(fa,Sa)}function dp(e,t){var r=Dr;Dr|=2;var n=o_();(fa!==e||Sa!==t)&&(Zo=null,Wl(e,t));do try{nT();break}catch(a){i_(e,a)}while(!0);if(gb(),Dr=r,lp.current=n,Hn!==null)throw Error(Re(261));return fa=null,Sa=0,na}function nT(){for(;Hn!==null;)s_(Hn)}function aT(){for(;Hn!==null&&!N6();)s_(Hn)}function s_(e){var t=u_(e.alternate,e,mi);e.memoizedProps=e.pendingProps,t===null?l_(e):Hn=t,Mb.current=null}function l_(e){var t=e;do{var r=t.alternate;if(e=t.return,t.flags&32768){if(r=ZA(r,t),r!==null){r.flags&=32767,Hn=r;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{na=6,Hn=null;return}}else if(r=qA(r,t,mi),r!==null){Hn=r;return}if(t=t.sibling,t!==null){Hn=t;return}Hn=t=e}while(t!==null);na===0&&(na=5)}function Ml(e,t,r){var n=Qr,a=Di.transition;try{Di.transition=null,Qr=1,iT(e,t,r,n)}finally{Di.transition=a,Qr=n}return null}function iT(e,t,r,n){do tu();while(Rs!==null);if(Dr&6)throw Error(Re(327));r=e.finishedWork;var a=e.finishedLanes;if(r===null)return null;if(e.finishedWork=null,e.finishedLanes=0,r===e.current)throw Error(Re(177));e.callbackNode=null,e.callbackPriority=0;var i=r.lanes|r.childLanes;if(L6(e,i),e===fa&&(Hn=fa=null,Sa=0),!(r.subtreeFlags&2064)&&!(r.flags&2064)||Q0||(Q0=!0,d_(Vh,function(){return tu(),null})),i=(r.flags&15990)!==0,r.subtreeFlags&15990||i){i=Di.transition,Di.transition=null;var o=Qr;Qr=1;var s=Dr;Dr|=4,Mb.current=null,QA(e,r),r_(r,e),PA($x),Kh=!!Ix,$x=Ix=null,e.current=r,eT(r),O6(),Dr=s,Qr=o,Di.transition=i}else e.current=r;if(Q0&&(Q0=!1,Rs=e,up=a),i=e.pendingLanes,i===0&&(Zs=null),E6(r.stateNode),si(e,In()),t!==null)for(n=e.onRecoverableError,r=0;r<t.length;r++)a=t[r],n(a.value,{componentStack:a.stack,digest:a.digest});if(cp)throw cp=!1,e=tv,tv=null,e;return up&1&&e.tag!==0&&tu(),i=e.pendingLanes,i&1?e===rv?Jd++:(Jd=0,rv=e):Jd=0,sl(),null}function tu(){if(Rs!==null){var e=Uj(up),t=Di.transition,r=Qr;try{if(Di.transition=null,Qr=16>e?16:e,Rs===null)var n=!1;else{if(e=Rs,Rs=null,up=0,Dr&6)throw Error(Re(331));var a=Dr;for(Dr|=4,st=e.current;st!==null;){var i=st,o=i.child;if(st.flags&16){var s=i.deletions;if(s!==null){for(var l=0;l<s.length;l++){var u=s[l];for(st=u;st!==null;){var d=st;switch(d.tag){case 0:case 11:case 15:qd(8,d,i)}var f=d.child;if(f!==null)f.return=d,st=f;else for(;st!==null;){d=st;var h=d.sibling,g=d.return;if(QP(d),d===u){st=null;break}if(h!==null){h.return=g,st=h;break}st=g}}}var b=i.alternate;if(b!==null){var w=b.child;if(w!==null){b.child=null;do{var v=w.sibling;w.sibling=null,w=v}while(w!==null)}}st=i}}if(i.subtreeFlags&2064&&o!==null)o.return=i,st=o;else e:for(;st!==null;){if(i=st,i.flags&2048)switch(i.tag){case 0:case 11:case 15:qd(9,i,i.return)}var x=i.sibling;if(x!==null){x.return=i.return,st=x;break e}st=i.return}}var m=e.current;for(st=m;st!==null;){o=st;var k=o.child;if(o.subtreeFlags&2064&&k!==null)k.return=o,st=k;else e:for(o=m;st!==null;){if(s=st,s.flags&2048)try{switch(s.tag){case 0:case 11:case 15:Tg(9,s)}}catch(j){An(s,s.return,j)}if(s===o){st=null;break e}var P=s.sibling;if(P!==null){P.return=s.return,st=P;break e}st=s.return}}if(Dr=a,sl(),No&&typeof No.onPostCommitFiberRoot=="function")try{No.onPostCommitFiberRoot(jg,e)}catch{}n=!0}return n}finally{Qr=r,Di.transition=t}}return!1}function vk(e,t,r){t=du(r,t),t=UP(e,t,1),e=qs(e,t,1),t=Ya(),e!==null&&(d0(e,1,t),si(e,t))}function An(e,t,r){if(e.tag===3)vk(e,e,r);else for(;t!==null;){if(t.tag===3){vk(t,e,r);break}else if(t.tag===1){var n=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof n.componentDidCatch=="function"&&(Zs===null||!Zs.has(n))){e=du(r,e),e=zP(t,e,1),t=qs(t,e,1),e=Ya(),t!==null&&(d0(t,1,e),si(t,e));break}}t=t.return}}function oT(e,t,r){var n=e.pingCache;n!==null&&n.delete(t),t=Ya(),e.pingedLanes|=e.suspendedLanes&r,fa===e&&(Sa&r)===r&&(na===4||na===3&&(Sa&130023424)===Sa&&500>In()-Ob?Wl(e,0):Nb|=r),si(e,t)}function c_(e,t){t===0&&(e.mode&1?(t=z0,z0<<=1,!(z0&130023424)&&(z0=4194304)):t=1);var r=Ya();e=us(e,t),e!==null&&(d0(e,t,r),si(e,r))}function sT(e){var t=e.memoizedState,r=0;t!==null&&(r=t.retryLane),c_(e,r)}function lT(e,t){var r=0;switch(e.tag){case 13:var n=e.stateNode,a=e.memoizedState;a!==null&&(r=a.retryLane);break;case 19:n=e.stateNode;break;default:throw Error(Re(314))}n!==null&&n.delete(t),c_(e,r)}var u_;u_=function(e,t,r){if(e!==null)if(e.memoizedProps!==t.pendingProps||ii.current)ni=!0;else{if(!(e.lanes&r)&&!(t.flags&128))return ni=!1,YA(e,t,r);ni=!!(e.flags&131072)}else ni=!1,bn&&t.flags&1048576&&pP(t,tp,t.index);switch(t.lanes=0,t.tag){case 2:var n=t.type;$h(e,t),e=t.pendingProps;var a=su(t,$a.current);eu(t,r),a=Sb(null,t,n,e,a,r);var i=jb();return t.flags|=1,typeof a=="object"&&a!==null&&typeof a.render=="function"&&a.$$typeof===void 0?(t.tag=1,t.memoizedState=null,t.updateQueue=null,oi(n)?(i=!0,Qh(t)):i=!1,t.memoizedState=a.state!==null&&a.state!==void 0?a.state:null,xb(t),a.updater=Ag,t.stateNode=a,a._reactInternals=t,Wx(t,n,e,r),t=Xx(null,t,n,!0,i,r)):(t.tag=0,bn&&i&&db(t),Wa(null,t,a,r),t=t.child),t;case 16:n=t.elementType;e:{switch($h(e,t),e=t.pendingProps,a=n._init,n=a(n._payload),t.type=n,a=t.tag=uT(n),e=Ji(n,e),a){case 0:t=Vx(null,t,n,e,r);break e;case 1:t=ck(null,t,n,e,r);break e;case 11:t=sk(null,t,n,e,r);break e;case 14:t=lk(null,t,n,Ji(n.type,e),r);break e}throw Error(Re(306,n,""))}return t;case 0:return n=t.type,a=t.pendingProps,a=t.elementType===n?a:Ji(n,a),Vx(e,t,n,a,r);case 1:return n=t.type,a=t.pendingProps,a=t.elementType===n?a:Ji(n,a),ck(e,t,n,a,r);case 3:e:{if(XP(t),e===null)throw Error(Re(387));n=t.pendingProps,i=t.memoizedState,a=i.element,bP(e,t),ap(t,n,null,r);var o=t.memoizedState;if(n=o.element,i.isDehydrated)if(i={element:n,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},t.updateQueue.baseState=i,t.memoizedState=i,t.flags&256){a=du(Error(Re(423)),t),t=uk(e,t,n,r,a);break e}else if(n!==a){a=du(Error(Re(424)),t),t=uk(e,t,n,r,a);break e}else for(vi=Ys(t.stateNode.containerInfo.firstChild),bi=t,bn=!0,no=null,r=xP(t,null,n,r),t.child=r;r;)r.flags=r.flags&-3|4096,r=r.sibling;else{if(lu(),n===a){t=ds(e,t,r);break e}Wa(e,t,n,r)}t=t.child}return t;case 5:return wP(t),e===null&&Gx(t),n=t.type,a=t.pendingProps,i=e!==null?e.memoizedProps:null,o=a.children,Dx(n,a)?o=null:i!==null&&Dx(n,i)&&(t.flags|=32),VP(e,t),Wa(e,t,o,r),t.child;case 6:return e===null&&Gx(t),null;case 13:return KP(e,t,r);case 4:return vb(t,t.stateNode.containerInfo),n=t.pendingProps,e===null?t.child=cu(t,null,n,r):Wa(e,t,n,r),t.child;case 11:return n=t.type,a=t.pendingProps,a=t.elementType===n?a:Ji(n,a),sk(e,t,n,a,r);case 7:return Wa(e,t,t.pendingProps,r),t.child;case 8:return Wa(e,t,t.pendingProps.children,r),t.child;case 12:return Wa(e,t,t.pendingProps.children,r),t.child;case 10:e:{if(n=t.type._context,a=t.pendingProps,i=t.memoizedProps,o=a.value,un(rp,n._currentValue),n._currentValue=o,i!==null)if(uo(i.value,o)){if(i.children===a.children&&!ii.current){t=ds(e,t,r);break e}}else for(i=t.child,i!==null&&(i.return=t);i!==null;){var s=i.dependencies;if(s!==null){o=i.child;for(var l=s.firstContext;l!==null;){if(l.context===n){if(i.tag===1){l=as(-1,r&-r),l.tag=2;var u=i.updateQueue;if(u!==null){u=u.shared;var d=u.pending;d===null?l.next=l:(l.next=d.next,d.next=l),u.pending=l}}i.lanes|=r,l=i.alternate,l!==null&&(l.lanes|=r),Ux(i.return,r,t),s.lanes|=r;break}l=l.next}}else if(i.tag===10)o=i.type===t.type?null:i.child;else if(i.tag===18){if(o=i.return,o===null)throw Error(Re(341));o.lanes|=r,s=o.alternate,s!==null&&(s.lanes|=r),Ux(o,r,t),o=i.sibling}else o=i.child;if(o!==null)o.return=i;else for(o=i;o!==null;){if(o===t){o=null;break}if(i=o.sibling,i!==null){i.return=o.return,o=i;break}o=o.return}i=o}Wa(e,t,a.children,r),t=t.child}return t;case 9:return a=t.type,n=t.pendingProps.children,eu(t,r),a=Bi(a),n=n(a),t.flags|=1,Wa(e,t,n,r),t.child;case 14:return n=t.type,a=Ji(n,t.pendingProps),a=Ji(n.type,a),lk(e,t,n,a,r);case 15:return WP(e,t,t.type,t.pendingProps,r);case 17:return n=t.type,a=t.pendingProps,a=t.elementType===n?a:Ji(n,a),$h(e,t),t.tag=1,oi(n)?(e=!0,Qh(t)):e=!1,eu(t,r),GP(t,n,a),Wx(t,n,a,r),Xx(null,t,n,!0,e,r);case 19:return YP(e,t,r);case 22:return HP(e,t,r)}throw Error(Re(156,t.tag))};function d_(e,t){return Bj(e,t)}function cT(e,t,r,n){this.tag=e,this.key=r,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=n,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Ei(e,t,r,n){return new cT(e,t,r,n)}function Ib(e){return e=e.prototype,!(!e||!e.isReactComponent)}function uT(e){if(typeof e=="function")return Ib(e)?1:0;if(e!=null){if(e=e.$$typeof,e===Q1)return 11;if(e===eb)return 14}return 2}function Qs(e,t){var r=e.alternate;return r===null?(r=Ei(e.tag,t,e.key,e.mode),r.elementType=e.elementType,r.type=e.type,r.stateNode=e.stateNode,r.alternate=e,e.alternate=r):(r.pendingProps=t,r.type=e.type,r.flags=0,r.subtreeFlags=0,r.deletions=null),r.flags=e.flags&14680064,r.childLanes=e.childLanes,r.lanes=e.lanes,r.child=e.child,r.memoizedProps=e.memoizedProps,r.memoizedState=e.memoizedState,r.updateQueue=e.updateQueue,t=e.dependencies,r.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},r.sibling=e.sibling,r.index=e.index,r.ref=e.ref,r}function Bh(e,t,r,n,a,i){var o=2;if(n=e,typeof e=="function")Ib(e)&&(o=1);else if(typeof e=="string")o=5;else e:switch(e){case Dc:return Hl(r.children,a,i,t);case J1:o=8,a|=8;break;case px:return e=Ei(12,r,t,a|2),e.elementType=px,e.lanes=i,e;case gx:return e=Ei(13,r,t,a),e.elementType=gx,e.lanes=i,e;case mx:return e=Ei(19,r,t,a),e.elementType=mx,e.lanes=i,e;case wj:return Ig(r,a,i,t);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case vj:o=10;break e;case bj:o=9;break e;case Q1:o=11;break e;case eb:o=14;break e;case Ns:o=16,n=null;break e}throw Error(Re(130,e==null?e:typeof e,""))}return t=Ei(o,r,t,a),t.elementType=e,t.type=n,t.lanes=i,t}function Hl(e,t,r,n){return e=Ei(7,e,n,t),e.lanes=r,e}function Ig(e,t,r,n){return e=Ei(22,e,n,t),e.elementType=wj,e.lanes=r,e.stateNode={isHidden:!1},e}function vy(e,t,r){return e=Ei(6,e,null,t),e.lanes=r,e}function by(e,t,r){return t=Ei(4,e.children!==null?e.children:[],e.key,t),t.lanes=r,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function dT(e,t,r,n,a){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=ey(0),this.expirationTimes=ey(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=ey(0),this.identifierPrefix=n,this.onRecoverableError=a,this.mutableSourceEagerHydrationData=null}function $b(e,t,r,n,a,i,o,s,l){return e=new dT(e,t,r,s,l),t===1?(t=1,i===!0&&(t|=8)):t=0,i=Ei(3,null,null,t),e.current=i,i.stateNode=e,i.memoizedState={element:n,isDehydrated:r,cache:null,transitions:null,pendingSuspenseBoundaries:null},xb(i),e}function fT(e,t,r){var n=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:$c,key:n==null?null:""+n,children:e,containerInfo:t,implementation:r}}function f_(e){if(!e)return al;e=e._reactInternals;e:{if(gc(e)!==e||e.tag!==1)throw Error(Re(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(oi(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(t!==null);throw Error(Re(171))}if(e.tag===1){var r=e.type;if(oi(r))return fP(e,r,t)}return t}function h_(e,t,r,n,a,i,o,s,l){return e=$b(r,n,!0,e,a,i,o,s,l),e.context=f_(null),r=e.current,n=Ya(),a=Js(r),i=as(n,a),i.callback=t??null,qs(r,i,a),e.current.lanes=a,d0(e,a,n),si(e,n),e}function $g(e,t,r,n){var a=t.current,i=Ya(),o=Js(a);return r=f_(r),t.context===null?t.context=r:t.pendingContext=r,t=as(i,o),t.payload={element:e},n=n===void 0?null:n,n!==null&&(t.callback=n),e=qs(a,t,o),e!==null&&(co(e,a,o,i),Th(e,a,o)),o}function fp(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function bk(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var r=e.retryLane;e.retryLane=r!==0&&r<t?r:t}}function Db(e,t){bk(e,t),(e=e.alternate)&&bk(e,t)}function hT(){return null}var p_=typeof reportError=="function"?reportError:function(e){console.error(e)};function Rb(e){this._internalRoot=e}Dg.prototype.render=Rb.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(Re(409));$g(e,t,null,null)};Dg.prototype.unmount=Rb.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;ec(function(){$g(null,e,null,null)}),t[cs]=null}};function Dg(e){this._internalRoot=e}Dg.prototype.unstable_scheduleHydration=function(e){if(e){var t=Hj();e={blockedOn:null,target:e,priority:t};for(var r=0;r<Es.length&&t!==0&&t<Es[r].priority;r++);Es.splice(r,0,e),r===0&&Xj(e)}};function Bb(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function Rg(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function wk(){}function pT(e,t,r,n,a){if(a){if(typeof n=="function"){var i=n;n=function(){var u=fp(o);i.call(u)}}var o=h_(t,n,e,0,null,!1,!1,"",wk);return e._reactRootContainer=o,e[cs]=o.current,yf(e.nodeType===8?e.parentNode:e),ec(),o}for(;a=e.lastChild;)e.removeChild(a);if(typeof n=="function"){var s=n;n=function(){var u=fp(l);s.call(u)}}var l=$b(e,0,!1,null,null,!1,!1,"",wk);return e._reactRootContainer=l,e[cs]=l.current,yf(e.nodeType===8?e.parentNode:e),ec(function(){$g(t,l,r,n)}),l}function Bg(e,t,r,n,a){var i=r._reactRootContainer;if(i){var o=i;if(typeof a=="function"){var s=a;a=function(){var l=fp(o);s.call(l)}}$g(t,o,e,a)}else o=pT(r,t,e,a,n);return fp(o)}zj=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var r=Gd(t.pendingLanes);r!==0&&(nb(t,r|1),si(t,In()),!(Dr&6)&&(fu=In()+500,sl()))}break;case 13:ec(function(){var n=us(e,1);if(n!==null){var a=Ya();co(n,e,1,a)}}),Db(e,1)}};ab=function(e){if(e.tag===13){var t=us(e,134217728);if(t!==null){var r=Ya();co(t,e,134217728,r)}Db(e,134217728)}};Wj=function(e){if(e.tag===13){var t=Js(e),r=us(e,t);if(r!==null){var n=Ya();co(r,e,t,n)}Db(e,t)}};Hj=function(){return Qr};Vj=function(e,t){var r=Qr;try{return Qr=e,t()}finally{Qr=r}};_x=function(e,t,r){switch(t){case"input":if(vx(e,r),t=r.name,r.type==="radio"&&t!=null){for(r=e;r.parentNode;)r=r.parentNode;for(r=r.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<r.length;t++){var n=r[t];if(n!==e&&n.form===e.form){var a=Mg(n);if(!a)throw Error(Re(90));Sj(n),vx(n,a)}}}break;case"textarea":Pj(e,r);break;case"select":t=r.value,t!=null&&qc(e,!!r.multiple,t,!1)}};Tj=Ab;Ej=ec;var gT={usingClientEntryPoint:!1,Events:[h0,Fc,Mg,Oj,Aj,Ab]},Pd={findFiberByHostInstance:Tl,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},mT={bundleType:Pd.bundleType,version:Pd.version,rendererPackageName:Pd.rendererPackageName,rendererConfig:Pd.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:gs.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=Dj(e),e===null?null:e.stateNode},findFiberByHostInstance:Pd.findFiberByHostInstance||hT,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var eh=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!eh.isDisabled&&eh.supportsFiber)try{jg=eh.inject(mT),No=eh}catch{}}ki.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=gT;ki.createPortal=function(e,t){var r=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Bb(t))throw Error(Re(200));return fT(e,t,null,r)};ki.createRoot=function(e,t){if(!Bb(e))throw Error(Re(299));var r=!1,n="",a=p_;return t!=null&&(t.unstable_strictMode===!0&&(r=!0),t.identifierPrefix!==void 0&&(n=t.identifierPrefix),t.onRecoverableError!==void 0&&(a=t.onRecoverableError)),t=$b(e,1,!1,null,null,r,!1,n,a),e[cs]=t.current,yf(e.nodeType===8?e.parentNode:e),new Rb(t)};ki.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(Re(188)):(e=Object.keys(e).join(","),Error(Re(268,e)));return e=Dj(t),e=e===null?null:e.stateNode,e};ki.flushSync=function(e){return ec(e)};ki.hydrate=function(e,t,r){if(!Rg(t))throw Error(Re(200));return Bg(null,e,t,!0,r)};ki.hydrateRoot=function(e,t,r){if(!Bb(e))throw Error(Re(405));var n=r!=null&&r.hydratedSources||null,a=!1,i="",o=p_;if(r!=null&&(r.unstable_strictMode===!0&&(a=!0),r.identifierPrefix!==void 0&&(i=r.identifierPrefix),r.onRecoverableError!==void 0&&(o=r.onRecoverableError)),t=h_(t,null,e,1,r??null,a,!1,i,o),e[cs]=t.current,yf(e),n)for(e=0;e<n.length;e++)r=n[e],a=r._getVersion,a=a(r._source),t.mutableSourceEagerHydrationData==null?t.mutableSourceEagerHydrationData=[r,a]:t.mutableSourceEagerHydrationData.push(r,a);return new Dg(t)};ki.render=function(e,t,r){if(!Rg(t))throw Error(Re(200));return Bg(null,e,t,!1,r)};ki.unmountComponentAtNode=function(e){if(!Rg(e))throw Error(Re(40));return e._reactRootContainer?(ec(function(){Bg(null,null,e,!1,function(){e._reactRootContainer=null,e[cs]=null})}),!0):!1};ki.unstable_batchedUpdates=Ab;ki.unstable_renderSubtreeIntoContainer=function(e,t,r,n){if(!Rg(r))throw Error(Re(200));if(e==null||e._reactInternals===void 0)throw Error(Re(38));return Bg(e,t,r,!1,n)};ki.version="18.3.1-next-f1338f8080-20240426";function g_(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(g_)}catch(e){console.error(e)}}g_(),gj.exports=ki;var yT=gj.exports,kk=yT;fx.createRoot=kk.createRoot,fx.hydrateRoot=kk.hydrateRoot;const el=({isOpen:e,onClose:t,onConfirm:r,title:n,message:a,confirmText:i="I know the risk and insist to continue",cancelText:o="Cancel"})=>e?c.jsx("div",{className:"fixed inset-0 z-[100] flex items-center justify-center bg-black/60 backdrop-blur-sm p-4 animate-in fade-in duration-200",children:c.jsxs("div",{className:"bg-white dark:bg-slate-900 w-full max-w-md rounded-2xl shadow-2xl border border-amber-500/30 overflow-hidden transform transition-all scale-100",children:[c.jsxs("div",{className:"bg-amber-500/10 p-6 flex flex-col items-center justify-center border-b border-amber-500/20",children:[c.jsx("div",{className:"w-16 h-16 bg-amber-100 dark:bg-amber-900/30 rounded-full flex items-center justify-center mb-4",children:c.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-10 w-10 text-amber-600 dark:text-amber-500",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})})}),c.jsx("h3",{className:"text-xl font-bold text-gray-900 dark:text-white text-center",children:n})]}),c.jsx("div",{className:"p-6",children:c.jsx("div",{className:"text-gray-600 dark:text-slate-300 text-center text-sm leading-relaxed",children:a})}),c.jsxs("div",{className:"p-4 bg-gray-50 dark:bg-slate-800/50 flex gap-3 justify-end border-t border-gray-200 dark:border-slate-800",children:[c.jsx("button",{onClick:t,className:"px-4 py-2 bg-white hover:bg-gray-100 dark:bg-slate-700 dark:hover:bg-slate-600 text-gray-700 dark:text-slate-200 font-semibold rounded-lg border border-gray-300 dark:border-slate-600 transition-colors text-sm",children:o}),c.jsx("button",{onClick:r,className:"px-4 py-2 bg-amber-600 hover:bg-amber-700 text-white font-bold rounded-lg shadow-lg shadow-amber-500/20 transition-all active:scale-95 text-sm",children:i})]})]})}):null,xT=({onFileSelected:e,onGenerateFakeDng:t,fileName:r,hasGeneratedData:n,viewMode:a,onSetViewMode:i,patternPeriod:o,onPatternPeriodChange:s,fillFactor:l,onFillFactorChange:u,patternPhase:d,onPatternPhaseChange:f,showPatternControls:h,onOpenAbout:g,onShowExif:b,bridgeStatus:w,onBridgeClick:v,isDrLabOpen:x,onToggleDrLab:m,isColorLabOpen:k,onToggleColorLab:P,isFftLabOpen:j,onToggleFftLab:S,isSfrLabOpen:M,onToggleSfrLab:O,onGenerateTestPic:E,onPTCFilesSelected:I,onDownloadDng:D,isThreePlane:B,onOpenDatabase:z,isSidebarOpen:Y,onToggleSidebar:G,onOpenSaveZ8:$,isPsModeOpen:L,onTogglePsMode:U})=>{const V=_.useRef(null),J=_.useRef(null),[K,Q]=_.useState(!1),[te,ee]=_.useState(!1),[me,re]=_.useState(!1),[De,fe]=_.useState("direct"),le=_.useRef(null),de=_.useRef(null);_.useEffect(()=>{const ve=ye=>{le.current&&!le.current.contains(ye.target)&&ee(!1),de.current&&!de.current.contains(ye.target)&&re(!1)};return document.addEventListener("mousedown",ve),()=>document.removeEventListener("mousedown",ve)},[]);const Se=ve=>{var ye,ge;ee(!1),ve==="direct"?(fe("direct"),(ye=V.current)==null||ye.click()):!w.isConnected||!w.hasDngConverter?Q(!0):(fe("convert"),(ge=V.current)==null||ge.click())},he=ve=>{var ge;const ye=(ge=ve.target.files)==null?void 0:ge[0];ye&&e(ye,De),ve.target.value=""},Pe=ve=>{ve.target.files&&ve.target.files.length>0&&I(ve.target.files),ve.target.value=""};return r==="pattern_test.dng"||(r==null||r.startsWith("Diff_")),c.jsxs("header",{className:"flex flex-col sm:flex-row justify-between items-center gap-4 mb-4 flex-shrink-0 relative z-50 font-mono",children:[c.jsx(el,{isOpen:K,onClose:()=>Q(!1),onConfirm:()=>Q(!1),title:"DNG Converter Missing",confirmText:"OK",cancelText:"Cancel",message:c.jsxs("div",{className:"flex flex-col gap-4",children:[c.jsx("p",{className:"font-bold text-red-600 dark:text-red-400 text-base",children:"JiangBridge Offline or Adobe DNG Converter not installed"}),c.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"To use the conversion feature, you must run JiangBridge locally and have Adobe DNG Converter installed on your system."})]})}),c.jsxs("div",{className:"flex items-center gap-4",children:[c.jsx("h1",{className:"text-xl sm:text-2xl font-bold text-black dark:text-white text-center sm:text-left tracking-tight border-2 border-black dark:border-white px-2 py-1 bg-white dark:bg-black",children:"Jiangtherapee_Online"}),c.jsx("p",{className:"text-sm text-gray-600 dark:text-slate-400 hidden lg:block max-w-xs truncate font-bold",title:r||"No image loaded",children:r||"No_Image_Loaded"}),B&&c.jsx("span",{className:"bg-red-100 text-red-700 dark:bg-red-900/30 dark:text-red-400 border-2 border-red-500 dark:border-red-800 text-[10px] font-bold px-2 py-1 animate-pulse",children:" 3-PLANE / RGB MODE"})]}),c.jsxs("div",{className:"flex items-center gap-4 flex-wrap justify-end",children:[c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsxs("button",{onClick:w.isConnected?void 0:v,className:`px-3 py-1.5 text-xs font-bold transition-all duration-200 flex items-center gap-1.5 shadow-[2px_2px_0px_black] border-2 border-black dark:border-gray-500 ${w.isConnected?"bg-emerald-100 text-emerald-900 border-emerald-800 dark:bg-emerald-900/30 dark:text-emerald-400 dark:border-emerald-600 cursor-default":"bg-pink-100 text-pink-900 border-pink-800 dark:bg-pink-900/30 dark:text-pink-400 dark:border-pink-600 hover:bg-pink-200 dark:hover:bg-pink-900/50 cursor-pointer animate-pulse"}`,title:w.isConnected?"Local Bridge Service Connected":"Click to download Jiangbridge",children:[c.jsx("span",{className:`w-2 h-2 ${w.isConnected?"bg-emerald-600":"bg-pink-600"}`}),w.isConnected?`JiangBridge Ready ${w.hasDngConverter?"DNG+":""}`:"JiangBridge Offline"]}),x&&c.jsxs("button",{onClick:m,className:"px-3 py-1.5 text-xs font-bold transition-all duration-200 flex items-center gap-1.5 shadow-[2px_2px_0px_black] border-2 border-indigo-800 bg-indigo-100 text-indigo-900 dark:bg-indigo-900/30 dark:text-indigo-400 dark:border-indigo-600 hover:bg-indigo-200 dark:hover:bg-indigo-900/50 cursor-pointer animate-in fade-in",title:"Click to turn off DR Lab",children:[c.jsx("span",{className:"w-2 h-2 bg-indigo-600 animate-pulse"}),"DR Lab On"]}),k&&c.jsxs("button",{onClick:P,className:"px-3 py-1.5 text-xs font-bold transition-all duration-200 flex items-center gap-1.5 shadow-[2px_2px_0px_black] border-2 border-yellow-800 bg-yellow-100 text-yellow-900 dark:bg-yellow-900/30 dark:text-yellow-400 dark:border-yellow-600 hover:bg-yellow-200 dark:hover:bg-yellow-900/50 cursor-pointer animate-in fade-in",title:"Click to turn off Color Lab",children:[c.jsx("span",{className:"w-2 h-2 bg-yellow-500 animate-pulse"}),"Color Lab On"]}),j&&c.jsxs("button",{onClick:S,className:"px-3 py-1.5 text-xs font-bold transition-all duration-200 flex items-center gap-1.5 shadow-[2px_2px_0px_black] border-2 border-fuchsia-800 bg-fuchsia-100 text-fuchsia-900 dark:bg-fuchsia-900/30 dark:text-fuchsia-400 dark:border-fuchsia-600 hover:bg-fuchsia-200 dark:hover:bg-fuchsia-900/50 cursor-pointer animate-in fade-in",title:"Click to turn off FFT Lab",children:[c.jsx("span",{className:"w-2 h-2 bg-fuchsia-600 animate-pulse"}),"FFT Lab On"]}),M&&c.jsxs("button",{onClick:O,className:"px-3 py-1.5 text-xs font-bold transition-all duration-200 flex items-center gap-1.5 shadow-[2px_2px_0px_black] border-2 border-orange-800 bg-orange-100 text-orange-900 dark:bg-orange-900/30 dark:text-orange-400 dark:border-orange-600 hover:bg-orange-200 dark:hover:bg-orange-900/50 cursor-pointer animate-in fade-in",title:"Click to turn off SFR Lab",children:[c.jsx("span",{className:"w-2 h-2 bg-orange-600 animate-pulse"}),"SFR Lab On"]}),L&&c.jsxs("button",{onClick:U,className:"px-3 py-1.5 text-xs font-bold transition-all duration-200 flex items-center gap-1.5 shadow-[2px_2px_0px_black] border-2 border-teal-800 bg-teal-100 text-teal-900 dark:bg-teal-900/30 dark:text-teal-400 dark:border-teal-600 hover:bg-teal-200 dark:hover:bg-teal-900/50 cursor-pointer animate-in fade-in",title:"Click to turn off PS Mode",children:[c.jsx("span",{className:"w-2 h-2 bg-teal-500 animate-pulse"}),"PS Mode On"]})]}),c.jsx("input",{type:"file",ref:V,onChange:he,className:"hidden",accept:".arw,.cr2,.cr3,.dng,.nef,.orf,.raf,.rw2,.pef,.srw,.sr2,.srf,.x3f,.erf,.mef,.mos,.mrw,.kdc,.dcr,.iiq,.3fr,.fff,.rwl,.nrw,.raw,.tif,.tiff"}),c.jsx("input",{type:"file",ref:J,onChange:Pe,className:"hidden",multiple:!0,accept:".csv"}),c.jsxs("div",{className:"relative inline-block text-left",ref:de,children:[c.jsxs("button",{onClick:()=>re(!me),className:"bg-purple-700 hover:bg-purple-600 text-white font-bold py-2 px-4 border-2 border-black dark:border-white shadow-[4px_4px_0px_black] dark:shadow-[4px_4px_0px_gray] active:translate-x-[2px] active:translate-y-[2px] active:shadow-[2px_2px_0px_black] transition-all duration-100 text-sm whitespace-nowrap flex items-center gap-2",children:["TOOLS",c.jsx("svg",{className:`w-4 h-4 transition-transform duration-200 ${me?"rotate-180":""}`,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),me&&c.jsx("div",{className:"absolute right-0 mt-2 w-56 bg-white dark:bg-slate-800 shadow-[8px_8px_0px_rgba(0,0,0,0.5)] ring-1 ring-black ring-opacity-5 focus:outline-none z-50 overflow-hidden origin-top-right transition-all animate-in fade-in slide-in-from-top-2 border-2 border-black dark:border-gray-500",children:c.jsxs("div",{className:"py-1",children:[c.jsxs("button",{onClick:()=>{re(!1),U&&!L&&U(),x&&m(),j&&S(),k&&P&&P(),M&&O&&O()},className:`w-full text-left px-4 py-3 text-sm transition-colors flex items-center gap-2 border-b border-gray-300 dark:border-gray-600 ${L?"bg-teal-100 dark:bg-teal-900/40 text-teal-800 dark:text-teal-300 font-bold":"text-gray-800 dark:text-slate-200 hover:bg-gray-200 dark:hover:bg-slate-700"}`,children:[c.jsx("svg",{className:"w-4 h-4 text-teal-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 6V4m0 2a2 2 0 100 4m0-4a2 2 0 110 4m-6 8a2 2 0 100-4m0 4a2 2 0 110-4m0 4v2m0-6V4m6 6v10m6-2a2 2 0 100-4m0 4a2 2 0 110-4m0 4v2m0-6V4"})}),c.jsxs("span",{children:["PS Mode ",L?"(On)":""]})]}),c.jsxs("button",{onClick:()=>{re(!1),x||m(),j&&S(),k&&P&&P(),M&&O&&O(),L&&U()},className:`w-full text-left px-4 py-3 text-sm transition-colors flex items-center gap-2 border-b border-gray-300 dark:border-gray-600 ${x?"bg-indigo-100 dark:bg-indigo-900/40 text-indigo-800 dark:text-indigo-300 font-bold":"text-gray-800 dark:text-slate-200 hover:bg-gray-200 dark:hover:bg-slate-700"}`,children:[c.jsx("svg",{className:"w-4 h-4 text-indigo-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19.428 15.428a2 2 0 00-1.022-.547l-2.384-.477a6 6 0 00-3.86.517l-.318.158a6 6 0 01-3.86.517L6.05 15.21a2 2 0 00-1.806.547M8 4h8l-1 1v5.172a2 2 0 00.586 1.414l5 5c1.26 1.26.367 3.414-1.415 3.414H4.828c-1.782 0-2.674-2.154-1.414-3.414l5-5A2 2 0 009 10.172V5L8 4z"})}),c.jsxs("span",{children:["DR Lab ",x?"(On)":""]})]}),c.jsxs("button",{onClick:()=>{re(!1),P&&!k&&P(),x&&m(),j&&S(),M&&O&&O(),L&&U()},className:`w-full text-left px-4 py-3 text-sm transition-colors flex items-center gap-2 border-b border-gray-300 dark:border-gray-600 ${k?"bg-yellow-100 dark:bg-yellow-900/40 text-yellow-800 dark:text-yellow-300 font-bold":"text-gray-800 dark:text-slate-200 hover:bg-gray-200 dark:hover:bg-slate-700"}`,children:[c.jsx("svg",{className:"w-4 h-4 text-yellow-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M7 21a4 4 0 01-4-4V5a2 2 0 012-2h4a2 2 0 012 2v12a4 4 0 01-4 4zm0 0h12a2 2 0 002-2v-4a2 2 0 00-2-2h-2.343M11 7.343l1.657-1.657a2 2 0 012.828 0l2.829 2.829a2 2 0 010 2.828l-8.486 8.485M7 17h.01"})}),c.jsxs("span",{children:["Color Lab ",k?"(On)":""]})]}),c.jsxs("button",{onClick:()=>{re(!1),O&&!M&&O(),x&&m(),j&&S(),k&&P&&P(),L&&U()},className:`w-full text-left px-4 py-3 text-sm transition-colors flex items-center gap-2 border-b border-gray-300 dark:border-gray-600 ${M?"bg-orange-100 dark:bg-orange-900/40 text-orange-800 dark:text-orange-300 font-bold":"text-gray-800 dark:text-slate-200 hover:bg-gray-200 dark:hover:bg-slate-700"}`,children:[c.jsx("svg",{className:"w-4 h-4 text-orange-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 10V3L4 14h7v7l9-11h-7z"})}),c.jsxs("span",{children:["SFR Lab ",M?"(On)":""]})]}),c.jsxs("button",{onClick:()=>{re(!1),j||S(),x&&m(),k&&P&&P(),M&&O&&O(),L&&U()},className:`w-full text-left px-4 py-3 text-sm transition-colors flex items-center gap-2 border-b border-gray-300 dark:border-gray-600 ${j?"bg-fuchsia-100 dark:bg-fuchsia-900/40 text-fuchsia-800 dark:text-fuchsia-300 font-bold":"text-gray-800 dark:text-slate-200 hover:bg-gray-200 dark:hover:bg-slate-700"}`,children:[c.jsx("svg",{className:"w-4 h-4 text-fuchsia-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2m0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"})}),c.jsxs("span",{children:["Stack Lab ",j?"(On)":""]})]}),c.jsx("div",{className:"border-t border-gray-300 dark:border-gray-600 my-1"}),c.jsxs("button",{onClick:()=>{re(!1),$==null||$()},className:"w-full text-left px-4 py-2 text-sm text-red-600 dark:text-red-400 hover:bg-gray-200 dark:hover:bg-slate-700 transition-colors flex items-center gap-2",children:[c.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})}),c.jsx("span",{children:" Z8 (Save Z8)"})]}),c.jsxs("button",{onClick:()=>{re(!1),t()},className:"w-full text-left px-4 py-2 text-sm text-gray-800 dark:text-slate-200 hover:bg-gray-200 dark:hover:bg-slate-700 transition-colors flex items-center gap-2",children:[c.jsx("svg",{className:"w-4 h-4 text-purple-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"})}),c.jsx("span",{children:"Generate Pattern DNG"})]}),c.jsxs("button",{onClick:()=>{var ve;re(!1),(ve=J.current)==null||ve.click()},className:"w-full text-left px-4 py-2 text-sm text-gray-800 dark:text-slate-200 hover:bg-gray-200 dark:hover:bg-slate-700 transition-colors flex items-center gap-2",children:[c.jsx("svg",{className:"w-4 h-4 text-emerald-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M7 12l3-3 3 3 4-4M8 21l4-4 4 4M3 4h18M4 4h16v12a1 1 0 01-1 1H5a1 1 0 01-1-1V4z"})}),c.jsx("span",{children:"Generate PTC"})]}),c.jsxs("button",{onClick:()=>{re(!1),window.open("https://y-g-jiang.github.io/CP.html","_blank")},className:"w-full text-left px-4 py-2 text-sm text-gray-800 dark:text-slate-200 hover:bg-gray-200 dark:hover:bg-slate-700 transition-colors flex items-center gap-2",children:[c.jsx("svg",{className:"w-4 h-4 text-teal-500",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2m0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"})}),c.jsx("span",{children:"Generate MTF Contour"})]})]})})]}),c.jsxs("div",{className:"relative inline-block text-left",ref:le,children:[c.jsxs("button",{onClick:()=>ee(!te),className:"bg-cyan-700 hover:bg-cyan-600 text-white font-bold py-2 px-4 border-2 border-black dark:border-white shadow-[4px_4px_0px_black] dark:shadow-[4px_4px_0px_gray] active:translate-x-[2px] active:translate-y-[2px] active:shadow-[2px_2px_0px_black] transition-all duration-100 text-sm whitespace-nowrap flex items-center gap-2",children:["Load Image",c.jsx("svg",{className:`w-4 h-4 transition-transform duration-200 ${te?"rotate-180":""}`,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),te&&c.jsx("div",{className:"absolute right-0 mt-2 w-56 bg-white dark:bg-slate-800 shadow-[8px_8px_0px_rgba(0,0,0,0.5)] ring-1 ring-black ring-opacity-5 focus:outline-none z-50 overflow-hidden origin-top-right transition-all animate-in fade-in slide-in-from-top-2 border-2 border-black dark:border-gray-500",children:c.jsxs("div",{className:"py-1",children:[c.jsxs("button",{onClick:()=>Se("direct"),className:"w-full text-left px-4 py-3 text-sm text-gray-800 dark:text-slate-200 hover:bg-gray-200 dark:hover:bg-slate-700 transition-colors flex items-center gap-2 border-b border-gray-300 dark:border-gray-600",children:[c.jsx("svg",{className:"w-4 h-4 text-cyan-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-8l-4-4m0 0L8 8m4-4v12"})}),c.jsx("span",{children:"Load Image (Direct)"})]}),c.jsxs("button",{onClick:()=>Se("convert"),className:"w-full text-left px-4 py-3 text-sm text-gray-800 dark:text-slate-200 hover:bg-gray-200 dark:hover:bg-slate-700 transition-colors flex items-center gap-2",children:[c.jsx("svg",{className:"w-4 h-4 text-purple-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19.428 15.428a2 2 0 00-1.022-.547l-2.384-.477a6 6 0 00-3.86.517l-.318.158a6 6 0 01-3.86.517L6.05 15.21a2 2 0 00-1.806.547M8 4h8l-1 1v5.172a2 2 0 00.586 1.414l5 5c1.26 1.26.367 3.414-1.415 3.414H4.828c-1.782 0-2.674-2.154-1.414-3.414l5-5A2 2 0 009 10.172V5L8 4z"})}),c.jsx("span",{children:"Convert to Adobe DNG & Load"})]})]})})]}),r&&b&&c.jsxs("button",{onClick:b,className:"bg-orange-600 hover:bg-orange-500 text-white font-bold py-2 px-4 border-2 border-black dark:border-white shadow-[4px_4px_0px_black] dark:shadow-[4px_4px_0px_gray] active:translate-x-[2px] active:translate-y-[2px] active:shadow-[2px_2px_0px_black] transition-all duration-100 text-sm whitespace-nowrap flex items-center gap-1",title:"View EXIF Data",children:[c.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),"EXIF"]}),c.jsx("button",{onClick:g,className:"bg-teal-700 hover:bg-teal-600 text-white font-bold py-2 px-4 border-2 border-black dark:border-white shadow-[4px_4px_0px_black] dark:shadow-[4px_4px_0px_gray] active:translate-x-[2px] active:translate-y-[2px] active:shadow-[2px_2px_0px_black] transition-all duration-100 text-sm whitespace-nowrap",children:"About/Tutorial/Tools"}),c.jsx("a",{href:"https://y-g-jiang.github.io/index.html",target:"_blank",rel:"noopener noreferrer",className:"bg-gray-300 hover:bg-gray-200 dark:bg-slate-700 dark:hover:bg-slate-600 text-black dark:text-white font-bold py-2 px-4 border-2 border-black dark:border-white shadow-[4px_4px_0px_black] dark:shadow-[4px_4px_0px_gray] active:translate-x-[2px] active:translate-y-[2px] active:shadow-[2px_2px_0px_black] transition-all duration-100 text-sm no-underline",children:"Home"}),c.jsxs("button",{onClick:G,className:`bg-slate-700 hover:bg-slate-600 text-white font-bold py-2 px-3 border-2 border-black dark:border-white shadow-[4px_4px_0px_black] dark:shadow-[4px_4px_0px_gray] active:translate-x-[2px] active:translate-y-[2px] active:shadow-[2px_2px_0px_black] transition-all duration-100 text-sm whitespace-nowrap flex items-center gap-2 ${Y?"":"ring-2 ring-cyan-500 ring-offset-2 dark:ring-offset-black"}`,title:Y?"Hide Control Panel":"Show Control Panel",children:[c.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:Y?c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 5l7 7-7 7M5 5l7 7-7 7"}):c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11 19l-7-7 7-7m8 14l-7-7 7-7"})}),c.jsx("span",{className:"hidden sm:inline",children:Y?"Hide Panel":"Show Panel"})]})]})]})},vT=({image:e,zoom:t,pan:r,onPanChange:n,onZoomChange:a,onSelectionChange:i,forcedSelection:o,theme:s,touchAction:l="pan",isMarking:u=!1,onPointClick:d,markers:f=[],gridRects:h=[],colorLabPoints:g=[],colorLabRects:b=[],sfrRects:w=[],psMaskOverlay:v=null,psMaskDirtyRect:x=null,psGuides:m=[],psSelectedGuideId:k=null,psGuidePickTarget:P=null,psEllipseTool:j={mode:"off",draft:null},psEditableEllipse:S=null,psBrush:M,onPsBrushPaint:O,onPsGuidePickPoint:E,onPsEllipseCenterPick:I,onPsEllipseDrag:D,onPsEditEllipse:B})=>{var jt;const z=_.useRef(null),Y=_.useRef(document.createElement("canvas")),G=_.useRef(null),$=_.useRef(null),[L,U]=_.useState(!1),[V,J]=_.useState({x:0,y:0}),K=_.useRef(null),Q=_.useRef(null),te=_.useRef(null),[ee,me]=_.useState(!1),[re,De]=_.useState(null),[fe,le]=_.useState(null),[de,Se]=_.useState(!1),[he,Pe]=_.useState(!1),[ve,ye]=_.useState(!1),[ge,ue]=_.useState(null),Le=_.useRef(null),rt=_.useRef(null),et=_.useRef(null),tt=_.useRef(null),ft=Me=>{Le.current=Me,ue(Me)};_.useEffect(()=>{o!==void 0&&le(o)},[o]),_.useEffect(()=>{ve||ft(null)},[ve,S==null?void 0:S.id]),_.useEffect(()=>{if(!v){G.current=null,$.current=null;return}if(!G.current||!$.current||$.current.width!==v.width||$.current.height!==v.height||!x){const sr=document.createElement("canvas");sr.width=v.width,sr.height=v.height;const Jt=sr.getContext("2d");if(!Jt)return;const vt=Jt.createImageData(v.width,v.height);for(let nr=0;nr<v.alpha.length;nr++){const A=Math.max(0,Math.min(1,v.alpha[nr])),Ge=nr*4;vt.data[Ge]=255,vt.data[Ge+1]=56,vt.data[Ge+2]=56,vt.data[Ge+3]=Math.round(A*128)}Jt.putImageData(vt,0,0),G.current=sr,$.current={width:v.width,height:v.height};return}const Te=G.current.getContext("2d");if(!Te)return;const xe=Math.max(0,Math.floor(x.x0)),ze=Math.max(0,Math.floor(x.y0)),Je=Math.min(v.width-1,Math.ceil(x.x1)),ot=Math.min(v.height-1,Math.ceil(x.y1)),Pt=Math.max(0,Je-xe+1),Qe=Math.max(0,ot-ze+1);if(Pt<=0||Qe<=0)return;const _r=Te.createImageData(Pt,Qe);for(let sr=0;sr<Qe;sr++){const vt=(ze+sr)*v.width,nr=sr*Pt;for(let A=0;A<Pt;A++){const Ge=xe+A,Ke=Math.max(0,Math.min(1,v.alpha[vt+Ge])),Yt=(nr+A)*4;_r.data[Yt]=255,_r.data[Yt+1]=56,_r.data[Yt+2]=56,_r.data[Yt+3]=Math.round(Ke*128)}}Te.putImageData(_r,xe,ze)},[v==null?void 0:v.alpha,v==null?void 0:v.width,v==null?void 0:v.height,v==null?void 0:v.version,x]);const wt=_.useCallback(()=>{const Me=z.current,X=Me==null?void 0:Me.getContext("2d");return{canvas:Me,ctx:X}},[]);_.useEffect(()=>{const Me=Y.current,X=Me.getContext("2d");if(!e||!X)return;let Te=0,xe=0;e instanceof ImageData?(Te=e.width,xe=e.height):e instanceof HTMLImageElement&&(Te=e.naturalWidth,xe=e.naturalHeight),!(Te===0||xe===0)&&((Me.width!==Te||Me.height!==xe)&&(Me.width=Te,Me.height=xe),e instanceof ImageData?X.putImageData(e,0,0):(X.clearRect(0,0,Te,xe),X.drawImage(e,0,0)))},[e]);const fr=_.useCallback(()=>{const{canvas:Me,ctx:X}=wt();if(!Me||!X||!e)return;if(X.setTransform(1,0,0,1,0,0),X.fillStyle=s==="dark"?"rgb(15, 23, 42)":"rgb(243, 244, 246)",X.fillRect(0,0,Me.width,Me.height),X.setTransform(t,0,0,t,r.x,r.y),Y.current.width>0&&(X.imageSmoothingEnabled=!1,X.drawImage(Y.current,0,0)),G.current&&(X.imageSmoothingEnabled=!1,X.drawImage(G.current,0,0)),m&&m.length>0){X.save();for(const xe of m){if(xe.visible===!1)continue;const ze=k===xe.id;X.strokeStyle=ze?"#f59e0b":"#22d3ee",X.lineWidth=ze?2/t:1/t,X.setLineDash([8/t,6/t]),X.beginPath(),X.moveTo(xe.p1.x,xe.p1.y),X.lineTo(xe.p2.x,xe.p2.y),X.stroke();const Je=3/t;X.fillStyle=ze?"#f59e0b":"#22d3ee",X.beginPath(),X.arc(xe.p1.x,xe.p1.y,Je,0,Math.PI*2),X.arc(xe.p2.x,xe.p2.y,Je,0,Math.PI*2),X.fill()}X.restore()}if(j.mode!=="off"&&j.draft){const xe=j.draft;X.save(),X.strokeStyle="#f59e0b",X.lineWidth=2/t,X.setLineDash([6/t,4/t]),X.beginPath(),X.ellipse(xe.center.x,xe.center.y,Math.max(1,xe.radiusX),Math.max(1,xe.radiusY),xe.rotationDeg*Math.PI/180,0,Math.PI*2),X.stroke(),X.setLineDash([]),X.fillStyle="#f59e0b",X.beginPath(),X.arc(xe.center.x,xe.center.y,3/t,0,Math.PI*2),X.fill(),X.restore()}const Te=ve&&ge?ge:S;if(Te&&j.mode==="off"){const xe=Te,ze=Sr(xe),Je=4/t;X.save(),X.strokeStyle="#14b8a6",X.lineWidth=1.5/t,X.setLineDash([5/t,3/t]),X.beginPath(),X.ellipse(xe.center.x,xe.center.y,Math.max(1,xe.radiusX),Math.max(1,xe.radiusY),xe.rotationDeg*Math.PI/180,0,Math.PI*2),X.stroke(),X.setLineDash([]),X.strokeStyle="#22d3ee",X.beginPath(),X.moveTo(ze.center.x,ze.center.y),X.lineTo(ze.rotHandle.x,ze.rotHandle.y),X.stroke();const ot=(Pt,Qe)=>{X.fillStyle=Qe,X.beginPath(),X.arc(Pt.x,Pt.y,Je,0,Math.PI*2),X.fill(),X.strokeStyle="#0f172a",X.lineWidth=1/t,X.stroke()};ot(ze.center,"#f59e0b"),ot(ze.rxHandle,"#38bdf8"),ot(ze.ryHandle,"#818cf8"),ot(ze.rotHandle,"#22d3ee"),X.restore()}if(fe){X.strokeStyle="#06b6d4",X.lineWidth=1/t,X.fillStyle="rgba(6, 182, 212, 0.2)",X.beginPath(),X.rect(fe.x,fe.y,fe.w,fe.h),X.fill(),X.stroke(),X.save(),X.fillStyle="#fff";const xe=Math.max(10,14/t);X.font=`${xe}px monospace`,X.shadowColor="rgba(0,0,0,0.8)",X.shadowBlur=4,X.shadowOffsetX=1,X.shadowOffsetY=1,X.fillText(`${Math.round(fe.w)}x${Math.round(fe.h)}`,fe.x,fe.y-5/t),X.restore()}if(h&&h.length>0){X.save(),X.strokeStyle="#f59e0b",X.lineWidth=1/t,X.globalAlpha=.8,X.beginPath(),h.forEach(Je=>{X.rect(Je.x,Je.y,Je.w,Je.h)}),X.stroke();const xe=h[0];X.fillStyle="#f59e0b";const ze=Math.max(10,12/t);X.font=`${ze}px monospace`,X.fillText(`${Math.round(xe.w)}x${Math.round(xe.h)}`,xe.x,xe.y-4/t),X.restore()}if(f&&f.length>0){X.save();const xe=6/t,ze=Math.max(12,16/t);X.font=`bold ${ze}px sans-serif`,X.textAlign="center",X.textBaseline="middle",f.forEach((Je,ot)=>{X.beginPath(),X.arc(Je.x,Je.y,xe,0,2*Math.PI),X.fillStyle="white",X.fill(),X.strokeStyle="#4338ca",X.lineWidth=2/t,X.stroke(),X.fillStyle="#4338ca",X.fillText((ot+1).toString(),Je.x,Je.y-12/t)}),X.restore()}if(g&&g.length>0){X.save();const xe=5/t,ze=Math.max(10,14/t);X.font=`bold ${ze}px sans-serif`,X.textAlign="center",X.textBaseline="middle",g.forEach((Je,ot)=>{X.fillStyle="yellow",X.fillRect(Je.x-xe,Je.y-xe,xe*2,xe*2),X.strokeStyle="black",X.lineWidth=1/t,X.strokeRect(Je.x-xe,Je.y-xe,xe*2,xe*2),X.fillStyle="yellow",X.shadowColor="black",X.shadowBlur=2,X.fillText((ot+1).toString(),Je.x,Je.y-10/t)}),X.restore()}if(b&&b.length>0){if(X.save(),X.strokeStyle="yellow",X.lineWidth=1/t,X.globalAlpha=.9,X.beginPath(),b.forEach(xe=>{X.rect(xe.x,xe.y,xe.w,xe.h)}),X.stroke(),b[0]){const xe=b[0];X.fillStyle="yellow",X.shadowColor="black",X.shadowBlur=3;const ze=Math.max(10,12/t);X.font=`${ze}px monospace`,X.fillText(`${Math.round(xe.w)}x${Math.round(xe.h)}`,xe.x,xe.y-4/t)}X.restore()}w&&w.length>0&&(X.save(),X.strokeStyle="#ef4444",X.lineWidth=2/t,X.globalAlpha=.9,X.beginPath(),w.forEach(xe=>{X.rect(xe.x,xe.y,xe.w,xe.h)}),X.stroke(),X.restore())},[wt,e,t,r,s,fe,h,f,g,b,w,v==null?void 0:v.version,m,k,j,S,ve,ge]);_.useEffect(()=>{const{canvas:Me}=wt();if(!Me)return;const X=new ResizeObserver(()=>{Me.width=Me.clientWidth,Me.height=Me.clientHeight,fr()});return X.observe(Me),()=>X.disconnect()},[wt,fr]),_.useEffect(()=>{fr()},[fr,e,r,t,s,fe,h,f,g,b,w,m,k,S,ve,ge]);const Wt=Me=>{const{canvas:X}=wt();if(!X)return{x:0,y:0};const Te=X.getBoundingClientRect();return{x:Me.clientX-Te.left,y:Me.clientY-Te.top}},kt=(Me,X)=>({x:(Me-r.x)/t,y:(X-r.y)/t}),Bt=Me=>{const X=Me*Math.PI/180,Te={x:Math.cos(X),y:Math.sin(X)},xe={x:-Math.sin(X),y:Math.cos(X)};return{ux:Te,uy:xe}},Sr=Me=>{const{ux:X,uy:Te}=Bt(Me.rotationDeg),xe=Me.center,ze=Math.max(1,Me.radiusX),Je=Math.max(1,Me.radiusY),ot={x:xe.x+X.x*ze,y:xe.y+X.y*ze},Pt={x:xe.x+Te.x*Je,y:xe.y+Te.y*Je},Qe={x:xe.x+X.x*(ze+28/t),y:xe.y+X.y*(ze+28/t)};return{center:xe,rxHandle:ot,ryHandle:Pt,rotHandle:Qe,ux:X,uy:Te}},Gr=(Me,X)=>{const Te=Me.x-X.x,xe=Me.y-X.y;return Te*Te+xe*xe},rr=Me=>{const X=ve&&ge?ge:S;if(!X||j.mode!=="off")return null;const Te=Sr(X),xe=8/t,ze=xe*xe;if(Gr(Me,Te.rotHandle)<=ze)return"rotate";if(Gr(Me,Te.rxHandle)<=ze)return"radiusX";if(Gr(Me,Te.ryHandle)<=ze)return"radiusY";if(Gr(Me,Te.center)<=ze)return"move";const Je=Me.x-Te.center.x,ot=Me.y-Te.center.y,Pt=Je*Te.ux.x+ot*Te.ux.y,Qe=Je*Te.uy.x+ot*Te.uy.y,_r=Pt/Math.max(1,X.radiusX),sr=Qe/Math.max(1,X.radiusY);return _r*_r+sr*sr<=1.05*1.05?"move":null},Nr=Me=>{if(!S||!B||j.mode!=="off")return!1;const X=rr(Me);return X?(et.current=X,tt.current={itemId:S.id,startMouse:Me,center:{...S.center},radiusX:S.radiusX,radiusY:S.radiusY,rotationDeg:S.rotationDeg},ft({id:S.id,center:{...S.center},radiusX:S.radiusX,radiusY:S.radiusY,rotationDeg:S.rotationDeg}),ye(!0),!0):!1},nt=Me=>{if(!ve)return!1;const X=et.current,Te=tt.current;if(!X||!Te)return!1;const xe={id:Te.itemId,center:{...Te.center},radiusX:Te.radiusX,radiusY:Te.radiusY,rotationDeg:Te.rotationDeg};if(X==="move")return xe.center={x:Te.center.x+(Me.x-Te.startMouse.x),y:Te.center.y+(Me.y-Te.startMouse.y)},ft(xe),!0;if(X==="rotate"){const Qe=Math.atan2(Me.y-Te.center.y,Me.x-Te.center.x)*180/Math.PI;return xe.rotationDeg=Qe,ft(xe),!0}const{ux:ze,uy:Je}=Bt(Te.rotationDeg),ot=Me.x-Te.center.x,Pt=Me.y-Te.center.y;if(X==="radiusX"){const Qe=Math.max(1,Math.abs(ot*ze.x+Pt*ze.y));return xe.radiusX=Qe,ft(xe),!0}if(X==="radiusY"){const Qe=Math.max(1,Math.abs(ot*Je.x+Pt*Je.y));return xe.radiusY=Qe,ft(xe),!0}return!1},Ot=()=>{if(!ve||!B)return;const Me=tt.current,X=Le.current||ge;!Me||!X||B(Me.itemId,{center:X.center,radiusX:X.radiusX,radiusY:X.radiusY,rotationDeg:X.rotationDeg})},pr=Me=>{Me.preventDefault();const X=Wt(Me),Te=kt(X.x,X.y);if(rt.current=Te,j.mode==="center"&&I){I(Te);return}if(j.mode==="drag"&&D){D(Te,"start"),Pe(!0);return}if(!Nr(Te)){if(P&&E){E(Te);return}if(M!=null&&M.enabled&&O&&!u&&l!=="select"&&!Me.shiftKey){const xe=kt(X.x,X.y);O(xe,"start"),Se(!0);return}if(u&&d){const xe=kt(X.x,X.y);d(xe);return}if(l==="select"||Me.shiftKey){me(!0);const xe=kt(X.x,X.y),ze={x:Math.floor(xe.x),y:Math.floor(xe.y)};De(ze),le(null),i&&i(null)}else U(!0),J({x:X.x-r.x,y:X.y-r.y})}},br=Me=>{const X=Wt(Me),Te=kt(X.x,X.y);if(rt.current=Te,!nt(Te)){if(he&&D){D(Te,"move");return}if(de&&O){O(Te,"move");return}if(ee&&re){const xe=kt(X.x,X.y),ze=Math.floor(xe.x),Je=Math.floor(xe.y),ot=Math.min(re.x,ze),Pt=Math.min(re.y,Je),Qe=Math.max(re.x,ze),_r=Math.max(re.y,Je),sr=Qe-ot+1,Jt=_r-Pt+1;le({x:ot,y:Pt,w:sr,h:Jt})}else L&&n({x:X.x-V.x,y:X.y-V.y})}},jr=()=>{he&&D&&(D(rt.current||{x:0,y:0},"end"),Pe(!1)),ve&&(Ot(),ye(!1),ft(null),et.current=null,tt.current=null),de&&(O&&O({x:0,y:0},"end"),Se(!1)),ee&&(me(!1),fe&&i&&fe.w>0&&fe.h>0&&i(fe)),U(!1)},Rr=Me=>{var X;if(Me.touches.length===1){const Te=Me.touches[0],xe=(X=z.current)==null?void 0:X.getBoundingClientRect();if(!xe)return;const ze=Te.clientX-xe.left,Je=Te.clientY-xe.top,ot=kt(ze,Je);if(rt.current=ot,j.mode==="center"&&I){I(ot);return}if(j.mode==="drag"&&D){D(ot,"start"),Pe(!0);return}if(Nr(ot))return;if(P&&E){E(ot);return}if(u&&d){const Pt=kt(ze,Je);d(Pt);return}if(M!=null&&M.enabled&&O&&l!=="select"){const Pt=kt(ze,Je);O(Pt,"start"),Se(!0);return}if(l==="select"){const Pt=kt(ze,Je),Qe={x:Math.floor(Pt.x),y:Math.floor(Pt.y)};De(Qe),me(!0),le(null),i&&i(null)}else te.current={x:ze,y:Je},J({x:ze-r.x,y:Je-r.y}),U(!0)}else if(Me.touches.length===2){const Te=Math.hypot(Me.touches[0].clientX-Me.touches[1].clientX,Me.touches[0].clientY-Me.touches[1].clientY);K.current=Te,Q.current=t,U(!1),me(!1)}},Pr=Me=>{var X;if(Me.touches.length===1){const Te=Me.touches[0],xe=(X=z.current)==null?void 0:X.getBoundingClientRect();if(!xe)return;const ze=Te.clientX-xe.left,Je=Te.clientY-xe.top,ot=kt(ze,Je);if(rt.current=ot,nt(ot))return;if(he&&D){D(ot,"move");return}if(u)return;if(de&&O){O(ot,"move");return}if(ee&&re){const Pt=kt(ze,Je),Qe=Math.floor(Pt.x),_r=Math.floor(Pt.y),sr=Math.min(re.x,Qe),Jt=Math.min(re.y,_r),vt=Math.max(re.x,Qe),nr=Math.max(re.y,_r),A=vt-sr+1,Ge=nr-Jt+1;le({x:sr,y:Jt,w:A,h:Ge})}else L&&n({x:ze-V.x,y:Je-V.y})}else if(Me.touches.length===2&&K.current&&Q.current&&a){const xe=Math.hypot(Me.touches[0].clientX-Me.touches[1].clientX,Me.touches[0].clientY-Me.touches[1].clientY)/K.current;a(Q.current*xe)}},Kt=()=>{he&&D&&(D(rt.current||{x:0,y:0},"end"),Pe(!1)),ve&&(Ot(),ye(!1),ft(null),et.current=null,tt.current=null),de&&O&&(O({x:0,y:0},"end"),Se(!1)),ee&&(me(!1),fe&&i&&fe.w>0&&fe.h>0&&i(fe)),U(!1),K.current=null,Q.current=null,te.current=null},Er=j.mode!=="off"||P?"cursor-crosshair":ve?"cursor-grabbing":S?"cursor-pointer":M!=null&&M.enabled||u||l==="select"||(jt=window.event)!=null&&jt.shiftKey?"cursor-crosshair":"cursor-grab active:cursor-grabbing";return c.jsx("canvas",{ref:z,className:`w-full h-full block touch-none ${Er}`,onMouseDown:pr,onMouseMove:br,onMouseUp:jr,onMouseLeave:jr,onTouchStart:Rr,onTouchMove:Pr,onTouchEnd:Kt,onTouchCancel:Kt,tabIndex:0})};function tc(e){const[[t,r,n],[a,i,o],[s,l,u]]=e,d=t*(i*u-o*l)-r*(a*u-o*s)+n*(a*l-i*s);if(Math.abs(d)<1e-10)return null;const f=1/d;return[[(i*u-o*l)*f,(n*l-r*u)*f,(r*o-n*i)*f],[(o*s-a*u)*f,(t*u-n*s)*f,(n*a-t*o)*f],[(a*l-i*s)*f,(r*s-t*l)*f,(t*i-r*a)*f]]}function bT(e,t){const[[r,n,a],[i,o,s],[l,u,d]]=e,[f,h,g]=t;return[r*f+n*h+a*g,i*f+o*h+s*g,l*f+u*h+d*g]}function _f(e,t){const r=[[0,0,0],[0,0,0],[0,0,0]];for(let n=0;n<3;n++)for(let a=0;a<3;a++)for(let i=0;i<3;i++)r[n][a]+=e[n][i]*t[i][a];return r}function wT(e){const t=e.length;if(t<2)return s=>{var l;return((l=e[0])==null?void 0:l.y)||0};const r=[...e].sort((s,l)=>s.x-l.x),n=r.map(s=>s.x),a=r.map(s=>s.y),i=new Float32Array(t-1),o=new Float32Array(t);for(let s=0;s<t-1;s++){const l=n[s+1]-n[s],u=a[s+1]-a[s];i[s]=u/(l||1e-9)}o[0]=i[0];for(let s=1;s<t-1;s++)o[s]=(i[s-1]+i[s])*.5;o[t-1]=i[t-2];for(let s=0;s<t-1;s++)if(i[s]===0)o[s]=0,o[s+1]=0;else{const l=o[s]/i[s],u=o[s+1]/i[s],d=l*l+u*u;if(d>9){const f=3/Math.sqrt(d);o[s]=l*f*i[s],o[s+1]=u*f*i[s]}}return s=>{let l=0;if(s<=n[0])return a[0];if(s>=n[t-1])return a[t-1];for(;s>n[l+1]&&l<t-2;)l++;const u=n[l+1]-n[l],d=1/u,h=(s-n[l])*d,g=h*h,b=g*h,w=2*b-3*g+1,v=b-2*g+h,x=-2*b+3*g,m=b-g,k=w*a[l]+v*u*o[l]+x*a[l+1]+m*u*o[l+1];return Math.max(0,Math.min(1,k))}}function Ia(e,t=256){const r=wT(e),n=new Float32Array(t);for(let a=0;a<t;a++){const i=a/(t-1);n[a]=r(i)}return n}class rc{constructor(t){Xt(this,"size");Xt(this,"isPowerOfTwo");Xt(this,"_real");Xt(this,"_imag");Xt(this,"_scratch",null);Xt(this,"_rev",null);Xt(this,"_m",0);Xt(this,"_internalFFT",null);Xt(this,"_chirpReal",null);Xt(this,"_chirpImag",null);Xt(this,"_bReal",null);Xt(this,"_bImag",null);Xt(this,"_hanning",null);Xt(this,"_windowSumSq",0);this.size=t,this.isPowerOfTwo=(t&t-1)===0&&t>0,this._real=new Float32Array(t),this._imag=new Float32Array(t),this.isPowerOfTwo?this.initRadix2():this.initBluestein()}initRadix2(){const t=this.size,r=Math.log2(t);this._rev=new Uint32Array(t);for(let n=0;n<t;n++){let a=0,i=n;for(let o=0;o<r;o++)a=a<<1|i&1,i>>>=1;this._rev[n]=a}}initBluestein(){const t=this.size;this._m=Math.pow(2,Math.ceil(Math.log2(2*t-1))),this._internalFFT=new rc(this._m),this._chirpReal=new Float32Array(t),this._chirpImag=new Float32Array(t);for(let a=0;a<t;a++){const i=-Math.PI*(a*a)/t;this._chirpReal[a]=Math.cos(i),this._chirpImag[a]=Math.sin(i)}const r=new Float32Array(this._m),n=new Float32Array(this._m);for(let a=0;a<t;a++)r[a]=this._chirpReal[a],n[a]=-this._chirpImag[a];for(let a=1;a<t;a++)r[this._m-a]=r[a],n[this._m-a]=n[a];this._internalFFT.transform(r,n),this._bReal=new Float32Array(this._internalFFT._real),this._bImag=new Float32Array(this._internalFFT._imag)}initHanning(){if(this._hanning)return;const t=this.size;this._hanning=new Float32Array(t);let r=0;for(let n=0;n<t;n++){const a=.5*(1-Math.cos(2*Math.PI*n/(t-1)));this._hanning[n]=a,r+=a*a}this._windowSumSq=r}transform(t,r){this.isPowerOfTwo?this.transformRadix2(t,r):this.transformBluestein(t,r)}transformRadix2(t,r){const n=this.size,a=this._rev,i=this._real,o=this._imag;if(t===i)for(let s=0;s<n;s++){const l=a[s];if(s<l){const u=i[s],d=o[s];i[s]=i[l],o[s]=o[l],i[l]=u,o[l]=d}}else for(let s=0;s<n;s++){const l=a[s];i[s]=t[l],o[s]=r?r[l]:0}for(let s=2;s<=n;s*=2){const l=s/2,u=-2*Math.PI/s,d=Math.cos(u),f=Math.sin(u);for(let h=0;h<n;h+=s){let g=1,b=0;for(let w=0;w<l;w++){const v=h+w,x=h+w+l,m=g*i[x]-b*o[x],k=g*o[x]+b*i[x],P=i[v],j=o[v];i[v]=P+m,o[v]=j+k,i[x]=P-m,o[x]=j-k;const S=g*d-b*f,M=g*f+b*d;g=S,b=M}}}}transformBluestein(t,r){const n=this.size,a=this._m,i=this._internalFFT,o=i._real,s=i._imag;o.fill(0),s.fill(0);for(let f=0;f<n;f++){const h=t[f],g=r?r[f]:0,b=this._chirpReal[f],w=this._chirpImag[f];o[f]=h*b-g*w,s[f]=h*w+g*b}i.transformRadix2(o,s);for(let f=0;f<a;f++){const h=i._real[f],g=i._imag[f],b=this._bReal[f],w=this._bImag[f];i._real[f]=h*b-g*w,i._imag[f]=h*w+g*b}const l=i._real,u=i._imag;for(let f=0;f<a;f++)u[f]=-u[f];i.transformRadix2(l,u);const d=1/a;for(let f=0;f<n;f++){const h=i._real[f]*d,g=-i._imag[f]*d,b=this._chirpReal[f],w=this._chirpImag[f];this._real[f]=h*b-g*w,this._imag[f]=h*w+g*b}}calculateSpectrum(t,r,n=!1){const a=this.size;let i=0;for(let d=0;d<a;d++)i+=t[d];const o=i/a;this._scratch||(this._scratch=new Float32Array(a));const s=this._scratch;if(n){this.initHanning();const d=this._hanning;for(let f=0;f<a;f++)s[f]=(t[f]-o)*d[f]}else for(let d=0;d<a;d++)s[d]=t[d]-o;this.transform(s);const l=r.length;let u=1/a;n&&this._windowSumSq>0&&(u=1/this._windowSumSq);for(let d=0;d<l;d++){const f=this._real[d],h=this._imag[d];r[d]+=(f*f+h*h)*u}}}function kT(e,t,r,n=!1){const a=new rc(t),i=new rc(r),o=t*r,s=new Float32Array(o),l=new Float32Array(o);let u=null,d=null;if(n){u=new Float32Array(t);for(let w=0;w<t;w++)u[w]=.5*(1-Math.cos(2*Math.PI*w/(t-1)));d=new Float32Array(r);for(let w=0;w<r;w++)d[w]=.5*(1-Math.cos(2*Math.PI*w/(r-1)))}for(let w=0;w<r;w++){const v=w*t,x=a._real;let m=0;for(let P=0;P<t;P++)m+=e[v+P];const k=m/t;if(u)for(let P=0;P<t;P++)x[P]=(e[v+P]-k)*u[P];else for(let P=0;P<t;P++)x[P]=e[v+P]-k;a.transform(x);for(let P=0;P<t;P++)s[v+P]=a._real[P],l[v+P]=a._imag[P]}for(let w=0;w<t;w++){const v=i._real,x=i._imag;for(let m=0;m<r;m++){const k=m*t+w;let P=s[k],j=l[k];d&&(P*=d[m],j*=d[m]),v[m]=P,x[m]=j}i.transform(v,x);for(let m=0;m<r;m++){const k=m*t+w;s[k]=i._real[m],l[k]=i._imag[m]}}const f=new Float32Array(o);let h=1,g=t,b=r;if(n&&u&&d){g=0;for(let w=0;w<t;w++)g+=u[w]*u[w];b=0;for(let w=0;w<r;w++)b+=d[w]*d[w]}h=1/(g*b);for(let w=0;w<o;w++)f[w]=(s[w]*s[w]+l[w]*l[w])*h;return f}function ST(e,t,r){const n=new Float32Array(e.length),a=Math.floor(t/2),i=Math.floor(r/2);for(let o=0;o<r;o++)for(let s=0;s<t;s++){const l=(s+a)%t,u=(o+i)%r,d=o*t+s,f=u*t+l;n[f]=e[d]}return n}const nc=e=>`${e}_${Date.now()}_${Math.random().toString(36).slice(2,8)}`,mr=e=>Math.max(0,Math.min(1,e)),th=[{x:0,y:0},{x:1,y:1}],rh=e=>e.map(t=>({x:t.x,y:t.y})),Lb=()=>({master:rh(th),red:rh(th),green:rh(th),blue:rh(th)}),jT=["red","orange","yellow","green","aqua","blue","purple","magenta"],m_=()=>({exposure:0,temperature:0,tint:0,contrast:0,highlights:0,shadows:0,vibrance:0,saturation:0}),js=()=>({hue:0,saturation:0,luminance:0}),Fb=()=>({red:js(),orange:js(),yellow:js(),green:js(),aqua:js(),blue:js(),purple:js(),magenta:js()}),Qi=(e,t,r,n=0)=>{const a=Number(e);return Number.isFinite(a)?Math.max(t,Math.min(r,a)):n},g0=e=>({exposure:Qi(e==null?void 0:e.exposure,-5,5,0),temperature:Qi(e==null?void 0:e.temperature,-100,100,0),tint:Qi(e==null?void 0:e.tint,-100,100,0),contrast:Qi(e==null?void 0:e.contrast,-100,100,0),highlights:Qi(e==null?void 0:e.highlights,-100,100,0),shadows:Qi(e==null?void 0:e.shadows,-100,100,0),vibrance:Qi(e==null?void 0:e.vibrance,-100,100,0),saturation:Qi(e==null?void 0:e.saturation,-100,100,0)}),m0=e=>{const t=Fb(),r=n=>{var a,i,o;return{hue:Qi((a=e==null?void 0:e[n])==null?void 0:a.hue,-100,100,t[n].hue),saturation:Qi((i=e==null?void 0:e[n])==null?void 0:i.saturation,-100,100,t[n].saturation),luminance:Qi((o=e==null?void 0:e[n])==null?void 0:o.luminance,-100,100,t[n].luminance)}};return{red:r("red"),orange:r("orange"),yellow:r("yellow"),green:r("green"),aqua:r("aqua"),blue:r("blue"),purple:r("purple"),magenta:r("magenta")}},Lg=e=>{const t=Lb();if(!e)return t;const r=n=>{const a=e==null?void 0:e[n];if(!Array.isArray(a)||a.length<2)return t[n];const i=a.map(o=>({x:Math.max(0,Math.min(1,Number((o==null?void 0:o.x)??0))),y:Math.max(0,Math.min(1,Number((o==null?void 0:o.y)??0)))})).filter(o=>!Number.isNaN(o.x)&&!Number.isNaN(o.y)).sort((o,s)=>o.x-s.x);return i.length<2?t[n]:(i[0].x=0,i[i.length-1].x=1,i)};return{master:r("master"),red:r("red"),green:r("green"),blue:r("blue")}},PT=(e,t,r,n,a,i,o,s,l)=>{const u=Math.max(1,i),d=mr(o),f=mr(l),h=u,g=u*(1+f*1.5),b=g*g,w=Math.max(0,Math.floor(n-g)),v=Math.max(0,Math.floor(a-g)),x=Math.min(t-1,Math.ceil(n+g)),m=Math.min(r-1,Math.ceil(a+g));for(let k=v;k<=m;k++){const P=k*t;for(let j=w;j<=x;j++){const S=j-n,M=k-a,O=S*S+M*M;if(O>b)continue;const E=Math.sqrt(O);let I=1;if(E>h){const Y=Math.max(1e-6,g-h);I=mr((g-E)/Y)}const D=mr(d*I),B=P+j,z=e[B];e[B]=s==="add"?z+(1-z)*D:z*(1-D)}}},_T=(e,t,r,n)=>{const a=n.center.x,i=n.center.y,o=Math.max(1,n.radiusX),s=Math.max(1,n.radiusY),l=Math.max(1,Math.min(o,s)),u=Math.max(0,Math.min(n.featherPx,l*.95)),d=n.rotationDeg*Math.PI/180,f=Math.cos(d),h=Math.sin(d),g=Math.ceil(Math.max(o,s))+2,b=Math.max(0,Math.floor(a-g)),w=Math.max(0,Math.floor(i-g)),v=Math.min(t-1,Math.ceil(a+g)),x=Math.min(r-1,Math.ceil(i+g));for(let m=w;m<=x;m++){const k=m*t;for(let P=b;P<=v;P++){const j=P-a,S=m-i,M=j*f+S*h,O=-j*h+S*f,E=Math.sqrt(M*M/(o*o)+O*O/(s*s));if(E>1)continue;let I=1;if(u>0){const z=(1-E)*l;I=mr(z/u)}const D=k+P,B=e[D];e[D]=n.mode==="add"?B+(1-B)*I:B*(1-I)}}},Gb=e=>{const t=new Float32Array(e.width*e.height);for(const r of e.items||[])if(r.visible)if(r.type==="ellipse")_T(t,e.width,e.height,r);else for(const n of r.points)PT(t,e.width,e.height,n.x,n.y,r.sizePx,r.opacity,r.mode,r.feather);return t};function y_(e){const t=e.masks.map(r=>{const n=Gb(r);return{...r,alpha:n,version:r.version+1}});return{...e,masks:t}}function CT(e){const t=e.width,r=e.height,n=e.alpha;let a=t,i=r,o=-1,s=-1;for(let u=0;u<r;u++){const d=u*t;for(let f=0;f<t;f++)n[d+f]<=1e-4||(f<a&&(a=f),u<i&&(i=u),f>o&&(o=f),u>s&&(s=u))}if(o<a||s<i)return null;const l=2;return{x0:Math.max(0,a-l),y0:Math.max(0,i-l),x1:Math.min(t-1,o+l),y1:Math.min(r-1,s+l)}}function Sk(e,t,r,n){return{id:e,width:t,height:r,baseRgb:n,masks:[],layers:[],guides:[],selectedGuideId:null,selectedMaskId:"",selectedLayerId:"",selectedMaskItemId:null,transform:{rotationDeg:0,crop:null},history:[{id:nc("history"),label:"Initialize PS Document",timestamp:Date.now()}],historyIndex:0}}function MT(e){const t=new Float32Array(e.length);for(let r=0;r<e.length;r++)t[r]=e[r]/65535;return t}function x_(e){const t=new Float32Array(e.width*e.height*3),r=e.data;for(let n=0,a=0;n<r.length;n+=4,a+=3)t[a]=r[n]/255,t[a+1]=r[n+1]/255,t[a+2]=r[n+2]/255;return t}async function NT(e){const t=e.naturalWidth||e.width,r=e.naturalHeight||e.height,n=document.createElement("canvas");n.width=t,n.height=r;const a=n.getContext("2d");if(!a)throw new Error("Failed to create 2D context for raster-to-float conversion.");a.drawImage(e,0,0,t,r);const i=a.getImageData(0,0,t,r);return{width:t,height:r,data:x_(i)}}function Ub(e){const t=nc("mask"),r=nc("layer"),n={id:t,name:`Mask ${e.masks.length+1}`,shape:"full",width:e.width,height:e.height,alpha:new Float32Array(e.width*e.height),version:1,featherPx:0,visible:!0,overlayVisible:!0,items:[]},a={id:r,name:`Layer ${e.layers.length+1}`,maskId:t,blendMode:"add",enabled:!0,opacity:1,basic:m_(),mixer:Fb(),curves:Lb()};return{...e,masks:[...e.masks,n],layers:[...e.layers,a],selectedMaskId:t,selectedLayerId:r,selectedMaskItemId:null}}function v_(e,t){if(!e.masks.some(o=>o.id===t))return e;const n=e.layers.find(o=>o.maskId===t);if(n)return{...e,selectedMaskId:t,selectedLayerId:n.id,selectedMaskItemId:null};const a=nc("layer"),i={id:a,name:`Layer ${e.layers.length+1}`,maskId:t,blendMode:"add",enabled:!0,opacity:1,basic:m_(),mixer:Fb(),curves:Lb()};return{...e,layers:[...e.layers,i],selectedMaskId:t,selectedLayerId:a,selectedMaskItemId:null}}function OT(e,t){const r=(e.width-1)*.5,n=(e.height-1)*.5,a=Math.max(8,e.width*.4),i=Math.max(8,e.height*.4),o={id:nc("guide"),orientation:t,p1:t==="horizontal"?{x:r-a*.5,y:n}:{x:r,y:n-i*.5},p2:t==="horizontal"?{x:r+a*.5,y:n}:{x:r,y:n+i*.5},visible:!0};return{...e,guides:[...e.guides,o],selectedGuideId:o.id}}function AT(e,t){return t===null?{...e,selectedGuideId:null}:e.guides.some(n=>n.id===t)?{...e,selectedGuideId:t}:e}function jk(e,t,r,n){const a=s=>({x:Math.max(0,Math.min(e.width-1,s.x)),y:Math.max(0,Math.min(e.height-1,s.y))});let i=!1;const o=e.guides.map(s=>{if(s.id!==t)return s;const l=a(r),u=a(n);return Math.abs(l.x-s.p1.x)<1e-6&&Math.abs(l.y-s.p1.y)<1e-6&&Math.abs(u.x-s.p2.x)<1e-6&&Math.abs(u.y-s.p2.y)<1e-6?s:(i=!0,{...s,p1:l,p2:u})});return i?{...e,guides:o}:e}function TT(e,t){const r=e.guides.filter(n=>n.id!==t);return r.length===e.guides.length?e:{...e,guides:r,selectedGuideId:e.selectedGuideId===t?null:e.selectedGuideId}}function ET(e,t,r=0,n="add"){var d;const a=e.selectedMaskId?e:Ub(e),i=a.selectedMaskId;if(!i)return a;const o=a.masks.map(f=>{if(f.id!==i)return f;const h=f.items||[],g={id:nc("item"),name:`Ellipse ${h.filter(v=>v.type==="ellipse").length+1}`,type:"ellipse",mode:n,visible:!0,center:{x:t.center.x,y:t.center.y},radiusX:Math.max(1,t.radiusX),radiusY:Math.max(1,t.radiusY),rotationDeg:t.rotationDeg??0,featherPx:Math.max(0,r)},b=[...h,g];return{...f,shape:"ellipse",items:b,alpha:Gb({...f,items:b}),version:f.version+1}}),s=o.find(f=>f.id===i),l=(s==null?void 0:s.items)||[],u=((d=l[l.length-1])==null?void 0:d.id)||null;return{...a,masks:o,selectedMaskItemId:u}}function IT(e,t,r,n,a,i,o=1){const s=e.selectedMaskId?e:Ub(e);if(!s.selectedMaskId)return s;const l=Math.max(1,n),u=mr(a),d=mr(o),f=l,h=l*(1+d*1.5),g=h*h,b=s.masks.map(w=>{if(w.id!==s.selectedMaskId)return w;const v=w.alpha,x=Math.max(0,Math.floor(t-h)),m=Math.max(0,Math.floor(r-h)),k=Math.min(w.width-1,Math.ceil(t+h)),P=Math.min(w.height-1,Math.ceil(r+h));for(let j=m;j<=P;j++){const S=j*w.width;for(let M=x;M<=k;M++){const O=M-t,E=j-r,I=O*O+E*E;if(I>g)continue;const D=Math.sqrt(I);let B=1;if(D>f){const $=Math.max(1e-6,h-f);B=mr((h-D)/$)}const z=mr(u*B),Y=S+M,G=v[Y];v[Y]=i==="add"?G+(1-G)*z:G*(1-z)}}return{...w,alpha:v,version:w.version+1}});return{...s,masks:b}}function $T(e,t,r,n,a,i){var d;if(!e.selectedMaskId||t.length===0)return e;const o=e.masks.map(f=>{if(f.id!==e.selectedMaskId)return f;const h=f.items||[],g=t.map(k=>({x:k.x,y:k.y})),b=Math.max(1,r),w=mr(n),v=mr(i),x=h[h.length-1];if(x&&x.type==="brush"&&FT(x,{points:g,sizePx:b,opacity:w,mode:a,feather:v})){const k=x.points[x.points.length-1],P=g.filter((S,M)=>M!==0||Math.hypot(S.x-k.x,S.y-k.y)>.5),j={...x,points:[...x.points,...P]};return{...f,shape:"brush",items:[...h.slice(0,-1),j]}}const m={id:nc("item"),name:`Brush ${h.filter(k=>k.type==="brush").length+1}`,type:"brush",mode:a,visible:!0,sizePx:b,opacity:w,feather:v,points:g};return{...f,shape:"brush",items:[...h,m]}}),s=o.find(f=>f.id===e.selectedMaskId),l=(s==null?void 0:s.items)||[],u=((d=l[l.length-1])==null?void 0:d.id)||null;return{...e,masks:o,selectedMaskItemId:u}}function DT(e,t){if(!t)return{...e,selectedMaskItemId:null};const r=e.selectedMaskId?e.masks.find(i=>i.id===e.selectedMaskId):null;if(r&&(r.items||[]).some(i=>i.id===t))return{...e,selectedMaskItemId:t};const n=e.masks.find(i=>(i.items||[]).some(o=>o.id===t));return n?{...v_(e,n.id),selectedMaskItemId:t}:{...e,selectedMaskItemId:null}}function RT(e,t,r){if(!e.selectedMaskId)return e;let n=!1;const a=e.masks.map(i=>{if(i.id!==e.selectedMaskId)return i;const o=(i.items||[]).map(s=>s.id!==t||s.type!=="ellipse"?s:(n=!0,{...s,...r,center:r.center?{x:r.center.x,y:r.center.y}:s.center,radiusX:r.radiusX!==void 0?Math.max(1,r.radiusX):s.radiusX,radiusY:r.radiusY!==void 0?Math.max(1,r.radiusY):s.radiusY,featherPx:r.featherPx!==void 0?Math.max(0,r.featherPx):s.featherPx}));return n?{...i,items:o,alpha:Gb({...i,items:o}),version:i.version+1}:i});return n?{...e,masks:a}:e}function BT(e,t,r){let n=!1;const a=e.masks.map(i=>i.id!==t||(i.overlayVisible??!0)===r?i:(n=!0,{...i,overlayVisible:r}));return n?{...e,masks:a}:e}const Qd=(e,t)=>[e[0]*t[0]+e[1]*t[3]+e[2]*t[6],e[0]*t[1]+e[1]*t[4]+e[2]*t[7],e[0]*t[2]+e[1]*t[5]+e[2]*t[8],e[3]*t[0]+e[4]*t[3]+e[5]*t[6],e[3]*t[1]+e[4]*t[4]+e[5]*t[7],e[3]*t[2]+e[4]*t[5]+e[5]*t[8],e[6]*t[0]+e[7]*t[3]+e[8]*t[6],e[6]*t[1]+e[7]*t[4]+e[8]*t[7],e[6]*t[2]+e[7]*t[5]+e[8]*t[8]],LT=e=>{const t=e[0],r=e[1],n=e[2],a=e[3],i=e[4],o=e[5],s=e[6],l=e[7],u=e[8],d=i*u-o*l,f=-(a*u-o*s),h=a*l-i*s,g=-(r*u-n*l),b=t*u-n*s,w=-(t*l-r*s),v=r*o-n*i,x=-(t*o-n*a),m=t*i-r*a,k=t*d+r*f+n*h;if(Math.abs(k)<1e-12)return null;const P=1/k;return[d*P,g*P,v*P,f*P,b*P,x*P,h*P,w*P,m*P]},Ha=(e,t)=>{const r=t.x,n=t.y,a=e[6]*r+e[7]*n+e[8];return Math.abs(a)<1e-12?{x:0,y:0}:{x:(e[0]*r+e[1]*n+e[2])/a,y:(e[3]*r+e[4]*n+e[5])/a}},FT=(e,t)=>{if(e.mode!==t.mode||Math.abs(e.sizePx-t.sizePx)>.25||Math.abs(e.opacity-t.opacity)>.02||Math.abs(e.feather-t.feather)>.02||e.points.length===0||t.points.length===0)return!1;const r=e.points[e.points.length-1],n=t.points[0],a=Math.hypot(r.x-n.x,r.y-n.y),i=Math.max(4,Math.min(e.sizePx,t.sizePx)*1.5);return a<=i},GT=(e,t)=>{const r=e.rotationDeg*Math.PI/180,n=Math.cos(r),a=Math.sin(r),i=-a,o=n,s=e.center,l={x:s.x+n*e.radiusX,y:s.y+a*e.radiusX},u={x:s.x+i*e.radiusY,y:s.y+o*e.radiusY},d=Ha(t,s),f=Ha(t,l),h=Ha(t,u),g=Math.max(1,Math.hypot(f.x-d.x,f.y-d.y)),b=Math.max(1,Math.hypot(h.x-d.x,h.y-d.y)),w=Math.atan2(f.y-d.y,f.x-d.x)*180/Math.PI;return{...e,center:d,radiusX:g,radiusY:b,rotationDeg:w}},nh=(e,t,r,n,a,i,o=0)=>{if(n<0||a<0||n>t-1||a>r-1)return 0;const s=Math.floor(n),l=Math.floor(a),u=Math.min(t-1,s+1),d=Math.min(r-1,l+1),f=n-s,h=a-l,g=(P,j)=>i===1?j*t+P:(j*t+P)*3+o,b=e[g(s,l)],w=e[g(u,l)],v=e[g(s,d)],x=e[g(u,d)],m=b*(1-f)+w*f,k=v*(1-f)+x*f;return m*(1-h)+k*h},b_=(e,t,r)=>{const a=[{x:0,y:0},{x:e-1,y:0},{x:e-1,y:t-1},{x:0,y:t-1}].map(s=>Ha(r,s)),i=a.map(s=>s.x),o=a.map(s=>s.y);return{minX:Math.min(...i),maxX:Math.max(...i),minY:Math.min(...o),maxY:Math.max(...o)}},w_=(e,t)=>{const r=b_(e.width,e.height,t),n=-r.minX,a=-r.minY,o=Qd([1,0,n,0,1,a,0,0,1],t),s=LT(o);if(!s)return e;const l=Math.max(1,Math.ceil(r.maxX-r.minX+1)),u=Math.max(1,Math.ceil(r.maxY-r.minY+1)),d=new Float32Array(l*u*3);for(let g=0;g<u;g++)for(let b=0;b<l;b++){const w=Ha(s,{x:b,y:g}),v=(g*l+b)*3;d[v]=nh(e.baseRgb,e.width,e.height,w.x,w.y,3,0),d[v+1]=nh(e.baseRgb,e.width,e.height,w.x,w.y,3,1),d[v+2]=nh(e.baseRgb,e.width,e.height,w.x,w.y,3,2)}const f=e.masks.map(g=>{const b=new Float32Array(l*u);for(let v=0;v<u;v++)for(let x=0;x<l;x++){const m=Ha(s,{x,y:v});b[v*l+x]=nh(g.alpha,g.width,g.height,m.x,m.y,1)}const w=(g.items||[]).map(v=>v.type==="brush"?{...v,points:v.points.map(x=>Ha(o,x)).filter(x=>x.x>=0&&x.y>=0&&x.x<=l-1&&x.y<=u-1)}:GT(v,o)).filter(v=>v.type==="ellipse"?v.center.x>=-Math.max(v.radiusX,v.radiusY)&&v.center.y>=-Math.max(v.radiusX,v.radiusY)&&v.center.x<=l-1+Math.max(v.radiusX,v.radiusY)&&v.center.y<=u-1+Math.max(v.radiusX,v.radiusY):v.points.length>0);return{...g,width:l,height:u,alpha:b,version:g.version+1,featherPx:0,items:w}}),h=e.guides.map(g=>({...g,p1:Ha(o,g.p1),p2:Ha(o,g.p2)}));return{...e,width:l,height:u,baseRgb:d,masks:f,guides:h,selectedMaskItemId:f.some(g=>(g.items||[]).some(b=>b.id===e.selectedMaskItemId))?e.selectedMaskItemId:null,transform:{rotationDeg:0,crop:null}}},UT=(e,t,r,n,a,i)=>{let o=0,s=1;const l=t.x-e.x,u=t.y-e.y,d=(f,h)=>{if(Math.abs(f)<1e-12)return h>=0;const g=h/f;return f<0?g>s?!1:(g>o&&(o=g),!0):g<o?!1:(g<s&&(s=g),!0)};return!d(-l,e.x-r)||!d(l,a-e.x)||!d(-u,e.y-n)||!d(u,i-e.y)?null:{p1:{x:e.x+o*l,y:e.y+o*u},p2:{x:e.x+s*l,y:e.y+s*u}}};function k_(e,t){const r=Math.max(0,Math.min(e.width-1,Math.floor(t.x))),n=Math.max(0,Math.min(e.height-1,Math.floor(t.y))),a=Math.max(r+1,Math.min(e.width,Math.ceil(t.x+t.w))),i=Math.max(n+1,Math.min(e.height,Math.ceil(t.y+t.h))),o=a-r,s=i-n;if(o===e.width&&s===e.height&&r===0&&n===0)return e;const l=new Float32Array(o*s*3);for(let f=0;f<s;f++)for(let h=0;h<o;h++){const g=((f+n)*e.width+(h+r))*3,b=(f*o+h)*3;l[b]=e.baseRgb[g],l[b+1]=e.baseRgb[g+1],l[b+2]=e.baseRgb[g+2]}const u=e.masks.map(f=>{const h=new Float32Array(o*s);for(let b=0;b<s;b++)for(let w=0;w<o;w++)h[b*o+w]=f.alpha[(b+n)*f.width+(w+r)];const g=(f.items||[]).map(b=>b.type==="brush"?{...b,points:b.points.map(w=>({x:w.x-r,y:w.y-n})).filter(w=>w.x>=0&&w.y>=0&&w.x<=o-1&&w.y<=s-1)}:{...b,center:{x:b.center.x-r,y:b.center.y-n}}).filter(b=>b.type==="ellipse"?b.center.x>=-Math.max(b.radiusX,b.radiusY)&&b.center.y>=-Math.max(b.radiusX,b.radiusY)&&b.center.x<=o-1+Math.max(b.radiusX,b.radiusY)&&b.center.y<=s-1+Math.max(b.radiusX,b.radiusY):b.points.length>0);return{...f,width:o,height:s,alpha:h,version:f.version+1,featherPx:0,items:g}}),d=e.guides.map(f=>{const h=UT(f.p1,f.p2,r,n,a-1,i-1);return h?{...f,p1:{x:h.p1.x-r,y:h.p1.y-n},p2:{x:h.p2.x-r,y:h.p2.y-n}}:null}).filter(Boolean);return{...e,width:o,height:s,baseRgb:l,masks:u,guides:d,selectedGuideId:d.some(f=>f.id===e.selectedGuideId)?e.selectedGuideId:null,selectedMaskItemId:u.some(f=>(f.items||[]).some(h=>h.id===e.selectedMaskItemId))?e.selectedMaskItemId:null,transform:{rotationDeg:0,crop:null}}}function S_(e,t){const r=t*Math.PI/180,n=Math.cos(r),a=Math.sin(r),i=(e.width-1)*.5,o=(e.height-1)*.5,s=[1,0,-i,0,1,-o,0,0,1],l=[n,-a,0,a,n,0,0,0,1],d=Qd([1,0,i,0,1,o,0,0,1],Qd(l,s)),f=b_(e.width,e.height,d),h=Qd([1,0,-f.minX,0,1,-f.minY,0,0,1],d),g=w_(e,d),b=g.masks.map(w=>{const v=e.masks.find(m=>m.id===w.id);if(!v)return w;const x=(v.items||[]).map(m=>m.type==="brush"?{...m,points:m.points.map(k=>Ha(h,k)).filter(k=>k.x>=0&&k.y>=0&&k.x<=g.width-1&&k.y<=g.height-1)}:{...m,center:Ha(h,m.center),rotationDeg:m.rotationDeg+t}).filter(m=>m.type==="ellipse"?!0:m.points.length>0);return{...w,items:x}});return{...g,masks:b,selectedMaskItemId:b.some(w=>(w.items||[]).some(v=>v.id===e.selectedMaskItemId))?e.selectedMaskItemId:null}}function j_(e){const t=e.width,r=e.height,n=new Float32Array(e.baseRgb.length);for(let i=0;i<r;i++)for(let o=0;o<t;o++){const s=t-1-o,l=(i*t+s)*3,u=(i*t+o)*3;n[u]=e.baseRgb[l],n[u+1]=e.baseRgb[l+1],n[u+2]=e.baseRgb[l+2]}const a=e.masks.map(i=>{const o=new Float32Array(i.alpha.length);for(let s=0;s<r;s++)for(let l=0;l<t;l++)o[s*t+l]=i.alpha[s*t+(t-1-l)];return{...i,alpha:o,version:i.version+1,items:(i.items||[]).map(s=>s.type==="brush"?{...s,points:s.points.map(l=>({x:t-1-l.x,y:l.y}))}:{...s,center:{x:t-1-s.center.x,y:s.center.y},rotationDeg:-s.rotationDeg})}});return{...e,baseRgb:n,masks:a,guides:e.guides.map(i=>({...i,p1:{x:t-1-i.p1.x,y:i.p1.y},p2:{x:t-1-i.p2.x,y:i.p2.y}}))}}function P_(e){const t=e.width,r=e.height,n=new Float32Array(e.baseRgb.length);for(let i=0;i<r;i++){const o=r-1-i;for(let s=0;s<t;s++){const l=(o*t+s)*3,u=(i*t+s)*3;n[u]=e.baseRgb[l],n[u+1]=e.baseRgb[l+1],n[u+2]=e.baseRgb[l+2]}}const a=e.masks.map(i=>{const o=new Float32Array(i.alpha.length);for(let s=0;s<r;s++){const l=r-1-s;for(let u=0;u<t;u++)o[s*t+u]=i.alpha[l*t+u]}return{...i,alpha:o,version:i.version+1,items:(i.items||[]).map(s=>s.type==="brush"?{...s,points:s.points.map(l=>({x:l.x,y:r-1-l.y}))}:{...s,center:{x:s.center.x,y:r-1-s.center.y},rotationDeg:-s.rotationDeg})}});return{...e,baseRgb:n,masks:a,guides:e.guides.map(i=>({...i,p1:{x:i.p1.x,y:r-1-i.p1.y},p2:{x:i.p2.x,y:r-1-i.p2.y}}))}}const Lh=(e,t)=>[e[1]*t[2]-e[2]*t[1],e[2]*t[0]-e[0]*t[2],e[0]*t[1]-e[1]*t[0]],ah=(e,t)=>Lh([e.x,e.y,1],[t.x,t.y,1]),iv=(e,t)=>{const r=Math.hypot(e,t);return r<1e-8?null:{x:e/r,y:t/r}},Pk=e=>{if(e.length===0)return null;let t=0,r=0;for(const n of e)t*n.x+r*n.y<0?(t-=n.x,r-=n.y):(t+=n.x,r+=n.y);return iv(t,r)};function __(e){const t=e.guides.filter(O=>O.visible!==!1&&O.orientation==="horizontal").slice(0,2),r=e.guides.filter(O=>O.visible!==!1&&O.orientation==="vertical").slice(0,2);if(t.length<2||r.length<2)return e;const n=ah(t[0].p1,t[0].p2),a=ah(t[1].p1,t[1].p2),i=ah(r[0].p1,r[0].p2),o=ah(r[1].p1,r[1].p2),s=Lh(n,a),l=Lh(i,o),u=Lh(s,l);if(Math.abs(u[2])<1e-12)return e;const d=u[0]/u[2],f=u[1]/u[2],h=[1,0,0,0,1,0,d,f,1],g=t.map(O=>{const E=Ha(h,O.p1),I=Ha(h,O.p2);return iv(I.x-E.x,I.y-E.y)}).filter(Boolean),b=r.map(O=>{const E=Ha(h,O.p1),I=Ha(h,O.p2);return iv(I.x-E.x,I.y-E.y)}).filter(Boolean),w=Pk(g),v=Pk(b);if(!w||!v)return e;const x=w.x*v.y-w.y*v.x;if(Math.abs(x)<1e-8)return e;const m=1/x,k=v.y*m,P=-v.x*m,j=-w.y*m,S=w.x*m;return w_(e,Qd([k,P,0,j,S,0,0,0,1],h))}function zT(e,t,r){const n=Math.max(e,t,r),a=Math.min(e,t,r),i=(n+a)/2;if(n===a)return[0,0,i];const o=n-a,s=i>.5?o/(2-n-a):o/(n+a);let l=0;switch(n){case e:l=(t-r)/o+(t<r?6:0);break;case t:l=(r-e)/o+2;break;default:l=(e-t)/o+4;break}return l/=6,[l,s,i]}function wy(e,t,r){let n=r;return n<0&&(n+=1),n>1&&(n-=1),n<1/6?e+(t-e)*6*n:n<1/2?t:n<2/3?e+(t-e)*(2/3-n)*6:e}function WT(e,t,r){if(t===0)return[r,r,r];const n=r<.5?r*(1+t):r+t-r*t,a=2*r-n;return[wy(a,n,e+1/3),wy(a,n,e),wy(a,n,e-1/3)]}const HT=[0,30,60,120,180,240,285,320],C_=e=>{const t=[],r=[],n=[];let a=!1;for(const i of jT){const o=e[i];t.push(o.hue),r.push(o.saturation),n.push(o.luminance),(Math.abs(o.hue)>1e-6||Math.abs(o.saturation)>1e-6||Math.abs(o.luminance)>1e-6)&&(a=!0)}return{hue:t,saturation:r,luminance:n,hasAdjust:a}},_k=(e,t,r)=>{if(Math.abs(t-e)<1e-9)return r<e?0:1;const n=mr((r-e)/(t-e));return n*n*(3-2*n)},Nc=(e,t,r)=>{const n=Math.max(-1,Math.min(1,t)),a=mr(r);return n>=0?e+(1-e)*n*a:e+e*n*a};function M_(e,t,r,n,a,i){let o=e,s=t,l=r;if(n.exposure!==0){const x=Math.pow(2,n.exposure);o*=x,s*=x,l*=x}if(n.temperature!==0||n.tint!==0){const x=n.temperature/100,m=n.tint/100;o*=1+.18*x+.08*m,s*=1-.16*m,l*=1-.18*x+.08*m}if(n.contrast!==0){const x=1+n.contrast/100;o=(o-.5)*x+.5,s=(s-.5)*x+.5,l=(l-.5)*x+.5}if(n.highlights!==0||n.shadows!==0){const x=mr(o*.2126+s*.7152+l*.0722),m=_k(.5,1,x),k=1-_k(0,.5,x);if(n.highlights!==0){const P=n.highlights/100;o=Nc(o,P,m),s=Nc(s,P,m),l=Nc(l,P,m)}if(n.shadows!==0){const P=n.shadows/100;o=Nc(o,P,k),s=Nc(s,P,k),l=Nc(l,P,k)}}if(n.vibrance!==0||n.saturation!==0||a.hasAdjust){let[x,m,k]=zT(mr(o),mr(s),mr(l));if(n.vibrance!==0){const P=n.vibrance/100;m=P>=0?mr(m+P*(1-m)):mr(m+P*m)}if(n.saturation!==0&&(m=mr(m+n.saturation/100)),a.hasAdjust){const P=(x%1+1)%1*360;let j=0,S=0,M=0,O=0;for(let E=0;E<8;E++){const I=HT[E];let D=Math.abs(P-I);D>180&&(D=360-D);const B=mr(1-D/45);B<=0||(j+=B,S+=B*a.hue[E],M+=B*a.saturation[E],O+=B*a.luminance[E])}if(j>1e-6){const E=mr((m-.03)/.25),I=1/j,D=S*I/100*(45/360)*E;x=(x+D)%1,x<0&&(x+=1),m=mr(m+M*I/100*E),k=mr(k+O*I/100*E)}}[o,s,l]=WT(x,m,k)}const d=Math.max(0,o*.2126+s*.7152+l*.0722),f=Math.min(255,Math.max(0,Math.round(mr(d)*255))),h=i.master[f],g=d>1e-6?h/d:1,b=mr(o*g),w=mr(s*g),v=mr(l*g);return o=i.red[Math.min(255,Math.max(0,Math.round(b*255)))],s=i.green[Math.min(255,Math.max(0,Math.round(w*255)))],l=i.blue[Math.min(255,Math.max(0,Math.round(v*255)))],[o,s,l]}function ov(e){const t=new Float32Array(e.baseRgb),r=new Map,n=new Map,a=e.width*e.height;for(const s of e.layers)s.enabled&&r.set(s.maskId,s);for(const s of e.masks){const l=r.get(s.id);if(!l||!l.enabled||!s.visible)continue;const u=g0(l.basic),d=m0(l.mixer),f=C_(d),h=Lg(l.curves),g=`${l.id}:${JSON.stringify(h)}`;let b=n.get(g);b||(b={master:Ia(h.master),red:Ia(h.red),green:Ia(h.green),blue:Ia(h.blue)},n.set(g,b));const w=s.alpha,v=mr(l.opacity);for(let x=0;x<a;x++){const m=mr(w[x]*v);if(m<=0)continue;const k=x*3,P=t[k],j=t[k+1],S=t[k+2],[M,O,E]=M_(P,j,S,u,f,b),I=l.blendMode==="subtract"?2*P-M:M,D=l.blendMode==="subtract"?2*j-O:O,B=l.blendMode==="subtract"?2*S-E:E;t[k]=P*(1-m)+I*m,t[k+1]=j*(1-m)+D*m,t[k+2]=S*(1-m)+B*m}}const i=new ImageData(e.width,e.height),o=i.data;for(let s=0,l=0;s<a;s++,l+=3){const u=s*4;o[u]=Math.round(mr(t[l])*255),o[u+1]=Math.round(mr(t[l+1])*255),o[u+2]=Math.round(mr(t[l+2])*255),o[u+3]=255}return i}function VT(e,t,r){if(t.width!==e.width||t.height!==e.height)return ov(e);const n=Math.max(0,Math.floor(r.x0)),a=Math.max(0,Math.floor(r.y0)),i=Math.min(e.width-1,Math.ceil(r.x1)),o=Math.min(e.height-1,Math.ceil(r.y1));if(i<n||o<a)return t;const s=new Uint8ClampedArray(t.data),l=new ImageData(s,e.width,e.height),u=l.data,d=new Map,f=new Map;for(const g of e.layers)g.enabled&&d.set(g.maskId,g);const h=[];for(const g of e.masks){const b=d.get(g.id);if(!b||!b.enabled||!g.visible)continue;const w=g0(b.basic),v=m0(b.mixer),x=C_(v),m=Lg(b.curves),k=`${b.id}:${JSON.stringify(m)}`;let P=f.get(k);P||(P={master:Ia(m.master),red:Ia(m.red),green:Ia(m.green),blue:Ia(m.blue)},f.set(k,P)),h.push({mask:g,layer:b,alpha:g.alpha,opacity:mr(b.opacity),basic:w,mixerArrays:x,lutPack:P})}for(let g=a;g<=o;g++){const b=g*e.width;for(let w=n;w<=i;w++){const v=b+w,x=v*3;let m=e.baseRgb[x],k=e.baseRgb[x+1],P=e.baseRgb[x+2];for(const S of h){const M=mr(S.alpha[v]*S.opacity);if(M<=0)continue;const[O,E,I]=M_(m,k,P,S.basic,S.mixerArrays,S.lutPack),D=S.layer.blendMode==="subtract"?2*m-O:O,B=S.layer.blendMode==="subtract"?2*k-E:E,z=S.layer.blendMode==="subtract"?2*P-I:I;m=m*(1-M)+D*M,k=k*(1-M)+B*M,P=P*(1-M)+z*M}const j=v*4;u[j]=Math.round(mr(m)*255),u[j+1]=Math.round(mr(k)*255),u[j+2]=Math.round(mr(P)*255),u[j+3]=255}}return l}const Ck=[{id:"red",label:"Red",color:"#ef4444"},{id:"orange",label:"Orange",color:"#fb923c"},{id:"yellow",label:"Yellow",color:"#facc15"},{id:"green",label:"Green",color:"#22c55e"},{id:"aqua",label:"Aqua",color:"#14b8a6"},{id:"blue",label:"Blue",color:"#3b82f6"},{id:"purple",label:"Purple",color:"#8b5cf6"},{id:"magenta",label:"Magenta",color:"#d946ef"}],Mk={exposure:0,temperature:0,tint:0,contrast:0,highlights:0,shadows:0,vibrance:0,saturation:0},Nk={red:{hue:0,saturation:0,luminance:0},orange:{hue:0,saturation:0,luminance:0},yellow:{hue:0,saturation:0,luminance:0},green:{hue:0,saturation:0,luminance:0},aqua:{hue:0,saturation:0,luminance:0},blue:{hue:0,saturation:0,luminance:0},purple:{hue:0,saturation:0,luminance:0},magenta:{hue:0,saturation:0,luminance:0}},XT=e=>{const t=[...e].sort((l,u)=>l.x-u.x),r=t.length,n=t.map(l=>l.x),a=t.map(l=>l.y);if(r<2)return l=>r===1?a[0]:0;const i=new Array(r-1).fill(0);for(let l=0;l<r-1;l++){const u=n[l+1]-n[l],d=a[l+1]-a[l];i[l]=u!==0?d/u:0}const o=new Array(r).fill(0);o[0]=i[0],o[r-1]=i[r-2];for(let l=1;l<r-1;l++)i[l-1]*i[l]<=0?o[l]=0:o[l]=(i[l-1]+i[l])/2;for(let l=0;l<r-1;l++){if(i[l]===0){o[l]=0,o[l+1]=0;continue}const u=o[l]/i[l],d=o[l+1]/i[l],f=u*u+d*d;if(f>9){const h=3/Math.sqrt(f);o[l]=h*u*i[l],o[l+1]=h*d*i[l]}}const s=(l,u)=>{const d=n[l],f=n[l+1],h=a[l],g=a[l+1],b=f-d;if(b<=0)return h;const w=(u-d)/b,v=w*w,x=v*w,m=2*x-3*v+1,k=x-2*v+w,P=-2*x+3*v,j=x-v;return Math.max(0,Math.min(1,m*h+k*b*o[l]+P*g+j*b*o[l+1]))};return l=>{if(l<=n[0])return a[0];if(l>=n[r-1])return a[r-1];let u=0;for(;u<r-2&&l>n[u+1];)u++;return s(u,l)}},KT=({channel:e,points:t,onChange:r})=>{const n=_.useRef(null),[a,i]=_.useState(null),[o,s]=_.useState(()=>[...t].sort((w,v)=>w.x-v.x)),l=_.useRef(o),u=w=>{l.current=w,s(w)};_.useEffect(()=>{if(a!==null)return;const w=[...t].sort((v,x)=>v.x-x.x);u(w)},[t,a]);const d=_.useMemo(()=>[...o].sort((w,v)=>w.x-v.x),[o]),f=_.useMemo(()=>{if(d.length<2)return"";const w=XT(d);let v=`M ${d[0].x*256} ${256-d[0].y*256}`;for(let x=1;x<=120;x++){const m=x/120,k=w(m);v+=` L ${m*256} ${256-k*256}`}return v},[d]),h=w=>{if(!n.current)return{x:0,y:0};const v=n.current.getBoundingClientRect();return{x:Math.max(0,Math.min(1,(w.clientX-v.left)/v.width)),y:Math.max(0,Math.min(1,1-(w.clientY-v.top)/v.height))}},g=w=>{if(a!==null)return;const v=h(w);if(d.some(m=>Math.abs(m.x-v.x)<.04))return;const x=[...d,v].sort((m,k)=>m.x-k.x);u(x),r(x)};_.useEffect(()=>{const w=x=>{if(a===null)return;const m=h(x),k=[...l.current].sort((M,O)=>M.x-O.x);let P=0,j=1;a>0&&(P=k[a-1].x+.01),a<k.length-1&&(j=k[a+1].x-.01),a===0?m.x=0:a===k.length-1?m.x=1:m.x=Math.max(P,Math.min(j,m.x));const S=[...k];S[a]=m,u(S)},v=()=>{if(a!==null){const x=[...l.current].sort((m,k)=>m.x-k.x);r(x)}i(null)};return a!==null&&(window.addEventListener("mousemove",w),window.addEventListener("mouseup",v)),()=>{window.removeEventListener("mousemove",w),window.removeEventListener("mouseup",v)}},[a,r,d]);const b=e==="master"?"#94a3b8":e==="red"?"#ef4444":e==="green"?"#22c55e":"#3b82f6";return c.jsx("div",{className:"w-full aspect-square bg-white dark:bg-slate-900 border border-gray-300 dark:border-slate-700 rounded relative select-none",children:c.jsxs("svg",{ref:n,width:"100%",height:"100%",viewBox:"0 0 256 256",className:"cursor-crosshair",onMouseDown:g,children:[c.jsx("path",{d:"M64,0 v256 M128,0 v256 M192,0 v256",stroke:"rgba(128,128,128,0.2)",strokeDasharray:"4 4"}),c.jsx("path",{d:"M0,64 h256 M0,128 h256 M0,192 h256",stroke:"rgba(128,128,128,0.2)",strokeDasharray:"4 4"}),c.jsx("line",{x1:"0",y1:"256",x2:"256",y2:"0",stroke:"rgba(128,128,128,0.1)"}),c.jsx("path",{d:f,fill:"none",stroke:b,strokeWidth:"2"}),d.map((w,v)=>c.jsx("circle",{cx:w.x*256,cy:256-w.y*256,r:a===v?6:4,fill:b,stroke:"white",strokeWidth:"1.5",className:"cursor-pointer",onMouseDown:x=>{x.stopPropagation(),x.preventDefault(),i(v)},onDoubleClick:x=>{if(x.stopPropagation(),v===0||v===d.length-1)return;const m=d.filter((k,P)=>P!==v);u(m),r(m)}},v))]})})},qi=({value:e,min:t,max:r,step:n,className:a,onCommit:i,resetValue:o=0})=>{const[s,l]=_.useState(e),u=_.useRef(!1);_.useEffect(()=>{u.current||l(e)},[e]);const d=()=>{const h=Math.max(t,Math.min(r,s));u.current=!1,Math.abs(h-e)>1e-9&&i(h)},f=()=>{const h=Math.max(t,Math.min(r,o));u.current=!1,l(h),Math.abs(h-e)>1e-9&&i(h)};return c.jsx("input",{type:"range",min:t,max:r,step:n,value:s,onChange:h=>l(Number(h.target.value)),onPointerDown:()=>{u.current=!0},onPointerUp:d,onPointerCancel:d,onMouseUp:d,onTouchEnd:d,onBlur:d,onDoubleClick:f,className:a})},YT=({inline:e=!1,doc:t,brushEnabled:r,brushSize:n,brushOpacity:a,brushFeather:i,ellipseFeather:o,brushMode:s,onAddMask:l,onAddEllipseMask:u,onCancelEllipseTool:d,onSelectLayer:f,onSelectMask:h,onBindLayerMask:g,onSetLayerBlendMode:b,onSetLayerOpacity:w,onSetLayerBasic:v,onSetLayerMixer:x,onSetLayerCurves:m,onSelectMaskItem:k,onUpdateEllipseItem:P,onSetMaskOverlayVisible:j,onBrushEnabledChange:S,onBrushSizeChange:M,onBrushOpacityChange:O,onBrushFeatherChange:E,onEllipseFeatherChange:I,onBrushModeChange:D})=>{var ve,ye,ge;const[B,z]=_.useState("master"),[Y,G]=_.useState("orange"),[$,L]=_.useState(null),[U,V]=_.useState(!1),[J,K]=_.useState(!1),Q=e?"w-full p-2 bg-white dark:bg-black border border-gray-300 dark:border-slate-700 text-xs":"absolute top-3 right-3 z-40 w-80 max-h-[90%] overflow-y-auto p-3 bg-white/95 dark:bg-black/95 border-2 border-black dark:border-white shadow-[6px_6px_0px_rgba(0,0,0,0.6)] text-xs";if(!t)return c.jsx("div",{className:e?"w-full p-2 bg-white dark:bg-black border border-gray-300 dark:border-slate-700":"absolute top-3 right-3 z-40 w-80 p-3 bg-white/90 dark:bg-black/90 border-2 border-black dark:border-white",children:c.jsx("p",{className:"text-xs font-bold",children:"PS document not ready."})});const te=t.masks.find(ue=>ue.id===t.selectedMaskId)||null,ee=te&&t.layers.find(ue=>ue.maskId===te.id)||null,me=((ve=te==null?void 0:te.items)==null?void 0:ve.find(ue=>ue.id===t.selectedMaskItemId))||null,re=me&&me.type==="ellipse"?me:null,De=Lg(ee==null?void 0:ee.curves),fe=(ee==null?void 0:ee.basic)||Mk,de=((ee==null?void 0:ee.mixer)||Nk)[Y]||{hue:0,saturation:0,luminance:0};_.useEffect(()=>{z("master"),G("orange")},[ee==null?void 0:ee.id]),_.useEffect(()=>{te&&L(te.id)},[te==null?void 0:te.id]);const Se=(ue,Le,rt)=>{v(ue.id,{...ue.basic||Mk,[Le]:rt})},he=(ue,Le,rt,et)=>{const tt=ue.mixer||Nk;x(ue.id,{...tt,[Le]:{...tt[Le]||{hue:0,saturation:0,luminance:0},[rt]:et}})},Pe=ue=>{ee&&m(ee.id,{...De,[B]:ue})};return c.jsxs("div",{className:Q,children:[c.jsx("div",{className:"font-bold mb-2",children:"PS Masks"}),c.jsxs("div",{className:"grid grid-cols-3 gap-2 mb-3",children:[c.jsx("button",{onClick:l,className:"px-2 py-1 bg-cyan-600 text-white font-bold border border-black",children:"+ Mask"}),c.jsx("button",{onClick:()=>{const ue=!U;V(ue),S(ue)},className:`px-2 py-1 font-bold border border-black ${U?"bg-white text-black":"bg-emerald-600 text-white"}`,children:"+ Brush"}),c.jsx("button",{onClick:()=>{const ue=!J;K(ue),ue?u():d()},className:`px-2 py-1 font-bold border border-black ${J?"bg-white text-black":"bg-violet-600 text-white"}`,children:"+ Ellipse"})]}),J&&c.jsxs("label",{className:"block mb-3",children:[c.jsxs("span",{className:"block mb-1",children:["New Ellipse Feather ",Math.round(o)," px"]}),c.jsx("input",{type:"range",min:0,max:256,step:1,value:o,onChange:ue=>I(Number(ue.target.value)),className:"w-full"})]}),c.jsxs("div",{className:"mb-3",children:[c.jsx("div",{className:"font-semibold mb-1",children:"Masks"}),c.jsxs("div",{className:"space-y-1 max-h-52 overflow-auto border border-gray-300 dark:border-slate-700 p-1",children:[t.masks.map(ue=>c.jsxs("div",{className:"border border-gray-300 dark:border-slate-700",children:[c.jsxs("div",{className:"flex",children:[c.jsx("button",{onClick:()=>L($===ue.id?null:ue.id),className:"w-7 px-1 py-1 border-r border-gray-300 dark:border-slate-700 bg-gray-100 dark:bg-slate-800",title:$===ue.id?"Collapse mask":"Expand mask",children:$===ue.id?"v":">"}),c.jsx("button",{onClick:()=>h(ue.id),className:`flex-1 text-left px-2 py-1 ${t.selectedMaskId===ue.id?"bg-emerald-100 dark:bg-emerald-900/40":"bg-white dark:bg-slate-900"}`,children:ue.name}),c.jsx("button",{onClick:()=>j(ue.id,!(ue.overlayVisible??!0)),className:`px-2 py-1 border-l border-gray-300 dark:border-slate-700 text-[11px] font-bold ${ue.overlayVisible??!0?"bg-rose-100 dark:bg-rose-900/40 text-rose-700 dark:text-rose-300":"bg-gray-100 dark:bg-slate-800 text-gray-500 dark:text-slate-400"}`,title:"Toggle red mask overlay",children:"Eye"})]}),$===ue.id&&c.jsxs("div",{className:"p-1 border-t border-gray-300 dark:border-slate-700 space-y-1 bg-gray-50 dark:bg-slate-900/40",children:[(ue.items||[]).map(Le=>c.jsxs("button",{onClick:()=>k(Le.id),className:`w-full text-left px-2 py-1 border text-[11px] ${t.selectedMaskId===ue.id&&t.selectedMaskItemId===Le.id?"bg-violet-100 dark:bg-violet-900/40 border-violet-500":"bg-white dark:bg-slate-900 border-gray-300 dark:border-slate-700"}`,children:[(Le.type==="brush",Le.name)," (",Le.mode==="add"?"Add":"Subtract",")"]},Le.id)),(ue.items||[]).length===0&&c.jsx("div",{className:"px-2 py-1 text-[11px] text-gray-500",children:"No brush/ellipse items."})]})]},ue.id)),t.masks.length===0&&c.jsx("div",{className:"px-2 py-2 text-[11px] text-gray-500",children:"No masks yet."})]})]}),U&&c.jsxs("div",{className:"mb-3 border border-gray-300 dark:border-slate-700 p-2",children:[c.jsx("div",{className:"font-semibold mb-2",children:"Brush"}),c.jsx("div",{className:"grid grid-cols-1 gap-2 mb-2",children:c.jsxs("select",{value:s,onChange:ue=>D(ue.target.value),className:"border border-gray-400 dark:border-slate-600 bg-white dark:bg-slate-900 p-1",children:[c.jsx("option",{value:"add",children:"Paint Add"}),c.jsx("option",{value:"subtract",children:"Paint Subtract"})]})}),c.jsxs("label",{className:"block mb-2",children:[c.jsxs("span",{className:"block mb-1",children:["Size ",n,"px"]}),c.jsx("input",{type:"range",min:1,max:200,step:1,value:n,onChange:ue=>M(Number(ue.target.value)),className:"w-full"})]}),c.jsxs("label",{className:"block mb-2",children:[c.jsxs("span",{className:"block mb-1",children:["Opacity ",a.toFixed(2)]}),c.jsx("input",{type:"range",min:.01,max:1,step:.01,value:a,onChange:ue=>O(Number(ue.target.value)),className:"w-full"})]}),c.jsxs("label",{className:"block",children:[c.jsxs("span",{className:"block mb-1",children:["Feather ",Math.round(i*100),"%"]}),c.jsx("input",{type:"range",min:0,max:1,step:.01,value:i,onChange:ue=>E(Number(ue.target.value)),className:"w-full"})]})]}),re&&c.jsxs("div",{className:"mb-3 border border-gray-300 dark:border-slate-700 p-2",children:[c.jsx("div",{className:"font-semibold mb-2",children:"Selected Ellipse"}),c.jsxs("label",{className:"block mb-2",children:[c.jsx("span",{className:"block mb-1",children:"Mode"}),c.jsxs("select",{value:re.mode,onChange:ue=>P(re.id,{mode:ue.target.value}),className:"w-full border border-gray-400 dark:border-slate-600 bg-white dark:bg-slate-900 p-1",children:[c.jsx("option",{value:"add",children:"Add"}),c.jsx("option",{value:"subtract",children:"Subtract"})]})]}),c.jsxs("div",{className:"grid grid-cols-2 gap-2 mb-2",children:[c.jsxs("label",{className:"text-[11px]",children:[c.jsx("span",{className:"block mb-1",children:"Center X"}),c.jsx("input",{type:"number",step:1,value:re.center.x,onChange:ue=>P(re.id,{center:{...re.center,x:Number(ue.target.value)}}),className:"w-full border border-gray-400 dark:border-slate-600 bg-white dark:bg-slate-900 p-1"})]}),c.jsxs("label",{className:"text-[11px]",children:[c.jsx("span",{className:"block mb-1",children:"Center Y"}),c.jsx("input",{type:"number",step:1,value:re.center.y,onChange:ue=>P(re.id,{center:{...re.center,y:Number(ue.target.value)}}),className:"w-full border border-gray-400 dark:border-slate-600 bg-white dark:bg-slate-900 p-1"})]}),c.jsxs("label",{className:"text-[11px]",children:[c.jsx("span",{className:"block mb-1",children:"Radius X"}),c.jsx("input",{type:"number",min:1,step:1,value:re.radiusX,onChange:ue=>P(re.id,{radiusX:Number(ue.target.value)}),className:"w-full border border-gray-400 dark:border-slate-600 bg-white dark:bg-slate-900 p-1"})]}),c.jsxs("label",{className:"text-[11px]",children:[c.jsx("span",{className:"block mb-1",children:"Radius Y"}),c.jsx("input",{type:"number",min:1,step:1,value:re.radiusY,onChange:ue=>P(re.id,{radiusY:Number(ue.target.value)}),className:"w-full border border-gray-400 dark:border-slate-600 bg-white dark:bg-slate-900 p-1"})]})]}),c.jsxs("label",{className:"block mb-2",children:[c.jsxs("span",{className:"block mb-1",children:["Rotation ",re.rotationDeg.toFixed(1)," deg"]}),c.jsx("input",{type:"range",min:-180,max:180,step:.1,value:re.rotationDeg,onChange:ue=>P(re.id,{rotationDeg:Number(ue.target.value)}),className:"w-full"})]}),c.jsxs("label",{className:"block",children:[c.jsxs("span",{className:"block mb-1",children:["Feather ",Math.round(re.featherPx)," px"]}),c.jsx("input",{type:"range",min:0,max:512,step:1,value:re.featherPx,onChange:ue=>P(re.id,{featherPx:Number(ue.target.value)}),className:"w-full"})]})]}),ee&&c.jsxs("div",{className:"mb-3 border border-gray-300 dark:border-slate-700 p-2",children:[c.jsx("div",{className:"font-semibold mb-2",children:"Mask Adjustment"}),c.jsxs("label",{className:"block mb-2",children:[c.jsx("span",{className:"block mb-1",children:"Blend"}),c.jsxs("select",{value:ee.blendMode,onChange:ue=>b(ee.id,ue.target.value),className:"w-full border border-gray-400 dark:border-slate-600 bg-white dark:bg-slate-900 p-1",children:[c.jsx("option",{value:"add",children:"Add"}),c.jsx("option",{value:"subtract",children:"Subtract"})]})]}),c.jsxs("div",{className:"mb-2 text-[11px] text-gray-500",children:["Bound Mask: ",c.jsx("span",{className:"font-semibold text-gray-700 dark:text-gray-300",children:((ye=t.masks.find(ue=>ue.id===ee.maskId))==null?void 0:ye.name)||"None"})]}),c.jsxs("label",{className:"block mb-2",children:[c.jsxs("span",{className:"block mb-1",children:["Opacity ",ee.opacity.toFixed(2)]}),c.jsx("input",{type:"range",min:0,max:1,step:.01,value:ee.opacity,onChange:ue=>w(ee.id,Number(ue.target.value)),className:"w-full"})]}),c.jsxs("div",{className:"mt-3 border border-gray-300 dark:border-slate-700 p-2",children:[c.jsx("div",{className:"font-semibold mb-2",children:"Basic"}),c.jsxs("label",{className:"block mb-2",children:[c.jsxs("div",{className:"flex items-center justify-between mb-1",children:[c.jsx("span",{children:"Exposure"}),c.jsx("span",{className:"text-[11px]",children:fe.exposure.toFixed(2)})]}),c.jsx(qi,{value:fe.exposure,min:-5,max:5,step:.01,onCommit:ue=>Se(ee,"exposure",ue),className:"w-full"})]}),c.jsxs("label",{className:"block mb-2",children:[c.jsxs("div",{className:"flex items-center justify-between mb-1",children:[c.jsx("span",{children:"Temperature"}),c.jsx("span",{className:"text-[11px]",children:Math.round(fe.temperature)})]}),c.jsx(qi,{value:fe.temperature,min:-100,max:100,step:1,onCommit:ue=>Se(ee,"temperature",ue),className:"w-full"})]}),c.jsxs("label",{className:"block mb-2",children:[c.jsxs("div",{className:"flex items-center justify-between mb-1",children:[c.jsx("span",{children:"Tint (G/M)"}),c.jsx("span",{className:"text-[11px]",children:Math.round(fe.tint)})]}),c.jsx(qi,{value:fe.tint,min:-100,max:100,step:1,onCommit:ue=>Se(ee,"tint",ue),className:"w-full"})]}),c.jsxs("label",{className:"block mb-2",children:[c.jsxs("div",{className:"flex items-center justify-between mb-1",children:[c.jsx("span",{children:"Contrast"}),c.jsx("span",{className:"text-[11px]",children:Math.round(fe.contrast)})]}),c.jsx(qi,{value:fe.contrast,min:-100,max:100,step:1,onCommit:ue=>Se(ee,"contrast",ue),className:"w-full"})]}),c.jsxs("label",{className:"block mb-2",children:[c.jsxs("div",{className:"flex items-center justify-between mb-1",children:[c.jsx("span",{children:"Highlights"}),c.jsx("span",{className:"text-[11px]",children:Math.round(fe.highlights)})]}),c.jsx(qi,{value:fe.highlights,min:-100,max:100,step:1,onCommit:ue=>Se(ee,"highlights",ue),className:"w-full"})]}),c.jsxs("label",{className:"block mb-2",children:[c.jsxs("div",{className:"flex items-center justify-between mb-1",children:[c.jsx("span",{children:"Shadows"}),c.jsx("span",{className:"text-[11px]",children:Math.round(fe.shadows)})]}),c.jsx(qi,{value:fe.shadows,min:-100,max:100,step:1,onCommit:ue=>Se(ee,"shadows",ue),className:"w-full"})]}),c.jsxs("label",{className:"block mb-2",children:[c.jsxs("div",{className:"flex items-center justify-between mb-1",children:[c.jsx("span",{children:"Vibrance"}),c.jsx("span",{className:"text-[11px]",children:Math.round(fe.vibrance)})]}),c.jsx(qi,{value:fe.vibrance,min:-100,max:100,step:1,onCommit:ue=>Se(ee,"vibrance",ue),className:"w-full"})]}),c.jsxs("label",{className:"block",children:[c.jsxs("div",{className:"flex items-center justify-between mb-1",children:[c.jsx("span",{children:"Saturation"}),c.jsx("span",{className:"text-[11px]",children:Math.round(fe.saturation)})]}),c.jsx(qi,{value:fe.saturation,min:-100,max:100,step:1,onCommit:ue=>Se(ee,"saturation",ue),className:"w-full"})]})]}),c.jsxs("div",{className:"mt-3 border border-gray-300 dark:border-slate-700 p-2",children:[c.jsx("div",{className:"font-semibold mb-2",children:"Color Mixer"}),c.jsx("div",{className:"flex items-center gap-2 mb-2 flex-wrap",children:Ck.map(ue=>c.jsx("button",{onClick:()=>G(ue.id),className:`w-5 h-5 rounded-full border-2 ${Y===ue.id?"border-black dark:border-white scale-110":"border-gray-500 dark:border-slate-500"} transition-transform`,style:{backgroundColor:ue.color},title:ue.label},ue.id))}),c.jsxs("div",{className:"text-[11px] text-gray-500 mb-2",children:["Band: ",(ge=Ck.find(ue=>ue.id===Y))==null?void 0:ge.label]}),c.jsxs("label",{className:"block mb-2",children:[c.jsxs("div",{className:"flex items-center justify-between mb-1",children:[c.jsx("span",{children:"Hue"}),c.jsx("span",{className:"text-[11px]",children:Math.round(de.hue)})]}),c.jsx(qi,{value:de.hue,min:-100,max:100,step:1,onCommit:ue=>he(ee,Y,"hue",ue),className:"w-full"})]}),c.jsxs("label",{className:"block mb-2",children:[c.jsxs("div",{className:"flex items-center justify-between mb-1",children:[c.jsx("span",{children:"Saturation"}),c.jsx("span",{className:"text-[11px]",children:Math.round(de.saturation)})]}),c.jsx(qi,{value:de.saturation,min:-100,max:100,step:1,onCommit:ue=>he(ee,Y,"saturation",ue),className:"w-full"})]}),c.jsxs("label",{className:"block",children:[c.jsxs("div",{className:"flex items-center justify-between mb-1",children:[c.jsx("span",{children:"Luminance"}),c.jsx("span",{className:"text-[11px]",children:Math.round(de.luminance)})]}),c.jsx(qi,{value:de.luminance,min:-100,max:100,step:1,onCommit:ue=>he(ee,Y,"luminance",ue),className:"w-full"})]})]}),c.jsxs("div",{className:"mt-3",children:[c.jsx("div",{className:"font-semibold mb-1",children:"Layer Curves"}),c.jsx("div",{className:"flex gap-1 mb-2",children:["master","red","green","blue"].map(ue=>c.jsx("button",{onClick:()=>z(ue),className:`flex-1 py-1 text-[11px] font-bold uppercase rounded transition-colors ${B===ue?"bg-slate-700 text-white":"bg-gray-200 dark:bg-slate-800 text-gray-600 dark:text-gray-400 hover:bg-gray-300 dark:hover:bg-slate-700"}`,children:ue==="master"?"Luma":ue},ue))}),c.jsx(KT,{channel:B,points:De[B],onChange:Pe}),c.jsx("div",{className:"text-[10px] text-gray-400 mt-1 text-center",children:"Click add, drag move, double-click remove."})]})]}),!ee&&te&&c.jsx("div",{className:"mb-3 border border-gray-300 dark:border-slate-700 p-2 text-[11px] text-gray-500",children:"No adjustment layer bound to this mask."})]})},hu={"Canon EOS R5":"0.9766 -0.2953 -0.1254 -0.4276 1.2116 0.2433 -0.0437 0.1336 0.5131","Canon EOS 7D Mark II":"0.7268 -0.1082 -0.0969 -0.4186 1.1839 0.2663 -0.0825 0.2029 0.5839","Canon EOS R3":"0.9423 -0.2839 -0.1195 -0.4532 1.2377 0.2415 -0.0483 0.1374 0.5276","Canon EOS 5D Mark III":"0.6722 -0.0635 -0.0963 -0.4287 1.246 0.2028 -0.0908 0.2162 0.5668","Canon EOS 5DS R":"0.625 -0.0711 -0.0808 -0.5153 1.2794 0.2636 -0.1249 0.2198 0.561","Canon EOS R6":"0.8293 -0.1611 -0.1132 -0.4759 1.2711 0.2275 -0.1013 0.2415 0.5509","Samsung NX U":"0.7557 -0.2522 -0.0739 -0.4679 1.2949 0.1894 -0.084 0.1777 0.5311","Canon EOS R5 Mark II":"0.9396 -0.2598 -0.1207 -0.4408 1.2296 0.2369 -0.0505 0.1575 0.6077","Canon EOS 5DS":"0.625 -0.0711 -0.0808 -0.5153 1.2794 0.2636 -0.1249 0.2198 0.561","Canon EOS R":"0.8293 -0.1789 -0.1094 -0.5025 1.2925 0.2327 -0.1199 0.2769 0.6108","Canon EOS R6 Mark II":"0.9539 -0.2795 -0.1224 -0.4175 1.1998 0.2458 -0.0465 0.1755 0.6048","Canon EOS R7":"1.0424 -0.3138 -0.13 -0.4221 1.1938 0.2584 -0.0547 0.1658 0.6183","Canon EOS 5D Mark IV":"0.6446 -0.0366 -0.0864 -0.4436 1.2204 0.2513 -0.0952 0.2496 0.6348","Canon EOS-1D X Mark III":"0.8971 -0.2022 -0.1242 -0.5405 1.3249 0.238 -0.128 0.2483 0.6072","Sony ILCE-7M3":"0.7374 -0.2389 -0.0551 -0.5435 1.3162 0.2519 -0.1006 0.1795 0.6552","Hasselblad 50-15-Coated5":"0.5002 -0.0878 0.0111 -0.4856 1.1929 0.3338 -0.1183 0.2041 0.7022","Canon EOS-1D X":"0.6847 -0.0614 -0.1014 -0.4669 1.2737 0.2139 -0.1197 0.2488 0.6846","Fujifilm GFX 100":"1.6212 -0.8423 -0.1583 -0.4336 1.2583 0.1937 -0.0195 0.0726 0.6199","Phase One IQ180":"0.6294 0.0686 -0.0712 -0.5435 1.3417 0.2211 -0.1006 0.2435 0.5042","Phase One IQ3 100MP":"0.2423 0 0 0 0.9901 0 0 0 0.7989","Canon EOS-1D X Mark II":"0.7596 -0.0978 -0.0967 -0.4808 1.2571 0.2503 -0.1398 0.2567 0.5752","Canon PowerShot Pro70":"-0.5106 1.0695 0.1576 0.382 0.0053 0.4566 -0.6497 1.0736 0.6701 -0.3336 1.1887 0.1394","Sony ILCE-9":"0.6389 -0.1703 -0.0378 -0.4562 1.2265 0.2587 -0.067 0.1489 0.655","Sony ILCE-7CR":"0.82 -0.2976 -0.0719 -0.4296 1.2053 0.2532 -0.0429 0.1282 0.5774","Sony ILCE-7S":"0.5838 -0.143 -0.0246 -0.3497 1.1477 0.2297 -0.0748 0.1885 0.5778","Sony ILCE-7RM3":"0.664 -0.1847 -0.0503 -0.5238 1.301 0.2474 -0.0993 0.1673 0.6527","Sony DSC-RX1RM3":"0.9034 -0.349 -0.0777 -0.4004 1.1841 0.2448 -0.0484 0.1352 0.5552","Sony ILCE-6100":"0.7657 -0.2847 -0.0607 -0.4083 1.1966 0.2389 -0.0684 0.1418 0.5844","Sony ILCE-7RM2":"0.6629 -0.19 -0.0483 -0.4618 1.2349 0.255 -0.0622 0.1381 0.6514","Sony ILCE-5100":"0.5991 -0.1456 -0.0455 -0.4764 1.2135 0.298 -0.0707 0.1425 0.6701","Sony ILCE-7M2":"0.5271 -0.0712 -0.0347 -0.6153 1.3653 0.2763 -0.1601 0.2366 0.7242","Sony ILCE-7RM5":"0.82 -0.2976 -0.0719 -0.4296 1.2053 0.2532 -0.0429 0.1282 0.5774","Sony ILCA-77M2":"0.5991 -0.1732 -0.0443 -0.41 1.1989 0.2381 -0.0704 0.1467 0.5992","Sony ZV-1M2":"0.828 -0.2987 -0.0703 -0.3531 1.1645 0.2133 -0.055 0.1542 0.5312","Sony ILCE-7SM2":"0.5838 -0.143 -0.0246 -0.3497 1.1477 0.2297 -0.0748 0.1885 0.5778","Sony DSC-RX100M7":"1.0315 -0.439 -0.0937 -0.4859 1.2734 0.2365 -0.0734 0.1537 0.5997","Sony ILCE-6300":"0.5973 -0.1695 -0.0419 -0.3826 1.1797 0.2293 -0.0639 0.1398 0.5789","Sony ILCA-99M2":"0.666 -0.1918 -0.0471 -0.4613 1.2398 0.2485 -0.0649 0.1433 0.6447","Sony ILCE-9M3":"0.9811 -0.3908 -0.0752 -0.3704 1.1577 0.2417 -0.0073 0.095 0.598","Sony ILCE-9M2":"0.6389 -0.1703 -0.0378 -0.4562 1.2265 0.2587 -0.067 0.1489 0.655","Sony DSC-RX100M6":"0.7325 -0.2321 -0.0596 -0.3494 1.1674 0.2055 -0.0668 0.1562 0.5031","Sony ZV-E10M2":"0.6972 -0.2408 -0.06 -0.433 1.2101 0.2515 -0.0388 0.1277 0.5847","Sony DSC-RX100M4":"0.6596 -0.2079 -0.0562 -0.4782 1.3016 0.1933 -0.097 0.1581 0.5181","Sony ILCE-7SM3":"0.6912 -0.2127 -0.0469 -0.447 1.2175 0.2587 -0.0398 0.1478 0.6492","Sony ILCE-7":"0.5271 -0.0712 -0.0347 -0.6153 1.3653 0.2763 -0.1601 0.2366 0.7242","Sony ILCE-6000":"0.5991 -0.1456 -0.0455 -0.4764 1.2135 0.298 -0.0707 0.1425 0.6701","Sony ILCE-1":"0.8161 -0.2947 -0.0739 -0.4811 1.2668 0.2389 -0.0437 0.1229 0.6524","Sony ILCE-7M4":"0.746 -0.2365 -0.0588 -0.5687 1.3442 0.2474 -0.0624 0.1156 0.6584","Sony ILCE-7R":"0.4913 -0.0541 -0.0202 -0.613 1.3513 0.2906 -0.1564 0.2151 0.7183","Fujifilm X100VI":"1.1809 -0.5358 -0.1141 -0.4248 1.2164 0.2343 -0.0514 0.1097 0.5848","Fujifilm X-H2":"1.1809 -0.5358 -0.1141 -0.4248 1.2164 0.2343 -0.0514 0.1097 0.5848","Fujifilm X-A3":"1.2407 -0.5222 -0.1086 -0.2971 1.1116 0.212 -0.0294 0.1029 0.5284","Fujifilm X-H2S":"1.2836 -0.5909 -0.1032 -0.3087 1.1132 0.2236 -0.0035 0.0872 0.533","Fujifilm X-Pro3":"1.3426 -0.6334 -0.1177 -0.4244 1.2136 0.2371 -0.058 0.1303 0.598","Fujifilm X-T50":"1.1809 -0.5358 -0.1141 -0.4248 1.2164 0.2343 -0.0514 0.1097 0.5848","Fujifilm X-T2":"1.1434 -0.4948 -0.121 -0.3746 1.2042 0.1903 -0.0666 0.1479 0.5235","Fujifilm X-T5":"1.1809 -0.5358 -0.1141 -0.4248 1.2164 0.2343 -0.0514 0.1097 0.5848","Fujifilm X-Pro2":"1.1434 -0.4948 -0.121 -0.3746 1.2042 0.1903 -0.0666 0.1479 0.5235","Fujifilm X-A7":"1.5055 -0.7391 -0.1274 -0.4062 1.2071 0.2238 -0.061 0.1217 0.6147","Fujifilm X-H1":"1.1434 -0.4948 -0.121 -0.3746 1.2042 0.1903 -0.0666 0.1479 0.5235","Fujifilm X-S20":"1.2836 -0.5909 -0.1032 -0.3087 1.1132 0.2236 -0.0035 0.0872 0.533","Fujifilm X-S10":"1.3426 -0.6334 -0.1177 -0.4244 1.2136 0.2371 -0.058 0.1303 0.598","Fujifilm X-T30":"1.3426 -0.6334 -0.1177 -0.4244 1.2136 0.2371 -0.058 0.1303 0.598","Fujifilm X30":"1.2328 -0.5256 -0.1144 -0.4469 1.2927 0.1675 -0.0087 0.1291 0.4351","Fujifilm GFX 50R":"1.1756 -0.4754 -0.0874 -0.3056 1.1045 0.2305 -0.0381 0.1457 0.6006","Fujifilm X100V":"1.3717 -0.649 -0.1154 -0.4348 1.2266 0.2335 -0.069 0.1286 0.6134","Fujifilm X-A5":"1.1673 -0.476 -0.1041 -0.3988 1.2058 0.2166 -0.0771 0.1417 0.5569","Fujifilm X100F":"1.1434 -0.4948 -0.121 -0.3746 1.2042 0.1903 -0.0666 0.1479 0.5235","Fujifilm X-T100":"1.1673 -0.476 -0.1041 -0.3988 1.2058 0.2166 -0.0771 0.1417 0.5569","Fujifilm XQ1":"0.9252 -0.2704 -0.1064 -0.5893 1.4265 0.1717 -0.1101 0.2341 0.4349","Fujifilm X-T4":"1.3426 -0.6334 -0.1177 -0.4244 1.2136 0.2371 -0.058 0.1303 0.598","Fujifilm X-E3":"1.1434 -0.4948 -0.121 -0.3746 1.2042 0.1903 -0.0666 0.1479 0.5235","Fujifilm X-T20":"1.1434 -0.4948 -0.121 -0.3746 1.2042 0.1903 -0.0666 0.1479 0.5235","Fujifilm X-A2":"1.0763 -0.456 -0.0917 -0.3346 1.1311 0.2322 -0.0475 0.1135 0.5843","Fujifilm GFX 50S":"1.1756 -0.4754 -0.0874 -0.3056 1.1045 0.2305 -0.0381 0.1457 0.6006","Fujifilm X-A1":"1.1086 -0.4555 -0.0839 -0.3512 1.131 0.2517 -0.0815 0.1341 0.594","Fujifilm X70":"1.045 -0.4329 -0.0878 -0.3217 1.1105 0.2421 -0.0752 0.1758 0.6519","Fujifilm FinePix S1":"1.2297 -0.4882 -0.1202 -0.2106 1.0691 0.1623 -0.0088 0.1312 0.479","Fujifilm XQ2":"0.9252 -0.2704 -0.1064 -0.5893 1.4265 0.1717 -0.1101 0.2341 0.4349","Fujifilm X-E2":"0.8458 -0.2451 -0.0855 -0.4597 1.2447 0.2407 -0.1475 0.2482 0.6526","Fujifilm GFX 100RF":"1.2806 -0.5779 -0.111 -0.3546 1.1507 0.2318 -0.0177 0.0996 0.5715","Fujifilm X-T10":"0.8458 -0.2451 -0.0855 -0.4597 1.2447 0.2407 -0.1475 0.2482 0.6526","Fujifilm X-E5":"1.1809 -0.5358 -0.1141 -0.4248 1.2164 0.2343 -0.0514 0.1097 0.5848","Fujifilm X100T":"1.0592 -0.4262 -0.1008 -0.3514 1.1355 0.2465 -0.087 0.2025 0.6386","Fujifilm X100S":"1.0592 -0.4262 -0.1008 -0.3514 1.1355 0.2465 -0.087 0.2025 0.6386","Fujifilm X-T3":"1.3426 -0.6334 -0.1177 -0.4244 1.2136 0.2371 -0.058 0.1303 0.598","Fujifilm X-M5":"1.2836 -0.5909 -0.1032 -0.3087 1.1132 0.2236 -0.0035 0.0872 0.533","Fujifilm X-M1":"1.0413 -0.3996 -0.0993 -0.3721 1.164 0.2361 -0.0733 0.154 0.6011","Fujifilm X-T1":"0.8458 -0.2451 -0.0855 -0.4597 1.2447 0.2407 -0.1475 0.2482 0.6526","Fujifilm X20":"1.1768 -0.4971 -0.1133 -0.4904 1.2927 0.2183 -0.048 0.1723 0.4605","Fujifilm GFX 50S II":"1.1756 -0.4754 -0.0874 -0.3056 1.1045 0.2305 -0.0381 0.1457 0.6006","Fujifilm X-Pro1":"1.0413 -0.3996 -0.0993 -0.3721 1.164 0.2361 -0.0733 0.154 0.6011","Fujifilm XF10":"1.1673 -0.476 -0.1041 -0.3988 1.2058 0.2166 -0.0771 0.1417 0.5569","Fujifilm X-E2S":"1.1562 -0.5118 -0.0961 -0.3022 1.1007 0.2311 -0.0525 0.1569 0.6097","Nikon Coolpix P330":"1.0321 -0.392 -0.0931 -0.275 1.1146 0.1824 -0.0442 0.1545 0.5539","Nikon Coolpix P1000":"1.4294 -0.6116 -0.1333 -0.1628 1.0219 0.1637 -0.0014 0.1158 0.5022","Nikon Coolpix P340":"1.0321 -0.392 -0.0931 -0.275 1.1146 0.1824 -0.0442 0.1545 0.5539","Nikon Coolpix P7800":"1.0321 -0.392 -0.0931 -0.275 1.1146 0.1824 -0.0442 0.1545 0.5539","Nikon Coolpix P7700":"1.0321 -0.392 -0.0931 -0.275 1.1146 0.1824 -0.0442 0.1545 0.5539","Nikon 1 S2":"0.6612 -0.1342 -0.0618 -0.3338 1.1055 0.2623 -0.0174 0.1792 0.5075","Nikon D3300":"0.6988 -0.1384 -0.0714 -0.5631 1.341 0.2447 -0.1485 0.2204 0.7318","Nikon D3200":"0.7013 -0.1408 -0.0635 -0.5268 1.2902 0.264 -0.147 0.2801 0.7379","Nikon Z 8":"1.1423 -0.4564 -0.1123 -0.4816 1.2895 0.2119 -0.021 0.1061 0.7282","Nikon D810A":"1.1973 -0.5685 -0.0888 -0.1965 1.0326 0.1901 -0.0115 0.1123 0.7169","Nikon D5500":"0.8821 -0.2938 -0.0785 -0.4178 1.2142 0.2287 -0.0824 0.1651 0.686","Nikon Z 6 3":"1.1206 -0.4286 -0.0941 -0.4879 1.2847 0.2251 -0.0745 0.1654 0.7374","Nikon D750":"0.902 -0.289 -0.0715 -0.4535 1.2436 0.2348 -0.0934 0.1919 0.7086","Nikon Z 6":"0.9943 -0.3269 -0.0839 -0.5323 1.3269 0.2259 -0.1198 0.2083 0.7557","Nikon D500":"0.8813 -0.321 -0.1036 -0.4703 1.2868 0.2021 -0.1054 0.194 0.6129","Nikon D3400":"0.6988 -0.1384 -0.0714 -0.5631 1.341 0.2447 -0.1485 0.2204 0.7318","Nikon D5300":"0.6988 -0.1384 -0.0714 -0.5631 1.341 0.2447 -0.1485 0.2204 0.7318","Nikon D5600":"0.8821 -0.2938 -0.0785 -0.4178 1.2142 0.2287 -0.0824 0.1651 0.686","Nikon D780":"0.9943 -0.3269 -0.0839 -0.5323 1.3269 0.2259 -0.1198 0.2083 0.7557","Nikon Z 6 2":"0.9943 -0.3269 -0.0839 -0.5323 1.3269 0.2259 -0.1198 0.2083 0.7557","Nikon D5":"0.92 -0.3522 -0.0992 -0.5755 1.3803 0.2117 -0.0753 0.1486 0.6338","Nikon 1 J4":"0.5958 -0.1559 -0.0571 -0.4021 1.1453 0.2939 -0.0634 0.1548 0.5087","Nikon D800":"0.7866 -0.2108 -0.0555 -0.4869 1.2483 0.2681 -0.1176 0.2069 0.7501","Nikon 1 S1":"0.8994 -0.2667 -0.0865 -0.4594 1.2324 0.2552 -0.0699 0.1786 0.626","Nikon D850":"1.0405 -0.3755 -0.127 -0.5461 1.3787 0.1793 -0.104 0.2015 0.6785","Nikon 1 J3":"0.6588 -0.1305 -0.0693 -0.3277 1.0987 0.2634 -0.0355 0.2016 0.5106","Nikon D7200":"0.8322 -0.3112 -0.1047 -0.6367 1.4342 0.2179 -0.0988 0.1638 0.6394","Nikon Z 5":"0.8695 -0.2558 -0.0648 -0.5015 1.2711 0.2575 -0.1279 0.2215 0.7514","Nikon Z 50":"1.164 -0.4829 -0.1079 -0.5107 1.3006 0.2325 -0.0972 0.1711 0.738","Nikon Z 7 2":"1.3705 -0.6004 -0.14 -0.5464 1.3568 0.2062 -0.094 0.1706 0.7618","Nikon 1 J5":"0.752 -0.2518 -0.0645 -0.3844 1.2102 0.1945 -0.0913 0.2249 0.6835","Nikon Z 5 2":"1.3133 -0.5542 -0.128 -0.4325 1.2543 0.1972 0.0034 0.0792 0.7662","Nikon Z fc":"1.164 -0.4829 -0.1079 -0.5107 1.3006 0.2325 -0.0972 0.1711 0.738","Nikon Z f":"1.1607 -0.4491 -0.0977 -0.4522 1.246 0.2304 -0.0458 0.1519 0.7616","Nikon D610":"0.8178 -0.2245 -0.0609 -0.4857 1.2394 0.2776 -0.1207 0.2086 0.7298","Nikon Z 7":"1.3705 -0.6004 -0.14 -0.5464 1.3568 0.2062 -0.094 0.1706 0.7618","Nikon Df":"0.8598 -0.2848 -0.0857 -0.5618 1.3606 0.2195 -0.1002 0.1773 0.7137","Nikon 1 V3":"0.5958 -0.1559 -0.0571 -0.4021 1.1453 0.2939 -0.0634 0.1548 0.5087","Nikon D7000":"0.8198 -0.2239 -0.0724 -0.4871 1.2389 0.2798 -0.1043 0.205 0.7181","Nikon Z 9":"1.3389 -0.6049 -0.1441 -0.4544 1.2757 0.1969 0.0229 0.0498 0.739","Nikon Z 50 2":"1.164 -0.4829 -0.1079 -0.5107 1.3006 0.2325 -0.0972 0.1711 0.738","Nikon D4S":"0.8598 -0.2848 -0.0857 -0.5618 1.3606 0.2195 -0.1002 0.1773 0.7137","Nikon D810":"0.9369 -0.3195 -0.0791 -0.4488 1.243 0.2301 -0.0893 0.1796 0.6872","Nikon D4":"0.8598 -0.2848 -0.0857 -0.5618 1.3606 0.2195 -0.1002 0.1773 0.7137","DXO ONE":"0.6596 -0.2079 -0.0562 -0.4782 1.3016 0.1933 -0.097 0.1581 0.5181","DXO-ONE":"0.6596 -0.2079 -0.0562 -0.4782 1.3016 0.1933 -0.097 0.1581 0.5181","Nikon D800E":"0.7866 -0.2108 -0.0555 -0.4869 1.2483 0.2681 -0.1176 0.2069 0.7501","ZEISS ZX1":"1 -0.4766 -0.0938 -0.2969 1.1328 0.1875 -0.0313 0.1094 0.7422","PENTAX K-50":"0.8628 -0.2607 -0.1156 -0.3995 1.2301 0.1881 -0.099 0.1735 0.6595","PENTAX K-500":"0.8513 -0.2572 -0.114 -0.3995 1.2301 0.1881 -0.1003 0.1758 0.6683","PENTAX K-3 II":"0.8571 -0.259 -0.1148 -0.3995 1.2301 0.1881 -0.1052 0.1844 0.7013","PENTAX K-S2":"0.8009 -0.2517 -0.114 -0.3882 1.235 0.1689 -0.0844 0.1493 0.6312","PENTAX K-3":"0.8761 -0.2648 -0.1173 -0.3995 1.2301 0.1881 -0.0901 0.1579 0.6001","PENTAX KP":"0.7357 -0.2031 -0.132 -0.4842 1.3555 0.1349 -0.1538 0.2416 0.5736","PENTAX MX-1":"0.8804 -0.2523 -0.1238 -0.2423 1.1627 0.086 -0.0682 0.1774 0.4753","PENTAX K-70":"0.8117 -0.2078 -0.1275 -0.4359 1.2953 0.1515 -0.1096 0.1965 0.6073","PENTAX K-3 Mark III":"0.6842 -0.1581 -0.0867 -0.4614 1.2728 0.2065 -0.0639 0.1428 0.5682","PENTAX 645Z":"0.9829 -0.31 -0.1271 -0.3685 1.2133 0.1721 -0.1068 0.1977 0.6854","PENTAX K-1":"0.8566 -0.2746 -0.1201 -0.3612 1.2204 0.155 -0.0893 0.168 0.6264","PENTAX Q7":"1.2995 -0.5593 -0.1107 -0.1879 1.0139 0.2027 -0.0064 0.1233 0.4919","Canon PowerShot SX60 HS":"1.3161 -0.5451 -0.1344 -0.1989 1.0654 0.1531 -0.0047 0.1271 0.4955","Canon PowerShot G15":"0.7474 -0.2301 -0.0567 -0.4056 1.1456 0.2975 -0.0222 0.0716 0.4181","Canon PowerShot G5 X Mark II":"1.1629 -0.5713 -0.0914 -0.2706 1.109 0.1842 -0.0206 0.1225 0.5515","Canon PowerShot G16":"0.802 -0.2687 -0.0682 -0.3704 1.1879 0.2052 -0.0965 0.1921 0.5556","Canon PowerShot S120":"0.6961 -0.1685 -0.0695 -0.4625 1.2945 0.1836 -0.1114 0.2152 0.5518","Canon PowerShot G1 X":"0.7378 -0.1255 -0.1043 -0.4088 1.2251 0.2048 -0.0876 0.1946 0.5805","Canon EOS M5":"0.8532 -0.0701 -0.1167 -0.4095 1.1879 0.2508 -0.0797 0.2424 0.701","Canon EOS M6":"0.8532 -0.0701 -0.1167 -0.4095 1.1879 0.2508 -0.0797 0.2424 0.701","Canon PowerShot G7 X":"0.9602 -0.3823 -0.0937 -0.2984 1.1495 0.1675 -0.0407 0.1415 0.5049","Canon PowerShot G7 X Mark II":"0.9602 -0.3823 -0.0937 -0.2984 1.1495 0.1675 -0.0407 0.1415 0.5049","Canon PowerShot G9 X":"0.9602 -0.3823 -0.0937 -0.2984 1.1495 0.1675 -0.0407 0.1415 0.5049","Canon PowerShot G3 X":"0.9701 -0.3857 -0.0921 -0.3149 1.1537 0.1817 -0.0786 0.1817 0.5147","Canon EOS 6D Mark II":"0.6875 -0.097 -0.0932 -0.4691 1.2459 0.2501 -0.0874 0.1953 0.5809","Canon PowerShot G1 X Mark III":"0.8532 -0.0701 -0.1167 -0.4095 1.1879 0.2508 -0.0797 0.2424 0.701","Canon PowerShot G9 X Mark II":"1.0056 -0.4131 -0.0944 -0.2576 1.1143 0.1625 -0.0238 0.1294 0.5179","Canon EOS 200D":"0.7377 -0.0742 -0.0998 -0.4235 1.1981 0.2549 -0.0673 0.1918 0.5538","Canon EOS R10":"0.9269 -0.2012 -0.1107 -0.399 1.1762 0.2527 -0.0569 0.2093 0.4913","Canon PowerShot G5 X":"0.9602 -0.3823 -0.0937 -0.2984 1.1495 0.1675 -0.0407 0.1415 0.5049","Canon PowerShot G1 X Mark II":"0.7378 -0.1255 -0.1043 -0.4088 1.2251 0.2048 -0.0876 0.1946 0.5805","Canon EOS M100":"0.8532 -0.0701 -0.1167 -0.4095 1.1879 0.2508 -0.0797 0.2424 0.701","Canon EOS RP":"0.8608 -0.2097 -0.1178 -0.5425 1.3265 0.2383 -0.1149 0.2238 0.568","Canon EOS 7D":"0.6844 -0.0996 -0.0856 -0.3876 1.1761 0.2396 -0.0593 0.1772 0.6198","Canon EOS 90D":"1.1498 -0.3759 -0.1516 -0.5073 1.2954 0.2349 -0.0892 0.1867 0.6118","Canon PowerShot V1":"1.26 -0.4747 -0.2027 -0.611 1.5868 -0.0029 0.011 0.0479 0.6011","Canon EOS M3":"0.6362 -0.0823 -0.0847 -0.4426 1.2109 0.2616 -0.0743 0.1857 0.5635","Canon PowerShot G7 X Mark III":"1.1629 -0.5713 -0.0914 -0.2706 1.109 0.1842 -0.0206 0.1225 0.5515","Canon EOS M50":"0.8532 -0.0701 -0.1167 -0.4095 1.1879 0.2508 -0.0797 0.2424 0.701","Canon EOS 80D":"0.7457 -0.0671 -0.0937 -0.4849 1.2495 0.2643 -0.1213 0.2354 0.5492","Canon EOS M200":"1.0463 -0.2173 -0.1437 -0.4856 1.2635 0.2482 -0.1216 0.2915 0.7237","Canon EOS R100":"0.823 -0.1515 -0.1032 -0.4179 1.2005 0.2454 -0.0649 0.2076 0.4711","Canon EOS 700D":"0.6602 -0.0841 -0.0939 -0.4472 1.2458 0.2247 -0.0975 0.2039 0.6148","Canon EOS 100D":"0.6602 -0.0841 -0.0939 -0.4472 1.2458 0.2247 -0.0975 0.2039 0.6148","Canon EOS M6 Mark II":"1.1498 -0.3759 -0.1516 -0.5073 1.2954 0.2349 -0.0892 0.1867 0.6118","Canon EOS 70D":"0.7034 -0.0804 -0.1014 -0.442 1.2564 0.2058 -0.0851 0.1994 0.5758","Canon EOS R8":"0.9539 -0.2795 -0.1224 -0.4175 1.1998 0.2458 -0.0465 0.1755 0.6048","Canon EOS 6D":"0.7034 -0.0804 -0.1014 -0.442 1.2564 0.2058 -0.0851 0.1994 0.5758","Canon EOS R50 V":"0.9089 -0.181 -0.1209 -0.4294 1.2116 0.2454 -0.0498 0.1862 0.4923","Canon EOS 77D":"0.7377 -0.0742 -0.0998 -0.4235 1.1981 0.2549 -0.0673 0.1918 0.5538","LEICA M10":"0.8249 -0.2849 -0.062 -0.5415 1.4756 0.0565 -0.0957 0.3074 0.6517","LEICA Q (Typ 116)":"1.1865 -0.4523 -0.1441 -0.5423 1.4458 0.0935 -0.1587 0.2687 0.483","LEICA Q3 43":"1.1111 -0.3816 -0.1057 -0.375 1.2107 0.1829 -0.0947 0.1868 0.4645","LEICA Q2":"1.1865 -0.4523 -0.1441 -0.5423 1.4458 0.0935 -0.1587 0.2687 0.483","LEICA SL (Typ 601)":"1.1865 -0.4523 -0.1441 -0.5423 1.4458 0.0935 -0.1587 0.2687 0.483","LEICA D-Lux 8":"0.8585 -0.3127 -0.0833 -0.4005 1.225 0.1953 -0.065 0.1494 0.4862","LEICA T (Typ 701)":"0.5463 -0.0988 -0.0364 -0.4634 1.2036 0.2946 -0.0766 0.1389 0.6522","LEICA X (Typ 113)":"0.7712 -0.2059 -0.0653 -0.3882 1.1494 0.2726 -0.071 0.1332 0.5958","PENTAX K-1 Mark II":"0.8935 -0.2864 -0.1253 -0.3612 1.2204 0.155 -0.0905 0.1702 0.6346","Panasonic DMC-ZS40":"0.8607 -0.2822 -0.0808 -0.3755 1.193 0.2049 -0.082 0.206 0.5224","Panasonic DMC-CM1":"0.877 -0.3194 -0.082 -0.2871 1.1281 0.1803 -0.0513 0.1552 0.4434","Panasonic DC-G9":"0.7685 -0.2375 -0.0634 -0.3687 1.17 0.2249 -0.0748 0.1546 0.5111","Panasonic DMC-ZS50":"0.8802 -0.3135 -0.0789 -0.3151 1.1468 0.1904 -0.055 0.1745 0.481","Panasonic DMC-GX85":"0.7771 -0.302 -0.0629 -0.4029 1.195 0.2345 -0.0821 0.1977 0.6119","Panasonic DMC-LX9":"0.779 -0.2736 -0.0755 -0.3452 1.187 0.1769 -0.0628 0.1647 0.4898","Panasonic DC-FZ80":"1.1532 -0.4324 -0.1066 -0.2375 1.0847 0.1749 -0.0564 0.1699 0.4351","Panasonic DMC-FZ300":"0.8378 -0.2798 -0.0769 -0.3068 1.141 0.1877 -0.0538 0.1792 0.4623","Panasonic DMC-GX8":"0.7564 -0.2263 -0.0606 -0.3148 1.1239 0.2177 -0.054 0.1435 0.4853","Panasonic DC-S1RM2":"0.9941 -0.4056 -0.0871 -0.3745 1.1604 0.2433 -0.0254 0.1132 0.5526","Panasonic DC-GH6":"0.7949 -0.3491 -0.071 -0.3435 1.1681 0.1977 -0.0503 0.1622 0.5065","Panasonic DC-S1":"0.9744 -0.3905 -0.0779 -0.4899 1.2807 0.2324 -0.0798 0.163 0.5827","Olympus E-M5":"0.838 -0.263 -0.0639 -0.2887 1.0725 0.2496 -0.0627 0.1427 0.5438","Panasonic DMC-ZS100":"0.779 -0.2736 -0.0755 -0.3452 1.187 0.1769 -0.0628 0.1647 0.4898","Olympus E-M5 Mark II":"0.9422 -0.3258 -0.0711 -0.2655 1.0898 0.2015 -0.0512 0.1354 0.5512","Panasonic DC-GF9":"0.761 -0.278 -0.0576 -0.4614 1.2195 0.2733 -0.1375 0.2393 0.649","Panasonic DMC-GF7":"0.761 -0.278 -0.0576 -0.4614 1.2195 0.2733 -0.1375 0.2393 0.649","Olympus PEN-F":"0.9476 -0.3182 -0.0765 -0.2613 1.0958 0.1893 -0.0449 0.1315 0.5268","Panasonic DC-S1H":"0.9397 -0.3719 -0.0805 -0.5425 1.3326 0.2309 -0.0972 0.1715 0.6034","Panasonic DMC-LX100":"0.8844 -0.3538 -0.0768 -0.3709 1.1762 0.22 -0.0698 0.1792 0.522","Panasonic DMC-FZ2500":"0.7386 -0.2443 -0.0743 -0.3437 1.1864 0.1757 -0.0608 0.166 0.4766","Panasonic DC-G99":"0.9657 -0.3963 -0.0748 -0.3361 1.1378 0.2258 -0.0568 0.1415 0.5158","Panasonic DC-LX100M2":"0.8585 -0.3127 -0.0833 -0.4005 1.225 0.1953 -0.065 0.1494 0.4862","Panasonic DC-S1R":"1.1822 -0.5321 -0.1249 -0.5958 1.5114 0.0766 -0.0614 0.1264 0.7043","Panasonic DC-G9M2":"0.8325 -0.3456 -0.0623 -0.433 1.2089 0.2528 -0.086 0.2646 0.5984","Panasonic DC-S9":"0.9983 -0.389 -0.0841 -0.418 1.2164 0.2263 -0.0249 0.1139 0.5766","Panasonic DC-ZS200":"0.779 -0.2736 -0.0755 -0.3452 1.187 0.1769 -0.0628 0.1647 0.4898","Panasonic DC-GX9":"0.7564 -0.2263 -0.0606 -0.3148 1.1239 0.2177 -0.054 0.1435 0.4853","Panasonic DMC-G8":"0.761 -0.278 -0.0576 -0.4614 1.2195 0.2733 -0.1375 0.2393 0.649","Panasonic DMC-ZS60":"0.855 -0.2908 -0.0842 -0.3195 1.1529 0.1881 -0.0338 0.1603 0.4631","Panasonic DC-S1M2":"1.073 -0.4442 -0.0922 -0.4478 1.2504 0.2199 -0.038 0.1198 0.6039","Panasonic DC-GH5S":"0.6929 -0.2355 -0.0708 -0.4192 1.2534 0.1828 -0.1097 0.1989 0.5195","Panasonic DC-S5":"0.9744 -0.3905 -0.0779 -0.4899 1.2807 0.2324 -0.0798 0.163 0.5827","Panasonic DC-GH5M2":"0.93 -0.3659 -0.0755 -0.2981 1.0988 0.2287 -0.019 0.1077 0.5016","Panasonic DC-FZ1000M2":"0.9803 -0.4185 -0.0992 -0.4066 1.2578 0.1628 -0.0838 0.1824 0.5288","Panasonic DC-GH5":"0.7641 -0.2336 -0.0605 -0.3218 1.1299 0.2187 -0.0485 0.1338 0.5121","Panasonic DMC-GX7":"0.761 -0.278 -0.0576 -0.4614 1.2195 0.2733 -0.1375 0.2393 0.649","Panasonic DMC-LX7":"1.0148 -0.3743 -0.0991 -0.2837 1.1366 0.1659 -0.0701 0.1893 0.4899","Panasonic DC-GH7":"0.8573 -0.3575 -0.0678 -0.4252 1.2079 0.2451 -0.0808 0.2524 0.5936","Panasonic DC-S5M2":"1.0308 -0.4206 -0.0783 -0.4088 1.2102 0.2229 -0.0125 0.1051 0.5912","Panasonic DMC-LF1":"0.9379 -0.3267 -0.0816 -0.3227 1.156 0.1881 -0.0926 0.1928 0.534","Panasonic DMC-G7":"0.761 -0.278 -0.0576 -0.4614 1.2195 0.2733 -0.1375 0.2393 0.649","Olympus E-M1X":"1.1896 -0.511 -0.1076 -0.3181 1.1378 0.2048 -0.0519 0.1224 0.5166","OM Digital Solutions OM-1":"0.9488 -0.3984 -0.0714 -0.2887 1.0945 0.2229 -0.0137 0.096 0.5786","Olympus E-M10":"0.838 -0.263 -0.0639 -0.2887 1.0725 0.2496 -0.0627 0.1427 0.5438","Olympus E-M1 Mark III":"1.1896 -0.511 -0.1076 -0.3181 1.1378 0.2048 -0.0519 0.1224 0.5166","Olympus TG-4":"1.1426 -0.4159 -0.1126 -0.2066 1.0678 0.1593 -0.012 0.1327 0.4998","Olympus E-P5":"0.838 -0.263 -0.0639 -0.2887 1.0725 0.2496 -0.0627 0.1427 0.5438","Olympus E-M10 Mark II":"0.838 -0.263 -0.0639 -0.2887 1.0725 0.2496 -0.0627 0.1427 0.5438","Olympus E-M1":"0.7687 -0.1984 -0.0606 -0.4327 1.1928 0.2721 -0.1381 0.2339 0.6452","Olympus E-PL5":"0.838 -0.263 -0.0639 -0.2887 1.0725 0.2496 -0.0627 0.1427 0.5438","Panasonic DMC-GM1":"0.677 -0.1895 -0.0744 -0.5232 1.3145 0.2303 -0.1664 0.2691 0.5703","Panasonic DMC-GF6":"0.813 -0.2801 -0.0946 -0.352 1.1289 0.2552 -0.1314 0.2511 0.5791","Panasonic DMC-FZ1000":"0.783 -0.2696 -0.0763 -0.3325 1.1667 0.1866 -0.0641 0.1712 0.4824","Panasonic DMC-GH4":"0.7122 -0.2108 -0.0512 -0.3155 1.1201 0.2231 -0.0541 0.1423 0.5045","Panasonic DMC-GM5":"0.8238 -0.3244 -0.0679 -0.3921 1.1814 0.2384 -0.0836 0.2022 0.5852","OM Digital Solutions OM-5 Mark II":"1.2008 -0.523 -0.1123 -0.2265 1.0496 0.2046 0.0069 0.0734 0.4938",M1:"0.7712 -0.2059 -0.0653 -0.3882 1.1494 0.2726 -0.071 0.1332 0.5958","Olympus XZ-2":"0.9777 -0.3483 -0.0925 -0.2886 1.1297 0.18 -0.0602 0.1663 0.5134","Olympus E-M1 Mark II":"0.9383 -0.317 -0.0763 -0.2457 1.0702 0.202 -0.0384 0.1236 0.5552","Olympus E-PL7":"0.9197 -0.319 -0.0659 -0.2606 1.083 0.2039 -0.0458 0.125 0.5458","OM Digital Solutions OM-5":"1.1896 -0.511 -0.1076 -0.3181 1.1378 0.2048 -0.0519 0.1224 0.5166","Olympus E-M5 Mark III":"1.1896 -0.511 -0.1076 -0.3181 1.1378 0.2048 -0.0519 0.1224 0.5166","Olympus STYLUS 1":"0.836 -0.242 -0.088 -0.3928 1.2353 0.1739 -0.1381 0.2416 0.5173","RICOH GR IV":"0.6428 -0.1485 -0.0814 -0.4614 1.2728 0.2065 -0.0667 0.1489 0.5924","RICOH GR III":"0.6093 -0.1407 -0.0772 -0.4614 1.2728 0.2065 -0.0663 0.1481 0.5892","GR II":"0.4717 -0.085 -0.0431 -0.4977 1.2805 0.2417 -0.0641 0.1474 0.6143","Olympus E-M10 Mark III":"0.838 -0.263 -0.0639 -0.2887 1.0725 0.2496 -0.0627 0.1427 0.5438","Samsung NX1":"1.0686 -0.4042 -0.1052 -0.3595 1.3238 0.0276 -0.0464 0.1259 0.5931","Samsung NX2000":"0.7557 -0.2522 -0.0739 -0.4679 1.2949 0.1894 -0.084 0.1777 0.5311","Samsung NX500":"1.0686 -0.4042 -0.1052 -0.3595 1.3238 0.0276 -0.0464 0.1259 0.5931","Samsung NX300":"0.7557 -0.2522 -0.0739 -0.4679 1.2949 0.1894 -0.084 0.1777 0.5311","Samsung NX30":"0.7557 -0.2522 -0.0739 -0.4679 1.2949 0.1894 -0.084 0.1777 0.5311","Samsung NX mini":"0.5222 -0.1196 -0.055 -0.654 1.4649 0.2009 -0.1666 0.2819 0.5657","SIGMA fp L":"1.079 -0.2673 -0.228 -0.6718 1.5773 0.0854 -0.1473 0.2047 0.4597","sd Quattro H":"1.2907 0.0532 -0.3603 0.2957 0.7904 -0.0911 0.0255 0.7093 0.3228","Phase One IQ4 150MP":"0.6644 -0.2257 -0.0804 -0.6459 1.4562 0.2019 -0.1221 0.1876 0.6411","Sony ILCE-7RM4":"0.7662 -0.2686 -0.066 -0.524 1.2965 0.253 -0.0796 0.1508 0.6167","Fujifilm X-E4":"1.3426 -0.6334 -0.1177 -0.4244 1.2136 0.2371 -0.058 0.1303 0.598"},qT="modulepreload",ZT=function(e){return"/"+e},Ok={},N_=function(t,r,n){let a=Promise.resolve();if(r&&r.length>0){document.getElementsByTagName("link");const o=document.querySelector("meta[property=csp-nonce]"),s=(o==null?void 0:o.nonce)||(o==null?void 0:o.getAttribute("nonce"));a=Promise.allSettled(r.map(l=>{if(l=ZT(l),l in Ok)return;Ok[l]=!0;const u=l.endsWith(".css"),d=u?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${l}"]${d}`))return;const f=document.createElement("link");if(f.rel=u?"stylesheet":qT,u||(f.as="script"),f.crossOrigin="",f.href=l,s&&f.setAttribute("nonce",s),document.head.appendChild(f),u)return new Promise((h,g)=>{f.addEventListener("load",h),f.addEventListener("error",()=>g(new Error(`Unable to preload CSS for ${l}`)))})}))}function i(o){const s=new Event("vite:preloadError",{cancelable:!0});if(s.payload=o,window.dispatchEvent(s),!s.defaultPrevented)throw o}return a.then(o=>{for(const s of o||[])s.status==="rejected"&&i(s.reason);return t().catch(i)})};function Fh(e,t,r,n=[0,0,0,0],a=65535,i="RGGB",o=null){const l=e*t*2,u=8,d=u+l,f="Fake",h="StretchedNoiseCam",g="StretchedNoiseCam",b=G=>{const $=new Uint8Array(G.length+1);for(let L=0;L<G.length;L++)$[L]=G.charCodeAt(L);return $[G.length]=0,$},w=b(f),v=b(h),x=b(g),m=G=>{const $=[0,0,0,0],L={R:0,G:1,B:2},U=G.toUpperCase();for(let V=0;V<4;V++)$[V]=L[U[V]]??1;return $},k=G=>{const $=[];return G.forEach(L=>{$.push(Math.round(L*1e4)),$.push(1e4)}),$},P=[{id:254,type:4,count:1,value:0},{id:256,type:4,count:1,value:e},{id:257,type:4,count:1,value:t},{id:258,type:3,count:1,value:16},{id:259,type:3,count:1,value:1},{id:262,type:3,count:1,value:32803},{id:271,type:2,count:w.length,value:w},{id:272,type:2,count:v.length,value:v},{id:273,type:4,count:1,value:u},{id:277,type:3,count:1,value:1},{id:278,type:4,count:1,value:t},{id:279,type:4,count:1,value:l},{id:33421,type:3,count:2,value:[2,2]},{id:33422,type:1,count:4,value:m(i)},{id:50706,type:1,count:4,value:[1,4,0,0]},{id:50714,type:3,count:4,value:n.map(G=>Math.round(G))},{id:50715,type:4,count:1,value:Math.round(a)},{id:50717,type:2,count:x.length,value:x}];o&&o.length===9&&(P.push({id:50721,type:10,count:9,value:k(o)}),P.push({id:50778,type:3,count:1,value:21})),P.sort((G,$)=>G.id-$.id);const j=2+P.length*12+4;let S=0;const M=P.map(G=>{let $=1;G.type===3&&($=2),G.type===4&&($=4),(G.type===5||G.type===10)&&($=8);const L=G.count*$,U=L<=4;let V=0;return U||(V=S,S+=L,S%2!==0&&S++),{...G,fits:U,totalBytes:L,extraOffset:V,typeSize:$}}),O=d+j,E=O+S,I=new ArrayBuffer(E),D=new DataView(I),B=new Uint8Array(I);D.setUint16(0,18761,!0),D.setUint16(2,42,!0),D.setUint32(4,d,!0);const z=new Uint8Array(r.buffer,r.byteOffset,r.byteLength);B.set(z,u);let Y=d;return D.setUint16(Y,P.length,!0),Y+=2,M.forEach(G=>{if(D.setUint16(Y,G.id,!0),D.setUint16(Y+2,G.type,!0),D.setUint32(Y+4,G.count,!0),G.fits){const $=Y+8;Array.isArray(G.value)?G.value.forEach((L,U)=>{G.type===1&&D.setUint8($+U,L),G.type===3&&D.setUint16($+U*2,L,!0)}):(G.type===3&&D.setUint16($,G.value,!0),G.type===4&&D.setUint32($,G.value,!0))}else{const $=O+G.extraOffset;D.setUint32(Y+8,$,!0),G.value instanceof Uint8Array?B.set(G.value,$):Array.isArray(G.value)&&G.value.forEach((L,U)=>{G.type===1&&D.setUint8($+U,L),G.type===2&&D.setUint8($+U,L),G.type===3&&D.setUint16($+U*2,L,!0),G.type===4&&D.setUint32($+U*4,L,!0),(G.type===5||G.type===10)&&(G.type===10?D.setInt32($+U*4,L,!0):D.setUint32($+U*4,L,!0))})}Y+=12}),D.setUint32(Y,0,!0),I}var Fg=typeof self<"u"?self:global;const Cf=typeof navigator<"u",JT=Cf&&typeof HTMLImageElement>"u",hp=!(typeof global>"u"||typeof process>"u"||!process.versions||!process.versions.node),Gg=Fg.Buffer,ih=Fg.BigInt,Ug=!!Gg,QT=e=>e;function pp(e,t=QT){if(hp)try{return typeof require=="function"?Promise.resolve(t(require(e))):import(e).then(t)}catch{console.warn(`Couldn't load ${e}`)}}let zb=Fg.fetch;const e8=e=>zb=e;if(!Fg.fetch){const e=pp("http",n=>n),t=pp("https",n=>n),r=(n,{headers:a}={})=>new Promise(async(i,o)=>{let{port:s,hostname:l,pathname:u,protocol:d,search:f}=new URL(n);const h={method:"GET",hostname:l,path:encodeURI(u)+f,headers:a};s!==""&&(h.port=Number(s));const g=(d==="https:"?await t:await e).request(h,b=>{if(b.statusCode===301||b.statusCode===302){let w=new URL(b.headers.location,n).toString();return r(w,{headers:a}).then(i).catch(o)}i({status:b.statusCode,arrayBuffer:()=>new Promise(w=>{let v=[];b.on("data",x=>v.push(x)),b.on("end",()=>w(Buffer.concat(v)))})})});g.on("error",o),g.end()});e8(r)}function zt(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}const gp=e=>O_(e)?void 0:e,t8=e=>e!==void 0;function O_(e){return e===void 0||(e instanceof Map?e.size===0:Object.values(e).filter(t8).length===0)}function Vn(e){let t=new Error(e);throw delete t.stack,t}function $l(e){return(e=function(t){for(;t.endsWith("\0");)t=t.slice(0,-1);return t}(e).trim())===""?void 0:e}function sv(e){let t=function(r){let n=0;return r.ifd0.enabled&&(n+=1024),r.exif.enabled&&(n+=2048),r.makerNote&&(n+=2048),r.userComment&&(n+=1024),r.gps.enabled&&(n+=512),r.interop.enabled&&(n+=100),r.ifd1.enabled&&(n+=1024),n+2048}(e);return e.jfif.enabled&&(t+=50),e.xmp.enabled&&(t+=2e4),e.iptc.enabled&&(t+=14e3),e.icc.enabled&&(t+=6e3),t}const lv=e=>String.fromCharCode.apply(null,e),Ak=typeof TextDecoder<"u"?new TextDecoder("utf-8"):void 0;function A_(e){return Ak?Ak.decode(e):Ug?Buffer.from(e).toString("utf8"):decodeURIComponent(escape(lv(e)))}class ri{static from(t,r){return t instanceof this&&t.le===r?t:new ri(t,void 0,void 0,r)}constructor(t,r=0,n,a){if(typeof a=="boolean"&&(this.le=a),Array.isArray(t)&&(t=new Uint8Array(t)),t===0)this.byteOffset=0,this.byteLength=0;else if(t instanceof ArrayBuffer){n===void 0&&(n=t.byteLength-r);let i=new DataView(t,r,n);this._swapDataView(i)}else if(t instanceof Uint8Array||t instanceof DataView||t instanceof ri){n===void 0&&(n=t.byteLength-r),(r+=t.byteOffset)+n>t.byteOffset+t.byteLength&&Vn("Creating view outside of available memory in ArrayBuffer");let i=new DataView(t.buffer,r,n);this._swapDataView(i)}else if(typeof t=="number"){let i=new DataView(new ArrayBuffer(t));this._swapDataView(i)}else Vn("Invalid input argument for BufferView: "+t)}_swapArrayBuffer(t){this._swapDataView(new DataView(t))}_swapBuffer(t){this._swapDataView(new DataView(t.buffer,t.byteOffset,t.byteLength))}_swapDataView(t){this.dataView=t,this.buffer=t.buffer,this.byteOffset=t.byteOffset,this.byteLength=t.byteLength}_lengthToEnd(t){return this.byteLength-t}set(t,r,n=ri){return t instanceof DataView||t instanceof ri?t=new Uint8Array(t.buffer,t.byteOffset,t.byteLength):t instanceof ArrayBuffer&&(t=new Uint8Array(t)),t instanceof Uint8Array||Vn("BufferView.set(): Invalid data argument."),this.toUint8().set(t,r),new n(this,r,t.byteLength)}subarray(t,r){return r=r||this._lengthToEnd(t),new ri(this,t,r)}toUint8(){return new Uint8Array(this.buffer,this.byteOffset,this.byteLength)}getUint8Array(t,r){return new Uint8Array(this.buffer,this.byteOffset+t,r)}getString(t=0,r=this.byteLength){return A_(this.getUint8Array(t,r))}getLatin1String(t=0,r=this.byteLength){let n=this.getUint8Array(t,r);return lv(n)}getUnicodeString(t=0,r=this.byteLength){const n=[];for(let a=0;a<r&&t+a<this.byteLength;a+=2)n.push(this.getUint16(t+a));return lv(n)}getInt8(t){return this.dataView.getInt8(t)}getUint8(t){return this.dataView.getUint8(t)}getInt16(t,r=this.le){return this.dataView.getInt16(t,r)}getInt32(t,r=this.le){return this.dataView.getInt32(t,r)}getUint16(t,r=this.le){return this.dataView.getUint16(t,r)}getUint32(t,r=this.le){return this.dataView.getUint32(t,r)}getFloat32(t,r=this.le){return this.dataView.getFloat32(t,r)}getFloat64(t,r=this.le){return this.dataView.getFloat64(t,r)}getFloat(t,r=this.le){return this.dataView.getFloat32(t,r)}getDouble(t,r=this.le){return this.dataView.getFloat64(t,r)}getUintBytes(t,r,n){switch(r){case 1:return this.getUint8(t,n);case 2:return this.getUint16(t,n);case 4:return this.getUint32(t,n);case 8:return this.getUint64&&this.getUint64(t,n)}}getUint(t,r,n){switch(r){case 8:return this.getUint8(t,n);case 16:return this.getUint16(t,n);case 32:return this.getUint32(t,n);case 64:return this.getUint64&&this.getUint64(t,n)}}toString(t){return this.dataView.toString(t,this.constructor.name)}ensureChunk(){}}function cv(e,t){Vn(`${e} '${t}' was not loaded, try using full build of exifr.`)}let Wb=class extends Map{constructor(t){super(),this.kind=t}get(t,r){return this.has(t)||cv(this.kind,t),r&&(t in r||function(n,a){Vn(`Unknown ${n} '${a}'.`)}(this.kind,t),r[t].enabled||cv(this.kind,t)),super.get(t)}keyList(){return Array.from(this.keys())}};var Do=new Wb("file parser"),zn=new Wb("segment parser"),Lo=new Wb("file reader");function r8(e,t){return typeof e=="string"?Tk(e,t):Cf&&!JT&&e instanceof HTMLImageElement?Tk(e.src,t):e instanceof Uint8Array||e instanceof ArrayBuffer||e instanceof DataView?new ri(e):Cf&&e instanceof Blob?uv(e,t,"blob",ic):void Vn("Invalid input argument")}function Tk(e,t){return(r=e).startsWith("data:")||r.length>1e4?dv(e,t,"base64"):hp&&e.includes("://")?uv(e,t,"url",ac):hp?dv(e,t,"fs"):Cf?uv(e,t,"url",ac):void Vn("Invalid input argument");var r}async function uv(e,t,r,n){return Lo.has(r)?dv(e,t,r):n?async function(a,i){let o=await i(a);return new ri(o)}(e,n):void Vn(`Parser ${r} is not loaded`)}async function dv(e,t,r){let n=new(Lo.get(r))(e,t);return await n.read(),n}const ac=e=>zb(e).then(t=>t.arrayBuffer()),ic=e=>new Promise((t,r)=>{let n=new FileReader;n.onloadend=()=>t(n.result||new ArrayBuffer),n.onerror=r,n.readAsArrayBuffer(e)});class n8 extends Map{get tagKeys(){return this.allKeys||(this.allKeys=Array.from(this.keys())),this.allKeys}get tagValues(){return this.allValues||(this.allValues=Array.from(this.values())),this.allValues}}function Dn(e,t,r){let n=new n8;for(let[a,i]of r)n.set(a,i);if(Array.isArray(t))for(let a of t)e.set(a,n);else e.set(t,n);return n}function oc(e,t,r){let n,a=e.get(t);for(n of r)a.set(n[0],n[1])}const ha=new Map,ho=new Map,tl=new Map,Bs=["chunked","firstChunkSize","firstChunkSizeNode","firstChunkSizeBrowser","chunkSize","chunkLimit"],Hu=["jfif","xmp","icc","iptc","ihdr"],sc=["tiff",...Hu],On=["ifd0","ifd1","exif","gps","interop"],Ls=[...sc,...On],Fs=["makerNote","userComment"],Vu=["translateKeys","translateValues","reviveValues","multiSegment"],Gs=[...Vu,"sanitize","mergeOutput","silentErrors"];class T_{get translate(){return this.translateKeys||this.translateValues||this.reviveValues}}class _d extends T_{get needed(){return this.enabled||this.deps.size>0}constructor(t,r,n,a){if(super(),zt(this,"enabled",!1),zt(this,"skip",new Set),zt(this,"pick",new Set),zt(this,"deps",new Set),zt(this,"translateKeys",!1),zt(this,"translateValues",!1),zt(this,"reviveValues",!1),this.key=t,this.enabled=r,this.parse=this.enabled,this.applyInheritables(a),this.canBeFiltered=On.includes(t),this.canBeFiltered&&(this.dict=ha.get(t)),n!==void 0)if(Array.isArray(n))this.parse=this.enabled=!0,this.canBeFiltered&&n.length>0&&this.translateTagSet(n,this.pick);else if(typeof n=="object"){if(this.enabled=!0,this.parse=n.parse!==!1,this.canBeFiltered){let{pick:i,skip:o}=n;i&&i.length>0&&this.translateTagSet(i,this.pick),o&&o.length>0&&this.translateTagSet(o,this.skip)}this.applyInheritables(n)}else n===!0||n===!1?this.parse=this.enabled=n:Vn(`Invalid options argument: ${n}`)}applyInheritables(t){let r,n;for(r of Vu)n=t[r],n!==void 0&&(this[r]=n)}translateTagSet(t,r){if(this.dict){let n,a,{tagKeys:i,tagValues:o}=this.dict;for(n of t)typeof n=="string"?(a=o.indexOf(n),a===-1&&(a=i.indexOf(Number(n))),a!==-1&&r.add(Number(i[a]))):r.add(n)}else for(let n of t)r.add(n)}finalizeFilters(){!this.enabled&&this.deps.size>0?(this.enabled=!0,mp(this.pick,this.deps)):this.enabled&&this.pick.size>0&&mp(this.pick,this.deps)}}var Ua={jfif:!1,tiff:!0,xmp:!1,icc:!1,iptc:!1,ifd0:!0,ifd1:!1,exif:!0,gps:!0,interop:!1,ihdr:void 0,makerNote:!1,userComment:!1,multiSegment:!1,skip:[],pick:[],translateKeys:!0,translateValues:!0,reviveValues:!0,sanitize:!0,mergeOutput:!0,silentErrors:!0,chunked:!0,firstChunkSize:void 0,firstChunkSizeNode:512,firstChunkSizeBrowser:65536,chunkSize:65536,chunkLimit:5},Ek=new Map;let mc=class extends T_{static useCached(t){let r=Ek.get(t);return r!==void 0||(r=new this(t),Ek.set(t,r)),r}constructor(t){super(),t===!0?this.setupFromTrue():t===void 0?this.setupFromUndefined():Array.isArray(t)?this.setupFromArray(t):typeof t=="object"?this.setupFromObject(t):Vn(`Invalid options argument ${t}`),this.firstChunkSize===void 0&&(this.firstChunkSize=Cf?this.firstChunkSizeBrowser:this.firstChunkSizeNode),this.mergeOutput&&(this.ifd1.enabled=!1),this.filterNestedSegmentTags(),this.traverseTiffDependencyTree(),this.checkLoadedPlugins()}setupFromUndefined(){let t;for(t of Bs)this[t]=Ua[t];for(t of Gs)this[t]=Ua[t];for(t of Fs)this[t]=Ua[t];for(t of Ls)this[t]=new _d(t,Ua[t],void 0,this)}setupFromTrue(){let t;for(t of Bs)this[t]=Ua[t];for(t of Gs)this[t]=Ua[t];for(t of Fs)this[t]=!0;for(t of Ls)this[t]=new _d(t,!0,void 0,this)}setupFromArray(t){let r;for(r of Bs)this[r]=Ua[r];for(r of Gs)this[r]=Ua[r];for(r of Fs)this[r]=Ua[r];for(r of Ls)this[r]=new _d(r,!1,void 0,this);this.setupGlobalFilters(t,void 0,On)}setupFromObject(t){let r;for(r of(On.ifd0=On.ifd0||On.image,On.ifd1=On.ifd1||On.thumbnail,Object.assign(this,t),Bs))this[r]=ky(t[r],Ua[r]);for(r of Gs)this[r]=ky(t[r],Ua[r]);for(r of Fs)this[r]=ky(t[r],Ua[r]);for(r of sc)this[r]=new _d(r,Ua[r],t[r],this);for(r of On)this[r]=new _d(r,Ua[r],t[r],this.tiff);this.setupGlobalFilters(t.pick,t.skip,On,Ls),t.tiff===!0?this.batchEnableWithBool(On,!0):t.tiff===!1?this.batchEnableWithUserValue(On,t):Array.isArray(t.tiff)?this.setupGlobalFilters(t.tiff,void 0,On):typeof t.tiff=="object"&&this.setupGlobalFilters(t.tiff.pick,t.tiff.skip,On)}batchEnableWithBool(t,r){for(let n of t)this[n].enabled=r}batchEnableWithUserValue(t,r){for(let n of t){let a=r[n];this[n].enabled=a!==!1&&a!==void 0}}setupGlobalFilters(t,r,n,a=n){if(t&&t.length){for(let o of a)this[o].enabled=!1;let i=Ik(t,n);for(let[o,s]of i)mp(this[o].pick,s),this[o].enabled=!0}else if(r&&r.length){let i=Ik(r,n);for(let[o,s]of i)mp(this[o].skip,s)}}filterNestedSegmentTags(){let{ifd0:t,exif:r,xmp:n,iptc:a,icc:i}=this;this.makerNote?r.deps.add(37500):r.skip.add(37500),this.userComment?r.deps.add(37510):r.skip.add(37510),n.enabled||t.skip.add(700),a.enabled||t.skip.add(33723),i.enabled||t.skip.add(34675)}traverseTiffDependencyTree(){let{ifd0:t,exif:r,gps:n,interop:a}=this;a.needed&&(r.deps.add(40965),t.deps.add(40965)),r.needed&&t.deps.add(34665),n.needed&&t.deps.add(34853),this.tiff.enabled=On.some(i=>this[i].enabled===!0)||this.makerNote||this.userComment;for(let i of On)this[i].finalizeFilters()}get onlyTiff(){return!Hu.map(t=>this[t].enabled).some(t=>t===!0)&&this.tiff.enabled}checkLoadedPlugins(){for(let t of sc)this[t].enabled&&!zn.has(t)&&cv("segment parser",t)}};function Ik(e,t){let r,n,a,i,o=[];for(a of t){for(i of(r=ha.get(a),n=[],r))(e.includes(i[0])||e.includes(i[1]))&&n.push(i[0]);n.length&&o.push([a,n])}return o}function ky(e,t){return e!==void 0?e:t!==void 0?t:void 0}function mp(e,t){for(let r of t)e.add(r)}zt(mc,"default",Ua);class ll{constructor(t){zt(this,"parsers",{}),zt(this,"output",{}),zt(this,"errors",[]),zt(this,"pushToErrors",r=>this.errors.push(r)),this.options=mc.useCached(t)}async read(t){this.file=await r8(t,this.options)}setup(){if(this.fileParser)return;let{file:t}=this,r=t.getUint16(0);for(let[n,a]of Do)if(a.canHandle(t,r))return this.fileParser=new a(this.options,this.file,this.parsers),t[n]=!0;this.file.close&&this.file.close(),Vn("Unknown file format")}async parse(){let{output:t,errors:r}=this;return this.setup(),this.options.silentErrors?(await this.executeParsers().catch(this.pushToErrors),r.push(...this.fileParser.errors)):await this.executeParsers(),this.file.close&&this.file.close(),this.options.silentErrors&&r.length>0&&(t.errors=r),gp(t)}async executeParsers(){let{output:t}=this;await this.fileParser.parse();let r=Object.values(this.parsers).map(async n=>{let a=await n.parse();n.assignToOutput(t,a)});this.options.silentErrors&&(r=r.map(n=>n.catch(this.pushToErrors))),await Promise.all(r)}async extractThumbnail(){this.setup();let{options:t,file:r}=this,n=zn.get("tiff",t);var a;if(r.tiff?a={start:0,type:"tiff"}:r.jpeg&&(a=await this.fileParser.getOrFindSegment("tiff")),a===void 0)return;let i=await this.fileParser.ensureSegmentChunk(a),o=this.parsers.tiff=new n(i,t,r),s=await o.extractThumbnail();return r.close&&r.close(),s}}async function zg(e,t){let r=new ll(t);return await r.read(e),r.parse()}var a8=Object.freeze({__proto__:null,parse:zg,Exifr:ll,fileParsers:Do,segmentParsers:zn,fileReaders:Lo,tagKeys:ha,tagValues:ho,tagRevivers:tl,createDictionary:Dn,extendDictionary:oc,fetchUrlAsArrayBuffer:ac,readBlobAsArrayBuffer:ic,chunkedProps:Bs,otherSegments:Hu,segments:sc,tiffBlocks:On,segmentsAndBlocks:Ls,tiffExtractables:Fs,inheritables:Vu,allFormatters:Gs,Options:mc});class Wg{constructor(t,r,n){zt(this,"errors",[]),zt(this,"ensureSegmentChunk",async a=>{let i=a.start,o=a.size||65536;if(this.file.chunked)if(this.file.available(i,o))a.chunk=this.file.subarray(i,o);else try{a.chunk=await this.file.readChunk(i,o)}catch(s){Vn(`Couldn't read segment: ${JSON.stringify(a)}. ${s.message}`)}else this.file.byteLength>i+o?a.chunk=this.file.subarray(i,o):a.size===void 0?a.chunk=this.file.subarray(i):Vn("Segment unreachable: "+JSON.stringify(a));return a.chunk}),this.extendOptions&&this.extendOptions(t),this.options=t,this.file=r,this.parsers=n}injectSegment(t,r){this.options[t].enabled&&this.createParser(t,r)}createParser(t,r){let n=new(zn.get(t))(r,this.options,this.file);return this.parsers[t]=n}createParsers(t){for(let r of t){let{type:n,chunk:a}=r,i=this.options[n];if(i&&i.enabled){let o=this.parsers[n];o&&o.append||o||this.createParser(n,a)}}}async readSegments(t){let r=t.map(this.ensureSegmentChunk);await Promise.all(r)}}let io=class{static findPosition(t,r){let n=t.getUint16(r+2)+2,a=typeof this.headerLength=="function"?this.headerLength(t,r,n):this.headerLength,i=r+a,o=n-a;return{offset:r,length:n,headerLength:a,start:i,size:o,end:i+o}}static parse(t,r={}){return new this(t,new mc({[this.type]:r}),t).parse()}normalizeInput(t){return t instanceof ri?t:new ri(t)}constructor(t,r={},n){zt(this,"errors",[]),zt(this,"raw",new Map),zt(this,"handleError",a=>{if(!this.options.silentErrors)throw a;this.errors.push(a.message)}),this.chunk=this.normalizeInput(t),this.file=n,this.type=this.constructor.type,this.globalOptions=this.options=r,this.localOptions=r[this.type],this.canTranslate=this.localOptions&&this.localOptions.translate}translate(){this.canTranslate&&(this.translated=this.translateBlock(this.raw,this.type))}get output(){return this.translated?this.translated:this.raw?Object.fromEntries(this.raw):void 0}translateBlock(t,r){let n=tl.get(r),a=ho.get(r),i=ha.get(r),o=this.options[r],s=o.reviveValues&&!!n,l=o.translateValues&&!!a,u=o.translateKeys&&!!i,d={};for(let[f,h]of t)s&&n.has(f)?h=n.get(f)(h):l&&a.has(f)&&(h=this.translateValue(h,a.get(f))),u&&i.has(f)&&(f=i.get(f)||f),d[f]=h;return d}translateValue(t,r){return r[t]||r.DEFAULT||t}assignToOutput(t,r){this.assignObjectToOutput(t,this.constructor.type,r)}assignObjectToOutput(t,r,n){if(this.globalOptions.mergeOutput)return Object.assign(t,n);t[r]?Object.assign(t[r],n):t[r]=n}};zt(io,"headerLength",4),zt(io,"type",void 0),zt(io,"multiSegment",!1),zt(io,"canHandle",()=>!1);function i8(e){return e===192||e===194||e===196||e===219||e===221||e===218||e===254}function o8(e){return e>=224&&e<=239}function s8(e,t,r){for(let[n,a]of zn)if(a.canHandle(e,t,r))return n}class $k extends Wg{constructor(...t){super(...t),zt(this,"appSegments",[]),zt(this,"jpegSegments",[]),zt(this,"unknownSegments",[])}static canHandle(t,r){return r===65496}async parse(){await this.findAppSegments(),await this.readSegments(this.appSegments),this.mergeMultiSegments(),this.createParsers(this.mergedAppSegments||this.appSegments)}setupSegmentFinderArgs(t){t===!0?(this.findAll=!0,this.wanted=new Set(zn.keyList())):(t=t===void 0?zn.keyList().filter(r=>this.options[r].enabled):t.filter(r=>this.options[r].enabled&&zn.has(r)),this.findAll=!1,this.remaining=new Set(t),this.wanted=new Set(t)),this.unfinishedMultiSegment=!1}async findAppSegments(t=0,r){this.setupSegmentFinderArgs(r);let{file:n,findAll:a,wanted:i,remaining:o}=this;if(!a&&this.file.chunked&&(a=Array.from(i).some(s=>{let l=zn.get(s),u=this.options[s];return l.multiSegment&&u.multiSegment}),a&&await this.file.readWhole()),t=this.findAppSegmentsInRange(t,n.byteLength),!this.options.onlyTiff&&n.chunked){let s=!1;for(;o.size>0&&!s&&(n.canReadNextChunk||this.unfinishedMultiSegment);){let{nextChunkOffset:l}=n,u=this.appSegments.some(d=>!this.file.available(d.offset||d.start,d.length||d.size));if(s=t>l&&!u?!await n.readNextChunk(t):!await n.readNextChunk(l),(t=this.findAppSegmentsInRange(t,n.byteLength))===void 0)return}}}findAppSegmentsInRange(t,r){r-=2;let n,a,i,o,s,l,{file:u,findAll:d,wanted:f,remaining:h,options:g}=this;for(;t<r;t++)if(u.getUint8(t)===255){if(n=u.getUint8(t+1),o8(n)){if(a=u.getUint16(t+2),i=s8(u,t,a),i&&f.has(i)&&(o=zn.get(i),s=o.findPosition(u,t),l=g[i],s.type=i,this.appSegments.push(s),!d&&(o.multiSegment&&l.multiSegment?(this.unfinishedMultiSegment=s.chunkNumber<s.chunkCount,this.unfinishedMultiSegment||h.delete(i)):h.delete(i),h.size===0)))break;g.recordUnknownSegments&&(s=io.findPosition(u,t),s.marker=n,this.unknownSegments.push(s)),t+=a+1}else if(i8(n)){if(a=u.getUint16(t+2),n===218&&g.stopAfterSos!==!1)return;g.recordJpegSegments&&this.jpegSegments.push({offset:t,length:a,marker:n}),t+=a+1}}return t}mergeMultiSegments(){if(!this.appSegments.some(r=>r.multiSegment))return;let t=function(r,n){let a,i,o,s=new Map;for(let l=0;l<r.length;l++)a=r[l],i=a[n],s.has(i)?o=s.get(i):s.set(i,o=[]),o.push(a);return Array.from(s)}(this.appSegments,"type");this.mergedAppSegments=t.map(([r,n])=>{let a=zn.get(r,this.options);return a.handleMultiSegments?{type:r,chunk:a.handleMultiSegments(n)}:n[0]})}getSegment(t){return this.appSegments.find(r=>r.type===t)}async getOrFindSegment(t){let r=this.getSegment(t);return r===void 0&&(await this.findAppSegments(0,[t]),r=this.getSegment(t)),r}}zt($k,"type","jpeg"),Do.set("jpeg",$k);const l8=[void 0,1,1,2,4,8,1,1,2,4,8,4,8,4];class c8 extends io{parseHeader(){var t=this.chunk.getUint16();t===18761?this.le=!0:t===19789&&(this.le=!1),this.chunk.le=this.le,this.headerParsed=!0}parseTags(t,r,n=new Map){let{pick:a,skip:i}=this.options[r];a=new Set(a);let o=a.size>0,s=i.size===0,l=this.chunk.getUint16(t);t+=2;for(let u=0;u<l;u++){let d=this.chunk.getUint16(t);if(o){if(a.has(d)&&(n.set(d,this.parseTag(t,d,r)),a.delete(d),a.size===0))break}else!s&&i.has(d)||n.set(d,this.parseTag(t,d,r));t+=12}return n}parseTag(t,r,n){let{chunk:a}=this,i=a.getUint16(t+2),o=a.getUint32(t+4),s=l8[i];if(s*o<=4?t+=8:t=a.getUint32(t+8),(i<1||i>13)&&Vn(`Invalid TIFF value type. block: ${n.toUpperCase()}, tag: ${r.toString(16)}, type: ${i}, offset ${t}`),t>a.byteLength&&Vn(`Invalid TIFF value offset. block: ${n.toUpperCase()}, tag: ${r.toString(16)}, type: ${i}, offset ${t} is outside of chunk size ${a.byteLength}`),i===1)return a.getUint8Array(t,o);if(i===2)return $l(a.getString(t,o));if(i===7)return a.getUint8Array(t,o);if(o===1)return this.parseTagValue(i,t);{let l=new(function(d){switch(d){case 1:return Uint8Array;case 3:return Uint16Array;case 4:return Uint32Array;case 5:return Array;case 6:return Int8Array;case 8:return Int16Array;case 9:return Int32Array;case 10:return Array;case 11:return Float32Array;case 12:return Float64Array;default:return Array}}(i))(o),u=s;for(let d=0;d<o;d++)l[d]=this.parseTagValue(i,t),t+=u;return l}}parseTagValue(t,r){let{chunk:n}=this;switch(t){case 1:return n.getUint8(r);case 3:return n.getUint16(r);case 4:return n.getUint32(r);case 5:return n.getUint32(r)/n.getUint32(r+4);case 6:return n.getInt8(r);case 8:return n.getInt16(r);case 9:return n.getInt32(r);case 10:return n.getInt32(r)/n.getInt32(r+4);case 11:return n.getFloat(r);case 12:return n.getDouble(r);case 13:return n.getUint32(r);default:Vn(`Invalid tiff type ${t}`)}}}class Sy extends c8{static canHandle(t,r){return t.getUint8(r+1)===225&&t.getUint32(r+4)===1165519206&&t.getUint16(r+8)===0}async parse(){this.parseHeader();let{options:t}=this;return t.ifd0.enabled&&await this.parseIfd0Block(),t.exif.enabled&&await this.safeParse("parseExifBlock"),t.gps.enabled&&await this.safeParse("parseGpsBlock"),t.interop.enabled&&await this.safeParse("parseInteropBlock"),t.ifd1.enabled&&await this.safeParse("parseThumbnailBlock"),this.createOutput()}safeParse(t){let r=this[t]();return r.catch!==void 0&&(r=r.catch(this.handleError)),r}findIfd0Offset(){this.ifd0Offset===void 0&&(this.ifd0Offset=this.chunk.getUint32(4))}findIfd1Offset(){if(this.ifd1Offset===void 0){this.findIfd0Offset();let t=this.chunk.getUint16(this.ifd0Offset),r=this.ifd0Offset+2+12*t;this.ifd1Offset=this.chunk.getUint32(r)}}parseBlock(t,r){let n=new Map;return this[r]=n,this.parseTags(t,r,n),n}async parseIfd0Block(){if(this.ifd0)return;let{file:t}=this;this.findIfd0Offset(),this.ifd0Offset<8&&Vn("Malformed EXIF data"),!t.chunked&&this.ifd0Offset>t.byteLength&&Vn(`IFD0 offset points to outside of file.
this.ifd0Offset: ${this.ifd0Offset}, file.byteLength: ${t.byteLength}`),t.tiff&&await t.ensureChunk(this.ifd0Offset,sv(this.options));let r=this.parseBlock(this.ifd0Offset,"ifd0");return r.size!==0?(this.exifOffset=r.get(34665),this.interopOffset=r.get(40965),this.gpsOffset=r.get(34853),this.xmp=r.get(700),this.iptc=r.get(33723),this.icc=r.get(34675),this.options.sanitize&&(r.delete(34665),r.delete(40965),r.delete(34853),r.delete(700),r.delete(33723),r.delete(34675)),r):void 0}async parseExifBlock(){if(this.exif||(this.ifd0||await this.parseIfd0Block(),this.exifOffset===void 0))return;this.file.tiff&&await this.file.ensureChunk(this.exifOffset,sv(this.options));let t=this.parseBlock(this.exifOffset,"exif");return this.interopOffset||(this.interopOffset=t.get(40965)),this.makerNote=t.get(37500),this.userComment=t.get(37510),this.options.sanitize&&(t.delete(40965),t.delete(37500),t.delete(37510)),this.unpack(t,41728),this.unpack(t,41729),t}unpack(t,r){let n=t.get(r);n&&n.length===1&&t.set(r,n[0])}async parseGpsBlock(){if(this.gps||(this.ifd0||await this.parseIfd0Block(),this.gpsOffset===void 0))return;let t=this.parseBlock(this.gpsOffset,"gps");return t&&t.has(2)&&t.has(4)&&(t.set("latitude",Dk(...t.get(2),t.get(1))),t.set("longitude",Dk(...t.get(4),t.get(3)))),t}async parseInteropBlock(){if(!this.interop&&(this.ifd0||await this.parseIfd0Block(),this.interopOffset!==void 0||this.exif||await this.parseExifBlock(),this.interopOffset!==void 0))return this.parseBlock(this.interopOffset,"interop")}async parseThumbnailBlock(t=!1){if(!this.ifd1&&!this.ifd1Parsed&&(!this.options.mergeOutput||t))return this.findIfd1Offset(),this.ifd1Offset>0&&(this.parseBlock(this.ifd1Offset,"ifd1"),this.ifd1Parsed=!0),this.ifd1}async extractThumbnail(){if(this.headerParsed||this.parseHeader(),this.ifd1Parsed||await this.parseThumbnailBlock(!0),this.ifd1===void 0)return;let t=this.ifd1.get(513),r=this.ifd1.get(514);return this.chunk.getUint8Array(t,r)}get image(){return this.ifd0}get thumbnail(){return this.ifd1}createOutput(){let t,r,n,a={};for(r of On)if(t=this[r],!O_(t))if(n=this.canTranslate?this.translateBlock(t,r):Object.fromEntries(t),this.options.mergeOutput){if(r==="ifd1")continue;Object.assign(a,n)}else a[r]=n;return this.makerNote&&(a.makerNote=this.makerNote),this.userComment&&(a.userComment=this.userComment),a}assignToOutput(t,r){if(this.globalOptions.mergeOutput)Object.assign(t,r);else for(let[n,a]of Object.entries(r))this.assignObjectToOutput(t,n,a)}}function Dk(e,t,r,n){var a=e+t/60+r/3600;return n!=="S"&&n!=="W"||(a*=-1),a}zt(Sy,"type","tiff"),zt(Sy,"headerLength",10),zn.set("tiff",Sy);var u8=Object.freeze({__proto__:null,default:a8,Exifr:ll,fileParsers:Do,segmentParsers:zn,fileReaders:Lo,tagKeys:ha,tagValues:ho,tagRevivers:tl,createDictionary:Dn,extendDictionary:oc,fetchUrlAsArrayBuffer:ac,readBlobAsArrayBuffer:ic,chunkedProps:Bs,otherSegments:Hu,segments:sc,tiffBlocks:On,segmentsAndBlocks:Ls,tiffExtractables:Fs,inheritables:Vu,allFormatters:Gs,Options:mc,parse:zg});const Hb={ifd0:!1,ifd1:!1,exif:!1,gps:!1,interop:!1,sanitize:!1,reviveValues:!0,translateKeys:!1,translateValues:!1,mergeOutput:!1},Vb=Object.assign({},Hb,{firstChunkSize:4e4,gps:[1,2,3,4]});async function E_(e){let t=new ll(Vb);await t.read(e);let r=await t.parse();if(r&&r.gps){let{latitude:n,longitude:a}=r.gps;return{latitude:n,longitude:a}}}const Xb=Object.assign({},Hb,{tiff:!1,ifd1:!0,mergeOutput:!1});async function I_(e){let t=new ll(Xb);await t.read(e);let r=await t.extractThumbnail();return r&&Ug?Gg.from(r):r}async function $_(e){let t=await this.thumbnail(e);if(t!==void 0){let r=new Blob([t]);return URL.createObjectURL(r)}}const Kb=Object.assign({},Hb,{firstChunkSize:4e4,ifd0:[274]});async function Yb(e){let t=new ll(Kb);await t.read(e);let r=await t.parse();if(r&&r.ifd0)return r.ifd0[274]}const qb=Object.freeze({1:{dimensionSwapped:!1,scaleX:1,scaleY:1,deg:0,rad:0},2:{dimensionSwapped:!1,scaleX:-1,scaleY:1,deg:0,rad:0},3:{dimensionSwapped:!1,scaleX:1,scaleY:1,deg:180,rad:180*Math.PI/180},4:{dimensionSwapped:!1,scaleX:-1,scaleY:1,deg:180,rad:180*Math.PI/180},5:{dimensionSwapped:!0,scaleX:1,scaleY:-1,deg:90,rad:90*Math.PI/180},6:{dimensionSwapped:!0,scaleX:1,scaleY:1,deg:90,rad:90*Math.PI/180},7:{dimensionSwapped:!0,scaleX:1,scaleY:-1,deg:270,rad:270*Math.PI/180},8:{dimensionSwapped:!0,scaleX:1,scaleY:1,deg:270,rad:270*Math.PI/180}});let Dl=!0,Rl=!0;if(typeof navigator=="object"){let e=navigator.userAgent;if(e.includes("iPad")||e.includes("iPhone")){let t=e.match(/OS (\d+)_(\d+)/);if(t){let[,r,n]=t;Dl=Number(r)+.1*Number(n)<13.4,Rl=!1}}else if(e.includes("OS X 10")){let[,t]=e.match(/OS X 10[_.](\d+)/);Dl=Rl=Number(t)<15}if(e.includes("Chrome/")){let[,t]=e.match(/Chrome\/(\d+)/);Dl=Rl=Number(t)<81}else if(e.includes("Firefox/")){let[,t]=e.match(/Firefox\/(\d+)/);Dl=Rl=Number(t)<77}}async function D_(e){let t=await Yb(e);return Object.assign({canvas:Dl,css:Rl},qb[t])}class d8 extends ri{constructor(...t){super(...t),zt(this,"ranges",new f8),this.byteLength!==0&&this.ranges.add(0,this.byteLength)}_tryExtend(t,r,n){if(t===0&&this.byteLength===0&&n){let a=new DataView(n.buffer||n,n.byteOffset,n.byteLength);this._swapDataView(a)}else{let a=t+r;if(a>this.byteLength){let{dataView:i}=this._extend(a);this._swapDataView(i)}}}_extend(t){let r;r=Ug?Gg.allocUnsafe(t):new Uint8Array(t);let n=new DataView(r.buffer,r.byteOffset,r.byteLength);return r.set(new Uint8Array(this.buffer,this.byteOffset,this.byteLength),0),{uintView:r,dataView:n}}subarray(t,r,n=!1){return r=r||this._lengthToEnd(t),n&&this._tryExtend(t,r),this.ranges.add(t,r),super.subarray(t,r)}set(t,r,n=!1){n&&this._tryExtend(r,t.byteLength,t);let a=super.set(t,r);return this.ranges.add(r,a.byteLength),a}async ensureChunk(t,r){this.chunked&&(this.ranges.available(t,r)||await this.readChunk(t,r))}available(t,r){return this.ranges.available(t,r)}}class f8{constructor(){zt(this,"list",[])}get length(){return this.list.length}add(t,r,n=0){let a=t+r,i=this.list.filter(o=>Rk(t,o.offset,a)||Rk(t,o.end,a));if(i.length>0){t=Math.min(t,...i.map(s=>s.offset)),a=Math.max(a,...i.map(s=>s.end)),r=a-t;let o=i.shift();o.offset=t,o.length=r,o.end=a,this.list=this.list.filter(s=>!i.includes(s))}else this.list.push({offset:t,length:r,end:a})}available(t,r){let n=t+r;return this.list.some(a=>a.offset<=t&&n<=a.end)}}function Rk(e,t,r){return e<=t&&t<=r}class Hg extends d8{constructor(t,r){super(0),zt(this,"chunksRead",0),this.input=t,this.options=r}async readWhole(){this.chunked=!1,await this.readChunk(this.nextChunkOffset)}async readChunked(){this.chunked=!0,await this.readChunk(0,this.options.firstChunkSize)}async readNextChunk(t=this.nextChunkOffset){if(this.fullyRead)return this.chunksRead++,!1;let r=this.options.chunkSize,n=await this.readChunk(t,r);return!!n&&n.byteLength===r}async readChunk(t,r){if(this.chunksRead++,(r=this.safeWrapAddress(t,r))!==0)return this._readChunk(t,r)}safeWrapAddress(t,r){return this.size!==void 0&&t+r>this.size?Math.max(0,this.size-t):r}get nextChunkOffset(){if(this.ranges.list.length!==0)return this.ranges.list[0].length}get canReadNextChunk(){return this.chunksRead<this.options.chunkLimit}get fullyRead(){return this.size!==void 0&&this.nextChunkOffset===this.size}read(){return this.options.chunked?this.readChunked():this.readWhole()}close(){}}Lo.set("blob",class extends Hg{async readWhole(){this.chunked=!1;let e=await ic(this.input);this._swapArrayBuffer(e)}readChunked(){return this.chunked=!0,this.size=this.input.size,super.readChunked()}async _readChunk(e,t){let r=t?e+t:void 0,n=this.input.slice(e,r),a=await ic(n);return this.set(a,e,!0)}});var h8=Object.freeze({__proto__:null,default:u8,Exifr:ll,fileParsers:Do,segmentParsers:zn,fileReaders:Lo,tagKeys:ha,tagValues:ho,tagRevivers:tl,createDictionary:Dn,extendDictionary:oc,fetchUrlAsArrayBuffer:ac,readBlobAsArrayBuffer:ic,chunkedProps:Bs,otherSegments:Hu,segments:sc,tiffBlocks:On,segmentsAndBlocks:Ls,tiffExtractables:Fs,inheritables:Vu,allFormatters:Gs,Options:mc,parse:zg,gpsOnlyOptions:Vb,gps:E_,thumbnailOnlyOptions:Xb,thumbnail:I_,thumbnailUrl:$_,orientationOnlyOptions:Kb,orientation:Yb,rotations:qb,get rotateCanvas(){return Dl},get rotateCss(){return Rl},rotation:D_});Lo.set("url",class extends Hg{async readWhole(){this.chunked=!1;let e=await ac(this.input);e instanceof ArrayBuffer?this._swapArrayBuffer(e):e instanceof Uint8Array&&this._swapBuffer(e)}async _readChunk(e,t){let r=t?e+t-1:void 0,n=this.options.httpHeaders||{};(e||r)&&(n.range=`bytes=${[e,r].join("-")}`);let a=await zb(this.input,{headers:n}),i=await a.arrayBuffer(),o=i.byteLength;if(a.status!==416)return o!==t&&(this.size=e+o),this.set(i,e,!0)}});ri.prototype.getUint64=function(e){let t=this.getUint32(e),r=this.getUint32(e+4);return t<1048575?t<<32|r:typeof ih!==void 0?(console.warn("Using BigInt because of type 64uint but JS can only handle 53b numbers."),ih(t)<<ih(32)|ih(r)):void Vn("Trying to read 64b value but JS can only handle 53b numbers.")};class p8 extends Wg{parseBoxes(t=0){let r=[];for(;t<this.file.byteLength-4;){let n=this.parseBoxHead(t);if(r.push(n),n.length===0)break;t+=n.length}return r}parseSubBoxes(t){t.boxes=this.parseBoxes(t.start)}findBox(t,r){return t.boxes===void 0&&this.parseSubBoxes(t),t.boxes.find(n=>n.kind===r)}parseBoxHead(t){let r=this.file.getUint32(t),n=this.file.getString(t+4,4),a=t+8;return r===1&&(r=this.file.getUint64(t+8),a+=8),{offset:t,length:r,kind:n,start:a}}parseBoxFullHead(t){if(t.version!==void 0)return;let r=this.file.getUint32(t.start);t.version=r>>24,t.start+=4}}class R_ extends p8{static canHandle(t,r){if(r!==0)return!1;let n=t.getUint16(2);if(n>50)return!1;let a=16,i=[];for(;a<n;)i.push(t.getString(a,4)),a+=4;return i.includes(this.type)}async parse(){let t=this.file.getUint32(0),r=this.parseBoxHead(t);for(;r.kind!=="meta";)t+=r.length,await this.file.ensureChunk(t,16),r=this.parseBoxHead(t);await this.file.ensureChunk(r.offset,r.length),this.parseBoxFullHead(r),this.parseSubBoxes(r),this.options.icc.enabled&&await this.findIcc(r),this.options.tiff.enabled&&await this.findExif(r)}async registerSegment(t,r,n){await this.file.ensureChunk(r,n);let a=this.file.subarray(r,n);this.createParser(t,a)}async findIcc(t){let r=this.findBox(t,"iprp");if(r===void 0)return;let n=this.findBox(r,"ipco");if(n===void 0)return;let a=this.findBox(n,"colr");a!==void 0&&await this.registerSegment("icc",a.offset+12,a.length)}async findExif(t){let r=this.findBox(t,"iinf");if(r===void 0)return;let n=this.findBox(t,"iloc");if(n===void 0)return;let a=this.findExifLocIdInIinf(r),i=this.findExtentInIloc(n,a);if(i===void 0)return;let[o,s]=i;await this.file.ensureChunk(o,s);let l=4+this.file.getUint32(o);o+=l,s-=l,await this.registerSegment("tiff",o,s)}findExifLocIdInIinf(t){this.parseBoxFullHead(t);let r,n,a,i,o=t.start,s=this.file.getUint16(o);for(o+=2;s--;){if(r=this.parseBoxHead(o),this.parseBoxFullHead(r),n=r.start,r.version>=2&&(a=r.version===3?4:2,i=this.file.getString(n+a+2,4),i==="Exif"))return this.file.getUintBytes(n,a);o+=r.length}}get8bits(t){let r=this.file.getUint8(t);return[r>>4,15&r]}findExtentInIloc(t,r){this.parseBoxFullHead(t);let n=t.start,[a,i]=this.get8bits(n++),[o,s]=this.get8bits(n++),l=t.version===2?4:2,u=t.version===1||t.version===2?2:0,d=s+a+i,f=t.version===2?4:2,h=this.file.getUintBytes(n,f);for(n+=f;h--;){let g=this.file.getUintBytes(n,l);n+=l+u+2+o;let b=this.file.getUint16(n);if(n+=2,g===r)return b>1&&console.warn(`ILOC box has more than one extent but we're only processing one
Please create an issue at https://github.com/MikeKovarik/exifr with this file`),[this.file.getUintBytes(n+s,a),this.file.getUintBytes(n+s+a,i)];n+=b*d}}}class B_ extends R_{}zt(B_,"type","heic");class Bk extends R_{}zt(Bk,"type","avif"),Do.set("heic",B_),Do.set("avif",Bk),Dn(ha,["ifd0","ifd1"],[[256,"ImageWidth"],[257,"ImageHeight"],[258,"BitsPerSample"],[259,"Compression"],[262,"PhotometricInterpretation"],[270,"ImageDescription"],[271,"Make"],[272,"Model"],[273,"StripOffsets"],[274,"Orientation"],[277,"SamplesPerPixel"],[278,"RowsPerStrip"],[279,"StripByteCounts"],[282,"XResolution"],[283,"YResolution"],[284,"PlanarConfiguration"],[296,"ResolutionUnit"],[301,"TransferFunction"],[305,"Software"],[306,"ModifyDate"],[315,"Artist"],[316,"HostComputer"],[317,"Predictor"],[318,"WhitePoint"],[319,"PrimaryChromaticities"],[513,"ThumbnailOffset"],[514,"ThumbnailLength"],[529,"YCbCrCoefficients"],[530,"YCbCrSubSampling"],[531,"YCbCrPositioning"],[532,"ReferenceBlackWhite"],[700,"ApplicationNotes"],[33432,"Copyright"],[33723,"IPTC"],[34665,"ExifIFD"],[34675,"ICC"],[34853,"GpsIFD"],[330,"SubIFD"],[40965,"InteropIFD"],[40091,"XPTitle"],[40092,"XPComment"],[40093,"XPAuthor"],[40094,"XPKeywords"],[40095,"XPSubject"]]),Dn(ha,"exif",[[33434,"ExposureTime"],[33437,"FNumber"],[34850,"ExposureProgram"],[34852,"SpectralSensitivity"],[34855,"ISO"],[34858,"TimeZoneOffset"],[34859,"SelfTimerMode"],[34864,"SensitivityType"],[34865,"StandardOutputSensitivity"],[34866,"RecommendedExposureIndex"],[34867,"ISOSpeed"],[34868,"ISOSpeedLatitudeyyy"],[34869,"ISOSpeedLatitudezzz"],[36864,"ExifVersion"],[36867,"DateTimeOriginal"],[36868,"CreateDate"],[36873,"GooglePlusUploadCode"],[36880,"OffsetTime"],[36881,"OffsetTimeOriginal"],[36882,"OffsetTimeDigitized"],[37121,"ComponentsConfiguration"],[37122,"CompressedBitsPerPixel"],[37377,"ShutterSpeedValue"],[37378,"ApertureValue"],[37379,"BrightnessValue"],[37380,"ExposureCompensation"],[37381,"MaxApertureValue"],[37382,"SubjectDistance"],[37383,"MeteringMode"],[37384,"LightSource"],[37385,"Flash"],[37386,"FocalLength"],[37393,"ImageNumber"],[37394,"SecurityClassification"],[37395,"ImageHistory"],[37396,"SubjectArea"],[37500,"MakerNote"],[37510,"UserComment"],[37520,"SubSecTime"],[37521,"SubSecTimeOriginal"],[37522,"SubSecTimeDigitized"],[37888,"AmbientTemperature"],[37889,"Humidity"],[37890,"Pressure"],[37891,"WaterDepth"],[37892,"Acceleration"],[37893,"CameraElevationAngle"],[40960,"FlashpixVersion"],[40961,"ColorSpace"],[40962,"ExifImageWidth"],[40963,"ExifImageHeight"],[40964,"RelatedSoundFile"],[41483,"FlashEnergy"],[41486,"FocalPlaneXResolution"],[41487,"FocalPlaneYResolution"],[41488,"FocalPlaneResolutionUnit"],[41492,"SubjectLocation"],[41493,"ExposureIndex"],[41495,"SensingMethod"],[41728,"FileSource"],[41729,"SceneType"],[41730,"CFAPattern"],[41985,"CustomRendered"],[41986,"ExposureMode"],[41987,"WhiteBalance"],[41988,"DigitalZoomRatio"],[41989,"FocalLengthIn35mmFormat"],[41990,"SceneCaptureType"],[41991,"GainControl"],[41992,"Contrast"],[41993,"Saturation"],[41994,"Sharpness"],[41996,"SubjectDistanceRange"],[42016,"ImageUniqueID"],[42032,"OwnerName"],[42033,"SerialNumber"],[42034,"LensInfo"],[42035,"LensMake"],[42036,"LensModel"],[42037,"LensSerialNumber"],[42080,"CompositeImage"],[42081,"CompositeImageCount"],[42082,"CompositeImageExposureTimes"],[42240,"Gamma"],[59932,"Padding"],[59933,"OffsetSchema"],[65e3,"OwnerName"],[65001,"SerialNumber"],[65002,"Lens"],[65100,"RawFile"],[65101,"Converter"],[65102,"WhiteBalance"],[65105,"Exposure"],[65106,"Shadows"],[65107,"Brightness"],[65108,"Contrast"],[65109,"Saturation"],[65110,"Sharpness"],[65111,"Smoothness"],[65112,"MoireFilter"],[40965,"InteropIFD"]]),Dn(ha,"gps",[[0,"GPSVersionID"],[1,"GPSLatitudeRef"],[2,"GPSLatitude"],[3,"GPSLongitudeRef"],[4,"GPSLongitude"],[5,"GPSAltitudeRef"],[6,"GPSAltitude"],[7,"GPSTimeStamp"],[8,"GPSSatellites"],[9,"GPSStatus"],[10,"GPSMeasureMode"],[11,"GPSDOP"],[12,"GPSSpeedRef"],[13,"GPSSpeed"],[14,"GPSTrackRef"],[15,"GPSTrack"],[16,"GPSImgDirectionRef"],[17,"GPSImgDirection"],[18,"GPSMapDatum"],[19,"GPSDestLatitudeRef"],[20,"GPSDestLatitude"],[21,"GPSDestLongitudeRef"],[22,"GPSDestLongitude"],[23,"GPSDestBearingRef"],[24,"GPSDestBearing"],[25,"GPSDestDistanceRef"],[26,"GPSDestDistance"],[27,"GPSProcessingMethod"],[28,"GPSAreaInformation"],[29,"GPSDateStamp"],[30,"GPSDifferential"],[31,"GPSHPositioningError"]]),Dn(ho,["ifd0","ifd1"],[[274,{1:"Horizontal (normal)",2:"Mirror horizontal",3:"Rotate 180",4:"Mirror vertical",5:"Mirror horizontal and rotate 270 CW",6:"Rotate 90 CW",7:"Mirror horizontal and rotate 90 CW",8:"Rotate 270 CW"}],[296,{1:"None",2:"inches",3:"cm"}]]);let ef=Dn(ho,"exif",[[34850,{0:"Not defined",1:"Manual",2:"Normal program",3:"Aperture priority",4:"Shutter priority",5:"Creative program",6:"Action program",7:"Portrait mode",8:"Landscape mode"}],[37121,{0:"-",1:"Y",2:"Cb",3:"Cr",4:"R",5:"G",6:"B"}],[37383,{0:"Unknown",1:"Average",2:"CenterWeightedAverage",3:"Spot",4:"MultiSpot",5:"Pattern",6:"Partial",255:"Other"}],[37384,{0:"Unknown",1:"Daylight",2:"Fluorescent",3:"Tungsten (incandescent light)",4:"Flash",9:"Fine weather",10:"Cloudy weather",11:"Shade",12:"Daylight fluorescent (D 5700 - 7100K)",13:"Day white fluorescent (N 4600 - 5400K)",14:"Cool white fluorescent (W 3900 - 4500K)",15:"White fluorescent (WW 3200 - 3700K)",17:"Standard light A",18:"Standard light B",19:"Standard light C",20:"D55",21:"D65",22:"D75",23:"D50",24:"ISO studio tungsten",255:"Other"}],[37385,{0:"Flash did not fire",1:"Flash fired",5:"Strobe return light not detected",7:"Strobe return light detected",9:"Flash fired, compulsory flash mode",13:"Flash fired, compulsory flash mode, return light not detected",15:"Flash fired, compulsory flash mode, return light detected",16:"Flash did not fire, compulsory flash mode",24:"Flash did not fire, auto mode",25:"Flash fired, auto mode",29:"Flash fired, auto mode, return light not detected",31:"Flash fired, auto mode, return light detected",32:"No flash function",65:"Flash fired, red-eye reduction mode",69:"Flash fired, red-eye reduction mode, return light not detected",71:"Flash fired, red-eye reduction mode, return light detected",73:"Flash fired, compulsory flash mode, red-eye reduction mode",77:"Flash fired, compulsory flash mode, red-eye reduction mode, return light not detected",79:"Flash fired, compulsory flash mode, red-eye reduction mode, return light detected",89:"Flash fired, auto mode, red-eye reduction mode",93:"Flash fired, auto mode, return light not detected, red-eye reduction mode",95:"Flash fired, auto mode, return light detected, red-eye reduction mode"}],[41495,{1:"Not defined",2:"One-chip color area sensor",3:"Two-chip color area sensor",4:"Three-chip color area sensor",5:"Color sequential area sensor",7:"Trilinear sensor",8:"Color sequential linear sensor"}],[41728,{1:"Film Scanner",2:"Reflection Print Scanner",3:"Digital Camera"}],[41729,{1:"Directly photographed"}],[41985,{0:"Normal",1:"Custom",2:"HDR (no original saved)",3:"HDR (original saved)",4:"Original (for HDR)",6:"Panorama",7:"Portrait HDR",8:"Portrait"}],[41986,{0:"Auto",1:"Manual",2:"Auto bracket"}],[41987,{0:"Auto",1:"Manual"}],[41990,{0:"Standard",1:"Landscape",2:"Portrait",3:"Night",4:"Other"}],[41991,{0:"None",1:"Low gain up",2:"High gain up",3:"Low gain down",4:"High gain down"}],[41996,{0:"Unknown",1:"Macro",2:"Close",3:"Distant"}],[42080,{0:"Unknown",1:"Not a Composite Image",2:"General Composite Image",3:"Composite Image Captured While Shooting"}]]);const Lk={1:"No absolute unit of measurement",2:"Inch",3:"Centimeter"};ef.set(37392,Lk),ef.set(41488,Lk);const jy={0:"Normal",1:"Low",2:"High"};function Fk(e){return typeof e=="object"&&e.length!==void 0?e[0]:e}function Gk(e){let t=Array.from(e).slice(1);return t[1]>15&&(t=t.map(r=>String.fromCharCode(r))),t[2]!=="0"&&t[2]!==0||t.pop(),t.join(".")}function Py(e){if(typeof e=="string"){var[t,r,n,a,i,o]=e.trim().split(/[-: ]/g).map(Number),s=new Date(t,r-1,n);return Number.isNaN(a)||Number.isNaN(i)||Number.isNaN(o)||(s.setHours(a),s.setMinutes(i),s.setSeconds(o)),Number.isNaN(+s)?e:s}}function Cd(e){if(typeof e=="string")return e;let t=[];if(e[1]===0&&e[e.length-1]===0)for(let r=0;r<e.length;r+=2)t.push(Uk(e[r+1],e[r]));else for(let r=0;r<e.length;r+=2)t.push(Uk(e[r],e[r+1]));return $l(String.fromCodePoint(...t))}function Uk(e,t){return e<<8|t}ef.set(41992,jy),ef.set(41993,jy),ef.set(41994,jy),Dn(tl,["ifd0","ifd1"],[[50827,function(e){return typeof e!="string"?A_(e):e}],[306,Py],[40091,Cd],[40092,Cd],[40093,Cd],[40094,Cd],[40095,Cd]]),Dn(tl,"exif",[[40960,Gk],[36864,Gk],[36867,Py],[36868,Py],[40962,Fk],[40963,Fk]]),Dn(tl,"gps",[[0,e=>Array.from(e).join(".")],[7,e=>Array.from(e).join(":")]]);class _y extends io{static canHandle(t,r){return t.getUint8(r+1)===225&&t.getUint32(r+4)===1752462448&&t.getString(r+4,20)==="http://ns.adobe.com/"}static headerLength(t,r){return t.getString(r+4,34)==="http://ns.adobe.com/xmp/extension/"?79:33}static findPosition(t,r){let n=super.findPosition(t,r);return n.multiSegment=n.extended=n.headerLength===79,n.multiSegment?(n.chunkCount=t.getUint8(r+72),n.chunkNumber=t.getUint8(r+76),t.getUint8(r+77)!==0&&n.chunkNumber++):(n.chunkCount=1/0,n.chunkNumber=-1),n}static handleMultiSegments(t){return t.map(r=>r.chunk.getString()).join("")}normalizeInput(t){return typeof t=="string"?t:ri.from(t).getString()}parse(t=this.chunk){if(!this.localOptions.parse)return t;t=function(i){let o={},s={};for(let l of U_)o[l]=[],s[l]=0;return i.replace(x8,(l,u,d)=>{if(u==="<"){let f=++s[d];return o[d].push(f),`${l}#${f}`}return`${l}#${o[d].pop()}`})}(t);let r=ru.findAll(t,"rdf","Description");r.length===0&&r.push(new ru("rdf","Description",void 0,t));let n,a={};for(let i of r)for(let o of i.properties)n=y8(o.ns,a),L_(o,n);return function(i){let o;for(let s in i)o=i[s]=gp(i[s]),o===void 0&&delete i[s];return gp(i)}(a)}assignToOutput(t,r){if(this.localOptions.parse)for(let[n,a]of Object.entries(r))switch(n){case"tiff":this.assignObjectToOutput(t,"ifd0",a);break;case"exif":this.assignObjectToOutput(t,"exif",a);break;case"xmlns":break;default:this.assignObjectToOutput(t,n,a)}else t.xmp=r}}zt(_y,"type","xmp"),zt(_y,"multiSegment",!0),zn.set("xmp",_y);class yp{static findAll(t){return F_(t,/([a-zA-Z0-9-]+):([a-zA-Z0-9-]+)=("[^"]*"|'[^']*')/gm).map(yp.unpackMatch)}static unpackMatch(t){let r=t[1],n=t[2],a=t[3].slice(1,-1);return a=G_(a),new yp(r,n,a)}constructor(t,r,n){this.ns=t,this.name=r,this.value=n}serialize(){return this.value}}class ru{static findAll(t,r,n){if(r!==void 0||n!==void 0){r=r||"[\\w\\d-]+",n=n||"[\\w\\d-]+";var a=new RegExp(`<(${r}):(${n})(#\\d+)?((\\s+?[\\w\\d-:]+=("[^"]*"|'[^']*'))*\\s*)(\\/>|>([\\s\\S]*?)<\\/\\1:\\2\\3>)`,"gm")}else a=/<([\w\d-]+):([\w\d-]+)(#\d+)?((\s+?[\w\d-:]+=("[^"]*"|'[^']*'))*\s*)(\/>|>([\s\S]*?)<\/\1:\2\3>)/gm;return F_(t,a).map(ru.unpackMatch)}static unpackMatch(t){let r=t[1],n=t[2],a=t[4],i=t[8];return new ru(r,n,a,i)}constructor(t,r,n,a){this.ns=t,this.name=r,this.attrString=n,this.innerXml=a,this.attrs=yp.findAll(n),this.children=ru.findAll(a),this.value=this.children.length===0?G_(a):void 0,this.properties=[...this.attrs,...this.children]}get isPrimitive(){return this.value!==void 0&&this.attrs.length===0&&this.children.length===0}get isListContainer(){return this.children.length===1&&this.children[0].isList}get isList(){let{ns:t,name:r}=this;return t==="rdf"&&(r==="Seq"||r==="Bag"||r==="Alt")}get isListItem(){return this.ns==="rdf"&&this.name==="li"}serialize(){if(this.properties.length===0&&this.value===void 0)return;if(this.isPrimitive)return this.value;if(this.isListContainer)return this.children[0].serialize();if(this.isList)return m8(this.children.map(g8));if(this.isListItem&&this.children.length===1&&this.attrs.length===0)return this.children[0].serialize();let t={};for(let r of this.properties)L_(r,t);return this.value!==void 0&&(t.value=this.value),gp(t)}}function L_(e,t){let r=e.serialize();r!==void 0&&(t[e.name]=r)}var g8=e=>e.serialize(),m8=e=>e.length===1?e[0]:e,y8=(e,t)=>t[e]?t[e]:t[e]={};function F_(e,t){let r,n=[];if(!e)return n;for(;(r=t.exec(e))!==null;)n.push(r);return n}function G_(e){if(function(n){return n==null||n==="null"||n==="undefined"||n===""||n.trim()===""}(e))return;let t=Number(e);if(!Number.isNaN(t))return t;let r=e.toLowerCase();return r==="true"||r!=="false"&&e.trim()}const U_=["rdf:li","rdf:Seq","rdf:Bag","rdf:Alt","rdf:Description"],x8=new RegExp(`(<|\\/)(${U_.join("|")})`,"g");var z_=Object.freeze({__proto__:null,default:h8,Exifr:ll,fileParsers:Do,segmentParsers:zn,fileReaders:Lo,tagKeys:ha,tagValues:ho,tagRevivers:tl,createDictionary:Dn,extendDictionary:oc,fetchUrlAsArrayBuffer:ac,readBlobAsArrayBuffer:ic,chunkedProps:Bs,otherSegments:Hu,segments:sc,tiffBlocks:On,segmentsAndBlocks:Ls,tiffExtractables:Fs,inheritables:Vu,allFormatters:Gs,Options:mc,parse:zg,gpsOnlyOptions:Vb,gps:E_,thumbnailOnlyOptions:Xb,thumbnail:I_,thumbnailUrl:$_,orientationOnlyOptions:Kb,orientation:Yb,rotations:qb,get rotateCanvas(){return Dl},get rotateCss(){return Rl},rotation:D_});let zk=pp("fs",e=>e.promises);Lo.set("fs",class extends Hg{async readWhole(){this.chunked=!1,this.fs=await zk;let e=await this.fs.readFile(this.input);this._swapBuffer(e)}async readChunked(){this.chunked=!0,this.fs=await zk,await this.open(),await this.readChunk(0,this.options.firstChunkSize)}async open(){this.fh===void 0&&(this.fh=await this.fs.open(this.input,"r"),this.size=(await this.fh.stat(this.input)).size)}async _readChunk(e,t){this.fh===void 0&&await this.open(),e+t>this.size&&(t=this.size-e);var r=this.subarray(e,t,!0);return await this.fh.read(r.dataView,0,t,e),r}async close(){if(this.fh){let e=this.fh;this.fh=void 0,await e.close()}}});Lo.set("base64",class extends Hg{constructor(...e){super(...e),this.input=this.input.replace(/^data:([^;]+);base64,/gim,""),this.size=this.input.length/4*3,this.input.endsWith("==")?this.size-=2:this.input.endsWith("=")&&(this.size-=1)}async _readChunk(e,t){let r,n,a=this.input;e===void 0?(e=0,r=0,n=0):(r=4*Math.floor(e/3),n=e-r/4*3),t===void 0&&(t=this.size);let i=e+t,o=r+4*Math.ceil(i/3);a=a.slice(r,o);let s=Math.min(t,this.size-e);if(Ug){let l=Gg.from(a,"base64").slice(n,n+s);return this.set(l,e,!0)}{let l=this.subarray(e,s,!0),u=atob(a),d=l.toUint8();for(let f=0;f<s;f++)d[f]=u.charCodeAt(n+f);return l}}});class Wk extends Wg{static canHandle(t,r){return r===18761||r===19789}extendOptions(t){let{ifd0:r,xmp:n,iptc:a,icc:i}=t;n.enabled&&r.deps.add(700),a.enabled&&r.deps.add(33723),i.enabled&&r.deps.add(34675),r.finalizeFilters()}async parse(){let{tiff:t,xmp:r,iptc:n,icc:a}=this.options;if(t.enabled||r.enabled||n.enabled||a.enabled){let i=Math.max(sv(this.options),this.options.chunkSize);await this.file.ensureChunk(0,i),this.createParser("tiff",this.file),this.parsers.tiff.parseHeader(),await this.parsers.tiff.parseIfd0Block(),this.adaptTiffPropAsSegment("xmp"),this.adaptTiffPropAsSegment("iptc"),this.adaptTiffPropAsSegment("icc")}}adaptTiffPropAsSegment(t){if(this.parsers.tiff[t]){let r=this.parsers.tiff[t];this.injectSegment(t,r)}}}zt(Wk,"type","tiff"),Do.set("tiff",Wk);let v8=pp("zlib");const b8=["ihdr","iccp","text","itxt","exif"];class Hk extends Wg{constructor(...t){super(...t),zt(this,"catchError",r=>this.errors.push(r)),zt(this,"metaChunks",[]),zt(this,"unknownChunks",[])}static canHandle(t,r){return r===35152&&t.getUint32(0)===2303741511&&t.getUint32(4)===218765834}async parse(){let{file:t}=this;await this.findPngChunksInRange(8,t.byteLength),await this.readSegments(this.metaChunks),this.findIhdr(),this.parseTextChunks(),await this.findExif().catch(this.catchError),await this.findXmp().catch(this.catchError),await this.findIcc().catch(this.catchError)}async findPngChunksInRange(t,r){let{file:n}=this;for(;t<r;){let a=n.getUint32(t),i=n.getUint32(t+4),o=n.getString(t+4,4).toLowerCase(),s=a+4+4+4,l={type:o,offset:t,length:s,start:t+4+4,size:a,marker:i};b8.includes(o)?this.metaChunks.push(l):this.unknownChunks.push(l),t+=s}}parseTextChunks(){let t=this.metaChunks.filter(r=>r.type==="text");for(let r of t){let[n,a]=this.file.getString(r.start,r.size).split("\0");this.injectKeyValToIhdr(n,a)}}injectKeyValToIhdr(t,r){let n=this.parsers.ihdr;n&&n.raw.set(t,r)}findIhdr(){let t=this.metaChunks.find(r=>r.type==="ihdr");t&&this.options.ihdr.enabled!==!1&&this.createParser("ihdr",t.chunk)}async findExif(){let t=this.metaChunks.find(r=>r.type==="exif");t&&this.injectSegment("tiff",t.chunk)}async findXmp(){let t=this.metaChunks.filter(r=>r.type==="itxt");for(let r of t)r.chunk.getString(0,17)==="XML:com.adobe.xmp"&&this.injectSegment("xmp",r.chunk)}async findIcc(){let t=this.metaChunks.find(s=>s.type==="iccp");if(!t)return;let{chunk:r}=t,n=r.getUint8Array(0,81),a=0;for(;a<80&&n[a]!==0;)a++;let i=a+2,o=r.getString(0,a);if(this.injectKeyValToIhdr("ProfileName",o),hp){let s=await v8,l=r.getUint8Array(i);l=s.inflateSync(l),this.injectSegment("icc",l)}}}zt(Hk,"type","png"),Do.set("png",Hk),Dn(ha,"interop",[[1,"InteropIndex"],[2,"InteropVersion"],[4096,"RelatedImageFileFormat"],[4097,"RelatedImageWidth"],[4098,"RelatedImageHeight"]]),oc(ha,"ifd0",[[11,"ProcessingSoftware"],[254,"SubfileType"],[255,"OldSubfileType"],[263,"Thresholding"],[264,"CellWidth"],[265,"CellLength"],[266,"FillOrder"],[269,"DocumentName"],[280,"MinSampleValue"],[281,"MaxSampleValue"],[285,"PageName"],[286,"XPosition"],[287,"YPosition"],[290,"GrayResponseUnit"],[297,"PageNumber"],[321,"HalftoneHints"],[322,"TileWidth"],[323,"TileLength"],[332,"InkSet"],[337,"TargetPrinter"],[18246,"Rating"],[18249,"RatingPercent"],[33550,"PixelScale"],[34264,"ModelTransform"],[34377,"PhotoshopSettings"],[50706,"DNGVersion"],[50707,"DNGBackwardVersion"],[50708,"UniqueCameraModel"],[50709,"LocalizedCameraModel"],[50736,"DNGLensInfo"],[50739,"ShadowScale"],[50740,"DNGPrivateData"],[33920,"IntergraphMatrix"],[33922,"ModelTiePoint"],[34118,"SEMInfo"],[34735,"GeoTiffDirectory"],[34736,"GeoTiffDoubleParams"],[34737,"GeoTiffAsciiParams"],[50341,"PrintIM"],[50721,"ColorMatrix1"],[50722,"ColorMatrix2"],[50723,"CameraCalibration1"],[50724,"CameraCalibration2"],[50725,"ReductionMatrix1"],[50726,"ReductionMatrix2"],[50727,"AnalogBalance"],[50728,"AsShotNeutral"],[50729,"AsShotWhiteXY"],[50730,"BaselineExposure"],[50731,"BaselineNoise"],[50732,"BaselineSharpness"],[50734,"LinearResponseLimit"],[50735,"CameraSerialNumber"],[50741,"MakerNoteSafety"],[50778,"CalibrationIlluminant1"],[50779,"CalibrationIlluminant2"],[50781,"RawDataUniqueID"],[50827,"OriginalRawFileName"],[50828,"OriginalRawFileData"],[50831,"AsShotICCProfile"],[50832,"AsShotPreProfileMatrix"],[50833,"CurrentICCProfile"],[50834,"CurrentPreProfileMatrix"],[50879,"ColorimetricReference"],[50885,"SRawType"],[50898,"PanasonicTitle"],[50899,"PanasonicTitle2"],[50931,"CameraCalibrationSig"],[50932,"ProfileCalibrationSig"],[50933,"ProfileIFD"],[50934,"AsShotProfileName"],[50936,"ProfileName"],[50937,"ProfileHueSatMapDims"],[50938,"ProfileHueSatMapData1"],[50939,"ProfileHueSatMapData2"],[50940,"ProfileToneCurve"],[50941,"ProfileEmbedPolicy"],[50942,"ProfileCopyright"],[50964,"ForwardMatrix1"],[50965,"ForwardMatrix2"],[50966,"PreviewApplicationName"],[50967,"PreviewApplicationVersion"],[50968,"PreviewSettingsName"],[50969,"PreviewSettingsDigest"],[50970,"PreviewColorSpace"],[50971,"PreviewDateTime"],[50972,"RawImageDigest"],[50973,"OriginalRawFileDigest"],[50981,"ProfileLookTableDims"],[50982,"ProfileLookTableData"],[51043,"TimeCodes"],[51044,"FrameRate"],[51058,"TStop"],[51081,"ReelName"],[51089,"OriginalDefaultFinalSize"],[51090,"OriginalBestQualitySize"],[51091,"OriginalDefaultCropSize"],[51105,"CameraLabel"],[51107,"ProfileHueSatMapEncoding"],[51108,"ProfileLookTableEncoding"],[51109,"BaselineExposureOffset"],[51110,"DefaultBlackRender"],[51111,"NewRawImageDigest"],[51112,"RawToPreviewGain"]]);let Vk=[[273,"StripOffsets"],[279,"StripByteCounts"],[288,"FreeOffsets"],[289,"FreeByteCounts"],[291,"GrayResponseCurve"],[292,"T4Options"],[293,"T6Options"],[300,"ColorResponseUnit"],[320,"ColorMap"],[324,"TileOffsets"],[325,"TileByteCounts"],[326,"BadFaxLines"],[327,"CleanFaxData"],[328,"ConsecutiveBadFaxLines"],[330,"SubIFD"],[333,"InkNames"],[334,"NumberofInks"],[336,"DotRange"],[338,"ExtraSamples"],[339,"SampleFormat"],[340,"SMinSampleValue"],[341,"SMaxSampleValue"],[342,"TransferRange"],[343,"ClipPath"],[344,"XClipPathUnits"],[345,"YClipPathUnits"],[346,"Indexed"],[347,"JPEGTables"],[351,"OPIProxy"],[400,"GlobalParametersIFD"],[401,"ProfileType"],[402,"FaxProfile"],[403,"CodingMethods"],[404,"VersionYear"],[405,"ModeNumber"],[433,"Decode"],[434,"DefaultImageColor"],[435,"T82Options"],[437,"JPEGTables"],[512,"JPEGProc"],[515,"JPEGRestartInterval"],[517,"JPEGLosslessPredictors"],[518,"JPEGPointTransforms"],[519,"JPEGQTables"],[520,"JPEGDCTables"],[521,"JPEGACTables"],[559,"StripRowCounts"],[999,"USPTOMiscellaneous"],[18247,"XP_DIP_XML"],[18248,"StitchInfo"],[28672,"SonyRawFileType"],[28688,"SonyToneCurve"],[28721,"VignettingCorrection"],[28722,"VignettingCorrParams"],[28724,"ChromaticAberrationCorrection"],[28725,"ChromaticAberrationCorrParams"],[28726,"DistortionCorrection"],[28727,"DistortionCorrParams"],[29895,"SonyCropTopLeft"],[29896,"SonyCropSize"],[32781,"ImageID"],[32931,"WangTag1"],[32932,"WangAnnotation"],[32933,"WangTag3"],[32934,"WangTag4"],[32953,"ImageReferencePoints"],[32954,"RegionXformTackPoint"],[32955,"WarpQuadrilateral"],[32956,"AffineTransformMat"],[32995,"Matteing"],[32996,"DataType"],[32997,"ImageDepth"],[32998,"TileDepth"],[33300,"ImageFullWidth"],[33301,"ImageFullHeight"],[33302,"TextureFormat"],[33303,"WrapModes"],[33304,"FovCot"],[33305,"MatrixWorldToScreen"],[33306,"MatrixWorldToCamera"],[33405,"Model2"],[33421,"CFARepeatPatternDim"],[33422,"CFAPattern2"],[33423,"BatteryLevel"],[33424,"KodakIFD"],[33445,"MDFileTag"],[33446,"MDScalePixel"],[33447,"MDColorTable"],[33448,"MDLabName"],[33449,"MDSampleInfo"],[33450,"MDPrepDate"],[33451,"MDPrepTime"],[33452,"MDFileUnits"],[33589,"AdventScale"],[33590,"AdventRevision"],[33628,"UIC1Tag"],[33629,"UIC2Tag"],[33630,"UIC3Tag"],[33631,"UIC4Tag"],[33918,"IntergraphPacketData"],[33919,"IntergraphFlagRegisters"],[33921,"INGRReserved"],[34016,"Site"],[34017,"ColorSequence"],[34018,"IT8Header"],[34019,"RasterPadding"],[34020,"BitsPerRunLength"],[34021,"BitsPerExtendedRunLength"],[34022,"ColorTable"],[34023,"ImageColorIndicator"],[34024,"BackgroundColorIndicator"],[34025,"ImageColorValue"],[34026,"BackgroundColorValue"],[34027,"PixelIntensityRange"],[34028,"TransparencyIndicator"],[34029,"ColorCharacterization"],[34030,"HCUsage"],[34031,"TrapIndicator"],[34032,"CMYKEquivalent"],[34152,"AFCP_IPTC"],[34232,"PixelMagicJBIGOptions"],[34263,"JPLCartoIFD"],[34306,"WB_GRGBLevels"],[34310,"LeafData"],[34687,"TIFF_FXExtensions"],[34688,"MultiProfiles"],[34689,"SharedData"],[34690,"T88Options"],[34732,"ImageLayer"],[34750,"JBIGOptions"],[34856,"Opto-ElectricConvFactor"],[34857,"Interlace"],[34908,"FaxRecvParams"],[34909,"FaxSubAddress"],[34910,"FaxRecvTime"],[34929,"FedexEDR"],[34954,"LeafSubIFD"],[37387,"FlashEnergy"],[37388,"SpatialFrequencyResponse"],[37389,"Noise"],[37390,"FocalPlaneXResolution"],[37391,"FocalPlaneYResolution"],[37392,"FocalPlaneResolutionUnit"],[37397,"ExposureIndex"],[37398,"TIFF-EPStandardID"],[37399,"SensingMethod"],[37434,"CIP3DataFile"],[37435,"CIP3Sheet"],[37436,"CIP3Side"],[37439,"StoNits"],[37679,"MSDocumentText"],[37680,"MSPropertySetStorage"],[37681,"MSDocumentTextPosition"],[37724,"ImageSourceData"],[40965,"InteropIFD"],[40976,"SamsungRawPointersOffset"],[40977,"SamsungRawPointersLength"],[41217,"SamsungRawByteOrder"],[41218,"SamsungRawUnknown"],[41484,"SpatialFrequencyResponse"],[41485,"Noise"],[41489,"ImageNumber"],[41490,"SecurityClassification"],[41491,"ImageHistory"],[41494,"TIFF-EPStandardID"],[41995,"DeviceSettingDescription"],[42112,"GDALMetadata"],[42113,"GDALNoData"],[44992,"ExpandSoftware"],[44993,"ExpandLens"],[44994,"ExpandFilm"],[44995,"ExpandFilterLens"],[44996,"ExpandScanner"],[44997,"ExpandFlashLamp"],[46275,"HasselbladRawImage"],[48129,"PixelFormat"],[48130,"Transformation"],[48131,"Uncompressed"],[48132,"ImageType"],[48256,"ImageWidth"],[48257,"ImageHeight"],[48258,"WidthResolution"],[48259,"HeightResolution"],[48320,"ImageOffset"],[48321,"ImageByteCount"],[48322,"AlphaOffset"],[48323,"AlphaByteCount"],[48324,"ImageDataDiscard"],[48325,"AlphaDataDiscard"],[50215,"OceScanjobDesc"],[50216,"OceApplicationSelector"],[50217,"OceIDNumber"],[50218,"OceImageLogic"],[50255,"Annotations"],[50459,"HasselbladExif"],[50547,"OriginalFileName"],[50560,"USPTOOriginalContentType"],[50656,"CR2CFAPattern"],[50710,"CFAPlaneColor"],[50711,"CFALayout"],[50712,"LinearizationTable"],[50713,"BlackLevelRepeatDim"],[50714,"BlackLevel"],[50715,"BlackLevelDeltaH"],[50716,"BlackLevelDeltaV"],[50717,"WhiteLevel"],[50718,"DefaultScale"],[50719,"DefaultCropOrigin"],[50720,"DefaultCropSize"],[50733,"BayerGreenSplit"],[50737,"ChromaBlurRadius"],[50738,"AntiAliasStrength"],[50752,"RawImageSegmentation"],[50780,"BestQualityScale"],[50784,"AliasLayerMetadata"],[50829,"ActiveArea"],[50830,"MaskedAreas"],[50935,"NoiseReductionApplied"],[50974,"SubTileBlockSize"],[50975,"RowInterleaveFactor"],[51008,"OpcodeList1"],[51009,"OpcodeList2"],[51022,"OpcodeList3"],[51041,"NoiseProfile"],[51114,"CacheVersion"],[51125,"DefaultUserCrop"],[51157,"NikonNEFInfo"],[65024,"KdcIFD"]];oc(ha,"ifd0",Vk),oc(ha,"exif",Vk),Dn(ho,"gps",[[23,{M:"Magnetic North",T:"True North"}],[25,{K:"Kilometers",M:"Miles",N:"Nautical Miles"}]]);class Cy extends io{static canHandle(t,r){return t.getUint8(r+1)===224&&t.getUint32(r+4)===1246120262&&t.getUint8(r+8)===0}parse(){return this.parseTags(),this.translate(),this.output}parseTags(){this.raw=new Map([[0,this.chunk.getUint16(0)],[2,this.chunk.getUint8(2)],[3,this.chunk.getUint16(3)],[5,this.chunk.getUint16(5)],[7,this.chunk.getUint8(7)],[8,this.chunk.getUint8(8)]])}}zt(Cy,"type","jfif"),zt(Cy,"headerLength",9),zn.set("jfif",Cy),Dn(ha,"jfif",[[0,"JFIFVersion"],[2,"ResolutionUnit"],[3,"XResolution"],[5,"YResolution"],[7,"ThumbnailWidth"],[8,"ThumbnailHeight"]]);class Xk extends io{parse(){return this.parseTags(),this.translate(),this.output}parseTags(){this.raw=new Map([[0,this.chunk.getUint32(0)],[4,this.chunk.getUint32(4)],[8,this.chunk.getUint8(8)],[9,this.chunk.getUint8(9)],[10,this.chunk.getUint8(10)],[11,this.chunk.getUint8(11)],[12,this.chunk.getUint8(12)],...Array.from(this.raw)])}}zt(Xk,"type","ihdr"),zn.set("ihdr",Xk),Dn(ha,"ihdr",[[0,"ImageWidth"],[4,"ImageHeight"],[8,"BitDepth"],[9,"ColorType"],[10,"Compression"],[11,"Filter"],[12,"Interlace"]]),Dn(ho,"ihdr",[[9,{0:"Grayscale",2:"RGB",3:"Palette",4:"Grayscale with Alpha",6:"RGB with Alpha",DEFAULT:"Unknown"}],[10,{0:"Deflate/Inflate",DEFAULT:"Unknown"}],[11,{0:"Adaptive",DEFAULT:"Unknown"}],[12,{0:"Noninterlaced",1:"Adam7 Interlace",DEFAULT:"Unknown"}]]);class Gh extends io{static canHandle(t,r){return t.getUint8(r+1)===226&&t.getUint32(r+4)===1229144927}static findPosition(t,r){let n=super.findPosition(t,r);return n.chunkNumber=t.getUint8(r+16),n.chunkCount=t.getUint8(r+17),n.multiSegment=n.chunkCount>1,n}static handleMultiSegments(t){return function(r){let n=function(a){let i=a[0].constructor,o=0;for(let u of a)o+=u.length;let s=new i(o),l=0;for(let u of a)s.set(u,l),l+=u.length;return s}(r.map(a=>a.chunk.toUint8()));return new ri(n)}(t)}parse(){return this.raw=new Map,this.parseHeader(),this.parseTags(),this.translate(),this.output}parseHeader(){let{raw:t}=this;this.chunk.byteLength<84&&Vn("ICC header is too short");for(let[r,n]of Object.entries(w8)){r=parseInt(r,10);let a=n(this.chunk,r);a!=="\0\0\0\0"&&t.set(r,a)}}parseTags(){let t,r,n,a,i,{raw:o}=this,s=this.chunk.getUint32(128),l=132,u=this.chunk.byteLength;for(;s--;){if(t=this.chunk.getString(l,4),r=this.chunk.getUint32(l+4),n=this.chunk.getUint32(l+8),a=this.chunk.getString(r,4),r+n>u)return void console.warn("reached the end of the first ICC chunk. Enable options.tiff.multiSegment to read all ICC segments.");i=this.parseTag(a,r,n),i!==void 0&&i!=="\0\0\0\0"&&o.set(t,i),l+=12}}parseTag(t,r,n){switch(t){case"desc":return this.parseDesc(r);case"mluc":return this.parseMluc(r);case"text":return this.parseText(r,n);case"sig ":return this.parseSig(r)}if(!(r+n>this.chunk.byteLength))return this.chunk.getUint8Array(r,n)}parseDesc(t){let r=this.chunk.getUint32(t+8)-1;return $l(this.chunk.getString(t+12,r))}parseText(t,r){return $l(this.chunk.getString(t+8,r-8))}parseSig(t){return $l(this.chunk.getString(t+8,4))}parseMluc(t){let{chunk:r}=this,n=r.getUint32(t+8),a=r.getUint32(t+12),i=t+16,o=[];for(let s=0;s<n;s++){let l=r.getString(i+0,2),u=r.getString(i+2,2),d=r.getUint32(i+4),f=r.getUint32(i+8)+t,h=$l(r.getUnicodeString(f,d));o.push({lang:l,country:u,text:h}),i+=a}return n===1?o[0].text:o}translateValue(t,r){return typeof t=="string"?r[t]||r[t.toLowerCase()]||t:r[t]||t}}zt(Gh,"type","icc"),zt(Gh,"multiSegment",!0),zt(Gh,"headerLength",18);const w8={4:Ko,8:function(e,t){return[e.getUint8(t),e.getUint8(t+1)>>4,e.getUint8(t+1)%16].map(r=>r.toString(10)).join(".")},12:Ko,16:Ko,20:Ko,24:function(e,t){const r=e.getUint16(t),n=e.getUint16(t+2)-1,a=e.getUint16(t+4),i=e.getUint16(t+6),o=e.getUint16(t+8),s=e.getUint16(t+10);return new Date(Date.UTC(r,n,a,i,o,s))},36:Ko,40:Ko,48:Ko,52:Ko,64:(e,t)=>e.getUint32(t),80:Ko};function Ko(e,t){return $l(e.getString(t,4))}zn.set("icc",Gh),Dn(ha,"icc",[[4,"ProfileCMMType"],[8,"ProfileVersion"],[12,"ProfileClass"],[16,"ColorSpaceData"],[20,"ProfileConnectionSpace"],[24,"ProfileDateTime"],[36,"ProfileFileSignature"],[40,"PrimaryPlatform"],[44,"CMMFlags"],[48,"DeviceManufacturer"],[52,"DeviceModel"],[56,"DeviceAttributes"],[64,"RenderingIntent"],[68,"ConnectionSpaceIlluminant"],[80,"ProfileCreator"],[84,"ProfileID"],["Header","ProfileHeader"],["MS00","WCSProfiles"],["bTRC","BlueTRC"],["bXYZ","BlueMatrixColumn"],["bfd","UCRBG"],["bkpt","MediaBlackPoint"],["calt","CalibrationDateTime"],["chad","ChromaticAdaptation"],["chrm","Chromaticity"],["ciis","ColorimetricIntentImageState"],["clot","ColorantTableOut"],["clro","ColorantOrder"],["clrt","ColorantTable"],["cprt","ProfileCopyright"],["crdi","CRDInfo"],["desc","ProfileDescription"],["devs","DeviceSettings"],["dmdd","DeviceModelDesc"],["dmnd","DeviceMfgDesc"],["dscm","ProfileDescriptionML"],["fpce","FocalPlaneColorimetryEstimates"],["gTRC","GreenTRC"],["gXYZ","GreenMatrixColumn"],["gamt","Gamut"],["kTRC","GrayTRC"],["lumi","Luminance"],["meas","Measurement"],["meta","Metadata"],["mmod","MakeAndModel"],["ncl2","NamedColor2"],["ncol","NamedColor"],["ndin","NativeDisplayInfo"],["pre0","Preview0"],["pre1","Preview1"],["pre2","Preview2"],["ps2i","PS2RenderingIntent"],["ps2s","PostScript2CSA"],["psd0","PostScript2CRD0"],["psd1","PostScript2CRD1"],["psd2","PostScript2CRD2"],["psd3","PostScript2CRD3"],["pseq","ProfileSequenceDesc"],["psid","ProfileSequenceIdentifier"],["psvm","PS2CRDVMSize"],["rTRC","RedTRC"],["rXYZ","RedMatrixColumn"],["resp","OutputResponse"],["rhoc","ReflectionHardcopyOrigColorimetry"],["rig0","PerceptualRenderingIntentGamut"],["rig2","SaturationRenderingIntentGamut"],["rpoc","ReflectionPrintOutputColorimetry"],["sape","SceneAppearanceEstimates"],["scoe","SceneColorimetryEstimates"],["scrd","ScreeningDesc"],["scrn","Screening"],["targ","CharTarget"],["tech","Technology"],["vcgt","VideoCardGamma"],["view","ViewingConditions"],["vued","ViewingCondDesc"],["wtpt","MediaWhitePoint"]]);const oh={"4d2p":"Erdt Systems",AAMA:"Aamazing Technologies",ACER:"Acer",ACLT:"Acolyte Color Research",ACTI:"Actix Sytems",ADAR:"Adara Technology",ADBE:"Adobe",ADI:"ADI Systems",AGFA:"Agfa Graphics",ALMD:"Alps Electric",ALPS:"Alps Electric",ALWN:"Alwan Color Expertise",AMTI:"Amiable Technologies",AOC:"AOC International",APAG:"Apago",APPL:"Apple Computer",AST:"AST","AT&T":"AT&T",BAEL:"BARBIERI electronic",BRCO:"Barco NV",BRKP:"Breakpoint",BROT:"Brother",BULL:"Bull",BUS:"Bus Computer Systems","C-IT":"C-Itoh",CAMR:"Intel",CANO:"Canon",CARR:"Carroll Touch",CASI:"Casio",CBUS:"Colorbus PL",CEL:"Crossfield",CELx:"Crossfield",CGS:"CGS Publishing Technologies International",CHM:"Rochester Robotics",CIGL:"Colour Imaging Group, London",CITI:"Citizen",CL00:"Candela",CLIQ:"Color IQ",CMCO:"Chromaco",CMiX:"CHROMiX",COLO:"Colorgraphic Communications",COMP:"Compaq",COMp:"Compeq/Focus Technology",CONR:"Conrac Display Products",CORD:"Cordata Technologies",CPQ:"Compaq",CPRO:"ColorPro",CRN:"Cornerstone",CTX:"CTX International",CVIS:"ColorVision",CWC:"Fujitsu Laboratories",DARI:"Darius Technology",DATA:"Dataproducts",DCP:"Dry Creek Photo",DCRC:"Digital Contents Resource Center, Chung-Ang University",DELL:"Dell Computer",DIC:"Dainippon Ink and Chemicals",DICO:"Diconix",DIGI:"Digital","DL&C":"Digital Light & Color",DPLG:"Doppelganger",DS:"Dainippon Screen",DSOL:"DOOSOL",DUPN:"DuPont",EPSO:"Epson",ESKO:"Esko-Graphics",ETRI:"Electronics and Telecommunications Research Institute",EVER:"Everex Systems",EXAC:"ExactCODE",Eizo:"Eizo",FALC:"Falco Data Products",FF:"Fuji Photo Film",FFEI:"FujiFilm Electronic Imaging",FNRD:"Fnord Software",FORA:"Fora",FORE:"Forefront Technology",FP:"Fujitsu",FPA:"WayTech Development",FUJI:"Fujitsu",FX:"Fuji Xerox",GCC:"GCC Technologies",GGSL:"Global Graphics Software",GMB:"Gretagmacbeth",GMG:"GMG",GOLD:"GoldStar Technology",GOOG:"Google",GPRT:"Giantprint",GTMB:"Gretagmacbeth",GVC:"WayTech Development",GW2K:"Sony",HCI:"HCI",HDM:"Heidelberger Druckmaschinen",HERM:"Hermes",HITA:"Hitachi America",HP:"Hewlett-Packard",HTC:"Hitachi",HiTi:"HiTi Digital",IBM:"IBM",IDNT:"Scitex",IEC:"Hewlett-Packard",IIYA:"Iiyama North America",IKEG:"Ikegami Electronics",IMAG:"Image Systems",IMI:"Ingram Micro",INTC:"Intel",INTL:"N/A (INTL)",INTR:"Intra Electronics",IOCO:"Iocomm International Technology",IPS:"InfoPrint Solutions Company",IRIS:"Scitex",ISL:"Ichikawa Soft Laboratory",ITNL:"N/A (ITNL)",IVM:"IVM",IWAT:"Iwatsu Electric",Idnt:"Scitex",Inca:"Inca Digital Printers",Iris:"Scitex",JPEG:"Joint Photographic Experts Group",JSFT:"Jetsoft Development",JVC:"JVC Information Products",KART:"Scitex",KFC:"KFC Computek Components",KLH:"KLH Computers",KMHD:"Konica Minolta",KNCA:"Konica",KODA:"Kodak",KYOC:"Kyocera",Kart:"Scitex",LCAG:"Leica",LCCD:"Leeds Colour",LDAK:"Left Dakota",LEAD:"Leading Technology",LEXM:"Lexmark International",LINK:"Link Computer",LINO:"Linotronic",LITE:"Lite-On",Leaf:"Leaf",Lino:"Linotronic",MAGC:"Mag Computronic",MAGI:"MAG Innovision",MANN:"Mannesmann",MICN:"Micron Technology",MICR:"Microtek",MICV:"Microvitec",MINO:"Minolta",MITS:"Mitsubishi Electronics America",MITs:"Mitsuba",MNLT:"Minolta",MODG:"Modgraph",MONI:"Monitronix",MONS:"Monaco Systems",MORS:"Morse Technology",MOTI:"Motive Systems",MSFT:"Microsoft",MUTO:"MUTOH INDUSTRIES",Mits:"Mitsubishi Electric",NANA:"NANAO",NEC:"NEC",NEXP:"NexPress Solutions",NISS:"Nissei Sangyo America",NKON:"Nikon",NONE:"none",OCE:"Oce Technologies",OCEC:"OceColor",OKI:"Oki",OKID:"Okidata",OKIP:"Okidata",OLIV:"Olivetti",OLYM:"Olympus",ONYX:"Onyx Graphics",OPTI:"Optiquest",PACK:"Packard Bell",PANA:"Matsushita Electric Industrial",PANT:"Pantone",PBN:"Packard Bell",PFU:"PFU",PHIL:"Philips Consumer Electronics",PNTX:"HOYA",POne:"Phase One A/S",PREM:"Premier Computer Innovations",PRIN:"Princeton Graphic Systems",PRIP:"Princeton Publishing Labs",QLUX:"Hong Kong",QMS:"QMS",QPCD:"QPcard AB",QUAD:"QuadLaser",QUME:"Qume",RADI:"Radius",RDDx:"Integrated Color Solutions",RDG:"Roland DG",REDM:"REDMS Group",RELI:"Relisys",RGMS:"Rolf Gierling Multitools",RICO:"Ricoh",RNLD:"Edmund Ronald",ROYA:"Royal",RPC:"Ricoh Printing Systems",RTL:"Royal Information Electronics",SAMP:"Sampo",SAMS:"Samsung",SANT:"Jaime Santana Pomares",SCIT:"Scitex",SCRN:"Dainippon Screen",SDP:"Scitex",SEC:"Samsung",SEIK:"Seiko Instruments",SEIk:"Seikosha",SGUY:"ScanGuy.com",SHAR:"Sharp Laboratories",SICC:"International Color Consortium",SONY:"Sony",SPCL:"SpectraCal",STAR:"Star",STC:"Sampo Technology",Scit:"Scitex",Sdp:"Scitex",Sony:"Sony",TALO:"Talon Technology",TAND:"Tandy",TATU:"Tatung",TAXA:"TAXAN America",TDS:"Tokyo Denshi Sekei",TECO:"TECO Information Systems",TEGR:"Tegra",TEKT:"Tektronix",TI:"Texas Instruments",TMKR:"TypeMaker",TOSB:"Toshiba",TOSH:"Toshiba",TOTK:"TOTOKU ELECTRIC",TRIU:"Triumph",TSBT:"Toshiba",TTX:"TTX Computer Products",TVM:"TVM Professional Monitor",TW:"TW Casper",ULSX:"Ulead Systems",UNIS:"Unisys",UTZF:"Utz Fehlau & Sohn",VARI:"Varityper",VIEW:"Viewsonic",VISL:"Visual communication",VIVO:"Vivo Mobile Communication",WANG:"Wang",WLBR:"Wilbur Imaging",WTG2:"Ware To Go",WYSE:"WYSE Technology",XERX:"Xerox",XRIT:"X-Rite",ZRAN:"Zoran",Zebr:"Zebra Technologies",appl:"Apple Computer",bICC:"basICColor",berg:"bergdesign",ceyd:"Integrated Color Solutions",clsp:"MacDermid ColorSpan",ds:"Dainippon Screen",dupn:"DuPont",ffei:"FujiFilm Electronic Imaging",flux:"FluxData",iris:"Scitex",kart:"Scitex",lcms:"Little CMS",lino:"Linotronic",none:"none",ob4d:"Erdt Systems",obic:"Medigraph",quby:"Qubyx Sarl",scit:"Scitex",scrn:"Dainippon Screen",sdp:"Scitex",siwi:"SIWI GRAFIKA",yxym:"YxyMaster"},Kk={scnr:"Scanner",mntr:"Monitor",prtr:"Printer",link:"Device Link",abst:"Abstract",spac:"Color Space Conversion Profile",nmcl:"Named Color",cenc:"ColorEncodingSpace profile",mid:"MultiplexIdentification profile",mlnk:"MultiplexLink profile",mvis:"MultiplexVisualization profile",nkpf:"Nikon Input Device Profile (NON-STANDARD!)"};Dn(ho,"icc",[[4,oh],[12,Kk],[40,Object.assign({},oh,Kk)],[48,oh],[80,oh],[64,{0:"Perceptual",1:"Relative Colorimetric",2:"Saturation",3:"Absolute Colorimetric"}],["tech",{amd:"Active Matrix Display",crt:"Cathode Ray Tube Display",kpcd:"Photo CD",pmd:"Passive Matrix Display",dcam:"Digital Camera",dcpj:"Digital Cinema Projector",dmpc:"Digital Motion Picture Camera",dsub:"Dye Sublimation Printer",epho:"Electrophotographic Printer",esta:"Electrostatic Printer",flex:"Flexography",fprn:"Film Writer",fscn:"Film Scanner",grav:"Gravure",ijet:"Ink Jet Printer",imgs:"Photo Image Setter",mpfr:"Motion Picture Film Recorder",mpfs:"Motion Picture Film Scanner",offs:"Offset Lithography",pjtv:"Projection Television",rpho:"Photographic Paper Printer",rscn:"Reflective Scanner",silk:"Silkscreen",twax:"Thermal Wax Printer",vidc:"Video Camera",vidm:"Video Monitor"}]]);class sh extends io{static canHandle(t,r,n){return t.getUint8(r+1)===237&&t.getString(r+4,9)==="Photoshop"&&this.containsIptc8bim(t,r,n)!==void 0}static headerLength(t,r,n){let a,i=this.containsIptc8bim(t,r,n);if(i!==void 0)return a=t.getUint8(r+i+7),a%2!=0&&(a+=1),a===0&&(a=4),i+8+a}static containsIptc8bim(t,r,n){for(let a=0;a<n;a++)if(this.isIptcSegmentHead(t,r+a))return a}static isIptcSegmentHead(t,r){return t.getUint8(r)===56&&t.getUint32(r)===943868237&&t.getUint16(r+4)===1028}parse(){let{raw:t}=this,r=this.chunk.byteLength-1,n=!1;for(let a=0;a<r;a++)if(this.chunk.getUint8(a)===28&&this.chunk.getUint8(a+1)===2){n=!0;let i=this.chunk.getUint16(a+3),o=this.chunk.getUint8(a+2),s=this.chunk.getLatin1String(a+5,i);t.set(o,this.pluralizeValue(t.get(o),s)),a+=4+i}else if(n)break;return this.translate(),this.output}pluralizeValue(t,r){return t!==void 0?t instanceof Array?(t.push(r),t):[t,r]:r}}zt(sh,"type","iptc"),zt(sh,"translateValues",!1),zt(sh,"reviveValues",!1),zn.set("iptc",sh),Dn(ha,"iptc",[[0,"ApplicationRecordVersion"],[3,"ObjectTypeReference"],[4,"ObjectAttributeReference"],[5,"ObjectName"],[7,"EditStatus"],[8,"EditorialUpdate"],[10,"Urgency"],[12,"SubjectReference"],[15,"Category"],[20,"SupplementalCategories"],[22,"FixtureIdentifier"],[25,"Keywords"],[26,"ContentLocationCode"],[27,"ContentLocationName"],[30,"ReleaseDate"],[35,"ReleaseTime"],[37,"ExpirationDate"],[38,"ExpirationTime"],[40,"SpecialInstructions"],[42,"ActionAdvised"],[45,"ReferenceService"],[47,"ReferenceDate"],[50,"ReferenceNumber"],[55,"DateCreated"],[60,"TimeCreated"],[62,"DigitalCreationDate"],[63,"DigitalCreationTime"],[65,"OriginatingProgram"],[70,"ProgramVersion"],[75,"ObjectCycle"],[80,"Byline"],[85,"BylineTitle"],[90,"City"],[92,"Sublocation"],[95,"State"],[100,"CountryCode"],[101,"Country"],[103,"OriginalTransmissionReference"],[105,"Headline"],[110,"Credit"],[115,"Source"],[116,"CopyrightNotice"],[118,"Contact"],[120,"Caption"],[121,"LocalCaption"],[122,"Writer"],[125,"RasterizedCaption"],[130,"ImageType"],[131,"ImageOrientation"],[135,"LanguageIdentifier"],[150,"AudioType"],[151,"AudioSamplingRate"],[152,"AudioSamplingResolution"],[153,"AudioDuration"],[154,"AudioOutcue"],[184,"JobID"],[185,"MasterDocumentID"],[186,"ShortDocumentID"],[187,"UniqueDocumentID"],[188,"OwnerID"],[200,"ObjectPreviewFileFormat"],[201,"ObjectPreviewFileVersion"],[202,"ObjectPreviewData"],[221,"Prefs"],[225,"ClassifyState"],[228,"SimilarityIndex"],[230,"DocumentNotes"],[231,"DocumentHistory"],[232,"ExifCameraInfo"],[255,"CatalogSets"]]),Dn(ho,"iptc",[[10,{0:"0 (reserved)",1:"1 (most urgent)",2:"2",3:"3",4:"4",5:"5 (normal urgency)",6:"6",7:"7",8:"8 (least urgent)",9:"9 (user-defined priority)"}],[75,{a:"Morning",b:"Both Morning and Evening",p:"Evening"}],[131,{L:"Landscape",P:"Portrait",S:"Square"}]]);let My=null;async function cl(){if(!My)try{const n=(await N_(()=>Promise.resolve().then(()=>Wie),[])).default;if(typeof n!="function")throw new Error("JoRaw WASM import failed");const a=new URL("/assets/joraw-DraTMNgX.wasm",import.meta.url).href;My=n({locateFile:(i,o)=>i.endsWith("joraw.wasm")?a:o+i})}catch(r){throw console.error("Failed to load joraw.js:",r),r}const e=await My,t=e.LibRaw||e.JoRaw;if(!t)throw new Error("JoRaw class not found");return t}const Zb=[[3.2404542,-1.5371385,-.4985314],[-.969266,1.8760108,.041556],[.0556434,-.2040259,1.0572252]],Ao=e=>e<=.0031308?12.92*e:1.055*Math.pow(e,1/2.4)-.055;async function lh(e,t=0,r=0){const n=await cl(),a=new n;try{await a.open(new Uint8Array(e));const i=a.getRawImage(),o=new Uint16Array(i.data),s=i.width,l=i.height,u=Math.floor((s-t)/6)*2,d=Math.floor((l-r)/6)*2;if(u<=0||d<=0)throw new Error("Image too small for X-Trans subsampling with current phase.");const f=new Uint16Array(u*d);for(let g=0;g<d/2;g++){const b=g*6+r;if(b+3>=l)break;const w=b*s,v=(b+3)*s,x=g*2,m=x*u,k=(x+1)*u;for(let P=0;P<u/2;P++){const j=P*6+t;if(j+1>=s)break;const S=P*2;f[m+S]=o[w+j+1],f[m+S+1]=o[w+j+0],f[k+S]=o[v+j+0],f[k+S+1]=o[v+j+1]}}return{dngBuffer:Fh(u,d,f),width:u,height:d}}finally{a.delete?a.delete():a.close()}}async function k8(e){const t=await createImageBitmap(e),r=t.width,n=t.height,a=document.createElement("canvas");a.width=r,a.height=n;const i=a.getContext("2d");if(!i)throw new Error("Failed to create canvas context");i.drawImage(t,0,0);const s=i.getImageData(0,0,r,n).data,l=r*n,u=new Uint16Array(l);for(let h=0;h<n;h++)for(let g=0;g<r;g++){const b=(h*r+g)*4,w=h*r+g,v=h%2===0,x=g%2===0;let m=0;v&&x?m=s[b]:!v&&!x?m=s[b+2]:m=s[b+1],u[w]=m*64}const d=await new Promise(h=>a.toBlob(h,"image/png"));let f={description:"Standard image (non-RAW)"};try{const h=await z_.parse(e);h&&(f={...f,...h})}catch(h){console.warn("EXIF parsing failed for standard image",h)}return{previewBlob:d||e,analysisData:{data:u,width:r,height:n,bayerPattern:"RGGB",blackLevels:[0,0,0,0],whiteLevel:16320,metadata:f,isThreePlane:!0}}}const S8=async e=>{const t=await cl(),r=new t;try{await r.open(e,{useCameraWb:!0,outputBps:8,noAutoBright:!0,userQual:3,outputColor:1});const n=await r.imageData();return new Promise((a,i)=>{const o=document.createElement("canvas");o.width=n.width,o.height=n.height;const s=o.getContext("2d");if(!s){i(new Error("Could not create canvas context"));return}const l=s.createImageData(n.width,n.height),u=n.data,d=n.width*n.height;for(let f=0;f<d;f++){const h=f*3,g=f*4;l.data[g]=u[h],l.data[g+1]=u[h+1],l.data[g+2]=u[h+2],l.data[g+3]=255}s.putImageData(l,0,0),o.toBlob(f=>{f?a(f):i(new Error("Canvas to Blob failed"))},"image/jpeg",.85)})}finally{r.delete?r.delete():r.close()}},xp=async e=>{var n,a,i,o,s,l,u,d,f;const t=await cl(),r=new t;try{if(await r.open(e,{}),typeof r.getRawImage!="function")throw new Error("WASM mismatch");const h=r.getRawImage();let g=new Uint16Array(h.data);const b=await r.metadata(!0);let w={...b};try{const S=await z_.parse(e.buffer);S&&(w={...w,...S})}catch(S){console.warn("exifr parsing failed for RAW buffer",S)}const v=((n=b.idata)==null?void 0:n.filters)||0,x=((a=b.idata)==null?void 0:a.colors)||0,m=v===0&&x===3,k=v===9;let P=[0,0,0,0],j=!1;if(r.getBlackLevels)try{const S=r.getBlackLevels();S.dng_cblack&&S.dng_cblack.length===4&&Array.from(S.dng_cblack).some(M=>M>0)?(P=Array.from(S.dng_cblack).map(Number),j=!0):S.cblack&&S.cblack.length===4&&Array.from(S.cblack).some(M=>M>0)?(P=Array.from(S.cblack).map(Number),j=!0):typeof S.black=="number"&&S.black>0&&(P=[S.black,S.black,S.black,S.black],j=!0)}catch(S){console.warn("getBlackLevels binding failed",S)}if(!j){let S=[];if((i=b.color_data)!=null&&i.cblack_rawpy_style)S=b.color_data.cblack_rawpy_style;else if((s=(o=b.color_data)==null?void 0:o.dng_levels)!=null&&s.dng_cblack)S=b.color_data.dng_levels.dng_cblack;else if(((l=b.black_level_per_channel)==null?void 0:l.length)>=4)S=b.black_level_per_channel;else if(((u=b.cblack)==null?void 0:u.length)>=4)S=b.cblack;else if(((f=(d=b.color)==null?void 0:d.cblack)==null?void 0:f.length)>=4)S=b.color.cblack;else{const M=b.black_level||b.color_data&&b.color_data.black||0;S=[M,M,M,M]}P=[Number(S[0])||0,Number(S[1])||0,Number(S[2])||0,Number(S[3])||0]}return{data:g,width:h.width,height:h.height,bayerPattern:b.color_desc||"RGGB",blackLevels:P,whiteLevel:b.white_level||16383,metadata:w,isThreePlane:m,isXTrans:k}}finally{r.delete?r.delete():r.close()}};async function Oc(e){const t=new Uint8Array(e.slice(0)),r=new Uint8Array(e.slice(0)),[n,a]=await Promise.all([S8(t),xp(r)]);return{previewBlob:n,analysisData:a}}async function pu(e){const t=new Uint8Array(e);return xp(t)}const Yk=e=>(e--,e|=e>>1,e|=e>>2,e|=e>>4,e|=e>>8,e|=e>>16,e++,e);async function Ny(e,t,r,n=!0){const a=await xp(new Uint8Array(e)),i=await xp(new Uint8Array(t));if(a.width!==i.width||a.height!==i.height)throw new Error("Dimension Mismatch");const o=a.width,s=a.height,l=r?Yk(o):o,u=r?Yk(s):s,d=l*u,f=new Uint16Array(d),h=32768,g=1.41421356;for(let b=0;b<s;b++){const w=b*o,v=b*l;for(let x=0;x<o;x++){const m=a.data[w+x],k=i.data[w+x];let P=m-k;n&&(P/=g);let j=P+h;j=Math.max(0,Math.min(65535,j)),f[v+x]=Math.round(j)}}return{rawData:f,width:l,height:u,metadata:a.metadata}}function Pl(e,t,r,n,a,i,o){const s=Math.max(0,Math.floor(n)),l=Math.max(0,Math.floor(a)),u=Math.min(t,Math.ceil(n+i)),d=Math.min(r,Math.ceil(a+o)),f=[0,0,0,0],h=[0,0,0,0],g=[0,0,0,0];for(let v=l;v<d;v++){const x=v*t,m=v%2;for(let k=s;k<u;k++){const P=k%2,j=e[x+k],S=m*2+P;f[S]+=j,h[S]+=j*j,g[S]++}}const b=[0,0,0,0],w=[0,0,0,0];for(let v=0;v<4;v++)if(g[v]>0){const x=f[v]/g[v];b[v]=x;const k=h[v]/g[v]-x*x;w[v]=Math.sqrt(Math.max(0,k))}return{x:s,y:l,width:u-s,height:d-l,means:b,stdDevs:w,pixelCount:g.reduce((v,x)=>v+x,0)}}function j8(e,t,r,n,a,i=!1){const o=Math.floor(Math.max(0,r.x)),s=Math.floor(Math.max(0,r.y)),l=Math.ceil(Math.min(t,r.x+r.w)),u=e.length/t,d=Math.ceil(Math.min(u,r.y+r.h)),f=[0,0,0,0],h=[0,0,0,0];for(let G=s;G<d;G++){const $=G*t,L=G%2;for(let U=o;U<l;U++){const V=U%2,J=L*2+V,K=e[$+U],Q=n[J]||0;f[J]+=Math.max(0,K-Q),h[J]++}}let g=0,b=3;i&&(g=3,b=0);const w=h[g]>0?f[g]/h[g]:1,v=(f[1]+f[2])/(h[1]+h[2]||1),x=h[b]>0?f[b]/h[b]:1;if(w<1||v<1||x<1)return[1,1];const m=[[a[0],a[1],a[2]],[a[3],a[4],a[5]],[a[6],a[7],a[8]]],k=tc(m);if(!k)return console.warn("Color Matrix is not invertible, falling back to standard WB"),[v/w,v/x];const P=_f(Zb,k),j=tc(P);let S=1,M=1,O=1;if(j)S=j[0][0]+j[0][1]+j[0][2],M=j[1][0]+j[1][1]+j[1][2],O=j[2][0]+j[2][1]+j[2][2],Math.abs(M)<1e-6&&(M=1);else return console.warn("Final Matrix is not invertible"),[v/w,v/x];const E=v/w,I=v/x,D=S/M,B=O/M,z=E*D,Y=I*B;return[Math.max(0,z),Math.max(0,Y)]}function qk(e,t,r,n,a,i,o=0,s=0){const l=Math.max(0,Math.floor(n.x)),u=Math.max(0,Math.floor(n.y)),d=Math.min(t,Math.ceil(n.x+n.w)),f=Math.min(r,Math.ceil(n.y+n.h)),h=a>>1,g=a&1,b=(i>>1)+o,w=(i&1)+s;let v=0,x=0,m=0;for(let O=u;O<f-2;O+=2)for(let E=l;E<d-2;E+=2){const I=(O+h)*t+(E+g),D=(O+b)*t+(E+w);O+b>=r||E+w>=t||(v+=e[I],x+=e[D],m++)}if(m<2)return{sumCov:0,sumVar1:0,sumVar2:0,n:0};const k=v/m,P=x/m;let j=0,S=0,M=0;for(let O=u;O<f-2;O+=2)for(let E=l;E<d-2;E+=2){const I=(O+h)*t+(E+g),D=(O+b)*t+(E+w);if(O+b>=r||E+w>=t)continue;const B=e[I],z=e[D],Y=B-k,G=z-P;j+=Y*G,S+=Y*Y,M+=G*G}return{sumCov:j,sumVar1:S,sumVar2:M,n:m}}function P8(e){if(e.n<2)return 0;const t=Math.sqrt(e.sumVar1*e.sumVar2);return t===0?0:e.sumCov/t}function _8(e,t,r,n,a,i,o,s,l,u,d){if(u<=l)return[];const f=Math.max(0,Math.floor(n)),h=Math.max(0,Math.floor(a)),g=Math.min(t,Math.ceil(n+i)),b=Math.min(r,Math.ceil(a+o)),w=u-l,v=d?Math.floor(w)+1:s,x=w/v,m=[new Uint32Array(v),new Uint32Array(v),new Uint32Array(v),new Uint32Array(v)];for(let P=h;P<b;P++){const j=P*t,S=P%2;for(let M=f;M<g;M++){const O=M%2,E=e[j+M];if(E<l||E>u)continue;const I=S*2+O;let D;d?D=Math.floor(E-l):D=Math.floor((E-l)/x),D<0&&(D=0),D>=v&&(D=v-1),m[I][D]++}}const k=[];for(let P=0;P<v;P++){const j=l+(d?P:P*x);k.push({binStart:j,c0:m[0][P],c1:m[1][P],c2:m[2][P],c3:m[3][P]})}return k}function C8(e,t,r,n,a,i=!1,o=!1,s={rows:!1,rowGroup:0,cols:!1,colGroup:0},l=!0,u=1){const d=Math.max(0,Math.floor(n.x)),f=Math.max(0,Math.floor(n.y)),h=Math.min(t,Math.ceil(n.x+n.w)),g=Math.min(r,Math.ceil(n.y+n.h)),b=h-d,w=g-f;if(b<=1||w<=1)return null;let v=0;for(let D=d;D<h;D++)D%2===(a&1)&&v++;let x=0;for(let D=f;D<g;D++)D%2===a>>1&&x++;if(v<4||x<4)return null;const m=Math.max(1,u),k=Math.floor(2*v/(m+1)),P=Math.floor(2*x/(m+1));if(k<4||P<4)return null;const j=new rc(k),S=new rc(P),M=new Float32Array(Math.floor(k/2)+1),O=new Float32Array(Math.floor(P/2)+1);let E=0,I=0;for(let D=f;D<g;D++){const B=D%2;if(a>>1!==B||s.rows&&(D>>1&1)!==s.rowGroup)continue;const z=D*t,Y=new Float32Array(v);let G=0;for(let $=d;$<h;$++)$%2===(a&1)&&G<v&&(Y[G++]=e[z+$]);for(let $=0;$<m;$++){const L=Math.floor($*k/2);if(L+k>v)break;const U=Y.slice(L,L+k);j.calculateSpectrum(U,M,o),E++}if(!l)break}for(let D=d;D<h;D++){const B=D%2;if((a&1)!==B||s.cols&&(D>>1&1)!==s.rowGroup)continue;const z=new Float32Array(x);let Y=0;for(let G=f;G<g;G++)G%2===a>>1&&Y<x&&(z[Y++]=e[G*t+D]);for(let G=0;G<m;G++){const $=Math.floor(G*P/2);if($+P>x)break;const L=z.slice($,$+P);S.calculateSpectrum(L,O,o),I++}if(!l)break}if(E>0)for(let D=0;D<M.length;D++)M[D]/=E;if(I>0)for(let D=0;D<O.length;D++)O[D]/=I;return{avgHoriz:Array.from(M),avgVert:Array.from(O),sampleCount:{h:E,v:I}}}function M8(e,t,r,n,a,i=!1){const o=Math.max(0,Math.floor(n.x)),s=Math.max(0,Math.floor(n.y)),l=Math.min(t,Math.ceil(n.x+n.w)),u=Math.min(r,Math.ceil(n.y+n.h));let d=-1;for(let m=s;m<u;m++)if(m%2===a>>1){d=m;break}if(d===-1)return null;let f=-1;for(let m=o;m<l;m++)if(m%2===(a&1)){f=m;break}if(f===-1)return null;const h=[];for(let m=d;m<u;m+=2){const k=m*t,P=[];for(let j=f;j<l;j+=2)P.push(e[k+j]);h.push(P)}const g=h.length;if(g===0)return null;const b=h[0].length;if(b===0)return null;const w=new Float32Array(b*g);for(let m=0;m<g;m++){const k=h[m];for(let P=0;P<b;P++)w[m*b+P]=k[P]}const v=kT(w,b,g,i),x=ST(v,b,g);return{width:b,height:g,data:x}}function N8(e,t,r,n,a,i,o){const{x:s,y:l,w:u,h:d}=n,f=[],h=Math.max(0,Math.floor(s)),g=Math.max(0,Math.floor(l)),b=Math.min(t,Math.ceil(s+u)),w=Math.min(r,Math.ceil(l+d)),v=a>>1,x=a&1;for(let S=g;S<w;S++){if(S%2!==v)continue;const M=S*t;for(let O=h;O<b;O++){if(O%2!==x)continue;const E=e[M+O];E>=i&&E<=o&&f.push(E-i)}}if(f.length===0)return null;f.sort((S,M)=>S-M);const m=[f[0]];for(let S=1;S<f.length;S++)f[S]!==f[S-1]&&m.push(f[S]);const k=[],P=[],j={};for(let S=0;S<m.length-1;S++){const M=m[S],E=m[S+1]-M;k.push(E),P.push({x:M,y:E}),j[E]=(j[E]||0)+1}return{uniqueCount:m.length,diffCount:k.length,stepCounts:j,plotData:P}}function Jb(e,t,r){if(!r.advancedZeroDep)throw new Error("Unmixing settings not found in DisplaySettings.");const{bl:n,bg:a,fg:i}=r.advancedZeroDep,{data:o,width:s,whiteLevel:l}=e,u=a.map((k,P)=>Math.max(0,k-n[P])),d=i.map((k,P)=>Math.max(0,k-n[P])),f=(u[1]+u[3])/2,h=(d[1]+d[3])/2,g=Math.floor(t.x),b=Math.floor(t.y),w=Math.floor(t.w),v=Math.floor(t.h),x=Math.pow(2,r.exposure),m=new Uint16Array(w*v);for(let k=0;k<v;k++){const P=b+k;if(P<0||P>=e.height)continue;const j=P%2,S=P*s,M=k*w;for(let O=0;O<w;O++){const E=g+O;if(E<0||E>=s)continue;const I=E%2;let D=0;!j&&!I?D=0:!j&&I?D=1:j&&!I?D=3:D=2;const B=o[S+E],z=n[D],Y=u[D],G=d[D],$=Math.max(B-z,0),L=G-Y||1e-9,U=($-Y)/L;let V;U<0?V=$*(f/Math.max(Y,1e-9)):U>1?V=$*(h/Math.max(G,1e-9)):V=(1-U)*f+U*h,V*=x,m[M+O]=Math.max(0,Math.min(65535,Math.round(V)))}}return{data:m,width:w,height:v}}async function O8(e,t){const r=await cl(),n=new r;try{const a=new Uint8Array(e.slice(0));let i=!1,o=[];if(t.customMatrix&&t.customMatrix.length===9){const h=[[t.customMatrix[0],t.customMatrix[1],t.customMatrix[2]],[t.customMatrix[3],t.customMatrix[4],t.customMatrix[5]],[t.customMatrix[6],t.customMatrix[7],t.customMatrix[8]]],g=tc(h);if(g){const b=t.wbGains?t.wbGains[0]:1,w=t.wbGains?t.wbGains[1]:1,x=_f(g,[[b,0,0],[0,1,0],[0,0,w]]),m=_f(Zb,x);o=[m[0][0],m[0][1],m[0][2],m[1][0],m[1][1],m[1][2],m[2][0],m[2][1],m[2][2]],i=!0}else throw new Error("Custom Matrix is not invertible.")}const s={outputBps:16,noAutoBright:!0,bright:i?1:Math.pow(2,t.exposure)};t.blackLevel&&t.blackLevel.length===4&&(s.userBlack=0,s.userCblack=t.blackLevel.map(h=>{const g=Math.round(h);return g===0?1:g})),t.demosaicMethod===-1?s.noInterpolation=!0:s.userQual=t.demosaicMethod,i?(s.outputColor=0,s.gamma=[1,1],s.userMul=[1,1,1,1],s.useCameraWb=!1):(s.outputColor=1,s.useCameraWb=!0),await n.open(a,s);const l=await n.imageData(),u=new ImageData(l.width,l.height),d=u.data,f=new Uint16Array(l.data.buffer,l.data.byteOffset,l.data.byteLength/2);if(i&&o.length===9){const h=o,b=Math.pow(2,t.exposure)*.25;for(let w=0;w<f.length;w+=3){const v=f[w]/65535,x=f[w+1]/65535,m=f[w+2]/65535;let k=h[0]*v+h[1]*x+h[2]*m,P=h[3]*v+h[4]*x+h[5]*m,j=h[6]*v+h[7]*x+h[8]*m;k*=b,P*=b,j*=b,k=Math.max(0,Math.min(1,k)),P=Math.max(0,Math.min(1,P)),j=Math.max(0,Math.min(1,j)),k=Ao(k),P=Ao(P),j=Ao(j);const S=w/3*4;d[S]=Math.round(k*255),d[S+1]=Math.round(P*255),d[S+2]=Math.round(j*255),d[S+3]=255}}else for(let h=0;h<f.length;h+=3){const g=h/3*4;d[g]=f[h]>>8,d[g+1]=f[h+1]>>8,d[g+2]=f[h+2]>>8,d[g+3]=255}return u}finally{n.delete?n.delete():n.close()}}async function Oy(e,t){const r=await cl(),n=new r;try{await n.open(new Uint8Array(e));let a=16383;try{const w=await n.metadata(!0);w&&w.white_level&&(a=w.white_level)}catch(w){console.warn("Metadata error",w)}const i=n.getRawImage(),o=i.width,s=i.height,l=i.data,u=new ImageData(o,s),d=u.data,f=t.blackLevel||[0,0,0,0],h=a,g=t.wbGains?t.wbGains[0]:1,b=t.wbGains?t.wbGains[1]:1;for(let w=0;w<s;w++){const v=w%2;for(let x=0;x<o;x++){const m=x%2,k=v*2+m,P=l[w*o+x],j=f[k];let S=(P-j)/(h-j);S=Math.max(0,Math.min(1,S)),t.exposure!==0&&(S*=Math.pow(2,t.exposure),S=Math.min(1,S)),k===0?S*=g:k===3&&(S*=b);const M=Math.round(Ao(Math.min(1,S))*255),O=(w*o+x)*4;d[O]=M,d[O+1]=M,d[O+2]=M,d[O+3]=255}}return u}finally{n.delete?n.delete():n.close()}}async function A8(e,t){const r=await cl(),n=new r;try{await n.open(new Uint8Array(e));let a=16383;try{const G=await n.metadata(!0);G&&G.white_level&&(a=G.white_level)}catch{}const i=n.getRawImage(),{width:o,height:s,data:l}=i,u=new ImageData(o,s),d=u.data,f=t.blackLevel||[0,0,0,0],h=a,g=t.wbGains?t.wbGains[0]:1,b=t.wbGains?t.wbGains[1]:1,w=Math.pow(2,t.exposure),v=!!t.isBGGR,x=t.zeroDepColorDemosaic==="edge-aware"?"edge-aware":"bilinear";let m=[[1,0,0],[0,1,0],[0,0,1]];if(t.customMatrix&&t.customMatrix.length===9){const G=[[t.customMatrix[0],t.customMatrix[1],t.customMatrix[2]],[t.customMatrix[3],t.customMatrix[4],t.customMatrix[5]],[t.customMatrix[6],t.customMatrix[7],t.customMatrix[8]]],$=tc(G);$&&(m=_f(Zb,$))}const k=m[0][0],P=m[0][1],j=m[0][2],S=m[1][0],M=m[1][1],O=m[1][2],E=m[2][0],I=m[2][1],D=m[2][2],B=new Float32Array(o*s);for(let G=0;G<o*s;G++){const $=Math.floor(G/o),L=G%o,U=$%2,V=L%2,J=U*2+V,K=l[G],Q=f[J];let te=(K-Q)/(h-Q);te=Math.max(0,te),v?J===0?te*=b:J===3&&(te*=g):J===0?te*=g:J===3&&(te*=b),B[G]=te}const z=G=>{const $=B[G-1],L=B[G+1],U=B[G-o],V=B[G+o],J=Math.abs($-L),K=Math.abs(U-V);return J+1e-6<K?($+L)*.5:K+1e-6<J?(U+V)*.5:($+L+U+V)*.25},Y=G=>{const $=B[G-o-1],L=B[G+o+1],U=B[G-o+1],V=B[G+o-1],J=Math.abs($-L),K=Math.abs(U-V);return J+1e-6<K?($+L)*.5:K+1e-6<J?(U+V)*.5:($+L+U+V)*.25};for(let G=1;G<s-1;G++){const $=G%2,L=G*o;for(let U=1;U<o-1;U++){const V=U%2,J=L+U;let K=0,Q=0,te=0,ee=!1,me=!1,re=!1;if(!$&&!V?v?me=!0:ee=!0:$&&V?v?ee=!0:me=!0:re=!0,ee)K=B[J],x==="edge-aware"?(Q=z(J),te=Y(J)):(Q=(B[J-1]+B[J+1]+B[J-o]+B[J+o])*.25,te=(B[J-o-1]+B[J-o+1]+B[J+o-1]+B[J+o+1])*.25);else if(me)te=B[J],x==="edge-aware"?(Q=z(J),K=Y(J)):(Q=(B[J-1]+B[J+1]+B[J-o]+B[J+o])*.25,K=(B[J-o-1]+B[J-o+1]+B[J+o-1]+B[J+o+1])*.25);else{Q=B[J];const Se=(B[J-1]+B[J+1])*.5,he=(B[J-o]+B[J+o])*.5;let Pe=!1;!$&&V?v?Pe=!1:Pe=!0:v?Pe=!0:Pe=!1,Pe?(K=Se,te=he):(te=Se,K=he)}let De=k*K+P*Q+j*te,fe=S*K+M*Q+O*te,le=E*K+I*Q+D*te;De*=w,fe*=w,le*=w,De=Math.max(0,Math.min(1,De)),fe=Math.max(0,Math.min(1,fe)),le=Math.max(0,Math.min(1,le)),De=Ao(De),fe=Ao(fe),le=Ao(le);const de=J*4;d[de]=Math.round(De*255),d[de+1]=Math.round(fe*255),d[de+2]=Math.round(le*255),d[de+3]=255}}return u}finally{n.delete?n.delete():n.close()}}async function T8(e,t){const r=await cl(),n=new r;try{await n.open(new Uint8Array(e));let a=16383;try{const m=await n.metadata(!0);m&&m.white_level&&(a=m.white_level)}catch(m){console.warn("Metadata error",m)}const i=n.getRawImage(),{width:o,height:s,data:l}=i,u=new ImageData(o,s),d=u.data;if(!t.advancedZeroDep)throw new Error("Missing advanced settings");const{bl:f,bg:h,fg:g}=t.advancedZeroDep,b=h.map((m,k)=>Math.max(0,m-f[k])),w=g.map((m,k)=>Math.max(0,m-f[k])),v=(b[1]+b[3])/2,x=(w[1]+w[3])/2;for(let m=0;m<s;m++){const k=m%2;for(let P=0;P<o;P++){const j=P%2;let S=0;!k&&!j?S=0:!k&&j?S=1:k&&!j?S=3:S=2;const M=l[m*o+P],O=f[S],E=b[S],I=w[S],D=Math.max(M-O,0),B=I-E||1e-9,z=(D-E)/B;let Y;z<0?Y=D*(v/Math.max(E,1e-9)):z>1?Y=D*(x/Math.max(I,1e-9)):Y=(1-z)*v+z*x;let G=Y/65535;G=Math.max(0,Math.min(1,G));const $=Math.round(Ao(G)*255),L=(m*o+P)*4;d[L]=$,d[L+1]=$,d[L+2]=$,d[L+3]=255}}return u}finally{n.delete?n.delete():n.close()}}async function W_(e,t,r=!1,n=!1){const a=await cl(),i=new a;try{if(t.renderMode==="zero-dependency"||t.renderMode==="advanced-zero-dep"){await i.open(new Uint8Array(e));const o=await i.metadata(!0),s=(o==null?void 0:o.white_level)||16383,l=i.getRawImage(),{width:u,height:d,data:f}=l,h=new Uint16Array(u*d),g=Math.pow(2,t.exposure);if(t.renderMode==="advanced-zero-dep"&&t.advancedZeroDep){const{bl:b,bg:w,fg:v}=t.advancedZeroDep,x=w.map((j,S)=>Math.max(0,j-b[S])),m=v.map((j,S)=>Math.max(0,j-b[S])),k=(x[1]+x[3])/2,P=(m[1]+m[3])/2;for(let j=0;j<d;j++){const S=j%2;for(let M=0;M<u;M++){const O=M%2;let E=0;!S&&!O?E=0:!S&&O?E=1:S&&!O?E=3:E=2;const I=f[j*u+M],D=b[E],B=x[E],z=m[E],Y=Math.max(I-D,0),G=z-B||1e-9,$=(Y-B)/G;let L;$<0?L=Y*(k/Math.max(B,1e-9)):$>1?L=Y*(P/Math.max(z,1e-9)):L=(1-$)*k+$*P,L*=g;let U;if(n){const V=Math.max(0,Math.min(1,L/65535));U=Ao(V)*65535}else U=L;h[j*u+M]=Math.round(Math.max(0,Math.min(65535,U)))}}}else{const b=t.blackLevel||[0,0,0,0],w=t.wbGains?t.wbGains[0]:1,v=t.wbGains?t.wbGains[1]:1;for(let x=0;x<d;x++){const m=x%2;for(let k=0;k<u;k++){const P=k%2,j=m*2+P,S=f[x*u+k],M=b[j];let O=S-M;j===0?O*=w:j===3&&(O*=v),O*=g;const E=Math.max(0,Math.min(1,O/(r?s-M:s))),I=n?Ao(E):E;h[x*u+k]=Math.round(I*65535)}}}return{data:h,width:u,height:d,channels:1}}else{const o=new Uint8Array(e.slice(0)),s={outputBps:16,noAutoBright:!r,bright:1,outputColor:n?1:0,useCameraWb:!0};t.blackLevel&&t.blackLevel.length===4&&(s.userBlack=0,s.userCblack=t.blackLevel.map(f=>Math.max(1,Math.round(f)))),t.demosaicMethod===-1?s.noInterpolation=!0:s.userQual=t.demosaicMethod,await i.open(o,s);const l=await i.imageData(),u=new Uint16Array(l.data.buffer,l.data.byteOffset,l.data.byteLength/2),d=Math.pow(2,t.exposure);if(d!==1)for(let f=0;f<u.length;f++)u[f]=Math.max(0,Math.min(65535,Math.round(u[f]*d)));return{data:u,width:l.width,height:l.height,channels:3}}}finally{i.delete?i.delete():i.close()}}async function E8(e,t){const r={...t,renderMode:"standard",demosaicMethod:t.demosaicMethod===-1?3:t.demosaicMethod},n=await W_(e,r,!1,!0),a=n.width*n.height,i=new Float32Array(a*3);if(n.channels===3)for(let o=0;o<n.data.length;o++)i[o]=n.data[o]/65535;else for(let o=0;o<a;o++){const s=n.data[o]/65535,l=o*3;i[l]=s,i[l+1]=s,i[l+2]=s}return{data:i,width:n.width,height:n.height}}const Ps=({title:e,children:t})=>c.jsxs("div",{className:"border-b border-gray-200 dark:border-slate-700 transition-colors duration-300",children:[c.jsx("div",{className:"p-4 font-semibold text-gray-800 dark:text-slate-200 bg-gray-50 dark:bg-slate-800/30 border-b border-gray-200 dark:border-slate-800 select-none cursor-default transition-colors duration-300",children:c.jsx("span",{children:e})}),c.jsx("div",{className:"p-4 bg-white dark:bg-slate-900/50 transition-colors duration-300",children:t})]}),I8=[{value:-1,label:"Raw Bayer (Grayscale)"},{value:0,label:"Linear interpolation"},{value:1,label:"VNG (Variable Number of Gradients)"},{value:2,label:"PPG (Patterned Pixel Grouping)"},{value:3,label:"AHD (Adaptive Homogeneity-Directed)"},{value:4,label:"DCB (Demosaicing with Color Back-refinement)"},{value:11,label:"DHT (Modified AHD)"},{value:12,label:"AAHD (Adaptive AHD)"}],ch=({checked:e,onChange:t,label:r})=>c.jsxs("div",{className:"flex items-center justify-between py-2 cursor-pointer group",onClick:()=>t(!e),children:[c.jsx("span",{className:"text-sm font-medium text-gray-600 dark:text-slate-300 select-none group-hover:text-gray-900 dark:group-hover:text-slate-200 transition-colors",children:r}),c.jsx("div",{className:`relative w-11 h-6 rounded-full transition-colors duration-200 ease-in-out ${e?"bg-cyan-500 dark:bg-cyan-600":"bg-gray-300 dark:bg-slate-600 group-hover:bg-gray-400 dark:group-hover:bg-slate-500"}`,children:c.jsx("div",{className:`absolute left-1 top-1 bg-white w-4 h-4 rounded-full shadow-md transform transition-transform duration-200 ease-in-out ${e?"translate-x-5":"translate-x-0"}`})})]}),Ay=(e,t)=>{if(!e)return null;if(t){const r=e.bayerPattern.toUpperCase(),n=l=>{const u=[];for(let d=0;d<4;d++)r[d]===l&&u.push(d);return u},a=t.BlackLevelRed,i=t.BlackLevelGreen,o=t.BlackLevelBlue;if(a!==void 0&&i!==void 0&&o!==void 0){const l=parseFloat(a),u=parseFloat(i),d=parseFloat(o);if(!isNaN(l)&&!isNaN(u)&&!isNaN(d)){const f=[0,0,0,0];return f.fill(u),n("R").forEach(h=>f[h]=l),n("G").forEach(h=>f[h]=u),f}}let s=t.BlackLevel;if(s===void 0&&(s=t.BlackLevel2),s!==void 0){let l=[];if(Array.isArray(s)?l=s.map(Number):typeof s=="string"?l=s.trim().split(/\s+/).map(Number):typeof s=="number"&&(l=[s,s,s,s]),l.length===1&&!isNaN(l[0])&&(l=[l[0],l[0],l[0],l[0]]),l.length>=4&&!l.slice(0,4).some(isNaN))return[l[0],l[1],l[2],l[3]]}}return e.blackLevels&&e.blackLevels.length===4?[e.blackLevels[0],e.blackLevels[1],e.blackLevels[2],e.blackLevels[3]]:null},$8=e=>{var Vo,Xo;const{rawImageData:t,displaySettings:r,onApplyDisplaySettings:n,onSetSelection:a,exifData:i,isBridgeConnected:o,isDrLabOpen:s,drMarkingStep:l,onStartMarking:u,onGenerateTestPic:d,drRoiSize:f,onDrRoiSizeChange:h,drGridRows:g,onDrGridRowsChange:b,drGridCols:w,onDrGridColsChange:v,onBatchDrLab:x,hasDrMarkers:m,isFftLabOpen:k,onProcessPair:P,onProcessBatchDiff:j,onProcessStackFft:S,onOpenCrossCalc:M,isThreePlane:O,onToggleXTrans:E,xtransPhase:I,onXTransPhaseChange:D,isXTransConverted:B,onCommand:z,isColorLabOpen:Y,colorLabMarkingStep:G,onStartColorLabMarking:$,isSfrLabOpen:L,roiStats:U,isBGGR:V,onOpenDngExport:J,sfrRectCount:K,isBatchMarkingMode:Q,onToggleBatchMarking:te,onClearBatchMarks:ee,onBatchCompute:me,stdChartStep:re,onStartStandardCalibration:De,onSaveBatchTemplate:fe,onImportBatchTemplate:le,onBatchTransform:de,onOpenStackingTool:Se,isPsModeOpen:he,psDocument:Pe,psBrushEnabled:ve,psBrushSize:ye,psBrushOpacity:ge,psBrushFeather:ue,psEllipseFeather:Le,psBrushMode:rt,onPsAddMask:et,onPsAddEllipseMask:tt,onPsCancelEllipseTool:ft,onPsFlipHorizontal:wt,onPsFlipVertical:fr,onPsCropToRoi:Wt,onPsRotateCanvas:kt,onPsApplyUpright:Bt,onPsSelectLayer:Sr,onPsSelectMask:Gr,onPsBindLayerMask:rr,onPsSetLayerBlendMode:Nr,onPsSetLayerOpacity:nt,onPsSetLayerBasic:Ot,onPsSetLayerMixer:pr,onPsSetLayerCurves:br,onPsSelectMaskItem:jr,onPsUpdateEllipseItem:Rr,onPsSetMaskOverlayVisible:Pr,onPsAddGuide:Kt,onPsSelectGuide:Er,onPsSetGuideEndpoints:jt,psGuidePickTarget:Me,onPsStartGuidePointPick:X,onPsCancelGuidePointPick:Te,onPsDeleteGuide:xe,onPsUndo:ze,onPsJumpHistoryIndex:Je,onPsExportWorkflowCsv:ot,onPsImportWorkflowCsv:Pt,onPsExportPng:Qe,onPsExportJpeg:_r,onPsBrushEnabledChange:sr,onPsBrushSizeChange:Jt,onPsBrushOpacityChange:vt,onPsBrushFeatherChange:nr,onPsEllipseFeatherChange:A,onPsBrushModeChange:Ge}=e,Ke=!!t,Yt=!!(t!=null&&t.isXTrans),Ht=!!E,At=_.useMemo(()=>!Pe||!Pe.selectedGuideId?null:Pe.guides.find(Z=>Z.id===Pe.selectedGuideId)||null,[Pe]),yr=_.useMemo(()=>{var Z;return(Z=Pe==null?void 0:Pe.history)!=null&&Z.length?Pe.history.map((Oe,Qt)=>({entry:Oe,index:Qt})).reverse():[]},[Pe]),[Xr,ut]=_.useState("0"),Dt=_.useCallback(()=>{const Z=Number(Xr);Number.isFinite(Z)&&(kt==null||kt(Z))},[Xr,kt]),Vt=_.useRef(!1),ar=_.useRef(null),St=()=>{Vt.current=!0},_e=()=>{Vt.current=!1},[Or,F]=_.useState(r.exposure.toString()),[Ce,Ee]=_.useState(""),[_t,He]=_.useState("0 0 0 0"),[dt,qe]=_.useState("1.0"),[Lt,Ur]=_.useState("1.0"),[Kr,lr]=_.useState(r.demosaicMethod),[kn,Yr]=_.useState(!!r.showKadc),[Ar,cr]=_.useState(!!r.subtractBlackLevelFromStats),[Ft,Br]=_.useState(!!r.highlightRecovery),[We,xr]=_.useState(((Vo=r.customWhiteLevel)==null?void 0:Vo.toString())||(t==null?void 0:t.whiteLevel.toString())||"16383"),[mn,sa]=_.useState("64"),[Da,Sn]=_.useState(!1),[Ja,ce]=_.useState(""),[be,ke]=_.useState(""),[ae,$e]=_.useState(""),[pt,yt]=_.useState(!1),[Tt,Et]=_.useState(!1),[Mt,Ir]=_.useState(!1),[gr,Cr]=_.useState("bilinear"),[Lr,Ie]=_.useState(!1),[Ct,gt]=_.useState(!1),[zr,ur]=_.useState("single"),[Rn,Mr]=_.useState(!1),[qr,jn]=_.useState(!0),[Qa,go]=_.useState(!0),[Go,Pa]=_.useState(!1),[Ra,ji]=_.useState(10),[sn,mo]=_.useState(1.05),yo=_.useMemo(()=>Object.keys(hu).sort(),[]),zi=_.useRef(null),Ba=_.useRef(null),_a=_.useRef(null),Zr=_.useRef(null),[Bn,yl]=_.useState(null),[Ln,at]=_.useState(null),[qt,dr]=_.useState(!1),[Gt,Kn]=_.useState(!0),Hr=_.useRef(null),la=_.useRef(null),La=_.useRef(null),Fn=_.useRef(null);_.useEffect(()=>{const Z=t!==ar.current;if(Z&&(ar.current=t,_e()),F(r.exposure.toString()),r.customMatrix?Ee(r.customMatrix.join(" ")):Ee(""),r.blackLevel&&r.blackLevel.length===4)He(r.blackLevel.join(" "));else{const Oe=Ay(t,i);Oe&&Oe.some(Qt=>Qt!==0)?He(Oe.join(" ")):He("")}qe(r.wbGains?r.wbGains[0].toString():"1.0"),Ur(r.wbGains?r.wbGains[1].toString():"1.0"),lr(r.demosaicMethod),Yr(!!r.showKadc),cr(!!r.subtractBlackLevelFromStats),Br(!!r.highlightRecovery),r.customWhiteLevel?xr(r.customWhiteLevel.toString()):t!=null&&t.whiteLevel&&xr(t.whiteLevel.toString()),r.advancedZeroDep&&(ce(r.advancedZeroDep.bl.join(" ")),ke(r.advancedZeroDep.bg.join(" ")),$e(r.advancedZeroDep.fg.join(" ")),Z&&Sn(!0))},[r,t,i]);const ga=_.useRef(!1),tn=_.useRef(null);_.useEffect(()=>{t!==tn.current&&(ga.current=!1,tn.current=t)},[t]),_.useEffect(()=>{if(o&&t&&!ga.current){ga.current=!0;const Z=Ay(t,i),Oe=Z&&Z.some(Qt=>Qt>0);if(Z&&Oe){console.log("[AutoApply] Detected Black Levels via Bridge:",Z);const Qt={...r,blackLevel:Z,showKadc:!1,subtractBlackLevelFromStats:!1,exposure:r.exposure,wbGains:r.wbGains||[1,1],demosaicMethod:-1,renderMode:"zero-dependency"};n(Qt)}}},[o,t,i,r,n]);const Uo=Z=>{St(),F(Z)},Rt=Z=>{St(),qe(Z)},zo=Z=>{St(),Ur(Z)},It=Z=>{St(),lr(parseInt(Z.target.value,10))},Wo=Z=>{St(),Ee(Z.target.value)},vs=()=>{_e(),F("0"),lr(3),qe("1.0"),Ur("1.0"),Yr(!0),cr(!0),Ee(""),Br(!1),xr((t==null?void 0:t.whiteLevel.toString())||"16383"),Sn(!1);const Z=Ay(t,i);He(Z&&Z.some(Oe=>Oe!==0)?Z.join(" "):"")},Wi=()=>{!t||!a||(a({x:0,y:0,w:t.width,h:t.height}),z==null||z("sel full"))},xl=()=>{if(!t||!a)return;const Z=parseInt(mn,10);if(isNaN(Z)||Z<=0)return;const Oe=Math.min(Z,t.width),Qt=Math.min(Z,t.height),nn=Math.floor((t.width-Oe)/2),Pn=Math.floor((t.height-Qt)/2);a({x:nn,y:Pn,w:Oe,h:Qt}),z==null||z(`sel center ${Z}`)},kc=()=>{if(!t||!U){alert("Please select a region on the image first.");return}const Z=vl()||[0,0,0,0],Oe=Ce.trim().replace(/[\s,\n]+/g," "),Qt=Oe?Oe.split(" ").map(Number):[1,0,0,0,1,0,0,0,1];if(Qt.length!==9){alert("Matrix must be 3x3 (9 values).");return}const[nn,Pn]=j8(t.data,t.width,{x:U.x,y:U.y,w:U.width,h:U.height},Z,Qt,V);St(),qe(nn.toFixed(4)),Ur(Pn.toFixed(4)),z==null||z(`wb ${nn.toFixed(4)} ${Pn.toFixed(4)} (Spot)`)},vl=()=>{const Oe=_t.split(/[\s,]+/).filter(Qt=>Qt.trim()!=="").map(Number);if(Oe.length===1&&!isNaN(Oe[0]))return[Oe[0],Oe[0],Oe[0],Oe[0]];if(Oe.length>=4&&!Oe.slice(0,4).some(isNaN))return[Oe[0],Oe[1],Oe[2],Oe[3]]},Ho=Z=>{const Oe=Z.trim().split(/[\s,]+/).map(Number);return Oe.length===4&&!Oe.some(isNaN)?Oe:Oe.length===1&&!isNaN(Oe[0])?[Oe[0],Oe[0],Oe[0],Oe[0]]:null},xo=()=>{_e(),z&&(Or!=="0"&&z(`ev ${Or}`),(dt!=="1.0"||Lt!=="1.0")&&z(`wb ${dt} ${Lt}`),_t!=="0 0 0 0"&&_t!==""&&z(`bl ${_t}`),Kr!==3&&z(`demo ${Kr}`),Ce.trim().length>0&&z(`matrix ${Ce.replace(/\s+/g," ")}`),z("render"));const Z={...r},Oe=parseFloat(Or);isNaN(Oe)||(Z.exposure=Oe);const Qt=parseFloat(dt),nn=parseFloat(Lt);!isNaN(Qt)&&!isNaN(nn)&&(Z.wbGains=[Qt,nn]),Z.demosaicMethod=Kr,Z.renderMode="standard";const Pn=vl();Pn?Z.blackLevel=Pn:delete Z.blackLevel;const Yn=Ce.trim().replace(/[\s,\n]+/g," ");if(Yn){const Jr=Yn.split(" ").map(Number);Jr.length===9&&!Jr.some(isNaN)?Z.customMatrix=Jr:alert("Invalid matrix format. Please ensure exactly 9 numeric values (3x3).")}else delete Z.customMatrix;if(Z.showKadc=kn,Z.subtractBlackLevelFromStats=Ar,Z.highlightRecovery=Ft,Ft){const Jr=parseFloat(We);!isNaN(Jr)&&Jr>0&&(Z.customWhiteLevel=Jr)}else delete Z.customWhiteLevel;n(Z)},bl=()=>{Ir(V||!1),Cr("bilinear"),Et(!0)},wl=Z=>{_e(),z&&(Or!=="0"&&z(`ev ${Or}`),(dt!=="1.0"||Lt!=="1.0")&&z(`wb ${dt} ${Lt}`),_t!=="0 0 0 0"&&_t!==""&&z(`bl ${_t}`),z(Z==="color"?"render zero color":"render zero"));const Oe={...r},Qt=vl();Qt&&(Oe.blackLevel=Qt);const nn=parseFloat(dt),Pn=parseFloat(Lt);!isNaN(nn)&&!isNaN(Pn)&&(Oe.wbGains=[nn,Pn]);const Yn=parseFloat(Or);if(isNaN(Yn)||(Oe.exposure=Yn),Z==="color"){const Jr=Ce.trim().replace(/[\s,\n]+/g," ");if(Jr){const ma=Jr.split(" ").map(Number);ma.length===9&&!ma.some(isNaN)&&(Oe.customMatrix=ma)}Oe.isBGGR=Mt,Oe.zeroDepColorDemosaic=gr}if(Oe.renderMode=Z==="mosaic"?"zero-dependency":"zero-dep-color",Oe.showKadc=kn,Oe.subtractBlackLevelFromStats=Ar,Oe.highlightRecovery=Ft,Ft){const Jr=parseFloat(We);!isNaN(Jr)&&Jr>0&&(Oe.customWhiteLevel=Jr)}else delete Oe.customWhiteLevel;Et(!1),n(Oe)},sd=()=>{_e();const Z=Ho(Ja),Oe=Ho(be),Qt=Ho(ae);if(!Z||!Oe||!Qt){alert("Please enter valid 4-channel numbers for BL, BG, and FG.");return}z&&(Or!=="0"&&z(`ev ${Or}`),z(`render unmix ${Z.join(" ")} ${Oe.join(" ")} ${Qt.join(" ")}`));const nn={...r,renderMode:"advanced-zero-dep",advancedZeroDep:{bl:Z,bg:Oe,fg:Qt}};if(nn.showKadc=kn,nn.subtractBlackLevelFromStats=Ar,nn.highlightRecovery=Ft,Ft){const Pn=parseFloat(We);!isNaN(Pn)&&Pn>0&&(nn.customWhiteLevel=Pn)}n(nn)},kl=()=>{if(U){const Z=U.means,Oe=[Z[0],Z[1],Z[3],Z[2]].map(Qt=>Qt.toFixed(1));St(),ke(Oe.join(" "))}else alert("Please select an ROI on the image first.")},Sc=()=>{if(U){const Z=U.means,Oe=[Z[0],Z[1],Z[3],Z[2]].map(Qt=>Qt.toFixed(1));St(),$e(Oe.join(" "))}else alert("Please select an ROI on the image first.")},ui=Z=>{Z.target.files&&Z.target.files.length>0&&x&&(x(Z.target.files,zr),z==null||z(`drlab batch ${zr}`)),Z.target.value="",gt(!1)},Fa=async Z=>{var Qt;const Oe=(Qt=Z.target.files)==null?void 0:Qt[0];if(!(!Oe||!le)){try{const Pn=(await Oe.text()).split(`
`),Yn=[];for(let Jr of Pn){if(Jr=Jr.trim(),!Jr||Jr.toLowerCase().startsWith("index"))continue;const ma=Jr.split(",").map(Number);if(ma.length>=5){const di=ma[1],Pi=ma[2],vo=ma[3],Vi=ma[4],ya=ma[5];!isNaN(di)&&!isNaN(Pi)&&!isNaN(vo)&&!isNaN(Vi)&&Yn.push({x:di,y:Pi,w:vo,h:Vi,ori:isNaN(ya)?void 0:ya})}}le(Yn),alert(`Imported ${Yn.length} ROIs successfully.`)}catch(nn){console.error("Import failed",nn),alert("Failed to import CSV: "+nn.message)}Z.target.value=""}},Ga=async Z=>{var Qt;const Oe=(Qt=Z.target.files)==null?void 0:Qt[0];if(Oe){try{const Pn=(await Oe.text()).split(`
`),Yn=[];Yn.push("#BlackLevel: 0,0,0,0"),Yn.push("#ImageHeight: 0"),Yn.push("Row,Col,R_Mean,G1_Mean,G2_Mean,B_Mean,R_Std,G1_Std,G2_Std,B_Std");let Jr=1;for(let vo=0;vo<Pn.length;vo++){const Vi=Pn[vo].trim();if(!Vi||Vi.includes("R_mean")||Vi.includes("R_std"))continue;const ya=Vi.split(/\s+/).map(Number);if(ya.length<8||ya.some(isNaN))continue;const hd=[Jr,1,ya[0],ya[2],ya[6],ya[4],ya[1],ya[3],ya[7],ya[5]].join(",");Yn.push(hd),Jr++}const ma=new Blob([Yn.join(`
`)],{type:"text/csv"}),di=URL.createObjectURL(ma),Pi=document.createElement("a");Pi.href=di,Pi.download=Oe.name.replace(/\.[^/.]+$/,"")+"_converted.csv",document.body.appendChild(Pi),Pi.click(),document.body.removeChild(Pi),URL.revokeObjectURL(di)}catch(nn){console.error("Conversion failed",nn),alert("Failed to convert file.")}Z.target.value=""}},bs=Z=>{Z.target.files&&Z.target.files[0]&&(yl(Z.target.files[0]),z==null||z("fft load a"))},ld=Z=>{Z.target.files&&Z.target.files[0]&&(at(Z.target.files[0]),z==null||z("fft load b"))},cd=()=>{Bn&&Ln&&P&&(P(Bn,Ln,qt,Gt),z==null||z("fft run"))},ws=Z=>{Z.target.files&&Z.target.files.length>0&&j&&(j(Z.target.files),z==null||z("fft batch")),Z.target.value=""},ks=Z=>{Z.target.files&&Z.target.files.length>0&&S&&(S(Z.target.files),z==null||z("fft stack")),Z.target.value=""},ud=()=>{me&&(me({useNR:qr,useDeshading:Qa,greenOnly:Go}),z==null||z("batch compute"))},xt=(Z,Oe,Qt)=>{de&&de(Z,Oe,Qt)},dd=Z=>{var Qt;const Oe=(Qt=Z.target.files)==null?void 0:Qt[0];Oe&&Pt&&Pt(Oe),Z.target.value=""},fd=Ja.trim()!==""&&be.trim()!==""&&ae.trim()!=="",Hi=r.renderMode==="advanced-zero-dep";return c.jsxs("div",{className:"flex flex-col h-full bg-white dark:bg-black",children:[c.jsxs("div",{className:"flex-grow overflow-y-auto",children:[O&&c.jsxs("div",{className:"bg-red-50 dark:bg-red-900/20 p-3 border-b border-red-100 dark:border-red-800 text-center animate-pulse",children:[c.jsx("p",{className:"text-xs font-bold text-red-600 dark:text-red-400 uppercase tracking-wide",children:" 3-Plane / Full Color"}),c.jsx("p",{className:"text-[10px] text-red-500/80 dark:text-red-300/70 mt-1",children:"Demosaic disabled. Stats analysis treated as pseudo-Bayer."})]}),Yt&&!B&&c.jsxs("div",{className:"bg-amber-50 dark:bg-amber-900/20 p-3 border-b border-amber-100 dark:border-amber-800 text-center",children:[c.jsx("p",{className:"text-xs font-bold text-amber-600 dark:text-amber-400 uppercase tracking-wide",children:" X-Trans Native (Unsupported)"}),c.jsx("p",{className:"text-[10px] text-amber-600/80 dark:text-amber-300/70 mt-1 text-left leading-tight px-1",children:"Currently reading raw 6x6 pattern as Bayer. Stats will be incorrect. Please enable Pseudo-Bayer conversion below."})]}),B&&c.jsxs("div",{className:"bg-emerald-50 dark:bg-emerald-900/20 p-3 border-b border-emerald-100 dark:border-emerald-800 text-center",children:[c.jsx("p",{className:"text-xs font-bold text-emerald-600 dark:text-emerald-400 uppercase tracking-wide",children:"?X-Trans Pseudo-Bayer"}),c.jsx("p",{className:"text-[10px] text-emerald-600/80 dark:text-emerald-300/70 mt-1 text-left leading-tight px-1",children:"Converted 6x6  2x2 RGGB (Subsampled). Demosaic & Analysis fully supported."})]}),he&&c.jsxs(c.Fragment,{children:[c.jsx("div",{className:"p-4 border-b border-gray-200 dark:border-slate-700 bg-gray-50 dark:bg-slate-800/30",children:c.jsxs("div",{className:"space-y-2",children:[c.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[c.jsx("button",{onClick:()=>ze==null?void 0:ze(),disabled:!Pe||(Pe.historyIndex??0)<=0,className:"px-2 py-1 bg-amber-600 disabled:bg-gray-400 text-white font-bold border border-black text-xs",children:"Undo"}),c.jsx("button",{onClick:()=>ot==null?void 0:ot(),disabled:!Pe,className:"px-2 py-1 bg-slate-800 disabled:bg-gray-400 text-white font-bold border border-black text-xs",children:"Export Flow JSON"})]}),c.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[c.jsx("button",{onClick:()=>{var Z;return(Z=Fn.current)==null?void 0:Z.click()},disabled:!Pe,className:"px-2 py-1 bg-slate-700 disabled:bg-gray-400 text-white font-bold border border-black text-xs",children:"Import Flow File"}),c.jsx("button",{onClick:()=>Qe==null?void 0:Qe(),className:"px-2 py-1 bg-emerald-700 text-white font-bold border border-black text-xs",children:"Export PNG"})]}),c.jsx("button",{onClick:()=>_r==null?void 0:_r(),className:"w-full px-2 py-1 bg-emerald-800 text-white font-bold border border-black text-xs",children:"Export JPEG"}),c.jsx("input",{ref:Fn,type:"file",accept:".json,.csv,application/json,text/csv",className:"hidden",onChange:dd}),c.jsx("div",{className:"max-h-36 overflow-y-auto border border-gray-300 dark:border-slate-700 bg-white dark:bg-slate-900",children:yr.length>0?yr.map(({entry:Z,index:Oe})=>c.jsxs("button",{onClick:()=>Je==null?void 0:Je(Oe),className:`w-full text-left px-2 py-1 border-b border-gray-200 dark:border-slate-700 text-xs ${(Pe==null?void 0:Pe.historyIndex)===Oe?"bg-cyan-100 dark:bg-cyan-900/40":"bg-white dark:bg-slate-900"}`,children:[c.jsx("div",{className:"font-semibold truncate",children:Z.label}),c.jsx("div",{className:"text-[10px] text-gray-500",children:new Date(Z.timestamp).toLocaleTimeString()})]},Z.id)):c.jsx("div",{className:"px-2 py-2 text-[11px] text-gray-500",children:"No history entries."})})]})}),c.jsx(Ps,{title:"PS Masks",children:c.jsx(YT,{inline:!0,doc:Pe||null,brushEnabled:!!ve,brushSize:ye||32,brushOpacity:ge||.35,brushFeather:ue??.6,ellipseFeather:Le??24,brushMode:rt||"add",onAddMask:()=>et==null?void 0:et(),onAddEllipseMask:()=>tt==null?void 0:tt(),onCancelEllipseTool:()=>ft==null?void 0:ft(),onSelectLayer:Z=>Sr==null?void 0:Sr(Z),onSelectMask:Z=>Gr==null?void 0:Gr(Z),onBindLayerMask:(Z,Oe)=>rr==null?void 0:rr(Z,Oe),onSetLayerBlendMode:(Z,Oe)=>Nr==null?void 0:Nr(Z,Oe),onSetLayerOpacity:(Z,Oe)=>nt==null?void 0:nt(Z,Oe),onSetLayerBasic:(Z,Oe)=>Ot==null?void 0:Ot(Z,Oe),onSetLayerMixer:(Z,Oe)=>pr==null?void 0:pr(Z,Oe),onSetLayerCurves:(Z,Oe)=>br==null?void 0:br(Z,Oe),onSelectMaskItem:Z=>jr==null?void 0:jr(Z),onUpdateEllipseItem:(Z,Oe)=>Rr==null?void 0:Rr(Z,Oe),onSetMaskOverlayVisible:(Z,Oe)=>Pr==null?void 0:Pr(Z,Oe),onBrushEnabledChange:Z=>sr==null?void 0:sr(Z),onBrushSizeChange:Z=>Jt==null?void 0:Jt(Z),onBrushOpacityChange:Z=>vt==null?void 0:vt(Z),onBrushFeatherChange:Z=>nr==null?void 0:nr(Z),onEllipseFeatherChange:Z=>A==null?void 0:A(Z),onBrushModeChange:Z=>Ge==null?void 0:Ge(Z)})}),c.jsxs(Ps,{title:"PS Upright / Crop",children:[c.jsxs("div",{className:"grid grid-cols-2 gap-2 mb-2",children:[c.jsx("button",{onClick:()=>wt==null?void 0:wt(),className:"px-2 py-1 bg-slate-700 text-white font-bold border border-black",children:"Flip Left-Right"}),c.jsx("button",{onClick:()=>fr==null?void 0:fr(),className:"px-2 py-1 bg-slate-700 text-white font-bold border border-black",children:"Flip Up-Down"})]}),c.jsxs("div",{className:"grid grid-cols-2 gap-2 mb-2",children:[c.jsx("button",{onClick:()=>kt==null?void 0:kt(90),className:"px-2 py-1 bg-slate-700 text-white font-bold border border-black",children:"Rotate +90"}),c.jsx("button",{onClick:()=>kt==null?void 0:kt(-90),className:"px-2 py-1 bg-slate-700 text-white font-bold border border-black",children:"Rotate -90"})]}),c.jsxs("div",{className:"grid grid-cols-[1fr_auto] gap-2 mb-3",children:[c.jsx("input",{type:"number",step:.1,value:Xr,onChange:Z=>ut(Z.target.value),className:"border border-gray-400 dark:border-slate-600 bg-white dark:bg-slate-900 p-1",placeholder:"Angle deg"}),c.jsx("button",{onClick:Dt,className:"px-2 py-1 bg-slate-800 text-white font-bold border border-black",children:"Rotate"})]}),c.jsx("button",{onClick:()=>Wt==null?void 0:Wt(),disabled:!U,className:"mb-3 w-full px-2 py-1 bg-amber-600 disabled:bg-gray-400 text-white font-bold border border-black",children:"Crop To ROI"}),c.jsxs("div",{className:"grid grid-cols-2 gap-2 mb-2",children:[c.jsx("button",{onClick:()=>Kt==null?void 0:Kt("horizontal"),className:"px-2 py-1 bg-sky-700 text-white font-bold border border-black",children:"+ H Guide"}),c.jsx("button",{onClick:()=>Kt==null?void 0:Kt("vertical"),className:"px-2 py-1 bg-sky-800 text-white font-bold border border-black",children:"+ V Guide"})]}),c.jsxs("div",{className:"space-y-1 max-h-24 overflow-auto border border-gray-300 dark:border-slate-700 p-1 mb-2",children:[((Pe==null?void 0:Pe.guides)||[]).map(Z=>c.jsxs("button",{onClick:()=>Er==null?void 0:Er(Z.id),className:`w-full text-left px-2 py-1 border ${(Pe==null?void 0:Pe.selectedGuideId)===Z.id?"bg-sky-100 dark:bg-sky-900/40 border-sky-500":"bg-white dark:bg-slate-900 border-gray-300 dark:border-slate-700"}`,children:[Z.orientation==="horizontal"?"H":"V"," (",Math.round(Z.p1.x),",",Math.round(Z.p1.y),")-(",Math.round(Z.p2.x),",",Math.round(Z.p2.y),")"]},Z.id)),(((Xo=Pe==null?void 0:Pe.guides)==null?void 0:Xo.length)||0)===0&&c.jsx("div",{className:"px-2 py-2 text-[11px] text-gray-500",children:"No guides."})]}),At&&c.jsxs("div",{children:[c.jsxs("div",{className:"text-[11px] mb-1 text-gray-500",children:["Selected: ",At.orientation==="horizontal"?"Horizontal":"Vertical"]}),c.jsxs("div",{className:"grid grid-cols-2 gap-2 mb-2",children:[c.jsxs("label",{className:"text-[10px]",children:[c.jsx("span",{className:"block mb-0.5",children:"x1"}),c.jsx("input",{type:"number",min:0,max:Math.max(0,((Pe==null?void 0:Pe.width)||1)-1),step:1,value:Math.round(At.p1.x),onChange:Z=>jt==null?void 0:jt(At.id,{...At.p1,x:Number(Z.target.value)},At.p2),className:"w-full border border-gray-400 dark:border-slate-600 bg-white dark:bg-slate-900 p-1"})]}),c.jsxs("label",{className:"text-[10px]",children:[c.jsx("span",{className:"block mb-0.5",children:"y1"}),c.jsx("input",{type:"number",min:0,max:Math.max(0,((Pe==null?void 0:Pe.height)||1)-1),step:1,value:Math.round(At.p1.y),onChange:Z=>jt==null?void 0:jt(At.id,{...At.p1,y:Number(Z.target.value)},At.p2),className:"w-full border border-gray-400 dark:border-slate-600 bg-white dark:bg-slate-900 p-1"})]}),c.jsxs("label",{className:"text-[10px]",children:[c.jsx("span",{className:"block mb-0.5",children:"x2"}),c.jsx("input",{type:"number",min:0,max:Math.max(0,((Pe==null?void 0:Pe.width)||1)-1),step:1,value:Math.round(At.p2.x),onChange:Z=>jt==null?void 0:jt(At.id,At.p1,{...At.p2,x:Number(Z.target.value)}),className:"w-full border border-gray-400 dark:border-slate-600 bg-white dark:bg-slate-900 p-1"})]}),c.jsxs("label",{className:"text-[10px]",children:[c.jsx("span",{className:"block mb-0.5",children:"y2"}),c.jsx("input",{type:"number",min:0,max:Math.max(0,((Pe==null?void 0:Pe.height)||1)-1),step:1,value:Math.round(At.p2.y),onChange:Z=>jt==null?void 0:jt(At.id,At.p1,{...At.p2,y:Number(Z.target.value)}),className:"w-full border border-gray-400 dark:border-slate-600 bg-white dark:bg-slate-900 p-1"})]})]}),c.jsx("button",{onClick:()=>xe==null?void 0:xe(At.id),className:"w-full px-2 py-1 bg-rose-700 text-white font-bold border border-black",children:"Delete Selected Guide"}),c.jsxs("div",{className:"grid grid-cols-2 gap-2 mt-2",children:[c.jsx("button",{onClick:()=>X==null?void 0:X("p1"),className:`px-2 py-1 font-bold border border-black ${Me==="p1"?"bg-amber-600 text-white":"bg-gray-200 dark:bg-slate-800 text-black dark:text-white"}`,children:"Pick P1"}),c.jsx("button",{onClick:()=>X==null?void 0:X("p2"),className:`px-2 py-1 font-bold border border-black ${Me==="p2"?"bg-amber-600 text-white":"bg-gray-200 dark:bg-slate-800 text-black dark:text-white"}`,children:"Pick P2"})]}),Me&&c.jsx("button",{onClick:()=>Te==null?void 0:Te(),className:"mt-2 w-full px-2 py-1 bg-gray-600 text-white font-bold border border-black",children:"Cancel Pick"})]}),c.jsx("button",{onClick:()=>Bt==null?void 0:Bt(),className:"mt-2 w-full px-2 py-1 bg-teal-700 text-white font-bold border border-black",children:"Apply Upright (4 Guides)"}),c.jsx("div",{className:"mt-2 text-[10px] text-gray-500",children:"Upright: set 4 guides for two horizontal and two vertical references."}),Me&&c.jsxs("div",{className:"mt-1 text-[10px] text-amber-600 dark:text-amber-400",children:["Click once on canvas to set ",Me.toUpperCase(),"."]})]})]}),L&&c.jsx(Ps,{title:"SFR Lab Tools (Scalar Unmixing)",children:c.jsxs("div",{className:"space-y-4",children:[c.jsxs("div",{className:"bg-orange-50 dark:bg-orange-900/20 p-3 rounded border border-orange-200 dark:border-orange-800",children:[c.jsx("h4",{className:"text-[10px] font-bold text-orange-600 dark:text-orange-400 uppercase mb-2",children:"Analyze ROI"}),c.jsx("p",{className:"text-[10px] text-gray-500 dark:text-slate-400 mb-2",children:"Select an edge on the main canvas and click analyze. Use the pop-up modal to view ESF/LSF/MTF."}),c.jsx("div",{className:"text-center text-xs font-bold text-orange-500",children:"(ROI Analysis Window is Active)"})]}),Hi&&c.jsxs("div",{className:"border-t border-orange-200 dark:border-orange-800 pt-3",children:[c.jsxs("div",{className:"flex justify-between items-center cursor-pointer",onClick:()=>Mr(!Rn),children:[c.jsx("h4",{className:"text-[10px] font-bold text-orange-600 dark:text-orange-400 uppercase",children:" (Batch Ops)"}),c.jsx("svg",{className:`w-4 h-4 text-orange-500 transition-transform ${Rn?"rotate-180":""}`,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),Rn&&c.jsxs("div",{className:"mt-3 space-y-3 bg-white/50 dark:bg-black/20 p-2 rounded animate-in slide-in-from-top-1",children:[c.jsxs("div",{className:"flex flex-col gap-2",children:[c.jsx("span",{className:"text-[9px] font-bold text-gray-600 dark:text-gray-300",children:" (Standard Chart)"}),c.jsx("button",{onClick:De,disabled:!!re&&re>0,className:`w-full py-2 border font-bold text-xs rounded transition-all ${re&&re>0?"bg-emerald-600 text-white border-emerald-500 animate-pulse":"bg-white dark:bg-slate-800 border-gray-300 dark:border-slate-600 text-gray-700 dark:text-gray-300 hover:bg-gray-100"}`,children:re&&re>0?`Click ${re===1?"TL":re===2?"TR":re===3?"BL":"BR"}`:"Start Calibration (4-Pts)"}),!!re&&re>0&&c.jsx("p",{className:"text-[9px] text-emerald-600 dark:text-emerald-400 font-bold text-center",children:"Click corners: TopLeft  TopRight  BottomLeft  BottomRight"})]}),c.jsx("div",{className:"h-px bg-gray-300 dark:bg-slate-600 w-full"}),c.jsxs("div",{className:"flex flex-col gap-2",children:[c.jsxs("div",{className:"flex justify-between items-center",children:[c.jsx("span",{className:"text-[9px] font-bold text-gray-600 dark:text-gray-300",children:" (Manual Mark)"}),K!==void 0&&K>0&&c.jsxs("span",{className:"text-[9px] text-orange-500 font-bold",children:[K," Selected"]})]}),c.jsx("button",{onClick:te,className:`w-full py-2 font-bold text-xs rounded shadow transition-all ${Q?"bg-orange-600 hover:bg-orange-500 text-white ring-2 ring-orange-300":"bg-white dark:bg-slate-800 border border-gray-300 dark:border-slate-600 text-gray-700 dark:text-gray-300 hover:bg-gray-100"}`,children:Q?"Stop Marking (Active)":"Start Batch Marking"}),c.jsxs("div",{className:"flex gap-2",children:[c.jsxs("button",{onClick:fe,disabled:!K,className:"flex-1 py-1.5 border border-indigo-300 dark:border-indigo-700 text-indigo-700 dark:text-indigo-400 font-bold text-[10px] rounded hover:bg-indigo-50 dark:hover:bg-indigo-900/30 transition-colors disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-1",children:[c.jsx("svg",{className:"w-3 h-3",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7H5a2 2 0 00-2 2v9a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2h-3m-1 4l-3 3m0 0l-3-3m3 3V4"})})," (Save)"]}),c.jsx("input",{type:"file",ref:La,className:"hidden",accept:".csv",onChange:Fa}),c.jsxs("button",{onClick:()=>{var Z;return(Z=La.current)==null?void 0:Z.click()},className:"flex-1 py-1.5 border border-emerald-300 dark:border-emerald-700 text-emerald-700 dark:text-emerald-400 font-bold text-[10px] rounded hover:bg-emerald-50 dark:hover:bg-emerald-900/30 transition-colors flex items-center justify-center gap-1",children:[c.jsx("svg",{className:"w-3 h-3",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-8l-4-4m0 0L8 8m4-4v12"})})," (Import)"]})]}),K!==void 0&&K>0&&c.jsxs("div",{className:"bg-gray-100 dark:bg-slate-800/50 p-2 rounded border border-gray-200 dark:border-slate-700 mt-1",children:[c.jsx("div",{className:"text-[9px] font-bold text-gray-500 text-center mb-1",children:"UNIFIED TRANSFORM"}),c.jsxs("div",{className:"flex gap-2 mb-2 justify-center",children:[c.jsxs("div",{className:"flex flex-col items-center",children:[c.jsx("span",{className:"text-[8px] text-gray-400",children:"Step (px)"}),c.jsx("input",{type:"number",min:"1",value:Ra,onChange:Z=>ji(Number(Z.target.value)),className:"w-10 text-center text-[10px] bg-white dark:bg-slate-900 border rounded"})]}),c.jsxs("div",{className:"flex flex-col items-center",children:[c.jsx("span",{className:"text-[8px] text-gray-400",children:"Scale"}),c.jsx("input",{type:"number",step:"0.01",value:sn,onChange:Z=>mo(Number(Z.target.value)),className:"w-10 text-center text-[10px] bg-white dark:bg-slate-900 border rounded"})]})]}),c.jsxs("div",{className:"grid grid-cols-3 gap-1",children:[c.jsx("button",{onClick:()=>xt("scale",1/sn,1/sn),className:"bg-white dark:bg-slate-700 hover:bg-gray-200 rounded text-[10px] border dark:border-slate-600 font-bold",title:"Zoom Out (Shrink)",children:"-"}),c.jsx("button",{onClick:()=>xt("move",0,-Ra),className:"bg-white dark:bg-slate-700 hover:bg-gray-200 rounded text-[10px] border dark:border-slate-600",children:"^"}),c.jsx("button",{onClick:()=>xt("scale",sn,sn),className:"bg-white dark:bg-slate-700 hover:bg-gray-200 rounded text-[10px] border dark:border-slate-600 font-bold",title:"Zoom In (Expand)",children:"+"}),c.jsx("button",{onClick:()=>xt("move",-Ra,0),className:"bg-white dark:bg-slate-700 hover:bg-gray-200 rounded text-[10px] border dark:border-slate-600",children:""}),c.jsx("div",{className:"text-center text-[8px] text-gray-400 flex items-center justify-center",children:"Move"}),c.jsx("button",{onClick:()=>xt("move",Ra,0),className:"bg-white dark:bg-slate-700 hover:bg-gray-200 rounded text-[10px] border dark:border-slate-600",children:">"}),c.jsx("div",{}),c.jsx("button",{onClick:()=>xt("move",0,Ra),className:"bg-white dark:bg-slate-700 hover:bg-gray-200 rounded text-[10px] border dark:border-slate-600",children:"v"}),c.jsx("div",{})]})]}),Q&&c.jsx("p",{className:"text-[9px] text-gray-400 italic text-center mt-1",children:"Hold Shift + Drag on canvas to add multiple ROIs."}),c.jsxs("div",{className:"flex flex-col gap-1 text-[10px] mt-2 bg-gray-100 dark:bg-slate-800/50 p-2 rounded",children:[c.jsxs("div",{className:"flex justify-between items-center",children:[c.jsxs("label",{className:"flex items-center gap-1 cursor-pointer",children:[c.jsx("input",{type:"checkbox",checked:qr,onChange:Z=>jn(Z.target.checked),className:"rounded text-orange-500"}),"Jiang Official NR"]}),c.jsxs("label",{className:"flex items-center gap-1 cursor-pointer",children:[c.jsx("input",{type:"checkbox",checked:Qa,onChange:Z=>go(Z.target.checked),className:"rounded text-purple-500"}),"Deshading"]})]}),c.jsx("div",{className:"h-px bg-gray-200 dark:bg-slate-700 my-1"}),c.jsxs("label",{className:"flex items-center gap-1 cursor-pointer",title:"Only use Green channel points for projection (reduces color moire issues)",children:[c.jsx("input",{type:"checkbox",checked:Go,onChange:Z=>Pa(Z.target.checked),className:"rounded text-emerald-500"}),c.jsx("span",{className:"font-bold text-emerald-600 dark:text-emerald-400",children:"Green Channel Only (G Only)"})]})]}),c.jsxs("button",{onClick:ud,disabled:!K,className:"w-full py-2 bg-indigo-600 hover:bg-indigo-500 disabled:bg-gray-300 disabled:text-gray-500 text-white font-bold text-xs rounded shadow transition-transform active:scale-95",children:["Calculate & Copy (",K||0,")"]}),c.jsx("button",{onClick:ee,disabled:!K,className:"w-full py-1.5 bg-gray-200 dark:bg-slate-700 hover:bg-red-100 hover:text-red-600 text-[10px] font-bold rounded transition-colors disabled:opacity-50",children:"Clear All Marks"})]})]})]}),c.jsx("div",{className:"h-px bg-gray-200 dark:bg-slate-700 w-full"}),c.jsx(ch,{checked:Da,onChange:Sn,label:" (Scalar Unmixing)"}),Da&&c.jsxs("div",{className:"space-y-4 pl-2 border-l-2 border-indigo-200 dark:border-indigo-900 animate-in slide-in-from-top-2 duration-200",children:[c.jsxs("div",{className:"grid grid-cols-5 gap-1 items-center text-[9px] uppercase font-bold text-gray-400 mb-[-8px]",children:[c.jsx("div",{className:"col-span-1",children:"Param"}),c.jsx("div",{className:"text-center",children:"Ch0(R)"}),c.jsx("div",{className:"text-center",children:"Ch1(G1)"}),c.jsx("div",{className:"text-center",children:"Ch2(B)"}),c.jsx("div",{className:"text-center",children:"Ch3(G2)"})]}),c.jsxs("div",{className:"grid grid-cols-5 gap-2 items-center",children:[c.jsx("span",{className:"text-[10px] font-bold text-red-500",children:"BL:"}),c.jsx("input",{type:"text",value:Ja,onChange:Z=>{St(),ce(Z.target.value)},placeholder:"0 0 0 0",className:"col-span-4 px-2 py-1 bg-white dark:bg-slate-800 border border-gray-300 dark:border-slate-600 rounded text-xs font-mono text-gray-900 dark:text-slate-100"})]}),c.jsxs("div",{className:"grid grid-cols-5 gap-2 items-center",children:[c.jsx("span",{className:"text-[10px] font-bold text-indigo-500",children:"B ():"}),c.jsxs("div",{className:"col-span-4 flex gap-1",children:[c.jsx("input",{type:"text",value:be,onChange:Z=>{St(),ke(Z.target.value)},className:"flex-1 px-2 py-1 bg-white dark:bg-slate-800 border border-gray-300 dark:border-slate-600 rounded text-xs font-mono text-gray-900 dark:text-slate-100"}),c.jsx("button",{onClick:kl,className:"px-2 bg-gray-200 dark:bg-slate-700 hover:bg-gray-300 dark:hover:bg-slate-600 text-[9px] rounded font-bold transition-colors",title:"Fill with current ROI mean stats (Raw DN)",children:"Pick"})]})]}),c.jsxs("div",{className:"grid grid-cols-5 gap-2 items-center",children:[c.jsx("span",{className:"text-[10px] font-bold text-emerald-500",children:"F ():"}),c.jsxs("div",{className:"col-span-4 flex gap-1",children:[c.jsx("input",{type:"text",value:ae,onChange:Z=>{St(),$e(Z.target.value)},className:"flex-1 px-2 py-1 bg-white dark:bg-slate-800 border border-gray-300 dark:border-slate-600 rounded text-xs font-mono text-gray-900 dark:text-slate-100"}),c.jsx("button",{onClick:Sc,className:"px-2 bg-gray-200 dark:bg-slate-700 hover:bg-gray-300 dark:hover:bg-slate-600 text-[9px] rounded font-bold transition-colors",title:"Fill with current ROI mean stats (Raw DN)",children:"Pick"})]})]}),c.jsx("button",{onClick:sd,disabled:!Ke||!fd,className:"w-full bg-indigo-600 hover:bg-indigo-500 text-white font-bold py-2 rounded text-[10px] shadow transition-transform active:scale-95 disabled:bg-gray-300 dark:disabled:bg-slate-800 disabled:text-gray-500 disabled:cursor-not-allowed",children:"RUN UNMIXING (ADV ZERO-DEP)"}),c.jsx("p",{className:"text-[9px] text-gray-400 italic text-center",children:"Basic render + sRGB gamma are applied."})]})]})}),k&&c.jsx(Ps,{title:"FFT Lab (Noise Profile)",children:c.jsxs("div",{className:"space-y-6",children:[c.jsxs("div",{className:"space-y-3 bg-gray-50 dark:bg-slate-800/40 p-3 rounded-xl border border-gray-100 dark:border-slate-800",children:[c.jsxs("h4",{className:"text-[10px] font-bold text-fuchsia-600 dark:text-fuchsia-400 uppercase tracking-widest flex items-center gap-2",children:[c.jsx("span",{className:"w-1.5 h-1.5 rounded-full bg-fuchsia-500"})," 1. Pair Difference (Sub)"]}),c.jsxs("div",{className:"flex flex-col gap-2",children:[c.jsx("input",{type:"file",ref:zi,className:"hidden",onChange:bs,accept:".arw,.cr2,.cr3,.dng,.nef,.orf,.raf,.rw2,.pef,.srw,.sr2,.srf,.x3f,.erf,.mef,.mos,.mrw,.kdc,.dcr,.iiq,.3fr,.fff,.rwl,.nrw,.raw,.tif,.tiff"}),c.jsx("button",{onClick:()=>{var Z;return(Z=zi.current)==null?void 0:Z.click()},className:`w-full py-2 px-3 rounded-lg border text-[10px] font-bold text-left truncate transition-colors ${Bn?"bg-fuchsia-55 dark:bg-fuchsia-900/20 border-fuchsia-300 dark:border-fuchsia-800 text-fuchsia-700 dark:text-fuchsia-300":"bg-white dark:bg-slate-800 border-gray-300 dark:border-slate-600 text-gray-500 hover:bg-gray-50 dark:hover:bg-slate-700"}`,children:Bn?`A: ${Bn.name}`:"Load Image A"}),c.jsx("input",{type:"file",ref:Ba,className:"hidden",onChange:ld,accept:".arw,.cr2,.cr3,.dng,.nef,.orf,.raf,.rw2,.pef,.srw,.sr2,.srf,.x3f,.erf,.mef,.mos,.mrw,.kdc,.dcr,.iiq,.3fr,.fff,.rwl,.nrw,.raw,.tif,.tiff"}),c.jsx("button",{onClick:()=>{var Z;return(Z=Ba.current)==null?void 0:Z.click()},className:`w-full py-2 px-3 rounded-lg border text-[10px] font-bold text-left truncate transition-colors ${Ln?"bg-fuchsia-55 dark:bg-fuchsia-900/20 border-fuchsia-300 dark:border-fuchsia-800 text-fuchsia-700 dark:text-fuchsia-300":"bg-white dark:bg-slate-800 border-gray-300 dark:border-slate-600 text-gray-500 hover:bg-gray-50 dark:hover:bg-slate-700"}`,children:Ln?`B: ${Ln.name}`:"Load Image B"})]}),c.jsx("div",{className:"flex flex-col gap-1.5 pt-1",children:c.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[c.jsx("input",{type:"checkbox",checked:Gt,onChange:Z=>Kn(Z.target.checked),className:"w-3 h-3 text-fuchsia-600 border-gray-300 rounded focus:ring-0"}),c.jsx("span",{className:"text-[10px] text-gray-600 dark:text-slate-300",children:"Normalize (?)"})]})}),c.jsxs("div",{className:"grid grid-cols-1 gap-2",children:[c.jsx("button",{onClick:cd,disabled:!Bn||!Ln,className:"w-full bg-fuchsia-600 hover:bg-fuchsia-500 disabled:opacity-30 text-white font-bold py-2 rounded shadow transition-all active:scale-95 text-[10px]",children:"Generate Diff & Load"}),c.jsx("input",{type:"file",ref:_a,className:"hidden",multiple:!0,accept:".arw,.cr2,.cr3,.dng,.nef,.orf,.raf,.rw2,.pef,.srw,.sr2,.srf,.x3f,.erf,.mef,.mos,.mrw,.kdc,.dcr,.iiq,.3fr,.fff,.rwl,.nrw,.raw,.tif,.tiff",onChange:ws}),c.jsx("button",{onClick:()=>{var Z;return(Z=_a.current)==null?void 0:Z.click()},className:"w-full bg-slate-700 hover:bg-slate-600 text-white font-bold py-2 rounded shadow transition-all active:scale-95 text-[10px] flex items-center justify-center gap-1",children:"Batch Diffs (Auto Download)"})]})]}),c.jsxs("div",{className:"space-y-3 bg-gray-50 dark:bg-slate-800/40 p-3 rounded-xl border border-gray-100 dark:border-slate-800",children:[c.jsxs("h4",{className:"text-[10px] font-bold text-cyan-600 dark:text-cyan-400 uppercase tracking-widest flex items-center gap-2",children:[c.jsx("span",{className:"w-1.5 h-1.5 rounded-full bg-cyan-500"})," 2. Stack FFT (Avg PSD)"]}),c.jsxs("div",{className:"flex flex-col gap-2",children:[c.jsx("input",{type:"file",ref:Zr,className:"hidden",multiple:!0,onChange:ks,accept:".arw,.cr2,.cr3,.dng,.nef,.orf,.raf,.rw2,.pef,.srw,.sr2,.srf,.x3f,.erf,.mef,.mos,.mrw,.kdc,.dcr,.iiq,.3fr,.fff,.rwl,.nrw,.raw,.tif,.tiff"}),c.jsx("button",{onClick:()=>{var Z;return(Z=Zr.current)==null?void 0:Z.click()},className:"w-full py-3 bg-cyan-600 hover:bg-cyan-500 text-white font-bold rounded-lg shadow-md transition-all active:scale-95 text-[10px] flex items-center justify-center gap-2",children:"Select Sequence Files"})]})]}),c.jsxs("div",{className:"flex flex-col gap-2 pt-2 border-t border-gray-100 dark:border-slate-800",children:[c.jsx("button",{onClick:()=>{M==null||M(),z==null||z("crosscalc")},className:"w-full bg-indigo-600 hover:bg-indigo-500 text-white font-bold py-2 px-4 rounded-lg shadow-md transition-all active:scale-95 text-[10px] flex items-center justify-center gap-2",children:"Cross-Compensation Calc"}),c.jsx("button",{onClick:()=>{Se==null||Se(),z==null||z("stack tool")},className:"w-full bg-emerald-600 hover:bg-emerald-500 text-white font-bold py-2 px-4 rounded-lg shadow-md transition-all active:scale-95 text-[10px] flex items-center justify-center gap-2",children:"?(General Stack)"})]})]})}),s&&c.jsx(Ps,{title:"DR Lab Tools",children:c.jsxs("div",{className:"space-y-4",children:[c.jsx("button",{onClick:()=>{d==null||d(),z==null||z("gen test")},className:"w-full bg-amber-500 hover:bg-amber-600 text-white font-bold py-2 px-4 rounded-lg shadow-md transition-colors text-sm",children:"Generate Test Pic"}),c.jsxs("div",{className:"border-t border-gray-200 dark:border-slate-700 pt-3",children:[c.jsx("h4",{className:"text-xs font-bold text-gray-500 dark:text-slate-400 uppercase tracking-wide mb-2",children:"Grid Analysis"}),h&&f!==void 0&&c.jsx("div",{className:"flex items-center justify-between mb-3",children:c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx("span",{className:"text-sm text-gray-600 dark:text-slate-300",children:"Box Size:"}),c.jsx("input",{type:"number",min:"8",max:"512",step:"2",value:f,onChange:Z=>h(parseInt(Z.target.value)||64),className:"w-12 px-1 py-1 bg-white dark:bg-slate-800 border border-gray-300 dark:border-slate-600 rounded-md focus:ring-2 focus:ring-cyan-500 outline-none text-sm text-gray-900 dark:text-slate-100 text-center"}),c.jsx("span",{className:"text-xs text-gray-400",children:"px"})]})}),b&&v&&g!==void 0&&w!==void 0&&c.jsxs("div",{className:"flex items-center justify-between mb-3",children:[c.jsx("span",{className:"text-sm text-gray-600 dark:text-slate-400",children:"Layout:"}),c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx("input",{type:"number",min:"1",max:"50",value:g,onChange:Z=>b(Math.max(1,parseInt(Z.target.value)||1)),className:"w-10 px-1 py-1 bg-white dark:bg-slate-800 border border-gray-300 dark:border-slate-600 rounded-md outline-none text-sm text-center",title:"Rows"}),c.jsx("span",{className:"text-xs text-gray-400",children:"x"}),c.jsx("input",{type:"number",min:"1",max:"50",value:w,onChange:Z=>v(Math.max(1,parseInt(Z.target.value)||1)),className:"w-10 px-1 py-1 bg-white dark:bg-slate-800 border border-gray-300 dark:border-slate-600 rounded-md outline-none text-sm text-center",title:"Columns"})]})]}),c.jsxs("div",{className:"flex flex-col gap-2",children:[c.jsx("button",{onClick:()=>{u==null||u(),z==null||z("mark")},disabled:!Ke||l!==void 0&&l>0,className:`w-full font-bold py-2 px-4 rounded-lg shadow-md transition-all text-sm ${Ke?l&&l>0?"bg-indigo-100 dark:bg-indigo-900 text-indigo-700 dark:text-indigo-300 border-2 border-indigo-500":"bg-indigo-600 hover:bg-indigo-700 text-white":"bg-gray-300 text-gray-500 cursor-not-allowed"}`,children:l&&l>0?"Marking Active...":"Mark Corners"}),x&&c.jsxs(c.Fragment,{children:[c.jsx("input",{type:"file",ref:Hr,className:"hidden",multiple:!0,accept:".arw,.cr2,.cr3,.dng,.nef,.orf,.raf,.rw2,.pef,.srw,.sr2,.srf,.x3f,.erf,.mef,.mos,.mrw,.kdc,.dcr,.iiq,.3fr,.fff,.rwl,.nrw,.raw,.tif,.tiff",onChange:ui}),c.jsxs("div",{className:"relative",children:[c.jsx("button",{onClick:()=>gt(!Ct),disabled:!m,className:"w-full font-bold py-2 px-4 rounded-lg shadow-md transition-all text-sm bg-emerald-600 hover:bg-emerald-700 disabled:bg-gray-300 disabled:text-gray-500 disabled:cursor-not-allowed text-white flex items-center justify-center gap-2",children:"Reuse Last & Batch"}),Ct&&c.jsxs("div",{className:"absolute bottom-full left-0 w-full mb-1 bg-white dark:bg-slate-800 rounded-lg shadow-xl border border-gray-200 dark:border-slate-700 overflow-hidden z-20 flex flex-col animate-in fade-in zoom-in-95 duration-100",children:[c.jsx("button",{className:"px-4 py-2 text-left text-xs hover:bg-gray-100 dark:hover:bg-slate-700 text-gray-700 dark:text-slate-200 border-b border-gray-100 dark:border-slate-700",onClick:()=>{var Z;ur("single"),(Z=Hr.current)==null||Z.click()},children:"1. Independent Frames"}),c.jsx("button",{className:"px-4 py-2 text-left text-xs hover:bg-gray-100 dark:hover:bg-slate-700 text-indigo-600 dark:text-indigo-400 font-bold",onClick:()=>{var Z;ur("pair"),(Z=Hr.current)==null||Z.click()},children:"2. Pair Difference (A-B)"})]})]})]}),c.jsxs("div",{className:"pt-2 mt-2 border-t border-gray-100 dark:border-slate-800",children:[c.jsx("input",{type:"file",ref:la,className:"hidden",accept:".txt",onChange:Ga}),c.jsx("button",{onClick:()=>{var Z;return(Z=la.current)==null?void 0:Z.click()},className:"w-full font-bold py-2 px-4 rounded-lg shadow-sm transition-all text-xs bg-slate-100 hover:bg-slate-200 dark:bg-slate-800 dark:hover:bg-slate-700 text-gray-600 dark:text-slate-300 flex items-center justify-center gap-2 border border-gray-300 dark:border-slate-600",children:"Convert Format (.txt  .csv)"})]})]}),l!==void 0&&l>0&&c.jsx("div",{className:"mt-2 text-center",children:c.jsxs("p",{className:"text-xs text-indigo-600 dark:text-indigo-400 font-bold animate-pulse",children:[l===1&&"Click Top-Left Center",l===2&&"Click Top-Right Center",l===3&&"Click Bottom-Left Center",l===4&&"Click Bottom-Right Center"]})})]})]})}),Y&&c.jsx(Ps,{title:"Color Lab Tools",children:c.jsxs("div",{className:"space-y-4",children:[c.jsx("div",{className:"text-sm text-gray-600 dark:text-slate-300 mb-2",children:"Calibrate colors using a standard ColorChecker 24 chart."}),c.jsx("button",{onClick:()=>{$==null||$(),z==null||z("cl mark")},disabled:!Ke||G!==void 0&&G>0,className:`w-full font-bold py-2 px-4 rounded-lg shadow-md transition-all text-sm ${Ke?G&&G>0?"bg-yellow-100 dark:bg-yellow-900 text-yellow-700 dark:text-yellow-300 border-2 border-yellow-500":"bg-yellow-600 hover:bg-yellow-700 text-white":"bg-gray-300 text-gray-500 cursor-not-allowed"}`,children:G&&G>0?"Marking Active...":"Mark 24-Patch Chart"}),G!==void 0&&G>0&&c.jsx("div",{className:"mt-2 text-center",children:c.jsxs("p",{className:"text-xs text-yellow-600 dark:text-yellow-400 font-bold animate-pulse",children:[G===1&&"Click Top-Left (Brown)",G===2&&"Click Top-Right (Cyanish)",G===3&&"Click Bottom-Left (White)",G===4&&"Click Bottom-Right (Black)"]})})]})}),!he&&c.jsx(Ps,{title:"Selection Tools",children:c.jsx("div",{className:"space-y-3",children:c.jsxs("div",{children:[c.jsx("label",{className:"text-xs font-bold text-gray-500 dark:text-slate-400 uppercase tracking-wide block mb-2",children:"Quick Select (or Shift+drag)"}),c.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[c.jsx("span",{className:"text-sm text-gray-600 dark:text-slate-300",children:"Size (px):"}),c.jsx("input",{type:"number",min:"1",value:mn,onChange:Z=>sa(Z.target.value),disabled:!Ke,className:"flex-1 px-2 py-1 bg-white dark:bg-slate-800 border border-gray-300 dark:border-slate-600 rounded-md focus:ring-2 focus:ring-cyan-500 outline-none text-sm text-gray-900 dark:text-slate-100 transition-colors"})]}),c.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[c.jsx("button",{onClick:xl,disabled:!Ke,className:"px-3 py-1.5 bg-gray-200 hover:bg-gray-300 dark:bg-slate-700 dark:hover:bg-slate-600 text-gray-800 dark:text-slate-200 text-xs font-semibold rounded transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:"Center Rect"}),c.jsx("button",{onClick:Wi,disabled:!Ke,className:"px-3 py-1.5 bg-gray-200 hover:bg-gray-300 dark:bg-slate-700 dark:hover:bg-slate-600 text-gray-800 dark:text-slate-200 text-xs font-semibold rounded transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:"Full Image"})]})]})})}),c.jsx(Ps,{title:"Display Controls",children:c.jsxs("div",{className:"space-y-5",children:[c.jsxs("p",{className:"text-gray-500 dark:text-slate-400 text-center text-sm",children:["Adjust parameters and click ",c.jsx("b",{children:"Apply"}),"."]}),c.jsxs("div",{children:[c.jsx("label",{htmlFor:"exposure",className:"text-xs font-bold text-gray-500 dark:text-slate-400 uppercase tracking-wide block mb-2",children:"Exposure (EV)"}),c.jsx("div",{className:"flex items-center gap-2 mb-2",children:c.jsx("input",{type:"range",min:"-5",max:"5",step:"0.1",disabled:!Ke,value:parseFloat(Or)||0,onChange:Z=>Uo(Z.target.value),className:"w-full h-2 bg-gray-300 dark:bg-slate-700 rounded-lg appearance-none cursor-pointer accent-cyan-500 disabled:opacity-50"})}),c.jsx("div",{className:"flex items-center gap-2",children:c.jsx("input",{id:"exposure",type:"number",step:"0.1",value:Or,onChange:Z=>Uo(Z.target.value),disabled:!Ke,className:"w-full px-2 py-1 bg-white dark:bg-slate-800 border border-gray-300 dark:border-slate-600 rounded-md focus:ring-2 focus:ring-cyan-500 outline-none text-sm text-gray-900 dark:text-slate-100 transition-colors duration-300"})})]}),c.jsxs("div",{children:[c.jsx(ch,{checked:Ft,onChange:Z=>{St(),Br(Z)},label:"Highlight Recovery"}),Ft&&c.jsxs("div",{className:"mt-2 pl-2 border-l-2 border-orange-200 dark:border-orange-900 animate-in slide-in-from-top-1",children:[c.jsx("label",{className:"text-[10px] font-bold text-gray-500 dark:text-slate-400 uppercase block mb-1",children:"White Level (Clip Point)"}),c.jsx("input",{type:"number",value:We,onChange:Z=>{St(),xr(Z.target.value)},className:"w-full px-2 py-1 bg-white dark:bg-slate-800 border border-gray-300 dark:border-slate-600 rounded-md focus:ring-2 focus:ring-orange-500 outline-none text-sm text-gray-900 dark:text-slate-100 transition-colors"})]})]}),Ht&&c.jsxs("div",{className:"border-t border-gray-100 dark:border-slate-800 pt-2",children:[c.jsx(ch,{checked:!!B,onChange:Z=>{St(),E&&E(Z),z==null||z(`xtrans ${Z?"on":"off"}`)},label:"Force X-Trans (6x6 -> 2x2)"}),B&&I&&D&&c.jsxs("div",{className:"mt-2 pl-2 border-l-2 border-emerald-500/50 bg-emerald-50/20 dark:bg-emerald-900/10 p-2 rounded",children:[c.jsx("label",{className:"text-[9px] font-bold text-gray-500 dark:text-slate-400 uppercase block mb-1",children:"Phase Offset (Fine Tune)"}),c.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[c.jsxs("div",{className:"flex flex-col",children:[c.jsx("span",{className:"text-[9px] text-gray-400",children:"X (0-5)"}),c.jsx("input",{type:"number",min:"0",max:"5",value:I.x,onChange:Z=>{St();const Oe=Math.min(5,Math.max(0,parseInt(Z.target.value)||0));D({x:Oe}),z==null||z(`xtrans phase ${Oe} ${I.y}`)},className:"w-full text-xs px-1 py-0.5 bg-white dark:bg-slate-800 border border-gray-300 dark:border-slate-600 rounded text-center outline-none focus:border-cyan-500"})]}),c.jsxs("div",{className:"flex flex-col",children:[c.jsx("span",{className:"text-[9px] text-gray-400",children:"Y (0-5)"}),c.jsx("input",{type:"number",min:"0",max:"5",value:I.y,onChange:Z=>{St();const Oe=Math.min(5,Math.max(0,parseInt(Z.target.value)||0));D({y:Oe}),z==null||z(`xtrans phase ${I.x} ${Oe}`)},className:"w-full text-xs px-1 py-0.5 bg-white dark:bg-slate-800 border border-gray-300 dark:border-slate-600 rounded text-center outline-none focus:border-cyan-500"})]})]})]})]}),c.jsxs("div",{className:"space-y-5 pt-2 animate-in slide-in-from-top-2 duration-200 border-t border-gray-200 dark:border-slate-700",children:[c.jsxs("div",{children:[c.jsx(ch,{checked:kn,onChange:Z=>{St(),Yr(Z)},label:"Show k"}),c.jsx("p",{className:"text-[10px] text-gray-400 dark:text-slate-500 mt-1"})]}),c.jsxs("div",{children:[c.jsxs("button",{onClick:kc,disabled:!Ke||!U,className:"w-full mb-3 px-3 py-1.5 bg-cyan-600 hover:bg-cyan-500 text-white text-xs font-bold rounded shadow-sm transition-all active:scale-95 disabled:bg-gray-300 dark:disabled:bg-slate-700 disabled:text-gray-500 dark:disabled:text-gray-500 disabled:cursor-not-allowed disabled:shadow-none flex items-center justify-center gap-2",title:"Calculate Gains to make the selected area neutral gray, accounting for Color Matrix",children:[c.jsx("svg",{className:"w-3.5 h-3.5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 10V3L4 14h7v7l9-11h-7z"})}),"Spot WB (Matrix-Aware)"]}),c.jsx("label",{className:"text-xs font-bold text-gray-500 dark:text-slate-400 uppercase tracking-wide block mb-2",children:"White Balance Gains"}),c.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[c.jsxs("div",{children:[c.jsx("span",{className:"text-xs text-red-500 dark:text-red-400 block mb-1",children:"Red"}),c.jsx("input",{type:"number",step:"0.01",value:dt,onChange:Z=>Rt(Z.target.value),disabled:!Ke,className:"w-full px-2 py-1 bg-white dark:bg-slate-800 border border-gray-300 dark:border-slate-600 rounded-md focus:ring-2 focus:ring-red-500 outline-none text-sm text-gray-900 dark:text-slate-100 transition-colors duration-300"})]}),c.jsxs("div",{children:[c.jsx("span",{className:"text-xs text-blue-500 dark:text-blue-400 block mb-1",children:"Blue"}),c.jsx("input",{type:"number",step:"0.01",value:Lt,onChange:Z=>zo(Z.target.value),disabled:!Ke,className:"w-full px-2 py-1 bg-white dark:bg-slate-800 border border-gray-300 dark:border-slate-600 rounded-md focus:ring-2 focus:ring-blue-500 outline-none text-sm text-gray-900 dark:text-slate-100 transition-colors duration-300"})]})]})]}),c.jsxs("div",{children:[c.jsxs("div",{className:"flex justify-between items-end mb-2",children:[c.jsxs("label",{className:"text-xs font-bold text-gray-500 dark:text-slate-400 uppercase tracking-wide block mb-0 flex items-center",children:["Black Level (4-Ch)",c.jsx("span",{className:"ml-1 text-[10px] text-gray-400 dark:text-slate-500 font-normal normal-case",children:"Native"}),c.jsx("button",{onClick:()=>yt(!0),className:"ml-2 text-[10px] text-cyan-600 dark:text-cyan-400 hover:text-cyan-700 dark:hover:text-cyan-300 hover:underline cursor-pointer transition-colors",title:"About Black Level Settings",children:"[about]"})]}),c.jsxs("div",{className:"flex items-center gap-1.5",title:"Subtract Black Level from ROI Mean stats (for display)",children:[c.jsx("span",{className:"text-[9px] font-mono text-gray-400 dark:text-slate-500 uppercase tracking-wide",children:"Sub. BL"}),c.jsx("div",{className:`relative w-8 h-4 rounded-full cursor-pointer transition-colors duration-200 ease-in-out ${Ar?"bg-cyan-500":"bg-gray-300 dark:bg-slate-700"}`,onClick:()=>{St(),cr(!Ar)},children:c.jsx("div",{className:`absolute top-0.5 left-0.5 bg-white w-3 h-3 rounded-full shadow-sm transform transition-transform duration-200 ${Ar?"translate-x-4":"translate-x-0"}`})})]})]}),c.jsx("input",{type:"text",value:_t,onChange:Z=>{St(),He(Z.target.value)},disabled:!Ke,placeholder:"0 0 0 0",className:"w-full px-2 py-1 bg-white dark:bg-slate-800 border border-gray-300 dark:border-slate-600 rounded-md focus:ring-2 focus:ring-cyan-500 outline-none text-xs font-mono text-gray-900 dark:text-slate-100 transition-colors duration-300",title:"Enter 4 values separated by space or comma"}),c.jsx("p",{className:"text-[10px] text-gray-400 dark:text-slate-500 mt-1",children:"Order: (0,0) (0,1) (1,0) (1,1). Spatial: TL, TR, BL, BR."})]}),c.jsxs("div",{children:[c.jsxs("div",{className:"flex justify-between items-end mb-2",children:[c.jsxs("label",{htmlFor:"customMatrix",className:"text-xs font-bold text-gray-500 dark:text-slate-400 uppercase tracking-wide block flex flex-col gap-1",children:[c.jsx("span",{children:"Custom Color Matrix"}),c.jsx("span",{className:"text-[9px] text-gray-400 dark:text-slate-500 font-normal normal-case",children:"XYZ to Camera RGB (3x3, 9 nums)"})]}),c.jsxs("select",{className:"text-[10px] bg-gray-100 dark:bg-gray-800 border border-black dark:border-gray-500 rounded-none px-1 py-0.5 max-w-[120px] cursor-pointer outline-none text-gray-700 dark:text-gray-300",onChange:Z=>{St();const Oe=hu[Z.target.value];Oe&&Ee(Oe),Z.target.value=""},defaultValue:"",children:[c.jsx("option",{value:"",disabled:!0,children:"Select Camera..."}),yo.map(Z=>c.jsx("option",{value:Z,children:Z},Z))]})]}),c.jsx("textarea",{id:"customMatrix",value:Ce,onChange:Wo,disabled:!Ke,placeholder:"0.66 -0.19 -0.04  -0.46 1.23 0.25  -0.06 0.13 0.65",className:"w-full h-24 px-2 py-2 bg-white dark:bg-slate-800 border border-gray-300 dark:border-slate-600 rounded-md focus:ring-2 focus:ring-cyan-500 outline-none transition-colors disabled:bg-gray-100 dark:disabled:bg-slate-800/50 disabled:cursor-not-allowed text-xs font-mono leading-relaxed text-gray-900 dark:text-slate-100"})]})]}),c.jsxs("div",{className:"pt-4 flex flex-col gap-2",children:[c.jsx("button",{onClick:bl,disabled:!Ke,className:"w-full text-sm font-bold bg-slate-700 hover:bg-slate-600 text-white disabled:bg-gray-300 dark:disabled:bg-slate-800 disabled:text-gray-500 transition-all py-4 rounded-xl flex items-center justify-center border-2 border-slate-500 shadow-lg",title:"Diagnostic Mode. Direct RAW-to-Grayscale mapping using manual Black Level & WB Gains (R/B calibration).",children:c.jsxs("span",{className:"text-center leading-tight",children:["Apply Settings / Render",c.jsx("br",{}),c.jsx("span",{className:"text-xs font-normal opacity-90",children:"Float-safe render path, avoids ROI drift and CM color artifacts"})]})}),c.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[c.jsxs("button",{onClick:()=>Ie(!0),disabled:!Ke,className:"w-full text-xs font-bold bg-black text-gray-400 hover:bg-gray-800 hover:text-gray-300 dark:bg-black dark:text-gray-400 dark:hover:bg-gray-800 dark:hover:text-gray-300 disabled:bg-gray-300 dark:disabled:bg-slate-800 disabled:text-gray-500 disabled:cursor-not-allowed py-3 px-2 rounded-lg transition-all active:scale-95 border border-gray-700",children:["Try Official Render",c.jsx("br",{}),c.jsx("span",{className:"text-[10px] font-normal opacity-75",children:"(Not for analysis)"})]}),c.jsx("button",{onClick:()=>J==null?void 0:J(),disabled:!Ke,className:"w-full text-xs font-bold bg-black text-gray-400 hover:bg-gray-800 hover:text-gray-300 dark:bg-black dark:text-gray-400 dark:hover:bg-gray-800 dark:hover:text-gray-300 disabled:bg-gray-300 dark:disabled:bg-slate-800 disabled:text-gray-500 disabled:cursor-not-allowed transition-all py-3 rounded-lg flex items-center justify-center border border-gray-700 active:scale-95",title:"Manual Lab Workstation: 16-bit Bit Shift and Manual DNG Container Packaging",children:"Generate 16bit DNG"})]}),c.jsx("div",{className:"text-center pt-1",children:c.jsx("button",{onClick:vs,disabled:!Ke,className:"text-xs text-gray-400 hover:text-gray-600 dark:text-slate-400 dark:hover:text-slate-200 disabled:text-gray-300 dark:disabled:text-slate-600 transition-colors underline decoration-gray-300 hover:decoration-gray-600 underline-offset-2",children:"Reset Defaults (Local)"})})]})]})})]}),c.jsx(el,{isOpen:pt,onClose:()=>yt(!1),onConfirm:()=>{window.open("https://y-g-jiang.github.io/CBLD.html","_blank"),yt(!1)},title:"Black Level Info / ",confirmText:"Visit Database (CBLD)",cancelText:"Close",message:c.jsxs("div",{className:"flex flex-col gap-4 text-left text-sm text-gray-600 dark:text-slate-300",children:[c.jsx("p",{className:"leading-relaxed",children:"JiangBridge  CBLD "}),c.jsx("div",{className:"h-px bg-gray-200 dark:bg-slate-700 w-full"}),c.jsx("p",{className:"leading-relaxed",children:"For best accuracy, capture a dark frame with the same ISO/shutter and measure the center ROI in this app."})]})}),c.jsx(el,{isOpen:Tt,onClose:()=>Et(!1),onConfirm:()=>{},title:"Select Zero-Dependency Mode",confirmText:"",cancelText:"",message:c.jsxs("div",{className:"flex flex-col gap-4",children:[c.jsx("div",{className:"text-gray-600 dark:text-slate-300 text-left text-sm leading-relaxed mb-2",children:"Select how you want to visualize the raw data without full JOraw processing."}),c.jsxs("div",{className:"flex justify-between items-center mb-2 px-1",children:[c.jsx("span",{className:"text-xs font-bold text-gray-500 dark:text-slate-400 uppercase",children:"Bayer Pattern"}),c.jsxs("div",{className:"flex bg-gray-100 dark:bg-slate-800 p-1 rounded-lg border border-gray-200 dark:border-slate-700",children:[c.jsx("button",{onClick:()=>Ir(!1),className:`px-3 py-1 text-[10px] font-bold rounded transition-all ${Mt?"text-gray-500 dark:text-slate-400":"bg-white dark:bg-slate-600 text-cyan-600 dark:text-cyan-400 shadow-sm"}`,children:"RGGB"}),c.jsx("button",{onClick:()=>Ir(!0),className:`px-3 py-1 text-[10px] font-bold rounded transition-all ${Mt?"bg-white dark:bg-slate-600 text-cyan-600 dark:text-cyan-400 shadow-sm":"text-gray-500 dark:text-slate-400"}`,children:"BGGR"})]})]}),c.jsxs("div",{className:"flex justify-between items-center mb-2 px-1",children:[c.jsx("span",{className:"text-xs font-bold text-gray-500 dark:text-slate-400 uppercase",children:"Color Demosaic"}),c.jsxs("div",{className:"flex bg-gray-100 dark:bg-slate-800 p-1 rounded-lg border border-gray-200 dark:border-slate-700",children:[c.jsx("button",{onClick:()=>Cr("bilinear"),className:`px-3 py-1 text-[10px] font-bold rounded transition-all ${gr==="bilinear"?"bg-white dark:bg-slate-600 text-cyan-600 dark:text-cyan-400 shadow-sm":"text-gray-500 dark:text-slate-400"}`,children:"Bilinear (Default)"}),c.jsx("button",{onClick:()=>Cr("edge-aware"),className:`px-3 py-1 text-[10px] font-bold rounded transition-all ${gr==="edge-aware"?"bg-white dark:bg-slate-600 text-cyan-600 dark:text-cyan-400 shadow-sm":"text-gray-500 dark:text-slate-400"}`,children:"Edge-Aware"})]})]}),c.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[c.jsxs("button",{onClick:()=>wl("mosaic"),className:"flex flex-col items-center justify-center p-4 bg-gray-100 hover:bg-gray-200 dark:bg-slate-800 dark:hover:bg-slate-700 border-2 border-transparent hover:border-gray-400 dark:hover:border-slate-500 rounded-xl transition-all group",children:[c.jsx("div",{className:"w-12 h-12 bg-gray-300 dark:bg-slate-600 rounded-full flex items-center justify-center mb-3 group-hover:scale-110 transition-transform",children:c.jsx("svg",{className:"w-6 h-6 text-gray-600 dark:text-slate-300",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2H6a2 2 0 01-2-2V6zM14 6a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2V6zM4 16a2 2 0 012-2h2a2 2 0 01-2 2H6a2 2 0 01-2-2v-2zM14 16a2 2 0 012-2h2a2 2 0 01-2 2h-2a2 2 0 01-2-2v-2z"})})}),c.jsx("span",{className:"font-bold text-gray-800 dark:text-slate-200",children:"Raw Mosaic"}),c.jsx("span",{className:"text-xs text-gray-500 dark:text-slate-400 mt-1",children:"Grayscale checkerboard"})]}),c.jsxs("button",{onClick:()=>wl("color"),className:"flex flex-col items-center justify-center p-4 bg-gray-100 hover:bg-gray-200 dark:bg-slate-800 dark:hover:bg-slate-700 border-2 border-transparent hover:border-cyan-400 dark:hover:border-cyan-500 rounded-xl transition-all group",children:[c.jsx("div",{className:"w-12 h-12 bg-cyan-100 dark:bg-cyan-900/30 rounded-full flex items-center justify-center mb-3 group-hover:scale-110 transition-transform",children:c.jsx("svg",{className:"w-6 h-6 text-cyan-600 dark:text-cyan-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M7 21a4 4 0 01-4-4V5a2 2 0 012-2h4a2 2 0 012 2v12a4 4 0 01-4 4zm0 0h12a2 2 0 002-2v-4a2 2 0 00-2-2h-2.343M11 7.343l1.657-1.657a2 2 0 012.828 0l2.829 2.829a2 2 0 010 2.828l-8.486 8.485M7 17h.01"})})}),c.jsx("span",{className:"font-bold text-cyan-700 dark:text-cyan-400",children:"Basic Color"}),c.jsx("span",{className:"text-xs text-gray-500 dark:text-slate-400 mt-1",children:gr==="edge-aware"?"Edge-Aware Demosaic + WB + Matrix":"Bilinear Demosaic + WB + Matrix"})]})]})]})}),c.jsx(el,{isOpen:Lr,onClose:()=>Ie(!1),onConfirm:()=>{xo(),Ie(!1)},title:"Official Render Options",confirmText:"Render",message:c.jsxs("div",{className:"flex flex-col gap-4 text-left",children:[c.jsx("p",{className:"text-sm text-gray-600 dark:text-slate-300",children:"Select a demosaicing algorithm for the standard render pipeline."}),c.jsxs("div",{children:[c.jsx("label",{htmlFor:"demosaic-modal",className:"text-xs font-bold text-gray-500 dark:text-slate-400 uppercase tracking-wide block mb-2",children:"Demosaic Method"}),c.jsx("select",{id:"demosaic-modal",value:Kr,onChange:It,disabled:!Ke||O||(t==null?void 0:t.isXTrans),className:"w-full px-2 py-2 bg-white dark:bg-slate-800 border border-gray-300 dark:border-slate-600 rounded-md focus:ring-2 focus:ring-cyan-500 outline-none transition-colors disabled:bg-gray-100 dark:disabled:bg-slate-800/50 disabled:cursor-not-allowed text-sm text-gray-900 dark:text-slate-100",children:I8.map(Z=>c.jsx("option",{value:Z.value,children:Z.label},Z.value))}),O&&c.jsx("p",{className:"text-[9px] text-gray-400 mt-1",children:"Full color data detected. Demosaicing skipped."}),(t==null?void 0:t.isXTrans)&&c.jsx("p",{className:"text-[9px] text-amber-500 mt-1",children:"X-Trans detected. Please enable Pseudo-Bayer conversion first."})]})]})})]})},D8=_.forwardRef((e,t)=>{const{rawImageData:r,displaySettings:n,onApplyDisplaySettings:a,onSetSelection:i,onStartMarking:o,onGenerateTestPic:s,onBatchDrLab:l,onProcessPair:u,onProcessBatchDiff:d,onProcessStackFft:f,onOpenCrossCalc:h,onToggleXTrans:g,onXTransPhaseChange:b}=e,[w,v]=_.useState([{id:"init",type:"info",text:'Jiangtherapee CLI v1.0. Type "help" for commands.'}]),[x,m]=_.useState(""),[k,P]=_.useState([]),[j,S]=_.useState(-1),M=_.useRef(null),O=_.useRef(null),E=_.useRef(null),I=_.useRef(null),D=_.useRef(null),B=_.useRef(null),z=_.useRef(null),Y=_.useRef(null);_.useRef(null);const G=_.useRef({...n});_.useEffect(()=>{G.current={...n}},[n.exposure,n.demosaicMethod]);const $=_.useRef({fileA:null,fileB:null});_.useLayoutEffect(()=>{M.current&&(M.current.scrollTop=M.current.scrollHeight)},[w]);const L=(te,ee="out")=>{v(me=>[...me,{id:Date.now().toString()+Math.random(),type:ee,text:te}])};_.useImperativeHandle(t,()=>({log:(te,ee="in")=>{const me=ee;let re=te;ee==="in"&&!te.startsWith(">")&&(re=`> ${te}`),L(re,me)}}));const U=_.useRef(null);_.useEffect(()=>{if(e.roiStats&&e.roiStats!==U.current){const te=e.roiStats,ee=Math.round(te.x),me=Math.round(te.y),re=Math.round(te.width),De=Math.round(te.height);L(`> sel ${ee} ${me} ${re} ${De}`,"in");const fe=e.isBGGR?[{name:"B",idx:0},{name:"G1",idx:1},{name:"G2",idx:2},{name:"R",idx:3}]:[{name:"R",idx:0},{name:"G1",idx:1},{name:"G2",idx:2},{name:"B",idx:3}],le=c.jsxs("div",{className:"font-mono text-xs mt-1 mb-2",children:[c.jsxs("div",{className:"text-gray-400 mb-1",children:["Region Stats [",ee,", ",me,", ",re,"x",De,"]:"]}),c.jsxs("div",{className:"grid grid-cols-[30px_1fr_1fr] gap-x-2 border-b border-gray-700 pb-1 mb-1 text-gray-500 font-bold",children:[c.jsx("div",{children:"Ch"}),c.jsx("div",{className:"text-right",children:"Mean"}),c.jsx("div",{className:"text-right",children:"StdDev"})]}),fe.map(de=>c.jsxs("div",{className:"grid grid-cols-[30px_1fr_1fr] gap-x-2 hover:bg-gray-900",children:[c.jsx("div",{className:de.name==="R"?"text-red-500":de.name==="B"?"text-blue-500":"text-green-500",children:de.name}),c.jsx("div",{className:"text-right text-gray-300",children:te.means[de.idx].toFixed(2)}),c.jsx("div",{className:"text-right text-gray-400",children:te.stdDevs[de.idx].toFixed(2)})]},de.name))]});L(le,"out"),U.current=te}},[e.roiStats,e.isBGGR]);const V=te=>{var De,fe,le,de,Se,he,Pe;const ee=te.trim().split(/\s+/),me=ee[0].toLowerCase(),re=ee.slice(1);switch(me){case"help":L("Available Commands:","info"),L("  ev <val>          Set Exposure (e.g. ev 1.5)","info"),L("  wb <r> <b>        Set WB Gains","info"),L("  bl <r> <g>...     Set Black Level (1 or 4 vals)","info"),L("  demo <id>         Demosaic (0=Lin, 3=AHD, -1=Raw)","info"),L("  matrix <n1..n9>   Set Custom Color Matrix","info"),L("  xtrans <on|off>   Force X-Trans Mode","info"),L("  xtrans phase <x> <y>  Set X-Trans Phase","info"),L("  render            Apply settings & Render","info"),L("  render zero       Zero-Dependency Render","info"),L("  render unmix      Advanced Unmixing Render","info"),L("  sel <full|center> Select ROI","info"),L("  sel <x> <y> <w> <h> Select ROI manually","info"),L("  mark              Start DR Lab Corner Marking","info"),L("  gen test          Generate Test Pattern","info"),L("  fft load <a>      Load FFT Pair Image A","info"),L("  fft load <b>      Load FFT Pair Image B","info"),L("  fft run           Run FFT Pair Diff","info"),L("  cls               Clear Screen","info");break;case"cls":case"clear":v([]);break;case"ev":case"exposure":if(re.length<1){L(`Current EV: ${G.current.exposure}`,"info");return}const ve=parseFloat(re[0]);if(isNaN(ve)){L("Invalid EV value","err");return}G.current.exposure=ve,L(`EV set to ${ve} (run 'render' to apply)`);break;case"wb":if(re.length<2){L("Usage: wb <red_gain> <blue_gain>","err");return}const ye=parseFloat(re[0]),ge=parseFloat(re[1]);if(isNaN(ye)||isNaN(ge)){L("Invalid gains","err");return}G.current.wbGains=[ye,ge],L(`WB set to R:${ye} B:${ge}`);break;case"bl":case"black":if(re.length===0){L(`Current BL: ${((De=G.current.blackLevel)==null?void 0:De.join(" "))||"Auto"}`,"info");return}let ue=re.map(Number);if(ue.some(isNaN)){L("Invalid numbers","err");return}if(ue.length===1&&(ue=[ue[0],ue[0],ue[0],ue[0]]),ue.length<4){L("Need 1 or 4 values","err");return}G.current.blackLevel=[ue[0],ue[1],ue[2],ue[3]],G.current.subtractBlackLevelFromStats=!0,G.current.showKadc=!0,L(`Black Level set: ${ue.slice(0,4).join(" ")}`);break;case"demo":case"demosaic":if(re.length===0){L("Usage: demo <id> (0=Lin, 1=VNG, 2=PPG, 3=AHD, 4=DCB, 11=DHT, 12=AAHD, -1=Raw)","info");return}const Le=parseInt(re[0]);if(isNaN(Le)){L("Invalid method ID","err");return}G.current.demosaicMethod=Le,L(`Demosaic set to ID ${Le}`);break;case"matrix":if(re.length!==9){L("Usage: matrix m1 m2 m3 m4 m5 m6 m7 m8 m9 (3x3)","err");return}const rt=re.map(Number);if(rt.some(isNaN)){L("Invalid matrix values","err");return}G.current.customMatrix=rt,L("Custom Color Matrix set.");break;case"xtrans":if(re[0]==="on"||re[0]==="true")g?(g(!0),L("X-Trans conversion ON")):L("Feature not available","err");else if(re[0]==="off"||re[0]==="false")g?(g(!1),L("X-Trans conversion OFF")):L("Feature not available","err");else if(re[0]==="phase"){if(re.length<3){L("Usage: xtrans phase <x> <y>","err");return}const et=parseInt(re[1]),tt=parseInt(re[2]);b&&(b({x:et,y:tt}),L(`X-Trans Phase set to (${et}, ${tt})`))}else L("Usage: xtrans <on|off> OR xtrans phase <x> <y>","err");break;case"render":case"apply":if(re[0]==="zero"){const et=re[1]==="color"?"zero-dep-color":"zero-dependency";G.current.renderMode=et,L(`Rendering Zero-Dependency (${et})...`)}else if(re[0]==="unmix"){if(re.length<13){L("Usage: render unmix <4xBL> <4xBG> <4xFG>","err");return}const et=re.slice(1).map(Number);if(et.some(isNaN)){L("Invalid params","err");return}G.current.renderMode="advanced-zero-dep",G.current.advancedZeroDep={bl:[et[0],et[1],et[2],et[3]],bg:[et[4],et[5],et[6],et[7]],fg:[et[8],et[9],et[10],et[11]]},L("Rendering Advanced Unmix...")}else G.current.renderMode="standard",L("Rendering Standard Pipeline...");a({...G.current});break;case"sel":case"select":if(!r||!i){L("No image loaded","err");return}if(re[0]==="full")i({x:0,y:0,w:r.width,h:r.height});else if(re[0]==="center"){const et=parseInt(re[1])||64,tt=Math.floor((r.width-et)/2),ft=Math.floor((r.height-et)/2);i({x:tt,y:ft,w:et,h:et})}else if(re.length===4){const[et,tt,ft,wt]=re.map(Number);if([et,tt,ft,wt].some(isNaN)){L("Invalid coordinates","err");return}i({x:et,y:tt,w:ft,h:wt})}else L("Usage: sel full | sel center <size> | sel <x> <y> <w> <h>","err");break;case"mark":o&&(o(),L("Interactive marking started. Click 4 corners on canvas."));break;case"gen":(re[0]==="test"||re[0]==="pattern")&&s&&(s(),L("Generated Test Pattern"));break;case"drlab":if(re[0]==="config"){const[et,tt,ft]=re.slice(1).map(Number);e.onDrRoiSizeChange&&e.onDrRoiSizeChange(et||64),e.onDrGridRowsChange&&e.onDrGridRowsChange(tt||10),e.onDrGridColsChange&&e.onDrGridColsChange(ft||10),L(`DR Grid Configured: Size=${et}, Grid=${tt}x${ft}`)}else re[0]==="batch"&&(re[1]==="pair"?(L("Select file pairs for DR Lab..."),(fe=I.current)==null||fe.click()):(L("Select single files for DR Lab..."),(le=E.current)==null||le.click()));break;case"fft":re[0]==="load"?re[1]==="a"?(de=D.current)==null||de.click():re[1]==="b"?(Se=B.current)==null||Se.click():L("Usage: fft load <a|b>","err"):re[0]==="run"?$.current.fileA&&$.current.fileB&&u?(L(`Processing Pair: ${$.current.fileA.name} - ${$.current.fileB.name}`),u($.current.fileA,$.current.fileB,!1,!0)):L("Load both A and B first","err"):re[0]==="stack"?(L("Select files for Stack FFT..."),(he=z.current)==null||he.click()):re[0]==="batch"&&(L("Select files for Batch Diff...","info"),(Pe=Y.current)==null||Pe.click());break;case"crosscalc":h&&(h(),L("Opened Cross-Calculator"));break;default:L(`Unknown command: ${me}`,"err")}},J=te=>{if(te.key==="Enter"){const ee=x.trim();if(!ee)return;L(`> ${ee}`,"in"),ee.split(";").forEach(re=>{re.trim()&&V(re.trim())}),P(re=>[...re,ee]),S(-1),m("")}else if(te.key==="ArrowUp"){if(te.preventDefault(),k.length>0){const ee=j===-1?k.length-1:Math.max(0,j-1);S(ee),m(k[ee])}}else if(te.key==="ArrowDown")if(te.preventDefault(),j!==-1){const ee=Math.min(k.length-1,j+1);S(ee),m(k[ee])}else m("")},K=(te,ee)=>{te.target.files&&te.target.files.length>0&&l&&(L(`Batch processing ${te.target.files.length} files in ${ee} mode...`),l(te.target.files,ee)),te.target.value=""},Q=(te,ee)=>{var re;const me=(re=te.target.files)==null?void 0:re[0];me&&(ee==="A"?$.current.fileA=me:$.current.fileB=me,L(`Loaded ${ee}: ${me.name}`)),te.target.value=""};return c.jsxs("div",{className:"flex flex-col h-full bg-black text-green-500 font-mono text-sm border-l-4 border-gray-700 p-2 shadow-2xl",children:[c.jsxs("div",{className:"border-b border-green-800 pb-2 mb-2 flex justify-between items-end select-none",children:[c.jsx("h2",{className:"text-xl font-bold tracking-widest",children:"TERMINAL"}),c.jsx("div",{className:"text-[10px] text-green-700",children:"JIANGTHERAPEE_CLI_V1"})]}),c.jsx("div",{ref:M,className:"flex-grow overflow-y-auto overflow-x-hidden break-words mb-2 pr-1 scrollbar-thin scrollbar-thumb-green-900 scrollbar-track-black",children:w.map(te=>c.jsxs("div",{className:`mb-1 ${te.type==="in"?"opacity-50":""} ${te.type==="err"?"text-red-500":""} ${te.type==="info"?"text-cyan-400":""}`,children:[te.type!=="in"&&typeof te.text=="string"&&!te.text.startsWith(">")&&c.jsx("span",{className:"mr-2 opacity-50",children:">"}),te.text]},te.id))}),c.jsxs("div",{className:"relative flex items-center border-t border-green-800 pt-2",children:[c.jsx("span",{className:"text-green-500 mr-2 animate-pulse font-bold",children:">"}),c.jsx("input",{ref:O,type:"text",value:x,onChange:te=>m(te.target.value),onKeyDown:J,autoFocus:!0,className:"w-full bg-transparent border-none outline-none text-green-400 placeholder-green-900",placeholder:"Enter command (e.g. 'help')",spellCheck:!1,autoComplete:"off"})]}),c.jsx("input",{type:"file",ref:E,className:"hidden",multiple:!0,onChange:te=>K(te,"single")}),c.jsx("input",{type:"file",ref:I,className:"hidden",multiple:!0,onChange:te=>K(te,"pair")}),c.jsx("input",{type:"file",ref:D,className:"hidden",onChange:te=>Q(te,"A")}),c.jsx("input",{type:"file",ref:B,className:"hidden",onChange:te=>Q(te,"B")}),c.jsx("input",{type:"file",ref:z,className:"hidden",multiple:!0,onChange:te=>{e.onProcessStackFft&&te.target.files&&(L(`Loading ${te.target.files.length} frames for Stack FFT...`),e.onProcessStackFft(te.target.files)),te.target.value=""}}),c.jsx("input",{type:"file",ref:Y,className:"hidden",multiple:!0,onChange:te=>{e.onProcessBatchDiff&&te.target.files&&(L("Starting Batch Diff..."),e.onProcessBatchDiff(te.target.files)),te.target.value=""}})]})}),R8=(e,t)=>{if(!e)return null;if(t){const r=e.bayerPattern.toUpperCase(),n=l=>{const u=[];for(let d=0;d<4;d++)r[d]===l&&u.push(d);return u},a=t.BlackLevelRed,i=t.BlackLevelGreen,o=t.BlackLevelBlue;if(a!==void 0&&i!==void 0&&o!==void 0){const l=parseFloat(a),u=parseFloat(i),d=parseFloat(o);if(!isNaN(l)&&!isNaN(u)&&!isNaN(d)){const f=[0,0,0,0];if(f.fill(u),n("R").forEach(h=>f[h]=l),n("G").forEach(h=>f[h]=u),n("B").forEach(h=>f[h]=d),f.some(h=>h>0))return f}}let s=t.BlackLevel;if(s===void 0&&(s=t.BlackLevel2),s!==void 0){let l=[];if(Array.isArray(s)?l=s.map(Number):typeof s=="string"?l=s.trim().split(/\s+/).map(Number):typeof s=="number"&&(l=[s,s,s,s]),l.length===1&&!isNaN(l[0])&&(l=[l[0],l[0],l[0],l[0]]),l.length>=4&&!l.slice(0,4).some(isNaN)&&l.some(u=>u>0))return[l[0],l[1],l[2],l[3]]}}return e.blackLevels&&e.blackLevels.length===4?[e.blackLevels[0],e.blackLevels[1],e.blackLevels[2],e.blackLevels[3]]:null},B8=e=>{const[t,r]=_.useState("gui"),{rawImageData:n,exifData:a,isBridgeConnected:i,displaySettings:o,onApplyDisplaySettings:s}=e,l=_.useRef(null),u=_.useRef(o);_.useEffect(()=>{u.current=o},[o]);const d=_.useRef(!1),f=_.useRef(null);_.useEffect(()=>{n!==f.current&&(d.current=!1,f.current=n)},[n]),_.useEffect(()=>{var k;if(!i||!n||d.current)return;const g=R8(n,a);if(!(!!g&&g.some(P=>P>0))||!g)return;const w=u.current,v=w.blackLevel;if(!!v&&v.some(P=>P>0)){d.current=!0;return}d.current=!0,console.log("[AutoApply] Detected Black Levels via Bridge:",g),(k=l.current)==null||k.log(`Auto-detected BL: ${g.join(" ")}`,"info");const m={...w,blackLevel:g};s(m)},[i,n,a,s]);const h=_.useCallback(g=>{var b;(b=l.current)==null||b.log(g,"in")},[]);return c.jsxs("div",{className:"flex flex-col h-full",children:[c.jsxs("div",{className:"flex bg-gray-200 dark:bg-gray-800 p-1 border-b border-gray-300 dark:border-gray-700 flex-shrink-0",children:[c.jsx("button",{onClick:()=>r("gui"),className:`flex-1 py-1 text-xs font-bold uppercase tracking-wider transition-colors border-r border-gray-300 dark:border-gray-700 ${t==="gui"?"bg-white dark:bg-black shadow-inner text-cyan-600 dark:text-cyan-400":"bg-gray-200 dark:bg-gray-900 text-gray-500 hover:text-gray-700 dark:hover:text-gray-300"}`,children:"GUI"}),c.jsx("button",{onClick:()=>r("terminal"),className:`flex-1 py-1 text-xs font-bold uppercase tracking-wider transition-colors ${t==="terminal"?"bg-black text-green-500 shadow-inner":"bg-gray-200 dark:bg-gray-900 text-gray-500 hover:text-gray-700 dark:hover:text-gray-300"}`,children:"Terminal"})]}),c.jsxs("div",{className:"flex-grow overflow-hidden relative",children:[c.jsx("div",{className:`h-full w-full ${t==="gui"?"block":"hidden"}`,children:c.jsx($8,{...e,onCommand:h})}),c.jsx("div",{className:`h-full w-full ${t==="terminal"?"block":"hidden"}`,children:c.jsx(D8,{...e,ref:l})})]})]})},L8=()=>c.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M20 12H4"})}),F8=()=>c.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 4v16m8-8H4"})}),G8=()=>c.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M4 4v5h5M4 12a8 8 0 0114.24-5.12M20 20v-5h-5M20 12a8 8 0 01-14.24 5.12"})}),U8=()=>c.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M7 11.5V14m0-2.5v-6a1.5 1.5 0 113 0m-3 6a1.5 1.5 0 00-3 0v2a7.5 7.5 0 0015 0v-5a1.5 1.5 0 00-3 0m-6-3V11m0-5.5v-1a1.5 1.5 0 013 0v1m0 0V11m0-5.5a1.5 1.5 0 013 0v3m0 0V11"})}),z8=()=>c.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M4 8V4m0 0h4M4 4l5 5m11-1V4m0 0h-4m4 4l-5 5M4 16v4m0 0h4m-4 0l5-5m11 5l-5-5m5 5v-4m0 4h-4"})}),fv=.1,hv=16,W8=Math.log(fv),H8=Math.log(hv),V8=({zoom:e,onZoomChange:t,onResetView:r,touchAction:n,onToggleTouchAction:a})=>{const i=u=>{const d=parseFloat(u.target.value),f=Math.exp(d);t(Math.max(fv,Math.min(hv,f)))},o=()=>{t(Math.min(hv,e*1.25))},s=()=>{t(Math.max(fv,e/1.25))},l=Math.log(e);return c.jsxs("div",{className:"absolute top-4 right-4 flex gap-2",onClick:u=>u.stopPropagation(),children:[c.jsx("div",{className:"bg-white/90 dark:bg-slate-800/70 backdrop-blur-sm p-2 rounded-lg border border-gray-200 dark:border-slate-700 flex items-center shadow-lg transition-colors duration-300",children:c.jsx("button",{onClick:a,className:`p-1.5 rounded-md transition-colors flex items-center justify-center ${n==="select"?"bg-cyan-100 text-cyan-600 dark:bg-cyan-900/50 dark:text-cyan-400 ring-2 ring-cyan-500/50":"text-gray-500 dark:text-slate-400 hover:bg-gray-100 dark:hover:bg-slate-700"}`,title:n==="select"?"Mode: Selection (Drag to Select)":"Mode: Pan (Drag to Move)",children:n==="select"?c.jsx(z8,{}):c.jsx(U8,{})})}),c.jsxs("div",{className:"bg-white/90 dark:bg-slate-800/70 backdrop-blur-sm p-2 rounded-lg border border-gray-200 dark:border-slate-700 flex items-center gap-2 text-gray-700 dark:text-slate-300 shadow-lg transition-colors duration-300",children:[c.jsx("button",{onClick:s,className:"p-1 rounded-md hover:bg-gray-100 dark:hover:bg-slate-700 transition-colors",title:"Zoom Out","aria-label":"Zoom Out",children:c.jsx(L8,{})}),c.jsx("input",{type:"range",min:W8,max:H8,step:"0.01",value:l,onChange:i,className:"w-24 sm:w-32 h-2 bg-gray-300 dark:bg-slate-700 rounded-lg appearance-none cursor-pointer accent-cyan-500","aria-label":"Zoom slider"}),c.jsx("button",{onClick:o,className:"p-1 rounded-md hover:bg-gray-100 dark:hover:bg-slate-700 transition-colors",title:"Zoom In","aria-label":"Zoom In",children:c.jsx(F8,{})}),c.jsxs("span",{className:"w-16 text-center font-mono text-sm","aria-live":"polite",children:[(e*100).toFixed(0),"%"]}),c.jsx("button",{onClick:r,className:"p-1 rounded-md hover:bg-gray-100 dark:hover:bg-slate-700 transition-colors",title:"Reset View","aria-label":"Reset View",children:c.jsx(G8,{})})]})]})},X8=({theme:e,setTheme:t})=>{const r=()=>{t(e==="light"?"dark":"light")};return c.jsx("button",{onClick:r,className:"fixed bottom-6 right-6 z-50 p-3 rounded-full bg-white dark:bg-slate-800 border border-gray-200 dark:border-slate-700 shadow-lg text-gray-800 dark:text-yellow-400 hover:bg-gray-100 dark:hover:bg-slate-700 transition-all duration-300",title:`Switch to ${e==="light"?"dark":"light"} mode`,children:e==="light"?c.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6 text-slate-700",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003 0 0012 21a9.003 9.003 0 008.354-5.646z"})}):c.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z"})})})};function H_(e){var t,r,n="";if(typeof e=="string"||typeof e=="number")n+=e;else if(typeof e=="object")if(Array.isArray(e)){var a=e.length;for(t=0;t<a;t++)e[t]&&(r=H_(e[t]))&&(n&&(n+=" "),n+=r)}else for(r in e)e[r]&&(n&&(n+=" "),n+=r);return n}function kr(){for(var e,t,r=0,n="",a=arguments.length;r<a;r++)(e=arguments[r])&&(t=H_(e))&&(n&&(n+=" "),n+=t);return n}var K8=Array.isArray,ci=K8,Y8=typeof R0=="object"&&R0&&R0.Object===Object&&R0,V_=Y8,q8=V_,Z8=typeof self=="object"&&self&&self.Object===Object&&self,J8=q8||Z8||Function("return this")(),Fo=J8,Q8=Fo,eE=Q8.Symbol,y0=eE,Zk=y0,X_=Object.prototype,tE=X_.hasOwnProperty,rE=X_.toString,Md=Zk?Zk.toStringTag:void 0;function nE(e){var t=tE.call(e,Md),r=e[Md];try{e[Md]=void 0;var n=!0}catch{}var a=rE.call(e);return n&&(t?e[Md]=r:delete e[Md]),a}var aE=nE,iE=Object.prototype,oE=iE.toString;function sE(e){return oE.call(e)}var lE=sE,Jk=y0,cE=aE,uE=lE,dE="[object Null]",fE="[object Undefined]",Qk=Jk?Jk.toStringTag:void 0;function hE(e){return e==null?e===void 0?fE:dE:Qk&&Qk in Object(e)?cE(e):uE(e)}var ms=hE;function pE(e){return e!=null&&typeof e=="object"}var ys=pE,gE=ms,mE=ys,yE="[object Symbol]";function xE(e){return typeof e=="symbol"||mE(e)&&gE(e)==yE}var Xu=xE,vE=ci,bE=Xu,wE=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,kE=/^\w*$/;function SE(e,t){if(vE(e))return!1;var r=typeof e;return r=="number"||r=="symbol"||r=="boolean"||e==null||bE(e)?!0:kE.test(e)||!wE.test(e)||t!=null&&e in Object(t)}var Qb=SE;function jE(e){var t=typeof e;return e!=null&&(t=="object"||t=="function")}var ul=jE;const Ku=on(ul);var PE=ms,_E=ul,CE="[object AsyncFunction]",ME="[object Function]",NE="[object GeneratorFunction]",OE="[object Proxy]";function AE(e){if(!_E(e))return!1;var t=PE(e);return t==ME||t==NE||t==CE||t==OE}var e2=AE;const tr=on(e2);var TE=Fo,EE=TE["__core-js_shared__"],IE=EE,Ty=IE,eS=function(){var e=/[^.]+$/.exec(Ty&&Ty.keys&&Ty.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}();function $E(e){return!!eS&&eS in e}var DE=$E,RE=Function.prototype,BE=RE.toString;function LE(e){if(e!=null){try{return BE.call(e)}catch{}try{return e+""}catch{}}return""}var K_=LE,FE=e2,GE=DE,UE=ul,zE=K_,WE=/[\\^$.*+?()[\]{}|]/g,HE=/^\[object .+?Constructor\]$/,VE=Function.prototype,XE=Object.prototype,KE=VE.toString,YE=XE.hasOwnProperty,qE=RegExp("^"+KE.call(YE).replace(WE,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function ZE(e){if(!UE(e)||GE(e))return!1;var t=FE(e)?qE:HE;return t.test(zE(e))}var JE=ZE;function QE(e,t){return e==null?void 0:e[t]}var eI=QE,tI=JE,rI=eI;function nI(e,t){var r=rI(e,t);return tI(r)?r:void 0}var yc=nI,aI=yc,iI=aI(Object,"create"),Vg=iI,tS=Vg;function oI(){this.__data__=tS?tS(null):{},this.size=0}var sI=oI;function lI(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t}var cI=lI,uI=Vg,dI="__lodash_hash_undefined__",fI=Object.prototype,hI=fI.hasOwnProperty;function pI(e){var t=this.__data__;if(uI){var r=t[e];return r===dI?void 0:r}return hI.call(t,e)?t[e]:void 0}var gI=pI,mI=Vg,yI=Object.prototype,xI=yI.hasOwnProperty;function vI(e){var t=this.__data__;return mI?t[e]!==void 0:xI.call(t,e)}var bI=vI,wI=Vg,kI="__lodash_hash_undefined__";function SI(e,t){var r=this.__data__;return this.size+=this.has(e)?0:1,r[e]=wI&&t===void 0?kI:t,this}var jI=SI,PI=sI,_I=cI,CI=gI,MI=bI,NI=jI;function Yu(e){var t=-1,r=e==null?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}Yu.prototype.clear=PI;Yu.prototype.delete=_I;Yu.prototype.get=CI;Yu.prototype.has=MI;Yu.prototype.set=NI;var OI=Yu;function AI(){this.__data__=[],this.size=0}var TI=AI;function EI(e,t){return e===t||e!==e&&t!==t}var t2=EI,II=t2;function $I(e,t){for(var r=e.length;r--;)if(II(e[r][0],t))return r;return-1}var Xg=$I,DI=Xg,RI=Array.prototype,BI=RI.splice;function LI(e){var t=this.__data__,r=DI(t,e);if(r<0)return!1;var n=t.length-1;return r==n?t.pop():BI.call(t,r,1),--this.size,!0}var FI=LI,GI=Xg;function UI(e){var t=this.__data__,r=GI(t,e);return r<0?void 0:t[r][1]}var zI=UI,WI=Xg;function HI(e){return WI(this.__data__,e)>-1}var VI=HI,XI=Xg;function KI(e,t){var r=this.__data__,n=XI(r,e);return n<0?(++this.size,r.push([e,t])):r[n][1]=t,this}var YI=KI,qI=TI,ZI=FI,JI=zI,QI=VI,e$=YI;function qu(e){var t=-1,r=e==null?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}qu.prototype.clear=qI;qu.prototype.delete=ZI;qu.prototype.get=JI;qu.prototype.has=QI;qu.prototype.set=e$;var Kg=qu,t$=yc,r$=Fo,n$=t$(r$,"Map"),r2=n$,rS=OI,a$=Kg,i$=r2;function o$(){this.size=0,this.__data__={hash:new rS,map:new(i$||a$),string:new rS}}var s$=o$;function l$(e){var t=typeof e;return t=="string"||t=="number"||t=="symbol"||t=="boolean"?e!=="__proto__":e===null}var c$=l$,u$=c$;function d$(e,t){var r=e.__data__;return u$(t)?r[typeof t=="string"?"string":"hash"]:r.map}var Yg=d$,f$=Yg;function h$(e){var t=f$(this,e).delete(e);return this.size-=t?1:0,t}var p$=h$,g$=Yg;function m$(e){return g$(this,e).get(e)}var y$=m$,x$=Yg;function v$(e){return x$(this,e).has(e)}var b$=v$,w$=Yg;function k$(e,t){var r=w$(this,e),n=r.size;return r.set(e,t),this.size+=r.size==n?0:1,this}var S$=k$,j$=s$,P$=p$,_$=y$,C$=b$,M$=S$;function Zu(e){var t=-1,r=e==null?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}Zu.prototype.clear=j$;Zu.prototype.delete=P$;Zu.prototype.get=_$;Zu.prototype.has=C$;Zu.prototype.set=M$;var n2=Zu,Y_=n2,N$="Expected a function";function a2(e,t){if(typeof e!="function"||t!=null&&typeof t!="function")throw new TypeError(N$);var r=function(){var n=arguments,a=t?t.apply(this,n):n[0],i=r.cache;if(i.has(a))return i.get(a);var o=e.apply(this,n);return r.cache=i.set(a,o)||i,o};return r.cache=new(a2.Cache||Y_),r}a2.Cache=Y_;var q_=a2;const O$=on(q_);var A$=q_,T$=500;function E$(e){var t=A$(e,function(n){return r.size===T$&&r.clear(),n}),r=t.cache;return t}var I$=E$,$$=I$,D$=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,R$=/\\(\\)?/g,B$=$$(function(e){var t=[];return e.charCodeAt(0)===46&&t.push(""),e.replace(D$,function(r,n,a,i){t.push(a?i.replace(R$,"$1"):n||r)}),t}),L$=B$;function F$(e,t){for(var r=-1,n=e==null?0:e.length,a=Array(n);++r<n;)a[r]=t(e[r],r,e);return a}var i2=F$,nS=y0,G$=i2,U$=ci,z$=Xu,aS=nS?nS.prototype:void 0,iS=aS?aS.toString:void 0;function Z_(e){if(typeof e=="string")return e;if(U$(e))return G$(e,Z_)+"";if(z$(e))return iS?iS.call(e):"";var t=e+"";return t=="0"&&1/e==-1/0?"-0":t}var W$=Z_,H$=W$;function V$(e){return e==null?"":H$(e)}var J_=V$,X$=ci,K$=Qb,Y$=L$,q$=J_;function Z$(e,t){return X$(e)?e:K$(e,t)?[e]:Y$(q$(e))}var Q_=Z$,J$=Xu;function Q$(e){if(typeof e=="string"||J$(e))return e;var t=e+"";return t=="0"&&1/e==-1/0?"-0":t}var qg=Q$,eD=Q_,tD=qg;function rD(e,t){t=eD(t,e);for(var r=0,n=t.length;e!=null&&r<n;)e=e[tD(t[r++])];return r&&r==n?e:void 0}var o2=rD,nD=o2;function aD(e,t,r){var n=e==null?void 0:nD(e,t);return n===void 0?r:n}var eC=aD;const Ri=on(eC);function iD(e){return e==null}var oD=iD;const Zt=on(oD);var sD=ms,lD=ci,cD=ys,uD="[object String]";function dD(e){return typeof e=="string"||!lD(e)&&cD(e)&&sD(e)==uD}var fD=dD;const lc=on(fD);var tC={exports:{}},en={};/**
 * @license React
 * react-is.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var s2=Symbol.for("react.element"),l2=Symbol.for("react.portal"),Zg=Symbol.for("react.fragment"),Jg=Symbol.for("react.strict_mode"),Qg=Symbol.for("react.profiler"),em=Symbol.for("react.provider"),tm=Symbol.for("react.context"),hD=Symbol.for("react.server_context"),rm=Symbol.for("react.forward_ref"),nm=Symbol.for("react.suspense"),am=Symbol.for("react.suspense_list"),im=Symbol.for("react.memo"),om=Symbol.for("react.lazy"),pD=Symbol.for("react.offscreen"),rC;rC=Symbol.for("react.module.reference");function Gi(e){if(typeof e=="object"&&e!==null){var t=e.$$typeof;switch(t){case s2:switch(e=e.type,e){case Zg:case Qg:case Jg:case nm:case am:return e;default:switch(e=e&&e.$$typeof,e){case hD:case tm:case rm:case om:case im:case em:return e;default:return t}}case l2:return t}}}en.ContextConsumer=tm;en.ContextProvider=em;en.Element=s2;en.ForwardRef=rm;en.Fragment=Zg;en.Lazy=om;en.Memo=im;en.Portal=l2;en.Profiler=Qg;en.StrictMode=Jg;en.Suspense=nm;en.SuspenseList=am;en.isAsyncMode=function(){return!1};en.isConcurrentMode=function(){return!1};en.isContextConsumer=function(e){return Gi(e)===tm};en.isContextProvider=function(e){return Gi(e)===em};en.isElement=function(e){return typeof e=="object"&&e!==null&&e.$$typeof===s2};en.isForwardRef=function(e){return Gi(e)===rm};en.isFragment=function(e){return Gi(e)===Zg};en.isLazy=function(e){return Gi(e)===om};en.isMemo=function(e){return Gi(e)===im};en.isPortal=function(e){return Gi(e)===l2};en.isProfiler=function(e){return Gi(e)===Qg};en.isStrictMode=function(e){return Gi(e)===Jg};en.isSuspense=function(e){return Gi(e)===nm};en.isSuspenseList=function(e){return Gi(e)===am};en.isValidElementType=function(e){return typeof e=="string"||typeof e=="function"||e===Zg||e===Qg||e===Jg||e===nm||e===am||e===pD||typeof e=="object"&&e!==null&&(e.$$typeof===om||e.$$typeof===im||e.$$typeof===em||e.$$typeof===tm||e.$$typeof===rm||e.$$typeof===rC||e.getModuleId!==void 0)};en.typeOf=Gi;tC.exports=en;var gD=tC.exports,mD=ms,yD=ys,xD="[object Number]";function vD(e){return typeof e=="number"||yD(e)&&mD(e)==xD}var nC=vD;const bD=on(nC);var wD=nC;function kD(e){return wD(e)&&e!=+e}var SD=kD;const Ju=on(SD);var oo=function(t){return t===0?0:t>0?1:-1},Bl=function(t){return lc(t)&&t.indexOf("%")===t.length-1},Fe=function(t){return bD(t)&&!Ju(t)},jD=function(t){return Zt(t)},aa=function(t){return Fe(t)||lc(t)},PD=0,xc=function(t){var r=++PD;return"".concat(t||"").concat(r)},cc=function(t,r){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(!Fe(t)&&!lc(t))return n;var i;if(Bl(t)){var o=t.indexOf("%");i=r*parseFloat(t.slice(0,o))/100}else i=+t;return Ju(i)&&(i=n),a&&i>r&&(i=r),i},$s=function(t){if(!t)return null;var r=Object.keys(t);return r&&r.length?t[r[0]]:null},_D=function(t){if(!Array.isArray(t))return!1;for(var r=t.length,n={},a=0;a<r;a++)if(!n[t[a]])n[t[a]]=!0;else return!0;return!1},$n=function(t,r){return Fe(t)&&Fe(r)?function(n){return t+n*(r-t)}:function(){return r}};function vp(e,t,r){return!e||!e.length?null:e.find(function(n){return n&&(typeof t=="function"?t(n):Ri(n,t))===r})}var CD=function(t){if(!t||!t.length)return null;for(var r=t.length,n=0,a=0,i=0,o=0,s=1/0,l=-1/0,u=0,d=0,f=0;f<r;f++)u=t[f].cx||0,d=t[f].cy||0,n+=u,a+=d,i+=u*d,o+=u*u,s=Math.min(s,u),l=Math.max(l,u);var h=r*o!==n*n?(r*i-n*a)/(r*o-n*n):0;return{xmin:s,xmax:l,a:h,b:(a-h*n)/r}},MD=function(t,r){return Fe(t)&&Fe(r)?t-r:lc(t)&&lc(r)?t.localeCompare(r):t instanceof Date&&r instanceof Date?t.getTime()-r.getTime():String(t).localeCompare(String(r))};function nu(e,t){for(var r in e)if({}.hasOwnProperty.call(e,r)&&(!{}.hasOwnProperty.call(t,r)||e[r]!==t[r]))return!1;for(var n in t)if({}.hasOwnProperty.call(t,n)&&!{}.hasOwnProperty.call(e,n))return!1;return!0}function pv(e){"@babel/helpers - typeof";return pv=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},pv(e)}var ND=["viewBox","children"],OD=["aria-activedescendant","aria-atomic","aria-autocomplete","aria-busy","aria-checked","aria-colcount","aria-colindex","aria-colspan","aria-controls","aria-current","aria-describedby","aria-details","aria-disabled","aria-errormessage","aria-expanded","aria-flowto","aria-haspopup","aria-hidden","aria-invalid","aria-keyshortcuts","aria-label","aria-labelledby","aria-level","aria-live","aria-modal","aria-multiline","aria-multiselectable","aria-orientation","aria-owns","aria-placeholder","aria-posinset","aria-pressed","aria-readonly","aria-relevant","aria-required","aria-roledescription","aria-rowcount","aria-rowindex","aria-rowspan","aria-selected","aria-setsize","aria-sort","aria-valuemax","aria-valuemin","aria-valuenow","aria-valuetext","className","color","height","id","lang","max","media","method","min","name","style","target","width","role","tabIndex","accentHeight","accumulate","additive","alignmentBaseline","allowReorder","alphabetic","amplitude","arabicForm","ascent","attributeName","attributeType","autoReverse","azimuth","baseFrequency","baselineShift","baseProfile","bbox","begin","bias","by","calcMode","capHeight","clip","clipPath","clipPathUnits","clipRule","colorInterpolation","colorInterpolationFilters","colorProfile","colorRendering","contentScriptType","contentStyleType","cursor","cx","cy","d","decelerate","descent","diffuseConstant","direction","display","divisor","dominantBaseline","dur","dx","dy","edgeMode","elevation","enableBackground","end","exponent","externalResourcesRequired","fill","fillOpacity","fillRule","filter","filterRes","filterUnits","floodColor","floodOpacity","focusable","fontFamily","fontSize","fontSizeAdjust","fontStretch","fontStyle","fontVariant","fontWeight","format","from","fx","fy","g1","g2","glyphName","glyphOrientationHorizontal","glyphOrientationVertical","glyphRef","gradientTransform","gradientUnits","hanging","horizAdvX","horizOriginX","href","ideographic","imageRendering","in2","in","intercept","k1","k2","k3","k4","k","kernelMatrix","kernelUnitLength","kerning","keyPoints","keySplines","keyTimes","lengthAdjust","letterSpacing","lightingColor","limitingConeAngle","local","markerEnd","markerHeight","markerMid","markerStart","markerUnits","markerWidth","mask","maskContentUnits","maskUnits","mathematical","mode","numOctaves","offset","opacity","operator","order","orient","orientation","origin","overflow","overlinePosition","overlineThickness","paintOrder","panose1","pathLength","patternContentUnits","patternTransform","patternUnits","pointerEvents","pointsAtX","pointsAtY","pointsAtZ","preserveAlpha","preserveAspectRatio","primitiveUnits","r","radius","refX","refY","renderingIntent","repeatCount","repeatDur","requiredExtensions","requiredFeatures","restart","result","rotate","rx","ry","seed","shapeRendering","slope","spacing","specularConstant","specularExponent","speed","spreadMethod","startOffset","stdDeviation","stemh","stemv","stitchTiles","stopColor","stopOpacity","strikethroughPosition","strikethroughThickness","string","stroke","strokeDasharray","strokeDashoffset","strokeLinecap","strokeLinejoin","strokeMiterlimit","strokeOpacity","strokeWidth","surfaceScale","systemLanguage","tableValues","targetX","targetY","textAnchor","textDecoration","textLength","textRendering","to","transform","u1","u2","underlinePosition","underlineThickness","unicode","unicodeBidi","unicodeRange","unitsPerEm","vAlphabetic","values","vectorEffect","version","vertAdvY","vertOriginX","vertOriginY","vHanging","vIdeographic","viewTarget","visibility","vMathematical","widths","wordSpacing","writingMode","x1","x2","x","xChannelSelector","xHeight","xlinkActuate","xlinkArcrole","xlinkHref","xlinkRole","xlinkShow","xlinkTitle","xlinkType","xmlBase","xmlLang","xmlns","xmlnsXlink","xmlSpace","y1","y2","y","yChannelSelector","z","zoomAndPan","ref","key","angle"],oS=["points","pathLength"],Ey={svg:ND,polygon:oS,polyline:oS},c2=["dangerouslySetInnerHTML","onCopy","onCopyCapture","onCut","onCutCapture","onPaste","onPasteCapture","onCompositionEnd","onCompositionEndCapture","onCompositionStart","onCompositionStartCapture","onCompositionUpdate","onCompositionUpdateCapture","onFocus","onFocusCapture","onBlur","onBlurCapture","onChange","onChangeCapture","onBeforeInput","onBeforeInputCapture","onInput","onInputCapture","onReset","onResetCapture","onSubmit","onSubmitCapture","onInvalid","onInvalidCapture","onLoad","onLoadCapture","onError","onErrorCapture","onKeyDown","onKeyDownCapture","onKeyPress","onKeyPressCapture","onKeyUp","onKeyUpCapture","onAbort","onAbortCapture","onCanPlay","onCanPlayCapture","onCanPlayThrough","onCanPlayThroughCapture","onDurationChange","onDurationChangeCapture","onEmptied","onEmptiedCapture","onEncrypted","onEncryptedCapture","onEnded","onEndedCapture","onLoadedData","onLoadedDataCapture","onLoadedMetadata","onLoadedMetadataCapture","onLoadStart","onLoadStartCapture","onPause","onPauseCapture","onPlay","onPlayCapture","onPlaying","onPlayingCapture","onProgress","onProgressCapture","onRateChange","onRateChangeCapture","onSeeked","onSeekedCapture","onSeeking","onSeekingCapture","onStalled","onStalledCapture","onSuspend","onSuspendCapture","onTimeUpdate","onTimeUpdateCapture","onVolumeChange","onVolumeChangeCapture","onWaiting","onWaitingCapture","onAuxClick","onAuxClickCapture","onClick","onClickCapture","onContextMenu","onContextMenuCapture","onDoubleClick","onDoubleClickCapture","onDrag","onDragCapture","onDragEnd","onDragEndCapture","onDragEnter","onDragEnterCapture","onDragExit","onDragExitCapture","onDragLeave","onDragLeaveCapture","onDragOver","onDragOverCapture","onDragStart","onDragStartCapture","onDrop","onDropCapture","onMouseDown","onMouseDownCapture","onMouseEnter","onMouseLeave","onMouseMove","onMouseMoveCapture","onMouseOut","onMouseOutCapture","onMouseOver","onMouseOverCapture","onMouseUp","onMouseUpCapture","onSelect","onSelectCapture","onTouchCancel","onTouchCancelCapture","onTouchEnd","onTouchEndCapture","onTouchMove","onTouchMoveCapture","onTouchStart","onTouchStartCapture","onPointerDown","onPointerDownCapture","onPointerMove","onPointerMoveCapture","onPointerUp","onPointerUpCapture","onPointerCancel","onPointerCancelCapture","onPointerEnter","onPointerEnterCapture","onPointerLeave","onPointerLeaveCapture","onPointerOver","onPointerOverCapture","onPointerOut","onPointerOutCapture","onGotPointerCapture","onGotPointerCaptureCapture","onLostPointerCapture","onLostPointerCaptureCapture","onScroll","onScrollCapture","onWheel","onWheelCapture","onAnimationStart","onAnimationStartCapture","onAnimationEnd","onAnimationEndCapture","onAnimationIteration","onAnimationIterationCapture","onTransitionEnd","onTransitionEndCapture"],bp=function(t,r){if(!t||typeof t=="function"||typeof t=="boolean")return null;var n=t;if(_.isValidElement(t)&&(n=t.props),!Ku(n))return null;var a={};return Object.keys(n).forEach(function(i){c2.includes(i)&&(a[i]=r||function(o){return n[i](n,o)})}),a},AD=function(t,r,n){return function(a){return t(r,n,a),null}},Mf=function(t,r,n){if(!Ku(t)||pv(t)!=="object")return null;var a=null;return Object.keys(t).forEach(function(i){var o=t[i];c2.includes(i)&&typeof o=="function"&&(a||(a={}),a[i]=AD(o,r,n))}),a},TD=["children"],ED=["children"];function sS(e,t){if(e==null)return{};var r=ID(e,t),n,a;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function ID(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function gv(e){"@babel/helpers - typeof";return gv=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},gv(e)}var lS={click:"onClick",mousedown:"onMouseDown",mouseup:"onMouseUp",mouseover:"onMouseOver",mousemove:"onMouseMove",mouseout:"onMouseOut",mouseenter:"onMouseEnter",mouseleave:"onMouseLeave",touchcancel:"onTouchCancel",touchend:"onTouchEnd",touchmove:"onTouchMove",touchstart:"onTouchStart",contextmenu:"onContextMenu",dblclick:"onDoubleClick"},is=function(t){return typeof t=="string"?t:t?t.displayName||t.name||"Component":""},cS=null,Iy=null,u2=function e(t){if(t===cS&&Array.isArray(Iy))return Iy;var r=[];return _.Children.forEach(t,function(n){Zt(n)||(gD.isFragment(n)?r=r.concat(e(n.props.children)):r.push(n))}),Iy=r,cS=t,r};function li(e,t){var r=[],n=[];return Array.isArray(t)?n=t.map(function(a){return is(a)}):n=[is(t)],u2(e).forEach(function(a){var i=Ri(a,"type.displayName")||Ri(a,"type.name");n.indexOf(i)!==-1&&r.push(a)}),r}function yi(e,t){var r=li(e,t);return r&&r[0]}var uS=function(t){if(!t||!t.props)return!1;var r=t.props,n=r.width,a=r.height;return!(!Fe(n)||n<=0||!Fe(a)||a<=0)},$D=["a","altGlyph","altGlyphDef","altGlyphItem","animate","animateColor","animateMotion","animateTransform","circle","clipPath","color-profile","cursor","defs","desc","ellipse","feBlend","feColormatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence","filter","font","font-face","font-face-format","font-face-name","font-face-url","foreignObject","g","glyph","glyphRef","hkern","image","line","lineGradient","marker","mask","metadata","missing-glyph","mpath","path","pattern","polygon","polyline","radialGradient","rect","script","set","stop","style","svg","switch","symbol","text","textPath","title","tref","tspan","use","view","vkern"],DD=function(t){return t&&t.type&&lc(t.type)&&$D.indexOf(t.type)>=0},aC=function(t){return t&&gv(t)==="object"&&"clipDot"in t},RD=function(t,r,n,a){var i,o=(i=Ey==null?void 0:Ey[a])!==null&&i!==void 0?i:[];return r.startsWith("data-")||!tr(t)&&(a&&o.includes(r)||OD.includes(r))||n&&c2.includes(r)},er=function(t,r,n){if(!t||typeof t=="function"||typeof t=="boolean")return null;var a=t;if(_.isValidElement(t)&&(a=t.props),!Ku(a))return null;var i={};return Object.keys(a).forEach(function(o){var s;RD((s=a)===null||s===void 0?void 0:s[o],o,r,n)&&(i[o]=a[o])}),i},mv=function e(t,r){if(t===r)return!0;var n=_.Children.count(t);if(n!==_.Children.count(r))return!1;if(n===0)return!0;if(n===1)return dS(Array.isArray(t)?t[0]:t,Array.isArray(r)?r[0]:r);for(var a=0;a<n;a++){var i=t[a],o=r[a];if(Array.isArray(i)||Array.isArray(o)){if(!e(i,o))return!1}else if(!dS(i,o))return!1}return!0},dS=function(t,r){if(Zt(t)&&Zt(r))return!0;if(!Zt(t)&&!Zt(r)){var n=t.props||{},a=n.children,i=sS(n,TD),o=r.props||{},s=o.children,l=sS(o,ED);return a&&s?nu(i,l)&&mv(a,s):!a&&!s?nu(i,l):!1}return!1},fS=function(t,r){var n=[],a={};return u2(t).forEach(function(i,o){if(DD(i))n.push(i);else if(i){var s=is(i.type),l=r[s]||{},u=l.handler,d=l.once;if(u&&(!d||!a[s])){var f=u(i,s,o);n.push(f),a[s]=!0}}}),n},BD=function(t){var r=t&&t.type;return r&&lS[r]?lS[r]:null},LD=function(t,r){return u2(r).indexOf(t)},FD=["children","width","height","viewBox","className","style","title","desc"];function yv(){return yv=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},yv.apply(this,arguments)}function GD(e,t){if(e==null)return{};var r=UD(e,t),n,a;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function UD(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function xv(e){var t=e.children,r=e.width,n=e.height,a=e.viewBox,i=e.className,o=e.style,s=e.title,l=e.desc,u=GD(e,FD),d=a||{width:r,height:n,x:0,y:0},f=kr("recharts-surface",i);return oe.createElement("svg",yv({},er(u,!0,"svg"),{className:f,width:r,height:n,style:o,viewBox:"".concat(d.x," ").concat(d.y," ").concat(d.width," ").concat(d.height)}),oe.createElement("title",null,s),oe.createElement("desc",null,l),t)}var zD=["children","className"];function vv(){return vv=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},vv.apply(this,arguments)}function WD(e,t){if(e==null)return{};var r=HD(e,t),n,a;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function HD(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}var Wr=oe.forwardRef(function(e,t){var r=e.children,n=e.className,a=WD(e,zD),i=kr("recharts-layer",n);return oe.createElement("g",vv({className:i},er(a,!0),{ref:t}),r)}),os=function(t,r){for(var n=arguments.length,a=new Array(n>2?n-2:0),i=2;i<n;i++)a[i-2]=arguments[i]};function VD(e,t,r){var n=-1,a=e.length;t<0&&(t=-t>a?0:a+t),r=r>a?a:r,r<0&&(r+=a),a=t>r?0:r-t>>>0,t>>>=0;for(var i=Array(a);++n<a;)i[n]=e[n+t];return i}var XD=VD,KD=XD;function YD(e,t,r){var n=e.length;return r=r===void 0?n:r,!t&&r>=n?e:KD(e,t,r)}var qD=YD,ZD="\\ud800-\\udfff",JD="\\u0300-\\u036f",QD="\\ufe20-\\ufe2f",eR="\\u20d0-\\u20ff",tR=JD+QD+eR,rR="\\ufe0e\\ufe0f",nR="\\u200d",aR=RegExp("["+nR+ZD+tR+rR+"]");function iR(e){return aR.test(e)}var iC=iR;function oR(e){return e.split("")}var sR=oR,oC="\\ud800-\\udfff",lR="\\u0300-\\u036f",cR="\\ufe20-\\ufe2f",uR="\\u20d0-\\u20ff",dR=lR+cR+uR,fR="\\ufe0e\\ufe0f",hR="["+oC+"]",bv="["+dR+"]",wv="\\ud83c[\\udffb-\\udfff]",pR="(?:"+bv+"|"+wv+")",sC="[^"+oC+"]",lC="(?:\\ud83c[\\udde6-\\uddff]){2}",cC="[\\ud800-\\udbff][\\udc00-\\udfff]",gR="\\u200d",uC=pR+"?",dC="["+fR+"]?",mR="(?:"+gR+"(?:"+[sC,lC,cC].join("|")+")"+dC+uC+")*",yR=dC+uC+mR,xR="(?:"+[sC+bv+"?",bv,lC,cC,hR].join("|")+")",vR=RegExp(wv+"(?="+wv+")|"+xR+yR,"g");function bR(e){return e.match(vR)||[]}var wR=bR,kR=sR,SR=iC,jR=wR;function PR(e){return SR(e)?jR(e):kR(e)}var _R=PR,CR=qD,MR=iC,NR=_R,OR=J_;function AR(e){return function(t){t=OR(t);var r=MR(t)?NR(t):void 0,n=r?r[0]:t.charAt(0),a=r?CR(r,1).join(""):t.slice(1);return n[e]()+a}}var TR=AR,ER=TR,IR=ER("toUpperCase"),$R=IR;const sm=on($R);function cn(e){return function(){return e}}const fC=Math.cos,wp=Math.sin,po=Math.sqrt,kp=Math.PI,lm=2*kp,kv=Math.PI,Sv=2*kv,Nl=1e-6,DR=Sv-Nl;function hC(e){this._+=e[0];for(let t=1,r=e.length;t<r;++t)this._+=arguments[t]+e[t]}function RR(e){let t=Math.floor(e);if(!(t>=0))throw new Error(`invalid digits: ${e}`);if(t>15)return hC;const r=10**t;return function(n){this._+=n[0];for(let a=1,i=n.length;a<i;++a)this._+=Math.round(arguments[a]*r)/r+n[a]}}class BR{constructor(t){this._x0=this._y0=this._x1=this._y1=null,this._="",this._append=t==null?hC:RR(t)}moveTo(t,r){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+r}`}closePath(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._append`Z`)}lineTo(t,r){this._append`L${this._x1=+t},${this._y1=+r}`}quadraticCurveTo(t,r,n,a){this._append`Q${+t},${+r},${this._x1=+n},${this._y1=+a}`}bezierCurveTo(t,r,n,a,i,o){this._append`C${+t},${+r},${+n},${+a},${this._x1=+i},${this._y1=+o}`}arcTo(t,r,n,a,i){if(t=+t,r=+r,n=+n,a=+a,i=+i,i<0)throw new Error(`negative radius: ${i}`);let o=this._x1,s=this._y1,l=n-t,u=a-r,d=o-t,f=s-r,h=d*d+f*f;if(this._x1===null)this._append`M${this._x1=t},${this._y1=r}`;else if(h>Nl)if(!(Math.abs(f*l-u*d)>Nl)||!i)this._append`L${this._x1=t},${this._y1=r}`;else{let g=n-o,b=a-s,w=l*l+u*u,v=g*g+b*b,x=Math.sqrt(w),m=Math.sqrt(h),k=i*Math.tan((kv-Math.acos((w+h-v)/(2*x*m)))/2),P=k/m,j=k/x;Math.abs(P-1)>Nl&&this._append`L${t+P*d},${r+P*f}`,this._append`A${i},${i},0,0,${+(f*g>d*b)},${this._x1=t+j*l},${this._y1=r+j*u}`}}arc(t,r,n,a,i,o){if(t=+t,r=+r,n=+n,o=!!o,n<0)throw new Error(`negative radius: ${n}`);let s=n*Math.cos(a),l=n*Math.sin(a),u=t+s,d=r+l,f=1^o,h=o?a-i:i-a;this._x1===null?this._append`M${u},${d}`:(Math.abs(this._x1-u)>Nl||Math.abs(this._y1-d)>Nl)&&this._append`L${u},${d}`,n&&(h<0&&(h=h%Sv+Sv),h>DR?this._append`A${n},${n},0,1,${f},${t-s},${r-l}A${n},${n},0,1,${f},${this._x1=u},${this._y1=d}`:h>Nl&&this._append`A${n},${n},0,${+(h>=kv)},${f},${this._x1=t+n*Math.cos(i)},${this._y1=r+n*Math.sin(i)}`)}rect(t,r,n,a){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+r}h${n=+n}v${+a}h${-n}Z`}toString(){return this._}}function d2(e){let t=3;return e.digits=function(r){if(!arguments.length)return t;if(r==null)t=null;else{const n=Math.floor(r);if(!(n>=0))throw new RangeError(`invalid digits: ${r}`);t=n}return e},()=>new BR(t)}function f2(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function pC(e){this._context=e}pC.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:this._context.lineTo(e,t);break}}};function cm(e){return new pC(e)}function gC(e){return e[0]}function mC(e){return e[1]}function yC(e,t){var r=cn(!0),n=null,a=cm,i=null,o=d2(s);e=typeof e=="function"?e:e===void 0?gC:cn(e),t=typeof t=="function"?t:t===void 0?mC:cn(t);function s(l){var u,d=(l=f2(l)).length,f,h=!1,g;for(n==null&&(i=a(g=o())),u=0;u<=d;++u)!(u<d&&r(f=l[u],u,l))===h&&((h=!h)?i.lineStart():i.lineEnd()),h&&i.point(+e(f,u,l),+t(f,u,l));if(g)return i=null,g+""||null}return s.x=function(l){return arguments.length?(e=typeof l=="function"?l:cn(+l),s):e},s.y=function(l){return arguments.length?(t=typeof l=="function"?l:cn(+l),s):t},s.defined=function(l){return arguments.length?(r=typeof l=="function"?l:cn(!!l),s):r},s.curve=function(l){return arguments.length?(a=l,n!=null&&(i=a(n)),s):a},s.context=function(l){return arguments.length?(l==null?n=i=null:i=a(n=l),s):n},s}function uh(e,t,r){var n=null,a=cn(!0),i=null,o=cm,s=null,l=d2(u);e=typeof e=="function"?e:e===void 0?gC:cn(+e),t=typeof t=="function"?t:cn(t===void 0?0:+t),r=typeof r=="function"?r:r===void 0?mC:cn(+r);function u(f){var h,g,b,w=(f=f2(f)).length,v,x=!1,m,k=new Array(w),P=new Array(w);for(i==null&&(s=o(m=l())),h=0;h<=w;++h){if(!(h<w&&a(v=f[h],h,f))===x)if(x=!x)g=h,s.areaStart(),s.lineStart();else{for(s.lineEnd(),s.lineStart(),b=h-1;b>=g;--b)s.point(k[b],P[b]);s.lineEnd(),s.areaEnd()}x&&(k[h]=+e(v,h,f),P[h]=+t(v,h,f),s.point(n?+n(v,h,f):k[h],r?+r(v,h,f):P[h]))}if(m)return s=null,m+""||null}function d(){return yC().defined(a).curve(o).context(i)}return u.x=function(f){return arguments.length?(e=typeof f=="function"?f:cn(+f),n=null,u):e},u.x0=function(f){return arguments.length?(e=typeof f=="function"?f:cn(+f),u):e},u.x1=function(f){return arguments.length?(n=f==null?null:typeof f=="function"?f:cn(+f),u):n},u.y=function(f){return arguments.length?(t=typeof f=="function"?f:cn(+f),r=null,u):t},u.y0=function(f){return arguments.length?(t=typeof f=="function"?f:cn(+f),u):t},u.y1=function(f){return arguments.length?(r=f==null?null:typeof f=="function"?f:cn(+f),u):r},u.lineX0=u.lineY0=function(){return d().x(e).y(t)},u.lineY1=function(){return d().x(e).y(r)},u.lineX1=function(){return d().x(n).y(t)},u.defined=function(f){return arguments.length?(a=typeof f=="function"?f:cn(!!f),u):a},u.curve=function(f){return arguments.length?(o=f,i!=null&&(s=o(i)),u):o},u.context=function(f){return arguments.length?(f==null?i=s=null:s=o(i=f),u):i},u}class xC{constructor(t,r){this._context=t,this._x=r}areaStart(){this._line=0}areaEnd(){this._line=NaN}lineStart(){this._point=0}lineEnd(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line}point(t,r){switch(t=+t,r=+r,this._point){case 0:{this._point=1,this._line?this._context.lineTo(t,r):this._context.moveTo(t,r);break}case 1:this._point=2;default:{this._x?this._context.bezierCurveTo(this._x0=(this._x0+t)/2,this._y0,this._x0,r,t,r):this._context.bezierCurveTo(this._x0,this._y0=(this._y0+r)/2,t,this._y0,t,r);break}}this._x0=t,this._y0=r}}function LR(e){return new xC(e,!0)}function FR(e){return new xC(e,!1)}const h2={draw(e,t){const r=po(t/kp);e.moveTo(r,0),e.arc(0,0,r,0,lm)}},GR={draw(e,t){const r=po(t/5)/2;e.moveTo(-3*r,-r),e.lineTo(-r,-r),e.lineTo(-r,-3*r),e.lineTo(r,-3*r),e.lineTo(r,-r),e.lineTo(3*r,-r),e.lineTo(3*r,r),e.lineTo(r,r),e.lineTo(r,3*r),e.lineTo(-r,3*r),e.lineTo(-r,r),e.lineTo(-3*r,r),e.closePath()}},vC=po(1/3),UR=vC*2,zR={draw(e,t){const r=po(t/UR),n=r*vC;e.moveTo(0,-r),e.lineTo(n,0),e.lineTo(0,r),e.lineTo(-n,0),e.closePath()}},WR={draw(e,t){const r=po(t),n=-r/2;e.rect(n,n,r,r)}},HR=.8908130915292852,bC=wp(kp/10)/wp(7*kp/10),VR=wp(lm/10)*bC,XR=-fC(lm/10)*bC,KR={draw(e,t){const r=po(t*HR),n=VR*r,a=XR*r;e.moveTo(0,-r),e.lineTo(n,a);for(let i=1;i<5;++i){const o=lm*i/5,s=fC(o),l=wp(o);e.lineTo(l*r,-s*r),e.lineTo(s*n-l*a,l*n+s*a)}e.closePath()}},$y=po(3),YR={draw(e,t){const r=-po(t/($y*3));e.moveTo(0,r*2),e.lineTo(-$y*r,-r),e.lineTo($y*r,-r),e.closePath()}},Ci=-.5,Mi=po(3)/2,jv=1/po(12),qR=(jv/2+1)*3,ZR={draw(e,t){const r=po(t/qR),n=r/2,a=r*jv,i=n,o=r*jv+r,s=-i,l=o;e.moveTo(n,a),e.lineTo(i,o),e.lineTo(s,l),e.lineTo(Ci*n-Mi*a,Mi*n+Ci*a),e.lineTo(Ci*i-Mi*o,Mi*i+Ci*o),e.lineTo(Ci*s-Mi*l,Mi*s+Ci*l),e.lineTo(Ci*n+Mi*a,Ci*a-Mi*n),e.lineTo(Ci*i+Mi*o,Ci*o-Mi*i),e.lineTo(Ci*s+Mi*l,Ci*l-Mi*s),e.closePath()}};function JR(e,t){let r=null,n=d2(a);e=typeof e=="function"?e:cn(e||h2),t=typeof t=="function"?t:cn(t===void 0?64:+t);function a(){let i;if(r||(r=i=n()),e.apply(this,arguments).draw(r,+t.apply(this,arguments)),i)return r=null,i+""||null}return a.type=function(i){return arguments.length?(e=typeof i=="function"?i:cn(i),a):e},a.size=function(i){return arguments.length?(t=typeof i=="function"?i:cn(+i),a):t},a.context=function(i){return arguments.length?(r=i??null,a):r},a}function Sp(){}function jp(e,t,r){e._context.bezierCurveTo((2*e._x0+e._x1)/3,(2*e._y0+e._y1)/3,(e._x0+2*e._x1)/3,(e._y0+2*e._y1)/3,(e._x0+4*e._x1+t)/6,(e._y0+4*e._y1+r)/6)}function wC(e){this._context=e}wC.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){switch(this._point){case 3:jp(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:jp(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function QR(e){return new wC(e)}function kC(e){this._context=e}kC.prototype={areaStart:Sp,areaEnd:Sp,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._y0=this._y1=this._y2=this._y3=this._y4=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x2,this._y2),this._context.closePath();break}case 2:{this._context.moveTo((this._x2+2*this._x3)/3,(this._y2+2*this._y3)/3),this._context.lineTo((this._x3+2*this._x2)/3,(this._y3+2*this._y2)/3),this._context.closePath();break}case 3:{this.point(this._x2,this._y2),this.point(this._x3,this._y3),this.point(this._x4,this._y4);break}}},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._x2=e,this._y2=t;break;case 1:this._point=2,this._x3=e,this._y3=t;break;case 2:this._point=3,this._x4=e,this._y4=t,this._context.moveTo((this._x0+4*this._x1+e)/6,(this._y0+4*this._y1+t)/6);break;default:jp(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function e7(e){return new kC(e)}function SC(e){this._context=e}SC.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3;var r=(this._x0+4*this._x1+e)/6,n=(this._y0+4*this._y1+t)/6;this._line?this._context.lineTo(r,n):this._context.moveTo(r,n);break;case 3:this._point=4;default:jp(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function t7(e){return new SC(e)}function jC(e){this._context=e}jC.prototype={areaStart:Sp,areaEnd:Sp,lineStart:function(){this._point=0},lineEnd:function(){this._point&&this._context.closePath()},point:function(e,t){e=+e,t=+t,this._point?this._context.lineTo(e,t):(this._point=1,this._context.moveTo(e,t))}};function r7(e){return new jC(e)}function hS(e){return e<0?-1:1}function pS(e,t,r){var n=e._x1-e._x0,a=t-e._x1,i=(e._y1-e._y0)/(n||a<0&&-0),o=(r-e._y1)/(a||n<0&&-0),s=(i*a+o*n)/(n+a);return(hS(i)+hS(o))*Math.min(Math.abs(i),Math.abs(o),.5*Math.abs(s))||0}function gS(e,t){var r=e._x1-e._x0;return r?(3*(e._y1-e._y0)/r-t)/2:t}function Dy(e,t,r){var n=e._x0,a=e._y0,i=e._x1,o=e._y1,s=(i-n)/3;e._context.bezierCurveTo(n+s,a+s*t,i-s,o-s*r,i,o)}function Pp(e){this._context=e}Pp.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:Dy(this,this._t0,gS(this,this._t0));break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){var r=NaN;if(e=+e,t=+t,!(e===this._x1&&t===this._y1)){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,Dy(this,gS(this,r=pS(this,e,t)),r);break;default:Dy(this,this._t0,r=pS(this,e,t));break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t,this._t0=r}}};function PC(e){this._context=new _C(e)}(PC.prototype=Object.create(Pp.prototype)).point=function(e,t){Pp.prototype.point.call(this,t,e)};function _C(e){this._context=e}_C.prototype={moveTo:function(e,t){this._context.moveTo(t,e)},closePath:function(){this._context.closePath()},lineTo:function(e,t){this._context.lineTo(t,e)},bezierCurveTo:function(e,t,r,n,a,i){this._context.bezierCurveTo(t,e,n,r,i,a)}};function n7(e){return new Pp(e)}function a7(e){return new PC(e)}function CC(e){this._context=e}CC.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=[],this._y=[]},lineEnd:function(){var e=this._x,t=this._y,r=e.length;if(r)if(this._line?this._context.lineTo(e[0],t[0]):this._context.moveTo(e[0],t[0]),r===2)this._context.lineTo(e[1],t[1]);else for(var n=mS(e),a=mS(t),i=0,o=1;o<r;++i,++o)this._context.bezierCurveTo(n[0][i],a[0][i],n[1][i],a[1][i],e[o],t[o]);(this._line||this._line!==0&&r===1)&&this._context.closePath(),this._line=1-this._line,this._x=this._y=null},point:function(e,t){this._x.push(+e),this._y.push(+t)}};function mS(e){var t,r=e.length-1,n,a=new Array(r),i=new Array(r),o=new Array(r);for(a[0]=0,i[0]=2,o[0]=e[0]+2*e[1],t=1;t<r-1;++t)a[t]=1,i[t]=4,o[t]=4*e[t]+2*e[t+1];for(a[r-1]=2,i[r-1]=7,o[r-1]=8*e[r-1]+e[r],t=1;t<r;++t)n=a[t]/i[t-1],i[t]-=n,o[t]-=n*o[t-1];for(a[r-1]=o[r-1]/i[r-1],t=r-2;t>=0;--t)a[t]=(o[t]-a[t+1])/i[t];for(i[r-1]=(e[r]+a[r-1])/2,t=0;t<r-1;++t)i[t]=2*e[t+1]-a[t+1];return[a,i]}function i7(e){return new CC(e)}function um(e,t){this._context=e,this._t=t}um.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=this._y=NaN,this._point=0},lineEnd:function(){0<this._t&&this._t<1&&this._point===2&&this._context.lineTo(this._x,this._y),(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line>=0&&(this._t=1-this._t,this._line=1-this._line)},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:{if(this._t<=0)this._context.lineTo(this._x,t),this._context.lineTo(e,t);else{var r=this._x*(1-this._t)+e*this._t;this._context.lineTo(r,this._y),this._context.lineTo(r,t)}break}}this._x=e,this._y=t}};function o7(e){return new um(e,.5)}function s7(e){return new um(e,0)}function l7(e){return new um(e,1)}function gu(e,t){if((o=e.length)>1)for(var r=1,n,a,i=e[t[0]],o,s=i.length;r<o;++r)for(a=i,i=e[t[r]],n=0;n<s;++n)i[n][1]+=i[n][0]=isNaN(a[n][1])?a[n][0]:a[n][1]}function Pv(e){for(var t=e.length,r=new Array(t);--t>=0;)r[t]=t;return r}function c7(e,t){return e[t]}function u7(e){const t=[];return t.key=e,t}function d7(){var e=cn([]),t=Pv,r=gu,n=c7;function a(i){var o=Array.from(e.apply(this,arguments),u7),s,l=o.length,u=-1,d;for(const f of i)for(s=0,++u;s<l;++s)(o[s][u]=[0,+n(f,o[s].key,u,i)]).data=f;for(s=0,d=f2(t(o));s<l;++s)o[d[s]].index=s;return r(o,d),o}return a.keys=function(i){return arguments.length?(e=typeof i=="function"?i:cn(Array.from(i)),a):e},a.value=function(i){return arguments.length?(n=typeof i=="function"?i:cn(+i),a):n},a.order=function(i){return arguments.length?(t=i==null?Pv:typeof i=="function"?i:cn(Array.from(i)),a):t},a.offset=function(i){return arguments.length?(r=i??gu,a):r},a}function f7(e,t){if((n=e.length)>0){for(var r,n,a=0,i=e[0].length,o;a<i;++a){for(o=r=0;r<n;++r)o+=e[r][a][1]||0;if(o)for(r=0;r<n;++r)e[r][a][1]/=o}gu(e,t)}}function h7(e,t){if((a=e.length)>0){for(var r=0,n=e[t[0]],a,i=n.length;r<i;++r){for(var o=0,s=0;o<a;++o)s+=e[o][r][1]||0;n[r][1]+=n[r][0]=-s/2}gu(e,t)}}function p7(e,t){if(!(!((o=e.length)>0)||!((i=(a=e[t[0]]).length)>0))){for(var r=0,n=1,a,i,o;n<i;++n){for(var s=0,l=0,u=0;s<o;++s){for(var d=e[t[s]],f=d[n][1]||0,h=d[n-1][1]||0,g=(f-h)/2,b=0;b<s;++b){var w=e[t[b]],v=w[n][1]||0,x=w[n-1][1]||0;g+=v-x}l+=f,u+=g*f}a[n-1][1]+=a[n-1][0]=r,l&&(r-=u/l)}a[n-1][1]+=a[n-1][0]=r,gu(e,t)}}function Nf(e){"@babel/helpers - typeof";return Nf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Nf(e)}var g7=["type","size","sizeType"];function _v(){return _v=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},_v.apply(this,arguments)}function yS(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function xS(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?yS(Object(r),!0).forEach(function(n){m7(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):yS(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function m7(e,t,r){return t=y7(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function y7(e){var t=x7(e,"string");return Nf(t)=="symbol"?t:t+""}function x7(e,t){if(Nf(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(Nf(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function v7(e,t){if(e==null)return{};var r=b7(e,t),n,a;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function b7(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}var MC={symbolCircle:h2,symbolCross:GR,symbolDiamond:zR,symbolSquare:WR,symbolStar:KR,symbolTriangle:YR,symbolWye:ZR},w7=Math.PI/180,k7=function(t){var r="symbol".concat(sm(t));return MC[r]||h2},S7=function(t,r,n){if(r==="area")return t;switch(n){case"cross":return 5*t*t/9;case"diamond":return .5*t*t/Math.sqrt(3);case"square":return t*t;case"star":{var a=18*w7;return 1.25*t*t*(Math.tan(a)-Math.tan(a*2)*Math.pow(Math.tan(a),2))}case"triangle":return Math.sqrt(3)*t*t/4;case"wye":return(21-10*Math.sqrt(3))*t*t/8;default:return Math.PI*t*t/4}},j7=function(t,r){MC["symbol".concat(sm(t))]=r},dm=function(t){var r=t.type,n=r===void 0?"circle":r,a=t.size,i=a===void 0?64:a,o=t.sizeType,s=o===void 0?"area":o,l=v7(t,g7),u=xS(xS({},l),{},{type:n,size:i,sizeType:s}),d=function(){var v=k7(n),x=JR().type(v).size(S7(i,s,n));return x()},f=u.className,h=u.cx,g=u.cy,b=er(u,!0);return h===+h&&g===+g&&i===+i?oe.createElement("path",_v({},b,{className:kr("recharts-symbols",f),transform:"translate(".concat(h,", ").concat(g,")"),d:d()})):null};dm.registerSymbol=j7;function mu(e){"@babel/helpers - typeof";return mu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},mu(e)}function Cv(){return Cv=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Cv.apply(this,arguments)}function vS(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function P7(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?vS(Object(r),!0).forEach(function(n){Of(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):vS(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function _7(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function C7(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,OC(n.key),n)}}function M7(e,t,r){return t&&C7(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function N7(e,t,r){return t=_p(t),O7(e,NC()?Reflect.construct(t,r||[],_p(e).constructor):t.apply(e,r))}function O7(e,t){if(t&&(mu(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return A7(e)}function A7(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function NC(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(NC=function(){return!!e})()}function _p(e){return _p=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},_p(e)}function T7(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Mv(e,t)}function Mv(e,t){return Mv=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},Mv(e,t)}function Of(e,t,r){return t=OC(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function OC(e){var t=E7(e,"string");return mu(t)=="symbol"?t:t+""}function E7(e,t){if(mu(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(mu(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var Ni=32,p2=function(e){function t(){return _7(this,t),N7(this,t,arguments)}return T7(t,e),M7(t,[{key:"renderIcon",value:function(n){var a=this.props.inactiveColor,i=Ni/2,o=Ni/6,s=Ni/3,l=n.inactive?a:n.color;if(n.type==="plainline")return oe.createElement("line",{strokeWidth:4,fill:"none",stroke:l,strokeDasharray:n.payload.strokeDasharray,x1:0,y1:i,x2:Ni,y2:i,className:"recharts-legend-icon"});if(n.type==="line")return oe.createElement("path",{strokeWidth:4,fill:"none",stroke:l,d:"M0,".concat(i,"h").concat(s,`
            A`).concat(o,",").concat(o,",0,1,1,").concat(2*s,",").concat(i,`
            H`).concat(Ni,"M").concat(2*s,",").concat(i,`
            A`).concat(o,",").concat(o,",0,1,1,").concat(s,",").concat(i),className:"recharts-legend-icon"});if(n.type==="rect")return oe.createElement("path",{stroke:"none",fill:l,d:"M0,".concat(Ni/8,"h").concat(Ni,"v").concat(Ni*3/4,"h").concat(-Ni,"z"),className:"recharts-legend-icon"});if(oe.isValidElement(n.legendIcon)){var u=P7({},n);return delete u.legendIcon,oe.cloneElement(n.legendIcon,u)}return oe.createElement(dm,{fill:l,cx:i,cy:i,size:Ni,sizeType:"diameter",type:n.type})}},{key:"renderItems",value:function(){var n=this,a=this.props,i=a.payload,o=a.iconSize,s=a.layout,l=a.formatter,u=a.inactiveColor,d={x:0,y:0,width:Ni,height:Ni},f={display:s==="horizontal"?"inline-block":"block",marginRight:10},h={display:"inline-block",verticalAlign:"middle",marginRight:4};return i.map(function(g,b){var w=g.formatter||l,v=kr(Of(Of({"recharts-legend-item":!0},"legend-item-".concat(b),!0),"inactive",g.inactive));if(g.type==="none")return null;var x=tr(g.value)?null:g.value;os(!tr(g.value),`The name property is also required when using a function for the dataKey of a chart's cartesian components. Ex: <Bar name="Name of my Data"/>`);var m=g.inactive?u:g.color;return oe.createElement("li",Cv({className:v,style:f,key:"legend-item-".concat(b)},Mf(n.props,g,b)),oe.createElement(xv,{width:o,height:o,viewBox:d,style:h},n.renderIcon(g)),oe.createElement("span",{className:"recharts-legend-item-text",style:{color:m}},w?w(x,g,b):x))})}},{key:"render",value:function(){var n=this.props,a=n.payload,i=n.layout,o=n.align;if(!a||!a.length)return null;var s={padding:0,margin:0,textAlign:i==="horizontal"?o:"left"};return oe.createElement("ul",{className:"recharts-default-legend",style:s},this.renderItems())}}])}(_.PureComponent);Of(p2,"displayName","Legend");Of(p2,"defaultProps",{iconSize:14,layout:"horizontal",align:"center",verticalAlign:"middle",inactiveColor:"#ccc"});var I7=Kg;function $7(){this.__data__=new I7,this.size=0}var D7=$7;function R7(e){var t=this.__data__,r=t.delete(e);return this.size=t.size,r}var B7=R7;function L7(e){return this.__data__.get(e)}var F7=L7;function G7(e){return this.__data__.has(e)}var U7=G7,z7=Kg,W7=r2,H7=n2,V7=200;function X7(e,t){var r=this.__data__;if(r instanceof z7){var n=r.__data__;if(!W7||n.length<V7-1)return n.push([e,t]),this.size=++r.size,this;r=this.__data__=new H7(n)}return r.set(e,t),this.size=r.size,this}var K7=X7,Y7=Kg,q7=D7,Z7=B7,J7=F7,Q7=U7,e9=K7;function Qu(e){var t=this.__data__=new Y7(e);this.size=t.size}Qu.prototype.clear=q7;Qu.prototype.delete=Z7;Qu.prototype.get=J7;Qu.prototype.has=Q7;Qu.prototype.set=e9;var AC=Qu,t9="__lodash_hash_undefined__";function r9(e){return this.__data__.set(e,t9),this}var n9=r9;function a9(e){return this.__data__.has(e)}var i9=a9,o9=n2,s9=n9,l9=i9;function Cp(e){var t=-1,r=e==null?0:e.length;for(this.__data__=new o9;++t<r;)this.add(e[t])}Cp.prototype.add=Cp.prototype.push=s9;Cp.prototype.has=l9;var TC=Cp;function c9(e,t){for(var r=-1,n=e==null?0:e.length;++r<n;)if(t(e[r],r,e))return!0;return!1}var EC=c9;function u9(e,t){return e.has(t)}var IC=u9,d9=TC,f9=EC,h9=IC,p9=1,g9=2;function m9(e,t,r,n,a,i){var o=r&p9,s=e.length,l=t.length;if(s!=l&&!(o&&l>s))return!1;var u=i.get(e),d=i.get(t);if(u&&d)return u==t&&d==e;var f=-1,h=!0,g=r&g9?new d9:void 0;for(i.set(e,t),i.set(t,e);++f<s;){var b=e[f],w=t[f];if(n)var v=o?n(w,b,f,t,e,i):n(b,w,f,e,t,i);if(v!==void 0){if(v)continue;h=!1;break}if(g){if(!f9(t,function(x,m){if(!h9(g,m)&&(b===x||a(b,x,r,n,i)))return g.push(m)})){h=!1;break}}else if(!(b===w||a(b,w,r,n,i))){h=!1;break}}return i.delete(e),i.delete(t),h}var $C=m9,y9=Fo,x9=y9.Uint8Array,v9=x9;function b9(e){var t=-1,r=Array(e.size);return e.forEach(function(n,a){r[++t]=[a,n]}),r}var w9=b9;function k9(e){var t=-1,r=Array(e.size);return e.forEach(function(n){r[++t]=n}),r}var g2=k9,bS=y0,wS=v9,S9=t2,j9=$C,P9=w9,_9=g2,C9=1,M9=2,N9="[object Boolean]",O9="[object Date]",A9="[object Error]",T9="[object Map]",E9="[object Number]",I9="[object RegExp]",$9="[object Set]",D9="[object String]",R9="[object Symbol]",B9="[object ArrayBuffer]",L9="[object DataView]",kS=bS?bS.prototype:void 0,Ry=kS?kS.valueOf:void 0;function F9(e,t,r,n,a,i,o){switch(r){case L9:if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case B9:return!(e.byteLength!=t.byteLength||!i(new wS(e),new wS(t)));case N9:case O9:case E9:return S9(+e,+t);case A9:return e.name==t.name&&e.message==t.message;case I9:case D9:return e==t+"";case T9:var s=P9;case $9:var l=n&C9;if(s||(s=_9),e.size!=t.size&&!l)return!1;var u=o.get(e);if(u)return u==t;n|=M9,o.set(e,t);var d=j9(s(e),s(t),n,a,i,o);return o.delete(e),d;case R9:if(Ry)return Ry.call(e)==Ry.call(t)}return!1}var G9=F9;function U9(e,t){for(var r=-1,n=t.length,a=e.length;++r<n;)e[a+r]=t[r];return e}var DC=U9,z9=DC,W9=ci;function H9(e,t,r){var n=t(e);return W9(e)?n:z9(n,r(e))}var V9=H9;function X9(e,t){for(var r=-1,n=e==null?0:e.length,a=0,i=[];++r<n;){var o=e[r];t(o,r,e)&&(i[a++]=o)}return i}var K9=X9;function Y9(){return[]}var q9=Y9,Z9=K9,J9=q9,Q9=Object.prototype,eB=Q9.propertyIsEnumerable,SS=Object.getOwnPropertySymbols,tB=SS?function(e){return e==null?[]:(e=Object(e),Z9(SS(e),function(t){return eB.call(e,t)}))}:J9,rB=tB;function nB(e,t){for(var r=-1,n=Array(e);++r<e;)n[r]=t(r);return n}var aB=nB,iB=ms,oB=ys,sB="[object Arguments]";function lB(e){return oB(e)&&iB(e)==sB}var cB=lB,jS=cB,uB=ys,RC=Object.prototype,dB=RC.hasOwnProperty,fB=RC.propertyIsEnumerable,hB=jS(function(){return arguments}())?jS:function(e){return uB(e)&&dB.call(e,"callee")&&!fB.call(e,"callee")},m2=hB,Mp={exports:{}};function pB(){return!1}var gB=pB;Mp.exports;(function(e,t){var r=Fo,n=gB,a=t&&!t.nodeType&&t,i=a&&!0&&e&&!e.nodeType&&e,o=i&&i.exports===a,s=o?r.Buffer:void 0,l=s?s.isBuffer:void 0,u=l||n;e.exports=u})(Mp,Mp.exports);var BC=Mp.exports,mB=9007199254740991,yB=/^(?:0|[1-9]\d*)$/;function xB(e,t){var r=typeof e;return t=t??mB,!!t&&(r=="number"||r!="symbol"&&yB.test(e))&&e>-1&&e%1==0&&e<t}var y2=xB,vB=9007199254740991;function bB(e){return typeof e=="number"&&e>-1&&e%1==0&&e<=vB}var x2=bB,wB=ms,kB=x2,SB=ys,jB="[object Arguments]",PB="[object Array]",_B="[object Boolean]",CB="[object Date]",MB="[object Error]",NB="[object Function]",OB="[object Map]",AB="[object Number]",TB="[object Object]",EB="[object RegExp]",IB="[object Set]",$B="[object String]",DB="[object WeakMap]",RB="[object ArrayBuffer]",BB="[object DataView]",LB="[object Float32Array]",FB="[object Float64Array]",GB="[object Int8Array]",UB="[object Int16Array]",zB="[object Int32Array]",WB="[object Uint8Array]",HB="[object Uint8ClampedArray]",VB="[object Uint16Array]",XB="[object Uint32Array]",hn={};hn[LB]=hn[FB]=hn[GB]=hn[UB]=hn[zB]=hn[WB]=hn[HB]=hn[VB]=hn[XB]=!0;hn[jB]=hn[PB]=hn[RB]=hn[_B]=hn[BB]=hn[CB]=hn[MB]=hn[NB]=hn[OB]=hn[AB]=hn[TB]=hn[EB]=hn[IB]=hn[$B]=hn[DB]=!1;function KB(e){return SB(e)&&kB(e.length)&&!!hn[wB(e)]}var YB=KB;function qB(e){return function(t){return e(t)}}var LC=qB,Np={exports:{}};Np.exports;(function(e,t){var r=V_,n=t&&!t.nodeType&&t,a=n&&!0&&e&&!e.nodeType&&e,i=a&&a.exports===n,o=i&&r.process,s=function(){try{var l=a&&a.require&&a.require("util").types;return l||o&&o.binding&&o.binding("util")}catch{}}();e.exports=s})(Np,Np.exports);var ZB=Np.exports,JB=YB,QB=LC,PS=ZB,_S=PS&&PS.isTypedArray,eL=_S?QB(_S):JB,FC=eL,tL=aB,rL=m2,nL=ci,aL=BC,iL=y2,oL=FC,sL=Object.prototype,lL=sL.hasOwnProperty;function cL(e,t){var r=nL(e),n=!r&&rL(e),a=!r&&!n&&aL(e),i=!r&&!n&&!a&&oL(e),o=r||n||a||i,s=o?tL(e.length,String):[],l=s.length;for(var u in e)(t||lL.call(e,u))&&!(o&&(u=="length"||a&&(u=="offset"||u=="parent")||i&&(u=="buffer"||u=="byteLength"||u=="byteOffset")||iL(u,l)))&&s.push(u);return s}var uL=cL,dL=Object.prototype;function fL(e){var t=e&&e.constructor,r=typeof t=="function"&&t.prototype||dL;return e===r}var hL=fL;function pL(e,t){return function(r){return e(t(r))}}var GC=pL,gL=GC,mL=gL(Object.keys,Object),yL=mL,xL=hL,vL=yL,bL=Object.prototype,wL=bL.hasOwnProperty;function kL(e){if(!xL(e))return vL(e);var t=[];for(var r in Object(e))wL.call(e,r)&&r!="constructor"&&t.push(r);return t}var SL=kL,jL=e2,PL=x2;function _L(e){return e!=null&&PL(e.length)&&!jL(e)}var x0=_L,CL=uL,ML=SL,NL=x0;function OL(e){return NL(e)?CL(e):ML(e)}var fm=OL,AL=V9,TL=rB,EL=fm;function IL(e){return AL(e,EL,TL)}var $L=IL,CS=$L,DL=1,RL=Object.prototype,BL=RL.hasOwnProperty;function LL(e,t,r,n,a,i){var o=r&DL,s=CS(e),l=s.length,u=CS(t),d=u.length;if(l!=d&&!o)return!1;for(var f=l;f--;){var h=s[f];if(!(o?h in t:BL.call(t,h)))return!1}var g=i.get(e),b=i.get(t);if(g&&b)return g==t&&b==e;var w=!0;i.set(e,t),i.set(t,e);for(var v=o;++f<l;){h=s[f];var x=e[h],m=t[h];if(n)var k=o?n(m,x,h,t,e,i):n(x,m,h,e,t,i);if(!(k===void 0?x===m||a(x,m,r,n,i):k)){w=!1;break}v||(v=h=="constructor")}if(w&&!v){var P=e.constructor,j=t.constructor;P!=j&&"constructor"in e&&"constructor"in t&&!(typeof P=="function"&&P instanceof P&&typeof j=="function"&&j instanceof j)&&(w=!1)}return i.delete(e),i.delete(t),w}var FL=LL,GL=yc,UL=Fo,zL=GL(UL,"DataView"),WL=zL,HL=yc,VL=Fo,XL=HL(VL,"Promise"),KL=XL,YL=yc,qL=Fo,ZL=YL(qL,"Set"),UC=ZL,JL=yc,QL=Fo,eF=JL(QL,"WeakMap"),tF=eF,Nv=WL,Ov=r2,Av=KL,Tv=UC,Ev=tF,zC=ms,ed=K_,MS="[object Map]",rF="[object Object]",NS="[object Promise]",OS="[object Set]",AS="[object WeakMap]",TS="[object DataView]",nF=ed(Nv),aF=ed(Ov),iF=ed(Av),oF=ed(Tv),sF=ed(Ev),Ol=zC;(Nv&&Ol(new Nv(new ArrayBuffer(1)))!=TS||Ov&&Ol(new Ov)!=MS||Av&&Ol(Av.resolve())!=NS||Tv&&Ol(new Tv)!=OS||Ev&&Ol(new Ev)!=AS)&&(Ol=function(e){var t=zC(e),r=t==rF?e.constructor:void 0,n=r?ed(r):"";if(n)switch(n){case nF:return TS;case aF:return MS;case iF:return NS;case oF:return OS;case sF:return AS}return t});var lF=Ol,By=AC,cF=$C,uF=G9,dF=FL,ES=lF,IS=ci,$S=BC,fF=FC,hF=1,DS="[object Arguments]",RS="[object Array]",dh="[object Object]",pF=Object.prototype,BS=pF.hasOwnProperty;function gF(e,t,r,n,a,i){var o=IS(e),s=IS(t),l=o?RS:ES(e),u=s?RS:ES(t);l=l==DS?dh:l,u=u==DS?dh:u;var d=l==dh,f=u==dh,h=l==u;if(h&&$S(e)){if(!$S(t))return!1;o=!0,d=!1}if(h&&!d)return i||(i=new By),o||fF(e)?cF(e,t,r,n,a,i):uF(e,t,l,r,n,a,i);if(!(r&hF)){var g=d&&BS.call(e,"__wrapped__"),b=f&&BS.call(t,"__wrapped__");if(g||b){var w=g?e.value():e,v=b?t.value():t;return i||(i=new By),a(w,v,r,n,i)}}return h?(i||(i=new By),dF(e,t,r,n,a,i)):!1}var mF=gF,yF=mF,LS=ys;function WC(e,t,r,n,a){return e===t?!0:e==null||t==null||!LS(e)&&!LS(t)?e!==e&&t!==t:yF(e,t,r,n,WC,a)}var v2=WC,xF=AC,vF=v2,bF=1,wF=2;function kF(e,t,r,n){var a=r.length,i=a,o=!n;if(e==null)return!i;for(e=Object(e);a--;){var s=r[a];if(o&&s[2]?s[1]!==e[s[0]]:!(s[0]in e))return!1}for(;++a<i;){s=r[a];var l=s[0],u=e[l],d=s[1];if(o&&s[2]){if(u===void 0&&!(l in e))return!1}else{var f=new xF;if(n)var h=n(u,d,l,e,t,f);if(!(h===void 0?vF(d,u,bF|wF,n,f):h))return!1}}return!0}var SF=kF,jF=ul;function PF(e){return e===e&&!jF(e)}var HC=PF,_F=HC,CF=fm;function MF(e){for(var t=CF(e),r=t.length;r--;){var n=t[r],a=e[n];t[r]=[n,a,_F(a)]}return t}var NF=MF;function OF(e,t){return function(r){return r==null?!1:r[e]===t&&(t!==void 0||e in Object(r))}}var VC=OF,AF=SF,TF=NF,EF=VC;function IF(e){var t=TF(e);return t.length==1&&t[0][2]?EF(t[0][0],t[0][1]):function(r){return r===e||AF(r,e,t)}}var $F=IF;function DF(e,t){return e!=null&&t in Object(e)}var RF=DF,BF=Q_,LF=m2,FF=ci,GF=y2,UF=x2,zF=qg;function WF(e,t,r){t=BF(t,e);for(var n=-1,a=t.length,i=!1;++n<a;){var o=zF(t[n]);if(!(i=e!=null&&r(e,o)))break;e=e[o]}return i||++n!=a?i:(a=e==null?0:e.length,!!a&&UF(a)&&GF(o,a)&&(FF(e)||LF(e)))}var HF=WF,VF=RF,XF=HF;function KF(e,t){return e!=null&&XF(e,t,VF)}var YF=KF,qF=v2,ZF=eC,JF=YF,QF=Qb,eG=HC,tG=VC,rG=qg,nG=1,aG=2;function iG(e,t){return QF(e)&&eG(t)?tG(rG(e),t):function(r){var n=ZF(r,e);return n===void 0&&n===t?JF(r,e):qF(t,n,nG|aG)}}var oG=iG;function sG(e){return e}var td=sG;function lG(e){return function(t){return t==null?void 0:t[e]}}var cG=lG,uG=o2;function dG(e){return function(t){return uG(t,e)}}var fG=dG,hG=cG,pG=fG,gG=Qb,mG=qg;function yG(e){return gG(e)?hG(mG(e)):pG(e)}var xG=yG,vG=$F,bG=oG,wG=td,kG=ci,SG=xG;function jG(e){return typeof e=="function"?e:e==null?wG:typeof e=="object"?kG(e)?bG(e[0],e[1]):vG(e):SG(e)}var dl=jG;function PG(e,t,r,n){for(var a=e.length,i=r+(n?1:-1);n?i--:++i<a;)if(t(e[i],i,e))return i;return-1}var XC=PG;function _G(e){return e!==e}var CG=_G;function MG(e,t,r){for(var n=r-1,a=e.length;++n<a;)if(e[n]===t)return n;return-1}var NG=MG,OG=XC,AG=CG,TG=NG;function EG(e,t,r){return t===t?TG(e,t,r):OG(e,AG,r)}var IG=EG,$G=IG;function DG(e,t){var r=e==null?0:e.length;return!!r&&$G(e,t,0)>-1}var RG=DG;function BG(e,t,r){for(var n=-1,a=e==null?0:e.length;++n<a;)if(r(t,e[n]))return!0;return!1}var LG=BG;function FG(){}var GG=FG,Ly=UC,UG=GG,zG=g2,WG=1/0,HG=Ly&&1/zG(new Ly([,-0]))[1]==WG?function(e){return new Ly(e)}:UG,VG=HG,XG=TC,KG=RG,YG=LG,qG=IC,ZG=VG,JG=g2,QG=200;function eU(e,t,r){var n=-1,a=KG,i=e.length,o=!0,s=[],l=s;if(r)o=!1,a=YG;else if(i>=QG){var u=t?null:ZG(e);if(u)return JG(u);o=!1,a=qG,l=new XG}else l=t?[]:s;e:for(;++n<i;){var d=e[n],f=t?t(d):d;if(d=r||d!==0?d:0,o&&f===f){for(var h=l.length;h--;)if(l[h]===f)continue e;t&&l.push(f),s.push(d)}else a(l,f,r)||(l!==s&&l.push(f),s.push(d))}return s}var tU=eU,rU=dl,nU=tU;function aU(e,t){return e&&e.length?nU(e,rU(t)):[]}var iU=aU;const FS=on(iU);function KC(e,t,r){return t===!0?FS(e,r):tr(t)?FS(e,t):e}function yu(e){"@babel/helpers - typeof";return yu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},yu(e)}var oU=["ref"];function GS(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Yo(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?GS(Object(r),!0).forEach(function(n){hm(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):GS(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function sU(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function US(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,qC(n.key),n)}}function lU(e,t,r){return t&&US(e.prototype,t),r&&US(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function cU(e,t,r){return t=Op(t),uU(e,YC()?Reflect.construct(t,r||[],Op(e).constructor):t.apply(e,r))}function uU(e,t){if(t&&(yu(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return dU(e)}function dU(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function YC(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(YC=function(){return!!e})()}function Op(e){return Op=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Op(e)}function fU(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Iv(e,t)}function Iv(e,t){return Iv=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},Iv(e,t)}function hm(e,t,r){return t=qC(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function qC(e){var t=hU(e,"string");return yu(t)=="symbol"?t:t+""}function hU(e,t){if(yu(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(yu(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}function pU(e,t){if(e==null)return{};var r=gU(e,t),n,a;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function gU(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function mU(e){return e.value}function yU(e,t){if(oe.isValidElement(e))return oe.cloneElement(e,t);if(typeof e=="function")return oe.createElement(e,t);t.ref;var r=pU(t,oU);return oe.createElement(p2,r)}var zS=1,To=function(e){function t(){var r;sU(this,t);for(var n=arguments.length,a=new Array(n),i=0;i<n;i++)a[i]=arguments[i];return r=cU(this,t,[].concat(a)),hm(r,"lastBoundingBox",{width:-1,height:-1}),r}return fU(t,e),lU(t,[{key:"componentDidMount",value:function(){this.updateBBox()}},{key:"componentDidUpdate",value:function(){this.updateBBox()}},{key:"getBBox",value:function(){if(this.wrapperNode&&this.wrapperNode.getBoundingClientRect){var n=this.wrapperNode.getBoundingClientRect();return n.height=this.wrapperNode.offsetHeight,n.width=this.wrapperNode.offsetWidth,n}return null}},{key:"updateBBox",value:function(){var n=this.props.onBBoxUpdate,a=this.getBBox();a?(Math.abs(a.width-this.lastBoundingBox.width)>zS||Math.abs(a.height-this.lastBoundingBox.height)>zS)&&(this.lastBoundingBox.width=a.width,this.lastBoundingBox.height=a.height,n&&n(a)):(this.lastBoundingBox.width!==-1||this.lastBoundingBox.height!==-1)&&(this.lastBoundingBox.width=-1,this.lastBoundingBox.height=-1,n&&n(null))}},{key:"getBBoxSnapshot",value:function(){return this.lastBoundingBox.width>=0&&this.lastBoundingBox.height>=0?Yo({},this.lastBoundingBox):{width:0,height:0}}},{key:"getDefaultPosition",value:function(n){var a=this.props,i=a.layout,o=a.align,s=a.verticalAlign,l=a.margin,u=a.chartWidth,d=a.chartHeight,f,h;if(!n||(n.left===void 0||n.left===null)&&(n.right===void 0||n.right===null))if(o==="center"&&i==="vertical"){var g=this.getBBoxSnapshot();f={left:((u||0)-g.width)/2}}else f=o==="right"?{right:l&&l.right||0}:{left:l&&l.left||0};if(!n||(n.top===void 0||n.top===null)&&(n.bottom===void 0||n.bottom===null))if(s==="middle"){var b=this.getBBoxSnapshot();h={top:((d||0)-b.height)/2}}else h=s==="bottom"?{bottom:l&&l.bottom||0}:{top:l&&l.top||0};return Yo(Yo({},f),h)}},{key:"render",value:function(){var n=this,a=this.props,i=a.content,o=a.width,s=a.height,l=a.wrapperStyle,u=a.payloadUniqBy,d=a.payload,f=Yo(Yo({position:"absolute",width:o||"auto",height:s||"auto"},this.getDefaultPosition(l)),l);return oe.createElement("div",{className:"recharts-legend-wrapper",style:f,ref:function(g){n.wrapperNode=g}},yU(i,Yo(Yo({},this.props),{},{payload:KC(d,u,mU)})))}}],[{key:"getWithHeight",value:function(n,a){var i=Yo(Yo({},this.defaultProps),n.props),o=i.layout;return o==="vertical"&&Fe(n.props.height)?{height:n.props.height}:o==="horizontal"?{width:n.props.width||a}:null}}])}(_.PureComponent);hm(To,"displayName","Legend");hm(To,"defaultProps",{iconSize:14,layout:"horizontal",align:"center",verticalAlign:"bottom"});var WS=y0,xU=m2,vU=ci,HS=WS?WS.isConcatSpreadable:void 0;function bU(e){return vU(e)||xU(e)||!!(HS&&e&&e[HS])}var wU=bU,kU=DC,SU=wU;function ZC(e,t,r,n,a){var i=-1,o=e.length;for(r||(r=SU),a||(a=[]);++i<o;){var s=e[i];t>0&&r(s)?t>1?ZC(s,t-1,r,n,a):kU(a,s):n||(a[a.length]=s)}return a}var JC=ZC;function jU(e){return function(t,r,n){for(var a=-1,i=Object(t),o=n(t),s=o.length;s--;){var l=o[e?s:++a];if(r(i[l],l,i)===!1)break}return t}}var PU=jU,_U=PU,CU=_U(),MU=CU,NU=MU,OU=fm;function AU(e,t){return e&&NU(e,t,OU)}var QC=AU,TU=x0;function EU(e,t){return function(r,n){if(r==null)return r;if(!TU(r))return e(r,n);for(var a=r.length,i=t?a:-1,o=Object(r);(t?i--:++i<a)&&n(o[i],i,o)!==!1;);return r}}var IU=EU,$U=QC,DU=IU,RU=DU($U),b2=RU,BU=b2,LU=x0;function FU(e,t){var r=-1,n=LU(e)?Array(e.length):[];return BU(e,function(a,i,o){n[++r]=t(a,i,o)}),n}var eM=FU;function GU(e,t){var r=e.length;for(e.sort(t);r--;)e[r]=e[r].value;return e}var UU=GU,VS=Xu;function zU(e,t){if(e!==t){var r=e!==void 0,n=e===null,a=e===e,i=VS(e),o=t!==void 0,s=t===null,l=t===t,u=VS(t);if(!s&&!u&&!i&&e>t||i&&o&&l&&!s&&!u||n&&o&&l||!r&&l||!a)return 1;if(!n&&!i&&!u&&e<t||u&&r&&a&&!n&&!i||s&&r&&a||!o&&a||!l)return-1}return 0}var WU=zU,HU=WU;function VU(e,t,r){for(var n=-1,a=e.criteria,i=t.criteria,o=a.length,s=r.length;++n<o;){var l=HU(a[n],i[n]);if(l){if(n>=s)return l;var u=r[n];return l*(u=="desc"?-1:1)}}return e.index-t.index}var XU=VU,Fy=i2,KU=o2,YU=dl,qU=eM,ZU=UU,JU=LC,QU=XU,ez=td,tz=ci;function rz(e,t,r){t.length?t=Fy(t,function(i){return tz(i)?function(o){return KU(o,i.length===1?i[0]:i)}:i}):t=[ez];var n=-1;t=Fy(t,JU(YU));var a=qU(e,function(i,o,s){var l=Fy(t,function(u){return u(i)});return{criteria:l,index:++n,value:i}});return ZU(a,function(i,o){return QU(i,o,r)})}var nz=rz;function az(e,t,r){switch(r.length){case 0:return e.call(t);case 1:return e.call(t,r[0]);case 2:return e.call(t,r[0],r[1]);case 3:return e.call(t,r[0],r[1],r[2])}return e.apply(t,r)}var iz=az,oz=iz,XS=Math.max;function sz(e,t,r){return t=XS(t===void 0?e.length-1:t,0),function(){for(var n=arguments,a=-1,i=XS(n.length-t,0),o=Array(i);++a<i;)o[a]=n[t+a];a=-1;for(var s=Array(t+1);++a<t;)s[a]=n[a];return s[t]=r(o),oz(e,this,s)}}var lz=sz;function cz(e){return function(){return e}}var uz=cz,dz=yc,fz=function(){try{var e=dz(Object,"defineProperty");return e({},"",{}),e}catch{}}(),tM=fz,hz=uz,KS=tM,pz=td,gz=KS?function(e,t){return KS(e,"toString",{configurable:!0,enumerable:!1,value:hz(t),writable:!0})}:pz,mz=gz,yz=800,xz=16,vz=Date.now;function bz(e){var t=0,r=0;return function(){var n=vz(),a=xz-(n-r);if(r=n,a>0){if(++t>=yz)return arguments[0]}else t=0;return e.apply(void 0,arguments)}}var wz=bz,kz=mz,Sz=wz,jz=Sz(kz),Pz=jz,_z=td,Cz=lz,Mz=Pz;function Nz(e,t){return Mz(Cz(e,t,_z),e+"")}var Oz=Nz,Az=t2,Tz=x0,Ez=y2,Iz=ul;function $z(e,t,r){if(!Iz(r))return!1;var n=typeof t;return(n=="number"?Tz(r)&&Ez(t,r.length):n=="string"&&t in r)?Az(r[t],e):!1}var pm=$z,Dz=JC,Rz=nz,Bz=Oz,YS=pm,Lz=Bz(function(e,t){if(e==null)return[];var r=t.length;return r>1&&YS(e,t[0],t[1])?t=[]:r>2&&YS(t[0],t[1],t[2])&&(t=[t[0]]),Rz(e,Dz(t,1),[])}),Fz=Lz;const w2=on(Fz);function Af(e){"@babel/helpers - typeof";return Af=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Af(e)}function $v(){return $v=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},$v.apply(this,arguments)}function Gz(e,t){return Hz(e)||Wz(e,t)||zz(e,t)||Uz()}function Uz(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function zz(e,t){if(e){if(typeof e=="string")return qS(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return qS(e,t)}}function qS(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Wz(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,a,i,o,s=[],l=!0,u=!1;try{if(i=(r=r.call(e)).next,t!==0)for(;!(l=(n=i.call(r)).done)&&(s.push(n.value),s.length!==t);l=!0);}catch(d){u=!0,a=d}finally{try{if(!l&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(u)throw a}}return s}}function Hz(e){if(Array.isArray(e))return e}function ZS(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Gy(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?ZS(Object(r),!0).forEach(function(n){Vz(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ZS(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Vz(e,t,r){return t=Xz(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Xz(e){var t=Kz(e,"string");return Af(t)=="symbol"?t:t+""}function Kz(e,t){if(Af(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(Af(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Yz(e){return Array.isArray(e)&&aa(e[0])&&aa(e[1])?e.join(" ~ "):e}var qz=function(t){var r=t.separator,n=r===void 0?" : ":r,a=t.contentStyle,i=a===void 0?{}:a,o=t.itemStyle,s=o===void 0?{}:o,l=t.labelStyle,u=l===void 0?{}:l,d=t.payload,f=t.formatter,h=t.itemSorter,g=t.wrapperClassName,b=t.labelClassName,w=t.label,v=t.labelFormatter,x=t.accessibilityLayer,m=x===void 0?!1:x,k=function(){if(d&&d.length){var B={padding:0,margin:0},z=(h?w2(d,h):d).map(function(Y,G){if(Y.type==="none")return null;var $=Gy({display:"block",paddingTop:4,paddingBottom:4,color:Y.color||"#000"},s),L=Y.formatter||f||Yz,U=Y.value,V=Y.name,J=U,K=V;if(L&&J!=null&&K!=null){var Q=L(U,V,Y,G,d);if(Array.isArray(Q)){var te=Gz(Q,2);J=te[0],K=te[1]}else J=Q}return oe.createElement("li",{className:"recharts-tooltip-item",key:"tooltip-item-".concat(G),style:$},aa(K)?oe.createElement("span",{className:"recharts-tooltip-item-name"},K):null,aa(K)?oe.createElement("span",{className:"recharts-tooltip-item-separator"},n):null,oe.createElement("span",{className:"recharts-tooltip-item-value"},J),oe.createElement("span",{className:"recharts-tooltip-item-unit"},Y.unit||""))});return oe.createElement("ul",{className:"recharts-tooltip-item-list",style:B},z)}return null},P=Gy({margin:0,padding:10,backgroundColor:"#fff",border:"1px solid #ccc",whiteSpace:"nowrap"},i),j=Gy({margin:0},u),S=!Zt(w),M=S?w:"",O=kr("recharts-default-tooltip",g),E=kr("recharts-tooltip-label",b);S&&v&&d!==void 0&&d!==null&&(M=v(w,d));var I=m?{role:"status","aria-live":"assertive"}:{};return oe.createElement("div",$v({className:O,style:P},I),oe.createElement("p",{className:E,style:j},oe.isValidElement(M)?M:"".concat(M)),k())};function Tf(e){"@babel/helpers - typeof";return Tf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Tf(e)}function fh(e,t,r){return t=Zz(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Zz(e){var t=Jz(e,"string");return Tf(t)=="symbol"?t:t+""}function Jz(e,t){if(Tf(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(Tf(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Nd="recharts-tooltip-wrapper",Qz={visibility:"hidden"};function eW(e){var t=e.coordinate,r=e.translateX,n=e.translateY;return kr(Nd,fh(fh(fh(fh({},"".concat(Nd,"-right"),Fe(r)&&t&&Fe(t.x)&&r>=t.x),"".concat(Nd,"-left"),Fe(r)&&t&&Fe(t.x)&&r<t.x),"".concat(Nd,"-bottom"),Fe(n)&&t&&Fe(t.y)&&n>=t.y),"".concat(Nd,"-top"),Fe(n)&&t&&Fe(t.y)&&n<t.y))}function JS(e){var t=e.allowEscapeViewBox,r=e.coordinate,n=e.key,a=e.offsetTopLeft,i=e.position,o=e.reverseDirection,s=e.tooltipDimension,l=e.viewBox,u=e.viewBoxDimension;if(i&&Fe(i[n]))return i[n];var d=r[n]-s-a,f=r[n]+a;if(t[n])return o[n]?d:f;if(o[n]){var h=d,g=l[n];return h<g?Math.max(f,l[n]):Math.max(d,l[n])}var b=f+s,w=l[n]+u;return b>w?Math.max(d,l[n]):Math.max(f,l[n])}function tW(e){var t=e.translateX,r=e.translateY,n=e.useTranslate3d;return{transform:n?"translate3d(".concat(t,"px, ").concat(r,"px, 0)"):"translate(".concat(t,"px, ").concat(r,"px)")}}function rW(e){var t=e.allowEscapeViewBox,r=e.coordinate,n=e.offsetTopLeft,a=e.position,i=e.reverseDirection,o=e.tooltipBox,s=e.useTranslate3d,l=e.viewBox,u,d,f;return o.height>0&&o.width>0&&r?(d=JS({allowEscapeViewBox:t,coordinate:r,key:"x",offsetTopLeft:n,position:a,reverseDirection:i,tooltipDimension:o.width,viewBox:l,viewBoxDimension:l.width}),f=JS({allowEscapeViewBox:t,coordinate:r,key:"y",offsetTopLeft:n,position:a,reverseDirection:i,tooltipDimension:o.height,viewBox:l,viewBoxDimension:l.height}),u=tW({translateX:d,translateY:f,useTranslate3d:s})):u=Qz,{cssProperties:u,cssClasses:eW({translateX:d,translateY:f,coordinate:r})}}function xu(e){"@babel/helpers - typeof";return xu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},xu(e)}function QS(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function e3(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?QS(Object(r),!0).forEach(function(n){Rv(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):QS(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function nW(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function aW(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,nM(n.key),n)}}function iW(e,t,r){return t&&aW(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function oW(e,t,r){return t=Ap(t),sW(e,rM()?Reflect.construct(t,r||[],Ap(e).constructor):t.apply(e,r))}function sW(e,t){if(t&&(xu(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return lW(e)}function lW(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function rM(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(rM=function(){return!!e})()}function Ap(e){return Ap=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Ap(e)}function cW(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Dv(e,t)}function Dv(e,t){return Dv=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},Dv(e,t)}function Rv(e,t,r){return t=nM(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function nM(e){var t=uW(e,"string");return xu(t)=="symbol"?t:t+""}function uW(e,t){if(xu(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(xu(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var t3=1,dW=function(e){function t(){var r;nW(this,t);for(var n=arguments.length,a=new Array(n),i=0;i<n;i++)a[i]=arguments[i];return r=oW(this,t,[].concat(a)),Rv(r,"state",{dismissed:!1,dismissedAtCoordinate:{x:0,y:0},lastBoundingBox:{width:-1,height:-1}}),Rv(r,"handleKeyDown",function(o){if(o.key==="Escape"){var s,l,u,d;r.setState({dismissed:!0,dismissedAtCoordinate:{x:(s=(l=r.props.coordinate)===null||l===void 0?void 0:l.x)!==null&&s!==void 0?s:0,y:(u=(d=r.props.coordinate)===null||d===void 0?void 0:d.y)!==null&&u!==void 0?u:0}})}}),r}return cW(t,e),iW(t,[{key:"updateBBox",value:function(){if(this.wrapperNode&&this.wrapperNode.getBoundingClientRect){var n=this.wrapperNode.getBoundingClientRect();(Math.abs(n.width-this.state.lastBoundingBox.width)>t3||Math.abs(n.height-this.state.lastBoundingBox.height)>t3)&&this.setState({lastBoundingBox:{width:n.width,height:n.height}})}else(this.state.lastBoundingBox.width!==-1||this.state.lastBoundingBox.height!==-1)&&this.setState({lastBoundingBox:{width:-1,height:-1}})}},{key:"componentDidMount",value:function(){document.addEventListener("keydown",this.handleKeyDown),this.updateBBox()}},{key:"componentWillUnmount",value:function(){document.removeEventListener("keydown",this.handleKeyDown)}},{key:"componentDidUpdate",value:function(){var n,a;this.props.active&&this.updateBBox(),this.state.dismissed&&(((n=this.props.coordinate)===null||n===void 0?void 0:n.x)!==this.state.dismissedAtCoordinate.x||((a=this.props.coordinate)===null||a===void 0?void 0:a.y)!==this.state.dismissedAtCoordinate.y)&&(this.state.dismissed=!1)}},{key:"render",value:function(){var n=this,a=this.props,i=a.active,o=a.allowEscapeViewBox,s=a.animationDuration,l=a.animationEasing,u=a.children,d=a.coordinate,f=a.hasPayload,h=a.isAnimationActive,g=a.offset,b=a.position,w=a.reverseDirection,v=a.useTranslate3d,x=a.viewBox,m=a.wrapperStyle,k=rW({allowEscapeViewBox:o,coordinate:d,offsetTopLeft:g,position:b,reverseDirection:w,tooltipBox:this.state.lastBoundingBox,useTranslate3d:v,viewBox:x}),P=k.cssClasses,j=k.cssProperties,S=e3(e3({transition:h&&i?"transform ".concat(s,"ms ").concat(l):void 0},j),{},{pointerEvents:"none",visibility:!this.state.dismissed&&i&&f?"visible":"hidden",position:"absolute",top:0,left:0},m);return oe.createElement("div",{tabIndex:-1,className:P,style:S,ref:function(O){n.wrapperNode=O}},u)}}])}(_.PureComponent),fW=function(){return!(typeof window<"u"&&window.document&&window.document.createElement&&window.setTimeout)},fl={isSsr:fW()};function vu(e){"@babel/helpers - typeof";return vu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},vu(e)}function r3(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function n3(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?r3(Object(r),!0).forEach(function(n){k2(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):r3(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function hW(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function pW(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,iM(n.key),n)}}function gW(e,t,r){return t&&pW(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function mW(e,t,r){return t=Tp(t),yW(e,aM()?Reflect.construct(t,r||[],Tp(e).constructor):t.apply(e,r))}function yW(e,t){if(t&&(vu(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return xW(e)}function xW(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function aM(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(aM=function(){return!!e})()}function Tp(e){return Tp=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Tp(e)}function vW(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Bv(e,t)}function Bv(e,t){return Bv=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},Bv(e,t)}function k2(e,t,r){return t=iM(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function iM(e){var t=bW(e,"string");return vu(t)=="symbol"?t:t+""}function bW(e,t){if(vu(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(vu(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}function wW(e){return e.dataKey}function kW(e,t){return oe.isValidElement(e)?oe.cloneElement(e,t):typeof e=="function"?oe.createElement(e,t):oe.createElement(qz,t)}var ra=function(e){function t(){return hW(this,t),mW(this,t,arguments)}return vW(t,e),gW(t,[{key:"render",value:function(){var n=this,a=this.props,i=a.active,o=a.allowEscapeViewBox,s=a.animationDuration,l=a.animationEasing,u=a.content,d=a.coordinate,f=a.filterNull,h=a.isAnimationActive,g=a.offset,b=a.payload,w=a.payloadUniqBy,v=a.position,x=a.reverseDirection,m=a.useTranslate3d,k=a.viewBox,P=a.wrapperStyle,j=b??[];f&&j.length&&(j=KC(b.filter(function(M){return M.value!=null&&(M.hide!==!0||n.props.includeHidden)}),w,wW));var S=j.length>0;return oe.createElement(dW,{allowEscapeViewBox:o,animationDuration:s,animationEasing:l,isAnimationActive:h,active:i,coordinate:d,hasPayload:S,offset:g,position:v,reverseDirection:x,useTranslate3d:m,viewBox:k,wrapperStyle:P},kW(u,n3(n3({},this.props),{},{payload:j})))}}])}(_.PureComponent);k2(ra,"displayName","Tooltip");k2(ra,"defaultProps",{accessibilityLayer:!1,allowEscapeViewBox:{x:!1,y:!1},animationDuration:400,animationEasing:"ease",contentStyle:{},coordinate:{x:0,y:0},cursor:!0,cursorStyle:{},filterNull:!0,isAnimationActive:!fl.isSsr,itemStyle:{},labelStyle:{},offset:10,reverseDirection:{x:!1,y:!1},separator:" : ",trigger:"hover",useTranslate3d:!1,viewBox:{x:0,y:0,height:0,width:0},wrapperStyle:{}});var SW=Fo,jW=function(){return SW.Date.now()},PW=jW,_W=/\s/;function CW(e){for(var t=e.length;t--&&_W.test(e.charAt(t)););return t}var MW=CW,NW=MW,OW=/^\s+/;function AW(e){return e&&e.slice(0,NW(e)+1).replace(OW,"")}var TW=AW,EW=TW,a3=ul,IW=Xu,i3=NaN,$W=/^[-+]0x[0-9a-f]+$/i,DW=/^0b[01]+$/i,RW=/^0o[0-7]+$/i,BW=parseInt;function LW(e){if(typeof e=="number")return e;if(IW(e))return i3;if(a3(e)){var t=typeof e.valueOf=="function"?e.valueOf():e;e=a3(t)?t+"":t}if(typeof e!="string")return e===0?e:+e;e=EW(e);var r=DW.test(e);return r||RW.test(e)?BW(e.slice(2),r?2:8):$W.test(e)?i3:+e}var oM=LW,FW=ul,Uy=PW,o3=oM,GW="Expected a function",UW=Math.max,zW=Math.min;function WW(e,t,r){var n,a,i,o,s,l,u=0,d=!1,f=!1,h=!0;if(typeof e!="function")throw new TypeError(GW);t=o3(t)||0,FW(r)&&(d=!!r.leading,f="maxWait"in r,i=f?UW(o3(r.maxWait)||0,t):i,h="trailing"in r?!!r.trailing:h);function g(S){var M=n,O=a;return n=a=void 0,u=S,o=e.apply(O,M),o}function b(S){return u=S,s=setTimeout(x,t),d?g(S):o}function w(S){var M=S-l,O=S-u,E=t-M;return f?zW(E,i-O):E}function v(S){var M=S-l,O=S-u;return l===void 0||M>=t||M<0||f&&O>=i}function x(){var S=Uy();if(v(S))return m(S);s=setTimeout(x,w(S))}function m(S){return s=void 0,h&&n?g(S):(n=a=void 0,o)}function k(){s!==void 0&&clearTimeout(s),u=0,n=l=a=s=void 0}function P(){return s===void 0?o:m(Uy())}function j(){var S=Uy(),M=v(S);if(n=arguments,a=this,l=S,M){if(s===void 0)return b(l);if(f)return clearTimeout(s),s=setTimeout(x,t),g(l)}return s===void 0&&(s=setTimeout(x,t)),o}return j.cancel=k,j.flush=P,j}var HW=WW,VW=HW,XW=ul,KW="Expected a function";function YW(e,t,r){var n=!0,a=!0;if(typeof e!="function")throw new TypeError(KW);return XW(r)&&(n="leading"in r?!!r.leading:n,a="trailing"in r?!!r.trailing:a),VW(e,t,{leading:n,maxWait:t,trailing:a})}var qW=YW;const sM=on(qW);function Ef(e){"@babel/helpers - typeof";return Ef=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ef(e)}function s3(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function hh(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?s3(Object(r),!0).forEach(function(n){ZW(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):s3(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function ZW(e,t,r){return t=JW(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function JW(e){var t=QW(e,"string");return Ef(t)=="symbol"?t:t+""}function QW(e,t){if(Ef(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(Ef(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function eH(e,t){return aH(e)||nH(e,t)||rH(e,t)||tH()}function tH(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function rH(e,t){if(e){if(typeof e=="string")return l3(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return l3(e,t)}}function l3(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function nH(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,a,i,o,s=[],l=!0,u=!1;try{if(i=(r=r.call(e)).next,t!==0)for(;!(l=(n=i.call(r)).done)&&(s.push(n.value),s.length!==t);l=!0);}catch(d){u=!0,a=d}finally{try{if(!l&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(u)throw a}}return s}}function aH(e){if(Array.isArray(e))return e}var _o=_.forwardRef(function(e,t){var r=e.aspect,n=e.initialDimension,a=n===void 0?{width:-1,height:-1}:n,i=e.width,o=i===void 0?"100%":i,s=e.height,l=s===void 0?"100%":s,u=e.minWidth,d=u===void 0?0:u,f=e.minHeight,h=e.maxHeight,g=e.children,b=e.debounce,w=b===void 0?0:b,v=e.id,x=e.className,m=e.onResize,k=e.style,P=k===void 0?{}:k,j=_.useRef(null),S=_.useRef();S.current=m,_.useImperativeHandle(t,function(){return Object.defineProperty(j.current,"current",{get:function(){return console.warn("The usage of ref.current.current is deprecated and will no longer be supported."),j.current},configurable:!0})});var M=_.useState({containerWidth:a.width,containerHeight:a.height}),O=eH(M,2),E=O[0],I=O[1],D=_.useCallback(function(z,Y){I(function(G){var $=Math.round(z),L=Math.round(Y);return G.containerWidth===$&&G.containerHeight===L?G:{containerWidth:$,containerHeight:L}})},[]);_.useEffect(function(){var z=function(V){var J,K=V[0].contentRect,Q=K.width,te=K.height;D(Q,te),(J=S.current)===null||J===void 0||J.call(S,Q,te)};w>0&&(z=sM(z,w,{trailing:!0,leading:!1}));var Y=new ResizeObserver(z),G=j.current.getBoundingClientRect(),$=G.width,L=G.height;return D($,L),Y.observe(j.current),function(){Y.disconnect()}},[D,w]);var B=_.useMemo(function(){var z=E.containerWidth,Y=E.containerHeight;if(z<0||Y<0)return null;os(Bl(o)||Bl(l),`The width(%s) and height(%s) are both fixed numbers,
       maybe you don't need to use a ResponsiveContainer.`,o,l),os(!r||r>0,"The aspect(%s) must be greater than zero.",r);var G=Bl(o)?z:o,$=Bl(l)?Y:l;r&&r>0&&(G?$=G/r:$&&(G=$*r),h&&$>h&&($=h)),os(G>0||$>0,`The width(%s) and height(%s) of chart should be greater than 0,
       please check the style of container, or the props width(%s) and height(%s),
       or add a minWidth(%s) or minHeight(%s) or use aspect(%s) to control the
       height and width.`,G,$,o,l,d,f,r);var L=!Array.isArray(g)&&is(g.type).endsWith("Chart");return oe.Children.map(g,function(U){return oe.isValidElement(U)?_.cloneElement(U,hh({width:G,height:$},L?{style:hh({height:"100%",width:"100%",maxHeight:$,maxWidth:G},U.props.style)}:{})):U})},[r,g,l,h,f,d,E,o]);return oe.createElement("div",{id:v?"".concat(v):void 0,className:kr("recharts-responsive-container",x),style:hh(hh({},P),{},{width:o,height:l,minWidth:d,minHeight:f,maxHeight:h}),ref:j},B)}),S2=function(t){return null};S2.displayName="Cell";function If(e){"@babel/helpers - typeof";return If=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},If(e)}function c3(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Lv(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?c3(Object(r),!0).forEach(function(n){iH(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):c3(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function iH(e,t,r){return t=oH(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function oH(e){var t=sH(e,"string");return If(t)=="symbol"?t:t+""}function sH(e,t){if(If(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(If(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Ac={widthCache:{},cacheCount:0},lH=2e3,cH={position:"absolute",top:"-20000px",left:0,padding:0,margin:0,border:"none",whiteSpace:"pre"},u3="recharts_measurement_span";function uH(e){var t=Lv({},e);return Object.keys(t).forEach(function(r){t[r]||delete t[r]}),t}var tf=function(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(t==null||fl.isSsr)return{width:0,height:0};var n=uH(r),a=JSON.stringify({text:t,copyStyle:n});if(Ac.widthCache[a])return Ac.widthCache[a];try{var i=document.getElementById(u3);i||(i=document.createElement("span"),i.setAttribute("id",u3),i.setAttribute("aria-hidden","true"),document.body.appendChild(i));var o=Lv(Lv({},cH),n);Object.assign(i.style,o),i.textContent="".concat(t);var s=i.getBoundingClientRect(),l={width:s.width,height:s.height};return Ac.widthCache[a]=l,++Ac.cacheCount>lH&&(Ac.cacheCount=0,Ac.widthCache={}),l}catch{return{width:0,height:0}}},dH=function(t){return{top:t.top+window.scrollY-document.documentElement.clientTop,left:t.left+window.scrollX-document.documentElement.clientLeft}};function $f(e){"@babel/helpers - typeof";return $f=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},$f(e)}function Ep(e,t){return gH(e)||pH(e,t)||hH(e,t)||fH()}function fH(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function hH(e,t){if(e){if(typeof e=="string")return d3(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return d3(e,t)}}function d3(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function pH(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,a,i,o,s=[],l=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=i.call(r)).done)&&(s.push(n.value),s.length!==t);l=!0);}catch(d){u=!0,a=d}finally{try{if(!l&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(u)throw a}}return s}}function gH(e){if(Array.isArray(e))return e}function mH(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function f3(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,xH(n.key),n)}}function yH(e,t,r){return t&&f3(e.prototype,t),r&&f3(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function xH(e){var t=vH(e,"string");return $f(t)=="symbol"?t:t+""}function vH(e,t){if($f(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if($f(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var h3=/(-?\d+(?:\.\d+)?[a-zA-Z%]*)([*/])(-?\d+(?:\.\d+)?[a-zA-Z%]*)/,p3=/(-?\d+(?:\.\d+)?[a-zA-Z%]*)([+-])(-?\d+(?:\.\d+)?[a-zA-Z%]*)/,bH=/^px|cm|vh|vw|em|rem|%|mm|in|pt|pc|ex|ch|vmin|vmax|Q$/,wH=/(-?\d+(?:\.\d+)?)([a-zA-Z%]+)?/,lM={cm:96/2.54,mm:96/25.4,pt:96/72,pc:96/6,in:96,Q:96/(2.54*40),px:1},kH=Object.keys(lM),Xc="NaN";function SH(e,t){return e*lM[t]}var ph=function(){function e(t,r){mH(this,e),this.num=t,this.unit=r,this.num=t,this.unit=r,Number.isNaN(t)&&(this.unit=""),r!==""&&!bH.test(r)&&(this.num=NaN,this.unit=""),kH.includes(r)&&(this.num=SH(t,r),this.unit="px")}return yH(e,[{key:"add",value:function(r){return this.unit!==r.unit?new e(NaN,""):new e(this.num+r.num,this.unit)}},{key:"subtract",value:function(r){return this.unit!==r.unit?new e(NaN,""):new e(this.num-r.num,this.unit)}},{key:"multiply",value:function(r){return this.unit!==""&&r.unit!==""&&this.unit!==r.unit?new e(NaN,""):new e(this.num*r.num,this.unit||r.unit)}},{key:"divide",value:function(r){return this.unit!==""&&r.unit!==""&&this.unit!==r.unit?new e(NaN,""):new e(this.num/r.num,this.unit||r.unit)}},{key:"toString",value:function(){return"".concat(this.num).concat(this.unit)}},{key:"isNaN",value:function(){return Number.isNaN(this.num)}}],[{key:"parse",value:function(r){var n,a=(n=wH.exec(r))!==null&&n!==void 0?n:[],i=Ep(a,3),o=i[1],s=i[2];return new e(parseFloat(o),s??"")}}])}();function cM(e){if(e.includes(Xc))return Xc;for(var t=e;t.includes("*")||t.includes("/");){var r,n=(r=h3.exec(t))!==null&&r!==void 0?r:[],a=Ep(n,4),i=a[1],o=a[2],s=a[3],l=ph.parse(i??""),u=ph.parse(s??""),d=o==="*"?l.multiply(u):l.divide(u);if(d.isNaN())return Xc;t=t.replace(h3,d.toString())}for(;t.includes("+")||/.-\d+(?:\.\d+)?/.test(t);){var f,h=(f=p3.exec(t))!==null&&f!==void 0?f:[],g=Ep(h,4),b=g[1],w=g[2],v=g[3],x=ph.parse(b??""),m=ph.parse(v??""),k=w==="+"?x.add(m):x.subtract(m);if(k.isNaN())return Xc;t=t.replace(p3,k.toString())}return t}var g3=/\(([^()]*)\)/;function jH(e){for(var t=e;t.includes("(");){var r=g3.exec(t),n=Ep(r,2),a=n[1];t=t.replace(g3,cM(a))}return t}function PH(e){var t=e.replace(/\s+/g,"");return t=jH(t),t=cM(t),t}function _H(e){try{return PH(e)}catch{return Xc}}function zy(e){var t=_H(e.slice(5,-1));return t===Xc?"":t}var CH=["x","y","lineHeight","capHeight","scaleToFit","textAnchor","verticalAnchor","fill"],MH=["dx","dy","angle","className","breakAll"];function Fv(){return Fv=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Fv.apply(this,arguments)}function m3(e,t){if(e==null)return{};var r=NH(e,t),n,a;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function NH(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function y3(e,t){return EH(e)||TH(e,t)||AH(e,t)||OH()}function OH(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function AH(e,t){if(e){if(typeof e=="string")return x3(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return x3(e,t)}}function x3(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function TH(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,a,i,o,s=[],l=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=i.call(r)).done)&&(s.push(n.value),s.length!==t);l=!0);}catch(d){u=!0,a=d}finally{try{if(!l&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(u)throw a}}return s}}function EH(e){if(Array.isArray(e))return e}var uM=/[ \f\n\r\t\v\u2028\u2029]+/,dM=function(t){var r=t.children,n=t.breakAll,a=t.style;try{var i=[];Zt(r)||(n?i=r.toString().split(""):i=r.toString().split(uM));var o=i.map(function(l){return{word:l,width:tf(l,a).width}}),s=n?0:tf("",a).width;return{wordsWithComputedWidth:o,spaceWidth:s}}catch{return null}},IH=function(t,r,n,a,i){var o=t.maxLines,s=t.children,l=t.style,u=t.breakAll,d=Fe(o),f=s,h=function(){var G=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return G.reduce(function($,L){var U=L.word,V=L.width,J=$[$.length-1];if(J&&(a==null||i||J.width+V+n<Number(a)))J.words.push(U),J.width+=V+n;else{var K={words:[U],width:V};$.push(K)}return $},[])},g=h(r),b=function(G){return G.reduce(function($,L){return $.width>L.width?$:L})};if(!d)return g;for(var w="",v=function(G){var $=f.slice(0,G),L=dM({breakAll:u,style:l,children:$+w}).wordsWithComputedWidth,U=h(L),V=U.length>o||b(U).width>Number(a);return[V,U]},x=0,m=f.length-1,k=0,P;x<=m&&k<=f.length-1;){var j=Math.floor((x+m)/2),S=j-1,M=v(S),O=y3(M,2),E=O[0],I=O[1],D=v(j),B=y3(D,1),z=B[0];if(!E&&!z&&(x=j+1),E&&z&&(m=j-1),!E&&z){P=I;break}k++}return P||g},v3=function(t){var r=Zt(t)?[]:t.toString().split(uM);return[{words:r}]},$H=function(t){var r=t.width,n=t.scaleToFit,a=t.children,i=t.style,o=t.breakAll,s=t.maxLines;if((r||n)&&!fl.isSsr){var l,u,d=dM({breakAll:o,children:a,style:i});if(d){var f=d.wordsWithComputedWidth,h=d.spaceWidth;l=f,u=h}else return v3(a);return IH({breakAll:o,children:a,maxLines:s,style:i},l,u,r,n)}return v3(a)},b3="#808080",Ip=function(t){var r=t.x,n=r===void 0?0:r,a=t.y,i=a===void 0?0:a,o=t.lineHeight,s=o===void 0?"1em":o,l=t.capHeight,u=l===void 0?"0.71em":l,d=t.scaleToFit,f=d===void 0?!1:d,h=t.textAnchor,g=h===void 0?"start":h,b=t.verticalAnchor,w=b===void 0?"end":b,v=t.fill,x=v===void 0?b3:v,m=m3(t,CH),k=_.useMemo(function(){return $H({breakAll:m.breakAll,children:m.children,maxLines:m.maxLines,scaleToFit:f,style:m.style,width:m.width})},[m.breakAll,m.children,m.maxLines,f,m.style,m.width]),P=m.dx,j=m.dy,S=m.angle,M=m.className,O=m.breakAll,E=m3(m,MH);if(!aa(n)||!aa(i))return null;var I=n+(Fe(P)?P:0),D=i+(Fe(j)?j:0),B;switch(w){case"start":B=zy("calc(".concat(u,")"));break;case"middle":B=zy("calc(".concat((k.length-1)/2," * -").concat(s," + (").concat(u," / 2))"));break;default:B=zy("calc(".concat(k.length-1," * -").concat(s,")"));break}var z=[];if(f){var Y=k[0].width,G=m.width;z.push("scale(".concat((Fe(G)?G/Y:1)/Y,")"))}return S&&z.push("rotate(".concat(S,", ").concat(I,", ").concat(D,")")),z.length&&(E.transform=z.join(" ")),oe.createElement("text",Fv({},er(E,!0),{x:I,y:D,className:kr("recharts-text",M),textAnchor:g,fill:x.includes("url")?b3:x}),k.map(function($,L){var U=$.words.join(O?"":" ");return oe.createElement("tspan",{x:I,dy:L===0?B:s,key:"".concat(U,"-").concat(L)},U)}))};function rl(e,t){return e==null||t==null?NaN:e<t?-1:e>t?1:e>=t?0:NaN}function DH(e,t){return e==null||t==null?NaN:t<e?-1:t>e?1:t>=e?0:NaN}function j2(e){let t,r,n;e.length!==2?(t=rl,r=(s,l)=>rl(e(s),l),n=(s,l)=>e(s)-l):(t=e===rl||e===DH?e:RH,r=e,n=e);function a(s,l,u=0,d=s.length){if(u<d){if(t(l,l)!==0)return d;do{const f=u+d>>>1;r(s[f],l)<0?u=f+1:d=f}while(u<d)}return u}function i(s,l,u=0,d=s.length){if(u<d){if(t(l,l)!==0)return d;do{const f=u+d>>>1;r(s[f],l)<=0?u=f+1:d=f}while(u<d)}return u}function o(s,l,u=0,d=s.length){const f=a(s,l,u,d-1);return f>u&&n(s[f-1],l)>-n(s[f],l)?f-1:f}return{left:a,center:o,right:i}}function RH(){return 0}function fM(e){return e===null?NaN:+e}function*BH(e,t){for(let r of e)r!=null&&(r=+r)>=r&&(yield r)}const LH=j2(rl),v0=LH.right;j2(fM).center;class w3 extends Map{constructor(t,r=UH){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:r}}),t!=null)for(const[n,a]of t)this.set(n,a)}get(t){return super.get(k3(this,t))}has(t){return super.has(k3(this,t))}set(t,r){return super.set(FH(this,t),r)}delete(t){return super.delete(GH(this,t))}}function k3({_intern:e,_key:t},r){const n=t(r);return e.has(n)?e.get(n):r}function FH({_intern:e,_key:t},r){const n=t(r);return e.has(n)?e.get(n):(e.set(n,r),r)}function GH({_intern:e,_key:t},r){const n=t(r);return e.has(n)&&(r=e.get(n),e.delete(n)),r}function UH(e){return e!==null&&typeof e=="object"?e.valueOf():e}function zH(e=rl){if(e===rl)return hM;if(typeof e!="function")throw new TypeError("compare is not a function");return(t,r)=>{const n=e(t,r);return n||n===0?n:(e(r,r)===0)-(e(t,t)===0)}}function hM(e,t){return(e==null||!(e>=e))-(t==null||!(t>=t))||(e<t?-1:e>t?1:0)}const WH=Math.sqrt(50),HH=Math.sqrt(10),VH=Math.sqrt(2);function $p(e,t,r){const n=(t-e)/Math.max(0,r),a=Math.floor(Math.log10(n)),i=n/Math.pow(10,a),o=i>=WH?10:i>=HH?5:i>=VH?2:1;let s,l,u;return a<0?(u=Math.pow(10,-a)/o,s=Math.round(e*u),l=Math.round(t*u),s/u<e&&++s,l/u>t&&--l,u=-u):(u=Math.pow(10,a)*o,s=Math.round(e/u),l=Math.round(t/u),s*u<e&&++s,l*u>t&&--l),l<s&&.5<=r&&r<2?$p(e,t,r*2):[s,l,u]}function Gv(e,t,r){if(t=+t,e=+e,r=+r,!(r>0))return[];if(e===t)return[e];const n=t<e,[a,i,o]=n?$p(t,e,r):$p(e,t,r);if(!(i>=a))return[];const s=i-a+1,l=new Array(s);if(n)if(o<0)for(let u=0;u<s;++u)l[u]=(i-u)/-o;else for(let u=0;u<s;++u)l[u]=(i-u)*o;else if(o<0)for(let u=0;u<s;++u)l[u]=(a+u)/-o;else for(let u=0;u<s;++u)l[u]=(a+u)*o;return l}function Uv(e,t,r){return t=+t,e=+e,r=+r,$p(e,t,r)[2]}function zv(e,t,r){t=+t,e=+e,r=+r;const n=t<e,a=n?Uv(t,e,r):Uv(e,t,r);return(n?-1:1)*(a<0?1/-a:a)}function S3(e,t){let r;for(const n of e)n!=null&&(r<n||r===void 0&&n>=n)&&(r=n);return r}function j3(e,t){let r;for(const n of e)n!=null&&(r>n||r===void 0&&n>=n)&&(r=n);return r}function pM(e,t,r=0,n=1/0,a){if(t=Math.floor(t),r=Math.floor(Math.max(0,r)),n=Math.floor(Math.min(e.length-1,n)),!(r<=t&&t<=n))return e;for(a=a===void 0?hM:zH(a);n>r;){if(n-r>600){const l=n-r+1,u=t-r+1,d=Math.log(l),f=.5*Math.exp(2*d/3),h=.5*Math.sqrt(d*f*(l-f)/l)*(u-l/2<0?-1:1),g=Math.max(r,Math.floor(t-u*f/l+h)),b=Math.min(n,Math.floor(t+(l-u)*f/l+h));pM(e,t,g,b,a)}const i=e[t];let o=r,s=n;for(Od(e,r,t),a(e[n],i)>0&&Od(e,r,n);o<s;){for(Od(e,o,s),++o,--s;a(e[o],i)<0;)++o;for(;a(e[s],i)>0;)--s}a(e[r],i)===0?Od(e,r,s):(++s,Od(e,s,n)),s<=t&&(r=s+1),t<=s&&(n=s-1)}return e}function Od(e,t,r){const n=e[t];e[t]=e[r],e[r]=n}function XH(e,t,r){if(e=Float64Array.from(BH(e)),!(!(n=e.length)||isNaN(t=+t))){if(t<=0||n<2)return j3(e);if(t>=1)return S3(e);var n,a=(n-1)*t,i=Math.floor(a),o=S3(pM(e,i).subarray(0,i+1)),s=j3(e.subarray(i+1));return o+(s-o)*(a-i)}}function KH(e,t,r=fM){if(!(!(n=e.length)||isNaN(t=+t))){if(t<=0||n<2)return+r(e[0],0,e);if(t>=1)return+r(e[n-1],n-1,e);var n,a=(n-1)*t,i=Math.floor(a),o=+r(e[i],i,e),s=+r(e[i+1],i+1,e);return o+(s-o)*(a-i)}}function YH(e,t,r){e=+e,t=+t,r=(a=arguments.length)<2?(t=e,e=0,1):a<3?1:+r;for(var n=-1,a=Math.max(0,Math.ceil((t-e)/r))|0,i=new Array(a);++n<a;)i[n]=e+n*r;return i}function Ui(e,t){switch(arguments.length){case 0:break;case 1:this.range(e);break;default:this.range(t).domain(e);break}return this}function xs(e,t){switch(arguments.length){case 0:break;case 1:{typeof e=="function"?this.interpolator(e):this.range(e);break}default:{this.domain(e),typeof t=="function"?this.interpolator(t):this.range(t);break}}return this}const Wv=Symbol("implicit");function P2(){var e=new w3,t=[],r=[],n=Wv;function a(i){let o=e.get(i);if(o===void 0){if(n!==Wv)return n;e.set(i,o=t.push(i)-1)}return r[o%r.length]}return a.domain=function(i){if(!arguments.length)return t.slice();t=[],e=new w3;for(const o of i)e.has(o)||e.set(o,t.push(o)-1);return a},a.range=function(i){return arguments.length?(r=Array.from(i),a):r.slice()},a.unknown=function(i){return arguments.length?(n=i,a):n},a.copy=function(){return P2(t,r).unknown(n)},Ui.apply(a,arguments),a}function Df(){var e=P2().unknown(void 0),t=e.domain,r=e.range,n=0,a=1,i,o,s=!1,l=0,u=0,d=.5;delete e.unknown;function f(){var h=t().length,g=a<n,b=g?a:n,w=g?n:a;i=(w-b)/Math.max(1,h-l+u*2),s&&(i=Math.floor(i)),b+=(w-b-i*(h-l))*d,o=i*(1-l),s&&(b=Math.round(b),o=Math.round(o));var v=YH(h).map(function(x){return b+i*x});return r(g?v.reverse():v)}return e.domain=function(h){return arguments.length?(t(h),f()):t()},e.range=function(h){return arguments.length?([n,a]=h,n=+n,a=+a,f()):[n,a]},e.rangeRound=function(h){return[n,a]=h,n=+n,a=+a,s=!0,f()},e.bandwidth=function(){return o},e.step=function(){return i},e.round=function(h){return arguments.length?(s=!!h,f()):s},e.padding=function(h){return arguments.length?(l=Math.min(1,u=+h),f()):l},e.paddingInner=function(h){return arguments.length?(l=Math.min(1,h),f()):l},e.paddingOuter=function(h){return arguments.length?(u=+h,f()):u},e.align=function(h){return arguments.length?(d=Math.max(0,Math.min(1,h)),f()):d},e.copy=function(){return Df(t(),[n,a]).round(s).paddingInner(l).paddingOuter(u).align(d)},Ui.apply(f(),arguments)}function gM(e){var t=e.copy;return e.padding=e.paddingOuter,delete e.paddingInner,delete e.paddingOuter,e.copy=function(){return gM(t())},e}function rf(){return gM(Df.apply(null,arguments).paddingInner(1))}function _2(e,t,r){e.prototype=t.prototype=r,r.constructor=e}function mM(e,t){var r=Object.create(e.prototype);for(var n in t)r[n]=t[n];return r}function b0(){}var Rf=.7,Dp=1/Rf,au="\\s*([+-]?\\d+)\\s*",Bf="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",Eo="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",qH=/^#([0-9a-f]{3,8})$/,ZH=new RegExp(`^rgb\\(${au},${au},${au}\\)$`),JH=new RegExp(`^rgb\\(${Eo},${Eo},${Eo}\\)$`),QH=new RegExp(`^rgba\\(${au},${au},${au},${Bf}\\)$`),eV=new RegExp(`^rgba\\(${Eo},${Eo},${Eo},${Bf}\\)$`),tV=new RegExp(`^hsl\\(${Bf},${Eo},${Eo}\\)$`),rV=new RegExp(`^hsla\\(${Bf},${Eo},${Eo},${Bf}\\)$`),P3={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};_2(b0,Lf,{copy(e){return Object.assign(new this.constructor,this,e)},displayable(){return this.rgb().displayable()},hex:_3,formatHex:_3,formatHex8:nV,formatHsl:aV,formatRgb:C3,toString:C3});function _3(){return this.rgb().formatHex()}function nV(){return this.rgb().formatHex8()}function aV(){return yM(this).formatHsl()}function C3(){return this.rgb().formatRgb()}function Lf(e){var t,r;return e=(e+"").trim().toLowerCase(),(t=qH.exec(e))?(r=t[1].length,t=parseInt(t[1],16),r===6?M3(t):r===3?new ai(t>>8&15|t>>4&240,t>>4&15|t&240,(t&15)<<4|t&15,1):r===8?gh(t>>24&255,t>>16&255,t>>8&255,(t&255)/255):r===4?gh(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|t&240,((t&15)<<4|t&15)/255):null):(t=ZH.exec(e))?new ai(t[1],t[2],t[3],1):(t=JH.exec(e))?new ai(t[1]*255/100,t[2]*255/100,t[3]*255/100,1):(t=QH.exec(e))?gh(t[1],t[2],t[3],t[4]):(t=eV.exec(e))?gh(t[1]*255/100,t[2]*255/100,t[3]*255/100,t[4]):(t=tV.exec(e))?A3(t[1],t[2]/100,t[3]/100,1):(t=rV.exec(e))?A3(t[1],t[2]/100,t[3]/100,t[4]):P3.hasOwnProperty(e)?M3(P3[e]):e==="transparent"?new ai(NaN,NaN,NaN,0):null}function M3(e){return new ai(e>>16&255,e>>8&255,e&255,1)}function gh(e,t,r,n){return n<=0&&(e=t=r=NaN),new ai(e,t,r,n)}function iV(e){return e instanceof b0||(e=Lf(e)),e?(e=e.rgb(),new ai(e.r,e.g,e.b,e.opacity)):new ai}function Hv(e,t,r,n){return arguments.length===1?iV(e):new ai(e,t,r,n??1)}function ai(e,t,r,n){this.r=+e,this.g=+t,this.b=+r,this.opacity=+n}_2(ai,Hv,mM(b0,{brighter(e){return e=e==null?Dp:Math.pow(Dp,e),new ai(this.r*e,this.g*e,this.b*e,this.opacity)},darker(e){return e=e==null?Rf:Math.pow(Rf,e),new ai(this.r*e,this.g*e,this.b*e,this.opacity)},rgb(){return this},clamp(){return new ai(Vl(this.r),Vl(this.g),Vl(this.b),Rp(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:N3,formatHex:N3,formatHex8:oV,formatRgb:O3,toString:O3}));function N3(){return`#${Ll(this.r)}${Ll(this.g)}${Ll(this.b)}`}function oV(){return`#${Ll(this.r)}${Ll(this.g)}${Ll(this.b)}${Ll((isNaN(this.opacity)?1:this.opacity)*255)}`}function O3(){const e=Rp(this.opacity);return`${e===1?"rgb(":"rgba("}${Vl(this.r)}, ${Vl(this.g)}, ${Vl(this.b)}${e===1?")":`, ${e})`}`}function Rp(e){return isNaN(e)?1:Math.max(0,Math.min(1,e))}function Vl(e){return Math.max(0,Math.min(255,Math.round(e)||0))}function Ll(e){return e=Vl(e),(e<16?"0":"")+e.toString(16)}function A3(e,t,r,n){return n<=0?e=t=r=NaN:r<=0||r>=1?e=t=NaN:t<=0&&(e=NaN),new ao(e,t,r,n)}function yM(e){if(e instanceof ao)return new ao(e.h,e.s,e.l,e.opacity);if(e instanceof b0||(e=Lf(e)),!e)return new ao;if(e instanceof ao)return e;e=e.rgb();var t=e.r/255,r=e.g/255,n=e.b/255,a=Math.min(t,r,n),i=Math.max(t,r,n),o=NaN,s=i-a,l=(i+a)/2;return s?(t===i?o=(r-n)/s+(r<n)*6:r===i?o=(n-t)/s+2:o=(t-r)/s+4,s/=l<.5?i+a:2-i-a,o*=60):s=l>0&&l<1?0:o,new ao(o,s,l,e.opacity)}function sV(e,t,r,n){return arguments.length===1?yM(e):new ao(e,t,r,n??1)}function ao(e,t,r,n){this.h=+e,this.s=+t,this.l=+r,this.opacity=+n}_2(ao,sV,mM(b0,{brighter(e){return e=e==null?Dp:Math.pow(Dp,e),new ao(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=e==null?Rf:Math.pow(Rf,e),new ao(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=this.h%360+(this.h<0)*360,t=isNaN(e)||isNaN(this.s)?0:this.s,r=this.l,n=r+(r<.5?r:1-r)*t,a=2*r-n;return new ai(Wy(e>=240?e-240:e+120,a,n),Wy(e,a,n),Wy(e<120?e+240:e-120,a,n),this.opacity)},clamp(){return new ao(T3(this.h),mh(this.s),mh(this.l),Rp(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const e=Rp(this.opacity);return`${e===1?"hsl(":"hsla("}${T3(this.h)}, ${mh(this.s)*100}%, ${mh(this.l)*100}%${e===1?")":`, ${e})`}`}}));function T3(e){return e=(e||0)%360,e<0?e+360:e}function mh(e){return Math.max(0,Math.min(1,e||0))}function Wy(e,t,r){return(e<60?t+(r-t)*e/60:e<180?r:e<240?t+(r-t)*(240-e)/60:t)*255}const C2=e=>()=>e;function lV(e,t){return function(r){return e+r*t}}function cV(e,t,r){return e=Math.pow(e,r),t=Math.pow(t,r)-e,r=1/r,function(n){return Math.pow(e+n*t,r)}}function uV(e){return(e=+e)==1?xM:function(t,r){return r-t?cV(t,r,e):C2(isNaN(t)?r:t)}}function xM(e,t){var r=t-e;return r?lV(e,r):C2(isNaN(e)?t:e)}const E3=function e(t){var r=uV(t);function n(a,i){var o=r((a=Hv(a)).r,(i=Hv(i)).r),s=r(a.g,i.g),l=r(a.b,i.b),u=xM(a.opacity,i.opacity);return function(d){return a.r=o(d),a.g=s(d),a.b=l(d),a.opacity=u(d),a+""}}return n.gamma=e,n}(1);function dV(e,t){t||(t=[]);var r=e?Math.min(t.length,e.length):0,n=t.slice(),a;return function(i){for(a=0;a<r;++a)n[a]=e[a]*(1-i)+t[a]*i;return n}}function fV(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}function hV(e,t){var r=t?t.length:0,n=e?Math.min(r,e.length):0,a=new Array(n),i=new Array(r),o;for(o=0;o<n;++o)a[o]=rd(e[o],t[o]);for(;o<r;++o)i[o]=t[o];return function(s){for(o=0;o<n;++o)i[o]=a[o](s);return i}}function pV(e,t){var r=new Date;return e=+e,t=+t,function(n){return r.setTime(e*(1-n)+t*n),r}}function Bp(e,t){return e=+e,t=+t,function(r){return e*(1-r)+t*r}}function gV(e,t){var r={},n={},a;(e===null||typeof e!="object")&&(e={}),(t===null||typeof t!="object")&&(t={});for(a in t)a in e?r[a]=rd(e[a],t[a]):n[a]=t[a];return function(i){for(a in r)n[a]=r[a](i);return n}}var Vv=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,Hy=new RegExp(Vv.source,"g");function mV(e){return function(){return e}}function yV(e){return function(t){return e(t)+""}}function xV(e,t){var r=Vv.lastIndex=Hy.lastIndex=0,n,a,i,o=-1,s=[],l=[];for(e=e+"",t=t+"";(n=Vv.exec(e))&&(a=Hy.exec(t));)(i=a.index)>r&&(i=t.slice(r,i),s[o]?s[o]+=i:s[++o]=i),(n=n[0])===(a=a[0])?s[o]?s[o]+=a:s[++o]=a:(s[++o]=null,l.push({i:o,x:Bp(n,a)})),r=Hy.lastIndex;return r<t.length&&(i=t.slice(r),s[o]?s[o]+=i:s[++o]=i),s.length<2?l[0]?yV(l[0].x):mV(t):(t=l.length,function(u){for(var d=0,f;d<t;++d)s[(f=l[d]).i]=f.x(u);return s.join("")})}function rd(e,t){var r=typeof t,n;return t==null||r==="boolean"?C2(t):(r==="number"?Bp:r==="string"?(n=Lf(t))?(t=n,E3):xV:t instanceof Lf?E3:t instanceof Date?pV:fV(t)?dV:Array.isArray(t)?hV:typeof t.valueOf!="function"&&typeof t.toString!="function"||isNaN(t)?gV:Bp)(e,t)}function M2(e,t){return e=+e,t=+t,function(r){return Math.round(e*(1-r)+t*r)}}function vV(e,t){t===void 0&&(t=e,e=rd);for(var r=0,n=t.length-1,a=t[0],i=new Array(n<0?0:n);r<n;)i[r]=e(a,a=t[++r]);return function(o){var s=Math.max(0,Math.min(n-1,Math.floor(o*=n)));return i[s](o-s)}}function bV(e){return function(){return e}}function Lp(e){return+e}var I3=[0,1];function Va(e){return e}function Xv(e,t){return(t-=e=+e)?function(r){return(r-e)/t}:bV(isNaN(t)?NaN:.5)}function wV(e,t){var r;return e>t&&(r=e,e=t,t=r),function(n){return Math.max(e,Math.min(t,n))}}function kV(e,t,r){var n=e[0],a=e[1],i=t[0],o=t[1];return a<n?(n=Xv(a,n),i=r(o,i)):(n=Xv(n,a),i=r(i,o)),function(s){return i(n(s))}}function SV(e,t,r){var n=Math.min(e.length,t.length)-1,a=new Array(n),i=new Array(n),o=-1;for(e[n]<e[0]&&(e=e.slice().reverse(),t=t.slice().reverse());++o<n;)a[o]=Xv(e[o],e[o+1]),i[o]=r(t[o],t[o+1]);return function(s){var l=v0(e,s,1,n)-1;return i[l](a[l](s))}}function w0(e,t){return t.domain(e.domain()).range(e.range()).interpolate(e.interpolate()).clamp(e.clamp()).unknown(e.unknown())}function gm(){var e=I3,t=I3,r=rd,n,a,i,o=Va,s,l,u;function d(){var h=Math.min(e.length,t.length);return o!==Va&&(o=wV(e[0],e[h-1])),s=h>2?SV:kV,l=u=null,f}function f(h){return h==null||isNaN(h=+h)?i:(l||(l=s(e.map(n),t,r)))(n(o(h)))}return f.invert=function(h){return o(a((u||(u=s(t,e.map(n),Bp)))(h)))},f.domain=function(h){return arguments.length?(e=Array.from(h,Lp),d()):e.slice()},f.range=function(h){return arguments.length?(t=Array.from(h),d()):t.slice()},f.rangeRound=function(h){return t=Array.from(h),r=M2,d()},f.clamp=function(h){return arguments.length?(o=h?!0:Va,d()):o!==Va},f.interpolate=function(h){return arguments.length?(r=h,d()):r},f.unknown=function(h){return arguments.length?(i=h,f):i},function(h,g){return n=h,a=g,d()}}function N2(){return gm()(Va,Va)}function jV(e){return Math.abs(e=Math.round(e))>=1e21?e.toLocaleString("en").replace(/,/g,""):e.toString(10)}function Fp(e,t){if(!isFinite(e)||e===0)return null;var r=(e=t?e.toExponential(t-1):e.toExponential()).indexOf("e"),n=e.slice(0,r);return[n.length>1?n[0]+n.slice(2):n,+e.slice(r+1)]}function bu(e){return e=Fp(Math.abs(e)),e?e[1]:NaN}function PV(e,t){return function(r,n){for(var a=r.length,i=[],o=0,s=e[0],l=0;a>0&&s>0&&(l+s+1>n&&(s=Math.max(1,n-l)),i.push(r.substring(a-=s,a+s)),!((l+=s+1)>n));)s=e[o=(o+1)%e.length];return i.reverse().join(t)}}function _V(e){return function(t){return t.replace(/[0-9]/g,function(r){return e[+r]})}}var CV=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function Ff(e){if(!(t=CV.exec(e)))throw new Error("invalid format: "+e);var t;return new O2({fill:t[1],align:t[2],sign:t[3],symbol:t[4],zero:t[5],width:t[6],comma:t[7],precision:t[8]&&t[8].slice(1),trim:t[9],type:t[10]})}Ff.prototype=O2.prototype;function O2(e){this.fill=e.fill===void 0?" ":e.fill+"",this.align=e.align===void 0?">":e.align+"",this.sign=e.sign===void 0?"-":e.sign+"",this.symbol=e.symbol===void 0?"":e.symbol+"",this.zero=!!e.zero,this.width=e.width===void 0?void 0:+e.width,this.comma=!!e.comma,this.precision=e.precision===void 0?void 0:+e.precision,this.trim=!!e.trim,this.type=e.type===void 0?"":e.type+""}O2.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function MV(e){e:for(var t=e.length,r=1,n=-1,a;r<t;++r)switch(e[r]){case".":n=a=r;break;case"0":n===0&&(n=r),a=r;break;default:if(!+e[r])break e;n>0&&(n=0);break}return n>0?e.slice(0,n)+e.slice(a+1):e}var Gp;function NV(e,t){var r=Fp(e,t);if(!r)return Gp=void 0,e.toPrecision(t);var n=r[0],a=r[1],i=a-(Gp=Math.max(-8,Math.min(8,Math.floor(a/3)))*3)+1,o=n.length;return i===o?n:i>o?n+new Array(i-o+1).join("0"):i>0?n.slice(0,i)+"."+n.slice(i):"0."+new Array(1-i).join("0")+Fp(e,Math.max(0,t+i-1))[0]}function $3(e,t){var r=Fp(e,t);if(!r)return e+"";var n=r[0],a=r[1];return a<0?"0."+new Array(-a).join("0")+n:n.length>a+1?n.slice(0,a+1)+"."+n.slice(a+1):n+new Array(a-n.length+2).join("0")}const D3={"%":(e,t)=>(e*100).toFixed(t),b:e=>Math.round(e).toString(2),c:e=>e+"",d:jV,e:(e,t)=>e.toExponential(t),f:(e,t)=>e.toFixed(t),g:(e,t)=>e.toPrecision(t),o:e=>Math.round(e).toString(8),p:(e,t)=>$3(e*100,t),r:$3,s:NV,X:e=>Math.round(e).toString(16).toUpperCase(),x:e=>Math.round(e).toString(16)};function R3(e){return e}var B3=Array.prototype.map,L3=["y","z","a","f","p","n","","m","","k","M","G","T","P","E","Z","Y"];function OV(e){var t=e.grouping===void 0||e.thousands===void 0?R3:PV(B3.call(e.grouping,Number),e.thousands+""),r=e.currency===void 0?"":e.currency[0]+"",n=e.currency===void 0?"":e.currency[1]+"",a=e.decimal===void 0?".":e.decimal+"",i=e.numerals===void 0?R3:_V(B3.call(e.numerals,String)),o=e.percent===void 0?"%":e.percent+"",s=e.minus===void 0?"":e.minus+"",l=e.nan===void 0?"NaN":e.nan+"";function u(f,h){f=Ff(f);var g=f.fill,b=f.align,w=f.sign,v=f.symbol,x=f.zero,m=f.width,k=f.comma,P=f.precision,j=f.trim,S=f.type;S==="n"?(k=!0,S="g"):D3[S]||(P===void 0&&(P=12),j=!0,S="g"),(x||g==="0"&&b==="=")&&(x=!0,g="0",b="=");var M=(h&&h.prefix!==void 0?h.prefix:"")+(v==="$"?r:v==="#"&&/[boxX]/.test(S)?"0"+S.toLowerCase():""),O=(v==="$"?n:/[%p]/.test(S)?o:"")+(h&&h.suffix!==void 0?h.suffix:""),E=D3[S],I=/[defgprs%]/.test(S);P=P===void 0?6:/[gprs]/.test(S)?Math.max(1,Math.min(21,P)):Math.max(0,Math.min(20,P));function D(B){var z=M,Y=O,G,$,L;if(S==="c")Y=E(B)+Y,B="";else{B=+B;var U=B<0||1/B<0;if(B=isNaN(B)?l:E(Math.abs(B),P),j&&(B=MV(B)),U&&+B==0&&w!=="+"&&(U=!1),z=(U?w==="("?w:s:w==="-"||w==="("?"":w)+z,Y=(S==="s"&&!isNaN(B)&&Gp!==void 0?L3[8+Gp/3]:"")+Y+(U&&w==="("?")":""),I){for(G=-1,$=B.length;++G<$;)if(L=B.charCodeAt(G),48>L||L>57){Y=(L===46?a+B.slice(G+1):B.slice(G))+Y,B=B.slice(0,G);break}}}k&&!x&&(B=t(B,1/0));var V=z.length+B.length+Y.length,J=V<m?new Array(m-V+1).join(g):"";switch(k&&x&&(B=t(J+B,J.length?m-Y.length:1/0),J=""),b){case"<":B=z+B+Y+J;break;case"=":B=z+J+B+Y;break;case"^":B=J.slice(0,V=J.length>>1)+z+B+Y+J.slice(V);break;default:B=J+z+B+Y;break}return i(B)}return D.toString=function(){return f+""},D}function d(f,h){var g=Math.max(-8,Math.min(8,Math.floor(bu(h)/3)))*3,b=Math.pow(10,-g),w=u((f=Ff(f),f.type="f",f),{suffix:L3[8+g/3]});return function(v){return w(b*v)}}return{format:u,formatPrefix:d}}var yh,A2,vM;AV({thousands:",",grouping:[3],currency:["$",""]});function AV(e){return yh=OV(e),A2=yh.format,vM=yh.formatPrefix,yh}function TV(e){return Math.max(0,-bu(Math.abs(e)))}function EV(e,t){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(bu(t)/3)))*3-bu(Math.abs(e)))}function IV(e,t){return e=Math.abs(e),t=Math.abs(t)-e,Math.max(0,bu(t)-bu(e))+1}function bM(e,t,r,n){var a=zv(e,t,r),i;switch(n=Ff(n??",f"),n.type){case"s":{var o=Math.max(Math.abs(e),Math.abs(t));return n.precision==null&&!isNaN(i=EV(a,o))&&(n.precision=i),vM(n,o)}case"":case"e":case"g":case"p":case"r":{n.precision==null&&!isNaN(i=IV(a,Math.max(Math.abs(e),Math.abs(t))))&&(n.precision=i-(n.type==="e"));break}case"f":case"%":{n.precision==null&&!isNaN(i=TV(a))&&(n.precision=i-(n.type==="%")*2);break}}return A2(n)}function hl(e){var t=e.domain;return e.ticks=function(r){var n=t();return Gv(n[0],n[n.length-1],r??10)},e.tickFormat=function(r,n){var a=t();return bM(a[0],a[a.length-1],r??10,n)},e.nice=function(r){r==null&&(r=10);var n=t(),a=0,i=n.length-1,o=n[a],s=n[i],l,u,d=10;for(s<o&&(u=o,o=s,s=u,u=a,a=i,i=u);d-- >0;){if(u=Uv(o,s,r),u===l)return n[a]=o,n[i]=s,t(n);if(u>0)o=Math.floor(o/u)*u,s=Math.ceil(s/u)*u;else if(u<0)o=Math.ceil(o*u)/u,s=Math.floor(s*u)/u;else break;l=u}return e},e}function Up(){var e=N2();return e.copy=function(){return w0(e,Up())},Ui.apply(e,arguments),hl(e)}function wM(e){var t;function r(n){return n==null||isNaN(n=+n)?t:n}return r.invert=r,r.domain=r.range=function(n){return arguments.length?(e=Array.from(n,Lp),r):e.slice()},r.unknown=function(n){return arguments.length?(t=n,r):t},r.copy=function(){return wM(e).unknown(t)},e=arguments.length?Array.from(e,Lp):[0,1],hl(r)}function kM(e,t){e=e.slice();var r=0,n=e.length-1,a=e[r],i=e[n],o;return i<a&&(o=r,r=n,n=o,o=a,a=i,i=o),e[r]=t.floor(a),e[n]=t.ceil(i),e}function F3(e){return Math.log(e)}function G3(e){return Math.exp(e)}function $V(e){return-Math.log(-e)}function DV(e){return-Math.exp(-e)}function RV(e){return isFinite(e)?+("1e"+e):e<0?0:e}function BV(e){return e===10?RV:e===Math.E?Math.exp:t=>Math.pow(e,t)}function LV(e){return e===Math.E?Math.log:e===10&&Math.log10||e===2&&Math.log2||(e=Math.log(e),t=>Math.log(t)/e)}function U3(e){return(t,r)=>-e(-t,r)}function T2(e){const t=e(F3,G3),r=t.domain;let n=10,a,i;function o(){return a=LV(n),i=BV(n),r()[0]<0?(a=U3(a),i=U3(i),e($V,DV)):e(F3,G3),t}return t.base=function(s){return arguments.length?(n=+s,o()):n},t.domain=function(s){return arguments.length?(r(s),o()):r()},t.ticks=s=>{const l=r();let u=l[0],d=l[l.length-1];const f=d<u;f&&([u,d]=[d,u]);let h=a(u),g=a(d),b,w;const v=s==null?10:+s;let x=[];if(!(n%1)&&g-h<v){if(h=Math.floor(h),g=Math.ceil(g),u>0){for(;h<=g;++h)for(b=1;b<n;++b)if(w=h<0?b/i(-h):b*i(h),!(w<u)){if(w>d)break;x.push(w)}}else for(;h<=g;++h)for(b=n-1;b>=1;--b)if(w=h>0?b/i(-h):b*i(h),!(w<u)){if(w>d)break;x.push(w)}x.length*2<v&&(x=Gv(u,d,v))}else x=Gv(h,g,Math.min(g-h,v)).map(i);return f?x.reverse():x},t.tickFormat=(s,l)=>{if(s==null&&(s=10),l==null&&(l=n===10?"s":","),typeof l!="function"&&(!(n%1)&&(l=Ff(l)).precision==null&&(l.trim=!0),l=A2(l)),s===1/0)return l;const u=Math.max(1,n*s/t.ticks().length);return d=>{let f=d/i(Math.round(a(d)));return f*n<n-.5&&(f*=n),f<=u?l(d):""}},t.nice=()=>r(kM(r(),{floor:s=>i(Math.floor(a(s))),ceil:s=>i(Math.ceil(a(s)))})),t}function SM(){const e=T2(gm()).domain([1,10]);return e.copy=()=>w0(e,SM()).base(e.base()),Ui.apply(e,arguments),e}function z3(e){return function(t){return Math.sign(t)*Math.log1p(Math.abs(t/e))}}function W3(e){return function(t){return Math.sign(t)*Math.expm1(Math.abs(t))*e}}function E2(e){var t=1,r=e(z3(t),W3(t));return r.constant=function(n){return arguments.length?e(z3(t=+n),W3(t)):t},hl(r)}function jM(){var e=E2(gm());return e.copy=function(){return w0(e,jM()).constant(e.constant())},Ui.apply(e,arguments)}function H3(e){return function(t){return t<0?-Math.pow(-t,e):Math.pow(t,e)}}function FV(e){return e<0?-Math.sqrt(-e):Math.sqrt(e)}function GV(e){return e<0?-e*e:e*e}function I2(e){var t=e(Va,Va),r=1;function n(){return r===1?e(Va,Va):r===.5?e(FV,GV):e(H3(r),H3(1/r))}return t.exponent=function(a){return arguments.length?(r=+a,n()):r},hl(t)}function $2(){var e=I2(gm());return e.copy=function(){return w0(e,$2()).exponent(e.exponent())},Ui.apply(e,arguments),e}function UV(){return $2.apply(null,arguments).exponent(.5)}function V3(e){return Math.sign(e)*e*e}function zV(e){return Math.sign(e)*Math.sqrt(Math.abs(e))}function PM(){var e=N2(),t=[0,1],r=!1,n;function a(i){var o=zV(e(i));return isNaN(o)?n:r?Math.round(o):o}return a.invert=function(i){return e.invert(V3(i))},a.domain=function(i){return arguments.length?(e.domain(i),a):e.domain()},a.range=function(i){return arguments.length?(e.range((t=Array.from(i,Lp)).map(V3)),a):t.slice()},a.rangeRound=function(i){return a.range(i).round(!0)},a.round=function(i){return arguments.length?(r=!!i,a):r},a.clamp=function(i){return arguments.length?(e.clamp(i),a):e.clamp()},a.unknown=function(i){return arguments.length?(n=i,a):n},a.copy=function(){return PM(e.domain(),t).round(r).clamp(e.clamp()).unknown(n)},Ui.apply(a,arguments),hl(a)}function _M(){var e=[],t=[],r=[],n;function a(){var o=0,s=Math.max(1,t.length);for(r=new Array(s-1);++o<s;)r[o-1]=KH(e,o/s);return i}function i(o){return o==null||isNaN(o=+o)?n:t[v0(r,o)]}return i.invertExtent=function(o){var s=t.indexOf(o);return s<0?[NaN,NaN]:[s>0?r[s-1]:e[0],s<r.length?r[s]:e[e.length-1]]},i.domain=function(o){if(!arguments.length)return e.slice();e=[];for(let s of o)s!=null&&!isNaN(s=+s)&&e.push(s);return e.sort(rl),a()},i.range=function(o){return arguments.length?(t=Array.from(o),a()):t.slice()},i.unknown=function(o){return arguments.length?(n=o,i):n},i.quantiles=function(){return r.slice()},i.copy=function(){return _M().domain(e).range(t).unknown(n)},Ui.apply(i,arguments)}function CM(){var e=0,t=1,r=1,n=[.5],a=[0,1],i;function o(l){return l!=null&&l<=l?a[v0(n,l,0,r)]:i}function s(){var l=-1;for(n=new Array(r);++l<r;)n[l]=((l+1)*t-(l-r)*e)/(r+1);return o}return o.domain=function(l){return arguments.length?([e,t]=l,e=+e,t=+t,s()):[e,t]},o.range=function(l){return arguments.length?(r=(a=Array.from(l)).length-1,s()):a.slice()},o.invertExtent=function(l){var u=a.indexOf(l);return u<0?[NaN,NaN]:u<1?[e,n[0]]:u>=r?[n[r-1],t]:[n[u-1],n[u]]},o.unknown=function(l){return arguments.length&&(i=l),o},o.thresholds=function(){return n.slice()},o.copy=function(){return CM().domain([e,t]).range(a).unknown(i)},Ui.apply(hl(o),arguments)}function MM(){var e=[.5],t=[0,1],r,n=1;function a(i){return i!=null&&i<=i?t[v0(e,i,0,n)]:r}return a.domain=function(i){return arguments.length?(e=Array.from(i),n=Math.min(e.length,t.length-1),a):e.slice()},a.range=function(i){return arguments.length?(t=Array.from(i),n=Math.min(e.length,t.length-1),a):t.slice()},a.invertExtent=function(i){var o=t.indexOf(i);return[e[o-1],e[o]]},a.unknown=function(i){return arguments.length?(r=i,a):r},a.copy=function(){return MM().domain(e).range(t).unknown(r)},Ui.apply(a,arguments)}const Vy=new Date,Xy=new Date;function oa(e,t,r,n){function a(i){return e(i=arguments.length===0?new Date:new Date(+i)),i}return a.floor=i=>(e(i=new Date(+i)),i),a.ceil=i=>(e(i=new Date(i-1)),t(i,1),e(i),i),a.round=i=>{const o=a(i),s=a.ceil(i);return i-o<s-i?o:s},a.offset=(i,o)=>(t(i=new Date(+i),o==null?1:Math.floor(o)),i),a.range=(i,o,s)=>{const l=[];if(i=a.ceil(i),s=s==null?1:Math.floor(s),!(i<o)||!(s>0))return l;let u;do l.push(u=new Date(+i)),t(i,s),e(i);while(u<i&&i<o);return l},a.filter=i=>oa(o=>{if(o>=o)for(;e(o),!i(o);)o.setTime(o-1)},(o,s)=>{if(o>=o)if(s<0)for(;++s<=0;)for(;t(o,-1),!i(o););else for(;--s>=0;)for(;t(o,1),!i(o););}),r&&(a.count=(i,o)=>(Vy.setTime(+i),Xy.setTime(+o),e(Vy),e(Xy),Math.floor(r(Vy,Xy))),a.every=i=>(i=Math.floor(i),!isFinite(i)||!(i>0)?null:i>1?a.filter(n?o=>n(o)%i===0:o=>a.count(0,o)%i===0):a)),a}const zp=oa(()=>{},(e,t)=>{e.setTime(+e+t)},(e,t)=>t-e);zp.every=e=>(e=Math.floor(e),!isFinite(e)||!(e>0)?null:e>1?oa(t=>{t.setTime(Math.floor(t/e)*e)},(t,r)=>{t.setTime(+t+r*e)},(t,r)=>(r-t)/e):zp);zp.range;const ts=1e3,Ii=ts*60,rs=Ii*60,fs=rs*24,D2=fs*7,X3=fs*30,Ky=fs*365,Fl=oa(e=>{e.setTime(e-e.getMilliseconds())},(e,t)=>{e.setTime(+e+t*ts)},(e,t)=>(t-e)/ts,e=>e.getUTCSeconds());Fl.range;const R2=oa(e=>{e.setTime(e-e.getMilliseconds()-e.getSeconds()*ts)},(e,t)=>{e.setTime(+e+t*Ii)},(e,t)=>(t-e)/Ii,e=>e.getMinutes());R2.range;const B2=oa(e=>{e.setUTCSeconds(0,0)},(e,t)=>{e.setTime(+e+t*Ii)},(e,t)=>(t-e)/Ii,e=>e.getUTCMinutes());B2.range;const L2=oa(e=>{e.setTime(e-e.getMilliseconds()-e.getSeconds()*ts-e.getMinutes()*Ii)},(e,t)=>{e.setTime(+e+t*rs)},(e,t)=>(t-e)/rs,e=>e.getHours());L2.range;const F2=oa(e=>{e.setUTCMinutes(0,0,0)},(e,t)=>{e.setTime(+e+t*rs)},(e,t)=>(t-e)/rs,e=>e.getUTCHours());F2.range;const k0=oa(e=>e.setHours(0,0,0,0),(e,t)=>e.setDate(e.getDate()+t),(e,t)=>(t-e-(t.getTimezoneOffset()-e.getTimezoneOffset())*Ii)/fs,e=>e.getDate()-1);k0.range;const mm=oa(e=>{e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCDate(e.getUTCDate()+t)},(e,t)=>(t-e)/fs,e=>e.getUTCDate()-1);mm.range;const NM=oa(e=>{e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCDate(e.getUTCDate()+t)},(e,t)=>(t-e)/fs,e=>Math.floor(e/fs));NM.range;function vc(e){return oa(t=>{t.setDate(t.getDate()-(t.getDay()+7-e)%7),t.setHours(0,0,0,0)},(t,r)=>{t.setDate(t.getDate()+r*7)},(t,r)=>(r-t-(r.getTimezoneOffset()-t.getTimezoneOffset())*Ii)/D2)}const ym=vc(0),Wp=vc(1),WV=vc(2),HV=vc(3),wu=vc(4),VV=vc(5),XV=vc(6);ym.range;Wp.range;WV.range;HV.range;wu.range;VV.range;XV.range;function bc(e){return oa(t=>{t.setUTCDate(t.getUTCDate()-(t.getUTCDay()+7-e)%7),t.setUTCHours(0,0,0,0)},(t,r)=>{t.setUTCDate(t.getUTCDate()+r*7)},(t,r)=>(r-t)/D2)}const xm=bc(0),Hp=bc(1),KV=bc(2),YV=bc(3),ku=bc(4),qV=bc(5),ZV=bc(6);xm.range;Hp.range;KV.range;YV.range;ku.range;qV.range;ZV.range;const G2=oa(e=>{e.setDate(1),e.setHours(0,0,0,0)},(e,t)=>{e.setMonth(e.getMonth()+t)},(e,t)=>t.getMonth()-e.getMonth()+(t.getFullYear()-e.getFullYear())*12,e=>e.getMonth());G2.range;const U2=oa(e=>{e.setUTCDate(1),e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCMonth(e.getUTCMonth()+t)},(e,t)=>t.getUTCMonth()-e.getUTCMonth()+(t.getUTCFullYear()-e.getUTCFullYear())*12,e=>e.getUTCMonth());U2.range;const hs=oa(e=>{e.setMonth(0,1),e.setHours(0,0,0,0)},(e,t)=>{e.setFullYear(e.getFullYear()+t)},(e,t)=>t.getFullYear()-e.getFullYear(),e=>e.getFullYear());hs.every=e=>!isFinite(e=Math.floor(e))||!(e>0)?null:oa(t=>{t.setFullYear(Math.floor(t.getFullYear()/e)*e),t.setMonth(0,1),t.setHours(0,0,0,0)},(t,r)=>{t.setFullYear(t.getFullYear()+r*e)});hs.range;const ps=oa(e=>{e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCFullYear(e.getUTCFullYear()+t)},(e,t)=>t.getUTCFullYear()-e.getUTCFullYear(),e=>e.getUTCFullYear());ps.every=e=>!isFinite(e=Math.floor(e))||!(e>0)?null:oa(t=>{t.setUTCFullYear(Math.floor(t.getUTCFullYear()/e)*e),t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)},(t,r)=>{t.setUTCFullYear(t.getUTCFullYear()+r*e)});ps.range;function OM(e,t,r,n,a,i){const o=[[Fl,1,ts],[Fl,5,5*ts],[Fl,15,15*ts],[Fl,30,30*ts],[i,1,Ii],[i,5,5*Ii],[i,15,15*Ii],[i,30,30*Ii],[a,1,rs],[a,3,3*rs],[a,6,6*rs],[a,12,12*rs],[n,1,fs],[n,2,2*fs],[r,1,D2],[t,1,X3],[t,3,3*X3],[e,1,Ky]];function s(u,d,f){const h=d<u;h&&([u,d]=[d,u]);const g=f&&typeof f.range=="function"?f:l(u,d,f),b=g?g.range(u,+d+1):[];return h?b.reverse():b}function l(u,d,f){const h=Math.abs(d-u)/f,g=j2(([,,v])=>v).right(o,h);if(g===o.length)return e.every(zv(u/Ky,d/Ky,f));if(g===0)return zp.every(Math.max(zv(u,d,f),1));const[b,w]=o[h/o[g-1][2]<o[g][2]/h?g-1:g];return b.every(w)}return[s,l]}const[JV,QV]=OM(ps,U2,xm,NM,F2,B2),[eX,tX]=OM(hs,G2,ym,k0,L2,R2);function Yy(e){if(0<=e.y&&e.y<100){var t=new Date(-1,e.m,e.d,e.H,e.M,e.S,e.L);return t.setFullYear(e.y),t}return new Date(e.y,e.m,e.d,e.H,e.M,e.S,e.L)}function qy(e){if(0<=e.y&&e.y<100){var t=new Date(Date.UTC(-1,e.m,e.d,e.H,e.M,e.S,e.L));return t.setUTCFullYear(e.y),t}return new Date(Date.UTC(e.y,e.m,e.d,e.H,e.M,e.S,e.L))}function Ad(e,t,r){return{y:e,m:t,d:r,H:0,M:0,S:0,L:0}}function rX(e){var t=e.dateTime,r=e.date,n=e.time,a=e.periods,i=e.days,o=e.shortDays,s=e.months,l=e.shortMonths,u=Td(a),d=Ed(a),f=Td(i),h=Ed(i),g=Td(o),b=Ed(o),w=Td(s),v=Ed(s),x=Td(l),m=Ed(l),k={a:L,A:U,b:V,B:J,c:null,d:Q3,e:Q3,f:PX,g:$X,G:RX,H:kX,I:SX,j:jX,L:AM,m:_X,M:CX,p:K,q:Q,Q:r5,s:n5,S:MX,u:NX,U:OX,V:AX,w:TX,W:EX,x:null,X:null,y:IX,Y:DX,Z:BX,"%":t5},P={a:te,A:ee,b:me,B:re,c:null,d:e5,e:e5,f:UX,g:JX,G:eK,H:LX,I:FX,j:GX,L:EM,m:zX,M:WX,p:De,q:fe,Q:r5,s:n5,S:HX,u:VX,U:XX,V:KX,w:YX,W:qX,x:null,X:null,y:ZX,Y:QX,Z:tK,"%":t5},j={a:I,A:D,b:B,B:z,c:Y,d:Z3,e:Z3,f:xX,g:q3,G:Y3,H:J3,I:J3,j:pX,L:yX,m:hX,M:gX,p:E,q:fX,Q:bX,s:wX,S:mX,u:sX,U:lX,V:cX,w:oX,W:uX,x:G,X:$,y:q3,Y:Y3,Z:dX,"%":vX};k.x=S(r,k),k.X=S(n,k),k.c=S(t,k),P.x=S(r,P),P.X=S(n,P),P.c=S(t,P);function S(le,de){return function(Se){var he=[],Pe=-1,ve=0,ye=le.length,ge,ue,Le;for(Se instanceof Date||(Se=new Date(+Se));++Pe<ye;)le.charCodeAt(Pe)===37&&(he.push(le.slice(ve,Pe)),(ue=K3[ge=le.charAt(++Pe)])!=null?ge=le.charAt(++Pe):ue=ge==="e"?" ":"0",(Le=de[ge])&&(ge=Le(Se,ue)),he.push(ge),ve=Pe+1);return he.push(le.slice(ve,Pe)),he.join("")}}function M(le,de){return function(Se){var he=Ad(1900,void 0,1),Pe=O(he,le,Se+="",0),ve,ye;if(Pe!=Se.length)return null;if("Q"in he)return new Date(he.Q);if("s"in he)return new Date(he.s*1e3+("L"in he?he.L:0));if(de&&!("Z"in he)&&(he.Z=0),"p"in he&&(he.H=he.H%12+he.p*12),he.m===void 0&&(he.m="q"in he?he.q:0),"V"in he){if(he.V<1||he.V>53)return null;"w"in he||(he.w=1),"Z"in he?(ve=qy(Ad(he.y,0,1)),ye=ve.getUTCDay(),ve=ye>4||ye===0?Hp.ceil(ve):Hp(ve),ve=mm.offset(ve,(he.V-1)*7),he.y=ve.getUTCFullYear(),he.m=ve.getUTCMonth(),he.d=ve.getUTCDate()+(he.w+6)%7):(ve=Yy(Ad(he.y,0,1)),ye=ve.getDay(),ve=ye>4||ye===0?Wp.ceil(ve):Wp(ve),ve=k0.offset(ve,(he.V-1)*7),he.y=ve.getFullYear(),he.m=ve.getMonth(),he.d=ve.getDate()+(he.w+6)%7)}else("W"in he||"U"in he)&&("w"in he||(he.w="u"in he?he.u%7:"W"in he?1:0),ye="Z"in he?qy(Ad(he.y,0,1)).getUTCDay():Yy(Ad(he.y,0,1)).getDay(),he.m=0,he.d="W"in he?(he.w+6)%7+he.W*7-(ye+5)%7:he.w+he.U*7-(ye+6)%7);return"Z"in he?(he.H+=he.Z/100|0,he.M+=he.Z%100,qy(he)):Yy(he)}}function O(le,de,Se,he){for(var Pe=0,ve=de.length,ye=Se.length,ge,ue;Pe<ve;){if(he>=ye)return-1;if(ge=de.charCodeAt(Pe++),ge===37){if(ge=de.charAt(Pe++),ue=j[ge in K3?de.charAt(Pe++):ge],!ue||(he=ue(le,Se,he))<0)return-1}else if(ge!=Se.charCodeAt(he++))return-1}return he}function E(le,de,Se){var he=u.exec(de.slice(Se));return he?(le.p=d.get(he[0].toLowerCase()),Se+he[0].length):-1}function I(le,de,Se){var he=g.exec(de.slice(Se));return he?(le.w=b.get(he[0].toLowerCase()),Se+he[0].length):-1}function D(le,de,Se){var he=f.exec(de.slice(Se));return he?(le.w=h.get(he[0].toLowerCase()),Se+he[0].length):-1}function B(le,de,Se){var he=x.exec(de.slice(Se));return he?(le.m=m.get(he[0].toLowerCase()),Se+he[0].length):-1}function z(le,de,Se){var he=w.exec(de.slice(Se));return he?(le.m=v.get(he[0].toLowerCase()),Se+he[0].length):-1}function Y(le,de,Se){return O(le,t,de,Se)}function G(le,de,Se){return O(le,r,de,Se)}function $(le,de,Se){return O(le,n,de,Se)}function L(le){return o[le.getDay()]}function U(le){return i[le.getDay()]}function V(le){return l[le.getMonth()]}function J(le){return s[le.getMonth()]}function K(le){return a[+(le.getHours()>=12)]}function Q(le){return 1+~~(le.getMonth()/3)}function te(le){return o[le.getUTCDay()]}function ee(le){return i[le.getUTCDay()]}function me(le){return l[le.getUTCMonth()]}function re(le){return s[le.getUTCMonth()]}function De(le){return a[+(le.getUTCHours()>=12)]}function fe(le){return 1+~~(le.getUTCMonth()/3)}return{format:function(le){var de=S(le+="",k);return de.toString=function(){return le},de},parse:function(le){var de=M(le+="",!1);return de.toString=function(){return le},de},utcFormat:function(le){var de=S(le+="",P);return de.toString=function(){return le},de},utcParse:function(le){var de=M(le+="",!0);return de.toString=function(){return le},de}}}var K3={"-":"",_:" ",0:"0"},pa=/^\s*\d+/,nX=/^%/,aX=/[\\^$*+?|[\]().{}]/g;function Fr(e,t,r){var n=e<0?"-":"",a=(n?-e:e)+"",i=a.length;return n+(i<r?new Array(r-i+1).join(t)+a:a)}function iX(e){return e.replace(aX,"\\$&")}function Td(e){return new RegExp("^(?:"+e.map(iX).join("|")+")","i")}function Ed(e){return new Map(e.map((t,r)=>[t.toLowerCase(),r]))}function oX(e,t,r){var n=pa.exec(t.slice(r,r+1));return n?(e.w=+n[0],r+n[0].length):-1}function sX(e,t,r){var n=pa.exec(t.slice(r,r+1));return n?(e.u=+n[0],r+n[0].length):-1}function lX(e,t,r){var n=pa.exec(t.slice(r,r+2));return n?(e.U=+n[0],r+n[0].length):-1}function cX(e,t,r){var n=pa.exec(t.slice(r,r+2));return n?(e.V=+n[0],r+n[0].length):-1}function uX(e,t,r){var n=pa.exec(t.slice(r,r+2));return n?(e.W=+n[0],r+n[0].length):-1}function Y3(e,t,r){var n=pa.exec(t.slice(r,r+4));return n?(e.y=+n[0],r+n[0].length):-1}function q3(e,t,r){var n=pa.exec(t.slice(r,r+2));return n?(e.y=+n[0]+(+n[0]>68?1900:2e3),r+n[0].length):-1}function dX(e,t,r){var n=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(t.slice(r,r+6));return n?(e.Z=n[1]?0:-(n[2]+(n[3]||"00")),r+n[0].length):-1}function fX(e,t,r){var n=pa.exec(t.slice(r,r+1));return n?(e.q=n[0]*3-3,r+n[0].length):-1}function hX(e,t,r){var n=pa.exec(t.slice(r,r+2));return n?(e.m=n[0]-1,r+n[0].length):-1}function Z3(e,t,r){var n=pa.exec(t.slice(r,r+2));return n?(e.d=+n[0],r+n[0].length):-1}function pX(e,t,r){var n=pa.exec(t.slice(r,r+3));return n?(e.m=0,e.d=+n[0],r+n[0].length):-1}function J3(e,t,r){var n=pa.exec(t.slice(r,r+2));return n?(e.H=+n[0],r+n[0].length):-1}function gX(e,t,r){var n=pa.exec(t.slice(r,r+2));return n?(e.M=+n[0],r+n[0].length):-1}function mX(e,t,r){var n=pa.exec(t.slice(r,r+2));return n?(e.S=+n[0],r+n[0].length):-1}function yX(e,t,r){var n=pa.exec(t.slice(r,r+3));return n?(e.L=+n[0],r+n[0].length):-1}function xX(e,t,r){var n=pa.exec(t.slice(r,r+6));return n?(e.L=Math.floor(n[0]/1e3),r+n[0].length):-1}function vX(e,t,r){var n=nX.exec(t.slice(r,r+1));return n?r+n[0].length:-1}function bX(e,t,r){var n=pa.exec(t.slice(r));return n?(e.Q=+n[0],r+n[0].length):-1}function wX(e,t,r){var n=pa.exec(t.slice(r));return n?(e.s=+n[0],r+n[0].length):-1}function Q3(e,t){return Fr(e.getDate(),t,2)}function kX(e,t){return Fr(e.getHours(),t,2)}function SX(e,t){return Fr(e.getHours()%12||12,t,2)}function jX(e,t){return Fr(1+k0.count(hs(e),e),t,3)}function AM(e,t){return Fr(e.getMilliseconds(),t,3)}function PX(e,t){return AM(e,t)+"000"}function _X(e,t){return Fr(e.getMonth()+1,t,2)}function CX(e,t){return Fr(e.getMinutes(),t,2)}function MX(e,t){return Fr(e.getSeconds(),t,2)}function NX(e){var t=e.getDay();return t===0?7:t}function OX(e,t){return Fr(ym.count(hs(e)-1,e),t,2)}function TM(e){var t=e.getDay();return t>=4||t===0?wu(e):wu.ceil(e)}function AX(e,t){return e=TM(e),Fr(wu.count(hs(e),e)+(hs(e).getDay()===4),t,2)}function TX(e){return e.getDay()}function EX(e,t){return Fr(Wp.count(hs(e)-1,e),t,2)}function IX(e,t){return Fr(e.getFullYear()%100,t,2)}function $X(e,t){return e=TM(e),Fr(e.getFullYear()%100,t,2)}function DX(e,t){return Fr(e.getFullYear()%1e4,t,4)}function RX(e,t){var r=e.getDay();return e=r>=4||r===0?wu(e):wu.ceil(e),Fr(e.getFullYear()%1e4,t,4)}function BX(e){var t=e.getTimezoneOffset();return(t>0?"-":(t*=-1,"+"))+Fr(t/60|0,"0",2)+Fr(t%60,"0",2)}function e5(e,t){return Fr(e.getUTCDate(),t,2)}function LX(e,t){return Fr(e.getUTCHours(),t,2)}function FX(e,t){return Fr(e.getUTCHours()%12||12,t,2)}function GX(e,t){return Fr(1+mm.count(ps(e),e),t,3)}function EM(e,t){return Fr(e.getUTCMilliseconds(),t,3)}function UX(e,t){return EM(e,t)+"000"}function zX(e,t){return Fr(e.getUTCMonth()+1,t,2)}function WX(e,t){return Fr(e.getUTCMinutes(),t,2)}function HX(e,t){return Fr(e.getUTCSeconds(),t,2)}function VX(e){var t=e.getUTCDay();return t===0?7:t}function XX(e,t){return Fr(xm.count(ps(e)-1,e),t,2)}function IM(e){var t=e.getUTCDay();return t>=4||t===0?ku(e):ku.ceil(e)}function KX(e,t){return e=IM(e),Fr(ku.count(ps(e),e)+(ps(e).getUTCDay()===4),t,2)}function YX(e){return e.getUTCDay()}function qX(e,t){return Fr(Hp.count(ps(e)-1,e),t,2)}function ZX(e,t){return Fr(e.getUTCFullYear()%100,t,2)}function JX(e,t){return e=IM(e),Fr(e.getUTCFullYear()%100,t,2)}function QX(e,t){return Fr(e.getUTCFullYear()%1e4,t,4)}function eK(e,t){var r=e.getUTCDay();return e=r>=4||r===0?ku(e):ku.ceil(e),Fr(e.getUTCFullYear()%1e4,t,4)}function tK(){return"+0000"}function t5(){return"%"}function r5(e){return+e}function n5(e){return Math.floor(+e/1e3)}var Tc,$M,DM;rK({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});function rK(e){return Tc=rX(e),$M=Tc.format,Tc.parse,DM=Tc.utcFormat,Tc.utcParse,Tc}function nK(e){return new Date(e)}function aK(e){return e instanceof Date?+e:+new Date(+e)}function z2(e,t,r,n,a,i,o,s,l,u){var d=N2(),f=d.invert,h=d.domain,g=u(".%L"),b=u(":%S"),w=u("%I:%M"),v=u("%I %p"),x=u("%a %d"),m=u("%b %d"),k=u("%B"),P=u("%Y");function j(S){return(l(S)<S?g:s(S)<S?b:o(S)<S?w:i(S)<S?v:n(S)<S?a(S)<S?x:m:r(S)<S?k:P)(S)}return d.invert=function(S){return new Date(f(S))},d.domain=function(S){return arguments.length?h(Array.from(S,aK)):h().map(nK)},d.ticks=function(S){var M=h();return e(M[0],M[M.length-1],S??10)},d.tickFormat=function(S,M){return M==null?j:u(M)},d.nice=function(S){var M=h();return(!S||typeof S.range!="function")&&(S=t(M[0],M[M.length-1],S??10)),S?h(kM(M,S)):d},d.copy=function(){return w0(d,z2(e,t,r,n,a,i,o,s,l,u))},d}function iK(){return Ui.apply(z2(eX,tX,hs,G2,ym,k0,L2,R2,Fl,$M).domain([new Date(2e3,0,1),new Date(2e3,0,2)]),arguments)}function oK(){return Ui.apply(z2(JV,QV,ps,U2,xm,mm,F2,B2,Fl,DM).domain([Date.UTC(2e3,0,1),Date.UTC(2e3,0,2)]),arguments)}function vm(){var e=0,t=1,r,n,a,i,o=Va,s=!1,l;function u(f){return f==null||isNaN(f=+f)?l:o(a===0?.5:(f=(i(f)-r)*a,s?Math.max(0,Math.min(1,f)):f))}u.domain=function(f){return arguments.length?([e,t]=f,r=i(e=+e),n=i(t=+t),a=r===n?0:1/(n-r),u):[e,t]},u.clamp=function(f){return arguments.length?(s=!!f,u):s},u.interpolator=function(f){return arguments.length?(o=f,u):o};function d(f){return function(h){var g,b;return arguments.length?([g,b]=h,o=f(g,b),u):[o(0),o(1)]}}return u.range=d(rd),u.rangeRound=d(M2),u.unknown=function(f){return arguments.length?(l=f,u):l},function(f){return i=f,r=f(e),n=f(t),a=r===n?0:1/(n-r),u}}function pl(e,t){return t.domain(e.domain()).interpolator(e.interpolator()).clamp(e.clamp()).unknown(e.unknown())}function RM(){var e=hl(vm()(Va));return e.copy=function(){return pl(e,RM())},xs.apply(e,arguments)}function BM(){var e=T2(vm()).domain([1,10]);return e.copy=function(){return pl(e,BM()).base(e.base())},xs.apply(e,arguments)}function LM(){var e=E2(vm());return e.copy=function(){return pl(e,LM()).constant(e.constant())},xs.apply(e,arguments)}function W2(){var e=I2(vm());return e.copy=function(){return pl(e,W2()).exponent(e.exponent())},xs.apply(e,arguments)}function sK(){return W2.apply(null,arguments).exponent(.5)}function FM(){var e=[],t=Va;function r(n){if(n!=null&&!isNaN(n=+n))return t((v0(e,n,1)-1)/(e.length-1))}return r.domain=function(n){if(!arguments.length)return e.slice();e=[];for(let a of n)a!=null&&!isNaN(a=+a)&&e.push(a);return e.sort(rl),r},r.interpolator=function(n){return arguments.length?(t=n,r):t},r.range=function(){return e.map((n,a)=>t(a/(e.length-1)))},r.quantiles=function(n){return Array.from({length:n+1},(a,i)=>XH(e,i/n))},r.copy=function(){return FM(t).domain(e)},xs.apply(r,arguments)}function bm(){var e=0,t=.5,r=1,n=1,a,i,o,s,l,u=Va,d,f=!1,h;function g(w){return isNaN(w=+w)?h:(w=.5+((w=+d(w))-i)*(n*w<n*i?s:l),u(f?Math.max(0,Math.min(1,w)):w))}g.domain=function(w){return arguments.length?([e,t,r]=w,a=d(e=+e),i=d(t=+t),o=d(r=+r),s=a===i?0:.5/(i-a),l=i===o?0:.5/(o-i),n=i<a?-1:1,g):[e,t,r]},g.clamp=function(w){return arguments.length?(f=!!w,g):f},g.interpolator=function(w){return arguments.length?(u=w,g):u};function b(w){return function(v){var x,m,k;return arguments.length?([x,m,k]=v,u=vV(w,[x,m,k]),g):[u(0),u(.5),u(1)]}}return g.range=b(rd),g.rangeRound=b(M2),g.unknown=function(w){return arguments.length?(h=w,g):h},function(w){return d=w,a=w(e),i=w(t),o=w(r),s=a===i?0:.5/(i-a),l=i===o?0:.5/(o-i),n=i<a?-1:1,g}}function GM(){var e=hl(bm()(Va));return e.copy=function(){return pl(e,GM())},xs.apply(e,arguments)}function UM(){var e=T2(bm()).domain([.1,1,10]);return e.copy=function(){return pl(e,UM()).base(e.base())},xs.apply(e,arguments)}function zM(){var e=E2(bm());return e.copy=function(){return pl(e,zM()).constant(e.constant())},xs.apply(e,arguments)}function H2(){var e=I2(bm());return e.copy=function(){return pl(e,H2()).exponent(e.exponent())},xs.apply(e,arguments)}function lK(){return H2.apply(null,arguments).exponent(.5)}const a5=Object.freeze(Object.defineProperty({__proto__:null,scaleBand:Df,scaleDiverging:GM,scaleDivergingLog:UM,scaleDivergingPow:H2,scaleDivergingSqrt:lK,scaleDivergingSymlog:zM,scaleIdentity:wM,scaleImplicit:Wv,scaleLinear:Up,scaleLog:SM,scaleOrdinal:P2,scalePoint:rf,scalePow:$2,scaleQuantile:_M,scaleQuantize:CM,scaleRadial:PM,scaleSequential:RM,scaleSequentialLog:BM,scaleSequentialPow:W2,scaleSequentialQuantile:FM,scaleSequentialSqrt:sK,scaleSequentialSymlog:LM,scaleSqrt:UV,scaleSymlog:jM,scaleThreshold:MM,scaleTime:iK,scaleUtc:oK,tickFormat:bM},Symbol.toStringTag,{value:"Module"}));var cK=Xu;function uK(e,t,r){for(var n=-1,a=e.length;++n<a;){var i=e[n],o=t(i);if(o!=null&&(s===void 0?o===o&&!cK(o):r(o,s)))var s=o,l=i}return l}var WM=uK;function dK(e,t){return e>t}var fK=dK,hK=WM,pK=fK,gK=td;function mK(e){return e&&e.length?hK(e,gK,pK):void 0}var yK=mK;const Us=on(yK);function xK(e,t){return e<t}var vK=xK,bK=WM,wK=vK,kK=td;function SK(e){return e&&e.length?bK(e,kK,wK):void 0}var jK=SK;const wm=on(jK);var PK=i2,_K=dl,CK=eM,MK=ci;function NK(e,t){var r=MK(e)?PK:CK;return r(e,_K(t))}var OK=NK,AK=JC,TK=OK;function EK(e,t){return AK(TK(e,t),1)}var IK=EK;const $K=on(IK);var DK=v2;function RK(e,t){return DK(e,t)}var BK=RK;const uc=on(BK);var nd=1e9,LK={precision:20,rounding:4,toExpNeg:-7,toExpPos:21,LN10:"2.302585092994045684017991454684364207601101488628772976033327900967572609677352480235997205089598298341967784042286"},X2,wn=!0,Fi="[DecimalError] ",Xl=Fi+"Invalid argument: ",V2=Fi+"Exponent out of range: ",ad=Math.floor,Al=Math.pow,FK=/^(\d+(\.\d*)?|\.\d+)(e[+-]?\d+)?$/i,xi,ua=1e7,pn=7,HM=9007199254740991,Vp=ad(HM/pn),lt={};lt.absoluteValue=lt.abs=function(){var e=new this.constructor(this);return e.s&&(e.s=1),e};lt.comparedTo=lt.cmp=function(e){var t,r,n,a,i=this;if(e=new i.constructor(e),i.s!==e.s)return i.s||-e.s;if(i.e!==e.e)return i.e>e.e^i.s<0?1:-1;for(n=i.d.length,a=e.d.length,t=0,r=n<a?n:a;t<r;++t)if(i.d[t]!==e.d[t])return i.d[t]>e.d[t]^i.s<0?1:-1;return n===a?0:n>a^i.s<0?1:-1};lt.decimalPlaces=lt.dp=function(){var e=this,t=e.d.length-1,r=(t-e.e)*pn;if(t=e.d[t],t)for(;t%10==0;t/=10)r--;return r<0?0:r};lt.dividedBy=lt.div=function(e){return ss(this,new this.constructor(e))};lt.dividedToIntegerBy=lt.idiv=function(e){var t=this,r=t.constructor;return an(ss(t,new r(e),0,1),r.precision)};lt.equals=lt.eq=function(e){return!this.cmp(e)};lt.exponent=function(){return Xn(this)};lt.greaterThan=lt.gt=function(e){return this.cmp(e)>0};lt.greaterThanOrEqualTo=lt.gte=function(e){return this.cmp(e)>=0};lt.isInteger=lt.isint=function(){return this.e>this.d.length-2};lt.isNegative=lt.isneg=function(){return this.s<0};lt.isPositive=lt.ispos=function(){return this.s>0};lt.isZero=function(){return this.s===0};lt.lessThan=lt.lt=function(e){return this.cmp(e)<0};lt.lessThanOrEqualTo=lt.lte=function(e){return this.cmp(e)<1};lt.logarithm=lt.log=function(e){var t,r=this,n=r.constructor,a=n.precision,i=a+5;if(e===void 0)e=new n(10);else if(e=new n(e),e.s<1||e.eq(xi))throw Error(Fi+"NaN");if(r.s<1)throw Error(Fi+(r.s?"NaN":"-Infinity"));return r.eq(xi)?new n(0):(wn=!1,t=ss(Gf(r,i),Gf(e,i),i),wn=!0,an(t,a))};lt.minus=lt.sub=function(e){var t=this;return e=new t.constructor(e),t.s==e.s?KM(t,e):VM(t,(e.s=-e.s,e))};lt.modulo=lt.mod=function(e){var t,r=this,n=r.constructor,a=n.precision;if(e=new n(e),!e.s)throw Error(Fi+"NaN");return r.s?(wn=!1,t=ss(r,e,0,1).times(e),wn=!0,r.minus(t)):an(new n(r),a)};lt.naturalExponential=lt.exp=function(){return XM(this)};lt.naturalLogarithm=lt.ln=function(){return Gf(this)};lt.negated=lt.neg=function(){var e=new this.constructor(this);return e.s=-e.s||0,e};lt.plus=lt.add=function(e){var t=this;return e=new t.constructor(e),t.s==e.s?VM(t,e):KM(t,(e.s=-e.s,e))};lt.precision=lt.sd=function(e){var t,r,n,a=this;if(e!==void 0&&e!==!!e&&e!==1&&e!==0)throw Error(Xl+e);if(t=Xn(a)+1,n=a.d.length-1,r=n*pn+1,n=a.d[n],n){for(;n%10==0;n/=10)r--;for(n=a.d[0];n>=10;n/=10)r++}return e&&t>r?t:r};lt.squareRoot=lt.sqrt=function(){var e,t,r,n,a,i,o,s=this,l=s.constructor;if(s.s<1){if(!s.s)return new l(0);throw Error(Fi+"NaN")}for(e=Xn(s),wn=!1,a=Math.sqrt(+s),a==0||a==1/0?(t=Co(s.d),(t.length+e)%2==0&&(t+="0"),a=Math.sqrt(t),e=ad((e+1)/2)-(e<0||e%2),a==1/0?t="5e"+e:(t=a.toExponential(),t=t.slice(0,t.indexOf("e")+1)+e),n=new l(t)):n=new l(a.toString()),r=l.precision,a=o=r+3;;)if(i=n,n=i.plus(ss(s,i,o+2)).times(.5),Co(i.d).slice(0,o)===(t=Co(n.d)).slice(0,o)){if(t=t.slice(o-3,o+1),a==o&&t=="4999"){if(an(i,r+1,0),i.times(i).eq(s)){n=i;break}}else if(t!="9999")break;o+=4}return wn=!0,an(n,r)};lt.times=lt.mul=function(e){var t,r,n,a,i,o,s,l,u,d=this,f=d.constructor,h=d.d,g=(e=new f(e)).d;if(!d.s||!e.s)return new f(0);for(e.s*=d.s,r=d.e+e.e,l=h.length,u=g.length,l<u&&(i=h,h=g,g=i,o=l,l=u,u=o),i=[],o=l+u,n=o;n--;)i.push(0);for(n=u;--n>=0;){for(t=0,a=l+n;a>n;)s=i[a]+g[n]*h[a-n-1]+t,i[a--]=s%ua|0,t=s/ua|0;i[a]=(i[a]+t)%ua|0}for(;!i[--o];)i.pop();return t?++r:i.shift(),e.d=i,e.e=r,wn?an(e,f.precision):e};lt.toDecimalPlaces=lt.todp=function(e,t){var r=this,n=r.constructor;return r=new n(r),e===void 0?r:(Ro(e,0,nd),t===void 0?t=n.rounding:Ro(t,0,8),an(r,e+Xn(r)+1,t))};lt.toExponential=function(e,t){var r,n=this,a=n.constructor;return e===void 0?r=dc(n,!0):(Ro(e,0,nd),t===void 0?t=a.rounding:Ro(t,0,8),n=an(new a(n),e+1,t),r=dc(n,!0,e+1)),r};lt.toFixed=function(e,t){var r,n,a=this,i=a.constructor;return e===void 0?dc(a):(Ro(e,0,nd),t===void 0?t=i.rounding:Ro(t,0,8),n=an(new i(a),e+Xn(a)+1,t),r=dc(n.abs(),!1,e+Xn(n)+1),a.isneg()&&!a.isZero()?"-"+r:r)};lt.toInteger=lt.toint=function(){var e=this,t=e.constructor;return an(new t(e),Xn(e)+1,t.rounding)};lt.toNumber=function(){return+this};lt.toPower=lt.pow=function(e){var t,r,n,a,i,o,s=this,l=s.constructor,u=12,d=+(e=new l(e));if(!e.s)return new l(xi);if(s=new l(s),!s.s){if(e.s<1)throw Error(Fi+"Infinity");return s}if(s.eq(xi))return s;if(n=l.precision,e.eq(xi))return an(s,n);if(t=e.e,r=e.d.length-1,o=t>=r,i=s.s,o){if((r=d<0?-d:d)<=HM){for(a=new l(xi),t=Math.ceil(n/pn+4),wn=!1;r%2&&(a=a.times(s),o5(a.d,t)),r=ad(r/2),r!==0;)s=s.times(s),o5(s.d,t);return wn=!0,e.s<0?new l(xi).div(a):an(a,n)}}else if(i<0)throw Error(Fi+"NaN");return i=i<0&&e.d[Math.max(t,r)]&1?-1:1,s.s=1,wn=!1,a=e.times(Gf(s,n+u)),wn=!0,a=XM(a),a.s=i,a};lt.toPrecision=function(e,t){var r,n,a=this,i=a.constructor;return e===void 0?(r=Xn(a),n=dc(a,r<=i.toExpNeg||r>=i.toExpPos)):(Ro(e,1,nd),t===void 0?t=i.rounding:Ro(t,0,8),a=an(new i(a),e,t),r=Xn(a),n=dc(a,e<=r||r<=i.toExpNeg,e)),n};lt.toSignificantDigits=lt.tosd=function(e,t){var r=this,n=r.constructor;return e===void 0?(e=n.precision,t=n.rounding):(Ro(e,1,nd),t===void 0?t=n.rounding:Ro(t,0,8)),an(new n(r),e,t)};lt.toString=lt.valueOf=lt.val=lt.toJSON=lt[Symbol.for("nodejs.util.inspect.custom")]=function(){var e=this,t=Xn(e),r=e.constructor;return dc(e,t<=r.toExpNeg||t>=r.toExpPos)};function VM(e,t){var r,n,a,i,o,s,l,u,d=e.constructor,f=d.precision;if(!e.s||!t.s)return t.s||(t=new d(e)),wn?an(t,f):t;if(l=e.d,u=t.d,o=e.e,a=t.e,l=l.slice(),i=o-a,i){for(i<0?(n=l,i=-i,s=u.length):(n=u,a=o,s=l.length),o=Math.ceil(f/pn),s=o>s?o+1:s+1,i>s&&(i=s,n.length=1),n.reverse();i--;)n.push(0);n.reverse()}for(s=l.length,i=u.length,s-i<0&&(i=s,n=u,u=l,l=n),r=0;i;)r=(l[--i]=l[i]+u[i]+r)/ua|0,l[i]%=ua;for(r&&(l.unshift(r),++a),s=l.length;l[--s]==0;)l.pop();return t.d=l,t.e=a,wn?an(t,f):t}function Ro(e,t,r){if(e!==~~e||e<t||e>r)throw Error(Xl+e)}function Co(e){var t,r,n,a=e.length-1,i="",o=e[0];if(a>0){for(i+=o,t=1;t<a;t++)n=e[t]+"",r=pn-n.length,r&&(i+=As(r)),i+=n;o=e[t],n=o+"",r=pn-n.length,r&&(i+=As(r))}else if(o===0)return"0";for(;o%10===0;)o/=10;return i+o}var ss=function(){function e(n,a){var i,o=0,s=n.length;for(n=n.slice();s--;)i=n[s]*a+o,n[s]=i%ua|0,o=i/ua|0;return o&&n.unshift(o),n}function t(n,a,i,o){var s,l;if(i!=o)l=i>o?1:-1;else for(s=l=0;s<i;s++)if(n[s]!=a[s]){l=n[s]>a[s]?1:-1;break}return l}function r(n,a,i){for(var o=0;i--;)n[i]-=o,o=n[i]<a[i]?1:0,n[i]=o*ua+n[i]-a[i];for(;!n[0]&&n.length>1;)n.shift()}return function(n,a,i,o){var s,l,u,d,f,h,g,b,w,v,x,m,k,P,j,S,M,O,E=n.constructor,I=n.s==a.s?1:-1,D=n.d,B=a.d;if(!n.s)return new E(n);if(!a.s)throw Error(Fi+"Division by zero");for(l=n.e-a.e,M=B.length,j=D.length,g=new E(I),b=g.d=[],u=0;B[u]==(D[u]||0);)++u;if(B[u]>(D[u]||0)&&--l,i==null?m=i=E.precision:o?m=i+(Xn(n)-Xn(a))+1:m=i,m<0)return new E(0);if(m=m/pn+2|0,u=0,M==1)for(d=0,B=B[0],m++;(u<j||d)&&m--;u++)k=d*ua+(D[u]||0),b[u]=k/B|0,d=k%B|0;else{for(d=ua/(B[0]+1)|0,d>1&&(B=e(B,d),D=e(D,d),M=B.length,j=D.length),P=M,w=D.slice(0,M),v=w.length;v<M;)w[v++]=0;O=B.slice(),O.unshift(0),S=B[0],B[1]>=ua/2&&++S;do d=0,s=t(B,w,M,v),s<0?(x=w[0],M!=v&&(x=x*ua+(w[1]||0)),d=x/S|0,d>1?(d>=ua&&(d=ua-1),f=e(B,d),h=f.length,v=w.length,s=t(f,w,h,v),s==1&&(d--,r(f,M<h?O:B,h))):(d==0&&(s=d=1),f=B.slice()),h=f.length,h<v&&f.unshift(0),r(w,f,v),s==-1&&(v=w.length,s=t(B,w,M,v),s<1&&(d++,r(w,M<v?O:B,v))),v=w.length):s===0&&(d++,w=[0]),b[u++]=d,s&&w[0]?w[v++]=D[P]||0:(w=[D[P]],v=1);while((P++<j||w[0]!==void 0)&&m--)}return b[0]||b.shift(),g.e=l,an(g,o?i+Xn(g)+1:i)}}();function XM(e,t){var r,n,a,i,o,s,l=0,u=0,d=e.constructor,f=d.precision;if(Xn(e)>16)throw Error(V2+Xn(e));if(!e.s)return new d(xi);for(wn=!1,s=f,o=new d(.03125);e.abs().gte(.1);)e=e.times(o),u+=5;for(n=Math.log(Al(2,u))/Math.LN10*2+5|0,s+=n,r=a=i=new d(xi),d.precision=s;;){if(a=an(a.times(e),s),r=r.times(++l),o=i.plus(ss(a,r,s)),Co(o.d).slice(0,s)===Co(i.d).slice(0,s)){for(;u--;)i=an(i.times(i),s);return d.precision=f,t==null?(wn=!0,an(i,f)):i}i=o}}function Xn(e){for(var t=e.e*pn,r=e.d[0];r>=10;r/=10)t++;return t}function Zy(e,t,r){if(t>e.LN10.sd())throw wn=!0,r&&(e.precision=r),Error(Fi+"LN10 precision limit exceeded");return an(new e(e.LN10),t)}function As(e){for(var t="";e--;)t+="0";return t}function Gf(e,t){var r,n,a,i,o,s,l,u,d,f=1,h=10,g=e,b=g.d,w=g.constructor,v=w.precision;if(g.s<1)throw Error(Fi+(g.s?"NaN":"-Infinity"));if(g.eq(xi))return new w(0);if(t==null?(wn=!1,u=v):u=t,g.eq(10))return t==null&&(wn=!0),Zy(w,u);if(u+=h,w.precision=u,r=Co(b),n=r.charAt(0),i=Xn(g),Math.abs(i)<15e14){for(;n<7&&n!=1||n==1&&r.charAt(1)>3;)g=g.times(e),r=Co(g.d),n=r.charAt(0),f++;i=Xn(g),n>1?(g=new w("0."+r),i++):g=new w(n+"."+r.slice(1))}else return l=Zy(w,u+2,v).times(i+""),g=Gf(new w(n+"."+r.slice(1)),u-h).plus(l),w.precision=v,t==null?(wn=!0,an(g,v)):g;for(s=o=g=ss(g.minus(xi),g.plus(xi),u),d=an(g.times(g),u),a=3;;){if(o=an(o.times(d),u),l=s.plus(ss(o,new w(a),u)),Co(l.d).slice(0,u)===Co(s.d).slice(0,u))return s=s.times(2),i!==0&&(s=s.plus(Zy(w,u+2,v).times(i+""))),s=ss(s,new w(f),u),w.precision=v,t==null?(wn=!0,an(s,v)):s;s=l,a+=2}}function i5(e,t){var r,n,a;for((r=t.indexOf("."))>-1&&(t=t.replace(".","")),(n=t.search(/e/i))>0?(r<0&&(r=n),r+=+t.slice(n+1),t=t.substring(0,n)):r<0&&(r=t.length),n=0;t.charCodeAt(n)===48;)++n;for(a=t.length;t.charCodeAt(a-1)===48;)--a;if(t=t.slice(n,a),t){if(a-=n,r=r-n-1,e.e=ad(r/pn),e.d=[],n=(r+1)%pn,r<0&&(n+=pn),n<a){for(n&&e.d.push(+t.slice(0,n)),a-=pn;n<a;)e.d.push(+t.slice(n,n+=pn));t=t.slice(n),n=pn-t.length}else n-=a;for(;n--;)t+="0";if(e.d.push(+t),wn&&(e.e>Vp||e.e<-Vp))throw Error(V2+r)}else e.s=0,e.e=0,e.d=[0];return e}function an(e,t,r){var n,a,i,o,s,l,u,d,f=e.d;for(o=1,i=f[0];i>=10;i/=10)o++;if(n=t-o,n<0)n+=pn,a=t,u=f[d=0];else{if(d=Math.ceil((n+1)/pn),i=f.length,d>=i)return e;for(u=i=f[d],o=1;i>=10;i/=10)o++;n%=pn,a=n-pn+o}if(r!==void 0&&(i=Al(10,o-a-1),s=u/i%10|0,l=t<0||f[d+1]!==void 0||u%i,l=r<4?(s||l)&&(r==0||r==(e.s<0?3:2)):s>5||s==5&&(r==4||l||r==6&&(n>0?a>0?u/Al(10,o-a):0:f[d-1])%10&1||r==(e.s<0?8:7))),t<1||!f[0])return l?(i=Xn(e),f.length=1,t=t-i-1,f[0]=Al(10,(pn-t%pn)%pn),e.e=ad(-t/pn)||0):(f.length=1,f[0]=e.e=e.s=0),e;if(n==0?(f.length=d,i=1,d--):(f.length=d+1,i=Al(10,pn-n),f[d]=a>0?(u/Al(10,o-a)%Al(10,a)|0)*i:0),l)for(;;)if(d==0){(f[0]+=i)==ua&&(f[0]=1,++e.e);break}else{if(f[d]+=i,f[d]!=ua)break;f[d--]=0,i=1}for(n=f.length;f[--n]===0;)f.pop();if(wn&&(e.e>Vp||e.e<-Vp))throw Error(V2+Xn(e));return e}function KM(e,t){var r,n,a,i,o,s,l,u,d,f,h=e.constructor,g=h.precision;if(!e.s||!t.s)return t.s?t.s=-t.s:t=new h(e),wn?an(t,g):t;if(l=e.d,f=t.d,n=t.e,u=e.e,l=l.slice(),o=u-n,o){for(d=o<0,d?(r=l,o=-o,s=f.length):(r=f,n=u,s=l.length),a=Math.max(Math.ceil(g/pn),s)+2,o>a&&(o=a,r.length=1),r.reverse(),a=o;a--;)r.push(0);r.reverse()}else{for(a=l.length,s=f.length,d=a<s,d&&(s=a),a=0;a<s;a++)if(l[a]!=f[a]){d=l[a]<f[a];break}o=0}for(d&&(r=l,l=f,f=r,t.s=-t.s),s=l.length,a=f.length-s;a>0;--a)l[s++]=0;for(a=f.length;a>o;){if(l[--a]<f[a]){for(i=a;i&&l[--i]===0;)l[i]=ua-1;--l[i],l[a]+=ua}l[a]-=f[a]}for(;l[--s]===0;)l.pop();for(;l[0]===0;l.shift())--n;return l[0]?(t.d=l,t.e=n,wn?an(t,g):t):new h(0)}function dc(e,t,r){var n,a=Xn(e),i=Co(e.d),o=i.length;return t?(r&&(n=r-o)>0?i=i.charAt(0)+"."+i.slice(1)+As(n):o>1&&(i=i.charAt(0)+"."+i.slice(1)),i=i+(a<0?"e":"e+")+a):a<0?(i="0."+As(-a-1)+i,r&&(n=r-o)>0&&(i+=As(n))):a>=o?(i+=As(a+1-o),r&&(n=r-a-1)>0&&(i=i+"."+As(n))):((n=a+1)<o&&(i=i.slice(0,n)+"."+i.slice(n)),r&&(n=r-o)>0&&(a+1===o&&(i+="."),i+=As(n))),e.s<0?"-"+i:i}function o5(e,t){if(e.length>t)return e.length=t,!0}function YM(e){var t,r,n;function a(i){var o=this;if(!(o instanceof a))return new a(i);if(o.constructor=a,i instanceof a){o.s=i.s,o.e=i.e,o.d=(i=i.d)?i.slice():i;return}if(typeof i=="number"){if(i*0!==0)throw Error(Xl+i);if(i>0)o.s=1;else if(i<0)i=-i,o.s=-1;else{o.s=0,o.e=0,o.d=[0];return}if(i===~~i&&i<1e7){o.e=0,o.d=[i];return}return i5(o,i.toString())}else if(typeof i!="string")throw Error(Xl+i);if(i.charCodeAt(0)===45?(i=i.slice(1),o.s=-1):o.s=1,FK.test(i))i5(o,i);else throw Error(Xl+i)}if(a.prototype=lt,a.ROUND_UP=0,a.ROUND_DOWN=1,a.ROUND_CEIL=2,a.ROUND_FLOOR=3,a.ROUND_HALF_UP=4,a.ROUND_HALF_DOWN=5,a.ROUND_HALF_EVEN=6,a.ROUND_HALF_CEIL=7,a.ROUND_HALF_FLOOR=8,a.clone=YM,a.config=a.set=GK,e===void 0&&(e={}),e)for(n=["precision","rounding","toExpNeg","toExpPos","LN10"],t=0;t<n.length;)e.hasOwnProperty(r=n[t++])||(e[r]=this[r]);return a.config(e),a}function GK(e){if(!e||typeof e!="object")throw Error(Fi+"Object expected");var t,r,n,a=["precision",1,nd,"rounding",0,8,"toExpNeg",-1/0,0,"toExpPos",0,1/0];for(t=0;t<a.length;t+=3)if((n=e[r=a[t]])!==void 0)if(ad(n)===n&&n>=a[t+1]&&n<=a[t+2])this[r]=n;else throw Error(Xl+r+": "+n);if((n=e[r="LN10"])!==void 0)if(n==Math.LN10)this[r]=new this(n);else throw Error(Xl+r+": "+n);return this}var X2=YM(LK);xi=new X2(1);const rn=X2;function UK(e){return VK(e)||HK(e)||WK(e)||zK()}function zK(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function WK(e,t){if(e){if(typeof e=="string")return Kv(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Kv(e,t)}}function HK(e){if(typeof Symbol<"u"&&Symbol.iterator in Object(e))return Array.from(e)}function VK(e){if(Array.isArray(e))return Kv(e)}function Kv(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var XK=function(t){return t},qM={},ZM=function(t){return t===qM},s5=function(t){return function r(){return arguments.length===0||arguments.length===1&&ZM(arguments.length<=0?void 0:arguments[0])?r:t.apply(void 0,arguments)}},KK=function e(t,r){return t===1?r:s5(function(){for(var n=arguments.length,a=new Array(n),i=0;i<n;i++)a[i]=arguments[i];var o=a.filter(function(s){return s!==qM}).length;return o>=t?r.apply(void 0,a):e(t-o,s5(function(){for(var s=arguments.length,l=new Array(s),u=0;u<s;u++)l[u]=arguments[u];var d=a.map(function(f){return ZM(f)?l.shift():f});return r.apply(void 0,UK(d).concat(l))}))})},km=function(t){return KK(t.length,t)},Yv=function(t,r){for(var n=[],a=t;a<r;++a)n[a-t]=a;return n},YK=km(function(e,t){return Array.isArray(t)?t.map(e):Object.keys(t).map(function(r){return t[r]}).map(e)}),qK=function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];if(!r.length)return XK;var a=r.reverse(),i=a[0],o=a.slice(1);return function(){return o.reduce(function(s,l){return l(s)},i.apply(void 0,arguments))}},qv=function(t){return Array.isArray(t)?t.reverse():t.split("").reverse.join("")},JM=function(t){var r=null,n=null;return function(){for(var a=arguments.length,i=new Array(a),o=0;o<a;o++)i[o]=arguments[o];return r&&i.every(function(s,l){return s===r[l]})||(r=i,n=t.apply(void 0,i)),n}};function ZK(e){var t;return e===0?t=1:t=Math.floor(new rn(e).abs().log(10).toNumber())+1,t}function JK(e,t,r){for(var n=new rn(e),a=0,i=[];n.lt(t)&&a<1e5;)i.push(n.toNumber()),n=n.add(r),a++;return i}var QK=km(function(e,t,r){var n=+e,a=+t;return n+r*(a-n)}),eY=km(function(e,t,r){var n=t-+e;return n=n||1/0,(r-e)/n}),tY=km(function(e,t,r){var n=t-+e;return n=n||1/0,Math.max(0,Math.min(1,(r-e)/n))});const Sm={rangeStep:JK,getDigitCount:ZK,interpolateNumber:QK,uninterpolateNumber:eY,uninterpolateTruncation:tY};function Zv(e){return aY(e)||nY(e)||QM(e)||rY()}function rY(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function nY(e){if(typeof Symbol<"u"&&Symbol.iterator in Object(e))return Array.from(e)}function aY(e){if(Array.isArray(e))return Jv(e)}function Uf(e,t){return sY(e)||oY(e,t)||QM(e,t)||iY()}function iY(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function QM(e,t){if(e){if(typeof e=="string")return Jv(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Jv(e,t)}}function Jv(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function oY(e,t){if(!(typeof Symbol>"u"||!(Symbol.iterator in Object(e)))){var r=[],n=!0,a=!1,i=void 0;try{for(var o=e[Symbol.iterator](),s;!(n=(s=o.next()).done)&&(r.push(s.value),!(t&&r.length===t));n=!0);}catch(l){a=!0,i=l}finally{try{!n&&o.return!=null&&o.return()}finally{if(a)throw i}}return r}}function sY(e){if(Array.isArray(e))return e}function eN(e){var t=Uf(e,2),r=t[0],n=t[1],a=r,i=n;return r>n&&(a=n,i=r),[a,i]}function tN(e,t,r){if(e.lte(0))return new rn(0);var n=Sm.getDigitCount(e.toNumber()),a=new rn(10).pow(n),i=e.div(a),o=n!==1?.05:.1,s=new rn(Math.ceil(i.div(o).toNumber())).add(r).mul(o),l=s.mul(a);return t?l:new rn(Math.ceil(l))}function lY(e,t,r){var n=1,a=new rn(e);if(!a.isint()&&r){var i=Math.abs(e);i<1?(n=new rn(10).pow(Sm.getDigitCount(e)-1),a=new rn(Math.floor(a.div(n).toNumber())).mul(n)):i>1&&(a=new rn(Math.floor(e)))}else e===0?a=new rn(Math.floor((t-1)/2)):r||(a=new rn(Math.floor(e)));var o=Math.floor((t-1)/2),s=qK(YK(function(l){return a.add(new rn(l-o).mul(n)).toNumber()}),Yv);return s(0,t)}function rN(e,t,r,n){var a=arguments.length>4&&arguments[4]!==void 0?arguments[4]:0;if(!Number.isFinite((t-e)/(r-1)))return{step:new rn(0),tickMin:new rn(0),tickMax:new rn(0)};var i=tN(new rn(t).sub(e).div(r-1),n,a),o;e<=0&&t>=0?o=new rn(0):(o=new rn(e).add(t).div(2),o=o.sub(new rn(o).mod(i)));var s=Math.ceil(o.sub(e).div(i).toNumber()),l=Math.ceil(new rn(t).sub(o).div(i).toNumber()),u=s+l+1;return u>r?rN(e,t,r,n,a+1):(u<r&&(l=t>0?l+(r-u):l,s=t>0?s:s+(r-u)),{step:i,tickMin:o.sub(new rn(s).mul(i)),tickMax:o.add(new rn(l).mul(i))})}function cY(e){var t=Uf(e,2),r=t[0],n=t[1],a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:6,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,o=Math.max(a,2),s=eN([r,n]),l=Uf(s,2),u=l[0],d=l[1];if(u===-1/0||d===1/0){var f=d===1/0?[u].concat(Zv(Yv(0,a-1).map(function(){return 1/0}))):[].concat(Zv(Yv(0,a-1).map(function(){return-1/0})),[d]);return r>n?qv(f):f}if(u===d)return lY(u,a,i);var h=rN(u,d,o,i),g=h.step,b=h.tickMin,w=h.tickMax,v=Sm.rangeStep(b,w.add(new rn(.1).mul(g)),g);return r>n?qv(v):v}function uY(e,t){var r=Uf(e,2),n=r[0],a=r[1],i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,o=eN([n,a]),s=Uf(o,2),l=s[0],u=s[1];if(l===-1/0||u===1/0)return[n,a];if(l===u)return[l];var d=Math.max(t,2),f=tN(new rn(u).sub(l).div(d-1),i,0),h=[].concat(Zv(Sm.rangeStep(new rn(l),new rn(u).sub(new rn(.99).mul(f)),f)),[u]);return n>a?qv(h):h}var dY=JM(cY),fY=JM(uY),hY="Invariant failed";function fc(e,t){throw new Error(hY)}var pY=["offset","layout","width","dataKey","data","dataPointFormatter","xAxis","yAxis"];function Su(e){"@babel/helpers - typeof";return Su=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Su(e)}function Xp(){return Xp=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Xp.apply(this,arguments)}function gY(e,t){return vY(e)||xY(e,t)||yY(e,t)||mY()}function mY(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function yY(e,t){if(e){if(typeof e=="string")return l5(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return l5(e,t)}}function l5(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function xY(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,a,i,o,s=[],l=!0,u=!1;try{if(i=(r=r.call(e)).next,t!==0)for(;!(l=(n=i.call(r)).done)&&(s.push(n.value),s.length!==t);l=!0);}catch(d){u=!0,a=d}finally{try{if(!l&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(u)throw a}}return s}}function vY(e){if(Array.isArray(e))return e}function bY(e,t){if(e==null)return{};var r=wY(e,t),n,a;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function wY(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function kY(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function SY(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,iN(n.key),n)}}function jY(e,t,r){return t&&SY(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function PY(e,t,r){return t=Kp(t),_Y(e,nN()?Reflect.construct(t,r||[],Kp(e).constructor):t.apply(e,r))}function _Y(e,t){if(t&&(Su(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return CY(e)}function CY(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function nN(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(nN=function(){return!!e})()}function Kp(e){return Kp=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Kp(e)}function MY(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Qv(e,t)}function Qv(e,t){return Qv=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},Qv(e,t)}function aN(e,t,r){return t=iN(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function iN(e){var t=NY(e,"string");return Su(t)=="symbol"?t:t+""}function NY(e,t){if(Su(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(Su(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var id=function(e){function t(){return kY(this,t),PY(this,t,arguments)}return MY(t,e),jY(t,[{key:"render",value:function(){var n=this.props,a=n.offset,i=n.layout,o=n.width,s=n.dataKey,l=n.data,u=n.dataPointFormatter,d=n.xAxis,f=n.yAxis,h=bY(n,pY),g=er(h,!1);this.props.direction==="x"&&d.type!=="number"&&fc();var b=l.map(function(w){var v=u(w,s),x=v.x,m=v.y,k=v.value,P=v.errorVal;if(!P)return null;var j=[],S,M;if(Array.isArray(P)){var O=gY(P,2);S=O[0],M=O[1]}else S=M=P;if(i==="vertical"){var E=d.scale,I=m+a,D=I+o,B=I-o,z=E(k-S),Y=E(k+M);j.push({x1:Y,y1:D,x2:Y,y2:B}),j.push({x1:z,y1:I,x2:Y,y2:I}),j.push({x1:z,y1:D,x2:z,y2:B})}else if(i==="horizontal"){var G=f.scale,$=x+a,L=$-o,U=$+o,V=G(k-S),J=G(k+M);j.push({x1:L,y1:J,x2:U,y2:J}),j.push({x1:$,y1:V,x2:$,y2:J}),j.push({x1:L,y1:V,x2:U,y2:V})}return oe.createElement(Wr,Xp({className:"recharts-errorBar",key:"bar-".concat(j.map(function(K){return"".concat(K.x1,"-").concat(K.x2,"-").concat(K.y1,"-").concat(K.y2)}))},g),j.map(function(K){return oe.createElement("line",Xp({},K,{key:"line-".concat(K.x1,"-").concat(K.x2,"-").concat(K.y1,"-").concat(K.y2)}))}))});return oe.createElement(Wr,{className:"recharts-errorBars"},b)}}])}(oe.Component);aN(id,"defaultProps",{stroke:"black",strokeWidth:1.5,width:5,offset:0,layout:"horizontal"});aN(id,"displayName","ErrorBar");function zf(e){"@babel/helpers - typeof";return zf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},zf(e)}function c5(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function _l(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?c5(Object(r),!0).forEach(function(n){OY(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):c5(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function OY(e,t,r){return t=AY(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function AY(e){var t=TY(e,"string");return zf(t)=="symbol"?t:t+""}function TY(e,t){if(zf(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(zf(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var oN=function(t){var r=t.children,n=t.formattedGraphicalItems,a=t.legendWidth,i=t.legendContent,o=yi(r,To);if(!o)return null;var s=To.defaultProps,l=s!==void 0?_l(_l({},s),o.props):{},u;return o.props&&o.props.payload?u=o.props&&o.props.payload:i==="children"?u=(n||[]).reduce(function(d,f){var h=f.item,g=f.props,b=g.sectors||g.data||[];return d.concat(b.map(function(w){return{type:o.props.iconType||h.props.legendType,value:w.name,color:w.fill,payload:w}}))},[]):u=(n||[]).map(function(d){var f=d.item,h=f.type.defaultProps,g=h!==void 0?_l(_l({},h),f.props):{},b=g.dataKey,w=g.name,v=g.legendType,x=g.hide;return{inactive:x,dataKey:b,type:l.iconType||v||"square",color:K2(f),value:w||b,payload:g}}),_l(_l(_l({},l),To.getWithHeight(o,a)),{},{payload:u,item:o})};function Wf(e){"@babel/helpers - typeof";return Wf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Wf(e)}function u5(e){return DY(e)||$Y(e)||IY(e)||EY()}function EY(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function IY(e,t){if(e){if(typeof e=="string")return e1(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return e1(e,t)}}function $Y(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function DY(e){if(Array.isArray(e))return e1(e)}function e1(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function d5(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Tn(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?d5(Object(r),!0).forEach(function(n){iu(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):d5(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function iu(e,t,r){return t=RY(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function RY(e){var t=BY(e,"string");return Wf(t)=="symbol"?t:t+""}function BY(e,t){if(Wf(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(Wf(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function ia(e,t,r){return Zt(e)||Zt(t)?r:aa(t)?Ri(e,t,r):tr(t)?t(e):r}function nf(e,t,r,n){var a=$K(e,function(s){return ia(s,t)});if(r==="number"){var i=a.filter(function(s){return Fe(s)||parseFloat(s)});return i.length?[wm(i),Us(i)]:[1/0,-1/0]}var o=n?a.filter(function(s){return!Zt(s)}):a;return o.map(function(s){return aa(s)||s instanceof Date?s:""})}var LY=function(t){var r,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],a=arguments.length>2?arguments[2]:void 0,i=arguments.length>3?arguments[3]:void 0,o=-1,s=(r=n==null?void 0:n.length)!==null&&r!==void 0?r:0;if(s<=1)return 0;if(i&&i.axisType==="angleAxis"&&Math.abs(Math.abs(i.range[1]-i.range[0])-360)<=1e-6)for(var l=i.range,u=0;u<s;u++){var d=u>0?a[u-1].coordinate:a[s-1].coordinate,f=a[u].coordinate,h=u>=s-1?a[0].coordinate:a[u+1].coordinate,g=void 0;if(oo(f-d)!==oo(h-f)){var b=[];if(oo(h-f)===oo(l[1]-l[0])){g=h;var w=f+l[1]-l[0];b[0]=Math.min(w,(w+d)/2),b[1]=Math.max(w,(w+d)/2)}else{g=d;var v=h+l[1]-l[0];b[0]=Math.min(f,(v+f)/2),b[1]=Math.max(f,(v+f)/2)}var x=[Math.min(f,(g+f)/2),Math.max(f,(g+f)/2)];if(t>x[0]&&t<=x[1]||t>=b[0]&&t<=b[1]){o=a[u].index;break}}else{var m=Math.min(d,h),k=Math.max(d,h);if(t>(m+f)/2&&t<=(k+f)/2){o=a[u].index;break}}}else for(var P=0;P<s;P++)if(P===0&&t<=(n[P].coordinate+n[P+1].coordinate)/2||P>0&&P<s-1&&t>(n[P].coordinate+n[P-1].coordinate)/2&&t<=(n[P].coordinate+n[P+1].coordinate)/2||P===s-1&&t>(n[P].coordinate+n[P-1].coordinate)/2){o=n[P].index;break}return o},K2=function(t){var r,n=t,a=n.type.displayName,i=(r=t.type)!==null&&r!==void 0&&r.defaultProps?Tn(Tn({},t.type.defaultProps),t.props):t.props,o=i.stroke,s=i.fill,l;switch(a){case"Line":l=o;break;case"Area":case"Radar":l=o&&o!=="none"?o:s;break;default:l=s;break}return l},FY=function(t){var r=t.barSize,n=t.totalSize,a=t.stackGroups,i=a===void 0?{}:a;if(!i)return{};for(var o={},s=Object.keys(i),l=0,u=s.length;l<u;l++)for(var d=i[s[l]].stackGroups,f=Object.keys(d),h=0,g=f.length;h<g;h++){var b=d[f[h]],w=b.items,v=b.cateAxisId,x=w.filter(function(M){return is(M.type).indexOf("Bar")>=0});if(x&&x.length){var m=x[0].type.defaultProps,k=m!==void 0?Tn(Tn({},m),x[0].props):x[0].props,P=k.barSize,j=k[v];o[j]||(o[j]=[]);var S=Zt(P)?r:P;o[j].push({item:x[0],stackList:x.slice(1),barSize:Zt(S)?void 0:cc(S,n,0)})}}return o},GY=function(t){var r=t.barGap,n=t.barCategoryGap,a=t.bandSize,i=t.sizeList,o=i===void 0?[]:i,s=t.maxBarSize,l=o.length;if(l<1)return null;var u=cc(r,a,0,!0),d,f=[];if(o[0].barSize===+o[0].barSize){var h=!1,g=a/l,b=o.reduce(function(P,j){return P+j.barSize||0},0);b+=(l-1)*u,b>=a&&(b-=(l-1)*u,u=0),b>=a&&g>0&&(h=!0,g*=.9,b=l*g);var w=(a-b)/2>>0,v={offset:w-u,size:0};d=o.reduce(function(P,j){var S={item:j.item,position:{offset:v.offset+v.size+u,size:h?g:j.barSize}},M=[].concat(u5(P),[S]);return v=M[M.length-1].position,j.stackList&&j.stackList.length&&j.stackList.forEach(function(O){M.push({item:O,position:v})}),M},f)}else{var x=cc(n,a,0,!0);a-2*x-(l-1)*u<=0&&(u=0);var m=(a-2*x-(l-1)*u)/l;m>1&&(m>>=0);var k=s===+s?Math.min(m,s):m;d=o.reduce(function(P,j,S){var M=[].concat(u5(P),[{item:j.item,position:{offset:x+(m+u)*S+(m-k)/2,size:k}}]);return j.stackList&&j.stackList.length&&j.stackList.forEach(function(O){M.push({item:O,position:M[M.length-1].position})}),M},f)}return d},UY=function(t,r,n,a){var i=n.children,o=n.width,s=n.margin,l=o-(s.left||0)-(s.right||0),u=oN({children:i,legendWidth:l});if(u){var d=a||{},f=d.width,h=d.height,g=u.align,b=u.verticalAlign,w=u.layout;if((w==="vertical"||w==="horizontal"&&b==="middle")&&g!=="center"&&Fe(t[g]))return Tn(Tn({},t),{},iu({},g,t[g]+(f||0)));if((w==="horizontal"||w==="vertical"&&g==="center")&&b!=="middle"&&Fe(t[b]))return Tn(Tn({},t),{},iu({},b,t[b]+(h||0)))}return t},zY=function(t,r,n){return Zt(r)?!0:t==="horizontal"?r==="yAxis":t==="vertical"||n==="x"?r==="xAxis":n==="y"?r==="yAxis":!0},sN=function(t,r,n,a,i){var o=r.props.children,s=li(o,id).filter(function(u){return zY(a,i,u.props.direction)});if(s&&s.length){var l=s.map(function(u){return u.props.dataKey});return t.reduce(function(u,d){var f=ia(d,n);if(Zt(f))return u;var h=Array.isArray(f)?[wm(f),Us(f)]:[f,f],g=l.reduce(function(b,w){var v=ia(d,w,0),x=h[0]-Math.abs(Array.isArray(v)?v[0]:v),m=h[1]+Math.abs(Array.isArray(v)?v[1]:v);return[Math.min(x,b[0]),Math.max(m,b[1])]},[1/0,-1/0]);return[Math.min(g[0],u[0]),Math.max(g[1],u[1])]},[1/0,-1/0])}return null},WY=function(t,r,n,a,i){var o=r.map(function(s){return sN(t,s,n,i,a)}).filter(function(s){return!Zt(s)});return o&&o.length?o.reduce(function(s,l){return[Math.min(s[0],l[0]),Math.max(s[1],l[1])]},[1/0,-1/0]):null},lN=function(t,r,n,a,i){var o=r.map(function(l){var u=l.props.dataKey;return n==="number"&&u&&sN(t,l,u,a)||nf(t,u,n,i)});if(n==="number")return o.reduce(function(l,u){return[Math.min(l[0],u[0]),Math.max(l[1],u[1])]},[1/0,-1/0]);var s={};return o.reduce(function(l,u){for(var d=0,f=u.length;d<f;d++)s[u[d]]||(s[u[d]]=!0,l.push(u[d]));return l},[])},cN=function(t,r){return t==="horizontal"&&r==="xAxis"||t==="vertical"&&r==="yAxis"||t==="centric"&&r==="angleAxis"||t==="radial"&&r==="radiusAxis"},uN=function(t,r,n,a){if(a)return t.map(function(l){return l.coordinate});var i,o,s=t.map(function(l){return l.coordinate===r&&(i=!0),l.coordinate===n&&(o=!0),l.coordinate});return i||s.push(r),o||s.push(n),s},ns=function(t,r,n){if(!t)return null;var a=t.scale,i=t.duplicateDomain,o=t.type,s=t.range,l=t.realScaleType==="scaleBand"?a.bandwidth()/2:2,u=(r||n)&&o==="category"&&a.bandwidth?a.bandwidth()/l:0;if(u=t.axisType==="angleAxis"&&(s==null?void 0:s.length)>=2?oo(s[0]-s[1])*2*u:u,r&&(t.ticks||t.niceTicks)){var d=(t.ticks||t.niceTicks).map(function(f){var h=i?i.indexOf(f):f;return{coordinate:a(h)+u,value:f,offset:u}});return d.filter(function(f){return!Ju(f.coordinate)})}return t.isCategorical&&t.categoricalDomain?t.categoricalDomain.map(function(f,h){return{coordinate:a(f)+u,value:f,index:h,offset:u}}):a.ticks&&!n?a.ticks(t.tickCount).map(function(f){return{coordinate:a(f)+u,value:f,offset:u}}):a.domain().map(function(f,h){return{coordinate:a(f)+u,value:i?i[f]:f,index:h,offset:u}})},Jy=new WeakMap,xh=function(t,r){if(typeof r!="function")return t;Jy.has(t)||Jy.set(t,new WeakMap);var n=Jy.get(t);if(n.has(r))return n.get(r);var a=function(){t.apply(void 0,arguments),r.apply(void 0,arguments)};return n.set(r,a),a},HY=function(t,r,n){var a=t.scale,i=t.type,o=t.layout,s=t.axisType;if(a==="auto")return o==="radial"&&s==="radiusAxis"?{scale:Df(),realScaleType:"band"}:o==="radial"&&s==="angleAxis"?{scale:Up(),realScaleType:"linear"}:i==="category"&&r&&(r.indexOf("LineChart")>=0||r.indexOf("AreaChart")>=0||r.indexOf("ComposedChart")>=0&&!n)?{scale:rf(),realScaleType:"point"}:i==="category"?{scale:Df(),realScaleType:"band"}:{scale:Up(),realScaleType:"linear"};if(lc(a)){var l="scale".concat(sm(a));return{scale:(a5[l]||rf)(),realScaleType:a5[l]?l:"point"}}return tr(a)?{scale:a}:{scale:rf(),realScaleType:"point"}},f5=1e-4,VY=function(t){var r=t.domain();if(!(!r||r.length<=2)){var n=r.length,a=t.range(),i=Math.min(a[0],a[1])-f5,o=Math.max(a[0],a[1])+f5,s=t(r[0]),l=t(r[n-1]);(s<i||s>o||l<i||l>o)&&t.domain([r[0],r[n-1]])}},XY=function(t,r){if(!t)return null;for(var n=0,a=t.length;n<a;n++)if(t[n].item===r)return t[n].position;return null},KY=function(t,r){if(!r||r.length!==2||!Fe(r[0])||!Fe(r[1]))return t;var n=Math.min(r[0],r[1]),a=Math.max(r[0],r[1]),i=[t[0],t[1]];return(!Fe(t[0])||t[0]<n)&&(i[0]=n),(!Fe(t[1])||t[1]>a)&&(i[1]=a),i[0]>a&&(i[0]=a),i[1]<n&&(i[1]=n),i},YY=function(t){var r=t.length;if(!(r<=0))for(var n=0,a=t[0].length;n<a;++n)for(var i=0,o=0,s=0;s<r;++s){var l=Ju(t[s][n][1])?t[s][n][0]:t[s][n][1];l>=0?(t[s][n][0]=i,t[s][n][1]=i+l,i=t[s][n][1]):(t[s][n][0]=o,t[s][n][1]=o+l,o=t[s][n][1])}},qY=function(t){var r=t.length;if(!(r<=0))for(var n=0,a=t[0].length;n<a;++n)for(var i=0,o=0;o<r;++o){var s=Ju(t[o][n][1])?t[o][n][0]:t[o][n][1];s>=0?(t[o][n][0]=i,t[o][n][1]=i+s,i=t[o][n][1]):(t[o][n][0]=0,t[o][n][1]=0)}},ZY={sign:YY,expand:f7,none:gu,silhouette:h7,wiggle:p7,positive:qY},JY=function(t,r,n){var a=r.map(function(s){return s.props.dataKey}),i=ZY[n],o=d7().keys(a).value(function(s,l){return+ia(s,l,0)}).order(Pv).offset(i);return o(t)},QY=function(t,r,n,a,i,o){if(!t)return null;var s=o?r.reverse():r,l={},u=s.reduce(function(f,h){var g,b=(g=h.type)!==null&&g!==void 0&&g.defaultProps?Tn(Tn({},h.type.defaultProps),h.props):h.props,w=b.stackId,v=b.hide;if(v)return f;var x=b[n],m=f[x]||{hasStack:!1,stackGroups:{}};if(aa(w)){var k=m.stackGroups[w]||{numericAxisId:n,cateAxisId:a,items:[]};k.items.push(h),m.hasStack=!0,m.stackGroups[w]=k}else m.stackGroups[xc("_stackId_")]={numericAxisId:n,cateAxisId:a,items:[h]};return Tn(Tn({},f),{},iu({},x,m))},l),d={};return Object.keys(u).reduce(function(f,h){var g=u[h];if(g.hasStack){var b={};g.stackGroups=Object.keys(g.stackGroups).reduce(function(w,v){var x=g.stackGroups[v];return Tn(Tn({},w),{},iu({},v,{numericAxisId:n,cateAxisId:a,items:x.items,stackedData:JY(t,x.items,i)}))},b)}return Tn(Tn({},f),{},iu({},h,g))},d)},eq=function(t,r){var n=r.realScaleType,a=r.type,i=r.tickCount,o=r.originalDomain,s=r.allowDecimals,l=n||r.scale;if(l!=="auto"&&l!=="linear")return null;if(i&&a==="number"&&o&&(o[0]==="auto"||o[1]==="auto")){var u=t.domain();if(!u.length)return null;var d=dY(u,i,s);return t.domain([wm(d),Us(d)]),{niceTicks:d}}if(i&&a==="number"){var f=t.domain(),h=fY(f,i,s);return{niceTicks:h}}return null};function ju(e){var t=e.axis,r=e.ticks,n=e.bandSize,a=e.entry,i=e.index,o=e.dataKey;if(t.type==="category"){if(!t.allowDuplicatedCategory&&t.dataKey&&!Zt(a[t.dataKey])){var s=vp(r,"value",a[t.dataKey]);if(s)return s.coordinate+n/2}return r[i]?r[i].coordinate+n/2:null}var l=ia(a,Zt(o)?t.dataKey:o);return Zt(l)?null:t.scale(l)}var h5=function(t){var r=t.axis,n=t.ticks,a=t.offset,i=t.bandSize,o=t.entry,s=t.index;if(r.type==="category")return n[s]?n[s].coordinate+a:null;var l=ia(o,r.dataKey,r.domain[s]);return Zt(l)?null:r.scale(l)-i/2+a},tq=function(t){var r=t.numericAxis,n=r.scale.domain();if(r.type==="number"){var a=Math.min(n[0],n[1]),i=Math.max(n[0],n[1]);return a<=0&&i>=0?0:i<0?i:a}return n[0]},rq=function(t,r){var n,a=(n=t.type)!==null&&n!==void 0&&n.defaultProps?Tn(Tn({},t.type.defaultProps),t.props):t.props,i=a.stackId;if(aa(i)){var o=r[i];if(o){var s=o.items.indexOf(t);return s>=0?o.stackedData[s]:null}}return null},nq=function(t){return t.reduce(function(r,n){return[wm(n.concat([r[0]]).filter(Fe)),Us(n.concat([r[1]]).filter(Fe))]},[1/0,-1/0])},dN=function(t,r,n){return Object.keys(t).reduce(function(a,i){var o=t[i],s=o.stackedData,l=s.reduce(function(u,d){var f=nq(d.slice(r,n+1));return[Math.min(u[0],f[0]),Math.max(u[1],f[1])]},[1/0,-1/0]);return[Math.min(l[0],a[0]),Math.max(l[1],a[1])]},[1/0,-1/0]).map(function(a){return a===1/0||a===-1/0?0:a})},p5=/^dataMin[\s]*-[\s]*([0-9]+([.]{1}[0-9]+){0,1})$/,g5=/^dataMax[\s]*\+[\s]*([0-9]+([.]{1}[0-9]+){0,1})$/,t1=function(t,r,n){if(tr(t))return t(r,n);if(!Array.isArray(t))return r;var a=[];if(Fe(t[0]))a[0]=n?t[0]:Math.min(t[0],r[0]);else if(p5.test(t[0])){var i=+p5.exec(t[0])[1];a[0]=r[0]-i}else tr(t[0])?a[0]=t[0](r[0]):a[0]=r[0];if(Fe(t[1]))a[1]=n?t[1]:Math.max(t[1],r[1]);else if(g5.test(t[1])){var o=+g5.exec(t[1])[1];a[1]=r[1]+o}else tr(t[1])?a[1]=t[1](r[1]):a[1]=r[1];return a},Yp=function(t,r,n){if(t&&t.scale&&t.scale.bandwidth){var a=t.scale.bandwidth();if(!n||a>0)return a}if(t&&r&&r.length>=2){for(var i=w2(r,function(f){return f.coordinate}),o=1/0,s=1,l=i.length;s<l;s++){var u=i[s],d=i[s-1];o=Math.min((u.coordinate||0)-(d.coordinate||0),o)}return o===1/0?0:o}return n?void 0:0},m5=function(t,r,n){return!t||!t.length||uc(t,Ri(n,"type.defaultProps.domain"))?r:t},fN=function(t,r){var n=t.type.defaultProps?Tn(Tn({},t.type.defaultProps),t.props):t.props,a=n.dataKey,i=n.name,o=n.unit,s=n.formatter,l=n.tooltipType,u=n.chartType,d=n.hide;return Tn(Tn({},er(t,!1)),{},{dataKey:a,unit:o,formatter:s,name:i||a,color:K2(t),value:ia(r,a),type:l,payload:r,chartType:u,hide:d})};function Hf(e){"@babel/helpers - typeof";return Hf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Hf(e)}function y5(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function x5(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?y5(Object(r),!0).forEach(function(n){aq(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):y5(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function aq(e,t,r){return t=iq(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function iq(e){var t=oq(e,"string");return Hf(t)=="symbol"?t:t+""}function oq(e,t){if(Hf(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(Hf(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var qp=Math.PI/180,sq=function(t){return t*180/Math.PI},ka=function(t,r,n,a){return{x:t+Math.cos(-qp*a)*n,y:r+Math.sin(-qp*a)*n}},lq=function(t,r){var n=t.x,a=t.y,i=r.x,o=r.y;return Math.sqrt(Math.pow(n-i,2)+Math.pow(a-o,2))},cq=function(t,r){var n=t.x,a=t.y,i=r.cx,o=r.cy,s=lq({x:n,y:a},{x:i,y:o});if(s<=0)return{radius:s};var l=(n-i)/s,u=Math.acos(l);return a>o&&(u=2*Math.PI-u),{radius:s,angle:sq(u),angleInRadian:u}},uq=function(t){var r=t.startAngle,n=t.endAngle,a=Math.floor(r/360),i=Math.floor(n/360),o=Math.min(a,i);return{startAngle:r-o*360,endAngle:n-o*360}},dq=function(t,r){var n=r.startAngle,a=r.endAngle,i=Math.floor(n/360),o=Math.floor(a/360),s=Math.min(i,o);return t+s*360},v5=function(t,r){var n=t.x,a=t.y,i=cq({x:n,y:a},r),o=i.radius,s=i.angle,l=r.innerRadius,u=r.outerRadius;if(o<l||o>u)return!1;if(o===0)return!0;var d=uq(r),f=d.startAngle,h=d.endAngle,g=s,b;if(f<=h){for(;g>h;)g-=360;for(;g<f;)g+=360;b=g>=f&&g<=h}else{for(;g>f;)g-=360;for(;g<h;)g+=360;b=g>=h&&g<=f}return b?x5(x5({},r),{},{radius:o,angle:dq(g,r)}):null};function Vf(e){"@babel/helpers - typeof";return Vf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Vf(e)}var fq=["offset"];function hq(e){return yq(e)||mq(e)||gq(e)||pq()}function pq(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function gq(e,t){if(e){if(typeof e=="string")return r1(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return r1(e,t)}}function mq(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function yq(e){if(Array.isArray(e))return r1(e)}function r1(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function xq(e,t){if(e==null)return{};var r=vq(e,t),n,a;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function vq(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function b5(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function ea(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?b5(Object(r),!0).forEach(function(n){bq(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):b5(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function bq(e,t,r){return t=wq(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function wq(e){var t=kq(e,"string");return Vf(t)=="symbol"?t:t+""}function kq(e,t){if(Vf(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(Vf(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Xf(){return Xf=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Xf.apply(this,arguments)}var Sq=function(t){var r=t.value,n=t.formatter,a=Zt(t.children)?r:t.children;return tr(n)?n(a):a},jq=function(t,r){var n=oo(r-t),a=Math.min(Math.abs(r-t),360);return n*a},Pq=function(t,r,n){var a=t.position,i=t.viewBox,o=t.offset,s=t.className,l=i,u=l.cx,d=l.cy,f=l.innerRadius,h=l.outerRadius,g=l.startAngle,b=l.endAngle,w=l.clockWise,v=(f+h)/2,x=jq(g,b),m=x>=0?1:-1,k,P;a==="insideStart"?(k=g+m*o,P=w):a==="insideEnd"?(k=b-m*o,P=!w):a==="end"&&(k=b+m*o,P=w),P=x<=0?P:!P;var j=ka(u,d,v,k),S=ka(u,d,v,k+(P?1:-1)*359),M="M".concat(j.x,",").concat(j.y,`
    A`).concat(v,",").concat(v,",0,1,").concat(P?0:1,`,
    `).concat(S.x,",").concat(S.y),O=Zt(t.id)?xc("recharts-radial-line-"):t.id;return oe.createElement("text",Xf({},n,{dominantBaseline:"central",className:kr("recharts-radial-bar-label",s)}),oe.createElement("defs",null,oe.createElement("path",{id:O,d:M})),oe.createElement("textPath",{xlinkHref:"#".concat(O)},r))},_q=function(t){var r=t.viewBox,n=t.offset,a=t.position,i=r,o=i.cx,s=i.cy,l=i.innerRadius,u=i.outerRadius,d=i.startAngle,f=i.endAngle,h=(d+f)/2;if(a==="outside"){var g=ka(o,s,u+n,h),b=g.x,w=g.y;return{x:b,y:w,textAnchor:b>=o?"start":"end",verticalAnchor:"middle"}}if(a==="center")return{x:o,y:s,textAnchor:"middle",verticalAnchor:"middle"};if(a==="centerTop")return{x:o,y:s,textAnchor:"middle",verticalAnchor:"start"};if(a==="centerBottom")return{x:o,y:s,textAnchor:"middle",verticalAnchor:"end"};var v=(l+u)/2,x=ka(o,s,v,h),m=x.x,k=x.y;return{x:m,y:k,textAnchor:"middle",verticalAnchor:"middle"}},Cq=function(t){var r=t.viewBox,n=t.parentViewBox,a=t.offset,i=t.position,o=r,s=o.x,l=o.y,u=o.width,d=o.height,f=d>=0?1:-1,h=f*a,g=f>0?"end":"start",b=f>0?"start":"end",w=u>=0?1:-1,v=w*a,x=w>0?"end":"start",m=w>0?"start":"end";if(i==="top"){var k={x:s+u/2,y:l-f*a,textAnchor:"middle",verticalAnchor:g};return ea(ea({},k),n?{height:Math.max(l-n.y,0),width:u}:{})}if(i==="bottom"){var P={x:s+u/2,y:l+d+h,textAnchor:"middle",verticalAnchor:b};return ea(ea({},P),n?{height:Math.max(n.y+n.height-(l+d),0),width:u}:{})}if(i==="left"){var j={x:s-v,y:l+d/2,textAnchor:x,verticalAnchor:"middle"};return ea(ea({},j),n?{width:Math.max(j.x-n.x,0),height:d}:{})}if(i==="right"){var S={x:s+u+v,y:l+d/2,textAnchor:m,verticalAnchor:"middle"};return ea(ea({},S),n?{width:Math.max(n.x+n.width-S.x,0),height:d}:{})}var M=n?{width:u,height:d}:{};return i==="insideLeft"?ea({x:s+v,y:l+d/2,textAnchor:m,verticalAnchor:"middle"},M):i==="insideRight"?ea({x:s+u-v,y:l+d/2,textAnchor:x,verticalAnchor:"middle"},M):i==="insideTop"?ea({x:s+u/2,y:l+h,textAnchor:"middle",verticalAnchor:b},M):i==="insideBottom"?ea({x:s+u/2,y:l+d-h,textAnchor:"middle",verticalAnchor:g},M):i==="insideTopLeft"?ea({x:s+v,y:l+h,textAnchor:m,verticalAnchor:b},M):i==="insideTopRight"?ea({x:s+u-v,y:l+h,textAnchor:x,verticalAnchor:b},M):i==="insideBottomLeft"?ea({x:s+v,y:l+d-h,textAnchor:m,verticalAnchor:g},M):i==="insideBottomRight"?ea({x:s+u-v,y:l+d-h,textAnchor:x,verticalAnchor:g},M):Ku(i)&&(Fe(i.x)||Bl(i.x))&&(Fe(i.y)||Bl(i.y))?ea({x:s+cc(i.x,u),y:l+cc(i.y,d),textAnchor:"end",verticalAnchor:"end"},M):ea({x:s+u/2,y:l+d/2,textAnchor:"middle",verticalAnchor:"middle"},M)},Mq=function(t){return"cx"in t&&Fe(t.cx)};function wa(e){var t=e.offset,r=t===void 0?5:t,n=xq(e,fq),a=ea({offset:r},n),i=a.viewBox,o=a.position,s=a.value,l=a.children,u=a.content,d=a.className,f=d===void 0?"":d,h=a.textBreakAll;if(!i||Zt(s)&&Zt(l)&&!_.isValidElement(u)&&!tr(u))return null;if(_.isValidElement(u))return _.cloneElement(u,a);var g;if(tr(u)){if(g=_.createElement(u,a),_.isValidElement(g))return g}else g=Sq(a);var b=Mq(i),w=er(a,!0);if(b&&(o==="insideStart"||o==="insideEnd"||o==="end"))return Pq(a,g,w);var v=b?_q(a):Cq(a);return oe.createElement(Ip,Xf({className:kr("recharts-label",f)},w,v,{breakAll:h}),g)}wa.displayName="Label";var hN=function(t){var r=t.cx,n=t.cy,a=t.angle,i=t.startAngle,o=t.endAngle,s=t.r,l=t.radius,u=t.innerRadius,d=t.outerRadius,f=t.x,h=t.y,g=t.top,b=t.left,w=t.width,v=t.height,x=t.clockWise,m=t.labelViewBox;if(m)return m;if(Fe(w)&&Fe(v)){if(Fe(f)&&Fe(h))return{x:f,y:h,width:w,height:v};if(Fe(g)&&Fe(b))return{x:g,y:b,width:w,height:v}}return Fe(f)&&Fe(h)?{x:f,y:h,width:0,height:0}:Fe(r)&&Fe(n)?{cx:r,cy:n,startAngle:i||a||0,endAngle:o||a||0,innerRadius:u||0,outerRadius:d||l||s||0,clockWise:x}:t.viewBox?t.viewBox:{}},Nq=function(t,r){return t?t===!0?oe.createElement(wa,{key:"label-implicit",viewBox:r}):aa(t)?oe.createElement(wa,{key:"label-implicit",viewBox:r,value:t}):_.isValidElement(t)?t.type===wa?_.cloneElement(t,{key:"label-implicit",viewBox:r}):oe.createElement(wa,{key:"label-implicit",content:t,viewBox:r}):tr(t)?oe.createElement(wa,{key:"label-implicit",content:t,viewBox:r}):Ku(t)?oe.createElement(wa,Xf({viewBox:r},t,{key:"label-implicit"})):null:null},Oq=function(t,r){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;if(!t||!t.children&&n&&!t.label)return null;var a=t.children,i=hN(t),o=li(a,wa).map(function(l,u){return _.cloneElement(l,{viewBox:r||i,key:"label-".concat(u)})});if(!n)return o;var s=Nq(t.label,r||i);return[s].concat(hq(o))};wa.parseViewBox=hN;wa.renderCallByParent=Oq;function Aq(e){var t=e==null?0:e.length;return t?e[t-1]:void 0}var Tq=Aq;const Eq=on(Tq);function Kf(e){"@babel/helpers - typeof";return Kf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Kf(e)}var Iq=["valueAccessor"],$q=["data","dataKey","clockWise","id","textBreakAll"];function Dq(e){return Fq(e)||Lq(e)||Bq(e)||Rq()}function Rq(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Bq(e,t){if(e){if(typeof e=="string")return n1(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return n1(e,t)}}function Lq(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function Fq(e){if(Array.isArray(e))return n1(e)}function n1(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Zp(){return Zp=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Zp.apply(this,arguments)}function w5(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function k5(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?w5(Object(r),!0).forEach(function(n){Gq(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):w5(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Gq(e,t,r){return t=Uq(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Uq(e){var t=zq(e,"string");return Kf(t)=="symbol"?t:t+""}function zq(e,t){if(Kf(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(Kf(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function S5(e,t){if(e==null)return{};var r=Wq(e,t),n,a;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function Wq(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}var Hq=function(t){return Array.isArray(t.value)?Eq(t.value):t.value};function Io(e){var t=e.valueAccessor,r=t===void 0?Hq:t,n=S5(e,Iq),a=n.data,i=n.dataKey,o=n.clockWise,s=n.id,l=n.textBreakAll,u=S5(n,$q);return!a||!a.length?null:oe.createElement(Wr,{className:"recharts-label-list"},a.map(function(d,f){var h=Zt(i)?r(d,f):ia(d&&d.payload,i),g=Zt(s)?{}:{id:"".concat(s,"-").concat(f)};return oe.createElement(wa,Zp({},er(d,!0),u,g,{parentViewBox:d.parentViewBox,value:h,textBreakAll:l,viewBox:wa.parseViewBox(Zt(o)?d:k5(k5({},d),{},{clockWise:o})),key:"label-".concat(f),index:f}))}))}Io.displayName="LabelList";function Vq(e,t){return e?e===!0?oe.createElement(Io,{key:"labelList-implicit",data:t}):oe.isValidElement(e)||tr(e)?oe.createElement(Io,{key:"labelList-implicit",data:t,content:e}):Ku(e)?oe.createElement(Io,Zp({data:t},e,{key:"labelList-implicit"})):null:null}function Xq(e,t){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;if(!e||!e.children&&r&&!e.label)return null;var n=e.children,a=li(n,Io).map(function(o,s){return _.cloneElement(o,{data:t,key:"labelList-".concat(s)})});if(!r)return a;var i=Vq(e.label,t);return[i].concat(Dq(a))}Io.renderCallByParent=Xq;function Yf(e){"@babel/helpers - typeof";return Yf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Yf(e)}function a1(){return a1=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},a1.apply(this,arguments)}function j5(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function P5(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?j5(Object(r),!0).forEach(function(n){Kq(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):j5(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Kq(e,t,r){return t=Yq(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Yq(e){var t=qq(e,"string");return Yf(t)=="symbol"?t:t+""}function qq(e,t){if(Yf(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(Yf(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Zq=function(t,r){var n=oo(r-t),a=Math.min(Math.abs(r-t),359.999);return n*a},vh=function(t){var r=t.cx,n=t.cy,a=t.radius,i=t.angle,o=t.sign,s=t.isExternal,l=t.cornerRadius,u=t.cornerIsExternal,d=l*(s?1:-1)+a,f=Math.asin(l/d)/qp,h=u?i:i+o*f,g=ka(r,n,d,h),b=ka(r,n,a,h),w=u?i-o*f:i,v=ka(r,n,d*Math.cos(f*qp),w);return{center:g,circleTangency:b,lineTangency:v,theta:f}},pN=function(t){var r=t.cx,n=t.cy,a=t.innerRadius,i=t.outerRadius,o=t.startAngle,s=t.endAngle,l=Zq(o,s),u=o+l,d=ka(r,n,i,o),f=ka(r,n,i,u),h="M ".concat(d.x,",").concat(d.y,`
    A `).concat(i,",").concat(i,`,0,
    `).concat(+(Math.abs(l)>180),",").concat(+(o>u),`,
    `).concat(f.x,",").concat(f.y,`
  `);if(a>0){var g=ka(r,n,a,o),b=ka(r,n,a,u);h+="L ".concat(b.x,",").concat(b.y,`
            A `).concat(a,",").concat(a,`,0,
            `).concat(+(Math.abs(l)>180),",").concat(+(o<=u),`,
            `).concat(g.x,",").concat(g.y," Z")}else h+="L ".concat(r,",").concat(n," Z");return h},Jq=function(t){var r=t.cx,n=t.cy,a=t.innerRadius,i=t.outerRadius,o=t.cornerRadius,s=t.forceCornerRadius,l=t.cornerIsExternal,u=t.startAngle,d=t.endAngle,f=oo(d-u),h=vh({cx:r,cy:n,radius:i,angle:u,sign:f,cornerRadius:o,cornerIsExternal:l}),g=h.circleTangency,b=h.lineTangency,w=h.theta,v=vh({cx:r,cy:n,radius:i,angle:d,sign:-f,cornerRadius:o,cornerIsExternal:l}),x=v.circleTangency,m=v.lineTangency,k=v.theta,P=l?Math.abs(u-d):Math.abs(u-d)-w-k;if(P<0)return s?"M ".concat(b.x,",").concat(b.y,`
        a`).concat(o,",").concat(o,",0,0,1,").concat(o*2,`,0
        a`).concat(o,",").concat(o,",0,0,1,").concat(-o*2,`,0
      `):pN({cx:r,cy:n,innerRadius:a,outerRadius:i,startAngle:u,endAngle:d});var j="M ".concat(b.x,",").concat(b.y,`
    A`).concat(o,",").concat(o,",0,0,").concat(+(f<0),",").concat(g.x,",").concat(g.y,`
    A`).concat(i,",").concat(i,",0,").concat(+(P>180),",").concat(+(f<0),",").concat(x.x,",").concat(x.y,`
    A`).concat(o,",").concat(o,",0,0,").concat(+(f<0),",").concat(m.x,",").concat(m.y,`
  `);if(a>0){var S=vh({cx:r,cy:n,radius:a,angle:u,sign:f,isExternal:!0,cornerRadius:o,cornerIsExternal:l}),M=S.circleTangency,O=S.lineTangency,E=S.theta,I=vh({cx:r,cy:n,radius:a,angle:d,sign:-f,isExternal:!0,cornerRadius:o,cornerIsExternal:l}),D=I.circleTangency,B=I.lineTangency,z=I.theta,Y=l?Math.abs(u-d):Math.abs(u-d)-E-z;if(Y<0&&o===0)return"".concat(j,"L").concat(r,",").concat(n,"Z");j+="L".concat(B.x,",").concat(B.y,`
      A`).concat(o,",").concat(o,",0,0,").concat(+(f<0),",").concat(D.x,",").concat(D.y,`
      A`).concat(a,",").concat(a,",0,").concat(+(Y>180),",").concat(+(f>0),",").concat(M.x,",").concat(M.y,`
      A`).concat(o,",").concat(o,",0,0,").concat(+(f<0),",").concat(O.x,",").concat(O.y,"Z")}else j+="L".concat(r,",").concat(n,"Z");return j},Qq={cx:0,cy:0,innerRadius:0,outerRadius:0,startAngle:0,endAngle:0,cornerRadius:0,forceCornerRadius:!1,cornerIsExternal:!1},gN=function(t){var r=P5(P5({},Qq),t),n=r.cx,a=r.cy,i=r.innerRadius,o=r.outerRadius,s=r.cornerRadius,l=r.forceCornerRadius,u=r.cornerIsExternal,d=r.startAngle,f=r.endAngle,h=r.className;if(o<i||d===f)return null;var g=kr("recharts-sector",h),b=o-i,w=cc(s,b,0,!0),v;return w>0&&Math.abs(d-f)<360?v=Jq({cx:n,cy:a,innerRadius:i,outerRadius:o,cornerRadius:Math.min(w,b/2),forceCornerRadius:l,cornerIsExternal:u,startAngle:d,endAngle:f}):v=pN({cx:n,cy:a,innerRadius:i,outerRadius:o,startAngle:d,endAngle:f}),oe.createElement("path",a1({},er(r,!0),{className:g,d:v,role:"img"}))};function qf(e){"@babel/helpers - typeof";return qf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},qf(e)}function i1(){return i1=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},i1.apply(this,arguments)}function _5(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function C5(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?_5(Object(r),!0).forEach(function(n){eZ(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):_5(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function eZ(e,t,r){return t=tZ(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function tZ(e){var t=rZ(e,"string");return qf(t)=="symbol"?t:t+""}function rZ(e,t){if(qf(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(qf(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var M5={curveBasisClosed:e7,curveBasisOpen:t7,curveBasis:QR,curveBumpX:LR,curveBumpY:FR,curveLinearClosed:r7,curveLinear:cm,curveMonotoneX:n7,curveMonotoneY:a7,curveNatural:i7,curveStep:o7,curveStepAfter:l7,curveStepBefore:s7},bh=function(t){return t.x===+t.x&&t.y===+t.y},Id=function(t){return t.x},$d=function(t){return t.y},nZ=function(t,r){if(tr(t))return t;var n="curve".concat(sm(t));return(n==="curveMonotone"||n==="curveBump")&&r?M5["".concat(n).concat(r==="vertical"?"Y":"X")]:M5[n]||cm},aZ=function(t){var r=t.type,n=r===void 0?"linear":r,a=t.points,i=a===void 0?[]:a,o=t.baseLine,s=t.layout,l=t.connectNulls,u=l===void 0?!1:l,d=nZ(n,s),f=u?i.filter(function(w){return bh(w)}):i,h;if(Array.isArray(o)){var g=u?o.filter(function(w){return bh(w)}):o,b=f.map(function(w,v){return C5(C5({},w),{},{base:g[v]})});return s==="vertical"?h=uh().y($d).x1(Id).x0(function(w){return w.base.x}):h=uh().x(Id).y1($d).y0(function(w){return w.base.y}),h.defined(bh).curve(d),h(b)}return s==="vertical"&&Fe(o)?h=uh().y($d).x1(Id).x0(o):Fe(o)?h=uh().x(Id).y1($d).y0(o):h=yC().x(Id).y($d),h.defined(bh).curve(d),h(f)},Kl=function(t){var r=t.className,n=t.points,a=t.path,i=t.pathRef;if((!n||!n.length)&&!a)return null;var o=n&&n.length?aZ(t):a;return _.createElement("path",i1({},er(t,!1),bp(t),{className:kr("recharts-curve",r),d:o,ref:i}))},mN={exports:{}},iZ="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED",oZ=iZ,sZ=oZ;function yN(){}function xN(){}xN.resetWarningCache=yN;var lZ=function(){function e(n,a,i,o,s,l){if(l!==sZ){var u=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw u.name="Invariant Violation",u}}e.isRequired=e;function t(){return e}var r={array:e,bigint:e,bool:e,func:e,number:e,object:e,string:e,symbol:e,any:e,arrayOf:t,element:e,elementType:e,instanceOf:t,node:e,objectOf:t,oneOf:t,oneOfType:t,shape:t,exact:t,checkPropTypes:xN,resetWarningCache:yN};return r.PropTypes=r,r};mN.exports=lZ();var cZ=mN.exports;const Vr=on(cZ),{getOwnPropertyNames:uZ,getOwnPropertySymbols:dZ}=Object,{hasOwnProperty:fZ}=Object.prototype;function Qy(e,t){return function(n,a,i){return e(n,a,i)&&t(n,a,i)}}function wh(e){return function(r,n,a){if(!r||!n||typeof r!="object"||typeof n!="object")return e(r,n,a);const{cache:i}=a,o=i.get(r),s=i.get(n);if(o&&s)return o===n&&s===r;i.set(r,n),i.set(n,r);const l=e(r,n,a);return i.delete(r),i.delete(n),l}}function hZ(e){return e!=null?e[Symbol.toStringTag]:void 0}function N5(e){return uZ(e).concat(dZ(e))}const pZ=Object.hasOwn||((e,t)=>fZ.call(e,t));function wc(e,t){return e===t||!e&&!t&&e!==e&&t!==t}const gZ="__v",mZ="__o",yZ="_owner",{getOwnPropertyDescriptor:O5,keys:A5}=Object;function xZ(e,t){return e.byteLength===t.byteLength&&Jp(new Uint8Array(e),new Uint8Array(t))}function vZ(e,t,r){let n=e.length;if(t.length!==n)return!1;for(;n-- >0;)if(!r.equals(e[n],t[n],n,n,e,t,r))return!1;return!0}function bZ(e,t){return e.byteLength===t.byteLength&&Jp(new Uint8Array(e.buffer,e.byteOffset,e.byteLength),new Uint8Array(t.buffer,t.byteOffset,t.byteLength))}function wZ(e,t){return wc(e.getTime(),t.getTime())}function kZ(e,t){return e.name===t.name&&e.message===t.message&&e.cause===t.cause&&e.stack===t.stack}function SZ(e,t){return e===t}function T5(e,t,r){const n=e.size;if(n!==t.size)return!1;if(!n)return!0;const a=new Array(n),i=e.entries();let o,s,l=0;for(;(o=i.next())&&!o.done;){const u=t.entries();let d=!1,f=0;for(;(s=u.next())&&!s.done;){if(a[f]){f++;continue}const h=o.value,g=s.value;if(r.equals(h[0],g[0],l,f,e,t,r)&&r.equals(h[1],g[1],h[0],g[0],e,t,r)){d=a[f]=!0;break}f++}if(!d)return!1;l++}return!0}const jZ=wc;function PZ(e,t,r){const n=A5(e);let a=n.length;if(A5(t).length!==a)return!1;for(;a-- >0;)if(!vN(e,t,r,n[a]))return!1;return!0}function Dd(e,t,r){const n=N5(e);let a=n.length;if(N5(t).length!==a)return!1;let i,o,s;for(;a-- >0;)if(i=n[a],!vN(e,t,r,i)||(o=O5(e,i),s=O5(t,i),(o||s)&&(!o||!s||o.configurable!==s.configurable||o.enumerable!==s.enumerable||o.writable!==s.writable)))return!1;return!0}function _Z(e,t){return wc(e.valueOf(),t.valueOf())}function CZ(e,t){return e.source===t.source&&e.flags===t.flags}function E5(e,t,r){const n=e.size;if(n!==t.size)return!1;if(!n)return!0;const a=new Array(n),i=e.values();let o,s;for(;(o=i.next())&&!o.done;){const l=t.values();let u=!1,d=0;for(;(s=l.next())&&!s.done;){if(!a[d]&&r.equals(o.value,s.value,o.value,s.value,e,t,r)){u=a[d]=!0;break}d++}if(!u)return!1}return!0}function Jp(e,t){let r=e.byteLength;if(t.byteLength!==r||e.byteOffset!==t.byteOffset)return!1;for(;r-- >0;)if(e[r]!==t[r])return!1;return!0}function MZ(e,t){return e.hostname===t.hostname&&e.pathname===t.pathname&&e.protocol===t.protocol&&e.port===t.port&&e.hash===t.hash&&e.username===t.username&&e.password===t.password}function vN(e,t,r,n){return(n===yZ||n===mZ||n===gZ)&&(e.$$typeof||t.$$typeof)?!0:pZ(t,n)&&r.equals(e[n],t[n],n,n,e,t,r)}const NZ="[object ArrayBuffer]",OZ="[object Arguments]",AZ="[object Boolean]",TZ="[object DataView]",EZ="[object Date]",IZ="[object Error]",$Z="[object Map]",DZ="[object Number]",RZ="[object Object]",BZ="[object RegExp]",LZ="[object Set]",FZ="[object String]",GZ={"[object Int8Array]":!0,"[object Uint8Array]":!0,"[object Uint8ClampedArray]":!0,"[object Int16Array]":!0,"[object Uint16Array]":!0,"[object Int32Array]":!0,"[object Uint32Array]":!0,"[object Float16Array]":!0,"[object Float32Array]":!0,"[object Float64Array]":!0,"[object BigInt64Array]":!0,"[object BigUint64Array]":!0},UZ="[object URL]",zZ=Object.prototype.toString;function WZ({areArrayBuffersEqual:e,areArraysEqual:t,areDataViewsEqual:r,areDatesEqual:n,areErrorsEqual:a,areFunctionsEqual:i,areMapsEqual:o,areNumbersEqual:s,areObjectsEqual:l,arePrimitiveWrappersEqual:u,areRegExpsEqual:d,areSetsEqual:f,areTypedArraysEqual:h,areUrlsEqual:g,unknownTagComparators:b}){return function(v,x,m){if(v===x)return!0;if(v==null||x==null)return!1;const k=typeof v;if(k!==typeof x)return!1;if(k!=="object")return k==="number"?s(v,x,m):k==="function"?i(v,x,m):!1;const P=v.constructor;if(P!==x.constructor)return!1;if(P===Object)return l(v,x,m);if(Array.isArray(v))return t(v,x,m);if(P===Date)return n(v,x,m);if(P===RegExp)return d(v,x,m);if(P===Map)return o(v,x,m);if(P===Set)return f(v,x,m);const j=zZ.call(v);if(j===EZ)return n(v,x,m);if(j===BZ)return d(v,x,m);if(j===$Z)return o(v,x,m);if(j===LZ)return f(v,x,m);if(j===RZ)return typeof v.then!="function"&&typeof x.then!="function"&&l(v,x,m);if(j===UZ)return g(v,x,m);if(j===IZ)return a(v,x,m);if(j===OZ)return l(v,x,m);if(GZ[j])return h(v,x,m);if(j===NZ)return e(v,x,m);if(j===TZ)return r(v,x,m);if(j===AZ||j===DZ||j===FZ)return u(v,x,m);if(b){let S=b[j];if(!S){const M=hZ(v);M&&(S=b[M])}if(S)return S(v,x,m)}return!1}}function HZ({circular:e,createCustomConfig:t,strict:r}){let n={areArrayBuffersEqual:xZ,areArraysEqual:r?Dd:vZ,areDataViewsEqual:bZ,areDatesEqual:wZ,areErrorsEqual:kZ,areFunctionsEqual:SZ,areMapsEqual:r?Qy(T5,Dd):T5,areNumbersEqual:jZ,areObjectsEqual:r?Dd:PZ,arePrimitiveWrappersEqual:_Z,areRegExpsEqual:CZ,areSetsEqual:r?Qy(E5,Dd):E5,areTypedArraysEqual:r?Qy(Jp,Dd):Jp,areUrlsEqual:MZ,unknownTagComparators:void 0};if(t&&(n=Object.assign({},n,t(n))),e){const a=wh(n.areArraysEqual),i=wh(n.areMapsEqual),o=wh(n.areObjectsEqual),s=wh(n.areSetsEqual);n=Object.assign({},n,{areArraysEqual:a,areMapsEqual:i,areObjectsEqual:o,areSetsEqual:s})}return n}function VZ(e){return function(t,r,n,a,i,o,s){return e(t,r,s)}}function XZ({circular:e,comparator:t,createState:r,equals:n,strict:a}){if(r)return function(s,l){const{cache:u=e?new WeakMap:void 0,meta:d}=r();return t(s,l,{cache:u,equals:n,meta:d,strict:a})};if(e)return function(s,l){return t(s,l,{cache:new WeakMap,equals:n,meta:void 0,strict:a})};const i={cache:void 0,equals:n,meta:void 0,strict:a};return function(s,l){return t(s,l,i)}}const KZ=gl();gl({strict:!0});gl({circular:!0});gl({circular:!0,strict:!0});gl({createInternalComparator:()=>wc});gl({strict:!0,createInternalComparator:()=>wc});gl({circular:!0,createInternalComparator:()=>wc});gl({circular:!0,createInternalComparator:()=>wc,strict:!0});function gl(e={}){const{circular:t=!1,createInternalComparator:r,createState:n,strict:a=!1}=e,i=HZ(e),o=WZ(i),s=r?r(o):VZ(o);return XZ({circular:t,comparator:o,createState:n,equals:s,strict:a})}function YZ(e){typeof requestAnimationFrame<"u"&&requestAnimationFrame(e)}function I5(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,r=-1,n=function a(i){r<0&&(r=i),i-r>t?(e(i),r=-1):YZ(a)};requestAnimationFrame(n)}function o1(e){"@babel/helpers - typeof";return o1=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},o1(e)}function qZ(e){return eJ(e)||QZ(e)||JZ(e)||ZZ()}function ZZ(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function JZ(e,t){if(e){if(typeof e=="string")return $5(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return $5(e,t)}}function $5(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function QZ(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function eJ(e){if(Array.isArray(e))return e}function tJ(){var e={},t=function(){return null},r=!1,n=function a(i){if(!r){if(Array.isArray(i)){if(!i.length)return;var o=i,s=qZ(o),l=s[0],u=s.slice(1);if(typeof l=="number"){I5(a.bind(null,u),l);return}a(l),I5(a.bind(null,u));return}o1(i)==="object"&&(e=i,t(e)),typeof i=="function"&&i()}};return{stop:function(){r=!0},start:function(i){r=!1,n(i)},subscribe:function(i){return t=i,function(){t=function(){return null}}}}}function Zf(e){"@babel/helpers - typeof";return Zf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Zf(e)}function D5(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function R5(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?D5(Object(r),!0).forEach(function(n){bN(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):D5(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function bN(e,t,r){return t=rJ(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function rJ(e){var t=nJ(e,"string");return Zf(t)==="symbol"?t:String(t)}function nJ(e,t){if(Zf(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(Zf(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var aJ=function(t,r){return[Object.keys(t),Object.keys(r)].reduce(function(n,a){return n.filter(function(i){return a.includes(i)})})},iJ=function(t){return t},oJ=function(t){return t.replace(/([A-Z])/g,function(r){return"-".concat(r.toLowerCase())})},af=function(t,r){return Object.keys(r).reduce(function(n,a){return R5(R5({},n),{},bN({},a,t(a,r[a])))},{})},B5=function(t,r,n){return t.map(function(a){return"".concat(oJ(a)," ").concat(r,"ms ").concat(n)}).join(",")};function sJ(e,t){return uJ(e)||cJ(e,t)||wN(e,t)||lJ()}function lJ(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function cJ(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,a,i,o,s=[],l=!0,u=!1;try{if(i=(r=r.call(e)).next,t!==0)for(;!(l=(n=i.call(r)).done)&&(s.push(n.value),s.length!==t);l=!0);}catch(d){u=!0,a=d}finally{try{if(!l&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(u)throw a}}return s}}function uJ(e){if(Array.isArray(e))return e}function dJ(e){return pJ(e)||hJ(e)||wN(e)||fJ()}function fJ(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function wN(e,t){if(e){if(typeof e=="string")return s1(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return s1(e,t)}}function hJ(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function pJ(e){if(Array.isArray(e))return s1(e)}function s1(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var Qp=1e-4,kN=function(t,r){return[0,3*t,3*r-6*t,3*t-3*r+1]},SN=function(t,r){return t.map(function(n,a){return n*Math.pow(r,a)}).reduce(function(n,a){return n+a})},L5=function(t,r){return function(n){var a=kN(t,r);return SN(a,n)}},gJ=function(t,r){return function(n){var a=kN(t,r),i=[].concat(dJ(a.map(function(o,s){return o*s}).slice(1)),[0]);return SN(i,n)}},F5=function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];var a=r[0],i=r[1],o=r[2],s=r[3];if(r.length===1)switch(r[0]){case"linear":a=0,i=0,o=1,s=1;break;case"ease":a=.25,i=.1,o=.25,s=1;break;case"ease-in":a=.42,i=0,o=1,s=1;break;case"ease-out":a=.42,i=0,o=.58,s=1;break;case"ease-in-out":a=0,i=0,o=.58,s=1;break;default:{var l=r[0].split("(");if(l[0]==="cubic-bezier"&&l[1].split(")")[0].split(",").length===4){var u=l[1].split(")")[0].split(",").map(function(v){return parseFloat(v)}),d=sJ(u,4);a=d[0],i=d[1],o=d[2],s=d[3]}}}var f=L5(a,o),h=L5(i,s),g=gJ(a,o),b=function(x){return x>1?1:x<0?0:x},w=function(x){for(var m=x>1?1:x,k=m,P=0;P<8;++P){var j=f(k)-m,S=g(k);if(Math.abs(j-m)<Qp||S<Qp)return h(k);k=b(k-j/S)}return h(k)};return w.isStepper=!1,w},mJ=function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},r=t.stiff,n=r===void 0?100:r,a=t.damping,i=a===void 0?8:a,o=t.dt,s=o===void 0?17:o,l=function(d,f,h){var g=-(d-f)*n,b=h*i,w=h+(g-b)*s/1e3,v=h*s/1e3+d;return Math.abs(v-f)<Qp&&Math.abs(w)<Qp?[f,0]:[v,w]};return l.isStepper=!0,l.dt=s,l},yJ=function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];var a=r[0];if(typeof a=="string")switch(a){case"ease":case"ease-in-out":case"ease-out":case"ease-in":case"linear":return F5(a);case"spring":return mJ();default:if(a.split("(")[0]==="cubic-bezier")return F5(a)}return typeof a=="function"?a:null};function Jf(e){"@babel/helpers - typeof";return Jf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Jf(e)}function G5(e){return bJ(e)||vJ(e)||jN(e)||xJ()}function xJ(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function vJ(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function bJ(e){if(Array.isArray(e))return c1(e)}function U5(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function va(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?U5(Object(r),!0).forEach(function(n){l1(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):U5(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function l1(e,t,r){return t=wJ(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function wJ(e){var t=kJ(e,"string");return Jf(t)==="symbol"?t:String(t)}function kJ(e,t){if(Jf(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(Jf(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function SJ(e,t){return _J(e)||PJ(e,t)||jN(e,t)||jJ()}function jJ(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function jN(e,t){if(e){if(typeof e=="string")return c1(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return c1(e,t)}}function c1(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function PJ(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,a,i,o,s=[],l=!0,u=!1;try{if(i=(r=r.call(e)).next,t!==0)for(;!(l=(n=i.call(r)).done)&&(s.push(n.value),s.length!==t);l=!0);}catch(d){u=!0,a=d}finally{try{if(!l&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(u)throw a}}return s}}function _J(e){if(Array.isArray(e))return e}var eg=function(t,r,n){return t+(r-t)*n},u1=function(t){var r=t.from,n=t.to;return r!==n},CJ=function e(t,r,n){var a=af(function(i,o){if(u1(o)){var s=t(o.from,o.to,o.velocity),l=SJ(s,2),u=l[0],d=l[1];return va(va({},o),{},{from:u,velocity:d})}return o},r);return n<1?af(function(i,o){return u1(o)?va(va({},o),{},{velocity:eg(o.velocity,a[i].velocity,n),from:eg(o.from,a[i].from,n)}):o},r):e(t,a,n-1)};const MJ=function(e,t,r,n,a){var i=aJ(e,t),o=i.reduce(function(v,x){return va(va({},v),{},l1({},x,[e[x],t[x]]))},{}),s=i.reduce(function(v,x){return va(va({},v),{},l1({},x,{from:e[x],velocity:0,to:t[x]}))},{}),l=-1,u,d,f=function(){return null},h=function(){return af(function(x,m){return m.from},s)},g=function(){return!Object.values(s).filter(u1).length},b=function(x){u||(u=x);var m=x-u,k=m/r.dt;s=CJ(r,s,k),a(va(va(va({},e),t),h())),u=x,g()||(l=requestAnimationFrame(f))},w=function(x){d||(d=x);var m=(x-d)/n,k=af(function(j,S){return eg.apply(void 0,G5(S).concat([r(m)]))},o);if(a(va(va(va({},e),t),k)),m<1)l=requestAnimationFrame(f);else{var P=af(function(j,S){return eg.apply(void 0,G5(S).concat([r(1)]))},o);a(va(va(va({},e),t),P))}};return f=r.isStepper?b:w,function(){return requestAnimationFrame(f),function(){cancelAnimationFrame(l)}}};function Pu(e){"@babel/helpers - typeof";return Pu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Pu(e)}var NJ=["children","begin","duration","attributeName","easing","isActive","steps","from","to","canBegin","onAnimationEnd","shouldReAnimate","onAnimationReStart"];function OJ(e,t){if(e==null)return{};var r=AJ(e,t),n,a;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function AJ(e,t){if(e==null)return{};var r={},n=Object.keys(e),a,i;for(i=0;i<n.length;i++)a=n[i],!(t.indexOf(a)>=0)&&(r[a]=e[a]);return r}function ex(e){return $J(e)||IJ(e)||EJ(e)||TJ()}function TJ(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function EJ(e,t){if(e){if(typeof e=="string")return d1(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return d1(e,t)}}function IJ(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function $J(e){if(Array.isArray(e))return d1(e)}function d1(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function z5(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Zi(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?z5(Object(r),!0).forEach(function(n){zd(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):z5(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function zd(e,t,r){return t=PN(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function DJ(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function RJ(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,PN(n.key),n)}}function BJ(e,t,r){return t&&RJ(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function PN(e){var t=LJ(e,"string");return Pu(t)==="symbol"?t:String(t)}function LJ(e,t){if(Pu(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(Pu(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function FJ(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&f1(e,t)}function f1(e,t){return f1=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},f1(e,t)}function GJ(e){var t=UJ();return function(){var n=tg(e),a;if(t){var i=tg(this).constructor;a=Reflect.construct(n,arguments,i)}else a=n.apply(this,arguments);return h1(this,a)}}function h1(e,t){if(t&&(Pu(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return p1(e)}function p1(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function UJ(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function tg(e){return tg=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},tg(e)}var fo=function(e){FJ(r,e);var t=GJ(r);function r(n,a){var i;DJ(this,r),i=t.call(this,n,a);var o=i.props,s=o.isActive,l=o.attributeName,u=o.from,d=o.to,f=o.steps,h=o.children,g=o.duration;if(i.handleStyleChange=i.handleStyleChange.bind(p1(i)),i.changeStyle=i.changeStyle.bind(p1(i)),!s||g<=0)return i.state={style:{}},typeof h=="function"&&(i.state={style:d}),h1(i);if(f&&f.length)i.state={style:f[0].style};else if(u){if(typeof h=="function")return i.state={style:u},h1(i);i.state={style:l?zd({},l,u):u}}else i.state={style:{}};return i}return BJ(r,[{key:"componentDidMount",value:function(){var a=this.props,i=a.isActive,o=a.canBegin;this.mounted=!0,!(!i||!o)&&this.runAnimation(this.props)}},{key:"componentDidUpdate",value:function(a){var i=this.props,o=i.isActive,s=i.canBegin,l=i.attributeName,u=i.shouldReAnimate,d=i.to,f=i.from,h=this.state.style;if(s){if(!o){var g={style:l?zd({},l,d):d};this.state&&h&&(l&&h[l]!==d||!l&&h!==d)&&this.setState(g);return}if(!(KZ(a.to,d)&&a.canBegin&&a.isActive)){var b=!a.canBegin||!a.isActive;this.manager&&this.manager.stop(),this.stopJSAnimation&&this.stopJSAnimation();var w=b||u?f:a.to;if(this.state&&h){var v={style:l?zd({},l,w):w};(l&&h[l]!==w||!l&&h!==w)&&this.setState(v)}this.runAnimation(Zi(Zi({},this.props),{},{from:w,begin:0}))}}}},{key:"componentWillUnmount",value:function(){this.mounted=!1;var a=this.props.onAnimationEnd;this.unSubscribe&&this.unSubscribe(),this.manager&&(this.manager.stop(),this.manager=null),this.stopJSAnimation&&this.stopJSAnimation(),a&&a()}},{key:"handleStyleChange",value:function(a){this.changeStyle(a)}},{key:"changeStyle",value:function(a){this.mounted&&this.setState({style:a})}},{key:"runJSAnimation",value:function(a){var i=this,o=a.from,s=a.to,l=a.duration,u=a.easing,d=a.begin,f=a.onAnimationEnd,h=a.onAnimationStart,g=MJ(o,s,yJ(u),l,this.changeStyle),b=function(){i.stopJSAnimation=g()};this.manager.start([h,d,b,l,f])}},{key:"runStepAnimation",value:function(a){var i=this,o=a.steps,s=a.begin,l=a.onAnimationStart,u=o[0],d=u.style,f=u.duration,h=f===void 0?0:f,g=function(w,v,x){if(x===0)return w;var m=v.duration,k=v.easing,P=k===void 0?"ease":k,j=v.style,S=v.properties,M=v.onAnimationEnd,O=x>0?o[x-1]:v,E=S||Object.keys(j);if(typeof P=="function"||P==="spring")return[].concat(ex(w),[i.runJSAnimation.bind(i,{from:O.style,to:j,duration:m,easing:P}),m]);var I=B5(E,m,P),D=Zi(Zi(Zi({},O.style),j),{},{transition:I});return[].concat(ex(w),[D,m,M]).filter(iJ)};return this.manager.start([l].concat(ex(o.reduce(g,[d,Math.max(h,s)])),[a.onAnimationEnd]))}},{key:"runAnimation",value:function(a){this.manager||(this.manager=tJ());var i=a.begin,o=a.duration,s=a.attributeName,l=a.to,u=a.easing,d=a.onAnimationStart,f=a.onAnimationEnd,h=a.steps,g=a.children,b=this.manager;if(this.unSubscribe=b.subscribe(this.handleStyleChange),typeof u=="function"||typeof g=="function"||u==="spring"){this.runJSAnimation(a);return}if(h.length>1){this.runStepAnimation(a);return}var w=s?zd({},s,l):l,v=B5(Object.keys(w),o,u);b.start([d,i,Zi(Zi({},w),{},{transition:v}),o,f])}},{key:"render",value:function(){var a=this.props,i=a.children;a.begin;var o=a.duration;a.attributeName,a.easing;var s=a.isActive;a.steps,a.from,a.to,a.canBegin,a.onAnimationEnd,a.shouldReAnimate,a.onAnimationReStart;var l=OJ(a,NJ),u=_.Children.count(i),d=this.state.style;if(typeof i=="function")return i(d);if(!s||u===0||o<=0)return i;var f=function(g){var b=g.props,w=b.style,v=w===void 0?{}:w,x=b.className,m=_.cloneElement(g,Zi(Zi({},l),{},{style:Zi(Zi({},v),d),className:x}));return m};return u===1?f(_.Children.only(i)):oe.createElement("div",null,_.Children.map(i,function(h){return f(h)}))}}]),r}(_.PureComponent);fo.displayName="Animate";fo.defaultProps={begin:0,duration:1e3,from:"",to:"",attributeName:"",easing:"ease",isActive:!0,canBegin:!0,steps:[],onAnimationEnd:function(){},onAnimationStart:function(){}};fo.propTypes={from:Vr.oneOfType([Vr.object,Vr.string]),to:Vr.oneOfType([Vr.object,Vr.string]),attributeName:Vr.string,duration:Vr.number,begin:Vr.number,easing:Vr.oneOfType([Vr.string,Vr.func]),steps:Vr.arrayOf(Vr.shape({duration:Vr.number.isRequired,style:Vr.object.isRequired,easing:Vr.oneOfType([Vr.oneOf(["ease","ease-in","ease-out","ease-in-out","linear"]),Vr.func]),properties:Vr.arrayOf("string"),onAnimationEnd:Vr.func})),children:Vr.oneOfType([Vr.node,Vr.func]),isActive:Vr.bool,canBegin:Vr.bool,onAnimationEnd:Vr.func,shouldReAnimate:Vr.bool,onAnimationStart:Vr.func,onAnimationReStart:Vr.func};function Qf(e){"@babel/helpers - typeof";return Qf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Qf(e)}function rg(){return rg=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},rg.apply(this,arguments)}function zJ(e,t){return XJ(e)||VJ(e,t)||HJ(e,t)||WJ()}function WJ(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function HJ(e,t){if(e){if(typeof e=="string")return W5(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return W5(e,t)}}function W5(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function VJ(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,a,i,o,s=[],l=!0,u=!1;try{if(i=(r=r.call(e)).next,t!==0)for(;!(l=(n=i.call(r)).done)&&(s.push(n.value),s.length!==t);l=!0);}catch(d){u=!0,a=d}finally{try{if(!l&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(u)throw a}}return s}}function XJ(e){if(Array.isArray(e))return e}function H5(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function V5(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?H5(Object(r),!0).forEach(function(n){KJ(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):H5(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function KJ(e,t,r){return t=YJ(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function YJ(e){var t=qJ(e,"string");return Qf(t)=="symbol"?t:t+""}function qJ(e,t){if(Qf(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(Qf(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var X5=function(t,r,n,a,i){var o=Math.min(Math.abs(n)/2,Math.abs(a)/2),s=a>=0?1:-1,l=n>=0?1:-1,u=a>=0&&n>=0||a<0&&n<0?1:0,d;if(o>0&&i instanceof Array){for(var f=[0,0,0,0],h=0,g=4;h<g;h++)f[h]=i[h]>o?o:i[h];d="M".concat(t,",").concat(r+s*f[0]),f[0]>0&&(d+="A ".concat(f[0],",").concat(f[0],",0,0,").concat(u,",").concat(t+l*f[0],",").concat(r)),d+="L ".concat(t+n-l*f[1],",").concat(r),f[1]>0&&(d+="A ".concat(f[1],",").concat(f[1],",0,0,").concat(u,`,
        `).concat(t+n,",").concat(r+s*f[1])),d+="L ".concat(t+n,",").concat(r+a-s*f[2]),f[2]>0&&(d+="A ".concat(f[2],",").concat(f[2],",0,0,").concat(u,`,
        `).concat(t+n-l*f[2],",").concat(r+a)),d+="L ".concat(t+l*f[3],",").concat(r+a),f[3]>0&&(d+="A ".concat(f[3],",").concat(f[3],",0,0,").concat(u,`,
        `).concat(t,",").concat(r+a-s*f[3])),d+="Z"}else if(o>0&&i===+i&&i>0){var b=Math.min(o,i);d="M ".concat(t,",").concat(r+s*b,`
            A `).concat(b,",").concat(b,",0,0,").concat(u,",").concat(t+l*b,",").concat(r,`
            L `).concat(t+n-l*b,",").concat(r,`
            A `).concat(b,",").concat(b,",0,0,").concat(u,",").concat(t+n,",").concat(r+s*b,`
            L `).concat(t+n,",").concat(r+a-s*b,`
            A `).concat(b,",").concat(b,",0,0,").concat(u,",").concat(t+n-l*b,",").concat(r+a,`
            L `).concat(t+l*b,",").concat(r+a,`
            A `).concat(b,",").concat(b,",0,0,").concat(u,",").concat(t,",").concat(r+a-s*b," Z")}else d="M ".concat(t,",").concat(r," h ").concat(n," v ").concat(a," h ").concat(-n," Z");return d},ZJ=function(t,r){if(!t||!r)return!1;var n=t.x,a=t.y,i=r.x,o=r.y,s=r.width,l=r.height;if(Math.abs(s)>0&&Math.abs(l)>0){var u=Math.min(i,i+s),d=Math.max(i,i+s),f=Math.min(o,o+l),h=Math.max(o,o+l);return n>=u&&n<=d&&a>=f&&a<=h}return!1},JJ={x:0,y:0,width:0,height:0,radius:0,isAnimationActive:!1,isUpdateAnimationActive:!1,animationBegin:0,animationDuration:1500,animationEasing:"ease"},Y2=function(t){var r=V5(V5({},JJ),t),n=_.useRef(),a=_.useState(-1),i=zJ(a,2),o=i[0],s=i[1];_.useEffect(function(){if(n.current&&n.current.getTotalLength)try{var P=n.current.getTotalLength();P&&s(P)}catch{}},[]);var l=r.x,u=r.y,d=r.width,f=r.height,h=r.radius,g=r.className,b=r.animationEasing,w=r.animationDuration,v=r.animationBegin,x=r.isAnimationActive,m=r.isUpdateAnimationActive;if(l!==+l||u!==+u||d!==+d||f!==+f||d===0||f===0)return null;var k=kr("recharts-rectangle",g);return m?oe.createElement(fo,{canBegin:o>0,from:{width:d,height:f,x:l,y:u},to:{width:d,height:f,x:l,y:u},duration:w,animationEasing:b,isActive:m},function(P){var j=P.width,S=P.height,M=P.x,O=P.y;return oe.createElement(fo,{canBegin:o>0,from:"0px ".concat(o===-1?1:o,"px"),to:"".concat(o,"px 0px"),attributeName:"strokeDasharray",begin:v,duration:w,isActive:x,easing:b},oe.createElement("path",rg({},er(r,!0),{className:k,d:X5(M,O,j,S,h),ref:n})))}):oe.createElement("path",rg({},er(r,!0),{className:k,d:X5(l,u,d,f,h)}))};function g1(){return g1=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},g1.apply(this,arguments)}var jm=function(t){var r=t.cx,n=t.cy,a=t.r,i=t.className,o=kr("recharts-dot",i);return r===+r&&n===+n&&a===+a?_.createElement("circle",g1({},er(t,!1),bp(t),{className:o,cx:r,cy:n,r:a})):null};function e0(e){"@babel/helpers - typeof";return e0=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},e0(e)}var QJ=["x","y","top","left","width","height","className"];function m1(){return m1=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},m1.apply(this,arguments)}function K5(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function eQ(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?K5(Object(r),!0).forEach(function(n){tQ(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):K5(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function tQ(e,t,r){return t=rQ(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function rQ(e){var t=nQ(e,"string");return e0(t)=="symbol"?t:t+""}function nQ(e,t){if(e0(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(e0(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function aQ(e,t){if(e==null)return{};var r=iQ(e,t),n,a;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function iQ(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}var oQ=function(t,r,n,a,i,o){return"M".concat(t,",").concat(i,"v").concat(a,"M").concat(o,",").concat(r,"h").concat(n)},sQ=function(t){var r=t.x,n=r===void 0?0:r,a=t.y,i=a===void 0?0:a,o=t.top,s=o===void 0?0:o,l=t.left,u=l===void 0?0:l,d=t.width,f=d===void 0?0:d,h=t.height,g=h===void 0?0:h,b=t.className,w=aQ(t,QJ),v=eQ({x:n,y:i,top:s,left:u,width:f,height:g},w);return!Fe(n)||!Fe(i)||!Fe(f)||!Fe(g)||!Fe(s)||!Fe(u)?null:oe.createElement("path",m1({},er(v,!0),{className:kr("recharts-cross",b),d:oQ(n,i,f,g,s,u)}))},lQ=GC,cQ=lQ(Object.getPrototypeOf,Object),uQ=cQ,dQ=ms,fQ=uQ,hQ=ys,pQ="[object Object]",gQ=Function.prototype,mQ=Object.prototype,_N=gQ.toString,yQ=mQ.hasOwnProperty,xQ=_N.call(Object);function vQ(e){if(!hQ(e)||dQ(e)!=pQ)return!1;var t=fQ(e);if(t===null)return!0;var r=yQ.call(t,"constructor")&&t.constructor;return typeof r=="function"&&r instanceof r&&_N.call(r)==xQ}var bQ=vQ;const wQ=on(bQ);var kQ=ms,SQ=ys,jQ="[object Boolean]";function PQ(e){return e===!0||e===!1||SQ(e)&&kQ(e)==jQ}var _Q=PQ;const CQ=on(_Q);function t0(e){"@babel/helpers - typeof";return t0=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},t0(e)}function ng(){return ng=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},ng.apply(this,arguments)}function MQ(e,t){return TQ(e)||AQ(e,t)||OQ(e,t)||NQ()}function NQ(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function OQ(e,t){if(e){if(typeof e=="string")return Y5(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Y5(e,t)}}function Y5(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function AQ(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,a,i,o,s=[],l=!0,u=!1;try{if(i=(r=r.call(e)).next,t!==0)for(;!(l=(n=i.call(r)).done)&&(s.push(n.value),s.length!==t);l=!0);}catch(d){u=!0,a=d}finally{try{if(!l&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(u)throw a}}return s}}function TQ(e){if(Array.isArray(e))return e}function q5(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Z5(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?q5(Object(r),!0).forEach(function(n){EQ(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):q5(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function EQ(e,t,r){return t=IQ(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function IQ(e){var t=$Q(e,"string");return t0(t)=="symbol"?t:t+""}function $Q(e,t){if(t0(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(t0(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var J5=function(t,r,n,a,i){var o=n-a,s;return s="M ".concat(t,",").concat(r),s+="L ".concat(t+n,",").concat(r),s+="L ".concat(t+n-o/2,",").concat(r+i),s+="L ".concat(t+n-o/2-a,",").concat(r+i),s+="L ".concat(t,",").concat(r," Z"),s},DQ={x:0,y:0,upperWidth:0,lowerWidth:0,height:0,isUpdateAnimationActive:!1,animationBegin:0,animationDuration:1500,animationEasing:"ease"},RQ=function(t){var r=Z5(Z5({},DQ),t),n=_.useRef(),a=_.useState(-1),i=MQ(a,2),o=i[0],s=i[1];_.useEffect(function(){if(n.current&&n.current.getTotalLength)try{var k=n.current.getTotalLength();k&&s(k)}catch{}},[]);var l=r.x,u=r.y,d=r.upperWidth,f=r.lowerWidth,h=r.height,g=r.className,b=r.animationEasing,w=r.animationDuration,v=r.animationBegin,x=r.isUpdateAnimationActive;if(l!==+l||u!==+u||d!==+d||f!==+f||h!==+h||d===0&&f===0||h===0)return null;var m=kr("recharts-trapezoid",g);return x?oe.createElement(fo,{canBegin:o>0,from:{upperWidth:0,lowerWidth:0,height:h,x:l,y:u},to:{upperWidth:d,lowerWidth:f,height:h,x:l,y:u},duration:w,animationEasing:b,isActive:x},function(k){var P=k.upperWidth,j=k.lowerWidth,S=k.height,M=k.x,O=k.y;return oe.createElement(fo,{canBegin:o>0,from:"0px ".concat(o===-1?1:o,"px"),to:"".concat(o,"px 0px"),attributeName:"strokeDasharray",begin:v,duration:w,easing:b},oe.createElement("path",ng({},er(r,!0),{className:m,d:J5(M,O,P,j,S),ref:n})))}):oe.createElement("g",null,oe.createElement("path",ng({},er(r,!0),{className:m,d:J5(l,u,d,f,h)})))},BQ=["option","shapeType","propTransformer","activeClassName","isActive"];function r0(e){"@babel/helpers - typeof";return r0=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},r0(e)}function LQ(e,t){if(e==null)return{};var r=FQ(e,t),n,a;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function FQ(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function Q5(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function ag(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Q5(Object(r),!0).forEach(function(n){GQ(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Q5(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function GQ(e,t,r){return t=UQ(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function UQ(e){var t=zQ(e,"string");return r0(t)=="symbol"?t:t+""}function zQ(e,t){if(r0(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(r0(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function WQ(e,t){return ag(ag({},t),e)}function HQ(e,t){return e==="symbols"}function e4(e){var t=e.shapeType,r=e.elementProps;switch(t){case"rectangle":return oe.createElement(Y2,r);case"trapezoid":return oe.createElement(RQ,r);case"sector":return oe.createElement(gN,r);case"symbols":if(HQ(t))return oe.createElement(dm,r);break;default:return null}}function VQ(e){return _.isValidElement(e)?e.props:e}function y1(e){var t=e.option,r=e.shapeType,n=e.propTransformer,a=n===void 0?WQ:n,i=e.activeClassName,o=i===void 0?"recharts-active-shape":i,s=e.isActive,l=LQ(e,BQ),u;if(_.isValidElement(t))u=_.cloneElement(t,ag(ag({},l),VQ(t)));else if(tr(t))u=t(l);else if(wQ(t)&&!CQ(t)){var d=a(t,l);u=oe.createElement(e4,{shapeType:r,elementProps:d})}else{var f=l;u=oe.createElement(e4,{shapeType:r,elementProps:f})}return s?oe.createElement(Wr,{className:o},u):u}function Pm(e,t){return t!=null&&"trapezoids"in e.props}function _m(e,t){return t!=null&&"sectors"in e.props}function n0(e,t){return t!=null&&"points"in e.props}function XQ(e,t){var r,n,a=e.x===(t==null||(r=t.labelViewBox)===null||r===void 0?void 0:r.x)||e.x===t.x,i=e.y===(t==null||(n=t.labelViewBox)===null||n===void 0?void 0:n.y)||e.y===t.y;return a&&i}function KQ(e,t){var r=e.endAngle===t.endAngle,n=e.startAngle===t.startAngle;return r&&n}function YQ(e,t){var r=e.x===t.x,n=e.y===t.y,a=e.z===t.z;return r&&n&&a}function qQ(e,t){var r;return Pm(e,t)?r=XQ:_m(e,t)?r=KQ:n0(e,t)&&(r=YQ),r}function ZQ(e,t){var r;return Pm(e,t)?r="trapezoids":_m(e,t)?r="sectors":n0(e,t)&&(r="points"),r}function JQ(e,t){if(Pm(e,t)){var r;return(r=t.tooltipPayload)===null||r===void 0||(r=r[0])===null||r===void 0||(r=r.payload)===null||r===void 0?void 0:r.payload}if(_m(e,t)){var n;return(n=t.tooltipPayload)===null||n===void 0||(n=n[0])===null||n===void 0||(n=n.payload)===null||n===void 0?void 0:n.payload}return n0(e,t)?t.payload:{}}function QQ(e){var t=e.activeTooltipItem,r=e.graphicalItem,n=e.itemData,a=ZQ(r,t),i=JQ(r,t),o=n.filter(function(l,u){var d=uc(i,l),f=r.props[a].filter(function(b){var w=qQ(r,t);return w(b,t)}),h=r.props[a].indexOf(f[f.length-1]),g=u===h;return d&&g}),s=n.indexOf(o[o.length-1]);return s}var eee=Math.ceil,tee=Math.max;function ree(e,t,r,n){for(var a=-1,i=tee(eee((t-e)/(r||1)),0),o=Array(i);i--;)o[n?i:++a]=e,e+=r;return o}var nee=ree,aee=oM,t4=1/0,iee=17976931348623157e292;function oee(e){if(!e)return e===0?e:0;if(e=aee(e),e===t4||e===-t4){var t=e<0?-1:1;return t*iee}return e===e?e:0}var CN=oee,see=nee,lee=pm,tx=CN;function cee(e){return function(t,r,n){return n&&typeof n!="number"&&lee(t,r,n)&&(r=n=void 0),t=tx(t),r===void 0?(r=t,t=0):r=tx(r),n=n===void 0?t<r?1:-1:tx(n),see(t,r,n,e)}}var uee=cee,dee=uee,fee=dee(),hee=fee;const ig=on(hee);function a0(e){"@babel/helpers - typeof";return a0=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},a0(e)}function r4(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function n4(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?r4(Object(r),!0).forEach(function(n){MN(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):r4(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function MN(e,t,r){return t=pee(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function pee(e){var t=gee(e,"string");return a0(t)=="symbol"?t:t+""}function gee(e,t){if(a0(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(a0(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var mee=["Webkit","Moz","O","ms"],yee=function(t,r){var n=t.replace(/(\w)/,function(i){return i.toUpperCase()}),a=mee.reduce(function(i,o){return n4(n4({},i),{},MN({},o+n,r))},{});return a[t]=r,a};function _u(e){"@babel/helpers - typeof";return _u=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_u(e)}function og(){return og=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},og.apply(this,arguments)}function a4(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function rx(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?a4(Object(r),!0).forEach(function(n){gi(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):a4(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function xee(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i4(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,ON(n.key),n)}}function vee(e,t,r){return t&&i4(e.prototype,t),r&&i4(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function bee(e,t,r){return t=sg(t),wee(e,NN()?Reflect.construct(t,r||[],sg(e).constructor):t.apply(e,r))}function wee(e,t){if(t&&(_u(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return kee(e)}function kee(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function NN(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(NN=function(){return!!e})()}function sg(e){return sg=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},sg(e)}function See(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&x1(e,t)}function x1(e,t){return x1=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},x1(e,t)}function gi(e,t,r){return t=ON(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function ON(e){var t=jee(e,"string");return _u(t)=="symbol"?t:t+""}function jee(e,t){if(_u(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(_u(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var Pee=function(t){var r=t.data,n=t.startIndex,a=t.endIndex,i=t.x,o=t.width,s=t.travellerWidth;if(!r||!r.length)return{};var l=r.length,u=rf().domain(ig(0,l)).range([i,i+o-s]),d=u.domain().map(function(f){return u(f)});return{isTextActive:!1,isSlideMoving:!1,isTravellerMoving:!1,isTravellerFocused:!1,startX:u(n),endX:u(a),scale:u,scaleValues:d}},o4=function(t){return t.changedTouches&&!!t.changedTouches.length},Cu=function(e){function t(r){var n;return xee(this,t),n=bee(this,t,[r]),gi(n,"handleDrag",function(a){n.leaveTimer&&(clearTimeout(n.leaveTimer),n.leaveTimer=null),n.state.isTravellerMoving?n.handleTravellerMove(a):n.state.isSlideMoving&&n.handleSlideDrag(a)}),gi(n,"handleTouchMove",function(a){a.changedTouches!=null&&a.changedTouches.length>0&&n.handleDrag(a.changedTouches[0])}),gi(n,"handleDragEnd",function(){n.setState({isTravellerMoving:!1,isSlideMoving:!1},function(){var a=n.props,i=a.endIndex,o=a.onDragEnd,s=a.startIndex;o==null||o({endIndex:i,startIndex:s})}),n.detachDragEndListener()}),gi(n,"handleLeaveWrapper",function(){(n.state.isTravellerMoving||n.state.isSlideMoving)&&(n.leaveTimer=window.setTimeout(n.handleDragEnd,n.props.leaveTimeOut))}),gi(n,"handleEnterSlideOrTraveller",function(){n.setState({isTextActive:!0})}),gi(n,"handleLeaveSlideOrTraveller",function(){n.setState({isTextActive:!1})}),gi(n,"handleSlideDragStart",function(a){var i=o4(a)?a.changedTouches[0]:a;n.setState({isTravellerMoving:!1,isSlideMoving:!0,slideMoveStartX:i.pageX}),n.attachDragEndListener()}),n.travellerDragStartHandlers={startX:n.handleTravellerDragStart.bind(n,"startX"),endX:n.handleTravellerDragStart.bind(n,"endX")},n.state={},n}return See(t,e),vee(t,[{key:"componentWillUnmount",value:function(){this.leaveTimer&&(clearTimeout(this.leaveTimer),this.leaveTimer=null),this.detachDragEndListener()}},{key:"getIndex",value:function(n){var a=n.startX,i=n.endX,o=this.state.scaleValues,s=this.props,l=s.gap,u=s.data,d=u.length-1,f=Math.min(a,i),h=Math.max(a,i),g=t.getIndexInRange(o,f),b=t.getIndexInRange(o,h);return{startIndex:g-g%l,endIndex:b===d?d:b-b%l}}},{key:"getTextOfTick",value:function(n){var a=this.props,i=a.data,o=a.tickFormatter,s=a.dataKey,l=ia(i[n],s,n);return tr(o)?o(l,n):l}},{key:"attachDragEndListener",value:function(){window.addEventListener("mouseup",this.handleDragEnd,!0),window.addEventListener("touchend",this.handleDragEnd,!0),window.addEventListener("mousemove",this.handleDrag,!0)}},{key:"detachDragEndListener",value:function(){window.removeEventListener("mouseup",this.handleDragEnd,!0),window.removeEventListener("touchend",this.handleDragEnd,!0),window.removeEventListener("mousemove",this.handleDrag,!0)}},{key:"handleSlideDrag",value:function(n){var a=this.state,i=a.slideMoveStartX,o=a.startX,s=a.endX,l=this.props,u=l.x,d=l.width,f=l.travellerWidth,h=l.startIndex,g=l.endIndex,b=l.onChange,w=n.pageX-i;w>0?w=Math.min(w,u+d-f-s,u+d-f-o):w<0&&(w=Math.max(w,u-o,u-s));var v=this.getIndex({startX:o+w,endX:s+w});(v.startIndex!==h||v.endIndex!==g)&&b&&b(v),this.setState({startX:o+w,endX:s+w,slideMoveStartX:n.pageX})}},{key:"handleTravellerDragStart",value:function(n,a){var i=o4(a)?a.changedTouches[0]:a;this.setState({isSlideMoving:!1,isTravellerMoving:!0,movingTravellerId:n,brushMoveStartX:i.pageX}),this.attachDragEndListener()}},{key:"handleTravellerMove",value:function(n){var a=this.state,i=a.brushMoveStartX,o=a.movingTravellerId,s=a.endX,l=a.startX,u=this.state[o],d=this.props,f=d.x,h=d.width,g=d.travellerWidth,b=d.onChange,w=d.gap,v=d.data,x={startX:this.state.startX,endX:this.state.endX},m=n.pageX-i;m>0?m=Math.min(m,f+h-g-u):m<0&&(m=Math.max(m,f-u)),x[o]=u+m;var k=this.getIndex(x),P=k.startIndex,j=k.endIndex,S=function(){var O=v.length-1;return o==="startX"&&(s>l?P%w===0:j%w===0)||s<l&&j===O||o==="endX"&&(s>l?j%w===0:P%w===0)||s>l&&j===O};this.setState(gi(gi({},o,u+m),"brushMoveStartX",n.pageX),function(){b&&S()&&b(k)})}},{key:"handleTravellerMoveKeyboard",value:function(n,a){var i=this,o=this.state,s=o.scaleValues,l=o.startX,u=o.endX,d=this.state[a],f=s.indexOf(d);if(f!==-1){var h=f+n;if(!(h===-1||h>=s.length)){var g=s[h];a==="startX"&&g>=u||a==="endX"&&g<=l||this.setState(gi({},a,g),function(){i.props.onChange(i.getIndex({startX:i.state.startX,endX:i.state.endX}))})}}}},{key:"renderBackground",value:function(){var n=this.props,a=n.x,i=n.y,o=n.width,s=n.height,l=n.fill,u=n.stroke;return oe.createElement("rect",{stroke:u,fill:l,x:a,y:i,width:o,height:s})}},{key:"renderPanorama",value:function(){var n=this.props,a=n.x,i=n.y,o=n.width,s=n.height,l=n.data,u=n.children,d=n.padding,f=_.Children.only(u);return f?oe.cloneElement(f,{x:a,y:i,width:o,height:s,margin:d,compact:!0,data:l}):null}},{key:"renderTravellerLayer",value:function(n,a){var i,o,s=this,l=this.props,u=l.y,d=l.travellerWidth,f=l.height,h=l.traveller,g=l.ariaLabel,b=l.data,w=l.startIndex,v=l.endIndex,x=Math.max(n,this.props.x),m=rx(rx({},er(this.props,!1)),{},{x,y:u,width:d,height:f}),k=g||"Min value: ".concat((i=b[w])===null||i===void 0?void 0:i.name,", Max value: ").concat((o=b[v])===null||o===void 0?void 0:o.name);return oe.createElement(Wr,{tabIndex:0,role:"slider","aria-label":k,"aria-valuenow":n,className:"recharts-brush-traveller",onMouseEnter:this.handleEnterSlideOrTraveller,onMouseLeave:this.handleLeaveSlideOrTraveller,onMouseDown:this.travellerDragStartHandlers[a],onTouchStart:this.travellerDragStartHandlers[a],onKeyDown:function(j){["ArrowLeft","ArrowRight"].includes(j.key)&&(j.preventDefault(),j.stopPropagation(),s.handleTravellerMoveKeyboard(j.key==="ArrowRight"?1:-1,a))},onFocus:function(){s.setState({isTravellerFocused:!0})},onBlur:function(){s.setState({isTravellerFocused:!1})},style:{cursor:"col-resize"}},t.renderTraveller(h,m))}},{key:"renderSlide",value:function(n,a){var i=this.props,o=i.y,s=i.height,l=i.stroke,u=i.travellerWidth,d=Math.min(n,a)+u,f=Math.max(Math.abs(a-n)-u,0);return oe.createElement("rect",{className:"recharts-brush-slide",onMouseEnter:this.handleEnterSlideOrTraveller,onMouseLeave:this.handleLeaveSlideOrTraveller,onMouseDown:this.handleSlideDragStart,onTouchStart:this.handleSlideDragStart,style:{cursor:"move"},stroke:"none",fill:l,fillOpacity:.2,x:d,y:o,width:f,height:s})}},{key:"renderText",value:function(){var n=this.props,a=n.startIndex,i=n.endIndex,o=n.y,s=n.height,l=n.travellerWidth,u=n.stroke,d=this.state,f=d.startX,h=d.endX,g=5,b={pointerEvents:"none",fill:u};return oe.createElement(Wr,{className:"recharts-brush-texts"},oe.createElement(Ip,og({textAnchor:"end",verticalAnchor:"middle",x:Math.min(f,h)-g,y:o+s/2},b),this.getTextOfTick(a)),oe.createElement(Ip,og({textAnchor:"start",verticalAnchor:"middle",x:Math.max(f,h)+l+g,y:o+s/2},b),this.getTextOfTick(i)))}},{key:"render",value:function(){var n=this.props,a=n.data,i=n.className,o=n.children,s=n.x,l=n.y,u=n.width,d=n.height,f=n.alwaysShowText,h=this.state,g=h.startX,b=h.endX,w=h.isTextActive,v=h.isSlideMoving,x=h.isTravellerMoving,m=h.isTravellerFocused;if(!a||!a.length||!Fe(s)||!Fe(l)||!Fe(u)||!Fe(d)||u<=0||d<=0)return null;var k=kr("recharts-brush",i),P=oe.Children.count(o)===1,j=yee("userSelect","none");return oe.createElement(Wr,{className:k,onMouseLeave:this.handleLeaveWrapper,onTouchMove:this.handleTouchMove,style:j},this.renderBackground(),P&&this.renderPanorama(),this.renderSlide(g,b),this.renderTravellerLayer(g,"startX"),this.renderTravellerLayer(b,"endX"),(w||v||x||m||f)&&this.renderText())}}],[{key:"renderDefaultTraveller",value:function(n){var a=n.x,i=n.y,o=n.width,s=n.height,l=n.stroke,u=Math.floor(i+s/2)-1;return oe.createElement(oe.Fragment,null,oe.createElement("rect",{x:a,y:i,width:o,height:s,fill:l,stroke:"none"}),oe.createElement("line",{x1:a+1,y1:u,x2:a+o-1,y2:u,fill:"none",stroke:"#fff"}),oe.createElement("line",{x1:a+1,y1:u+2,x2:a+o-1,y2:u+2,fill:"none",stroke:"#fff"}))}},{key:"renderTraveller",value:function(n,a){var i;return oe.isValidElement(n)?i=oe.cloneElement(n,a):tr(n)?i=n(a):i=t.renderDefaultTraveller(a),i}},{key:"getDerivedStateFromProps",value:function(n,a){var i=n.data,o=n.width,s=n.x,l=n.travellerWidth,u=n.updateId,d=n.startIndex,f=n.endIndex;if(i!==a.prevData||u!==a.prevUpdateId)return rx({prevData:i,prevTravellerWidth:l,prevUpdateId:u,prevX:s,prevWidth:o},i&&i.length?Pee({data:i,width:o,x:s,travellerWidth:l,startIndex:d,endIndex:f}):{scale:null,scaleValues:null});if(a.scale&&(o!==a.prevWidth||s!==a.prevX||l!==a.prevTravellerWidth)){a.scale.range([s,s+o-l]);var h=a.scale.domain().map(function(g){return a.scale(g)});return{prevData:i,prevTravellerWidth:l,prevUpdateId:u,prevX:s,prevWidth:o,startX:a.scale(n.startIndex),endX:a.scale(n.endIndex),scaleValues:h}}return null}},{key:"getIndexInRange",value:function(n,a){for(var i=n.length,o=0,s=i-1;s-o>1;){var l=Math.floor((o+s)/2);n[l]>a?s=l:o=l}return a>=n[s]?s:o}}])}(_.PureComponent);gi(Cu,"displayName","Brush");gi(Cu,"defaultProps",{height:40,travellerWidth:5,gap:1,fill:"#fff",stroke:"#666",padding:{top:1,right:1,bottom:1,left:1},leaveTimeOut:1e3,alwaysShowText:!1});var _ee=b2;function Cee(e,t){var r;return _ee(e,function(n,a,i){return r=t(n,a,i),!r}),!!r}var Mee=Cee,Nee=EC,Oee=dl,Aee=Mee,Tee=ci,Eee=pm;function Iee(e,t,r){var n=Tee(e)?Nee:Aee;return r&&Eee(e,t,r)&&(t=void 0),n(e,Oee(t))}var $ee=Iee;const Dee=on($ee);var $o=function(t,r){var n=t.alwaysShow,a=t.ifOverflow;return n&&(a="extendDomain"),a===r},s4=tM;function Ree(e,t,r){t=="__proto__"&&s4?s4(e,t,{configurable:!0,enumerable:!0,value:r,writable:!0}):e[t]=r}var Bee=Ree,Lee=Bee,Fee=QC,Gee=dl;function Uee(e,t){var r={};return t=Gee(t),Fee(e,function(n,a,i){Lee(r,a,t(n,a,i))}),r}var zee=Uee;const Wee=on(zee);function Hee(e,t){for(var r=-1,n=e==null?0:e.length;++r<n;)if(!t(e[r],r,e))return!1;return!0}var Vee=Hee,Xee=b2;function Kee(e,t){var r=!0;return Xee(e,function(n,a,i){return r=!!t(n,a,i),r}),r}var Yee=Kee,qee=Vee,Zee=Yee,Jee=dl,Qee=ci,ete=pm;function tte(e,t,r){var n=Qee(e)?qee:Zee;return r&&ete(e,t,r)&&(t=void 0),n(e,Jee(t))}var rte=tte;const AN=on(rte);var nte=["x","y"];function i0(e){"@babel/helpers - typeof";return i0=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},i0(e)}function v1(){return v1=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},v1.apply(this,arguments)}function l4(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Rd(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?l4(Object(r),!0).forEach(function(n){ate(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):l4(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function ate(e,t,r){return t=ite(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function ite(e){var t=ote(e,"string");return i0(t)=="symbol"?t:t+""}function ote(e,t){if(i0(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(i0(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function ste(e,t){if(e==null)return{};var r=lte(e,t),n,a;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function lte(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function cte(e,t){var r=e.x,n=e.y,a=ste(e,nte),i="".concat(r),o=parseInt(i,10),s="".concat(n),l=parseInt(s,10),u="".concat(t.height||a.height),d=parseInt(u,10),f="".concat(t.width||a.width),h=parseInt(f,10);return Rd(Rd(Rd(Rd(Rd({},t),a),o?{x:o}:{}),l?{y:l}:{}),{},{height:d,width:h,name:t.name,radius:t.radius})}function c4(e){return oe.createElement(y1,v1({shapeType:"rectangle",propTransformer:cte,activeClassName:"recharts-active-bar"},e))}var ute=function(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return function(n,a){if(typeof t=="number")return t;var i=Fe(n)||jD(n);return i?t(n,a):(i||fc(),r)}},dte=["value","background"],TN;function Mu(e){"@babel/helpers - typeof";return Mu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Mu(e)}function fte(e,t){if(e==null)return{};var r=hte(e,t),n,a;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function hte(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function lg(){return lg=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},lg.apply(this,arguments)}function u4(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Un(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?u4(Object(r),!0).forEach(function(n){zs(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):u4(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function pte(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function d4(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,IN(n.key),n)}}function gte(e,t,r){return t&&d4(e.prototype,t),r&&d4(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function mte(e,t,r){return t=cg(t),yte(e,EN()?Reflect.construct(t,r||[],cg(e).constructor):t.apply(e,r))}function yte(e,t){if(t&&(Mu(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return xte(e)}function xte(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function EN(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(EN=function(){return!!e})()}function cg(e){return cg=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},cg(e)}function vte(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&b1(e,t)}function b1(e,t){return b1=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},b1(e,t)}function zs(e,t,r){return t=IN(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function IN(e){var t=bte(e,"string");return Mu(t)=="symbol"?t:t+""}function bte(e,t){if(Mu(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(Mu(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var S0=function(e){function t(){var r;pte(this,t);for(var n=arguments.length,a=new Array(n),i=0;i<n;i++)a[i]=arguments[i];return r=mte(this,t,[].concat(a)),zs(r,"state",{isAnimationFinished:!1}),zs(r,"id",xc("recharts-bar-")),zs(r,"handleAnimationEnd",function(){var o=r.props.onAnimationEnd;r.setState({isAnimationFinished:!0}),o&&o()}),zs(r,"handleAnimationStart",function(){var o=r.props.onAnimationStart;r.setState({isAnimationFinished:!1}),o&&o()}),r}return vte(t,e),gte(t,[{key:"renderRectanglesStatically",value:function(n){var a=this,i=this.props,o=i.shape,s=i.dataKey,l=i.activeIndex,u=i.activeBar,d=er(this.props,!1);return n&&n.map(function(f,h){var g=h===l,b=g?u:o,w=Un(Un(Un({},d),f),{},{isActive:g,option:b,index:h,dataKey:s,onAnimationStart:a.handleAnimationStart,onAnimationEnd:a.handleAnimationEnd});return oe.createElement(Wr,lg({className:"recharts-bar-rectangle"},Mf(a.props,f,h),{key:"rectangle-".concat(f==null?void 0:f.x,"-").concat(f==null?void 0:f.y,"-").concat(f==null?void 0:f.value,"-").concat(h)}),oe.createElement(c4,w))})}},{key:"renderRectanglesWithAnimation",value:function(){var n=this,a=this.props,i=a.data,o=a.layout,s=a.isAnimationActive,l=a.animationBegin,u=a.animationDuration,d=a.animationEasing,f=a.animationId,h=this.state.prevData;return oe.createElement(fo,{begin:l,duration:u,isActive:s,easing:d,from:{t:0},to:{t:1},key:"bar-".concat(f),onAnimationEnd:this.handleAnimationEnd,onAnimationStart:this.handleAnimationStart},function(g){var b=g.t,w=i.map(function(v,x){var m=h&&h[x];if(m){var k=$n(m.x,v.x),P=$n(m.y,v.y),j=$n(m.width,v.width),S=$n(m.height,v.height);return Un(Un({},v),{},{x:k(b),y:P(b),width:j(b),height:S(b)})}if(o==="horizontal"){var M=$n(0,v.height),O=M(b);return Un(Un({},v),{},{y:v.y+v.height-O,height:O})}var E=$n(0,v.width),I=E(b);return Un(Un({},v),{},{width:I})});return oe.createElement(Wr,null,n.renderRectanglesStatically(w))})}},{key:"renderRectangles",value:function(){var n=this.props,a=n.data,i=n.isAnimationActive,o=this.state.prevData;return i&&a&&a.length&&(!o||!uc(o,a))?this.renderRectanglesWithAnimation():this.renderRectanglesStatically(a)}},{key:"renderBackground",value:function(){var n=this,a=this.props,i=a.data,o=a.dataKey,s=a.activeIndex,l=er(this.props.background,!1);return i.map(function(u,d){u.value;var f=u.background,h=fte(u,dte);if(!f)return null;var g=Un(Un(Un(Un(Un({},h),{},{fill:"#eee"},f),l),Mf(n.props,u,d)),{},{onAnimationStart:n.handleAnimationStart,onAnimationEnd:n.handleAnimationEnd,dataKey:o,index:d,className:"recharts-bar-background-rectangle"});return oe.createElement(c4,lg({key:"background-bar-".concat(d),option:n.props.background,isActive:d===s},g))})}},{key:"renderErrorBar",value:function(n,a){if(this.props.isAnimationActive&&!this.state.isAnimationFinished)return null;var i=this.props,o=i.data,s=i.xAxis,l=i.yAxis,u=i.layout,d=i.children,f=li(d,id);if(!f)return null;var h=u==="vertical"?o[0].height/2:o[0].width/2,g=function(v,x){var m=Array.isArray(v.value)?v.value[1]:v.value;return{x:v.x,y:v.y,value:m,errorVal:ia(v,x)}},b={clipPath:n?"url(#clipPath-".concat(a,")"):null};return oe.createElement(Wr,b,f.map(function(w){return oe.cloneElement(w,{key:"error-bar-".concat(a,"-").concat(w.props.dataKey),data:o,xAxis:s,yAxis:l,layout:u,offset:h,dataPointFormatter:g})}))}},{key:"render",value:function(){var n=this.props,a=n.hide,i=n.data,o=n.className,s=n.xAxis,l=n.yAxis,u=n.left,d=n.top,f=n.width,h=n.height,g=n.isAnimationActive,b=n.background,w=n.id;if(a||!i||!i.length)return null;var v=this.state.isAnimationFinished,x=kr("recharts-bar",o),m=s&&s.allowDataOverflow,k=l&&l.allowDataOverflow,P=m||k,j=Zt(w)?this.id:w;return oe.createElement(Wr,{className:x},m||k?oe.createElement("defs",null,oe.createElement("clipPath",{id:"clipPath-".concat(j)},oe.createElement("rect",{x:m?u:u-f/2,y:k?d:d-h/2,width:m?f:f*2,height:k?h:h*2}))):null,oe.createElement(Wr,{className:"recharts-bar-rectangles",clipPath:P?"url(#clipPath-".concat(j,")"):null},b?this.renderBackground():null,this.renderRectangles()),this.renderErrorBar(P,j),(!g||v)&&Io.renderCallByParent(this.props,i))}}],[{key:"getDerivedStateFromProps",value:function(n,a){return n.animationId!==a.prevAnimationId?{prevAnimationId:n.animationId,curData:n.data,prevData:a.curData}:n.data!==a.curData?{curData:n.data}:null}}])}(_.PureComponent);TN=S0;zs(S0,"displayName","Bar");zs(S0,"defaultProps",{xAxisId:0,yAxisId:0,legendType:"rect",minPointSize:0,hide:!1,data:[],layout:"vertical",activeBar:!1,isAnimationActive:!fl.isSsr,animationBegin:0,animationDuration:400,animationEasing:"ease"});zs(S0,"getComposedData",function(e){var t=e.props,r=e.item,n=e.barPosition,a=e.bandSize,i=e.xAxis,o=e.yAxis,s=e.xAxisTicks,l=e.yAxisTicks,u=e.stackedData,d=e.dataStartIndex,f=e.displayedData,h=e.offset,g=XY(n,r);if(!g)return null;var b=t.layout,w=r.type.defaultProps,v=w!==void 0?Un(Un({},w),r.props):r.props,x=v.dataKey,m=v.children,k=v.minPointSize,P=b==="horizontal"?o:i,j=u?P.scale.domain():null,S=tq({numericAxis:P}),M=li(m,S2),O=f.map(function(E,I){var D,B,z,Y,G,$;u?D=KY(u[d+I],j):(D=ia(E,x),Array.isArray(D)||(D=[S,D]));var L=ute(k,TN.defaultProps.minPointSize)(D[1],I);if(b==="horizontal"){var U,V=[o.scale(D[0]),o.scale(D[1])],J=V[0],K=V[1];B=h5({axis:i,ticks:s,bandSize:a,offset:g.offset,entry:E,index:I}),z=(U=K??J)!==null&&U!==void 0?U:void 0,Y=g.size;var Q=J-K;if(G=Number.isNaN(Q)?0:Q,$={x:B,y:o.y,width:Y,height:o.height},Math.abs(L)>0&&Math.abs(G)<Math.abs(L)){var te=oo(G||L)*(Math.abs(L)-Math.abs(G));z-=te,G+=te}}else{var ee=[i.scale(D[0]),i.scale(D[1])],me=ee[0],re=ee[1];if(B=me,z=h5({axis:o,ticks:l,bandSize:a,offset:g.offset,entry:E,index:I}),Y=re-me,G=g.size,$={x:i.x,y:z,width:i.width,height:G},Math.abs(L)>0&&Math.abs(Y)<Math.abs(L)){var De=oo(Y||L)*(Math.abs(L)-Math.abs(Y));Y+=De}}return Un(Un(Un({},E),{},{x:B,y:z,width:Y,height:G,value:u?D:D[1],payload:E,background:$},M&&M[I]&&M[I].props),{},{tooltipPayload:[fN(r,E)],tooltipPosition:{x:B+Y/2,y:z+G/2}})});return Un({data:O,layout:b},h)});function o0(e){"@babel/helpers - typeof";return o0=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},o0(e)}function wte(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function f4(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,$N(n.key),n)}}function kte(e,t,r){return t&&f4(e.prototype,t),r&&f4(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function h4(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function to(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?h4(Object(r),!0).forEach(function(n){Cm(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):h4(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Cm(e,t,r){return t=$N(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function $N(e){var t=Ste(e,"string");return o0(t)=="symbol"?t:t+""}function Ste(e,t){if(o0(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(o0(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var q2=function(t,r,n,a,i){var o=t.width,s=t.height,l=t.layout,u=t.children,d=Object.keys(r),f={left:n.left,leftMirror:n.left,right:o-n.right,rightMirror:o-n.right,top:n.top,topMirror:n.top,bottom:s-n.bottom,bottomMirror:s-n.bottom},h=!!yi(u,S0);return d.reduce(function(g,b){var w=r[b],v=w.orientation,x=w.domain,m=w.padding,k=m===void 0?{}:m,P=w.mirror,j=w.reversed,S="".concat(v).concat(P?"Mirror":""),M,O,E,I,D;if(w.type==="number"&&(w.padding==="gap"||w.padding==="no-gap")){var B=x[1]-x[0],z=1/0,Y=w.categoricalDomain.sort(MD);if(Y.forEach(function(ee,me){me>0&&(z=Math.min((ee||0)-(Y[me-1]||0),z))}),Number.isFinite(z)){var G=z/B,$=w.layout==="vertical"?n.height:n.width;if(w.padding==="gap"&&(M=G*$/2),w.padding==="no-gap"){var L=cc(t.barCategoryGap,G*$),U=G*$/2;M=U-L-(U-L)/$*L}}}a==="xAxis"?O=[n.left+(k.left||0)+(M||0),n.left+n.width-(k.right||0)-(M||0)]:a==="yAxis"?O=l==="horizontal"?[n.top+n.height-(k.bottom||0),n.top+(k.top||0)]:[n.top+(k.top||0)+(M||0),n.top+n.height-(k.bottom||0)-(M||0)]:O=w.range,j&&(O=[O[1],O[0]]);var V=HY(w,i,h),J=V.scale,K=V.realScaleType;J.domain(x).range(O),VY(J);var Q=eq(J,to(to({},w),{},{realScaleType:K}));a==="xAxis"?(D=v==="top"&&!P||v==="bottom"&&P,E=n.left,I=f[S]-D*w.height):a==="yAxis"&&(D=v==="left"&&!P||v==="right"&&P,E=f[S]-D*w.width,I=n.top);var te=to(to(to({},w),Q),{},{realScaleType:K,x:E,y:I,scale:J,width:a==="xAxis"?n.width:w.width,height:a==="yAxis"?n.height:w.height});return te.bandSize=Yp(te,Q),!w.hide&&a==="xAxis"?f[S]+=(D?-1:1)*te.height:w.hide||(f[S]+=(D?-1:1)*te.width),to(to({},g),{},Cm({},b,te))},{})},DN=function(t,r){var n=t.x,a=t.y,i=r.x,o=r.y;return{x:Math.min(n,i),y:Math.min(a,o),width:Math.abs(i-n),height:Math.abs(o-a)}},jte=function(t){var r=t.x1,n=t.y1,a=t.x2,i=t.y2;return DN({x:r,y:n},{x:a,y:i})},RN=function(){function e(t){wte(this,e),this.scale=t}return kte(e,[{key:"domain",get:function(){return this.scale.domain}},{key:"range",get:function(){return this.scale.range}},{key:"rangeMin",get:function(){return this.range()[0]}},{key:"rangeMax",get:function(){return this.range()[1]}},{key:"bandwidth",get:function(){return this.scale.bandwidth}},{key:"apply",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},a=n.bandAware,i=n.position;if(r!==void 0){if(i)switch(i){case"start":return this.scale(r);case"middle":{var o=this.bandwidth?this.bandwidth()/2:0;return this.scale(r)+o}case"end":{var s=this.bandwidth?this.bandwidth():0;return this.scale(r)+s}default:return this.scale(r)}if(a){var l=this.bandwidth?this.bandwidth()/2:0;return this.scale(r)+l}return this.scale(r)}}},{key:"isInRange",value:function(r){var n=this.range(),a=n[0],i=n[n.length-1];return a<=i?r>=a&&r<=i:r>=i&&r<=a}}],[{key:"create",value:function(r){return new e(r)}}])}();Cm(RN,"EPS",1e-4);var Z2=function(t){var r=Object.keys(t).reduce(function(n,a){return to(to({},n),{},Cm({},a,RN.create(t[a])))},{});return to(to({},r),{},{apply:function(a){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},o=i.bandAware,s=i.position;return Wee(a,function(l,u){return r[u].apply(l,{bandAware:o,position:s})})},isInRange:function(a){return AN(a,function(i,o){return r[o].isInRange(i)})}})};function Pte(e){return(e%180+180)%180}var _te=function(t){var r=t.width,n=t.height,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,i=Pte(a),o=i*Math.PI/180,s=Math.atan(n/r),l=o>s&&o<Math.PI-s?n/Math.sin(o):r/Math.cos(o);return Math.abs(l)},Cte=dl,Mte=x0,Nte=fm;function Ote(e){return function(t,r,n){var a=Object(t);if(!Mte(t)){var i=Cte(r);t=Nte(t),r=function(s){return i(a[s],s,a)}}var o=e(t,r,n);return o>-1?a[i?t[o]:o]:void 0}}var Ate=Ote,Tte=CN;function Ete(e){var t=Tte(e),r=t%1;return t===t?r?t-r:t:0}var Ite=Ete,$te=XC,Dte=dl,Rte=Ite,Bte=Math.max;function Lte(e,t,r){var n=e==null?0:e.length;if(!n)return-1;var a=r==null?0:Rte(r);return a<0&&(a=Bte(n+a,0)),$te(e,Dte(t),a)}var Fte=Lte,Gte=Ate,Ute=Fte,zte=Gte(Ute),Wte=zte;const Hte=on(Wte);var Vte=O$(function(e){return{x:e.left,y:e.top,width:e.width,height:e.height}},function(e){return["l",e.left,"t",e.top,"w",e.width,"h",e.height].join("")}),J2=_.createContext(void 0),Q2=_.createContext(void 0),BN=_.createContext(void 0),LN=_.createContext({}),FN=_.createContext(void 0),GN=_.createContext(0),UN=_.createContext(0),p4=function(t){var r=t.state,n=r.xAxisMap,a=r.yAxisMap,i=r.offset,o=t.clipPathId,s=t.children,l=t.width,u=t.height,d=Vte(i);return oe.createElement(J2.Provider,{value:n},oe.createElement(Q2.Provider,{value:a},oe.createElement(LN.Provider,{value:i},oe.createElement(BN.Provider,{value:d},oe.createElement(FN.Provider,{value:o},oe.createElement(GN.Provider,{value:u},oe.createElement(UN.Provider,{value:l},s)))))))},Xte=function(){return _.useContext(FN)},zN=function(t){var r=_.useContext(J2);r==null&&fc();var n=r[t];return n==null&&fc(),n},Kte=function(){var t=_.useContext(J2);return $s(t)},Yte=function(){var t=_.useContext(Q2),r=Hte(t,function(n){return AN(n.domain,Number.isFinite)});return r||$s(t)},WN=function(t){var r=_.useContext(Q2);r==null&&fc();var n=r[t];return n==null&&fc(),n},qte=function(){var t=_.useContext(BN);return t},Zte=function(){return _.useContext(LN)},ew=function(){return _.useContext(UN)},tw=function(){return _.useContext(GN)};function Nu(e){"@babel/helpers - typeof";return Nu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Nu(e)}function Jte(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Qte(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,VN(n.key),n)}}function ere(e,t,r){return t&&Qte(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function tre(e,t,r){return t=ug(t),rre(e,HN()?Reflect.construct(t,r||[],ug(e).constructor):t.apply(e,r))}function rre(e,t){if(t&&(Nu(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return nre(e)}function nre(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function HN(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(HN=function(){return!!e})()}function ug(e){return ug=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},ug(e)}function are(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&w1(e,t)}function w1(e,t){return w1=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},w1(e,t)}function g4(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function m4(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?g4(Object(r),!0).forEach(function(n){rw(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):g4(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function rw(e,t,r){return t=VN(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function VN(e){var t=ire(e,"string");return Nu(t)=="symbol"?t:t+""}function ire(e,t){if(Nu(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(Nu(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}function ore(e,t){return ure(e)||cre(e,t)||lre(e,t)||sre()}function sre(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function lre(e,t){if(e){if(typeof e=="string")return y4(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return y4(e,t)}}function y4(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function cre(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,a,i,o,s=[],l=!0,u=!1;try{if(i=(r=r.call(e)).next,t!==0)for(;!(l=(n=i.call(r)).done)&&(s.push(n.value),s.length!==t);l=!0);}catch(d){u=!0,a=d}finally{try{if(!l&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(u)throw a}}return s}}function ure(e){if(Array.isArray(e))return e}function k1(){return k1=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},k1.apply(this,arguments)}var dre=function(t,r){var n;return oe.isValidElement(t)?n=oe.cloneElement(t,r):tr(t)?n=t(r):n=oe.createElement("line",k1({},r,{className:"recharts-reference-line-line"})),n},fre=function(t,r,n,a,i,o,s,l,u){var d=i.x,f=i.y,h=i.width,g=i.height;if(n){var b=u.y,w=t.y.apply(b,{position:o});if($o(u,"discard")&&!t.y.isInRange(w))return null;var v=[{x:d+h,y:w},{x:d,y:w}];return l==="left"?v.reverse():v}if(r){var x=u.x,m=t.x.apply(x,{position:o});if($o(u,"discard")&&!t.x.isInRange(m))return null;var k=[{x:m,y:f+g},{x:m,y:f}];return s==="top"?k.reverse():k}if(a){var P=u.segment,j=P.map(function(S){return t.apply(S,{position:o})});return $o(u,"discard")&&Dee(j,function(S){return!t.isInRange(S)})?null:j}return null};function hre(e){var t=e.x,r=e.y,n=e.segment,a=e.xAxisId,i=e.yAxisId,o=e.shape,s=e.className,l=e.alwaysShow,u=Xte(),d=zN(a),f=WN(i),h=qte();if(!u||!h)return null;os(l===void 0,'The alwaysShow prop is deprecated. Please use ifOverflow="extendDomain" instead.');var g=Z2({x:d.scale,y:f.scale}),b=aa(t),w=aa(r),v=n&&n.length===2,x=fre(g,b,w,v,h,e.position,d.orientation,f.orientation,e);if(!x)return null;var m=ore(x,2),k=m[0],P=k.x,j=k.y,S=m[1],M=S.x,O=S.y,E=$o(e,"hidden")?"url(#".concat(u,")"):void 0,I=m4(m4({clipPath:E},er(e,!0)),{},{x1:P,y1:j,x2:M,y2:O});return oe.createElement(Wr,{className:kr("recharts-reference-line",s)},dre(o,I),wa.renderCallByParent(e,jte({x1:P,y1:j,x2:M,y2:O})))}var Ws=function(e){function t(){return Jte(this,t),tre(this,t,arguments)}return are(t,e),ere(t,[{key:"render",value:function(){return oe.createElement(hre,this.props)}}])}(oe.Component);rw(Ws,"displayName","ReferenceLine");rw(Ws,"defaultProps",{isFront:!1,ifOverflow:"discard",xAxisId:0,yAxisId:0,fill:"none",stroke:"#ccc",fillOpacity:1,strokeWidth:1,position:"middle"});function S1(){return S1=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},S1.apply(this,arguments)}function Ou(e){"@babel/helpers - typeof";return Ou=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ou(e)}function x4(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function v4(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?x4(Object(r),!0).forEach(function(n){Mm(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):x4(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function pre(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function gre(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,KN(n.key),n)}}function mre(e,t,r){return t&&gre(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function yre(e,t,r){return t=dg(t),xre(e,XN()?Reflect.construct(t,r||[],dg(e).constructor):t.apply(e,r))}function xre(e,t){if(t&&(Ou(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return vre(e)}function vre(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function XN(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(XN=function(){return!!e})()}function dg(e){return dg=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},dg(e)}function bre(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&j1(e,t)}function j1(e,t){return j1=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},j1(e,t)}function Mm(e,t,r){return t=KN(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function KN(e){var t=wre(e,"string");return Ou(t)=="symbol"?t:t+""}function wre(e,t){if(Ou(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(Ou(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var kre=function(t){var r=t.x,n=t.y,a=t.xAxis,i=t.yAxis,o=Z2({x:a.scale,y:i.scale}),s=o.apply({x:r,y:n},{bandAware:!0});return $o(t,"discard")&&!o.isInRange(s)?null:s},j0=function(e){function t(){return pre(this,t),yre(this,t,arguments)}return bre(t,e),mre(t,[{key:"render",value:function(){var n=this.props,a=n.x,i=n.y,o=n.r,s=n.alwaysShow,l=n.clipPathId,u=aa(a),d=aa(i);if(os(s===void 0,'The alwaysShow prop is deprecated. Please use ifOverflow="extendDomain" instead.'),!u||!d)return null;var f=kre(this.props);if(!f)return null;var h=f.x,g=f.y,b=this.props,w=b.shape,v=b.className,x=$o(this.props,"hidden")?"url(#".concat(l,")"):void 0,m=v4(v4({clipPath:x},er(this.props,!0)),{},{cx:h,cy:g});return oe.createElement(Wr,{className:kr("recharts-reference-dot",v)},t.renderDot(w,m),wa.renderCallByParent(this.props,{x:h-o,y:g-o,width:2*o,height:2*o}))}}])}(oe.Component);Mm(j0,"displayName","ReferenceDot");Mm(j0,"defaultProps",{isFront:!1,ifOverflow:"discard",xAxisId:0,yAxisId:0,r:10,fill:"#fff",stroke:"#ccc",fillOpacity:1,strokeWidth:1});Mm(j0,"renderDot",function(e,t){var r;return oe.isValidElement(e)?r=oe.cloneElement(e,t):tr(e)?r=e(t):r=oe.createElement(jm,S1({},t,{cx:t.cx,cy:t.cy,className:"recharts-reference-dot-dot"})),r});function P1(){return P1=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},P1.apply(this,arguments)}function Au(e){"@babel/helpers - typeof";return Au=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Au(e)}function b4(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function w4(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?b4(Object(r),!0).forEach(function(n){Nm(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):b4(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Sre(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function jre(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,qN(n.key),n)}}function Pre(e,t,r){return t&&jre(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function _re(e,t,r){return t=fg(t),Cre(e,YN()?Reflect.construct(t,r||[],fg(e).constructor):t.apply(e,r))}function Cre(e,t){if(t&&(Au(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Mre(e)}function Mre(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function YN(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(YN=function(){return!!e})()}function fg(e){return fg=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},fg(e)}function Nre(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_1(e,t)}function _1(e,t){return _1=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},_1(e,t)}function Nm(e,t,r){return t=qN(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function qN(e){var t=Ore(e,"string");return Au(t)=="symbol"?t:t+""}function Ore(e,t){if(Au(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(Au(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var Are=function(t,r,n,a,i){var o=i.x1,s=i.x2,l=i.y1,u=i.y2,d=i.xAxis,f=i.yAxis;if(!d||!f)return null;var h=Z2({x:d.scale,y:f.scale}),g={x:t?h.x.apply(o,{position:"start"}):h.x.rangeMin,y:n?h.y.apply(l,{position:"start"}):h.y.rangeMin},b={x:r?h.x.apply(s,{position:"end"}):h.x.rangeMax,y:a?h.y.apply(u,{position:"end"}):h.y.rangeMax};return $o(i,"discard")&&(!h.isInRange(g)||!h.isInRange(b))?null:DN(g,b)},P0=function(e){function t(){return Sre(this,t),_re(this,t,arguments)}return Nre(t,e),Pre(t,[{key:"render",value:function(){var n=this.props,a=n.x1,i=n.x2,o=n.y1,s=n.y2,l=n.className,u=n.alwaysShow,d=n.clipPathId;os(u===void 0,'The alwaysShow prop is deprecated. Please use ifOverflow="extendDomain" instead.');var f=aa(a),h=aa(i),g=aa(o),b=aa(s),w=this.props.shape;if(!f&&!h&&!g&&!b&&!w)return null;var v=Are(f,h,g,b,this.props);if(!v&&!w)return null;var x=$o(this.props,"hidden")?"url(#".concat(d,")"):void 0;return oe.createElement(Wr,{className:kr("recharts-reference-area",l)},t.renderRect(w,w4(w4({clipPath:x},er(this.props,!0)),v)),wa.renderCallByParent(this.props,v))}}])}(oe.Component);Nm(P0,"displayName","ReferenceArea");Nm(P0,"defaultProps",{isFront:!1,ifOverflow:"discard",xAxisId:0,yAxisId:0,r:10,fill:"#ccc",fillOpacity:.5,stroke:"none",strokeWidth:1});Nm(P0,"renderRect",function(e,t){var r;return oe.isValidElement(e)?r=oe.cloneElement(e,t):tr(e)?r=e(t):r=oe.createElement(Y2,P1({},t,{className:"recharts-reference-area-rect"})),r});function ZN(e,t,r){if(t<1)return[];if(t===1&&r===void 0)return e;for(var n=[],a=0;a<e.length;a+=t)n.push(e[a]);return n}function Tre(e,t,r){var n={width:e.width+t.width,height:e.height+t.height};return _te(n,r)}function Ere(e,t,r){var n=r==="width",a=e.x,i=e.y,o=e.width,s=e.height;return t===1?{start:n?a:i,end:n?a+o:i+s}:{start:n?a+o:i+s,end:n?a:i}}function hg(e,t,r,n,a){if(e*t<e*n||e*t>e*a)return!1;var i=r();return e*(t-e*i/2-n)>=0&&e*(t+e*i/2-a)<=0}function Ire(e,t){return ZN(e,t+1)}function $re(e,t,r,n,a){for(var i=(n||[]).slice(),o=t.start,s=t.end,l=0,u=1,d=o,f=function(){var b=n==null?void 0:n[l];if(b===void 0)return{v:ZN(n,u)};var w=l,v,x=function(){return v===void 0&&(v=r(b,w)),v},m=b.coordinate,k=l===0||hg(e,m,x,d,s);k||(l=0,d=o,u+=1),k&&(d=m+e*(x()/2+a),l+=u)},h;u<=i.length;)if(h=f(),h)return h.v;return[]}function s0(e){"@babel/helpers - typeof";return s0=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},s0(e)}function k4(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Aa(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?k4(Object(r),!0).forEach(function(n){Dre(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):k4(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Dre(e,t,r){return t=Rre(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Rre(e){var t=Bre(e,"string");return s0(t)=="symbol"?t:t+""}function Bre(e,t){if(s0(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(s0(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Lre(e,t,r,n,a){for(var i=(n||[]).slice(),o=i.length,s=t.start,l=t.end,u=function(h){var g=i[h],b,w=function(){return b===void 0&&(b=r(g,h)),b};if(h===o-1){var v=e*(g.coordinate+e*w()/2-l);i[h]=g=Aa(Aa({},g),{},{tickCoord:v>0?g.coordinate-v*e:g.coordinate})}else i[h]=g=Aa(Aa({},g),{},{tickCoord:g.coordinate});var x=hg(e,g.tickCoord,w,s,l);x&&(l=g.tickCoord-e*(w()/2+a),i[h]=Aa(Aa({},g),{},{isShow:!0}))},d=o-1;d>=0;d--)u(d);return i}function Fre(e,t,r,n,a,i){var o=(n||[]).slice(),s=o.length,l=t.start,u=t.end;if(i){var d=n[s-1],f=r(d,s-1),h=e*(d.coordinate+e*f/2-u);o[s-1]=d=Aa(Aa({},d),{},{tickCoord:h>0?d.coordinate-h*e:d.coordinate});var g=hg(e,d.tickCoord,function(){return f},l,u);g&&(u=d.tickCoord-e*(f/2+a),o[s-1]=Aa(Aa({},d),{},{isShow:!0}))}for(var b=i?s-1:s,w=function(m){var k=o[m],P,j=function(){return P===void 0&&(P=r(k,m)),P};if(m===0){var S=e*(k.coordinate-e*j()/2-l);o[m]=k=Aa(Aa({},k),{},{tickCoord:S<0?k.coordinate-S*e:k.coordinate})}else o[m]=k=Aa(Aa({},k),{},{tickCoord:k.coordinate});var M=hg(e,k.tickCoord,j,l,u);M&&(l=k.tickCoord+e*(j()/2+a),o[m]=Aa(Aa({},k),{},{isShow:!0}))},v=0;v<b;v++)w(v);return o}function nw(e,t,r){var n=e.tick,a=e.ticks,i=e.viewBox,o=e.minTickGap,s=e.orientation,l=e.interval,u=e.tickFormatter,d=e.unit,f=e.angle;if(!a||!a.length||!n)return[];if(Fe(l)||fl.isSsr)return Ire(a,typeof l=="number"&&Fe(l)?l:0);var h=[],g=s==="top"||s==="bottom"?"width":"height",b=d&&g==="width"?tf(d,{fontSize:t,letterSpacing:r}):{width:0,height:0},w=function(k,P){var j=tr(u)?u(k.value,P):k.value;return g==="width"?Tre(tf(j,{fontSize:t,letterSpacing:r}),b,f):tf(j,{fontSize:t,letterSpacing:r})[g]},v=a.length>=2?oo(a[1].coordinate-a[0].coordinate):1,x=Ere(i,v,g);return l==="equidistantPreserveStart"?$re(v,x,w,a,o):(l==="preserveStart"||l==="preserveStartEnd"?h=Fre(v,x,w,a,o,l==="preserveStartEnd"):h=Lre(v,x,w,a,o),h.filter(function(m){return m.isShow}))}var Gre=["viewBox"],Ure=["viewBox"],zre=["ticks"];function Tu(e){"@babel/helpers - typeof";return Tu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Tu(e)}function Kc(){return Kc=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Kc.apply(this,arguments)}function S4(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Qn(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?S4(Object(r),!0).forEach(function(n){aw(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):S4(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function nx(e,t){if(e==null)return{};var r=Wre(e,t),n,a;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function Wre(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function Hre(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function j4(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,QN(n.key),n)}}function Vre(e,t,r){return t&&j4(e.prototype,t),r&&j4(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Xre(e,t,r){return t=pg(t),Kre(e,JN()?Reflect.construct(t,r||[],pg(e).constructor):t.apply(e,r))}function Kre(e,t){if(t&&(Tu(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Yre(e)}function Yre(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function JN(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(JN=function(){return!!e})()}function pg(e){return pg=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},pg(e)}function qre(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&C1(e,t)}function C1(e,t){return C1=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},C1(e,t)}function aw(e,t,r){return t=QN(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function QN(e){var t=Zre(e,"string");return Tu(t)=="symbol"?t:t+""}function Zre(e,t){if(Tu(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(Tu(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var od=function(e){function t(r){var n;return Hre(this,t),n=Xre(this,t,[r]),n.state={fontSize:"",letterSpacing:""},n}return qre(t,e),Vre(t,[{key:"shouldComponentUpdate",value:function(n,a){var i=n.viewBox,o=nx(n,Gre),s=this.props,l=s.viewBox,u=nx(s,Ure);return!nu(i,l)||!nu(o,u)||!nu(a,this.state)}},{key:"componentDidMount",value:function(){var n=this.layerReference;if(n){var a=n.getElementsByClassName("recharts-cartesian-axis-tick-value")[0];a&&this.setState({fontSize:window.getComputedStyle(a).fontSize,letterSpacing:window.getComputedStyle(a).letterSpacing})}}},{key:"getTickLineCoord",value:function(n){var a=this.props,i=a.x,o=a.y,s=a.width,l=a.height,u=a.orientation,d=a.tickSize,f=a.mirror,h=a.tickMargin,g,b,w,v,x,m,k=f?-1:1,P=n.tickSize||d,j=Fe(n.tickCoord)?n.tickCoord:n.coordinate;switch(u){case"top":g=b=n.coordinate,v=o+ +!f*l,w=v-k*P,m=w-k*h,x=j;break;case"left":w=v=n.coordinate,b=i+ +!f*s,g=b-k*P,x=g-k*h,m=j;break;case"right":w=v=n.coordinate,b=i+ +f*s,g=b+k*P,x=g+k*h,m=j;break;default:g=b=n.coordinate,v=o+ +f*l,w=v+k*P,m=w+k*h,x=j;break}return{line:{x1:g,y1:w,x2:b,y2:v},tick:{x,y:m}}}},{key:"getTickTextAnchor",value:function(){var n=this.props,a=n.orientation,i=n.mirror,o;switch(a){case"left":o=i?"start":"end";break;case"right":o=i?"end":"start";break;default:o="middle";break}return o}},{key:"getTickVerticalAnchor",value:function(){var n=this.props,a=n.orientation,i=n.mirror,o="end";switch(a){case"left":case"right":o="middle";break;case"top":o=i?"start":"end";break;default:o=i?"end":"start";break}return o}},{key:"renderAxisLine",value:function(){var n=this.props,a=n.x,i=n.y,o=n.width,s=n.height,l=n.orientation,u=n.mirror,d=n.axisLine,f=Qn(Qn(Qn({},er(this.props,!1)),er(d,!1)),{},{fill:"none"});if(l==="top"||l==="bottom"){var h=+(l==="top"&&!u||l==="bottom"&&u);f=Qn(Qn({},f),{},{x1:a,y1:i+h*s,x2:a+o,y2:i+h*s})}else{var g=+(l==="left"&&!u||l==="right"&&u);f=Qn(Qn({},f),{},{x1:a+g*o,y1:i,x2:a+g*o,y2:i+s})}return oe.createElement("line",Kc({},f,{className:kr("recharts-cartesian-axis-line",Ri(d,"className"))}))}},{key:"renderTicks",value:function(n,a,i){var o=this,s=this.props,l=s.tickLine,u=s.stroke,d=s.tick,f=s.tickFormatter,h=s.unit,g=nw(Qn(Qn({},this.props),{},{ticks:n}),a,i),b=this.getTickTextAnchor(),w=this.getTickVerticalAnchor(),v=er(this.props,!1),x=er(d,!1),m=Qn(Qn({},v),{},{fill:"none"},er(l,!1)),k=g.map(function(P,j){var S=o.getTickLineCoord(P),M=S.line,O=S.tick,E=Qn(Qn(Qn(Qn({textAnchor:b,verticalAnchor:w},v),{},{stroke:"none",fill:u},x),O),{},{index:j,payload:P,visibleTicksCount:g.length,tickFormatter:f});return oe.createElement(Wr,Kc({className:"recharts-cartesian-axis-tick",key:"tick-".concat(P.value,"-").concat(P.coordinate,"-").concat(P.tickCoord)},Mf(o.props,P,j)),l&&oe.createElement("line",Kc({},m,M,{className:kr("recharts-cartesian-axis-tick-line",Ri(l,"className"))})),d&&t.renderTickItem(d,E,"".concat(tr(f)?f(P.value,j):P.value).concat(h||"")))});return oe.createElement("g",{className:"recharts-cartesian-axis-ticks"},k)}},{key:"render",value:function(){var n=this,a=this.props,i=a.axisLine,o=a.width,s=a.height,l=a.ticksGenerator,u=a.className,d=a.hide;if(d)return null;var f=this.props,h=f.ticks,g=nx(f,zre),b=h;return tr(l)&&(b=h&&h.length>0?l(this.props):l(g)),o<=0||s<=0||!b||!b.length?null:oe.createElement(Wr,{className:kr("recharts-cartesian-axis",u),ref:function(v){n.layerReference=v}},i&&this.renderAxisLine(),this.renderTicks(b,this.state.fontSize,this.state.letterSpacing),wa.renderCallByParent(this.props))}}],[{key:"renderTickItem",value:function(n,a,i){var o,s=kr(a.className,"recharts-cartesian-axis-tick-value");return oe.isValidElement(n)?o=oe.cloneElement(n,Qn(Qn({},a),{},{className:s})):tr(n)?o=n(Qn(Qn({},a),{},{className:s})):o=oe.createElement(Ip,Kc({},a,{className:"recharts-cartesian-axis-tick-value"}),i),o}}])}(_.Component);aw(od,"displayName","CartesianAxis");aw(od,"defaultProps",{x:0,y:0,width:0,height:0,viewBox:{x:0,y:0,width:0,height:0},orientation:"bottom",ticks:[],stroke:"#666",tickLine:!0,axisLine:!0,tick:!0,mirror:!1,minTickGap:5,tickSize:6,tickMargin:2,interval:"preserveEnd"});var Jre=["x1","y1","x2","y2","key"],Qre=["offset"];function hc(e){"@babel/helpers - typeof";return hc=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},hc(e)}function P4(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Ea(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?P4(Object(r),!0).forEach(function(n){ene(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):P4(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function ene(e,t,r){return t=tne(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function tne(e){var t=rne(e,"string");return hc(t)=="symbol"?t:t+""}function rne(e,t){if(hc(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(hc(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Gl(){return Gl=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Gl.apply(this,arguments)}function _4(e,t){if(e==null)return{};var r=nne(e,t),n,a;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function nne(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}var ane=function(t){var r=t.fill;if(!r||r==="none")return null;var n=t.fillOpacity,a=t.x,i=t.y,o=t.width,s=t.height,l=t.ry;return oe.createElement("rect",{x:a,y:i,ry:l,width:o,height:s,stroke:"none",fill:r,fillOpacity:n,className:"recharts-cartesian-grid-bg"})};function eO(e,t){var r;if(oe.isValidElement(e))r=oe.cloneElement(e,t);else if(tr(e))r=e(t);else{var n=t.x1,a=t.y1,i=t.x2,o=t.y2,s=t.key,l=_4(t,Jre),u=er(l,!1);u.offset;var d=_4(u,Qre);r=oe.createElement("line",Gl({},d,{x1:n,y1:a,x2:i,y2:o,fill:"none",key:s}))}return r}function ine(e){var t=e.x,r=e.width,n=e.horizontal,a=n===void 0?!0:n,i=e.horizontalPoints;if(!a||!i||!i.length)return null;var o=i.map(function(s,l){var u=Ea(Ea({},e),{},{x1:t,y1:s,x2:t+r,y2:s,key:"line-".concat(l),index:l});return eO(a,u)});return oe.createElement("g",{className:"recharts-cartesian-grid-horizontal"},o)}function one(e){var t=e.y,r=e.height,n=e.vertical,a=n===void 0?!0:n,i=e.verticalPoints;if(!a||!i||!i.length)return null;var o=i.map(function(s,l){var u=Ea(Ea({},e),{},{x1:s,y1:t,x2:s,y2:t+r,key:"line-".concat(l),index:l});return eO(a,u)});return oe.createElement("g",{className:"recharts-cartesian-grid-vertical"},o)}function sne(e){var t=e.horizontalFill,r=e.fillOpacity,n=e.x,a=e.y,i=e.width,o=e.height,s=e.horizontalPoints,l=e.horizontal,u=l===void 0?!0:l;if(!u||!t||!t.length)return null;var d=s.map(function(h){return Math.round(h+a-a)}).sort(function(h,g){return h-g});a!==d[0]&&d.unshift(0);var f=d.map(function(h,g){var b=!d[g+1],w=b?a+o-h:d[g+1]-h;if(w<=0)return null;var v=g%t.length;return oe.createElement("rect",{key:"react-".concat(g),y:h,x:n,height:w,width:i,stroke:"none",fill:t[v],fillOpacity:r,className:"recharts-cartesian-grid-bg"})});return oe.createElement("g",{className:"recharts-cartesian-gridstripes-horizontal"},f)}function lne(e){var t=e.vertical,r=t===void 0?!0:t,n=e.verticalFill,a=e.fillOpacity,i=e.x,o=e.y,s=e.width,l=e.height,u=e.verticalPoints;if(!r||!n||!n.length)return null;var d=u.map(function(h){return Math.round(h+i-i)}).sort(function(h,g){return h-g});i!==d[0]&&d.unshift(0);var f=d.map(function(h,g){var b=!d[g+1],w=b?i+s-h:d[g+1]-h;if(w<=0)return null;var v=g%n.length;return oe.createElement("rect",{key:"react-".concat(g),x:h,y:o,width:w,height:l,stroke:"none",fill:n[v],fillOpacity:a,className:"recharts-cartesian-grid-bg"})});return oe.createElement("g",{className:"recharts-cartesian-gridstripes-vertical"},f)}var cne=function(t,r){var n=t.xAxis,a=t.width,i=t.height,o=t.offset;return uN(nw(Ea(Ea(Ea({},od.defaultProps),n),{},{ticks:ns(n,!0),viewBox:{x:0,y:0,width:a,height:i}})),o.left,o.left+o.width,r)},une=function(t,r){var n=t.yAxis,a=t.width,i=t.height,o=t.offset;return uN(nw(Ea(Ea(Ea({},od.defaultProps),n),{},{ticks:ns(n,!0),viewBox:{x:0,y:0,width:a,height:i}})),o.top,o.top+o.height,r)},Ec={horizontal:!0,vertical:!0,stroke:"#ccc",fill:"none",verticalFill:[],horizontalFill:[]};function so(e){var t,r,n,a,i,o,s=ew(),l=tw(),u=Zte(),d=Ea(Ea({},e),{},{stroke:(t=e.stroke)!==null&&t!==void 0?t:Ec.stroke,fill:(r=e.fill)!==null&&r!==void 0?r:Ec.fill,horizontal:(n=e.horizontal)!==null&&n!==void 0?n:Ec.horizontal,horizontalFill:(a=e.horizontalFill)!==null&&a!==void 0?a:Ec.horizontalFill,vertical:(i=e.vertical)!==null&&i!==void 0?i:Ec.vertical,verticalFill:(o=e.verticalFill)!==null&&o!==void 0?o:Ec.verticalFill,x:Fe(e.x)?e.x:u.left,y:Fe(e.y)?e.y:u.top,width:Fe(e.width)?e.width:u.width,height:Fe(e.height)?e.height:u.height}),f=d.x,h=d.y,g=d.width,b=d.height,w=d.syncWithTicks,v=d.horizontalValues,x=d.verticalValues,m=Kte(),k=Yte();if(!Fe(g)||g<=0||!Fe(b)||b<=0||!Fe(f)||f!==+f||!Fe(h)||h!==+h)return null;var P=d.verticalCoordinatesGenerator||cne,j=d.horizontalCoordinatesGenerator||une,S=d.horizontalPoints,M=d.verticalPoints;if((!S||!S.length)&&tr(j)){var O=v&&v.length,E=j({yAxis:k?Ea(Ea({},k),{},{ticks:O?v:k.ticks}):void 0,width:s,height:l,offset:u},O?!0:w);os(Array.isArray(E),"horizontalCoordinatesGenerator should return Array but instead it returned [".concat(hc(E),"]")),Array.isArray(E)&&(S=E)}if((!M||!M.length)&&tr(P)){var I=x&&x.length,D=P({xAxis:m?Ea(Ea({},m),{},{ticks:I?x:m.ticks}):void 0,width:s,height:l,offset:u},I?!0:w);os(Array.isArray(D),"verticalCoordinatesGenerator should return Array but instead it returned [".concat(hc(D),"]")),Array.isArray(D)&&(M=D)}return oe.createElement("g",{className:"recharts-cartesian-grid"},oe.createElement(ane,{fill:d.fill,fillOpacity:d.fillOpacity,x:d.x,y:d.y,width:d.width,height:d.height,ry:d.ry}),oe.createElement(ine,Gl({},d,{offset:u,horizontalPoints:S,xAxis:m,yAxis:k})),oe.createElement(one,Gl({},d,{offset:u,verticalPoints:M,xAxis:m,yAxis:k})),oe.createElement(sne,Gl({},d,{horizontalPoints:S})),oe.createElement(lne,Gl({},d,{verticalPoints:M})))}so.displayName="CartesianGrid";var dne=["type","layout","connectNulls","ref"],fne=["key"];function Eu(e){"@babel/helpers - typeof";return Eu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Eu(e)}function C4(e,t){if(e==null)return{};var r=hne(e,t),n,a;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function hne(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function of(){return of=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},of.apply(this,arguments)}function M4(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function pi(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?M4(Object(r),!0).forEach(function(n){ro(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):M4(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Ic(e){return yne(e)||mne(e)||gne(e)||pne()}function pne(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function gne(e,t){if(e){if(typeof e=="string")return M1(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return M1(e,t)}}function mne(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function yne(e){if(Array.isArray(e))return M1(e)}function M1(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function xne(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function N4(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,rO(n.key),n)}}function vne(e,t,r){return t&&N4(e.prototype,t),r&&N4(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function bne(e,t,r){return t=gg(t),wne(e,tO()?Reflect.construct(t,r||[],gg(e).constructor):t.apply(e,r))}function wne(e,t){if(t&&(Eu(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return kne(e)}function kne(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function tO(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(tO=function(){return!!e})()}function gg(e){return gg=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},gg(e)}function Sne(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&N1(e,t)}function N1(e,t){return N1=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},N1(e,t)}function ro(e,t,r){return t=rO(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function rO(e){var t=jne(e,"string");return Eu(t)=="symbol"?t:t+""}function jne(e,t){if(Eu(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(Eu(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var En=function(e){function t(){var r;xne(this,t);for(var n=arguments.length,a=new Array(n),i=0;i<n;i++)a[i]=arguments[i];return r=bne(this,t,[].concat(a)),ro(r,"state",{isAnimationFinished:!0,totalLength:0}),ro(r,"generateSimpleStrokeDasharray",function(o,s){return"".concat(s,"px ").concat(o-s,"px")}),ro(r,"getStrokeDasharray",function(o,s,l){var u=l.reduce(function(x,m){return x+m});if(!u)return r.generateSimpleStrokeDasharray(s,o);for(var d=Math.floor(o/u),f=o%u,h=s-o,g=[],b=0,w=0;b<l.length;w+=l[b],++b)if(w+l[b]>f){g=[].concat(Ic(l.slice(0,b)),[f-w]);break}var v=g.length%2===0?[0,h]:[h];return[].concat(Ic(t.repeat(l,d)),Ic(g),v).map(function(x){return"".concat(x,"px")}).join(", ")}),ro(r,"id",xc("recharts-line-")),ro(r,"pathRef",function(o){r.mainCurve=o}),ro(r,"handleAnimationEnd",function(){r.setState({isAnimationFinished:!0}),r.props.onAnimationEnd&&r.props.onAnimationEnd()}),ro(r,"handleAnimationStart",function(){r.setState({isAnimationFinished:!1}),r.props.onAnimationStart&&r.props.onAnimationStart()}),r}return Sne(t,e),vne(t,[{key:"componentDidMount",value:function(){if(this.props.isAnimationActive){var n=this.getTotalLength();this.setState({totalLength:n})}}},{key:"componentDidUpdate",value:function(){if(this.props.isAnimationActive){var n=this.getTotalLength();n!==this.state.totalLength&&this.setState({totalLength:n})}}},{key:"getTotalLength",value:function(){var n=this.mainCurve;try{return n&&n.getTotalLength&&n.getTotalLength()||0}catch{return 0}}},{key:"renderErrorBar",value:function(n,a){if(this.props.isAnimationActive&&!this.state.isAnimationFinished)return null;var i=this.props,o=i.points,s=i.xAxis,l=i.yAxis,u=i.layout,d=i.children,f=li(d,id);if(!f)return null;var h=function(w,v){return{x:w.x,y:w.y,value:w.value,errorVal:ia(w.payload,v)}},g={clipPath:n?"url(#clipPath-".concat(a,")"):null};return oe.createElement(Wr,g,f.map(function(b){return oe.cloneElement(b,{key:"bar-".concat(b.props.dataKey),data:o,xAxis:s,yAxis:l,layout:u,dataPointFormatter:h})}))}},{key:"renderDots",value:function(n,a,i){var o=this.props.isAnimationActive;if(o&&!this.state.isAnimationFinished)return null;var s=this.props,l=s.dot,u=s.points,d=s.dataKey,f=er(this.props,!1),h=er(l,!0),g=u.map(function(w,v){var x=pi(pi(pi({key:"dot-".concat(v),r:3},f),h),{},{index:v,cx:w.x,cy:w.y,value:w.value,dataKey:d,payload:w.payload,points:u});return t.renderDotItem(l,x)}),b={clipPath:n?"url(#clipPath-".concat(a?"":"dots-").concat(i,")"):null};return oe.createElement(Wr,of({className:"recharts-line-dots",key:"dots"},b),g)}},{key:"renderCurveStatically",value:function(n,a,i,o){var s=this.props,l=s.type,u=s.layout,d=s.connectNulls;s.ref;var f=C4(s,dne),h=pi(pi(pi({},er(f,!0)),{},{fill:"none",className:"recharts-line-curve",clipPath:a?"url(#clipPath-".concat(i,")"):null,points:n},o),{},{type:l,layout:u,connectNulls:d});return oe.createElement(Kl,of({},h,{pathRef:this.pathRef}))}},{key:"renderCurveWithAnimation",value:function(n,a){var i=this,o=this.props,s=o.points,l=o.strokeDasharray,u=o.isAnimationActive,d=o.animationBegin,f=o.animationDuration,h=o.animationEasing,g=o.animationId,b=o.animateNewValues,w=o.width,v=o.height,x=this.state,m=x.prevPoints,k=x.totalLength;return oe.createElement(fo,{begin:d,duration:f,isActive:u,easing:h,from:{t:0},to:{t:1},key:"line-".concat(g),onAnimationEnd:this.handleAnimationEnd,onAnimationStart:this.handleAnimationStart},function(P){var j=P.t;if(m){var S=m.length/s.length,M=s.map(function(B,z){var Y=Math.floor(z*S);if(m[Y]){var G=m[Y],$=$n(G.x,B.x),L=$n(G.y,B.y);return pi(pi({},B),{},{x:$(j),y:L(j)})}if(b){var U=$n(w*2,B.x),V=$n(v/2,B.y);return pi(pi({},B),{},{x:U(j),y:V(j)})}return pi(pi({},B),{},{x:B.x,y:B.y})});return i.renderCurveStatically(M,n,a)}var O=$n(0,k),E=O(j),I;if(l){var D="".concat(l).split(/[,\s]+/gim).map(function(B){return parseFloat(B)});I=i.getStrokeDasharray(E,k,D)}else I=i.generateSimpleStrokeDasharray(k,E);return i.renderCurveStatically(s,n,a,{strokeDasharray:I})})}},{key:"renderCurve",value:function(n,a){var i=this.props,o=i.points,s=i.isAnimationActive,l=this.state,u=l.prevPoints,d=l.totalLength;return s&&o&&o.length&&(!u&&d>0||!uc(u,o))?this.renderCurveWithAnimation(n,a):this.renderCurveStatically(o,n,a)}},{key:"render",value:function(){var n,a=this.props,i=a.hide,o=a.dot,s=a.points,l=a.className,u=a.xAxis,d=a.yAxis,f=a.top,h=a.left,g=a.width,b=a.height,w=a.isAnimationActive,v=a.id;if(i||!s||!s.length)return null;var x=this.state.isAnimationFinished,m=s.length===1,k=kr("recharts-line",l),P=u&&u.allowDataOverflow,j=d&&d.allowDataOverflow,S=P||j,M=Zt(v)?this.id:v,O=(n=er(o,!1))!==null&&n!==void 0?n:{r:3,strokeWidth:2},E=O.r,I=E===void 0?3:E,D=O.strokeWidth,B=D===void 0?2:D,z=aC(o)?o:{},Y=z.clipDot,G=Y===void 0?!0:Y,$=I*2+B;return oe.createElement(Wr,{className:k},P||j?oe.createElement("defs",null,oe.createElement("clipPath",{id:"clipPath-".concat(M)},oe.createElement("rect",{x:P?h:h-g/2,y:j?f:f-b/2,width:P?g:g*2,height:j?b:b*2})),!G&&oe.createElement("clipPath",{id:"clipPath-dots-".concat(M)},oe.createElement("rect",{x:h-$/2,y:f-$/2,width:g+$,height:b+$}))):null,!m&&this.renderCurve(S,M),this.renderErrorBar(S,M),(m||o)&&this.renderDots(S,G,M),(!w||x)&&Io.renderCallByParent(this.props,s))}}],[{key:"getDerivedStateFromProps",value:function(n,a){return n.animationId!==a.prevAnimationId?{prevAnimationId:n.animationId,curPoints:n.points,prevPoints:a.curPoints}:n.points!==a.curPoints?{curPoints:n.points}:null}},{key:"repeat",value:function(n,a){for(var i=n.length%2!==0?[].concat(Ic(n),[0]):n,o=[],s=0;s<a;++s)o=[].concat(Ic(o),Ic(i));return o}},{key:"renderDotItem",value:function(n,a){var i;if(oe.isValidElement(n))i=oe.cloneElement(n,a);else if(tr(n))i=n(a);else{var o=a.key,s=C4(a,fne),l=kr("recharts-line-dot",typeof n!="boolean"?n.className:"");i=oe.createElement(jm,of({key:o},s,{className:l}))}return i}}])}(_.PureComponent);ro(En,"displayName","Line");ro(En,"defaultProps",{xAxisId:0,yAxisId:0,connectNulls:!1,activeDot:!0,dot:!0,legendType:"line",stroke:"#3182bd",strokeWidth:1,fill:"#fff",points:[],isAnimationActive:!fl.isSsr,animateNewValues:!0,animationBegin:0,animationDuration:1500,animationEasing:"ease",hide:!1,label:!1});ro(En,"getComposedData",function(e){var t=e.props,r=e.xAxis,n=e.yAxis,a=e.xAxisTicks,i=e.yAxisTicks,o=e.dataKey,s=e.bandSize,l=e.displayedData,u=e.offset,d=t.layout,f=l.map(function(h,g){var b=ia(h,o);return d==="horizontal"?{x:ju({axis:r,ticks:a,bandSize:s,entry:h,index:g}),y:Zt(b)?null:n.scale(b),value:b,payload:h}:{x:Zt(b)?null:r.scale(b),y:ju({axis:n,ticks:i,bandSize:s,entry:h,index:g}),value:b,payload:h}});return pi({points:f,layout:d},u)});var Pne=["layout","type","stroke","connectNulls","isRange","ref"],_ne=["key"],nO;function Iu(e){"@babel/helpers - typeof";return Iu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Iu(e)}function aO(e,t){if(e==null)return{};var r=Cne(e,t),n,a;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function Cne(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function Ul(){return Ul=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Ul.apply(this,arguments)}function O4(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Ms(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?O4(Object(r),!0).forEach(function(n){Mo(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):O4(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Mne(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function A4(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,oO(n.key),n)}}function Nne(e,t,r){return t&&A4(e.prototype,t),r&&A4(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function One(e,t,r){return t=mg(t),Ane(e,iO()?Reflect.construct(t,r||[],mg(e).constructor):t.apply(e,r))}function Ane(e,t){if(t&&(Iu(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Tne(e)}function Tne(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function iO(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(iO=function(){return!!e})()}function mg(e){return mg=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},mg(e)}function Ene(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&O1(e,t)}function O1(e,t){return O1=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},O1(e,t)}function Mo(e,t,r){return t=oO(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function oO(e){var t=Ine(e,"string");return Iu(t)=="symbol"?t:t+""}function Ine(e,t){if(Iu(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(Iu(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var $i=function(e){function t(){var r;Mne(this,t);for(var n=arguments.length,a=new Array(n),i=0;i<n;i++)a[i]=arguments[i];return r=One(this,t,[].concat(a)),Mo(r,"state",{isAnimationFinished:!0}),Mo(r,"id",xc("recharts-area-")),Mo(r,"handleAnimationEnd",function(){var o=r.props.onAnimationEnd;r.setState({isAnimationFinished:!0}),tr(o)&&o()}),Mo(r,"handleAnimationStart",function(){var o=r.props.onAnimationStart;r.setState({isAnimationFinished:!1}),tr(o)&&o()}),r}return Ene(t,e),Nne(t,[{key:"renderDots",value:function(n,a,i){var o=this.props.isAnimationActive,s=this.state.isAnimationFinished;if(o&&!s)return null;var l=this.props,u=l.dot,d=l.points,f=l.dataKey,h=er(this.props,!1),g=er(u,!0),b=d.map(function(v,x){var m=Ms(Ms(Ms({key:"dot-".concat(x),r:3},h),g),{},{index:x,cx:v.x,cy:v.y,dataKey:f,value:v.value,payload:v.payload,points:d});return t.renderDotItem(u,m)}),w={clipPath:n?"url(#clipPath-".concat(a?"":"dots-").concat(i,")"):null};return oe.createElement(Wr,Ul({className:"recharts-area-dots"},w),b)}},{key:"renderHorizontalRect",value:function(n){var a=this.props,i=a.baseLine,o=a.points,s=a.strokeWidth,l=o[0].x,u=o[o.length-1].x,d=n*Math.abs(l-u),f=Us(o.map(function(h){return h.y||0}));return Fe(i)&&typeof i=="number"?f=Math.max(i,f):i&&Array.isArray(i)&&i.length&&(f=Math.max(Us(i.map(function(h){return h.y||0})),f)),Fe(f)?oe.createElement("rect",{x:l<u?l:l-d,y:0,width:d,height:Math.floor(f+(s?parseInt("".concat(s),10):1))}):null}},{key:"renderVerticalRect",value:function(n){var a=this.props,i=a.baseLine,o=a.points,s=a.strokeWidth,l=o[0].y,u=o[o.length-1].y,d=n*Math.abs(l-u),f=Us(o.map(function(h){return h.x||0}));return Fe(i)&&typeof i=="number"?f=Math.max(i,f):i&&Array.isArray(i)&&i.length&&(f=Math.max(Us(i.map(function(h){return h.x||0})),f)),Fe(f)?oe.createElement("rect",{x:0,y:l<u?l:l-d,width:f+(s?parseInt("".concat(s),10):1),height:Math.floor(d)}):null}},{key:"renderClipRect",value:function(n){var a=this.props.layout;return a==="vertical"?this.renderVerticalRect(n):this.renderHorizontalRect(n)}},{key:"renderAreaStatically",value:function(n,a,i,o){var s=this.props,l=s.layout,u=s.type,d=s.stroke,f=s.connectNulls,h=s.isRange;s.ref;var g=aO(s,Pne);return oe.createElement(Wr,{clipPath:i?"url(#clipPath-".concat(o,")"):null},oe.createElement(Kl,Ul({},er(g,!0),{points:n,connectNulls:f,type:u,baseLine:a,layout:l,stroke:"none",className:"recharts-area-area"})),d!=="none"&&oe.createElement(Kl,Ul({},er(this.props,!1),{className:"recharts-area-curve",layout:l,type:u,connectNulls:f,fill:"none",points:n})),d!=="none"&&h&&oe.createElement(Kl,Ul({},er(this.props,!1),{className:"recharts-area-curve",layout:l,type:u,connectNulls:f,fill:"none",points:a})))}},{key:"renderAreaWithAnimation",value:function(n,a){var i=this,o=this.props,s=o.points,l=o.baseLine,u=o.isAnimationActive,d=o.animationBegin,f=o.animationDuration,h=o.animationEasing,g=o.animationId,b=this.state,w=b.prevPoints,v=b.prevBaseLine;return oe.createElement(fo,{begin:d,duration:f,isActive:u,easing:h,from:{t:0},to:{t:1},key:"area-".concat(g),onAnimationEnd:this.handleAnimationEnd,onAnimationStart:this.handleAnimationStart},function(x){var m=x.t;if(w){var k=w.length/s.length,P=s.map(function(O,E){var I=Math.floor(E*k);if(w[I]){var D=w[I],B=$n(D.x,O.x),z=$n(D.y,O.y);return Ms(Ms({},O),{},{x:B(m),y:z(m)})}return O}),j;if(Fe(l)&&typeof l=="number"){var S=$n(v,l);j=S(m)}else if(Zt(l)||Ju(l)){var M=$n(v,0);j=M(m)}else j=l.map(function(O,E){var I=Math.floor(E*k);if(v[I]){var D=v[I],B=$n(D.x,O.x),z=$n(D.y,O.y);return Ms(Ms({},O),{},{x:B(m),y:z(m)})}return O});return i.renderAreaStatically(P,j,n,a)}return oe.createElement(Wr,null,oe.createElement("defs",null,oe.createElement("clipPath",{id:"animationClipPath-".concat(a)},i.renderClipRect(m))),oe.createElement(Wr,{clipPath:"url(#animationClipPath-".concat(a,")")},i.renderAreaStatically(s,l,n,a)))})}},{key:"renderArea",value:function(n,a){var i=this.props,o=i.points,s=i.baseLine,l=i.isAnimationActive,u=this.state,d=u.prevPoints,f=u.prevBaseLine,h=u.totalLength;return l&&o&&o.length&&(!d&&h>0||!uc(d,o)||!uc(f,s))?this.renderAreaWithAnimation(n,a):this.renderAreaStatically(o,s,n,a)}},{key:"render",value:function(){var n,a=this.props,i=a.hide,o=a.dot,s=a.points,l=a.className,u=a.top,d=a.left,f=a.xAxis,h=a.yAxis,g=a.width,b=a.height,w=a.isAnimationActive,v=a.id;if(i||!s||!s.length)return null;var x=this.state.isAnimationFinished,m=s.length===1,k=kr("recharts-area",l),P=f&&f.allowDataOverflow,j=h&&h.allowDataOverflow,S=P||j,M=Zt(v)?this.id:v,O=(n=er(o,!1))!==null&&n!==void 0?n:{r:3,strokeWidth:2},E=O.r,I=E===void 0?3:E,D=O.strokeWidth,B=D===void 0?2:D,z=aC(o)?o:{},Y=z.clipDot,G=Y===void 0?!0:Y,$=I*2+B;return oe.createElement(Wr,{className:k},P||j?oe.createElement("defs",null,oe.createElement("clipPath",{id:"clipPath-".concat(M)},oe.createElement("rect",{x:P?d:d-g/2,y:j?u:u-b/2,width:P?g:g*2,height:j?b:b*2})),!G&&oe.createElement("clipPath",{id:"clipPath-dots-".concat(M)},oe.createElement("rect",{x:d-$/2,y:u-$/2,width:g+$,height:b+$}))):null,m?null:this.renderArea(S,M),(o||m)&&this.renderDots(S,G,M),(!w||x)&&Io.renderCallByParent(this.props,s))}}],[{key:"getDerivedStateFromProps",value:function(n,a){return n.animationId!==a.prevAnimationId?{prevAnimationId:n.animationId,curPoints:n.points,curBaseLine:n.baseLine,prevPoints:a.curPoints,prevBaseLine:a.curBaseLine}:n.points!==a.curPoints||n.baseLine!==a.curBaseLine?{curPoints:n.points,curBaseLine:n.baseLine}:null}}])}(_.PureComponent);nO=$i;Mo($i,"displayName","Area");Mo($i,"defaultProps",{stroke:"#3182bd",fill:"#3182bd",fillOpacity:.6,xAxisId:0,yAxisId:0,legendType:"line",connectNulls:!1,points:[],dot:!1,activeDot:!0,hide:!1,isAnimationActive:!fl.isSsr,animationBegin:0,animationDuration:1500,animationEasing:"ease"});Mo($i,"getBaseValue",function(e,t,r,n){var a=e.layout,i=e.baseValue,o=t.props.baseValue,s=o??i;if(Fe(s)&&typeof s=="number")return s;var l=a==="horizontal"?n:r,u=l.scale.domain();if(l.type==="number"){var d=Math.max(u[0],u[1]),f=Math.min(u[0],u[1]);return s==="dataMin"?f:s==="dataMax"||d<0?d:Math.max(Math.min(u[0],u[1]),0)}return s==="dataMin"?u[0]:s==="dataMax"?u[1]:u[0]});Mo($i,"getComposedData",function(e){var t=e.props,r=e.item,n=e.xAxis,a=e.yAxis,i=e.xAxisTicks,o=e.yAxisTicks,s=e.bandSize,l=e.dataKey,u=e.stackedData,d=e.dataStartIndex,f=e.displayedData,h=e.offset,g=t.layout,b=u&&u.length,w=nO.getBaseValue(t,r,n,a),v=g==="horizontal",x=!1,m=f.map(function(P,j){var S;b?S=u[d+j]:(S=ia(P,l),Array.isArray(S)?x=!0:S=[w,S]);var M=S[1]==null||b&&ia(P,l)==null;return v?{x:ju({axis:n,ticks:i,bandSize:s,entry:P,index:j}),y:M?null:a.scale(S[1]),value:S,payload:P}:{x:M?null:n.scale(S[1]),y:ju({axis:a,ticks:o,bandSize:s,entry:P,index:j}),value:S,payload:P}}),k;return b||x?k=m.map(function(P){var j=Array.isArray(P.value)?P.value[0]:null;return v?{x:P.x,y:j!=null&&P.y!=null?a.scale(j):null}:{x:j!=null?n.scale(j):null,y:P.y}}):k=v?a.scale(w):n.scale(w),Ms({points:m,baseLine:k,layout:g,isRange:x},h)});Mo($i,"renderDotItem",function(e,t){var r;if(oe.isValidElement(e))r=oe.cloneElement(e,t);else if(tr(e))r=e(t);else{var n=kr("recharts-area-dot",typeof e!="boolean"?e.className:""),a=t.key,i=aO(t,_ne);r=oe.createElement(jm,Ul({},i,{key:a,className:n}))}return r});function $u(e){"@babel/helpers - typeof";return $u=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},$u(e)}function $ne(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Dne(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,cO(n.key),n)}}function Rne(e,t,r){return t&&Dne(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function Bne(e,t,r){return t=yg(t),Lne(e,sO()?Reflect.construct(t,r||[],yg(e).constructor):t.apply(e,r))}function Lne(e,t){if(t&&($u(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Fne(e)}function Fne(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function sO(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(sO=function(){return!!e})()}function yg(e){return yg=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},yg(e)}function Gne(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&A1(e,t)}function A1(e,t){return A1=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},A1(e,t)}function lO(e,t,r){return t=cO(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function cO(e){var t=Une(e,"string");return $u(t)=="symbol"?t:t+""}function Une(e,t){if($u(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if($u(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var Om=function(e){function t(){return $ne(this,t),Bne(this,t,arguments)}return Gne(t,e),Rne(t,[{key:"render",value:function(){return null}}])}(_.Component);lO(Om,"displayName","ZAxis");lO(Om,"defaultProps",{zAxisId:0,range:[64,64],scale:"auto",type:"number"});var zne=["option","isActive"];function sf(){return sf=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},sf.apply(this,arguments)}function Wne(e,t){if(e==null)return{};var r=Hne(e,t),n,a;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function Hne(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function Vne(e){var t=e.option,r=e.isActive,n=Wne(e,zne);return typeof t=="string"?_.createElement(y1,sf({option:_.createElement(dm,sf({type:t},n)),isActive:r,shapeType:"symbols"},n)):_.createElement(y1,sf({option:t,isActive:r,shapeType:"symbols"},n))}function Du(e){"@babel/helpers - typeof";return Du=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Du(e)}function lf(){return lf=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},lf.apply(this,arguments)}function T4(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Oi(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?T4(Object(r),!0).forEach(function(n){Hs(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):T4(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Xne(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function E4(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,dO(n.key),n)}}function Kne(e,t,r){return t&&E4(e.prototype,t),r&&E4(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Yne(e,t,r){return t=xg(t),qne(e,uO()?Reflect.construct(t,r||[],xg(e).constructor):t.apply(e,r))}function qne(e,t){if(t&&(Du(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Zne(e)}function Zne(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function uO(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(uO=function(){return!!e})()}function xg(e){return xg=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},xg(e)}function Jne(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&T1(e,t)}function T1(e,t){return T1=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},T1(e,t)}function Hs(e,t,r){return t=dO(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function dO(e){var t=Qne(e,"string");return Du(t)=="symbol"?t:t+""}function Qne(e,t){if(Du(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(Du(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var za=function(e){function t(){var r;Xne(this,t);for(var n=arguments.length,a=new Array(n),i=0;i<n;i++)a[i]=arguments[i];return r=Yne(this,t,[].concat(a)),Hs(r,"state",{isAnimationFinished:!1}),Hs(r,"handleAnimationEnd",function(){r.setState({isAnimationFinished:!0})}),Hs(r,"handleAnimationStart",function(){r.setState({isAnimationFinished:!1})}),Hs(r,"id",xc("recharts-scatter-")),r}return Jne(t,e),Kne(t,[{key:"renderSymbolsStatically",value:function(n){var a=this,i=this.props,o=i.shape,s=i.activeShape,l=i.activeIndex,u=er(this.props,!1);return n.map(function(d,f){var h=l===f,g=h?s:o,b=Oi(Oi({},u),d);return oe.createElement(Wr,lf({className:"recharts-scatter-symbol",key:"symbol-".concat(d==null?void 0:d.cx,"-").concat(d==null?void 0:d.cy,"-").concat(d==null?void 0:d.size,"-").concat(f)},Mf(a.props,d,f),{role:"img"}),oe.createElement(Vne,lf({option:g,isActive:h,key:"symbol-".concat(f)},b)))})}},{key:"renderSymbolsWithAnimation",value:function(){var n=this,a=this.props,i=a.points,o=a.isAnimationActive,s=a.animationBegin,l=a.animationDuration,u=a.animationEasing,d=a.animationId,f=this.state.prevPoints;return oe.createElement(fo,{begin:s,duration:l,isActive:o,easing:u,from:{t:0},to:{t:1},key:"pie-".concat(d),onAnimationEnd:this.handleAnimationEnd,onAnimationStart:this.handleAnimationStart},function(h){var g=h.t,b=i.map(function(w,v){var x=f&&f[v];if(x){var m=$n(x.cx,w.cx),k=$n(x.cy,w.cy),P=$n(x.size,w.size);return Oi(Oi({},w),{},{cx:m(g),cy:k(g),size:P(g)})}var j=$n(0,w.size);return Oi(Oi({},w),{},{size:j(g)})});return oe.createElement(Wr,null,n.renderSymbolsStatically(b))})}},{key:"renderSymbols",value:function(){var n=this.props,a=n.points,i=n.isAnimationActive,o=this.state.prevPoints;return i&&a&&a.length&&(!o||!uc(o,a))?this.renderSymbolsWithAnimation():this.renderSymbolsStatically(a)}},{key:"renderErrorBar",value:function(){var n=this.props.isAnimationActive;if(n&&!this.state.isAnimationFinished)return null;var a=this.props,i=a.points,o=a.xAxis,s=a.yAxis,l=a.children,u=li(l,id);return u?u.map(function(d,f){var h=d.props,g=h.direction,b=h.dataKey;return oe.cloneElement(d,{key:"".concat(g,"-").concat(b,"-").concat(i[f]),data:i,xAxis:o,yAxis:s,layout:g==="x"?"vertical":"horizontal",dataPointFormatter:function(v,x){return{x:v.cx,y:v.cy,value:g==="x"?+v.node.x:+v.node.y,errorVal:ia(v,x)}}})}):null}},{key:"renderLine",value:function(){var n=this.props,a=n.points,i=n.line,o=n.lineType,s=n.lineJointType,l=er(this.props,!1),u=er(i,!1),d,f;if(o==="joint")d=a.map(function(k){return{x:k.cx,y:k.cy}});else if(o==="fitting"){var h=CD(a),g=h.xmin,b=h.xmax,w=h.a,v=h.b,x=function(P){return w*P+v};d=[{x:g,y:x(g)},{x:b,y:x(b)}]}var m=Oi(Oi(Oi({},l),{},{fill:"none",stroke:l&&l.fill},u),{},{points:d});return oe.isValidElement(i)?f=oe.cloneElement(i,m):tr(i)?f=i(m):f=oe.createElement(Kl,lf({},m,{type:s})),oe.createElement(Wr,{className:"recharts-scatter-line",key:"recharts-scatter-line"},f)}},{key:"render",value:function(){var n=this.props,a=n.hide,i=n.points,o=n.line,s=n.className,l=n.xAxis,u=n.yAxis,d=n.left,f=n.top,h=n.width,g=n.height,b=n.id,w=n.isAnimationActive;if(a||!i||!i.length)return null;var v=this.state.isAnimationFinished,x=kr("recharts-scatter",s),m=l&&l.allowDataOverflow,k=u&&u.allowDataOverflow,P=m||k,j=Zt(b)?this.id:b;return oe.createElement(Wr,{className:x,clipPath:P?"url(#clipPath-".concat(j,")"):null},m||k?oe.createElement("defs",null,oe.createElement("clipPath",{id:"clipPath-".concat(j)},oe.createElement("rect",{x:m?d:d-h/2,y:k?f:f-g/2,width:m?h:h*2,height:k?g:g*2}))):null,o&&this.renderLine(),this.renderErrorBar(),oe.createElement(Wr,{key:"recharts-scatter-symbols"},this.renderSymbols()),(!w||v)&&Io.renderCallByParent(this.props,i))}}],[{key:"getDerivedStateFromProps",value:function(n,a){return n.animationId!==a.prevAnimationId?{prevAnimationId:n.animationId,curPoints:n.points,prevPoints:a.curPoints}:n.points!==a.curPoints?{curPoints:n.points}:null}}])}(_.PureComponent);Hs(za,"displayName","Scatter");Hs(za,"defaultProps",{xAxisId:0,yAxisId:0,zAxisId:0,legendType:"circle",lineType:"joint",lineJointType:"linear",data:[],shape:"circle",hide:!1,isAnimationActive:!fl.isSsr,animationBegin:0,animationDuration:400,animationEasing:"linear"});Hs(za,"getComposedData",function(e){var t=e.xAxis,r=e.yAxis,n=e.zAxis,a=e.item,i=e.displayedData,o=e.xAxisTicks,s=e.yAxisTicks,l=e.offset,u=a.props.tooltipType,d=li(a.props.children,S2),f=Zt(t.dataKey)?a.props.dataKey:t.dataKey,h=Zt(r.dataKey)?a.props.dataKey:r.dataKey,g=n&&n.dataKey,b=n?n.range:Om.defaultProps.range,w=b&&b[0],v=t.scale.bandwidth?t.scale.bandwidth():0,x=r.scale.bandwidth?r.scale.bandwidth():0,m=i.map(function(k,P){var j=ia(k,f),S=ia(k,h),M=!Zt(g)&&ia(k,g)||"-",O=[{name:Zt(t.dataKey)?a.props.name:t.name||t.dataKey,unit:t.unit||"",value:j,payload:k,dataKey:f,type:u},{name:Zt(r.dataKey)?a.props.name:r.name||r.dataKey,unit:r.unit||"",value:S,payload:k,dataKey:h,type:u}];M!=="-"&&O.push({name:n.name||n.dataKey,unit:n.unit||"",value:M,payload:k,dataKey:g,type:u});var E=ju({axis:t,ticks:o,bandSize:v,entry:k,index:P,dataKey:f}),I=ju({axis:r,ticks:s,bandSize:x,entry:k,index:P,dataKey:h}),D=M!=="-"?n.scale(M):w,B=Math.sqrt(Math.max(D,0)/Math.PI);return Oi(Oi({},k),{},{cx:E,cy:I,x:E-B,y:I-B,xAxis:t,yAxis:r,zAxis:n,width:2*B,height:2*B,size:D,node:{x:j,y:S,z:M},tooltipPayload:O,tooltipPosition:{x:E,y:I},payload:k},d&&d[P]&&d[P].props)});return Oi({points:m},l)});function Ru(e){"@babel/helpers - typeof";return Ru=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ru(e)}function eae(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function tae(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,pO(n.key),n)}}function rae(e,t,r){return t&&tae(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function nae(e,t,r){return t=vg(t),aae(e,fO()?Reflect.construct(t,r||[],vg(e).constructor):t.apply(e,r))}function aae(e,t){if(t&&(Ru(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return iae(e)}function iae(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function fO(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(fO=function(){return!!e})()}function vg(e){return vg=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},vg(e)}function oae(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&E1(e,t)}function E1(e,t){return E1=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},E1(e,t)}function hO(e,t,r){return t=pO(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function pO(e){var t=sae(e,"string");return Ru(t)=="symbol"?t:t+""}function sae(e,t){if(Ru(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(Ru(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}function I1(){return I1=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},I1.apply(this,arguments)}function lae(e){var t=e.xAxisId,r=ew(),n=tw(),a=zN(t);return a==null?null:_.createElement(od,I1({},a,{className:kr("recharts-".concat(a.axisType," ").concat(a.axisType),a.className),viewBox:{x:0,y:0,width:r,height:n},ticksGenerator:function(o){return ns(o,!0)}}))}var Xa=function(e){function t(){return eae(this,t),nae(this,t,arguments)}return oae(t,e),rae(t,[{key:"render",value:function(){return _.createElement(lae,this.props)}}])}(_.Component);hO(Xa,"displayName","XAxis");hO(Xa,"defaultProps",{allowDecimals:!0,hide:!1,orientation:"bottom",width:0,height:30,mirror:!1,xAxisId:0,tickCount:5,type:"category",padding:{left:0,right:0},allowDataOverflow:!1,scale:"auto",reversed:!1,allowDuplicatedCategory:!0});function Bu(e){"@babel/helpers - typeof";return Bu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Bu(e)}function cae(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function uae(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,yO(n.key),n)}}function dae(e,t,r){return t&&uae(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function fae(e,t,r){return t=bg(t),hae(e,gO()?Reflect.construct(t,r||[],bg(e).constructor):t.apply(e,r))}function hae(e,t){if(t&&(Bu(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return pae(e)}function pae(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function gO(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(gO=function(){return!!e})()}function bg(e){return bg=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},bg(e)}function gae(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&$1(e,t)}function $1(e,t){return $1=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},$1(e,t)}function mO(e,t,r){return t=yO(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function yO(e){var t=mae(e,"string");return Bu(t)=="symbol"?t:t+""}function mae(e,t){if(Bu(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(Bu(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}function D1(){return D1=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},D1.apply(this,arguments)}var yae=function(t){var r=t.yAxisId,n=ew(),a=tw(),i=WN(r);return i==null?null:_.createElement(od,D1({},i,{className:kr("recharts-".concat(i.axisType," ").concat(i.axisType),i.className),viewBox:{x:0,y:0,width:n,height:a},ticksGenerator:function(s){return ns(s,!0)}}))},Ka=function(e){function t(){return cae(this,t),fae(this,t,arguments)}return gae(t,e),dae(t,[{key:"render",value:function(){return _.createElement(yae,this.props)}}])}(_.Component);mO(Ka,"displayName","YAxis");mO(Ka,"defaultProps",{allowDuplicatedCategory:!0,allowDecimals:!0,hide:!1,orientation:"left",width:60,height:0,mirror:!1,yAxisId:0,tickCount:5,type:"number",padding:{top:0,bottom:0},allowDataOverflow:!1,scale:"auto",reversed:!1});function I4(e){return wae(e)||bae(e)||vae(e)||xae()}function xae(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function vae(e,t){if(e){if(typeof e=="string")return R1(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return R1(e,t)}}function bae(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function wae(e){if(Array.isArray(e))return R1(e)}function R1(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var B1=function(t,r,n,a,i){var o=li(t,Ws),s=li(t,j0),l=[].concat(I4(o),I4(s)),u=li(t,P0),d="".concat(a,"Id"),f=a[0],h=r;if(l.length&&(h=l.reduce(function(w,v){if(v.props[d]===n&&$o(v.props,"extendDomain")&&Fe(v.props[f])){var x=v.props[f];return[Math.min(w[0],x),Math.max(w[1],x)]}return w},h)),u.length){var g="".concat(f,"1"),b="".concat(f,"2");h=u.reduce(function(w,v){if(v.props[d]===n&&$o(v.props,"extendDomain")&&Fe(v.props[g])&&Fe(v.props[b])){var x=v.props[g],m=v.props[b];return[Math.min(w[0],x,m),Math.max(w[1],x,m)]}return w},h)}return i&&i.length&&(h=i.reduce(function(w,v){return Fe(v)?[Math.min(w[0],v),Math.max(w[1],v)]:w},h)),h},xO={exports:{}};(function(e){var t=Object.prototype.hasOwnProperty,r="~";function n(){}Object.create&&(n.prototype=Object.create(null),new n().__proto__||(r=!1));function a(l,u,d){this.fn=l,this.context=u,this.once=d||!1}function i(l,u,d,f,h){if(typeof d!="function")throw new TypeError("The listener must be a function");var g=new a(d,f||l,h),b=r?r+u:u;return l._events[b]?l._events[b].fn?l._events[b]=[l._events[b],g]:l._events[b].push(g):(l._events[b]=g,l._eventsCount++),l}function o(l,u){--l._eventsCount===0?l._events=new n:delete l._events[u]}function s(){this._events=new n,this._eventsCount=0}s.prototype.eventNames=function(){var u=[],d,f;if(this._eventsCount===0)return u;for(f in d=this._events)t.call(d,f)&&u.push(r?f.slice(1):f);return Object.getOwnPropertySymbols?u.concat(Object.getOwnPropertySymbols(d)):u},s.prototype.listeners=function(u){var d=r?r+u:u,f=this._events[d];if(!f)return[];if(f.fn)return[f.fn];for(var h=0,g=f.length,b=new Array(g);h<g;h++)b[h]=f[h].fn;return b},s.prototype.listenerCount=function(u){var d=r?r+u:u,f=this._events[d];return f?f.fn?1:f.length:0},s.prototype.emit=function(u,d,f,h,g,b){var w=r?r+u:u;if(!this._events[w])return!1;var v=this._events[w],x=arguments.length,m,k;if(v.fn){switch(v.once&&this.removeListener(u,v.fn,void 0,!0),x){case 1:return v.fn.call(v.context),!0;case 2:return v.fn.call(v.context,d),!0;case 3:return v.fn.call(v.context,d,f),!0;case 4:return v.fn.call(v.context,d,f,h),!0;case 5:return v.fn.call(v.context,d,f,h,g),!0;case 6:return v.fn.call(v.context,d,f,h,g,b),!0}for(k=1,m=new Array(x-1);k<x;k++)m[k-1]=arguments[k];v.fn.apply(v.context,m)}else{var P=v.length,j;for(k=0;k<P;k++)switch(v[k].once&&this.removeListener(u,v[k].fn,void 0,!0),x){case 1:v[k].fn.call(v[k].context);break;case 2:v[k].fn.call(v[k].context,d);break;case 3:v[k].fn.call(v[k].context,d,f);break;case 4:v[k].fn.call(v[k].context,d,f,h);break;default:if(!m)for(j=1,m=new Array(x-1);j<x;j++)m[j-1]=arguments[j];v[k].fn.apply(v[k].context,m)}}return!0},s.prototype.on=function(u,d,f){return i(this,u,d,f,!1)},s.prototype.once=function(u,d,f){return i(this,u,d,f,!0)},s.prototype.removeListener=function(u,d,f,h){var g=r?r+u:u;if(!this._events[g])return this;if(!d)return o(this,g),this;var b=this._events[g];if(b.fn)b.fn===d&&(!h||b.once)&&(!f||b.context===f)&&o(this,g);else{for(var w=0,v=[],x=b.length;w<x;w++)(b[w].fn!==d||h&&!b[w].once||f&&b[w].context!==f)&&v.push(b[w]);v.length?this._events[g]=v.length===1?v[0]:v:o(this,g)}return this},s.prototype.removeAllListeners=function(u){var d;return u?(d=r?r+u:u,this._events[d]&&o(this,d)):(this._events=new n,this._eventsCount=0),this},s.prototype.off=s.prototype.removeListener,s.prototype.addListener=s.prototype.on,s.prefixed=r,s.EventEmitter=s,e.exports=s})(xO);var kae=xO.exports;const Sae=on(kae);var ax=new Sae,ix="recharts.syncMouseEvents";function l0(e){"@babel/helpers - typeof";return l0=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},l0(e)}function jae(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Pae(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,vO(n.key),n)}}function _ae(e,t,r){return t&&Pae(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function ox(e,t,r){return t=vO(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function vO(e){var t=Cae(e,"string");return l0(t)=="symbol"?t:t+""}function Cae(e,t){if(l0(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(l0(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var Mae=function(){function e(){jae(this,e),ox(this,"activeIndex",0),ox(this,"coordinateList",[]),ox(this,"layout","horizontal")}return _ae(e,[{key:"setDetails",value:function(r){var n,a=r.coordinateList,i=a===void 0?null:a,o=r.container,s=o===void 0?null:o,l=r.layout,u=l===void 0?null:l,d=r.offset,f=d===void 0?null:d,h=r.mouseHandlerCallback,g=h===void 0?null:h;this.coordinateList=(n=i??this.coordinateList)!==null&&n!==void 0?n:[],this.container=s??this.container,this.layout=u??this.layout,this.offset=f??this.offset,this.mouseHandlerCallback=g??this.mouseHandlerCallback,this.activeIndex=Math.min(Math.max(this.activeIndex,0),this.coordinateList.length-1)}},{key:"focus",value:function(){this.spoofMouse()}},{key:"keyboardEvent",value:function(r){if(this.coordinateList.length!==0)switch(r.key){case"ArrowRight":{if(this.layout!=="horizontal")return;this.activeIndex=Math.min(this.activeIndex+1,this.coordinateList.length-1),this.spoofMouse();break}case"ArrowLeft":{if(this.layout!=="horizontal")return;this.activeIndex=Math.max(this.activeIndex-1,0),this.spoofMouse();break}}}},{key:"setIndex",value:function(r){this.activeIndex=r}},{key:"spoofMouse",value:function(){var r,n;if(this.layout==="horizontal"&&this.coordinateList.length!==0){var a=this.container.getBoundingClientRect(),i=a.x,o=a.y,s=a.height,l=this.coordinateList[this.activeIndex].coordinate,u=((r=window)===null||r===void 0?void 0:r.scrollX)||0,d=((n=window)===null||n===void 0?void 0:n.scrollY)||0,f=i+l+u,h=o+this.offset.top+s/2+d;this.mouseHandlerCallback({pageX:f,pageY:h})}}}])}();function Nae(e,t,r){if(r==="number"&&t===!0&&Array.isArray(e)){var n=e==null?void 0:e[0],a=e==null?void 0:e[1];if(n&&a&&Fe(n)&&Fe(a))return!0}return!1}function Oae(e,t,r,n){var a=n/2;return{stroke:"none",fill:"#ccc",x:e==="horizontal"?t.x-a:r.left+.5,y:e==="horizontal"?r.top+.5:t.y-a,width:e==="horizontal"?n:r.width-1,height:e==="horizontal"?r.height-1:n}}function bO(e){var t=e.cx,r=e.cy,n=e.radius,a=e.startAngle,i=e.endAngle,o=ka(t,r,n,a),s=ka(t,r,n,i);return{points:[o,s],cx:t,cy:r,radius:n,startAngle:a,endAngle:i}}function Aae(e,t,r){var n,a,i,o;if(e==="horizontal")n=t.x,i=n,a=r.top,o=r.top+r.height;else if(e==="vertical")a=t.y,o=a,n=r.left,i=r.left+r.width;else if(t.cx!=null&&t.cy!=null)if(e==="centric"){var s=t.cx,l=t.cy,u=t.innerRadius,d=t.outerRadius,f=t.angle,h=ka(s,l,u,f),g=ka(s,l,d,f);n=h.x,a=h.y,i=g.x,o=g.y}else return bO(t);return[{x:n,y:a},{x:i,y:o}]}function c0(e){"@babel/helpers - typeof";return c0=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},c0(e)}function $4(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function kh(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?$4(Object(r),!0).forEach(function(n){Tae(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):$4(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Tae(e,t,r){return t=Eae(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Eae(e){var t=Iae(e,"string");return c0(t)=="symbol"?t:t+""}function Iae(e,t){if(c0(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(c0(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function $ae(e){var t,r,n=e.element,a=e.tooltipEventType,i=e.isActive,o=e.activeCoordinate,s=e.activePayload,l=e.offset,u=e.activeTooltipIndex,d=e.tooltipAxisBandSize,f=e.layout,h=e.chartName,g=(t=n.props.cursor)!==null&&t!==void 0?t:(r=n.type.defaultProps)===null||r===void 0?void 0:r.cursor;if(!n||!g||!i||!o||h!=="ScatterChart"&&a!=="axis")return null;var b,w=Kl;if(h==="ScatterChart")b=o,w=sQ;else if(h==="BarChart")b=Oae(f,o,l,d),w=Y2;else if(f==="radial"){var v=bO(o),x=v.cx,m=v.cy,k=v.radius,P=v.startAngle,j=v.endAngle;b={cx:x,cy:m,startAngle:P,endAngle:j,innerRadius:k,outerRadius:k},w=gN}else b={points:Aae(f,o,l)},w=Kl;var S=kh(kh(kh(kh({stroke:"#ccc",pointerEvents:"none"},l),b),er(g,!1)),{},{payload:s,payloadIndex:u,className:kr("recharts-tooltip-cursor",g.className)});return _.isValidElement(g)?_.cloneElement(g,S):_.createElement(w,S)}var Dae=["item"],Rae=["children","className","width","height","style","compact","title","desc"];function Lu(e){"@babel/helpers - typeof";return Lu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Lu(e)}function Yc(){return Yc=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Yc.apply(this,arguments)}function D4(e,t){return Fae(e)||Lae(e,t)||kO(e,t)||Bae()}function Bae(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Lae(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,a,i,o,s=[],l=!0,u=!1;try{if(i=(r=r.call(e)).next,t!==0)for(;!(l=(n=i.call(r)).done)&&(s.push(n.value),s.length!==t);l=!0);}catch(d){u=!0,a=d}finally{try{if(!l&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(u)throw a}}return s}}function Fae(e){if(Array.isArray(e))return e}function R4(e,t){if(e==null)return{};var r=Gae(e,t),n,a;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function Gae(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function Uae(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function zae(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,SO(n.key),n)}}function Wae(e,t,r){return t&&zae(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function Hae(e,t,r){return t=wg(t),Vae(e,wO()?Reflect.construct(t,r||[],wg(e).constructor):t.apply(e,r))}function Vae(e,t){if(t&&(Lu(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Xae(e)}function Xae(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function wO(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(wO=function(){return!!e})()}function wg(e){return wg=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},wg(e)}function Kae(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&L1(e,t)}function L1(e,t){return L1=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},L1(e,t)}function Fu(e){return Zae(e)||qae(e)||kO(e)||Yae()}function Yae(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function kO(e,t){if(e){if(typeof e=="string")return F1(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return F1(e,t)}}function qae(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function Zae(e){if(Array.isArray(e))return F1(e)}function F1(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function B4(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function je(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?B4(Object(r),!0).forEach(function(n){$t(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):B4(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function $t(e,t,r){return t=SO(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function SO(e){var t=Jae(e,"string");return Lu(t)=="symbol"?t:t+""}function Jae(e,t){if(Lu(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(Lu(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Qae={xAxis:["bottom","top"],yAxis:["left","right"]},eie={width:"100%",height:"100%"},jO={x:0,y:0};function Sh(e){return e}var tie=function(t,r){return r==="horizontal"?t.x:r==="vertical"?t.y:r==="centric"?t.angle:t.radius},rie=function(t,r,n,a){var i=r.find(function(d){return d&&d.index===n});if(i){if(t==="horizontal")return{x:i.coordinate,y:a.y};if(t==="vertical")return{x:a.x,y:i.coordinate};if(t==="centric"){var o=i.coordinate,s=a.radius;return je(je(je({},a),ka(a.cx,a.cy,s,o)),{},{angle:o,radius:s})}var l=i.coordinate,u=a.angle;return je(je(je({},a),ka(a.cx,a.cy,l,u)),{},{angle:u,radius:l})}return jO},Am=function(t,r){var n=r.graphicalItems,a=r.dataStartIndex,i=r.dataEndIndex,o=(n??[]).reduce(function(s,l){var u=l.props.data;return u&&u.length?[].concat(Fu(s),Fu(u)):s},[]);return o.length>0?o:t&&t.length&&Fe(a)&&Fe(i)?t.slice(a,i+1):[]};function PO(e){return e==="number"?[0,"auto"]:void 0}var G1=function(t,r,n,a){var i=t.graphicalItems,o=t.tooltipAxis,s=Am(r,t);return n<0||!i||!i.length||n>=s.length?null:i.reduce(function(l,u){var d,f=(d=u.props.data)!==null&&d!==void 0?d:r;f&&t.dataStartIndex+t.dataEndIndex!==0&&t.dataEndIndex-t.dataStartIndex>=n&&(f=f.slice(t.dataStartIndex,t.dataEndIndex+1));var h;if(o.dataKey&&!o.allowDuplicatedCategory){var g=f===void 0?s:f;h=vp(g,o.dataKey,a)}else h=f&&f[n]||s[n];return h?[].concat(Fu(l),[fN(u,h)]):l},[])},L4=function(t,r,n,a){var i=a||{x:t.chartX,y:t.chartY},o=tie(i,n),s=t.orderedTooltipTicks,l=t.tooltipAxis,u=t.tooltipTicks,d=LY(o,s,u,l);if(d>=0&&u){var f=u[d]&&u[d].value,h=G1(t,r,d,f),g=rie(n,s,d,i);return{activeTooltipIndex:d,activeLabel:f,activePayload:h,activeCoordinate:g}}return null},nie=function(t,r){var n=r.axes,a=r.graphicalItems,i=r.axisType,o=r.axisIdKey,s=r.stackGroups,l=r.dataStartIndex,u=r.dataEndIndex,d=t.layout,f=t.children,h=t.stackOffset,g=cN(d,i);return n.reduce(function(b,w){var v,x=w.type.defaultProps!==void 0?je(je({},w.type.defaultProps),w.props):w.props,m=x.type,k=x.dataKey,P=x.allowDataOverflow,j=x.allowDuplicatedCategory,S=x.scale,M=x.ticks,O=x.includeHidden,E=x[o];if(b[E])return b;var I=Am(t.data,{graphicalItems:a.filter(function(Q){var te,ee=o in Q.props?Q.props[o]:(te=Q.type.defaultProps)===null||te===void 0?void 0:te[o];return ee===E}),dataStartIndex:l,dataEndIndex:u}),D=I.length,B,z,Y;Nae(x.domain,P,m)&&(B=t1(x.domain,null,P),g&&(m==="number"||S!=="auto")&&(Y=nf(I,k,"category")));var G=PO(m);if(!B||B.length===0){var $,L=($=x.domain)!==null&&$!==void 0?$:G;if(k){if(B=nf(I,k,m),m==="category"&&g){var U=_D(B);j&&U?(z=B,B=ig(0,D)):j||(B=m5(L,B,w).reduce(function(Q,te){return Q.indexOf(te)>=0?Q:[].concat(Fu(Q),[te])},[]))}else if(m==="category")j?B=B.filter(function(Q){return Q!==""&&!Zt(Q)}):B=m5(L,B,w).reduce(function(Q,te){return Q.indexOf(te)>=0||te===""||Zt(te)?Q:[].concat(Fu(Q),[te])},[]);else if(m==="number"){var V=WY(I,a.filter(function(Q){var te,ee,me=o in Q.props?Q.props[o]:(te=Q.type.defaultProps)===null||te===void 0?void 0:te[o],re="hide"in Q.props?Q.props.hide:(ee=Q.type.defaultProps)===null||ee===void 0?void 0:ee.hide;return me===E&&(O||!re)}),k,i,d);V&&(B=V)}g&&(m==="number"||S!=="auto")&&(Y=nf(I,k,"category"))}else g?B=ig(0,D):s&&s[E]&&s[E].hasStack&&m==="number"?B=h==="expand"?[0,1]:dN(s[E].stackGroups,l,u):B=lN(I,a.filter(function(Q){var te=o in Q.props?Q.props[o]:Q.type.defaultProps[o],ee="hide"in Q.props?Q.props.hide:Q.type.defaultProps.hide;return te===E&&(O||!ee)}),m,d,!0);if(m==="number")B=B1(f,B,E,i,M),L&&(B=t1(L,B,P));else if(m==="category"&&L){var J=L,K=B.every(function(Q){return J.indexOf(Q)>=0});K&&(B=J)}}return je(je({},b),{},$t({},E,je(je({},x),{},{axisType:i,domain:B,categoricalDomain:Y,duplicateDomain:z,originalDomain:(v=x.domain)!==null&&v!==void 0?v:G,isCategorical:g,layout:d})))},{})},aie=function(t,r){var n=r.graphicalItems,a=r.Axis,i=r.axisType,o=r.axisIdKey,s=r.stackGroups,l=r.dataStartIndex,u=r.dataEndIndex,d=t.layout,f=t.children,h=Am(t.data,{graphicalItems:n,dataStartIndex:l,dataEndIndex:u}),g=h.length,b=cN(d,i),w=-1;return n.reduce(function(v,x){var m=x.type.defaultProps!==void 0?je(je({},x.type.defaultProps),x.props):x.props,k=m[o],P=PO("number");if(!v[k]){w++;var j;return b?j=ig(0,g):s&&s[k]&&s[k].hasStack?(j=dN(s[k].stackGroups,l,u),j=B1(f,j,k,i)):(j=t1(P,lN(h,n.filter(function(S){var M,O,E=o in S.props?S.props[o]:(M=S.type.defaultProps)===null||M===void 0?void 0:M[o],I="hide"in S.props?S.props.hide:(O=S.type.defaultProps)===null||O===void 0?void 0:O.hide;return E===k&&!I}),"number",d),a.defaultProps.allowDataOverflow),j=B1(f,j,k,i)),je(je({},v),{},$t({},k,je(je({axisType:i},a.defaultProps),{},{hide:!0,orientation:Ri(Qae,"".concat(i,".").concat(w%2),null),domain:j,originalDomain:P,isCategorical:b,layout:d})))}return v},{})},iie=function(t,r){var n=r.axisType,a=n===void 0?"xAxis":n,i=r.AxisComp,o=r.graphicalItems,s=r.stackGroups,l=r.dataStartIndex,u=r.dataEndIndex,d=t.children,f="".concat(a,"Id"),h=li(d,i),g={};return h&&h.length?g=nie(t,{axes:h,graphicalItems:o,axisType:a,axisIdKey:f,stackGroups:s,dataStartIndex:l,dataEndIndex:u}):o&&o.length&&(g=aie(t,{Axis:i,graphicalItems:o,axisType:a,axisIdKey:f,stackGroups:s,dataStartIndex:l,dataEndIndex:u})),g},oie=function(t){var r=$s(t),n=ns(r,!1,!0);return{tooltipTicks:n,orderedTooltipTicks:w2(n,function(a){return a.coordinate}),tooltipAxis:r,tooltipAxisBandSize:Yp(r,n)}},F4=function(t){var r=t.children,n=t.defaultShowTooltip,a=yi(r,Cu),i=0,o=0;return t.data&&t.data.length!==0&&(o=t.data.length-1),a&&a.props&&(a.props.startIndex>=0&&(i=a.props.startIndex),a.props.endIndex>=0&&(o=a.props.endIndex)),{chartX:0,chartY:0,dataStartIndex:i,dataEndIndex:o,activeTooltipIndex:-1,isTooltipActive:!!n}},sie=function(t){return!t||!t.length?!1:t.some(function(r){var n=is(r&&r.type);return n&&n.indexOf("Bar")>=0})},G4=function(t){return t==="horizontal"?{numericAxisName:"yAxis",cateAxisName:"xAxis"}:t==="vertical"?{numericAxisName:"xAxis",cateAxisName:"yAxis"}:t==="centric"?{numericAxisName:"radiusAxis",cateAxisName:"angleAxis"}:{numericAxisName:"angleAxis",cateAxisName:"radiusAxis"}},lie=function(t,r){var n=t.props,a=t.graphicalItems,i=t.xAxisMap,o=i===void 0?{}:i,s=t.yAxisMap,l=s===void 0?{}:s,u=n.width,d=n.height,f=n.children,h=n.margin||{},g=yi(f,Cu),b=yi(f,To),w=Object.keys(l).reduce(function(j,S){var M=l[S],O=M.orientation;return!M.mirror&&!M.hide?je(je({},j),{},$t({},O,j[O]+M.width)):j},{left:h.left||0,right:h.right||0}),v=Object.keys(o).reduce(function(j,S){var M=o[S],O=M.orientation;return!M.mirror&&!M.hide?je(je({},j),{},$t({},O,Ri(j,"".concat(O))+M.height)):j},{top:h.top||0,bottom:h.bottom||0}),x=je(je({},v),w),m=x.bottom;g&&(x.bottom+=g.props.height||Cu.defaultProps.height),b&&r&&(x=UY(x,a,n,r));var k=u-x.left-x.right,P=d-x.top-x.bottom;return je(je({brushBottom:m},x),{},{width:Math.max(k,0),height:Math.max(P,0)})},cie=function(t,r){if(r==="xAxis")return t[r].width;if(r==="yAxis")return t[r].height},iw=function(t){var r=t.chartName,n=t.GraphicalChild,a=t.defaultTooltipEventType,i=a===void 0?"axis":a,o=t.validateTooltipEventTypes,s=o===void 0?["axis"]:o,l=t.axisComponents,u=t.legendContent,d=t.formatAxisMap,f=t.defaultProps,h=function(x,m){var k=m.graphicalItems,P=m.stackGroups,j=m.offset,S=m.updateId,M=m.dataStartIndex,O=m.dataEndIndex,E=x.barSize,I=x.layout,D=x.barGap,B=x.barCategoryGap,z=x.maxBarSize,Y=G4(I),G=Y.numericAxisName,$=Y.cateAxisName,L=sie(k),U=[];return k.forEach(function(V,J){var K=Am(x.data,{graphicalItems:[V],dataStartIndex:M,dataEndIndex:O}),Q=V.type.defaultProps!==void 0?je(je({},V.type.defaultProps),V.props):V.props,te=Q.dataKey,ee=Q.maxBarSize,me=Q["".concat(G,"Id")],re=Q["".concat($,"Id")],De={},fe=l.reduce(function(tt,ft){var wt=m["".concat(ft.axisType,"Map")],fr=Q["".concat(ft.axisType,"Id")];wt&&wt[fr]||ft.axisType==="zAxis"||fc();var Wt=wt[fr];return je(je({},tt),{},$t($t({},ft.axisType,Wt),"".concat(ft.axisType,"Ticks"),ns(Wt)))},De),le=fe[$],de=fe["".concat($,"Ticks")],Se=P&&P[me]&&P[me].hasStack&&rq(V,P[me].stackGroups),he=is(V.type).indexOf("Bar")>=0,Pe=Yp(le,de),ve=[],ye=L&&FY({barSize:E,stackGroups:P,totalSize:cie(fe,$)});if(he){var ge,ue,Le=Zt(ee)?z:ee,rt=(ge=(ue=Yp(le,de,!0))!==null&&ue!==void 0?ue:Le)!==null&&ge!==void 0?ge:0;ve=GY({barGap:D,barCategoryGap:B,bandSize:rt!==Pe?rt:Pe,sizeList:ye[re],maxBarSize:Le}),rt!==Pe&&(ve=ve.map(function(tt){return je(je({},tt),{},{position:je(je({},tt.position),{},{offset:tt.position.offset-rt/2})})}))}var et=V&&V.type&&V.type.getComposedData;et&&U.push({props:je(je({},et(je(je({},fe),{},{displayedData:K,props:x,dataKey:te,item:V,bandSize:Pe,barPosition:ve,offset:j,stackedData:Se,layout:I,dataStartIndex:M,dataEndIndex:O}))),{},$t($t($t({key:V.key||"item-".concat(J)},G,fe[G]),$,fe[$]),"animationId",S)),childIndex:LD(V,x.children),item:V})}),U},g=function(x,m){var k=x.props,P=x.dataStartIndex,j=x.dataEndIndex,S=x.updateId;if(!uS({props:k}))return null;var M=k.children,O=k.layout,E=k.stackOffset,I=k.data,D=k.reverseStackOrder,B=G4(O),z=B.numericAxisName,Y=B.cateAxisName,G=li(M,n),$=QY(I,G,"".concat(z,"Id"),"".concat(Y,"Id"),E,D),L=l.reduce(function(Q,te){var ee="".concat(te.axisType,"Map");return je(je({},Q),{},$t({},ee,iie(k,je(je({},te),{},{graphicalItems:G,stackGroups:te.axisType===z&&$,dataStartIndex:P,dataEndIndex:j}))))},{}),U=lie(je(je({},L),{},{props:k,graphicalItems:G}),m==null?void 0:m.legendBBox);Object.keys(L).forEach(function(Q){L[Q]=d(k,L[Q],U,Q.replace("Map",""),r)});var V=L["".concat(Y,"Map")],J=oie(V),K=h(k,je(je({},L),{},{dataStartIndex:P,dataEndIndex:j,updateId:S,graphicalItems:G,stackGroups:$,offset:U}));return je(je({formattedGraphicalItems:K,graphicalItems:G,offset:U,stackGroups:$},J),L)},b=function(v){function x(m){var k,P,j;return Uae(this,x),j=Hae(this,x,[m]),$t(j,"eventEmitterSymbol",Symbol("rechartsEventEmitter")),$t(j,"accessibilityManager",new Mae),$t(j,"handleLegendBBoxUpdate",function(S){if(S){var M=j.state,O=M.dataStartIndex,E=M.dataEndIndex,I=M.updateId;j.setState(je({legendBBox:S},g({props:j.props,dataStartIndex:O,dataEndIndex:E,updateId:I},je(je({},j.state),{},{legendBBox:S}))))}}),$t(j,"handleReceiveSyncEvent",function(S,M,O){if(j.props.syncId===S){if(O===j.eventEmitterSymbol&&typeof j.props.syncMethod!="function")return;j.applySyncEvent(M)}}),$t(j,"handleBrushChange",function(S){var M=S.startIndex,O=S.endIndex;if(M!==j.state.dataStartIndex||O!==j.state.dataEndIndex){var E=j.state.updateId;j.setState(function(){return je({dataStartIndex:M,dataEndIndex:O},g({props:j.props,dataStartIndex:M,dataEndIndex:O,updateId:E},j.state))}),j.triggerSyncEvent({dataStartIndex:M,dataEndIndex:O})}}),$t(j,"handleMouseEnter",function(S){var M=j.getMouseInfo(S);if(M){var O=je(je({},M),{},{isTooltipActive:!0});j.setState(O),j.triggerSyncEvent(O);var E=j.props.onMouseEnter;tr(E)&&E(O,S)}}),$t(j,"triggeredAfterMouseMove",function(S){var M=j.getMouseInfo(S),O=M?je(je({},M),{},{isTooltipActive:!0}):{isTooltipActive:!1};j.setState(O),j.triggerSyncEvent(O);var E=j.props.onMouseMove;tr(E)&&E(O,S)}),$t(j,"handleItemMouseEnter",function(S){j.setState(function(){return{isTooltipActive:!0,activeItem:S,activePayload:S.tooltipPayload,activeCoordinate:S.tooltipPosition||{x:S.cx,y:S.cy}}})}),$t(j,"handleItemMouseLeave",function(){j.setState(function(){return{isTooltipActive:!1}})}),$t(j,"handleMouseMove",function(S){S.persist(),j.throttleTriggeredAfterMouseMove(S)}),$t(j,"handleMouseLeave",function(S){j.throttleTriggeredAfterMouseMove.cancel();var M={isTooltipActive:!1};j.setState(M),j.triggerSyncEvent(M);var O=j.props.onMouseLeave;tr(O)&&O(M,S)}),$t(j,"handleOuterEvent",function(S){var M=BD(S),O=Ri(j.props,"".concat(M));if(M&&tr(O)){var E,I;/.*touch.*/i.test(M)?I=j.getMouseInfo(S.changedTouches[0]):I=j.getMouseInfo(S),O((E=I)!==null&&E!==void 0?E:{},S)}}),$t(j,"handleClick",function(S){var M=j.getMouseInfo(S);if(M){var O=je(je({},M),{},{isTooltipActive:!0});j.setState(O),j.triggerSyncEvent(O);var E=j.props.onClick;tr(E)&&E(O,S)}}),$t(j,"handleMouseDown",function(S){var M=j.props.onMouseDown;if(tr(M)){var O=j.getMouseInfo(S);M(O,S)}}),$t(j,"handleMouseUp",function(S){var M=j.props.onMouseUp;if(tr(M)){var O=j.getMouseInfo(S);M(O,S)}}),$t(j,"handleTouchMove",function(S){S.changedTouches!=null&&S.changedTouches.length>0&&j.throttleTriggeredAfterMouseMove(S.changedTouches[0])}),$t(j,"handleTouchStart",function(S){S.changedTouches!=null&&S.changedTouches.length>0&&j.handleMouseDown(S.changedTouches[0])}),$t(j,"handleTouchEnd",function(S){S.changedTouches!=null&&S.changedTouches.length>0&&j.handleMouseUp(S.changedTouches[0])}),$t(j,"handleDoubleClick",function(S){var M=j.props.onDoubleClick;if(tr(M)){var O=j.getMouseInfo(S);M(O,S)}}),$t(j,"handleContextMenu",function(S){var M=j.props.onContextMenu;if(tr(M)){var O=j.getMouseInfo(S);M(O,S)}}),$t(j,"triggerSyncEvent",function(S){j.props.syncId!==void 0&&ax.emit(ix,j.props.syncId,S,j.eventEmitterSymbol)}),$t(j,"applySyncEvent",function(S){var M=j.props,O=M.layout,E=M.syncMethod,I=j.state.updateId,D=S.dataStartIndex,B=S.dataEndIndex;if(S.dataStartIndex!==void 0||S.dataEndIndex!==void 0)j.setState(je({dataStartIndex:D,dataEndIndex:B},g({props:j.props,dataStartIndex:D,dataEndIndex:B,updateId:I},j.state)));else if(S.activeTooltipIndex!==void 0){var z=S.chartX,Y=S.chartY,G=S.activeTooltipIndex,$=j.state,L=$.offset,U=$.tooltipTicks;if(!L)return;if(typeof E=="function")G=E(U,S);else if(E==="value"){G=-1;for(var V=0;V<U.length;V++)if(U[V].value===S.activeLabel){G=V;break}}var J=je(je({},L),{},{x:L.left,y:L.top}),K=Math.min(z,J.x+J.width),Q=Math.min(Y,J.y+J.height),te=U[G]&&U[G].value,ee=G1(j.state,j.props.data,G),me=U[G]?{x:O==="horizontal"?U[G].coordinate:K,y:O==="horizontal"?Q:U[G].coordinate}:jO;j.setState(je(je({},S),{},{activeLabel:te,activeCoordinate:me,activePayload:ee,activeTooltipIndex:G}))}else j.setState(S)}),$t(j,"renderCursor",function(S){var M,O=j.state,E=O.isTooltipActive,I=O.activeCoordinate,D=O.activePayload,B=O.offset,z=O.activeTooltipIndex,Y=O.tooltipAxisBandSize,G=j.getTooltipEventType(),$=(M=S.props.active)!==null&&M!==void 0?M:E,L=j.props.layout,U=S.key||"_recharts-cursor";return oe.createElement($ae,{key:U,activeCoordinate:I,activePayload:D,activeTooltipIndex:z,chartName:r,element:S,isActive:$,layout:L,offset:B,tooltipAxisBandSize:Y,tooltipEventType:G})}),$t(j,"renderPolarAxis",function(S,M,O){var E=Ri(S,"type.axisType"),I=Ri(j.state,"".concat(E,"Map")),D=S.type.defaultProps,B=D!==void 0?je(je({},D),S.props):S.props,z=I&&I[B["".concat(E,"Id")]];return _.cloneElement(S,je(je({},z),{},{className:kr(E,z.className),key:S.key||"".concat(M,"-").concat(O),ticks:ns(z,!0)}))}),$t(j,"renderPolarGrid",function(S){var M=S.props,O=M.radialLines,E=M.polarAngles,I=M.polarRadius,D=j.state,B=D.radiusAxisMap,z=D.angleAxisMap,Y=$s(B),G=$s(z),$=G.cx,L=G.cy,U=G.innerRadius,V=G.outerRadius;return _.cloneElement(S,{polarAngles:Array.isArray(E)?E:ns(G,!0).map(function(J){return J.coordinate}),polarRadius:Array.isArray(I)?I:ns(Y,!0).map(function(J){return J.coordinate}),cx:$,cy:L,innerRadius:U,outerRadius:V,key:S.key||"polar-grid",radialLines:O})}),$t(j,"renderLegend",function(){var S=j.state.formattedGraphicalItems,M=j.props,O=M.children,E=M.width,I=M.height,D=j.props.margin||{},B=E-(D.left||0)-(D.right||0),z=oN({children:O,formattedGraphicalItems:S,legendWidth:B,legendContent:u});if(!z)return null;var Y=z.item,G=R4(z,Dae);return _.cloneElement(Y,je(je({},G),{},{chartWidth:E,chartHeight:I,margin:D,onBBoxUpdate:j.handleLegendBBoxUpdate}))}),$t(j,"renderTooltip",function(){var S,M=j.props,O=M.children,E=M.accessibilityLayer,I=yi(O,ra);if(!I)return null;var D=j.state,B=D.isTooltipActive,z=D.activeCoordinate,Y=D.activePayload,G=D.activeLabel,$=D.offset,L=(S=I.props.active)!==null&&S!==void 0?S:B;return _.cloneElement(I,{viewBox:je(je({},$),{},{x:$.left,y:$.top}),active:L,label:G,payload:L?Y:[],coordinate:z,accessibilityLayer:E})}),$t(j,"renderBrush",function(S){var M=j.props,O=M.margin,E=M.data,I=j.state,D=I.offset,B=I.dataStartIndex,z=I.dataEndIndex,Y=I.updateId;return _.cloneElement(S,{key:S.key||"_recharts-brush",onChange:xh(j.handleBrushChange,S.props.onChange),data:E,x:Fe(S.props.x)?S.props.x:D.left,y:Fe(S.props.y)?S.props.y:D.top+D.height+D.brushBottom-(O.bottom||0),width:Fe(S.props.width)?S.props.width:D.width,startIndex:B,endIndex:z,updateId:"brush-".concat(Y)})}),$t(j,"renderReferenceElement",function(S,M,O){if(!S)return null;var E=j,I=E.clipPathId,D=j.state,B=D.xAxisMap,z=D.yAxisMap,Y=D.offset,G=S.type.defaultProps||{},$=S.props,L=$.xAxisId,U=L===void 0?G.xAxisId:L,V=$.yAxisId,J=V===void 0?G.yAxisId:V;return _.cloneElement(S,{key:S.key||"".concat(M,"-").concat(O),xAxis:B[U],yAxis:z[J],viewBox:{x:Y.left,y:Y.top,width:Y.width,height:Y.height},clipPathId:I})}),$t(j,"renderActivePoints",function(S){var M=S.item,O=S.activePoint,E=S.basePoint,I=S.childIndex,D=S.isRange,B=[],z=M.props.key,Y=M.item.type.defaultProps!==void 0?je(je({},M.item.type.defaultProps),M.item.props):M.item.props,G=Y.activeDot,$=Y.dataKey,L=je(je({index:I,dataKey:$,cx:O.x,cy:O.y,r:4,fill:K2(M.item),strokeWidth:2,stroke:"#fff",payload:O.payload,value:O.value},er(G,!1)),bp(G));return B.push(x.renderActiveDot(G,L,"".concat(z,"-activePoint-").concat(I))),E?B.push(x.renderActiveDot(G,je(je({},L),{},{cx:E.x,cy:E.y}),"".concat(z,"-basePoint-").concat(I))):D&&B.push(null),B}),$t(j,"renderGraphicChild",function(S,M,O){var E=j.filterFormatItem(S,M,O);if(!E)return null;var I=j.getTooltipEventType(),D=j.state,B=D.isTooltipActive,z=D.tooltipAxis,Y=D.activeTooltipIndex,G=D.activeLabel,$=j.props.children,L=yi($,ra),U=E.props,V=U.points,J=U.isRange,K=U.baseLine,Q=E.item.type.defaultProps!==void 0?je(je({},E.item.type.defaultProps),E.item.props):E.item.props,te=Q.activeDot,ee=Q.hide,me=Q.activeBar,re=Q.activeShape,De=!!(!ee&&B&&L&&(te||me||re)),fe={};I!=="axis"&&L&&L.props.trigger==="click"?fe={onClick:xh(j.handleItemMouseEnter,S.props.onClick)}:I!=="axis"&&(fe={onMouseLeave:xh(j.handleItemMouseLeave,S.props.onMouseLeave),onMouseEnter:xh(j.handleItemMouseEnter,S.props.onMouseEnter)});var le=_.cloneElement(S,je(je({},E.props),fe));function de(ft){return typeof z.dataKey=="function"?z.dataKey(ft.payload):null}if(De)if(Y>=0){var Se,he;if(z.dataKey&&!z.allowDuplicatedCategory){var Pe=typeof z.dataKey=="function"?de:"payload.".concat(z.dataKey.toString());Se=vp(V,Pe,G),he=J&&K&&vp(K,Pe,G)}else Se=V==null?void 0:V[Y],he=J&&K&&K[Y];if(re||me){var ve=S.props.activeIndex!==void 0?S.props.activeIndex:Y;return[_.cloneElement(S,je(je(je({},E.props),fe),{},{activeIndex:ve})),null,null]}if(!Zt(Se))return[le].concat(Fu(j.renderActivePoints({item:E,activePoint:Se,basePoint:he,childIndex:Y,isRange:J})))}else{var ye,ge=(ye=j.getItemByXY(j.state.activeCoordinate))!==null&&ye!==void 0?ye:{graphicalItem:le},ue=ge.graphicalItem,Le=ue.item,rt=Le===void 0?S:Le,et=ue.childIndex,tt=je(je(je({},E.props),fe),{},{activeIndex:et});return[_.cloneElement(rt,tt),null,null]}return J?[le,null,null]:[le,null]}),$t(j,"renderCustomized",function(S,M,O){return _.cloneElement(S,je(je({key:"recharts-customized-".concat(O)},j.props),j.state))}),$t(j,"renderMap",{CartesianGrid:{handler:Sh,once:!0},ReferenceArea:{handler:j.renderReferenceElement},ReferenceLine:{handler:Sh},ReferenceDot:{handler:j.renderReferenceElement},XAxis:{handler:Sh},YAxis:{handler:Sh},Brush:{handler:j.renderBrush,once:!0},Bar:{handler:j.renderGraphicChild},Line:{handler:j.renderGraphicChild},Area:{handler:j.renderGraphicChild},Radar:{handler:j.renderGraphicChild},RadialBar:{handler:j.renderGraphicChild},Scatter:{handler:j.renderGraphicChild},Pie:{handler:j.renderGraphicChild},Funnel:{handler:j.renderGraphicChild},Tooltip:{handler:j.renderCursor,once:!0},PolarGrid:{handler:j.renderPolarGrid,once:!0},PolarAngleAxis:{handler:j.renderPolarAxis},PolarRadiusAxis:{handler:j.renderPolarAxis},Customized:{handler:j.renderCustomized}}),j.clipPathId="".concat((k=m.id)!==null&&k!==void 0?k:xc("recharts"),"-clip"),j.throttleTriggeredAfterMouseMove=sM(j.triggeredAfterMouseMove,(P=m.throttleDelay)!==null&&P!==void 0?P:1e3/60),j.state={},j}return Kae(x,v),Wae(x,[{key:"componentDidMount",value:function(){var k,P;this.addListener(),this.accessibilityManager.setDetails({container:this.container,offset:{left:(k=this.props.margin.left)!==null&&k!==void 0?k:0,top:(P=this.props.margin.top)!==null&&P!==void 0?P:0},coordinateList:this.state.tooltipTicks,mouseHandlerCallback:this.triggeredAfterMouseMove,layout:this.props.layout}),this.displayDefaultTooltip()}},{key:"displayDefaultTooltip",value:function(){var k=this.props,P=k.children,j=k.data,S=k.height,M=k.layout,O=yi(P,ra);if(O){var E=O.props.defaultIndex;if(!(typeof E!="number"||E<0||E>this.state.tooltipTicks.length-1)){var I=this.state.tooltipTicks[E]&&this.state.tooltipTicks[E].value,D=G1(this.state,j,E,I),B=this.state.tooltipTicks[E].coordinate,z=(this.state.offset.top+S)/2,Y=M==="horizontal",G=Y?{x:B,y:z}:{y:B,x:z},$=this.state.formattedGraphicalItems.find(function(U){var V=U.item;return V.type.name==="Scatter"});$&&(G=je(je({},G),$.props.points[E].tooltipPosition),D=$.props.points[E].tooltipPayload);var L={activeTooltipIndex:E,isTooltipActive:!0,activeLabel:I,activePayload:D,activeCoordinate:G};this.setState(L),this.renderCursor(O),this.accessibilityManager.setIndex(E)}}}},{key:"getSnapshotBeforeUpdate",value:function(k,P){if(!this.props.accessibilityLayer)return null;if(this.state.tooltipTicks!==P.tooltipTicks&&this.accessibilityManager.setDetails({coordinateList:this.state.tooltipTicks}),this.props.layout!==k.layout&&this.accessibilityManager.setDetails({layout:this.props.layout}),this.props.margin!==k.margin){var j,S;this.accessibilityManager.setDetails({offset:{left:(j=this.props.margin.left)!==null&&j!==void 0?j:0,top:(S=this.props.margin.top)!==null&&S!==void 0?S:0}})}return null}},{key:"componentDidUpdate",value:function(k){mv([yi(k.children,ra)],[yi(this.props.children,ra)])||this.displayDefaultTooltip()}},{key:"componentWillUnmount",value:function(){this.removeListener(),this.throttleTriggeredAfterMouseMove.cancel()}},{key:"getTooltipEventType",value:function(){var k=yi(this.props.children,ra);if(k&&typeof k.props.shared=="boolean"){var P=k.props.shared?"axis":"item";return s.indexOf(P)>=0?P:i}return i}},{key:"getMouseInfo",value:function(k){if(!this.container)return null;var P=this.container,j=P.getBoundingClientRect(),S=dH(j),M={chartX:Math.round(k.pageX-S.left),chartY:Math.round(k.pageY-S.top)},O=j.width/P.offsetWidth||1,E=this.inRange(M.chartX,M.chartY,O);if(!E)return null;var I=this.state,D=I.xAxisMap,B=I.yAxisMap,z=this.getTooltipEventType(),Y=L4(this.state,this.props.data,this.props.layout,E);if(z!=="axis"&&D&&B){var G=$s(D).scale,$=$s(B).scale,L=G&&G.invert?G.invert(M.chartX):null,U=$&&$.invert?$.invert(M.chartY):null;return je(je({},M),{},{xValue:L,yValue:U},Y)}return Y?je(je({},M),Y):null}},{key:"inRange",value:function(k,P){var j=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1,S=this.props.layout,M=k/j,O=P/j;if(S==="horizontal"||S==="vertical"){var E=this.state.offset,I=M>=E.left&&M<=E.left+E.width&&O>=E.top&&O<=E.top+E.height;return I?{x:M,y:O}:null}var D=this.state,B=D.angleAxisMap,z=D.radiusAxisMap;if(B&&z){var Y=$s(B);return v5({x:M,y:O},Y)}return null}},{key:"parseEventsOfWrapper",value:function(){var k=this.props.children,P=this.getTooltipEventType(),j=yi(k,ra),S={};j&&P==="axis"&&(j.props.trigger==="click"?S={onClick:this.handleClick}:S={onMouseEnter:this.handleMouseEnter,onDoubleClick:this.handleDoubleClick,onMouseMove:this.handleMouseMove,onMouseLeave:this.handleMouseLeave,onTouchMove:this.handleTouchMove,onTouchStart:this.handleTouchStart,onTouchEnd:this.handleTouchEnd,onContextMenu:this.handleContextMenu});var M=bp(this.props,this.handleOuterEvent);return je(je({},M),S)}},{key:"addListener",value:function(){ax.on(ix,this.handleReceiveSyncEvent)}},{key:"removeListener",value:function(){ax.removeListener(ix,this.handleReceiveSyncEvent)}},{key:"filterFormatItem",value:function(k,P,j){for(var S=this.state.formattedGraphicalItems,M=0,O=S.length;M<O;M++){var E=S[M];if(E.item===k||E.props.key===k.key||P===is(E.item.type)&&j===E.childIndex)return E}return null}},{key:"renderClipPath",value:function(){var k=this.clipPathId,P=this.state.offset,j=P.left,S=P.top,M=P.height,O=P.width;return oe.createElement("defs",null,oe.createElement("clipPath",{id:k},oe.createElement("rect",{x:j,y:S,height:M,width:O})))}},{key:"getXScales",value:function(){var k=this.state.xAxisMap;return k?Object.entries(k).reduce(function(P,j){var S=D4(j,2),M=S[0],O=S[1];return je(je({},P),{},$t({},M,O.scale))},{}):null}},{key:"getYScales",value:function(){var k=this.state.yAxisMap;return k?Object.entries(k).reduce(function(P,j){var S=D4(j,2),M=S[0],O=S[1];return je(je({},P),{},$t({},M,O.scale))},{}):null}},{key:"getXScaleByAxisId",value:function(k){var P;return(P=this.state.xAxisMap)===null||P===void 0||(P=P[k])===null||P===void 0?void 0:P.scale}},{key:"getYScaleByAxisId",value:function(k){var P;return(P=this.state.yAxisMap)===null||P===void 0||(P=P[k])===null||P===void 0?void 0:P.scale}},{key:"getItemByXY",value:function(k){var P=this.state,j=P.formattedGraphicalItems,S=P.activeItem;if(j&&j.length)for(var M=0,O=j.length;M<O;M++){var E=j[M],I=E.props,D=E.item,B=D.type.defaultProps!==void 0?je(je({},D.type.defaultProps),D.props):D.props,z=is(D.type);if(z==="Bar"){var Y=(I.data||[]).find(function(U){return ZJ(k,U)});if(Y)return{graphicalItem:E,payload:Y}}else if(z==="RadialBar"){var G=(I.data||[]).find(function(U){return v5(k,U)});if(G)return{graphicalItem:E,payload:G}}else if(Pm(E,S)||_m(E,S)||n0(E,S)){var $=QQ({graphicalItem:E,activeTooltipItem:S,itemData:B.data}),L=B.activeIndex===void 0?$:B.activeIndex;return{graphicalItem:je(je({},E),{},{childIndex:L}),payload:n0(E,S)?B.data[$]:E.props.data[$]}}}return null}},{key:"render",value:function(){var k=this;if(!uS(this))return null;var P=this.props,j=P.children,S=P.className,M=P.width,O=P.height,E=P.style,I=P.compact,D=P.title,B=P.desc,z=R4(P,Rae),Y=er(z,!1);if(I)return oe.createElement(p4,{state:this.state,width:this.props.width,height:this.props.height,clipPathId:this.clipPathId},oe.createElement(xv,Yc({},Y,{width:M,height:O,title:D,desc:B}),this.renderClipPath(),fS(j,this.renderMap)));if(this.props.accessibilityLayer){var G,$;Y.tabIndex=(G=this.props.tabIndex)!==null&&G!==void 0?G:0,Y.role=($=this.props.role)!==null&&$!==void 0?$:"application",Y.onKeyDown=function(U){k.accessibilityManager.keyboardEvent(U)},Y.onFocus=function(){k.accessibilityManager.focus()}}var L=this.parseEventsOfWrapper();return oe.createElement(p4,{state:this.state,width:this.props.width,height:this.props.height,clipPathId:this.clipPathId},oe.createElement("div",Yc({className:kr("recharts-wrapper",S),style:je({position:"relative",cursor:"default",width:M,height:O},E)},L,{ref:function(V){k.container=V}}),oe.createElement(xv,Yc({},Y,{width:M,height:O,title:D,desc:B,style:eie}),this.renderClipPath(),fS(j,this.renderMap)),this.renderLegend(),this.renderTooltip()))}}])}(_.Component);$t(b,"displayName",r),$t(b,"defaultProps",je({layout:"horizontal",stackOffset:"none",barCategoryGap:"10%",barGap:4,margin:{top:5,right:5,bottom:5,left:5},reverseStackOrder:!1,syncMethod:"index"},f)),$t(b,"getDerivedStateFromProps",function(v,x){var m=v.dataKey,k=v.data,P=v.children,j=v.width,S=v.height,M=v.layout,O=v.stackOffset,E=v.margin,I=x.dataStartIndex,D=x.dataEndIndex;if(x.updateId===void 0){var B=F4(v);return je(je(je({},B),{},{updateId:0},g(je(je({props:v},B),{},{updateId:0}),x)),{},{prevDataKey:m,prevData:k,prevWidth:j,prevHeight:S,prevLayout:M,prevStackOffset:O,prevMargin:E,prevChildren:P})}if(m!==x.prevDataKey||k!==x.prevData||j!==x.prevWidth||S!==x.prevHeight||M!==x.prevLayout||O!==x.prevStackOffset||!nu(E,x.prevMargin)){var z=F4(v),Y={chartX:x.chartX,chartY:x.chartY,isTooltipActive:x.isTooltipActive},G=je(je({},L4(x,k,M)),{},{updateId:x.updateId+1}),$=je(je(je({},z),Y),G);return je(je(je({},$),g(je({props:v},$),x)),{},{prevDataKey:m,prevData:k,prevWidth:j,prevHeight:S,prevLayout:M,prevStackOffset:O,prevMargin:E,prevChildren:P})}if(!mv(P,x.prevChildren)){var L,U,V,J,K=yi(P,Cu),Q=K&&(L=(U=K.props)===null||U===void 0?void 0:U.startIndex)!==null&&L!==void 0?L:I,te=K&&(V=(J=K.props)===null||J===void 0?void 0:J.endIndex)!==null&&V!==void 0?V:D,ee=Q!==I||te!==D,me=!Zt(k),re=me&&!ee?x.updateId:x.updateId+1;return je(je({updateId:re},g(je(je({props:v},x),{},{updateId:re,dataStartIndex:Q,dataEndIndex:te}),x)),{},{prevChildren:P,dataStartIndex:Q,dataEndIndex:te})}return null}),$t(b,"renderActiveDot",function(v,x,m){var k;return _.isValidElement(v)?k=_.cloneElement(v,x):tr(v)?k=v(x):k=oe.createElement(jm,x),oe.createElement(Wr,{className:"recharts-active-dot",key:m},k)});var w=_.forwardRef(function(x,m){return oe.createElement(b,Yc({},x,{ref:m}))});return w.displayName=b.displayName,w},zl=iw({chartName:"LineChart",GraphicalChild:En,axisComponents:[{axisType:"xAxis",AxisComp:Xa},{axisType:"yAxis",AxisComp:Ka}],formatAxisMap:q2}),uie=iw({chartName:"ScatterChart",GraphicalChild:za,defaultTooltipEventType:"item",validateTooltipEventTypes:["item"],axisComponents:[{axisType:"xAxis",AxisComp:Xa},{axisType:"yAxis",AxisComp:Ka},{axisType:"zAxis",AxisComp:Om}],formatAxisMap:q2}),_O=iw({chartName:"AreaChart",GraphicalChild:$i,axisComponents:[{axisType:"xAxis",AxisComp:Xa},{axisType:"yAxis",AxisComp:Ka}],formatAxisMap:q2});const qo=(e,t)=>{const r=localStorage.getItem(e);return r===null?t:typeof t=="boolean"?r==="true":typeof t=="number"?Number(r):r},die=({isOpen:e,onClose:t,onMinimize:r,rawImageData:n,roi:a,isBGGR:i,zIndex:o,onFocus:s,initialPosition:l,initialInternalState:u,onUpdateState:d,stackFiles:f})=>{const[h,g]=_.useState(()=>(u==null?void 0:u.channelMode)??qo("hist_mode","All")),[b,w]=_.useState(()=>(u==null?void 0:u.minVal)??qo("hist_min",0)),[v,x]=_.useState(()=>(u==null?void 0:u.maxVal)??qo("hist_max",16383)),[m,k]=_.useState(()=>(u==null?void 0:u.binCount)??qo("hist_bins",100)),[P,j]=_.useState(()=>(u==null?void 0:u.pointToPoint)??qo("hist_ptp",!1)),[S,M]=_.useState(()=>(u==null?void 0:u.showTheo)??qo("hist_show_theo",!1)),[O,E]=_.useState(()=>(u==null?void 0:u.theoMean)??qo("hist_theo_mean","512")),[I,D]=_.useState(()=>(u==null?void 0:u.theoSigma)??qo("hist_theo_sigma","10")),[B,z]=_.useState(()=>(u==null?void 0:u.theoAmp)??qo("hist_theo_amp","1000")),[Y,G]=_.useState(!1),[$,L]=_.useState(0),[U,V]=_.useState([]),[J,K]=_.useState(null),[Q,te]=_.useState(l||{x:100,y:100}),[ee,me]=_.useState(!1),re=_.useRef({x:0,y:0});_.useEffect(()=>{localStorage.setItem("hist_mode",h),localStorage.setItem("hist_min",String(b)),localStorage.setItem("hist_max",String(v)),localStorage.setItem("hist_bins",String(m)),localStorage.setItem("hist_ptp",String(P)),localStorage.setItem("hist_show_theo",String(S)),localStorage.setItem("hist_theo_mean",O),localStorage.setItem("hist_theo_sigma",I),localStorage.setItem("hist_theo_amp",B),d&&d({channelMode:h,minVal:b,maxVal:v,binCount:m,pointToPoint:P,showTheo:S,theoMean:O,theoSigma:I,theoAmp:B})},[h,b,v,m,P,S,O,I,B]),_.useEffect(()=>{if(!e||!a||!n&&(!f||f.length===0))return;if(v<=b){K("Invalid range: Max must be greater than Min");return}K(null),G(!0),L(0);const ye=new AbortController,ge=[],Le=setTimeout(async()=>{try{let rt=[];if(f&&f.length>1){const et=Math.min(f.length,navigator.hardwareConcurrency||4);for(let Wt=0;Wt<et;Wt++){const kt=new Worker(new URL("/assets/histogramWorker-CC48bXVX.js",import.meta.url),{type:"module"});ge.push(kt)}let tt=0,ft=0;const wt=[],fr=async Wt=>{for(;tt<f.length;){if(ye.signal.aborted)return;const kt=tt++,Bt=f[kt];try{const Sr=await Bt.arrayBuffer();await new Promise((Gr,rr)=>{Wt.onmessage=Nr=>{const{success:nt,hist:Ot,error:pr}=Nr.data;nt?(wt.push(Ot),ft++,L(ft),Gr()):(console.error(`Error processing ${Bt.name}:`,pr),Gr())},Wt.onerror=Nr=>{console.error("Worker Error",Nr),Gr()},Wt.postMessage({buffer:Sr,roi:a,binCount:m,minVal:b,maxVal:v,pointToPoint:P},[Sr])})}catch(Sr){console.error("File Read Error",Sr)}}};if(await Promise.all(ge.map(Wt=>fr(Wt))),ge.forEach(Wt=>Wt.terminate()),ge.length=0,wt.length>0){rt=wt[0];for(let Wt=1;Wt<wt.length;Wt++){const kt=wt[Wt];for(let Bt=0;Bt<kt.length;Bt++)rt[Bt]&&(rt[Bt].c0+=kt[Bt].c0,rt[Bt].c1+=kt[Bt].c1,rt[Bt].c2+=kt[Bt].c2,rt[Bt].c3+=kt[Bt].c3)}}}else n&&(rt=_8(n.data,n.width,n.height,a.x,a.y,a.w,a.h,m,b,v,P));ye.signal.aborted||V(rt)}catch(rt){console.error("Histogram calc error:",rt),K("Error calculating histogram")}finally{ye.signal.aborted||G(!1)}},50);return()=>{clearTimeout(Le),ye.abort(),ge.length>0&&(console.log(`Terminating ${ge.length} active histogram workers...`),ge.forEach(rt=>rt.terminate()))}},[e,n,a==null?void 0:a.x,a==null?void 0:a.y,a==null?void 0:a.w,a==null?void 0:a.h,m,b,v,P,f]);const De=_.useMemo(()=>{if(!S)return U;const ye=parseFloat(O),ge=parseFloat(I),ue=parseFloat(B);return isNaN(ye)||isNaN(ge)||isNaN(ue)||ge<=0?U:U.map(Le=>{const rt=Le.binStart,et=-Math.pow(rt-ye,2)/(2*Math.pow(ge,2)),tt=ue*Math.exp(et);return{...Le,theory:tt}})},[U,S,O,I,B]),fe=()=>{if(U.length===0)return;let ye=0,ge=0;if(U.forEach(ue=>{const Le=Math.max(ue.c0||0,ue.c1||0,ue.c2||0,ue.c3||0);Le>ye&&(ye=Le,ge=ue.binStart)}),E(ge.toFixed(2)),z(ye.toString()),parseFloat(I)===0||isNaN(parseFloat(I))){const ue=v-b;D((ue/20).toFixed(2))}},le=(ye,ge,ue)=>{s&&s(),!(ue.closest("button")||ue.closest("input")||ue.closest("select"))&&(me(!0),re.current={x:ye-Q.x,y:ge-Q.y})},de=ye=>{le(ye.clientX,ye.clientY,ye.target)},Se=ye=>{const ge=ye.touches[0];le(ge.clientX,ge.clientY,ye.target)};if(_.useEffect(()=>{const ye=ue=>{if(ee){const Le="touches"in ue?ue.touches[0].clientX:ue.clientX,rt="touches"in ue?ue.touches[0].clientY:ue.clientY;te({x:Le-re.current.x,y:rt-re.current.y})}},ge=()=>me(!1);return ee&&(window.addEventListener("mousemove",ye),window.addEventListener("mouseup",ge),window.addEventListener("touchmove",ye,{passive:!1}),window.addEventListener("touchend",ge)),()=>{window.removeEventListener("mousemove",ye),window.removeEventListener("mouseup",ge),window.removeEventListener("touchmove",ye),window.removeEventListener("touchend",ge)}},[ee]),!e)return null;const he=i?{c0:"Blue",c1:"Green 1",c2:"Green 2",c3:"Red"}:{c0:"Red",c1:"Green 1",c2:"Green 2",c3:"Blue"},Pe=i?{c0:"#3b82f6",c1:"#22c55e",c2:"#4ade80",c3:"#ef4444"}:{c0:"#ef4444",c1:"#22c55e",c2:"#4ade80",c3:"#3b82f6"},ve="step";return c.jsxs("div",{className:"fixed flex flex-col bg-white dark:bg-slate-900 border border-gray-200 dark:border-slate-700 shadow-2xl rounded-xl resize-both overflow-hidden min-w-[500px] min-h-[400px] w-[900px] h-[650px]",style:{left:Q.x,top:Q.y,zIndex:o??100},onMouseDownCapture:s,children:[c.jsxs("div",{className:`flex justify-between items-center p-4 border-b border-gray-200 dark:border-slate-700 flex-shrink-0 bg-white dark:bg-slate-900 select-none touch-none ${ee?"cursor-grabbing":"cursor-grab"}`,onMouseDown:de,onTouchStart:Se,children:[c.jsxs("h2",{className:"text-xl font-bold text-gray-900 dark:text-slate-100 pointer-events-none flex items-center gap-2",children:["ROI Histogram",f&&f.length>1&&c.jsxs("span",{className:"text-[10px] font-normal bg-purple-100 dark:bg-purple-900/30 text-purple-700 dark:text-purple-300 px-2 py-0.5 rounded border border-purple-200 dark:border-purple-800 shadow-sm",children:["Stack Count: ",f.length]})]}),c.jsxs("div",{className:"flex items-center gap-1",children:[r&&c.jsx("button",{onClick:r,className:"text-gray-400 hover:text-gray-600 dark:hover:text-slate-300 p-2 rounded-lg hover:bg-gray-100 dark:hover:bg-slate-800 transition-colors",children:c.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M20 12H4"})})}),c.jsx("button",{onClick:t,className:"text-gray-400 hover:text-red-500 dark:hover:text-red-400 p-2 rounded-lg hover:bg-gray-100 dark:hover:bg-slate-800 transition-colors",children:c.jsx("svg",{className:"w-6 h-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]})]}),c.jsxs("div",{className:"p-3 bg-gray-50 dark:bg-slate-800/50 flex flex-wrap gap-x-6 gap-y-3 items-center border-b border-gray-200 dark:border-slate-700 text-xs flex-shrink-0 relative z-10",children:[c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx("span",{className:"text-gray-500 dark:text-slate-400 font-bold uppercase tracking-tight",children:"Channel:"}),c.jsxs("select",{value:h,onChange:ye=>g(ye.target.value),className:"bg-white dark:bg-slate-700 border border-gray-300 dark:border-slate-600 rounded px-2 py-1 text-gray-900 dark:text-slate-100 outline-none focus:ring-1 focus:ring-cyan-500",children:[c.jsx("option",{value:"All",children:"All Colors"}),c.jsx("option",{value:"0",children:he.c0}),c.jsx("option",{value:"1",children:he.c1}),c.jsx("option",{value:"2",children:he.c2}),c.jsx("option",{value:"3",children:he.c3})]})]}),c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx("span",{className:"text-gray-500 dark:text-slate-400 font-bold uppercase tracking-tight",children:"Range:"}),c.jsx("input",{type:"number",value:b,onChange:ye=>w(Number(ye.target.value)),className:"w-16 px-1.5 py-1 bg-white dark:bg-slate-700 border border-gray-300 dark:border-slate-600 rounded outline-none text-gray-900 dark:text-slate-100 text-right font-mono"}),c.jsx("span",{className:"text-gray-400",children:"-"}),c.jsx("input",{type:"number",value:v,onChange:ye=>x(Number(ye.target.value)),className:"w-16 px-1.5 py-1 bg-white dark:bg-slate-700 border border-gray-300 dark:border-slate-600 rounded outline-none text-gray-900 dark:text-slate-100 text-right font-mono"})]}),c.jsxs("div",{className:"flex items-center gap-4",children:[c.jsxs("label",{className:"flex items-center gap-1.5 cursor-pointer",children:[c.jsx("input",{type:"checkbox",checked:P,onChange:ye=>j(ye.target.checked),className:"w-3.5 h-3.5 text-cyan-600 rounded border-gray-300 focus:ring-cyan-500"}),c.jsx("span",{className:"text-gray-700 dark:text-slate-300 select-none font-semibold",children:"PTP"})]}),!P&&c.jsxs("div",{className:"flex items-center gap-1.5",children:[c.jsx("span",{className:"text-gray-500 dark:text-slate-400 font-bold",children:"Bins:"}),c.jsx("input",{type:"number",value:m,onChange:ye=>k(Math.max(1,Number(ye.target.value))),className:"w-12 px-1.5 py-1 bg-white dark:bg-slate-700 border border-gray-300 dark:border-slate-600 rounded outline-none text-gray-900 dark:text-slate-100 text-right font-mono"})]})]}),c.jsx("div",{className:"h-6 w-px bg-gray-200 dark:bg-slate-700"}),c.jsxs("div",{className:`flex items-center gap-3 p-1.5 rounded-lg border transition-all ${S?"bg-amber-50/30 dark:bg-amber-900/10 border-amber-200/50 dark:border-amber-800/50":"bg-transparent border-transparent"}`,children:[c.jsxs("label",{className:"flex items-center gap-1.5 cursor-pointer select-none",children:[c.jsx("input",{type:"checkbox",checked:S,onChange:ye=>M(ye.target.checked),className:"w-3.5 h-3.5 text-amber-500 rounded border-gray-300 focus:ring-amber-500 bg-white dark:bg-slate-700"}),c.jsx("span",{className:`font-bold uppercase tracking-tight ${S?"text-amber-600 dark:text-amber-400":"text-gray-400"}`,children:"Theoretical Bell"})]}),S&&c.jsxs("div",{className:"flex items-center gap-2 animate-in fade-in slide-in-from-left-2 duration-200",children:[c.jsxs("div",{className:"flex flex-col items-center",children:[c.jsx("span",{className:"text-[8px] text-gray-400 uppercase font-bold",children:"Mean()"}),c.jsx("input",{type:"text",value:O,onChange:ye=>E(ye.target.value),className:"w-14 bg-white dark:bg-slate-900 border border-gray-300 dark:border-slate-600 rounded text-center text-[10px] py-0.5 outline-none focus:border-amber-500"})]}),c.jsxs("div",{className:"flex flex-col items-center",children:[c.jsx("span",{className:"text-[8px] text-gray-400 uppercase font-bold",children:"Sigma()"}),c.jsx("input",{type:"text",value:I,onChange:ye=>D(ye.target.value),className:"w-12 bg-white dark:bg-slate-900 border border-gray-300 dark:border-slate-600 rounded text-center text-[10px] py-0.5 outline-none focus:border-amber-500"})]}),c.jsxs("div",{className:"flex flex-col items-center",children:[c.jsx("span",{className:"text-[8px] text-gray-400 uppercase font-bold",children:"Scale(A)"}),c.jsx("input",{type:"text",value:B,onChange:ye=>z(ye.target.value),className:"w-16 bg-white dark:bg-slate-900 border border-gray-300 dark:border-slate-600 rounded text-center text-[10px] py-0.5 outline-none focus:border-amber-500"})]}),c.jsx("button",{onClick:fe,className:"mt-3 px-2 py-0.5 bg-amber-600 hover:bg-amber-500 text-white text-[9px] font-bold rounded shadow-sm active:scale-95 transition-all",title:"Set Mean and Amplitude based on current peak",children:"AUTO FIT"})]})]})]}),c.jsxs("div",{className:"flex-1 p-4 relative bg-white dark:bg-slate-900 overflow-hidden min-h-0",children:[c.jsx("div",{className:"absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 z-0 pointer-events-none select-none opacity-10 mix-blend-normal dark:mix-blend-plus-lighter",children:c.jsx("svg",{viewBox:"0 0 500 60",className:"w-96 h-auto",children:c.jsx("text",{x:"50%",y:"50%",dominantBaseline:"middle",textAnchor:"middle",className:"fill-gray-900 dark:fill-white",fontSize:"36",fontWeight:"bold",style:{fontFamily:"sans-serif",letterSpacing:"0.05em"},children:" y-g-jiang.github.io"})})}),Y&&c.jsxs("div",{className:"absolute inset-0 flex flex-col items-center justify-center z-20 bg-white/50 dark:bg-slate-900/50 backdrop-blur-[1px]",children:[c.jsx("div",{className:"w-8 h-8 border-4 border-cyan-500 border-t-transparent rounded-full animate-spin mb-2"}),c.jsx("span",{className:"text-sm text-cyan-600 dark:text-cyan-400 font-semibold",children:f&&f.length>1?`Stacking Histogram... ${$}/${f.length}`:"Calculating Histogram..."})]}),J?c.jsx("div",{className:"flex items-center justify-center h-full text-red-500 relative z-10",children:J}):c.jsx("div",{className:"relative z-10 w-full h-full",children:c.jsx(_o,{width:"100%",height:"100%",children:c.jsxs(zl,{data:De,children:[c.jsx(so,{strokeDasharray:"3 3",stroke:"#374151",opacity:.3}),c.jsx(Xa,{dataKey:"binStart",type:"number",domain:[b,v],tickFormatter:ye=>Math.floor(ye).toString(),tick:{fill:"#9ca3af",fontSize:12},allowDataOverflow:!0,label:{value:"DN Value",position:"insideBottom",offset:-5,fill:"#9ca3af",fontSize:12}}),c.jsx(Ka,{tick:{fill:"#9ca3af",fontSize:12},label:{value:"Count",angle:-90,position:"insideLeft",fill:"#9ca3af",fontSize:12}}),c.jsx(ra,{contentStyle:{backgroundColor:"#1f2937",border:"1px solid #374151",borderRadius:"0.5rem",color:"#f3f4f6"},itemStyle:{fontSize:"12px"},labelFormatter:ye=>`DN: ${Math.round(Number(ye))}`,formatter:(ye,ge)=>[Math.round(ye),ge]}),c.jsx(To,{wrapperStyle:{paddingTop:"10px"}}),S&&c.jsx(En,{type:"monotone",dataKey:"theory",name:"Ideal Bell (Gaussian)",stroke:"#f59e0b",strokeWidth:2.5,strokeDasharray:"5 5",dot:!1,isAnimationActive:!1}),(h==="All"||h==="0")&&c.jsx(En,{type:ve,dataKey:"c0",name:he.c0,stroke:Pe.c0,dot:!1,strokeWidth:1.5,activeDot:{r:4},isAnimationActive:!1}),(h==="All"||h==="1")&&c.jsx(En,{type:ve,dataKey:"c1",name:he.c1,stroke:Pe.c1,dot:!1,strokeWidth:1.5,activeDot:{r:4},isAnimationActive:!1}),(h==="All"||h==="2")&&c.jsx(En,{type:ve,dataKey:"c2",name:he.c2,stroke:Pe.c2,dot:!1,strokeWidth:1.5,activeDot:{r:4},isAnimationActive:!1}),(h==="All"||h==="3")&&c.jsx(En,{type:ve,dataKey:"c3",name:he.c3,stroke:Pe.c3,dot:!1,strokeWidth:1.5,activeDot:{r:4},isAnimationActive:!1})]})})})]})]})},ml=({initialPosition:e={x:20,y:80},children:t,className:r="",onClose:n,zIndex:a,onFocus:i})=>{const[o,s]=_.useState(e),[l,u]=_.useState(!1),[d,f]=_.useState({x:0,y:0}),h=_.useRef(null),g=(v,x,m)=>{i&&i(),!(m.closest("button")||m.closest("input"))&&(u(!0),f({x:v-o.x,y:x-o.y}))},b=v=>{g(v.clientX,v.clientY,v.target)},w=v=>{const x=v.touches[0];g(x.clientX,x.clientY,v.target)};return _.useEffect(()=>{const v=m=>{var k,P;if(l){m.cancelable&&m.preventDefault();const j="touches"in m?m.touches[0].clientX:m.clientX,S="touches"in m?m.touches[0].clientY:m.clientY,M=j-d.x,O=S-d.y,E=window.innerWidth-(((k=h.current)==null?void 0:k.offsetWidth)||100),I=window.innerHeight-(((P=h.current)==null?void 0:P.offsetHeight)||100);s({x:Math.max(0,Math.min(M,E)),y:Math.max(0,Math.min(O,I))})}},x=()=>{u(!1)};return l&&(window.addEventListener("mousemove",v),window.addEventListener("mouseup",x),window.addEventListener("touchmove",v,{passive:!1}),window.addEventListener("touchend",x)),()=>{window.removeEventListener("mousemove",v),window.removeEventListener("mouseup",x),window.removeEventListener("touchmove",v),window.removeEventListener("touchend",x)}},[l,d]),c.jsxs("div",{ref:h,style:{left:o.x,top:o.y,zIndex:a??90},onMouseDownCapture:i,className:`fixed border-2 border-black dark:border-gray-500 bg-white dark:bg-black shadow-[8px_8px_0px_rgba(0,0,0,0.5)] dark:shadow-[8px_8px_0px_rgba(255,255,255,0.2)] transition-shadow duration-200 ${l?"cursor-grabbing shadow-[4px_4px_0px_rgba(0,0,0,0.5)]":""} ${r}`,children:[c.jsx("div",{onMouseDown:b,onTouchStart:w,className:"absolute inset-0 w-full h-8 cursor-grab active:cursor-grabbing z-0 touch-none bg-gray-200 dark:bg-gray-800 border-b-2 border-black dark:border-gray-500",title:"Drag to move"}),c.jsx("div",{className:"relative z-10 pointer-events-none",children:c.jsx("div",{className:"pointer-events-auto",children:t})})]})},fie=({isOpen:e,onClose:t,rawImageData:r,roi:n,selectedChannel:a,channelName:i,zIndex:o,onFocus:s,initialPosition:l})=>{const u=_.useRef(null),[d,f]=_.useState(!1),[h,g]=_.useState(null),[b,w]=_.useState(null),[v,x]=_.useState(!0),[m,k]=_.useState(!0),[P,j]=_.useState("-1"),[S,M]=_.useState("8"),[O,E]=_.useState(64),[I,D]=_.useState(45),[B,z]=_.useState(60),Y=_.useRef(!1),G=_.useRef({x:0,y:0});_.useEffect(()=>{!e||!r||!n||(f(!0),w(null),setTimeout(()=>{try{const V=M8(r.data,r.width,r.height,n,a,m);V?g(V):w("Could not extract valid data from ROI.")}catch(V){console.error("2D FFT Error",V),w("Calculation Error: "+V.message)}finally{f(!1)}},50))},[e,r,n,a,m]),_.useEffect(()=>{if(!h||!u.current)return;const V=u.current,J=V.getContext("2d");if(!J)return;const K=V.width,Q=V.height;J.clearRect(0,0,K,Q),J.fillStyle="#0f172a",J.fillRect(0,0,K,Q);const te=h.width,ee=h.height,me=h.data,re=Math.pow(10,parseFloat(P)||-1),De=Math.pow(10,parseFloat(S)||8);let fe=re,le=De;v&&(fe=Math.log10(Math.max(1e-10,re)),le=Math.log10(Math.max(1e-10,De)));const de=le-fe||1,Se=K/2,he=Q/2+50,Pe=Math.min(K,Q)*.4,ve=.6,ye=I*Math.PI/180,ge=B*Math.PI/180,ue=Math.cos(ye),Le=Math.sin(ye),rt=Math.cos(ge),et=Math.sin(ge),tt=(Ot,pr,br)=>{const jr=Ot*ue-pr*Le,Rr=Ot*Le+pr*ue,Pr=Rr*rt-br*et,Kt=Rr*et+br*rt;return{x:Se+jr*Pe,y:he-Pr*Pe,depth:Kt}},ft=Math.max(16,O),wt=Math.max(1,Math.floor(te/ft)),fr=Math.max(1,Math.floor(ee/ft)),Wt=(Ot,pr)=>{let br=me[pr*te+Ot];return v&&(br=Math.log10(Math.max(1e-10,br))),br=Math.max(fe,Math.min(le,br)),(br-fe)/de},kt=Ot=>`hsl(${(1-Ot)*240}, 80%, 50%)`,Bt=[];for(let Ot=0;Ot<ee-fr;Ot+=fr)for(let pr=0;pr<te-wt;pr+=wt){const br=pr,jr=Ot,Rr=pr+wt,Pr=Ot,Kt=pr+wt,Er=Ot+fr,jt=pr,Me=Ot+fr,X=Wt(br,jr),Te=Wt(Rr,Pr),xe=Wt(Kt,Er),ze=Wt(jt,Me),Je=(X+Te+xe+ze)/4,ot=tt(br/(te-1)-.5,jr/(ee-1)-.5,X*ve),Pt=tt(Rr/(te-1)-.5,Pr/(ee-1)-.5,Te*ve),Qe=tt(Kt/(te-1)-.5,Er/(ee-1)-.5,xe*ve),_r=tt(jt/(te-1)-.5,Me/(ee-1)-.5,ze*ve),sr=(ot.depth+Pt.depth+Qe.depth+_r.depth)/4;Bt.push({pts:[{x:ot.x,y:ot.y},{x:Pt.x,y:Pt.y},{x:Qe.x,y:Qe.y},{x:_r.x,y:_r.y}],avgDepth:sr,avgZ:Je})}Bt.sort((Ot,pr)=>Ot.avgDepth-pr.avgDepth),J.lineWidth=.5,Bt.forEach(Ot=>{J.fillStyle=kt(Ot.avgZ),J.beginPath(),J.moveTo(Ot.pts[0].x,Ot.pts[0].y),J.lineTo(Ot.pts[1].x,Ot.pts[1].y),J.lineTo(Ot.pts[2].x,Ot.pts[2].y),J.lineTo(Ot.pts[3].x,Ot.pts[3].y),J.closePath(),J.fill()}),J.fillStyle="#aaa",J.font="10px monospace";const Sr=tt(-.5,-.5,0),Gr=tt(.5,-.5,0),rr=tt(-.5,.5,0),Nr=tt(.5,.5,0);J.strokeStyle="#666",J.beginPath(),J.moveTo(Sr.x,Sr.y),J.lineTo(Gr.x,Gr.y),J.lineTo(Nr.x,Nr.y),J.lineTo(rr.x,rr.y),J.closePath(),J.stroke(),J.fillText("0",Sr.x-10,Sr.y+10),J.fillText("Fx",Gr.x+5,Gr.y),J.fillText("Fy",rr.x-15,rr.y);const nt=tt(-.5,-.5,ve);J.strokeStyle="#fff",J.beginPath(),J.moveTo(Sr.x,Sr.y),J.lineTo(nt.x,nt.y),J.stroke(),J.fillText(`10^${S}`,nt.x-25,nt.y),J.fillText(`10^${P}`,Sr.x-25,Sr.y)},[h,v,I,B,P,S,O]);const $=V=>{Y.current=!0,G.current={x:V.clientX,y:V.clientY}},L=V=>{if(!Y.current)return;const J=V.clientX-G.current.x,K=V.clientY-G.current.y;D(Q=>Q-J*.5),z(Q=>Math.max(0,Math.min(90,Q+K*.5))),G.current={x:V.clientX,y:V.clientY}},U=()=>{Y.current=!1};return e?c.jsxs(ml,{initialPosition:l||{x:100,y:100},onClose:t,zIndex:o,onFocus:s,className:"w-[700px] h-[600px] bg-slate-900 border border-slate-700 flex flex-col overflow-hidden shadow-2xl",children:[c.jsxs("div",{className:"flex justify-between items-center px-4 py-2 border-b border-slate-700 bg-slate-800",children:[c.jsxs("h3",{className:"text-sm font-bold text-slate-200 flex items-center gap-2",children:["2D FFT Power Spectrum - ",i,h&&c.jsxs("span",{className:"text-[10px] font-normal text-slate-400 bg-slate-700 px-2 py-0.5 rounded",children:[h.width,"x",h.height," (Chirp-Z)"]})]}),c.jsx("div",{className:"flex items-center gap-2",children:c.jsx("button",{onClick:t,className:"text-slate-400 hover:text-red-400 transition-colors",children:c.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})})]}),c.jsxs("div",{className:"p-3 bg-slate-800/80 flex flex-wrap gap-4 text-xs items-center border-b border-slate-700",children:[c.jsxs("div",{className:"flex items-center gap-2 bg-slate-900 px-2 py-1 rounded border border-slate-600",children:[c.jsx("span",{className:"text-slate-400 font-bold",children:"Range (10^x):"}),c.jsx("input",{type:"number",value:P,onChange:V=>j(V.target.value),className:"w-10 bg-transparent text-slate-200 text-center border-b border-slate-600 focus:border-cyan-500 outline-none"}),c.jsx("span",{className:"text-slate-500",children:"to"}),c.jsx("input",{type:"number",value:S,onChange:V=>M(V.target.value),className:"w-10 bg-transparent text-slate-200 text-center border-b border-slate-600 focus:border-cyan-500 outline-none"})]}),c.jsxs("div",{className:"flex items-center gap-2 bg-slate-900 px-2 py-1 rounded border border-slate-600",children:[c.jsx("span",{className:"text-slate-400 font-bold",children:"Density:"}),c.jsx("input",{type:"range",min:"16",max:"128",step:"16",value:O,onChange:V=>E(Number(V.target.value)),className:"w-20 h-1.5 bg-slate-700 rounded-lg appearance-none cursor-pointer accent-cyan-500"}),c.jsx("span",{className:"text-slate-300 w-6 text-right",children:O})]}),c.jsxs("label",{className:"flex items-center gap-1 cursor-pointer select-none text-slate-300 hover:text-white",children:[c.jsx("input",{type:"checkbox",checked:v,onChange:V=>x(V.target.checked),className:"rounded bg-slate-700 border-slate-600 accent-cyan-500"}),"Log Z"]}),c.jsxs("label",{className:"flex items-center gap-1 cursor-pointer select-none text-slate-300 hover:text-white",children:[c.jsx("input",{type:"checkbox",checked:m,onChange:V=>k(V.target.checked),className:"rounded bg-slate-700 border-slate-600 accent-fuchsia-500"}),"Hanning"]})]}),c.jsxs("div",{className:"flex-1 relative bg-slate-900 cursor-move",children:[d&&c.jsx("div",{className:"absolute inset-0 flex items-center justify-center bg-slate-900/80 z-20 backdrop-blur-sm",children:c.jsxs("div",{className:"flex flex-col items-center gap-2",children:[c.jsx("div",{className:"w-8 h-8 border-4 border-cyan-500 border-t-transparent rounded-full animate-spin"}),c.jsx("span",{className:"text-cyan-400 font-bold animate-pulse text-sm",children:"Computing full-size 2D FFT..."})]})}),b&&c.jsx("div",{className:"absolute inset-0 flex items-center justify-center bg-slate-900/80 z-20 text-red-400 p-4 text-center",children:b}),c.jsx("canvas",{ref:u,width:700,height:500,className:"w-full h-full block",onMouseDown:$,onMouseMove:L,onMouseUp:U,onMouseLeave:U}),c.jsx("div",{className:"absolute bottom-2 right-2 text-[9px] text-slate-600 pointer-events-none",children:"Drag to Rotate"})]})]}):null},hie=.5,U1=1e-10,U4=(e,t)=>{const r=e.length-1;if(r<0)return U1;const n=t/hie*r,a=Math.round(n),i=e[Math.min(Math.max(0,a),r)]||0;return Math.max(i,U1)},pie=(e,t)=>{if(t<=0)return[1];const r=new Array(e);let n=0;for(let a=0;a<e;a++){const i=a-(e-1)/2,o=Math.exp(-(i*i)/(2*t*t));r[a]=o,n+=o}for(let a=0;a<e;a++)r[a]/=n;return r},gie=({isOpen:e,onClose:t,onMinimize:r,rawImageData:n,roi:a,isBGGR:i,onUpdateROI:o,zIndex:s,onFocus:l,initialPosition:u,initialInternalState:d,onUpdateState:f,stackFiles:h})=>{const[g,b]=_.useState((d==null?void 0:d.selectedChannel)??0),[w,v]=_.useState(()=>(d==null?void 0:d.yMinExp)||localStorage.getItem("fft_y_min")||"1.73"),[x,m]=_.useState(()=>(d==null?void 0:d.yMaxExp)||localStorage.getItem("fft_y_max")||"8.00"),[k,P]=_.useState((d==null?void 0:d.useHanning)??!0),[j,S]=_.useState((d==null?void 0:d.doAverage)??!0),[M,O]=_.useState((d==null?void 0:d.welchSegments)??1),[E,I]=_.useState((d==null?void 0:d.showH)??!0),[D,B]=_.useState((d==null?void 0:d.showV)??!0),[z,Y]=_.useState((d==null?void 0:d.interlaceRows)??!1),[G,$]=_.useState((d==null?void 0:d.rowGroup)??0),[L,U]=_.useState((d==null?void 0:d.interlaceCols)??!1),[V,J]=_.useState((d==null?void 0:d.colGroup)??0),[K,Q]=_.useState(()=>(d==null?void 0:d.theoSigma)||localStorage.getItem("fft_theo_sigma")||"0.00"),[te,ee]=_.useState(()=>(d==null?void 0:d.theoKernelSize)||localStorage.getItem("fft_theo_ksize")||"3"),[me,re]=_.useState(()=>(d==null?void 0:d.theoNoiseStd)||localStorage.getItem("fft_theo_noise")||"7.5"),[De,fe]=_.useState(()=>(d==null?void 0:d.theoScale)||localStorage.getItem("fft_theo_scale")||"1.0"),[le,de]=_.useState((d==null?void 0:d.intStart)||"0"),[Se,he]=_.useState((d==null?void 0:d.intEnd)||"0.5"),[Pe,ve]=_.useState(!1),[ye,ge]=_.useState([]),[ue,Le]=_.useState(!1),[rt,et]=_.useState(0),[tt,ft]=_.useState(null),[wt,fr]=_.useState(!1),[Wt,kt]=_.useState(!1),[Bt,Sr]=_.useState(null),[Gr,rr]=_.useState(!1),[Nr,nt]=_.useState(null),[Ot,pr]=_.useState(u||{x:50,y:50}),[br,jr]=_.useState(!1),[Rr,Pr]=_.useState(null),[Kt,Er]=_.useState({}),jt=_.useRef({x:0,y:0}),Me=i?{c0:"#3b82f6",c1:"#22c55e",c2:"#4ade80",c3:"#ef4444"}:{c0:"#ef4444",c1:"#22c55e",c2:"#4ade80",c3:"#3b82f6"},X=_.useMemo(()=>i?{0:"Blue",1:"Green 1",2:"Green 2",3:"Red"}:{0:"Red",1:"Green 1",2:"Green 2",3:"Blue"},[i]);_.useEffect(()=>{localStorage.setItem("fft_y_min",w),localStorage.setItem("fft_y_max",x),localStorage.setItem("fft_theo_sigma",K),localStorage.setItem("fft_theo_ksize",te),localStorage.setItem("fft_theo_noise",me),localStorage.setItem("fft_theo_scale",De)},[w,x,K,te,me,De]),_.useEffect(()=>{if(!e||!n||!a)return;Le(!0),ft(null),et(0);const A=setTimeout(async()=>{try{const Ge=g===-1?[0,1,2,3]:[g],Ke=h&&h.length>1?h:[null],Yt=Ke.length,Ht={};let At={h:0,v:0};for(let ut=0;ut<Yt;ut++){et(ut+1);let Dt;if(Ke[ut]){const Vt=await Ke[ut].arrayBuffer();Dt=await pu(Vt)}else Dt=n;for(const Vt of Ge){const ar=C8(Dt.data,Dt.width,Dt.height,a,Vt,!1,k,{rows:z,rowGroup:G,cols:L,colGroup:V},j,M);ar&&(Ht[Vt]||(Ht[Vt]={h:new Array(ar.avgHoriz.length).fill(0),v:new Array(ar.avgVert.length).fill(0)}),ar.avgHoriz.forEach((St,_e)=>Ht[Vt].h[_e]+=St/Yt),ar.avgVert.forEach((St,_e)=>Ht[Vt].v[_e]+=St/Yt),At=ar.sampleCount)}}if(Object.keys(Ht).length===0)throw new Error("ROI too small or no data found.");const yr=1024,Xr=[];for(let ut=0;ut<yr;ut++){const Dt=ut/(yr-1)*.5,Vt={freq:parseFloat(Dt.toFixed(6))};for(const ar of Ge)Ht[ar]&&(Vt[`c${ar}_h`]=U4(Ht[ar].h,Dt),Vt[`c${ar}_v`]=U4(Ht[ar].v,Dt));Xr.push(Vt)}Pr(At),ge(Xr)}catch(Ge){console.error("FFT Loop Failed:",Ge),ft(Ge.message||"Unknown error during FFT processing")}finally{Le(!1)}},100);return()=>clearTimeout(A)},[e,n,a==null?void 0:a.x,a==null?void 0:a.y,a==null?void 0:a.w,a==null?void 0:a.h,g,k,j,M,z,G,L,V,h]);const Te=()=>{const A=parseFloat(le),Ge=parseFloat(Se);if(isNaN(A)||isNaN(Ge))return;const Ke={},Yt=g===-1?[0,1,2,3]:[g],Ht=ye.filter(At=>At.freq>=A&&At.freq<=Ge);if(Ht.length===0){Er({});return}Yt.forEach(At=>{let yr=0,Xr=0;Ht.forEach(ut=>{const Dt=ut[`c${At}_h`],Vt=ut[`c${At}_v`];typeof Dt=="number"&&(yr+=Dt),typeof Vt=="number"&&(Xr+=Vt)}),Ke[At]={h:yr/Ht.length,v:Xr/Ht.length,count:Ht.length}}),Er(Ke)},xe=_.useMemo(()=>{const A=parseFloat(K),Ge=parseInt(te),Ke=parseFloat(me),Yt=parseFloat(De);if(isNaN(A)||isNaN(Ge)||isNaN(Ke)||isNaN(Yt)||ye.length===0)return ye;const Ht=pie(Ge,A),At=Ht.reduce((ut,Dt)=>ut+Dt*Dt,0),yr=(Ge-1)/2,Xr=Ke*Ke*Yt;return ye.map(ut=>{const Dt=ut.freq,Vt=2*Math.PI*Dt;let ar=0,St=0;for(let Or=0;Or<Ge;Or++){const F=Or-yr,Ce=Ht[Or],Ee=-Vt*F;ar+=Ce*Math.cos(Ee),St+=Ce*Math.sin(Ee)}const _e=ar*ar+St*St;return{...ut,theory:Math.max(U1,Xr*At*_e)}})},[ye,K,te,me,De]),ze=A=>{A&&A.activeLabel!==void 0&&(rr(!0),nt(Number(A.activeLabel)),Sr(null))},Je=A=>{if(Gr&&Nr!==null&&A&&A.activeLabel!==void 0){const Ge=Number(A.activeLabel);Sr([Math.min(Nr,Ge),Math.max(Nr,Ge)])}},ot=()=>rr(!1),Pt=(A,Ge,Ke)=>{l&&l(),!(Ke.closest("button")||Ke.closest("input"))&&(jr(!0),jt.current={x:A-Ot.x,y:Ge-Ot.y})},Qe=A=>{Pt(A.clientX,A.clientY,A.target)},_r=A=>{const Ge=A.touches[0];Pt(Ge.clientX,Ge.clientY,A.target)};_.useEffect(()=>{const A=Ke=>{if(br){const Yt="touches"in Ke?Ke.touches[0].clientX:Ke.clientX,Ht="touches"in Ke?Ke.touches[0].clientY:Ke.clientY;pr({x:Yt-jt.current.x,y:Ht-jt.current.y})}},Ge=()=>jr(!1);return br&&(window.addEventListener("mousemove",A),window.addEventListener("mouseup",Ge),window.addEventListener("touchmove",A,{passive:!1}),window.addEventListener("touchend",Ge)),()=>{window.removeEventListener("mousemove",A),window.removeEventListener("mouseup",Ge),window.removeEventListener("touchmove",A),window.removeEventListener("touchend",Ge)}},[br]);const sr=_.useMemo(()=>{if(!Bt||ye.length===0)return null;const[A,Ge]=Bt,Ke=ye.filter(At=>At.freq>=A&&At.freq<=Ge);if(Ke.length===0)return null;const Yt=g===-1?[0,1,2,3]:[g],Ht={};return Yt.forEach(At=>{["h","v"].forEach(yr=>{const Xr=`c${At}_${yr}`;let ut=0,Dt=0;for(const Vt of Ke){const ar=Vt[Xr];typeof ar=="number"&&(ut+=ar,Dt++)}Dt>0&&(Ht[`${Xr}_sigma`]=Math.sqrt(ut/Dt))})}),{count:Ke.length,stats:Ht}},[Bt,ye,g]),Jt=()=>{if(ye.length===0)return;let A=1/0,Ge=-1/0;if(ye.forEach(yr=>{yr.freq<.01||yr.freq>.49||Object.keys(yr).forEach(Xr=>{if(Xr==="freq"||Xr==="theory")return;const ut=yr[Xr];typeof ut=="number"&&ut>0&&(ut<A&&(A=ut),ut>Ge&&(Ge=ut))})}),A===1/0)return;const Ke=Math.log10(A),Yt=Math.log10(Ge),Ht=Yt-Ke,At=(Ht===0?1:Ht)*.1;v((Ke-At).toFixed(2)),m((Yt+At).toFixed(2))},vt=(A,Ge)=>{a&&o&&o({...a,x:a.x+A,y:a.y+Ge})},nr=(A,Ge)=>{a&&o&&o({...a,w:Math.max(2,a.w+A),h:Math.max(2,a.h+Ge)})};return e?c.jsxs("div",{className:"fixed flex flex-col bg-white dark:bg-slate-900 border border-gray-200 dark:border-slate-700 shadow-2xl rounded-xl overflow-hidden resize-both min-w-[750px] min-h-[500px]",style:{left:Ot.x,top:Ot.y,width:"1000px",height:"850px",zIndex:s??100},onMouseDownCapture:l,children:[c.jsxs("div",{className:`flex justify-between items-center p-3 border-b border-gray-200 dark:border-slate-700 flex-shrink-0 bg-gray-50 dark:bg-slate-800 z-50 relative select-none touch-none ${br?"cursor-grabbing":"cursor-grab"}`,onMouseDown:Qe,onTouchStart:_r,children:[c.jsxs("h2",{className:"text-lg font-bold text-gray-900 dark:text-slate-100 flex items-center gap-2 pointer-events-none",children:["Power Spectrum Analysis",c.jsx("span",{className:"text-[10px] font-normal bg-white dark:bg-slate-700 px-2 py-1 rounded text-gray-500 border border-gray-200 dark:border-slate-600 shadow-sm",children:h&&h.length>1?`Stack Avg (${h.length} frames)`:"Single Mode"})]}),c.jsxs("div",{className:"flex items-center gap-1",children:[r&&c.jsx("button",{onClick:r,className:"text-gray-400 hover:text-gray-600 dark:hover:text-slate-300 p-2 rounded-lg hover:bg-gray-200 dark:hover:bg-slate-700 transition-colors",children:c.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M20 12H4"})})}),c.jsx("button",{onClick:t,className:"text-gray-400 hover:text-red-500 dark:hover:text-red-400 p-2 rounded-lg hover:bg-gray-200 dark:hover:bg-slate-700 transition-colors",children:c.jsx("svg",{className:"w-6 h-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]})]}),c.jsxs("div",{className:"flex flex-col bg-gray-50 dark:bg-slate-900/80 border-b border-gray-200 dark:border-slate-800 flex-shrink-0 z-40 relative px-4 py-3 gap-3 overflow-x-auto",children:[c.jsxs("div",{className:"flex items-center gap-6",children:[c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx("span",{className:"text-[10px] font-bold text-gray-500 dark:text-slate-400 uppercase tracking-widest",children:"Channel"}),c.jsxs("div",{className:"flex bg-gray-100 dark:bg-slate-800 rounded-lg p-0.5 border border-gray-200 dark:border-slate-700 shadow-inner",children:[c.jsx("button",{onClick:()=>b(-1),className:`px-3 py-1 rounded text-[10px] font-bold transition-all ${g===-1?"bg-slate-700 text-white shadow-md":"text-gray-500 dark:text-slate-500 hover:bg-white dark:hover:bg-slate-700"}`,children:"All"}),[0,1,2,3].map(A=>c.jsx("button",{onClick:()=>b(A),className:`px-3 py-1 rounded text-[10px] font-bold transition-all ${g===A?"bg-cyan-600 text-white shadow-md":"text-gray-500 dark:text-slate-500 hover:bg-white dark:hover:bg-slate-700"}`,children:X[A]},A))]})]}),c.jsx("div",{className:"h-6 w-px bg-gray-200 dark:bg-slate-700 mx-2"}),c.jsxs("button",{onClick:()=>ve(!0),className:"flex items-center gap-1.5 px-4 py-1.5 bg-indigo-600 hover:bg-indigo-500 text-white text-[10px] font-bold rounded-lg shadow-lg shadow-indigo-500/30 transition-all active:scale-95 group border border-indigo-400/30",children:[c.jsx("svg",{className:"w-3.5 h-3.5 group-hover:animate-pulse",fill:"currentColor",viewBox:"0 0 24 24",children:c.jsx("path",{d:"M13 10V3L4 14h7v7l9-11h-7z"})}),"2D Diagonal"]}),c.jsx("div",{className:"h-6 w-px bg-gray-200 dark:bg-slate-700 mx-2"}),c.jsxs("div",{className:"flex items-center gap-3",children:[c.jsx("span",{className:"text-[10px] font-bold text-indigo-500 dark:text-indigo-400 uppercase tracking-widest",children:"Model"}),c.jsx("div",{className:"flex gap-2",children:[{label:"KSize",val:te,set:ee,w:"w-10"},{label:"Sigma",val:K,set:Q,w:"w-12"},{label:"Noise()",val:me,set:re,w:"w-12"},{label:"Scale",val:De,set:fe,w:"w-12"}].map(A=>c.jsxs("div",{className:"flex flex-col items-center",children:[c.jsx("label",{className:"text-[8px] text-gray-400 dark:text-slate-500 uppercase font-bold mb-0.5",children:A.label}),c.jsx("input",{type:"text",value:A.val,onChange:Ge=>A.set(Ge.target.value),className:`${A.w} text-[11px] bg-white dark:bg-slate-800 border border-gray-200 dark:border-slate-700 rounded px-1.5 py-0.5 text-center text-gray-900 dark:text-slate-100 outline-none focus:border-indigo-500 shadow-sm`})]},A.label))})]})]}),c.jsxs("div",{className:"flex items-center gap-4 flex-wrap",children:[c.jsxs("div",{className:"flex items-center gap-3 mr-2",children:[c.jsx("span",{className:"text-[10px] font-bold text-fuchsia-600 dark:text-fuchsia-500 uppercase tracking-widest",children:"Welch"}),c.jsx("input",{type:"range",min:"1",max:"16",step:"1",value:M,onChange:A=>O(parseInt(A.target.value)),className:"w-24 h-1.5 bg-gray-300 dark:bg-slate-700 rounded-lg appearance-none cursor-pointer accent-fuchsia-500"}),c.jsx("span",{className:"text-[10px] font-mono text-fuchsia-600 dark:text-fuchsia-400 w-4 font-bold",children:M})]}),c.jsx("div",{className:"h-6 w-px bg-gray-200 dark:bg-slate-700"}),c.jsxs("div",{className:"flex flex-col gap-1 px-2",children:[c.jsxs("label",{className:"flex items-center gap-1.5 cursor-pointer text-[10px] text-gray-500 dark:text-slate-400 hover:text-gray-900 dark:hover:text-slate-200 select-none",children:[c.jsx("input",{type:"checkbox",checked:z,onChange:A=>Y(A.target.checked),className:"w-3 h-3 rounded text-cyan-600 border-gray-300 dark:border-slate-700 bg-white dark:bg-slate-800"})," Row Int."]}),c.jsxs("label",{className:"flex items-center gap-1.5 cursor-pointer text-[10px] text-gray-500 dark:text-slate-400 hover:text-gray-900 dark:hover:text-slate-200 select-none",children:[c.jsx("input",{type:"checkbox",checked:L,onChange:A=>U(A.target.checked),className:"w-3 h-3 rounded text-cyan-600 border-gray-300 dark:border-slate-700 bg-white dark:bg-slate-800"})," Col Int."]})]}),c.jsxs("div",{className:"flex flex-col gap-1.5 bg-gray-100 dark:bg-slate-800/60 p-1.5 rounded-lg border border-gray-200 dark:border-slate-700",children:[c.jsxs("label",{className:"flex items-center gap-2 cursor-pointer select-none",children:[c.jsx("div",{className:`w-3.5 h-3.5 rounded-md border flex items-center justify-center transition-colors ${k?"bg-fuchsia-600 border-fuchsia-600":"bg-white dark:bg-slate-900 border-gray-300 dark:border-slate-600"}`,children:k&&c.jsx("svg",{className:"w-2.5 h-2.5 text-white",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:4,children:c.jsx("path",{d:"M5 13l4 4L19 7"})})}),c.jsx("input",{type:"checkbox",checked:k,onChange:A=>P(A.target.checked),className:"hidden"}),c.jsx("span",{className:"text-[10px] font-bold text-gray-700 dark:text-slate-300",children:"Hanning"})]}),c.jsxs("label",{className:"flex items-center gap-2 cursor-pointer select-none",children:[c.jsx("div",{className:`w-3.5 h-3.5 rounded-md border flex items-center justify-center transition-colors ${j?"bg-cyan-600 border-cyan-600":"bg-white dark:bg-slate-900 border-gray-300 dark:border-slate-600"}`,children:j&&c.jsx("svg",{className:"w-2.5 h-2.5 text-white",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:4,children:c.jsx("path",{d:"M5 13l4 4L19 7"})})}),c.jsx("input",{type:"checkbox",checked:j,onChange:A=>S(A.target.checked),className:"hidden"}),c.jsx("span",{className:"text-[10px] font-bold text-gray-700 dark:text-slate-300",children:"Average"})]})]}),c.jsxs("div",{className:"flex gap-2 bg-gray-100 dark:bg-slate-800 p-1 rounded-lg border border-gray-200 dark:border-slate-700",children:[c.jsxs("button",{onClick:()=>I(!E),className:`px-2.5 py-1 rounded-md border text-[11px] font-bold transition-all flex items-center gap-1.5 ${E?"bg-cyan-900/40 text-cyan-400 border-cyan-500 shadow-[0_0_8px_rgba(6,182,212,0.3)]":"bg-white dark:bg-slate-900 text-gray-400 border-gray-300 dark:border-slate-700"}`,children:[c.jsx("div",{className:`w-2 h-2 rounded-full ${E?"bg-cyan-400":"bg-gray-400"}`})," H"]}),c.jsxs("button",{onClick:()=>B(!D),className:`px-2.5 py-1 rounded-md border text-[11px] font-bold transition-all flex items-center gap-1.5 ${D?"bg-cyan-900/40 text-cyan-400 border-cyan-500 shadow-[0_0_8px_rgba(6,182,212,0.3)]":"bg-white dark:bg-slate-900 text-gray-400 border-gray-300 dark:border-slate-700"}`,children:[c.jsx("div",{className:`w-2 h-2 rounded-full ${E?"bg-cyan-400":"bg-gray-400"}`})," V"]})]}),c.jsxs("div",{className:"ml-auto flex gap-2",children:[c.jsx("button",{onClick:()=>kt(!Wt),className:`px-3 py-1.5 rounded-lg text-[10px] font-bold transition-all border ${Wt?"bg-emerald-600 text-white border-emerald-600 shadow-md":"bg-white dark:bg-slate-900 text-emerald-600 dark:text-emerald-400 border-emerald-200 dark:border-emerald-800 hover:bg-emerald-50"}`,children:""}),c.jsx("button",{onClick:()=>fr(!wt),className:`px-3 py-1.5 rounded-lg text-[10px] font-bold transition-all border ${wt?"bg-indigo-600 text-white border-indigo-600 shadow-md":"bg-white dark:bg-slate-900 text-indigo-600 dark:text-indigo-400 border-indigo-200 dark:border-indigo-800 hover:bg-indigo-50"}`,children:"ROI"})]})]}),c.jsxs("div",{className:"flex items-center gap-4 justify-end border-t border-gray-200 dark:border-slate-800/50 pt-2.5",children:[c.jsx("button",{onClick:Jt,className:"px-4 py-1 text-[10px] font-bold bg-cyan-600/10 text-cyan-600 dark:text-cyan-400 hover:bg-cyan-600/20 rounded-md border border-cyan-500/30 transition-all uppercase tracking-widest shadow-sm",children:"Auto"}),c.jsxs("div",{className:"flex items-center gap-2 text-[10px] font-bold text-gray-500 dark:text-slate-400 uppercase",children:["Y-AXIS (LOG)",c.jsxs("div",{className:"flex items-center bg-white dark:bg-slate-800 border border-gray-200 dark:border-slate-700 rounded-md overflow-hidden shadow-sm",children:[c.jsx("input",{type:"text",value:w,onChange:A=>v(A.target.value),className:"w-14 px-2 py-1 bg-transparent text-center outline-none text-gray-900 dark:text-slate-100 border-r border-gray-200 dark:border-slate-700"}),c.jsx("span",{className:"px-2 text-gray-400",children:"to"}),c.jsx("input",{type:"text",value:x,onChange:A=>m(A.target.value),className:"w-14 px-2 py-1 bg-transparent text-center outline-none text-gray-900 dark:text-slate-100"})]})]})]})]}),c.jsxs("div",{className:"flex-1 p-4 overflow-hidden flex flex-col gap-2 relative bg-gray-50/30 dark:bg-slate-900/30",children:[c.jsx("div",{className:"absolute inset-0 flex items-center justify-center pointer-events-none z-[50] select-none opacity-10",children:c.jsx("svg",{viewBox:"0 0 500 100",className:"w-3/4 h-auto drop-shadow-lg",children:c.jsx("text",{x:"50%",y:"50%",dominantBaseline:"middle",textAnchor:"middle",className:"fill-gray-900 dark:fill-white",fontSize:"24",fontWeight:"bold",style:{fontFamily:"sans-serif",letterSpacing:"0.05em"},children:" y-g-jiang.github.io"})})}),ue&&c.jsxs("div",{className:"absolute inset-0 flex flex-col items-center justify-center z-[55] bg-white/90 dark:bg-slate-900/90 backdrop-blur-[2px]",children:[c.jsx("div",{className:"w-10 h-10 border-4 border-cyan-500 border-t-transparent rounded-full animate-spin mb-4"}),c.jsx("span",{className:"text-cyan-600 dark:text-cyan-400 font-bold",children:"Computing FFT Stack..."}),h&&h.length>1&&c.jsxs("span",{className:"text-xs text-gray-500 mt-2 font-mono",children:["Processing frame ",rt," / ",h.length]})]}),tt?c.jsx("div",{className:"flex items-center justify-center h-full text-red-500 font-semibold",children:tt}):c.jsxs("div",{className:"flex-1 bg-white dark:bg-slate-950 border border-gray-200 dark:border-slate-800 rounded-xl p-2 flex flex-col relative z-20 shadow-xl overflow-hidden",children:[c.jsx("div",{className:"flex-1 relative z-10",onMouseDown:ze,onMouseMove:Je,onMouseUp:ot,style:{cursor:Gr?"col-resize":"crosshair"},children:c.jsx(_o,{width:"100%",height:"100%",children:c.jsxs(zl,{data:xe,margin:{top:10,right:10,bottom:20,left:0},children:[c.jsx(so,{strokeDasharray:"3 3",stroke:"#374151",opacity:.08}),c.jsx(Xa,{dataKey:"freq",type:"number",domain:[0,.5],tickCount:6,tick:{fill:"#6b7280",fontSize:10},label:{value:"Frequency (cy/px)",position:"insideBottom",offset:-10,fill:"#6b7280",fontSize:11}}),c.jsx(Ka,{scale:"log",domain:[Math.pow(10,parseFloat(w)),Math.pow(10,parseFloat(x))],allowDataOverflow:!0,tick:{fill:"#6b7280",fontSize:10},tickFormatter:A=>Number(A).toExponential(0),width:45}),c.jsx(ra,{contentStyle:{backgroundColor:"rgba(15, 23, 42, 0.95)",border:"1px solid #334155",color:"#f3f4f6",fontSize:"11px",borderRadius:"8px"},formatter:A=>[Number(A).toExponential(3),""],labelFormatter:A=>`Freq: ${Number(A).toFixed(4)}`}),c.jsx(To,{wrapperStyle:{fontSize:"10px"}}),c.jsx(En,{type:"monotone",dataKey:"theory",name:"Theory Model",stroke:"#6366f1",strokeWidth:2,dot:!1,isAnimationActive:!1}),[0,1,2,3].flatMap(A=>{if(g!==-1&&g!==A)return[];const Ge=`c${A}_h`,Ke=`c${A}_v`,Yt=Me[`c${A}`],Ht=[];return E&&Ht.push(c.jsx(En,{type:"linear",dataKey:Ge,name:`${X[A]} (H)`,stroke:Yt,strokeWidth:1,dot:!1,isAnimationActive:!1},`${A}_h`)),D&&Ht.push(c.jsx(En,{type:"linear",dataKey:Ke,name:`${X[A]} (V)`,stroke:Yt,strokeWidth:1,strokeDasharray:"3 3",dot:!1,isAnimationActive:!1},`${A}_v`)),Ht}),Bt&&c.jsx(P0,{x1:Bt[0],x2:Bt[1],fill:"#8884d8",fillOpacity:.15})]})})}),sr&&Bt&&c.jsxs("div",{className:"absolute bottom-12 left-12 bg-slate-900/90 backdrop-blur-md p-3 rounded-lg border border-indigo-500/50 shadow-2xl z-30 text-[10px] font-mono text-slate-100",children:[c.jsxs("div",{className:"text-indigo-400 font-bold mb-1 border-b border-indigo-500/30 pb-1",children:["Range: ",Bt[0].toFixed(3),"-",Bt[1].toFixed(3)]}),Object.entries(sr.stats).map(([A,Ge])=>c.jsxs("div",{className:"flex justify-between gap-4",children:[c.jsxs("span",{className:"text-slate-400",children:[A,":"]}),c.jsx("span",{className:"font-bold text-cyan-400",children:Ge.toFixed(5)})]},A))]})]})]}),Wt&&c.jsxs("div",{className:"absolute top-48 right-8 z-[55] w-72 bg-white dark:bg-slate-900 rounded-xl shadow-2xl border border-gray-200 dark:border-slate-700 p-4 animate-in slide-in-from-top-2",children:[c.jsx("h4",{className:"text-[10px] uppercase font-bold text-emerald-600 dark:text-emerald-400 mb-2 border-b border-gray-100 dark:border-slate-800 pb-1",children:"Range Averaging"}),c.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[c.jsx("input",{type:"number",step:"0.01",value:le,onChange:A=>de(A.target.value),className:"w-16 px-1 py-0.5 text-xs border rounded bg-transparent dark:border-slate-600 dark:text-white"}),c.jsx("span",{className:"text-gray-400",children:"-"}),c.jsx("input",{type:"number",step:"0.01",value:Se,onChange:A=>he(A.target.value),className:"w-16 px-1 py-0.5 text-xs border rounded bg-transparent dark:border-slate-600 dark:text-white"}),c.jsx("button",{onClick:Te,className:"flex-1 bg-emerald-600 text-white text-[10px] font-bold py-1 rounded",children:"Avg"})]}),c.jsx("div",{className:"flex flex-col gap-2 max-h-48 overflow-y-auto",children:[0,1,2,3].map(A=>{const Ge=Kt[A];if(!Ge)return null;const Ke=Me[`c${A}`];return c.jsxs("div",{className:"bg-gray-50 dark:bg-slate-800/50 p-2 rounded text-[10px] border border-gray-100 dark:border-slate-800",children:[c.jsxs("div",{className:"flex items-center gap-2 font-bold mb-1",style:{color:Ke},children:[X[A]," ",c.jsxs("span",{className:"text-gray-400 font-normal",children:["(",Ge.count," pts)"]})]}),c.jsxs("div",{className:"grid grid-cols-2 gap-x-2 text-gray-700 dark:text-slate-300 font-mono",children:[c.jsxs("div",{children:["H: ",Ge.h.toExponential(3)]}),c.jsxs("div",{children:["V: ",Ge.v.toExponential(3)]})]})]},A)})})]}),wt&&c.jsx("div",{className:"absolute top-48 right-8 z-[55] w-56 bg-white dark:bg-slate-900 rounded-xl shadow-2xl border border-gray-200 dark:border-slate-700 p-4 animate-in slide-in-from-top-2",children:c.jsxs("div",{className:"flex flex-col gap-3",children:[c.jsxs("div",{children:[c.jsx("h4",{className:"text-[9px] uppercase font-bold text-gray-400 mb-1",children:"Move"}),c.jsxs("div",{className:"grid grid-cols-3 gap-1",children:[c.jsx("div",{}),c.jsx("button",{onClick:()=>vt(0,-1),className:"p-1.5 bg-gray-100 dark:bg-slate-800 rounded",children:""}),c.jsx("div",{}),c.jsx("button",{onClick:()=>vt(-1,0),className:"p-1.5 bg-gray-100 dark:bg-slate-800 rounded",children:""}),c.jsx("div",{}),c.jsx("button",{onClick:()=>vt(1,0),className:"p-1.5 bg-gray-100 dark:bg-slate-800 rounded",children:""}),c.jsx("div",{}),c.jsx("button",{onClick:()=>vt(0,1),className:"p-1.5 bg-gray-100 dark:bg-slate-800 rounded",children:""}),c.jsx("div",{})]})]}),c.jsxs("div",{children:[c.jsx("h4",{className:"text-[9px] uppercase font-bold text-gray-400 mb-1",children:"Size"}),c.jsxs("div",{className:"grid grid-cols-2 gap-1",children:[c.jsx("button",{onClick:()=>nr(2,0),className:"p-1 bg-gray-100 dark:bg-slate-800 rounded",children:"W+"}),c.jsx("button",{onClick:()=>nr(-2,0),className:"p-1 bg-gray-100 dark:bg-slate-800 rounded",children:"W-"}),c.jsx("button",{onClick:()=>nr(0,2),className:"p-1 bg-gray-100 dark:bg-slate-800 rounded",children:"H+"}),c.jsx("button",{onClick:()=>nr(0,-2),className:"p-1 bg-gray-100 dark:bg-slate-800 rounded",children:"H-"})]})]})]})}),c.jsx(fie,{isOpen:Pe,onClose:()=>ve(!1),rawImageData:n,roi:a,selectedChannel:g===-1?0:g,channelName:g===-1?"Red (Default)":X[g],zIndex:s?s+2:102,onFocus:l})]}):null},mie=({isOpen:e,onClose:t,onMinimize:r,rawImageData:n,roi:a,isBGGR:i,zIndex:o,onFocus:s,initialPosition:l,initialInternalState:u,onUpdateState:d})=>{const[f,h]=_.useState((u==null?void 0:u.selectedChannelKey)||"G1"),[g,b]=_.useState((u==null?void 0:u.blackLevel)??0),[w,v]=_.useState((u==null?void 0:u.whiteLevel)??16383),[x,m]=_.useState(null),[k,P]=_.useState(!1),[j,S]=_.useState(null),[M,O]=_.useState(l||{x:150,y:150}),[E,I]=_.useState(!1),D=_.useRef({x:0,y:0});_.useEffect(()=>{d&&d({selectedChannelKey:f,blackLevel:g,whiteLevel:w})},[f,g,w]),_.useEffect(()=>{if(e&&n&&!u){const L=n.blackLevels?Math.floor(n.blackLevels[1]):0;b(L),v(n.whiteLevel||16383),m(null)}},[e,n]);const B=()=>{if(!n||!a)return;S(null),P(!0);const U=(i?{B:0,G1:1,G2:2,R:3}:{R:0,G1:1,G2:2,B:3})[f];setTimeout(()=>{try{const V=N8(n.data,n.width,n.height,a,U,g,w);V?m(V):(S("No data found in selection with current filters."),m(null))}catch(V){console.error("Analysis failed:",V),S(V.message||"Analysis error")}finally{P(!1)}},50)},z=(L,U,V)=>{s&&s(),!(V.closest("button")||V.closest("input")||V.closest("select"))&&(I(!0),D.current={x:L-M.x,y:U-M.y})},Y=L=>{z(L.clientX,L.clientY,L.target)},G=L=>{const U=L.touches[0];z(U.clientX,U.clientY,L.target)};if(_.useEffect(()=>{const L=V=>{if(E){const J="touches"in V?V.touches[0].clientX:V.clientX,K="touches"in V?V.touches[0].clientY:V.clientY;O({x:J-D.current.x,y:K-D.current.y})}},U=()=>I(!1);return E&&(window.addEventListener("mousemove",L),window.addEventListener("mouseup",U),window.addEventListener("touchmove",L,{passive:!1}),window.addEventListener("touchend",U)),()=>{window.removeEventListener("mousemove",L),window.removeEventListener("mouseup",U),window.removeEventListener("touchmove",L),window.removeEventListener("touchend",U)}},[E]),!e)return null;const $=i?["B","G1","G2","R"]:["R","G1","G2","B"];return c.jsxs("div",{className:"fixed flex flex-col bg-white dark:bg-slate-900 border border-gray-200 dark:border-slate-700 shadow-2xl rounded-xl resize-both overflow-hidden min-w-[500px] min-h-[400px] w-[900px] h-[700px]",style:{left:M.x,top:M.y,zIndex:o??100},onMouseDownCapture:s,children:[c.jsxs("div",{className:`flex justify-between items-center p-4 border-b border-gray-200 dark:border-slate-700 bg-white dark:bg-slate-900 select-none touch-none ${E?"cursor-grabbing":"cursor-grab"}`,onMouseDown:Y,onTouchStart:G,children:[c.jsx("h2",{className:"text-xl font-bold text-gray-900 dark:text-slate-100 flex items-center gap-2 pointer-events-none",children:"Quantization Step Analysis"}),c.jsxs("div",{className:"flex items-center gap-1",children:[r&&c.jsx("button",{onClick:r,className:"text-gray-400 hover:text-gray-600 dark:hover:text-slate-300 p-2 rounded-lg hover:bg-gray-100 dark:hover:bg-slate-800 transition-colors",children:c.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M20 12H4"})})}),c.jsx("button",{onClick:t,className:"text-gray-400 hover:text-gray-600 dark:hover:text-slate-200 p-2",children:c.jsx("svg",{className:"w-6 h-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]})]}),c.jsxs("div",{className:"p-4 bg-gray-50 dark:bg-slate-800/50 border-b border-gray-200 dark:border-slate-700 flex flex-wrap gap-4 items-end flex-shrink-0",children:[c.jsxs("div",{className:"flex flex-col gap-1",children:[c.jsx("label",{className:"text-xs font-bold text-gray-500 dark:text-slate-400 uppercase",children:"Channel"}),c.jsx("select",{value:f,onChange:L=>h(L.target.value),className:"bg-white dark:bg-slate-700 border border-gray-300 dark:border-slate-600 rounded px-3 py-1.5 text-sm text-gray-900 dark:text-slate-100 outline-none focus:ring-1 focus:ring-cyan-500 min-w-[80px]",children:$.map(L=>c.jsx("option",{value:L,children:L},L))})]}),c.jsxs("div",{className:"flex flex-col gap-1",children:[c.jsx("label",{className:"text-xs font-bold text-gray-500 dark:text-slate-400 uppercase",children:"Black Level"}),c.jsx("input",{type:"number",value:g,onChange:L=>b(Number(L.target.value)),className:"w-24 px-3 py-1.5 bg-white dark:bg-slate-700 border border-gray-300 dark:border-slate-600 rounded outline-none text-sm text-gray-900 dark:text-slate-100"})]}),c.jsxs("div",{className:"flex flex-col gap-1",children:[c.jsx("label",{className:"text-xs font-bold text-gray-500 dark:text-slate-400 uppercase",children:"White Level"}),c.jsx("input",{type:"number",value:w,onChange:L=>v(Number(L.target.value)),className:"w-24 px-3 py-1.5 bg-white dark:bg-slate-700 border border-gray-300 dark:border-slate-600 rounded outline-none text-sm text-gray-900 dark:text-slate-100"})]}),c.jsx("button",{onClick:B,disabled:k,className:"mb-0.5 px-5 py-1.5 bg-cyan-600 hover:bg-cyan-500 text-white font-bold rounded shadow-sm hover:shadow transition-colors disabled:opacity-50 text-sm",children:k?"Analyzing...":"Run Analysis"})]}),c.jsxs("div",{className:"flex-1 overflow-y-auto p-4 flex flex-col gap-4 bg-white dark:bg-slate-900 min-h-0",children:[j&&c.jsx("div",{className:"p-3 bg-red-100 dark:bg-red-900/30 text-red-700 dark:text-red-300 rounded text-sm text-center flex-shrink-0",children:j}),!x&&!k&&!j&&c.jsx("div",{className:"flex-1 flex flex-col items-center justify-center text-gray-400 dark:text-slate-500 h-full",children:c.jsx("p",{children:"Configure parameters and click Run Analysis"})}),x&&c.jsxs(c.Fragment,{children:[c.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 flex-shrink-0",children:[c.jsxs("div",{className:"bg-gray-100 dark:bg-slate-800 p-3 rounded-lg border border-gray-200 dark:border-slate-700 text-center",children:[c.jsx("div",{className:"text-xs text-gray-500 dark:text-slate-400 uppercase mb-1",children:"Unique Codes"}),c.jsx("div",{className:"text-xl font-bold text-gray-900 dark:text-slate-100",children:x.uniqueCount})]}),c.jsxs("div",{className:"bg-gray-100 dark:bg-slate-800 p-3 rounded-lg border border-gray-200 dark:border-slate-700 text-center",children:[c.jsx("div",{className:"text-xs text-gray-500 dark:text-slate-400 uppercase mb-1",children:"Total Diffs"}),c.jsx("div",{className:"text-xl font-bold text-gray-900 dark:text-slate-100",children:x.diffCount})]})]}),c.jsxs("div",{className:"bg-white dark:bg-slate-800/50 rounded-xl border border-gray-200 dark:border-slate-700 overflow-hidden flex-shrink-0",children:[c.jsx("div",{className:"px-4 py-2 bg-gray-50 dark:bg-slate-800 border-b border-gray-200 dark:border-slate-700 text-xs font-bold text-gray-500 dark:text-slate-400 uppercase",children:"Step Distribution"}),c.jsx("div",{className:"p-4 flex flex-wrap gap-x-8 gap-y-2 text-sm font-mono max-h-32 overflow-y-auto",children:Object.entries(x.stepCounts).sort((L,U)=>parseFloat(L[0])-parseFloat(U[0])).map(([L,U])=>c.jsxs("div",{className:"flex gap-2",children:[c.jsxs("span",{className:"text-gray-500 dark:text-slate-400",children:["Step ",L,":"]}),c.jsx("span",{className:"text-cyan-600 dark:text-cyan-400 font-bold",children:String(U)})]},L))})]}),c.jsxs("div",{className:"flex-1 bg-white dark:bg-slate-900 border border-gray-200 dark:border-slate-700 rounded-xl p-2 relative overflow-hidden min-h-[300px]",children:[c.jsx("div",{className:"absolute top-2 left-4 text-xs font-bold text-gray-400 dark:text-slate-500 pointer-events-none z-20 bg-white/80 dark:bg-slate-900/80 px-2 rounded",children:"Step Size vs Code Value"}),c.jsx("div",{className:"absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 z-0 pointer-events-none select-none opacity-10 mix-blend-normal dark:mix-blend-plus-lighter",children:c.jsx("svg",{viewBox:"0 0 500 60",className:"w-96 h-auto",children:c.jsx("text",{x:"50%",y:"50%",dominantBaseline:"middle",textAnchor:"middle",className:"fill-gray-900 dark:fill-white",fontSize:"36",fontWeight:"bold",style:{fontFamily:"sans-serif",letterSpacing:"0.05em"},children:" y-g-jiang.github.io"})})}),c.jsx("div",{className:"relative z-10 w-full h-full",children:c.jsx(_o,{width:"100%",height:"100%",children:c.jsxs(zl,{data:x.plotData,margin:{top:20,right:20,bottom:20,left:10},children:[c.jsx(so,{strokeDasharray:"3 3",stroke:"#374151",opacity:.1}),c.jsx(Xa,{dataKey:"x",type:"number",domain:["auto","auto"],tick:{fill:"#9ca3af",fontSize:10},label:{value:"Code Value (Shifted)",position:"insideBottom",offset:-10,fill:"#9ca3af",fontSize:11}}),c.jsx(Ka,{tick:{fill:"#9ca3af",fontSize:10},domain:[0,"auto"],allowDataOverflow:!1,label:{value:"Step Size (Delta)",angle:-90,position:"insideLeft",fill:"#9ca3af",fontSize:11}}),c.jsx(ra,{contentStyle:{backgroundColor:"rgba(17, 24, 39, 0.95)",border:"1px solid #374151",borderRadius:"0.5rem",color:"#f3f4f6",fontSize:"12px"},labelFormatter:L=>`Val: ${L}`,formatter:L=>[L,"Step Size"]}),c.jsx(En,{type:"stepAfter",dataKey:"y",stroke:"#0891b2",strokeWidth:1.5,dot:{r:1.5,fill:"#0891b2",strokeWidth:0},activeDot:{r:4},isAnimationActive:!1})]})})})]})]})]})]})},yie=({isOpen:e,onClose:t,rawImageData:r,roi:n,isBGGR:a,zIndex:i,onFocus:o,initialPosition:s,stackFiles:l})=>{const[u,d]=_.useState("cross"),[f,h]=_.useState("R"),[g,b]=_.useState("B"),[w,v]=_.useState("H"),[x,m]=_.useState(null),[k,P]=_.useState(!1),[j,S]=_.useState(0),[M,O]=_.useState(0),[E,I]=_.useState("single"),D=a?{B:0,G1:1,G2:2,R:3}:{R:0,G1:1,G2:2,B:3},B=a?["B","G1","G2","R"]:["R","G1","G2","B"],z=async Y=>{if(!r||!n)return;P(!0),I(Y),S(0),m(null);let G=D[f],$=u==="cross"?D[g]:G,L=0,U=0;u==="self"&&(w==="H"?U=2:L=2),setTimeout(async()=>{try{let V={sumCov:0,sumVar1:0,sumVar2:0,n:0};if(Y==="single")V=qk(r.data,r.width,r.height,n,G,$,L,U);else if(l&&l.length>0)for(let J=0;J<l.length;J++){S(J+1);const K=await l[J].arrayBuffer(),Q=await pu(K),te=qk(Q.data,Q.width,Q.height,n,G,$,L,U);V.sumCov+=te.sumCov,V.sumVar1+=te.sumVar1,V.sumVar2+=te.sumVar2,V.n+=te.n}O(V.n),m(P8(V))}catch(V){console.error("Pearson calculation failed",V),alert("Calculation error: "+V.message)}finally{P(!1)}},50)};return e?c.jsxs(ml,{initialPosition:s||{x:200,y:200},onClose:t,zIndex:i,onFocus:o,className:"w-80 bg-white dark:bg-slate-900 border border-gray-200 dark:border-slate-700 flex flex-col shadow-2xl overflow-hidden",children:[c.jsxs("div",{className:"flex justify-between items-center px-4 py-3 border-b border-gray-200 dark:border-slate-700 bg-gray-50 dark:bg-slate-800",children:[c.jsxs("h3",{className:"text-sm font-bold text-gray-700 dark:text-slate-200 flex items-center gap-2",children:["Pearson Correlation",c.jsx("span",{className:"text-[10px] font-normal bg-white dark:bg-slate-700 px-1.5 py-0.5 rounded border border-gray-200 dark:border-slate-600",children:"r"})]}),c.jsx("button",{onClick:t,className:"text-gray-400 hover:text-red-500 transition-colors",children:c.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),c.jsxs("div",{className:"p-4 flex flex-col gap-4",children:[c.jsxs("div",{className:"flex bg-gray-100 dark:bg-slate-800 p-1 rounded-lg border border-gray-200 dark:border-slate-700",children:[c.jsx("button",{onClick:()=>d("cross"),className:`flex-1 py-1 text-[10px] font-bold rounded transition-all ${u==="cross"?"bg-indigo-600 text-white shadow":"text-gray-500 dark:text-slate-400 hover:bg-gray-200 dark:hover:bg-slate-700"}`,children:"Cross-Channel"}),c.jsx("button",{onClick:()=>d("self"),className:`flex-1 py-1 text-[10px] font-bold rounded transition-all ${u==="self"?"bg-indigo-600 text-white shadow":"text-gray-500 dark:text-slate-400 hover:bg-gray-200 dark:hover:bg-slate-700"}`,children:"Self-Adjacent"})]}),c.jsxs("div",{className:"flex items-center gap-3",children:[c.jsxs("div",{className:"flex-1 flex flex-col gap-1",children:[c.jsx("label",{className:"text-[9px] uppercase font-bold text-gray-400",children:u==="cross"?"Channel 1":"Channel"}),c.jsx("select",{value:f,onChange:Y=>h(Y.target.value),className:"bg-gray-100 dark:bg-slate-800 border border-gray-200 dark:border-slate-700 rounded px-2 py-1.5 text-xs text-gray-700 dark:text-slate-200 outline-none focus:ring-1 focus:ring-indigo-500",children:B.map(Y=>c.jsx("option",{value:Y,children:Y},Y))})]}),c.jsx("div",{className:"text-gray-300 dark:text-slate-600 mt-4 font-mono",children:u==="cross"?"":""}),c.jsxs("div",{className:"flex-1 flex flex-col gap-1",children:[c.jsx("label",{className:"text-[9px] uppercase font-bold text-gray-400",children:u==="cross"?"Channel 2":"Direction"}),u==="cross"?c.jsx("select",{value:g,onChange:Y=>b(Y.target.value),className:"bg-gray-100 dark:bg-slate-800 border border-gray-200 dark:border-slate-700 rounded px-2 py-1.5 text-xs text-gray-700 dark:text-slate-200 outline-none focus:ring-1 focus:ring-indigo-500",children:B.map(Y=>c.jsx("option",{value:Y,children:Y},Y))}):c.jsxs("div",{className:"flex h-[28px] bg-gray-100 dark:bg-slate-800 rounded border border-gray-200 dark:border-slate-700 p-0.5",children:[c.jsx("button",{onClick:()=>v("H"),className:`flex-1 text-[9px] font-bold rounded ${w==="H"?"bg-slate-300 dark:bg-slate-600 text-indigo-600 dark:text-indigo-400":"text-gray-400"}`,children:"Horiz"}),c.jsx("button",{onClick:()=>v("V"),className:`flex-1 text-[9px] font-bold rounded ${w==="V"?"bg-slate-300 dark:bg-slate-600 text-indigo-600 dark:text-indigo-400":"text-gray-400"}`,children:"Vert"})]})]})]}),c.jsxs("div",{className:"grid grid-cols-1 gap-2",children:[c.jsx("button",{onClick:()=>z("single"),disabled:k,className:"w-full py-2 bg-indigo-600 hover:bg-indigo-500 disabled:bg-gray-400 text-white font-bold rounded shadow-md transition-all active:scale-95 text-xs",children:k&&E==="single"?"Calculating...":"Calc Current Frame"}),l&&l.length>0&&c.jsxs("button",{onClick:()=>z("stack"),disabled:k,className:"w-full py-2 bg-emerald-600 hover:bg-emerald-500 disabled:bg-gray-400 text-white font-bold rounded shadow-md transition-all active:scale-95 text-xs flex flex-col items-center justify-center",children:[c.jsx("span",{children:"Calc Stack Concatenated"}),k&&E==="stack"&&c.jsxs("span",{className:"text-[9px] font-normal opacity-80",children:["Progress: ",j," / ",l.length]})]})]}),x!==null&&c.jsxs("div",{className:"mt-2 p-4 bg-gray-50 dark:bg-slate-800/50 rounded-xl border border-gray-200 dark:border-slate-700 text-center animate-in fade-in slide-in-from-top-2",children:[c.jsxs("div",{className:"text-[10px] uppercase font-bold text-gray-400 dark:text-slate-500 mb-1",children:[u==="cross"?"Cross-Channel":`Self-Adj (${w})`," r"]}),c.jsx("div",{className:"text-2xl font-mono font-bold text-indigo-600 dark:text-indigo-400 select-all",style:{fontSize:"24px"},children:x.toFixed(5)}),c.jsxs("div",{className:"text-[9px] text-gray-400 mt-2 font-mono",children:["N = ",M.toLocaleString()," pairs"]}),c.jsx("div",{className:"mt-3 text-[10px] font-bold",children:Math.abs(x)>.5?c.jsx("span",{className:"text-red-500",children:"Significant Correlation"}):Math.abs(x)>.1?c.jsx("span",{className:"text-amber-500",children:"Weak Correlation"}):c.jsx("span",{className:"text-emerald-500",children:"Near-Zero (Uncorrelated)"})})]})]}),c.jsx("div",{className:"p-3 bg-gray-50/50 dark:bg-slate-800/30 text-[9px] text-gray-400 dark:text-slate-600 italic border-t border-gray-100 dark:border-slate-800",children:u==="cross"?"Comparing two color channels in the same Bayer 2x2 cells.":`Comparing pixel (r,c) with (r${w==="V"?"+2":""}, c${w==="H"?"+2":""}) in the same channel.`})]}):null},xie=[{href:"https://y-g-jiang.github.io/CBLD.html",text:" (Primary Source)",abbr:"CBLD",description:"ISO",highlight:!0},{href:"https://y-G-jiang.github.io/LAC.html",text:"",abbr:"LAC",description:""},{href:"https://y-G-jiang.github.io/CCGV.html",text:"adobeIECMF",abbr:"CCGV",description:"acrRAWxy"},{href:"https://y-G-jiang.github.io/JTJS.html",text:"",abbr:"JTJS",description:"CMF/"},{href:"https://y-G-jiang.github.io/XJZS.html",text:"",abbr:"XJZS",description:""}],vie=["5","9","0","8","2","1","4","7","3","6"],z4=e=>!e||e==="--"?"--":String(e).split("").map(t=>{const r=parseInt(t);return isNaN(r)?t:vie[r]}).join(""),bie=({isOpen:e,onClose:t})=>{const[r,n]=_.useState({pv:"--",uv:"--"});return _.useEffect(()=>{if(e){const a=()=>{const o=document.getElementById("vercount_value_site_pv"),s=document.getElementById("vercount_value_site_uv");o&&s&&n({pv:o.innerText||"--",uv:s.innerText||"--"})};a();const i=setTimeout(a,1e3);return()=>clearTimeout(i)}},[e]),e?c.jsx("div",{className:"fixed inset-0 z-[100] flex items-center justify-center bg-black/60 backdrop-blur-sm p-4 animate-in fade-in duration-200",onClick:t,children:c.jsxs("div",{className:"bg-white dark:bg-slate-900 w-full max-w-3xl rounded-2xl shadow-2xl border border-gray-200 dark:border-slate-700 overflow-hidden flex flex-col max-h-[90vh]",onClick:a=>a.stopPropagation(),children:[c.jsxs("div",{className:"flex justify-between items-center p-5 border-b border-gray-200 dark:border-slate-700 bg-gray-50 dark:bg-slate-800/50",children:[c.jsx("h2",{className:"text-xl font-bold text-gray-900 dark:text-white",children:"About / Tools"}),c.jsx("button",{onClick:t,className:"text-gray-400 hover:text-gray-600 dark:hover:text-slate-200 transition-colors p-1 rounded hover:bg-gray-200 dark:hover:bg-slate-700",children:c.jsx("svg",{className:"w-6 h-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),c.jsxs("div",{className:"p-6 overflow-y-auto scrollbar-thin scrollbar-thumb-gray-300 dark:scrollbar-thumb-slate-700 relative",children:[c.jsx("div",{className:"mb-8 p-4 bg-gray-50 dark:bg-slate-800/50 rounded-xl border border-gray-100 dark:border-slate-700 text-center",children:c.jsxs("p",{className:"text-lg text-gray-700 dark:text-slate-300",children:[c.jsx("span",{className:"font-bold mr-2",children:"about:"}),c.jsx("a",{href:"https://y-g-jiang.github.io/JOindex.html",target:"_blank",rel:"noopener noreferrer",className:"text-cyan-600 dark:text-cyan-400 hover:underline break-all font-mono",children:"https://y-g-jiang.github.io/JOindex.html"})]})}),c.jsxs("div",{className:"flex items-center gap-4 mb-6",children:[c.jsx("div",{className:"h-px bg-gray-200 dark:bg-slate-700 flex-1"}),c.jsx("span",{className:"text-sm font-bold text-gray-400 dark:text-slate-500 uppercase tracking-wider",children:"Primary Resources"}),c.jsx("div",{className:"h-px bg-gray-200 dark:bg-slate-700 flex-1"})]}),c.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4 mb-8",children:xie.map(a=>c.jsxs("a",{href:a.href,target:"_blank",rel:"noopener noreferrer",className:`group block p-4 rounded-xl border transition-all duration-200 relative overflow-hidden ${a.highlight?"border-cyan-500 dark:border-cyan-400 bg-cyan-50/30 dark:bg-cyan-900/10 shadow-lg scale-[1.02] ring-2 ring-cyan-500/20":"border-gray-200 dark:border-slate-700 bg-white dark:bg-slate-800/30 hover:bg-gray-50 dark:hover:bg-slate-800 hover:border-cyan-500"}`,children:[c.jsx("div",{className:"absolute top-0 right-0 w-16 h-16 bg-gradient-to-bl from-cyan-500/5 to-transparent -mr-8 -mt-8 rounded-full pointer-events-none group-hover:from-cyan-500/10 transition-colors"}),c.jsxs("div",{className:"flex items-center gap-3 mb-2 relative z-10",children:[c.jsx("span",{className:`px-2 py-1 text-xs font-bold rounded transition-colors border ${a.highlight?"bg-cyan-600 text-white border-cyan-500":"bg-gray-100 dark:bg-slate-700 text-gray-600 dark:text-slate-300 border-gray-200 dark:border-slate-600 group-hover:border-cyan-200"}`,children:a.abbr}),c.jsx("h3",{className:`font-bold transition-colors ${a.highlight?"text-cyan-700 dark:text-cyan-300":"text-gray-800 dark:text-slate-200 group-hover:text-cyan-600"}`,children:a.text})]}),c.jsx("p",{className:`text-xs pl-1 transition-colors relative z-10 ${a.highlight?"text-cyan-600/80 dark:text-cyan-400/80":"text-gray-500 dark:text-slate-400"}`,children:a.description})]},a.abbr))}),c.jsx("div",{className:"flex justify-end mt-4",children:c.jsx("div",{className:"bg-gray-50 dark:bg-slate-900/50 rounded border border-gray-200 dark:border-slate-800 p-1.5 opacity-40 hover:opacity-100 transition-opacity cursor-default select-none group",children:c.jsxs("div",{className:"font-mono text-[10px] text-gray-400 dark:text-slate-600 leading-tight text-right flex flex-col",children:[c.jsx("span",{className:"group-hover:text-indigo-400 transition-colors",children:z4(r.pv)}),c.jsx("span",{className:"group-hover:text-emerald-400 transition-colors",children:z4(r.uv)})]})})})]})]})}):null},wie=({isOpen:e,onClose:t,data:r,fileName:n,warning:a})=>{const[i,o]=_.useState(""),s=d=>{const f=new WeakSet;try{return JSON.stringify(d,(h,g)=>{if(typeof g=="bigint")return g.toString()+"n";if(typeof g=="object"&&g!==null){if(f.has(g))return"[Circular]";if(f.add(g),ArrayBuffer.isView(g))return`[${g.constructor.name}]`}return g})}catch{return"[Unable to serialize object]"}},l=_.useMemo(()=>{if(!r)return[];const d=[],f=(h,g=0)=>{if(g>5)return"...";if(h==null)return String(h);if(h instanceof Date)return h.toLocaleString();if(typeof h=="number")return h.toString();if(typeof h=="string")return h;if(typeof h=="bigint")return h.toString()+"n";if(ArrayBuffer.isView(h))return`<${h.constructor.name} len=${h.length} bytes=${h.byteLength}>`;if(h instanceof ArrayBuffer)return`<ArrayBuffer bytes=${h.byteLength}>`;if(typeof h=="object"){if(Array.isArray(h))return h.length===0?"[]":h.length>20?`[${h.slice(0,10).map(v=>typeof v=="number"?v.toFixed(2):f(v,g+1)).join(", ")}, ... (+${h.length-10} more)]`:`[${h.map(w=>typeof w=="number"?Number.isInteger(w)?w:w.toFixed(4):f(w,g+1)).join(", ")}]`;try{const b=Object.keys(h);return b.length>5?`{Object with ${b.length} keys}`:s(h)}catch{return"<Complex Object>"}}return String(h)};try{if(typeof r!="object")return[{key:"Value",value:String(r)}];Object.keys(r).sort().forEach(g=>{if(g==="MakerNote"||g==="UserComment"||g.includes("Strip")||g.includes("Offset")){d.push({key:g,value:"<Binary/Internal Data>"});return}const b=r[g];d.push({key:g,value:f(b)})})}catch(h){console.error("Error processing EXIF data:",h),d.push({key:"Error",value:"Failed to process metadata structure."})}return d},[r]);if(!e)return null;const u=l.filter(d=>d.key.toLowerCase().includes(i.toLowerCase())||d.value.toLowerCase().includes(i.toLowerCase()));return c.jsx("div",{className:"fixed inset-0 z-[100] flex items-center justify-center bg-black/60 backdrop-blur-sm p-4 animate-in fade-in duration-200",onClick:t,children:c.jsxs("div",{className:"bg-white dark:bg-slate-900 w-full max-w-3xl max-h-[90vh] rounded-2xl shadow-2xl flex flex-col border border-gray-200 dark:border-slate-700",onClick:d=>d.stopPropagation(),children:[c.jsxs("div",{className:"flex justify-between items-center p-5 border-b border-gray-200 dark:border-slate-700",children:[c.jsxs("div",{className:"overflow-hidden",children:[c.jsx("h2",{className:"text-xl font-bold text-gray-900 dark:text-slate-100",children:"EXIF Data"}),c.jsx("p",{className:"text-sm text-gray-500 dark:text-slate-400 mt-1 font-mono truncate",children:n})]}),c.jsx("button",{onClick:t,className:"text-gray-400 hover:text-gray-600 dark:hover:text-slate-200 transition-colors p-2 rounded-full hover:bg-gray-100 dark:hover:bg-slate-800",children:c.jsx("svg",{className:"w-6 h-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),a&&c.jsx("div",{className:"bg-amber-50 dark:bg-amber-900/20 px-4 py-2 border-b border-amber-100 dark:border-amber-800/50 text-center",children:c.jsx("p",{className:"text-xs text-amber-600 dark:text-amber-400 whitespace-pre-line font-medium leading-relaxed",children:a})}),c.jsx("div",{className:"p-4 border-b border-gray-200 dark:border-slate-700 bg-gray-50 dark:bg-slate-800/50",children:c.jsxs("div",{className:"relative",children:[c.jsx("svg",{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-gray-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})}),c.jsx("input",{type:"text",placeholder:"Search tags...",value:i,onChange:d=>o(d.target.value),className:"w-full pl-9 pr-4 py-2 bg-white dark:bg-slate-900 border border-gray-300 dark:border-slate-600 rounded-lg text-sm focus:ring-2 focus:ring-cyan-500 outline-none text-gray-900 dark:text-slate-100 transition-colors placeholder-gray-400"})]})}),c.jsx("div",{className:"overflow-y-auto flex-1 p-0 scrollbar-thin scrollbar-thumb-gray-300 dark:scrollbar-thumb-slate-700",children:u.length>0?c.jsxs("table",{className:"w-full text-left border-collapse table-fixed",children:[c.jsx("thead",{className:"bg-gray-50 dark:bg-slate-800 sticky top-0 shadow-sm z-10",children:c.jsxs("tr",{children:[c.jsx("th",{className:"py-3 px-5 font-semibold text-xs text-gray-500 dark:text-slate-400 uppercase tracking-wider w-1/3 border-b border-gray-200 dark:border-slate-700",children:"Tag Name"}),c.jsx("th",{className:"py-3 px-5 font-semibold text-xs text-gray-500 dark:text-slate-400 uppercase tracking-wider w-2/3 border-b border-gray-200 dark:border-slate-700",children:"Value"})]})}),c.jsx("tbody",{className:"divide-y divide-gray-100 dark:divide-slate-800",children:u.map(d=>c.jsxs("tr",{className:"hover:bg-gray-50 dark:hover:bg-slate-800/50 transition-colors group",children:[c.jsx("td",{className:"py-2 px-5 text-sm font-medium text-cyan-600 dark:text-cyan-400 font-mono break-words align-top",children:d.key}),c.jsx("td",{className:"py-2 px-5 text-sm text-gray-700 dark:text-slate-300 font-mono break-words align-top group-hover:text-gray-900 dark:group-hover:text-slate-100",children:d.value})]},d.key))})]}):c.jsx("div",{className:"flex flex-col items-center justify-center h-64 text-gray-400 dark:text-slate-500",children:c.jsxs("p",{children:['No tags found matching "',i,'"']})})}),c.jsx("div",{className:"p-4 border-t border-gray-200 dark:border-slate-700 bg-gray-50 dark:bg-slate-800/50 flex justify-end rounded-b-2xl",children:c.jsx("button",{onClick:t,className:"px-4 py-2 bg-gray-200 hover:bg-gray-300 dark:bg-slate-700 dark:hover:bg-slate-600 text-gray-800 dark:text-white rounded-lg text-sm font-semibold transition-colors",children:"Close"})})]})})},kie=100,sx=e=>{if(e.length===0)return 0;if(e.length===1)return e[0];if(e.length===2)return .5*(e[0]+e[1]);let t=[...e].sort((r,n)=>r-n);for(;t.length>4;){let r=1/0,n=0;const a=t.length,i=Math.floor(a/2);for(let o=0;o<=a-i;o++){const s=t[o+i-1]-t[o];s<r&&(r=s,n=o)}t=t.slice(n,n+i)}return t.reduce((r,n)=>r+n,0)/t.length},W4=({min:e,max:t,value:r,onChange:n,vertical:a=!1,logScale:i=!1})=>{const o=_.useRef(null),s=_.useRef(null),l=_.useCallback(m=>{const k=i?Math.max(1e-6,e):e,P=i?Math.max(k*1.0001,t):t,j=Math.max(k,Math.min(P,m));if(i){const S=Math.log10(k),M=Math.log10(P);return(Math.log10(j)-S)/(M-S)}return(j-k)/(P-k)},[e,t,i]),u=_.useCallback(m=>{const k=i?Math.max(1e-6,e):e,P=i?Math.max(k*1.0001,t):t;if(i){const j=Math.log10(k),S=Math.log10(P);return Math.pow(10,j+m*(S-j))}return k+m*(P-k)},[e,t,i]),d=(m,k)=>{m.preventDefault(),m.stopPropagation(),s.current=k;const P=S=>{if(!s.current||!o.current)return;const M=o.current.getBoundingClientRect();let O=0;a?O=(M.bottom-S.clientY)/M.height:O=(S.clientX-M.left)/M.width,O=Math.max(0,Math.min(1,O));const E=u(O);if(s.current==="min"){const I=r[1];n([Math.min(E,I),I])}else{const I=r[0];n([I,Math.max(E,I)])}},j=()=>{s.current=null,window.removeEventListener("mousemove",P),window.removeEventListener("mouseup",j)};window.addEventListener("mousemove",P),window.addEventListener("mouseup",j)},f=l(r[0])*100,h=l(r[1])*100,g=a?{left:"50%",top:0,bottom:0,width:"4px",transform:"translateX(-50%)"}:{top:"50%",left:0,right:0,height:"4px",transform:"translateY(-50%)"},b=a?{left:"50%",bottom:`${f}%`,height:`${h-f}%`,width:"4px",transform:"translateX(-50%)"}:{top:"50%",left:`${f}%`,width:`${h-f}%`,height:"4px",transform:"translateY(-50%)"},w="absolute w-3 h-3 bg-white border-2 border-cyan-600 rounded-full shadow-md cursor-pointer hover:scale-125 transition-transform z-10",v=a?{left:"50%",bottom:`${f}%`,transform:"translate(-50%, 50%)"}:{top:"50%",left:`${f}%`,transform:"translate(-50%, -50%)"},x=a?{left:"50%",bottom:`${h}%`,transform:"translate(-50%, 50%)"}:{top:"50%",left:`${h}%`,transform:"translate(-50%, -50%)"};return c.jsxs("div",{ref:o,className:`relative select-none ${a?"h-full w-4 py-2":"w-full h-4 px-2"}`,children:[c.jsx("div",{className:"absolute bg-gray-300 dark:bg-slate-600 rounded-full",style:g}),c.jsx("div",{className:"absolute bg-cyan-500 dark:bg-cyan-400 rounded-full",style:b}),c.jsx("div",{className:w,style:v,onMouseDown:m=>d(m,"min")}),c.jsx("div",{className:w,style:x,onMouseDown:m=>d(m,"max")})]})},Sie=({isOpen:e,onClose:t,data:r,blackLevel:n,imageHeight:a,isBGGR:i,importedMetadata:o,theme:s,initialCameraModel:l,initialISO:u})=>{const[d,f]=_.useState("Noise"),[h,g]=_.useState(!0),[b,w]=_.useState(null),[v,x]=_.useState("default"),[m,k]=_.useState(!1),[P,j]=_.useState(!1),[S,M]=_.useState({R:!0,G1:!0,G2:!0,B:!0}),[O,E]=_.useState(""),[I,D]=_.useState(""),[B,z]=_.useState(""),[Y,G]=_.useState(""),[$,L]=_.useState("10"),[U,V]=_.useState(""),[J,K]=_.useState("0 0 0 0"),[Q,te]=_.useState("0 0 0 0"),[ee,me]=_.useState(!1),[re,De]=_.useState(null),[fe,le]=_.useState(!1),[de,Se]=_.useState(0),[he,Pe]=_.useState([]),[ve,ye]=_.useState(""),[ge,ue]=_.useState(""),Le=()=>{const ce=parseFloat(ve),be=parseFloat(ge);!isNaN(ce)&&!isNaN(be)&&(Pe([...he,{id:Date.now(),x:ce,y:be}]),ye(""),ue(""))},[rt,et]=_.useState(()=>localStorage.getItem("ptc_tester_name")||""),[tt,ft]=_.useState(""),[wt,fr]=_.useState("");_.useEffect(()=>{localStorage.setItem("ptc_tester_name",rt)},[rt]);const Wt=_.useRef(ee),kt=_.useRef(fe),Bt=_.useRef(de);_.useEffect(()=>{Wt.current=ee,kt.current=fe,Bt.current=de},[ee,fe,de]);const[Sr,Gr]=_.useState(null),[rr,Nr]=_.useState({min:.01,max:90}),[nt,Ot]=_.useState({readNoise:0,gain:1,prnu:.5}),[pr,br]=_.useState(2e6),jr=_.useRef(nt),Rr=_.useRef(rr),Pr=_.useRef(pr);_.useEffect(()=>{jr.current=nt,Rr.current=rr,Pr.current=pr},[nt,rr,pr]);const[Kt,Er]=_.useState({read:"0",gain:"1.0",prnu:"0.5",rangeMin:"0.01",rangeMax:"90"}),[jt,Me]=_.useState({read:!0,shot:!0,prnu:!0,total:!0,fitRange:!0}),[X,Te]=_.useState(!1),[xe,ze]=_.useState([]),[Je,ot]=_.useState(null),[Pt,Qe]=_.useState(""),_r=_.useMemo(()=>n?n.join(","):"",[n]);_.useEffect(()=>{if(e){let ce="0 0 0 0";o&&o.blackLevel?ce=o.blackLevel.join(" "):ce=n&&n.length===4?n.join(" "):"0 0 0 0",K(ce),te(ce);let be="";if(o&&o.height?be=o.height.toString():a&&(be=a.toString()),V(be),be){const ae=parseFloat(be);!isNaN(ae)&&ae>0?L((2309.4/ae).toFixed(2)):L("10")}else L("10");De(null),me(!1),le(!1),Se(0),ze([]),ot(null),Nr({min:.01,max:90}),Er({read:"0",gain:"0",prnu:"0",rangeMin:"0.01",rangeMax:"90"});const ke={readNoise:0,gain:0,prnu:0};Ot(ke),jr.current=ke,E(""),D(""),z(""),G(""),f("Noise"),Gr(null),br(2e6),Qe(""),j(!1),Pe([]),ft(ae=>ae.trim()===""&&l?l:ae),fr(ae=>ae.trim()===""&&u?u:ae)}},[e,_r,o,a,r,l,u]);const sr=ce=>{if(ce.key==="Enter"){const be=parseFloat(U);if(!isNaN(be)&&be>0){const ke=(2309.4/be).toFixed(2);L(ke)}ce.target.blur()}},Jt=_.useMemo(()=>{let be=Q.trim().split(/[\s,]+/).filter(Boolean).map(Number);for(be.length===1&&(be=[be[0],be[0],be[0],be[0]]);be.length<4;)be.push(0);const ke=ae=>{switch(ae){case"R":return be[0];case"G1":return be[1];case"G2":return be[2];case"B":return be[3];default:return 0}};return r.map(ae=>{const $e=ae.mean-ke(ae.channel),pt=ae.std>0?$e/ae.std:0;return{...ae,x:$e,std:ae.std,snr:pt}}).filter(ae=>ae.std>0)},[r,Q]),vt=_.useMemo(()=>{const ce=nt.readNoise,be=ce*ce;return Jt.map(ke=>{let ae=0;if(d==="Noise")ae=ke.std;else if(d==="SNR")ae=ke.snr;else if(d==="Linear"){const pt=ke.std*ke.std-be;ae=ke.x!==0?pt/ke.x:0}return{...ke,y:ae}})},[Jt,d,nt.readNoise]),nr=_.useMemo(()=>{if(Jt.length===0)return"G1";const ce={R:0,G1:0,G2:0,B:0},be={R:0,G1:0,G2:0,B:0};for(const $e of Jt)ce[$e.channel]+=$e.x,be[$e.channel]++;let ke="G1",ae=-1/0;return Object.keys(ce).forEach($e=>{const pt=be[$e],yt=pt>0?ce[$e]/pt:-1/0;yt>ae&&(ae=yt,ke=$e)}),ke},[Jt]),A=_.useCallback(()=>{let ce=1/0,be=-1/0;if(Jt.length===0)return{min:.1,max:1};for(let ke=0;ke<Jt.length;ke++){const ae=Jt[ke].x;h&&ae<=0||(ae<ce&&(ce=ae),ae>be&&(be=ae))}return ce===1/0?{min:.1,max:1}:{min:ce,max:be}},[Jt,h]),Ge=_.useCallback(()=>{let ce=1/0,be=-1/0;if(vt.length===0)return{min:.1,max:1};for(let ke=0;ke<vt.length;ke++){const ae=vt[ke].y;h&&ae<=0||(ae<ce&&(ce=ae),ae>be&&(be=ae))}return ce===1/0?{min:.1,max:1}:{min:ce*.9,max:be*1.1}},[vt,h]),{min:Ke,max:Yt}=A(),{min:Ht,max:At}=Ge(),yr=Yt*(rr.min/100),Xr=Yt*(rr.max/100),ut=_.useMemo(()=>{if(!h&&vt.length===0)return{shot:[],read:[],prnu:[],total:[]};const ce=O?parseFloat(O):Ke,be=I?parseFloat(I):Yt,ke=100,ae=Math.max(.1,ce),$e=Math.max(1,be);if(ae>=$e)return{shot:[],read:[],prnu:[],total:[]};const pt=Math.log10(ae),Tt=(Math.log10($e)-pt)/ke,Et=nt.readNoise,Mt=nt.gain>0?nt.gain:1,Ir=nt.prnu/100,gr=[],Cr=[],Lr=[],Ie=[];for(let Ct=0;Ct<=ke;Ct++){const gt=Math.pow(10,pt+Ct*Tt);if(d==="Linear"){const zr=1/Mt,ur=Ir*Ir,Rn=zr+ur*gt;Ie.push({x:gt,y:Rn}),gr.push({x:gt,y:zr}),Lr.push({x:gt,y:ur*gt})}else{const zr=Et,ur=Math.sqrt(gt/Mt),Rn=Ir*gt,Mr=Math.sqrt(zr*zr+ur*ur+Rn*Rn);d==="Noise"?(gr.push({x:gt,y:ur}),Cr.push({x:gt,y:zr}),Lr.push({x:gt,y:Rn}),Ie.push({x:gt,y:Mr})):(ur>0&&gr.push({x:gt,y:gt/ur}),zr>0&&Cr.push({x:gt,y:gt/zr}),Rn>0&&Lr.push({x:gt,y:gt/Rn}),Mr>0&&Ie.push({x:gt,y:gt/Mr}))}}return{shot:gr,read:Cr,prnu:Lr,total:Ie}},[vt,h,O,I,nt,d,Ke,Yt]),Dt=_.useMemo(()=>{if(d==="Linear")return[];const ce=parseFloat($);if(isNaN(ce)||ce<=0)return[];const be=O?parseFloat(O):Ke,ke=I?parseFloat(I):Yt;return d==="SNR"?[{x:be,y:ce},{x:ke,y:ce}]:[{x:be,y:be/ce},{x:ke,y:ke/ce}]},[vt,$,d,O,I,Ke,Yt]),Vt=_.useCallback((ce,be)=>{if(!be||be.length===0)return null;const ke=[...be].sort((ae,$e)=>ae.x-$e.x);for(let ae=0;ae<ke.length-1;ae++){const $e=ke[ae],pt=ke[ae+1];if($e.snr<=ce&&pt.snr>=ce||$e.snr>=ce&&pt.snr<=ce){const yt=(ce-$e.snr)/(pt.snr-$e.snr);return $e.x+yt*(pt.x-$e.x)}}return null},[]),ar=_.useMemo(()=>{const ce=Jt,be=1e3,ke=$e=>{if($e.length===0)return[];if($e.length<=be)return $e;const pt=[...$e].sort((Et,Mt)=>Et.x-Mt.x),yt=[],Tt=pt.length/be;for(let Et=0;Et<be;Et++){const Mt=Math.floor(Et*Tt),Ir=Math.floor((Et+1)*Tt),gr=pt.slice(Mt,Ir);if(gr.length===0)continue;gr.sort((Lr,Ie)=>Lr.std-Ie.std);const Cr=Math.floor(gr.length/2);yt.push(gr[Cr])}return yt},ae={R:[],G1:[],G2:[],B:[]};return ce.forEach($e=>{ae[$e.channel]&&ae[$e.channel].push($e)}),{R:ke(ae.R),G1:ke(ae.G1),G2:ke(ae.G2),B:ke(ae.B)}},[Jt]),St=_.useMemo(()=>re&&nt.gain?re*nt.gain:null,[re,nt.gain]),_e=_.useMemo(()=>{if(re===null||re===0)return null;const ce=parseFloat($);let be=null;if(!isNaN(ce)&&ce>0){let yt=0,Tt=0;if(["R","G1","G2","B"].forEach(Et=>{const Mt=Vt(ce,ar[Et]);Mt!==null&&(yt+=Mt,Tt++)}),Tt>0){const Et=yt/Tt;be=Math.log2(re/Et)}}const ke=parseFloat(U);let ae=null,$e=NaN;if(!isNaN(ke)&&ke>0){$e=16e3/ke;let yt=0,Tt=0;if(["R","G1","G2","B"].forEach(Et=>{const Mt=Vt($e,ar[Et]);Mt!==null&&(yt+=Mt,Tt++)}),Tt>0){const Et=yt/Tt;ae=Math.log2(re/Et)}}let pt=null;if(!isNaN(ke)&&ke>0){const yt=Vt($e,ar[nr]);yt!==null&&(pt=Math.log2(re/yt))}return{manualDR:be,ptpDR:ae,d55DR:pt,manualTarget:ce,ptpTarget:$e,saturationSignal:re,dominantChannel:nr}},[re,$,U,ar,Vt,nr]),Or=_.useMemo(()=>{if(d==="Linear"||!_e||!_e.ptpTarget||isNaN(_e.ptpTarget))return[];const ce=_e.ptpTarget,be=O?parseFloat(O):Ke,ke=I?parseFloat(I):Yt;return d==="SNR"?[{x:be,y:ce},{x:ke,y:ce}]:[{x:be,y:be/ce},{x:ke,y:ke/ce}]},[d,_e,O,I,Ke,Yt]),F=_.useCallback(()=>{const ke=document.createElement("canvas");ke.width=2048,ke.height=1536;const ae=ke.getContext("2d");if(!ae)return;const $e=s==="dark",pt=$e?"#0f172a":"#ffffff",yt=$e?"#ffffff":"#000000",Tt=$e?"#475569":"#cbd5e1",Et=$e?"#1e293b":"#f1f5f9",Mt=i?{R:"#ef4444",G1:"#22c55e",G2:"#4ade80",B:"#3b82f6"}:{R:"#ef4444",G1:"#22c55e",G2:"#4ade80",B:"#3b82f6"};ae.fillStyle=pt,ae.fillRect(0,0,2048,1536);let Ir=O?parseFloat(O):Ke,gr=I?parseFloat(I):Yt,Cr=B?parseFloat(B):Ht,Lr=Y?parseFloat(Y):At;isNaN(Ir)&&(Ir=.1),isNaN(gr)&&(gr=1e4),isNaN(Cr)&&(Cr=.1),isNaN(Lr)&&(Lr=1e3);const Ie={top:80,right:80,bottom:100,left:120},Ct=2048-Ie.left-Ie.right,gt=1536-Ie.top-Ie.bottom,zr=at=>{if(h){const qt=Math.log10(Math.max(1e-9,Ir)),dr=Math.log10(Math.max(1e-9,gr)),Gt=Math.log10(Math.max(1e-9,at));return Ie.left+(Gt-qt)/(dr-qt)*Ct}else return Ie.left+(at-Ir)/(gr-Ir)*Ct},ur=at=>{if(h){const qt=Math.log10(Math.max(1e-9,Cr)),dr=Math.log10(Math.max(1e-9,Lr)),Gt=Math.log10(Math.max(1e-9,at));return Ie.top+gt-(Gt-qt)/(dr-qt)*gt}else return Ie.top+gt-(at-Cr)/(Lr-Cr)*gt};if(ae.beginPath(),h){const at=(qt,dr,Gt)=>{const Kn=Math.log10(Math.max(1e-9,qt)),Hr=Math.log10(Math.max(1e-9,dr)),la=Math.floor(Kn),La=Math.ceil(Hr);for(let Fn=la;Fn<=La;Fn++){const ga=Math.pow(10,Fn);let tn=Gt?zr(ga):ur(ga);(Gt?tn>=Ie.left-1&&tn<=Ie.left+Ct+1:tn>=Ie.top-1&&tn<=Ie.top+gt+1)&&(ae.lineWidth=1.5,ae.strokeStyle=Tt,ae.beginPath(),Gt?(ae.moveTo(tn,Ie.top),ae.lineTo(tn,Ie.top+gt)):(ae.moveTo(Ie.left,tn),ae.lineTo(Ie.left+Ct,tn)),ae.stroke()),ae.lineWidth=.5,ae.strokeStyle=Et;for(let Rt=2;Rt<10;Rt++){const zo=Rt*ga;tn=Gt?zr(zo):ur(zo),(Gt?tn>=Ie.left&&tn<=Ie.left+Ct:tn>=Ie.top&&tn<=Ie.top+gt)&&(ae.beginPath(),Gt?(ae.moveTo(tn,Ie.top),ae.lineTo(tn,Ie.top+gt)):(ae.moveTo(Ie.left,tn),ae.lineTo(Ie.left+Ct,tn)),ae.stroke())}}};at(Ir,gr,!0),at(Cr,Lr,!1)}else{ae.strokeStyle=Tt,ae.lineWidth=1;for(let at=0;at<=5;at++){const qt=Ie.left+Ct*at/5;ae.beginPath(),ae.moveTo(qt,Ie.top),ae.lineTo(qt,Ie.top+gt),ae.stroke();const dr=Ie.top+gt*at/5;ae.beginPath(),ae.moveTo(Ie.left,dr),ae.lineTo(Ie.left+Ct,dr),ae.stroke()}}ae.strokeStyle=yt,ae.lineWidth=2,ae.strokeRect(Ie.left,Ie.top,Ct,gt);const Rn=(at,qt,dr)=>{at<Ie.left||at>Ie.left+Ct||qt<Ie.top||qt>Ie.top+gt||(ae.fillStyle=dr,ae.fillRect(at-1.5,qt-1.5,3,3))},Mr=vt.filter(at=>!(h&&(at.x<=0||at.y<=0)));Mr.forEach(at=>{S[at.channel]&&at.channel!==nr&&Rn(zr(at.x),ur(at.y),Mt[at.channel])}),Mr.forEach(at=>{S[at.channel]&&at.channel===nr&&Rn(zr(at.x),ur(at.y),Mt[at.channel])}),he.forEach(at=>{const qt=zr(at.x),dr=ur(at.y);if(qt<Ie.left||qt>Ie.left+Ct||dr<Ie.top||dr>Ie.top+gt)return;ae.strokeStyle="#d946ef",ae.lineWidth=2.5;const Gt=6;ae.beginPath(),ae.moveTo(qt-Gt,dr-Gt),ae.lineTo(qt+Gt,dr+Gt),ae.moveTo(qt+Gt,dr-Gt),ae.lineTo(qt-Gt,dr+Gt),ae.stroke()});const qr=(at,qt,dr=[])=>{if(at.length<2)return;ae.beginPath(),ae.strokeStyle=qt,ae.lineWidth=3,ae.setLineDash(dr);let Gt=!1;for(const Kn of at){const Hr=zr(Kn.x),la=ur(Kn.y);if(Hr<Ie.left-100||Hr>Ie.left+Ct+100||la<Ie.top-100||la>Ie.top+gt+100){Gt=!1;continue}Gt?ae.lineTo(Hr,la):(ae.moveTo(Hr,la),Gt=!0)}ae.stroke(),ae.setLineDash([])},jn=$e?"#ffffff":"#000000";if(jt.shot&&qr(ut.shot,"#94a3b8",[5,5]),jt.read&&qr(ut.read,"#f43f5e",[3,3]),jt.prnu&&qr(ut.prnu,"#f59e0b",[3,3]),jt.total&&qr(ut.total,jn,[]),Dt.length===2){const at="#6366f1";qr(Dt,at,[4,2]);const qt=Dt[1],dr=ur(qt.y);dr>=Ie.top&&dr<=Ie.top+gt&&(ae.fillStyle=at,ae.font="bold 20px sans-serif",ae.textAlign="right",ae.textBaseline="bottom",ae.fillText(`M.Tgt=${$}`,Ie.left+Ct-10,dr-8))}if(Or.length===2&&(_e!=null&&_e.ptpTarget)){const at="#10b981";qr(Or,at,[4,4]);const qt=Or[1],dr=ur(qt.y);if(dr>=Ie.top&&dr<=Ie.top+gt){ae.fillStyle=at,ae.font="bold 20px sans-serif",ae.textAlign="right",ae.textBaseline="bottom";const Gt=_e.ptpTarget.toFixed(1),Kn=Dt.length===2?ur(Dt[1].y):-100,Hr=Math.abs(dr-Kn)<25?25:0;ae.fillText(`PTP=${Gt}`,Ie.left+Ct-10,dr-8-Hr)}}if(jt.fitRange||fe){const at=(qt,dr)=>{const Gt=zr(qt);Gt>=Ie.left&&Gt<=Ie.left+Ct&&(ae.beginPath(),ae.strokeStyle=dr,ae.lineWidth=2,ae.setLineDash([8,8]),ae.moveTo(Gt,Ie.top),ae.lineTo(Gt,Ie.top+gt),ae.stroke(),ae.setLineDash([]))};at(yr,"#22d3ee"),at(Xr,"#22d3ee")}if(re){const at=zr(re);at>=Ie.left&&at<=Ie.left+Ct&&(ae.strokeStyle="#ef4444",ae.lineWidth=3,ae.setLineDash([10,10]),ae.beginPath(),ae.moveTo(at,Ie.top),ae.lineTo(at,Ie.top+gt),ae.stroke(),ae.setLineDash([]),ae.fillStyle="#ef4444",ae.font="bold 24px sans-serif",ae.textAlign="center",ae.fillText("Sat",at,Ie.top-10))}ae.fillStyle=yt,ae.font="28px monospace",ae.textAlign="center",ae.fillText(Ir.toExponential(1),Ie.left,Ie.top+gt+40),ae.fillText(gr.toExponential(1),Ie.left+Ct,Ie.top+gt+40),ae.fillText("Signal (DN)",Ie.left+Ct/2,Ie.top+gt+80),ae.textAlign="right",ae.textBaseline="middle",ae.fillText(Cr.toExponential(1),Ie.left-20,Ie.top+gt),ae.fillText(Lr.toExponential(1),Ie.left-20,Ie.top),ae.save(),ae.translate(Ie.left-80,Ie.top+gt/2),ae.rotate(-Math.PI/2),ae.textAlign="center",ae.fillText(d==="Linear"?"(Var - RN) / Mean":d,0,0),ae.restore(),ae.save(),ae.translate(2048/2,1536/2),ae.rotate(-Math.PI/6),ae.textAlign="center",ae.textBaseline="middle",ae.fillStyle=$e?"rgba(255, 255, 255, 0.1)":"rgba(0, 0, 0, 0.1)",ae.font="bold 150px sans-serif",ae.fillText(" y-g-jiang.github.io",0,0),ae.restore(),ae.fillStyle=yt,ae.font="bold 36px sans-serif",ae.textAlign="left",ae.textBaseline="top",ae.fillText(`PTC Export: ${d} Mode`,Ie.left,20),ae.font="24px sans-serif",ae.fillStyle=$e?"#94a3b8":"#64748b",ae.fillText(`Points: ${vt.length} | Sat Channel: ${nr}`,Ie.left,65);const Qa=Ie.left+30,go=Ie.top+30,Go=70,Pa=at=>{if(!re||at<=0)return"--";const qt=nt.readNoise,dr=nt.gain,Gt=nt.prnu/100;if(dr<=0)return"--";const Kn=at*at,Hr=qt*qt,la=1-Kn*Gt*Gt,La=-(Kn/dr),Fn=-(Kn*Hr);let ga=0;if(Math.abs(la)<1e-8)Math.abs(La)>1e-8&&(ga=-Fn/La);else{const tn=La*La-4*la*Fn;tn>=0&&(ga=(-La+Math.sqrt(tn))/(2*la))}return ga>0?Math.log2(re/ga).toFixed(2)+" EV":"--"},Ra=_e!=null&&_e.ptpTarget&&!isNaN(_e.ptpTarget)?Pa(_e.ptpTarget):"--",ji=$?Pa(parseFloat($)):"--";ae.font="bold 48px monospace",ae.textAlign="left",ae.textBaseline="top",ae.shadowColor=$e?"rgba(0,0,0,0.8)":"rgba(255,255,255,0.8)",ae.shadowBlur=4,ae.shadowOffsetX=1,ae.shadowOffsetY=1;const sn=(at,qt,dr,Gt)=>{const Kn=go+dr*Go;ae.fillStyle=yt,ae.fillText(at,Qa,Kn);const Hr=ae.measureText(at).width;ae.fillStyle=Gt||yt,ae.fillText(qt,Qa+Hr,Kn)},mo=Kt.read,yo=parseFloat(Kt.gain).toFixed(3),zi=parseFloat(Kt.prnu).toFixed(2)+"%";let Ba=`M.DR@SNR${$}: `;const _a=parseFloat(U);if(!isNaN(_a)&&_a>0){const at=(2309.4/_a).toFixed(2);Math.abs(parseFloat($)-parseFloat(at))<.05&&(Ba="8mpSNR=1 DR: ")}sn("Tester: ",rt||"N/A",0),sn("Model : ",tt||"Unknown",1),sn("ISO   : ",wt||"N/A",2),sn("RN/FPN: ",mo,3,"#f43f5e"),sn("KADC  : ",yo,4,"#06b6d4"),sn("PRNU  : ",zi,5,"#f59e0b"),sn("PTP DR: ",_e!=null&&_e.ptpDR?_e.ptpDR.toFixed(2)+" EV":"--",6,"#10b981"),sn("D55 DR: ",_e!=null&&_e.d55DR?_e.d55DR.toFixed(2)+" EV":"--",7,"#8b5cf6"),sn("FWC   : ",St?St>1e4?(St/1e3).toFixed(1)+"k":Math.round(St).toString():"--",8,"#f97316"),sn(Ba,_e!=null&&_e.manualDR?_e.manualDR.toFixed(2)+" EV":"--",9,"#06b6d4"),sn("PTCFitDR(PTP): ",Ra,10,"#10b981"),sn("PTCFitDR(Man): ",ji,11,"#06b6d4"),ae.save(),ae.textAlign="right",ae.textBaseline="bottom",ae.fillStyle="#3b82f6",ae.font="bold 80px sans-serif",ae.shadowColor=$e?"rgba(0,0,0,0.8)":"rgba(255,255,255,0.8)",ae.shadowBlur=4,ae.shadowOffsetX=2,ae.shadowOffsetY=2;const Zr=1988,Bn=1476,yl=90;ae.fillText("Online",Zr,Bn),ae.fillText("Jiangtherapee",Zr,Bn-yl),ae.restore();const Ln=document.createElement("a");Ln.download=`ptc_complete_${d}_${Date.now()}.jpg`,Ln.href=ke.toDataURL("image/jpeg",.9),Ln.click()},[vt,nr,S,O,I,B,Y,Ke,Yt,Ht,At,h,s,d,re,i,jt,ut,yr,Xr,rr,fe,rt,tt,wt,_e,St,$,Dt,Or,Kt,U,he]),Ce=_.useMemo(()=>{let ce=vt;if(h&&(ce=ce.filter($e=>$e.y>0&&$e.x>0)),v==="top3"){const $e=[...ce].sort((yt,Tt)=>Tt.x-yt.x),pt=Math.max(50,Math.ceil($e.length*.03));ce=$e.slice(0,pt)}const be={R:[],G1:[],G2:[],B:[]};if(ce.forEach($e=>{be[$e.channel]&&be[$e.channel].push($e)}),v==="raw")return be;const ke=v==="top3"?500:kie,ae=$e=>{if($e.length<=ke)return $e;const pt=[...$e].sort((Et,Mt)=>Et.x-Mt.x),yt=[],Tt=pt.length/ke;for(let Et=0;Et<ke;Et++){const Mt=Math.floor(Et*Tt),Ir=Math.floor((Et+1)*Tt),gr=pt.slice(Mt,Ir);if(gr.length===0)continue;gr.sort((Lr,Ie)=>Lr.y-Ie.y);const Cr=Math.floor(gr.length/2);yt.push(gr[Cr])}return yt};return{R:ae(be.R),G1:ae(be.G1),G2:ae(be.G2),B:ae(be.B)}},[vt,v,h]),Ee=_.useMemo(()=>{if(Jt.length<5)return[];const ce=Jt.filter(ke=>ke.channel===nr);return[...ce.length>20?ce:Jt].sort((ke,ae)=>ke.x-ae.x).map(ke=>({mean:ke.x,std:ke.std}))},[Jt,nr]),_t=ce=>{const be=ce.length;if(be===0)return[];const ke=ce.reduce((Ct,gt)=>Ct+gt,0)/be,ae=ce.reduce((Ct,gt)=>Ct+Math.pow(gt-ke,2),0)/(be-1||1),$e=Math.sqrt(ae);if($e===0)return[{x:ke-.001,density:0},{x:ke,density:1},{x:ke+.001,density:0}];const pt=1.06*$e*Math.pow(be,-.2),yt=Math.min(...ce),Tt=Math.max(...ce),Et=(Tt-yt)*.2||yt*.1,Mt=Math.max(0,yt-Et),Ir=Tt+Et,gr=100,Cr=(Ir-Mt)/(gr-1),Lr=Ct=>1/Math.sqrt(2*Math.PI)*Math.exp(-.5*Ct*Ct),Ie=[];for(let Ct=0;Ct<gr;Ct++){const gt=Mt+Ct*Cr;let zr=0;for(let ur=0;ur<be;ur++)zr+=Lr((gt-ce[ur])/pt);zr/=be*pt,Ie.push({x:gt,density:zr})}return Ie},He=_.useCallback((ce,be,ke,ae)=>{if(ce.length<5)return{gain:0,prnu:0};const $e=ce[ce.length-1].mean,pt=$e*(ke.min/100),yt=$e*(ke.max/100),Tt=ce.filter(Mr=>Mr.mean>=pt&&Mr.mean<=yt);if(Tt.length<5)return{gain:0,prnu:0};Gr({nPoints:Tt.length});const Et=be*be,Mt=[],Ir=[];if(Tt.forEach(Mr=>{const jn=Mr.std*Mr.std-Et;if(Mr.mean>1&&jn>0){const Qa=Mr.mean,go=jn/Mr.mean;Mt.push({x:Qa,y:go}),Ir.push(Mr.mean/jn)}}),Mt.length<5)return{gain:0,prnu:0};const gr=[],Cr=Mt.length,Lr=ae,Ie=Cr*(Cr-1)/2;if(Ie<=Lr)for(let Mr=0;Mr<Cr;Mr++)for(let qr=Mr+1;qr<Cr;qr++){const jn=Mt[qr].x-Mt[Mr].x;Math.abs(jn)>1e-5&&gr.push((Mt[qr].y-Mt[Mr].y)/jn)}else{const Mr=Math.max(1,Math.floor(Ie/Lr));for(let qr=0;qr<Cr;qr++)for(let jn=qr+1;jn<Cr;jn+=Mr){const Qa=Mt[jn].x-Mt[qr].x;Math.abs(Qa)>1e-5&&gr.push((Mt[jn].y-Mt[qr].y)/Qa)}}const Ct=sx(gr),gt=Mt.map(Mr=>Mr.y-Ct*Mr.x),zr=sx(gt);let ur=0,Rn=0;if(zr>1e-6?ur=1/zr:ur=sx(Ir),Ct>0&&(Rn=Math.sqrt(Ct)*100),Ir.length>0){const Mr=_t(Ir);ze(Mr),ot(ur)}else ze([]);return{gain:ur,prnu:Rn}},[]),dt=_.useCallback(ce=>{let be=ce.read??jr.current.readNoise;const ke=ce.gRange??Rr.current,ae=Pr.current;if((ce.read!==void 0||ce.gRange!==void 0)&&ce.gain===void 0&&ce.prnu===void 0&&Ee.length>0&&be>=0)j(!0),setTimeout(()=>{const pt=He(Ee,be,ke,ae);let yt=jr.current.gain,Tt=jr.current.prnu;pt.gain>0&&(yt=pt.gain,Tt=pt.prnu),Ot({readNoise:be,gain:yt,prnu:Tt}),ce.gRange!==void 0&&Nr(ce.gRange),Er(Et=>{var Mt,Ir;return{...Et,read:be.toString(),gain:yt>0?yt.toFixed(3):"0",prnu:Tt.toFixed(2),rangeMin:(((Mt=ce.gRange)==null?void 0:Mt.min)??Et.rangeMin).toString(),rangeMax:(((Ir=ce.gRange)==null?void 0:Ir.max)??Et.rangeMax).toString()}}),j(!1)},50);else{let pt=ce.gain!==void 0?ce.gain:jr.current.gain,yt=ce.prnu!==void 0?ce.prnu:jr.current.prnu;Ot({readNoise:be,gain:pt,prnu:yt}),ce.gRange!==void 0&&Nr(ce.gRange),Er(Tt=>{var Et,Mt;return{...Tt,read:be.toString(),gain:pt>0?pt.toFixed(3):"0",prnu:yt.toFixed(2),rangeMin:(((Et=ce.gRange)==null?void 0:Et.min)??Tt.rangeMin).toString(),rangeMax:(((Mt=ce.gRange)==null?void 0:Mt.max)??Tt.rangeMax).toString()}})}},[Ee,He]),qe=`${Q}-${r.length}`;_.useEffect(()=>{if(!e||!r||r.length===0)return;const ce=Ce[nr];if(!ce||ce.length===0||Pt===qe)return;M({R:nr==="R",G1:nr==="G1",G2:nr==="G2",B:nr==="B"});const be=[...ce].sort((pt,yt)=>pt.x-yt.x);let ke=0;be.length>0&&(ke=be[0].std);const ae=Jt.filter(pt=>pt.channel===nr);let $e=-1/0;for(const pt of ae)pt.x>$e&&($e=pt.x);$e!==-1/0&&De($e),dt({read:ke}),Qe(qe)},[e,r,Pt,qe,Ce,nr,dt,Jt]);const Lt=(ce,be)=>{Er(ke=>({...ke,[ce]:be}))},Ur=ce=>{let be=parseFloat(Kt[ce]);isNaN(be)||be<0||dt({[ce]:be})},Kr=()=>{te(J),Qe("")},lr=()=>{const ce=parseFloat(Kt.rangeMin),be=parseFloat(Kt.rangeMax);!isNaN(ce)&&!isNaN(be)&&ce<be&&ce>=0&&be<=100&&dt({gRange:{min:ce,max:be}})},kn=(ce,be)=>{ce.key==="Enter"&&(be==="rangeMin"||be==="rangeMax"?lr():Ur(be),ce.target.blur())};_.useEffect(()=>{e&&Ee.length>0&&dt({})},[e,pr,Ee]);const Yr=ce=>{M(be=>({...be,[ce]:!be[ce]}))},Ar=()=>{x(ce=>ce==="top3"?"default":"top3")},cr=()=>{v==="raw"?x("default"):k(!0)},Ft=()=>{k(!1),x("raw")},Br=(ce,be)=>{const ke=parseFloat(ce),ae=parseFloat(be);let $e=isNaN(ke)?"auto":ke,pt=isNaN(ae)?"auto":ae;return h&&typeof $e=="number"&&$e<=0&&($e="auto"),[$e,pt]},We=ce=>{if(!ce||!ce.payload)return;const be=ce.payload;if(w(be),Wt.current&&(De(be.x),me(!1)),kt.current){const ke=Rr.current.min,ae=Rr.current.max,{max:$e}=A();if($e<=0)return;const pt=Math.max(0,Math.min(100,be.x/$e*100));if(Bt.current===1){const yt=Math.min(pt,ae-.5);dt({gRange:{min:yt,max:ae}}),Se(2)}else if(Bt.current===2){const yt=Math.max(pt,ke+.5);dt({gRange:{min:ke,max:yt}}),Se(0),le(!1)}}},xr=_.useCallback(ce=>{const{cx:be,cy:ke,fill:ae}=ce;return c.jsx("circle",{cx:be,cy:ke,r:3,fill:ae,stroke:"none",style:{cursor:"pointer"}})},[]),mn=({active:ce,payload:be})=>{if(ce&&be&&be.length){const ke=be[0].payload;return c.jsxs("div",{className:"bg-slate-800 text-white text-xs p-2 rounded border border-slate-600 shadow-xl opacity-90 font-mono z-50",children:[c.jsx("div",{className:"font-bold border-b border-slate-600 pb-1 mb-1",children:ke.channel}),c.jsxs("div",{children:["Signal: ",ke.x.toFixed(2)]}),c.jsxs("div",{children:[d,": ",ke.y.toFixed(4)]}),ke.row!==void 0&&ke.col!==void 0&&!isNaN(ke.row)&&!isNaN(ke.col)&&c.jsxs("div",{className:"text-cyan-400 mt-0.5",children:["Loc: Row ",ke.row,", Col ",ke.col]}),ke.filename&&c.jsx("div",{className:"text-gray-400 mt-1 max-w-[200px] truncate",title:ke.filename,children:ke.filename})]})}return null},sa=ce=>{f(ce),ce==="Linear"&&g(!1)};if(!e)return null;const Da=s==="dark"?"#ffffff":"#000000";let Sn=d;d==="Linear"&&(Sn="(Var - RN) / Mean");const Ja=J!==Q;return c.jsx("div",{className:"fixed inset-0 z-[60] flex items-center justify-center bg-black/60 backdrop-blur-sm p-4 animate-in fade-in",onClick:ce=>{ce.stopPropagation()},children:c.jsxs("div",{className:"bg-white dark:bg-slate-900 w-[98vw] max-w-[2200px] h-[95vh] rounded-2xl shadow-2xl flex flex-col border border-gray-200 dark:border-slate-700 overflow-hidden relative",onClick:ce=>ce.stopPropagation(),children:[c.jsx(el,{isOpen:m,onClose:()=>k(!1),onConfirm:Ft,title:"Warning: High Performance Cost",message:"Displaying all data points may cause the browser to freeze or become unresponsive, especially with large datasets. Are you sure you want to continue?",confirmText:"Yes, Show All"}),b&&c.jsxs("div",{className:"absolute top-20 right-8 z-30 bg-white/90 dark:bg-slate-800/90 border border-cyan-500 rounded-xl p-4 shadow-xl backdrop-blur-md max-w-xs animate-in fade-in zoom-in-95 duration-200",children:[c.jsxs("div",{className:"flex justify-between items-start mb-2 border-b border-gray-200 dark:border-slate-700 pb-2",children:[c.jsx("h4",{className:"font-bold text-gray-900 dark:text-white text-sm",children:"Selected Point"}),c.jsx("button",{onClick:()=>w(null),className:"text-gray-400 hover:text-gray-600 dark:hover:text-slate-200",children:c.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),c.jsx("div",{className:"space-y-1 text-xs font-mono text-gray-700 dark:text-slate-300",children:c.jsxs("div",{className:"grid grid-cols-2 gap-x-4 gap-y-1.5",children:[c.jsx("span",{className:"text-gray-500 dark:text-slate-500",children:"Channel:"}),c.jsx("span",{className:"font-bold",children:b.channel}),c.jsx("span",{className:"text-gray-500 dark:text-slate-500",children:"Signal (DN):"}),c.jsx("span",{children:b.x.toFixed(4)}),c.jsx("span",{className:"text-gray-500 dark:text-slate-500",children:"Noise (Std):"}),c.jsx("span",{children:b.std.toFixed(4)}),c.jsx("span",{className:"text-gray-500 dark:text-slate-500",children:"SNR:"}),c.jsx("span",{className:"text-purple-600 dark:text-purple-400 font-bold",children:(b.x/b.std).toFixed(2)})]})})]}),X&&c.jsx("div",{className:"absolute inset-0 z-40 bg-white/95 dark:bg-slate-900/95 backdrop-blur-sm flex flex-col items-center justify-center p-8 animate-in fade-in zoom-in-95 duration-200",children:c.jsxs("div",{className:"w-full max-w-2xl h-[60vh] bg-gray-50 dark:bg-slate-800 rounded-xl border border-gray-200 dark:border-slate-700 shadow-2xl p-4 flex flex-col relative",children:[c.jsx("button",{onClick:()=>Te(!1),className:"absolute top-4 right-4 text-gray-400 hover:text-red-500 transition-colors",children:c.jsx("svg",{className:"w-6 h-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})}),c.jsxs("div",{className:"mb-4 text-center",children:[c.jsx("h3",{className:"text-lg font-bold text-gray-800 dark:text-slate-200",children:"Gain Density Estimation"}),c.jsxs("p",{className:"text-xs text-gray-500 dark:text-slate-400",children:["HSM Mode: ",c.jsx("span",{className:"text-cyan-600 dark:text-cyan-400 font-bold",children:Je==null?void 0:Je.toFixed(4)}),c.jsx("span",{className:"mx-2",children:"|"}),"Data Points: ",xe.length>0?"Density Curve Generated":"No Data"]})]}),c.jsx("div",{className:"flex-1 min-h-0",children:xe.length>0?c.jsx(_o,{width:"100%",height:"100%",children:c.jsxs(_O,{data:xe,margin:{top:10,right:30,left:0,bottom:20},children:[c.jsx(so,{strokeDasharray:"3 3",stroke:"#374151",opacity:.3,vertical:!1}),c.jsx(Xa,{dataKey:"x",tickFormatter:ce=>ce.toFixed(2),tick:{fill:"#9ca3af",fontSize:10},label:{value:"Gain (e/ADU)",position:"insideBottom",offset:-15,fill:"#9ca3af",fontSize:12}}),c.jsx(Ka,{tick:{fill:"#9ca3af",fontSize:10}}),c.jsx(ra,{cursor:{stroke:"rgba(255,255,255,0.2)"},contentStyle:{backgroundColor:"#1f2937",border:"1px solid #374151",borderRadius:"0.5rem",color:"#f3f4f6"}}),c.jsx($i,{type:"monotone",dataKey:"density",stroke:"#0ea5e9",fill:"#0ea5e9",fillOpacity:.3,strokeWidth:2}),Je!==null&&c.jsx(Ws,{x:Je,stroke:"#ef4444",strokeWidth:2,label:{value:"HSM",fill:"#ef4444",fontSize:10,position:"top"}})]})}):c.jsx("div",{className:"flex items-center justify-center h-full text-gray-400",children:"No data in selected range"})})]})}),c.jsxs("div",{className:"flex flex-wrap justify-between items-center p-3 border-b border-gray-200 dark:border-slate-700 bg-gray-50 dark:bg-slate-800/50 gap-4 flex-shrink-0",children:[c.jsxs("h2",{className:"text-lg font-bold text-gray-900 dark:text-slate-100 flex items-center gap-2",children:["Photon Transfer Curve",c.jsxs("span",{className:"text-xs font-normal bg-purple-100 dark:bg-purple-900/30 text-purple-600 dark:text-purple-300 px-2 py-0.5 rounded border border-purple-200 dark:border-purple-800",children:[r.length," Pts"]})]}),c.jsxs("div",{className:"flex gap-4 items-center flex-wrap",children:[c.jsxs("button",{onClick:F,className:"bg-green-600 hover:bg-green-500 text-white font-bold py-1 px-3 rounded text-xs shadow-md transition-all active:scale-95 flex items-center gap-1",title:"Render all points, target lines, and metadata to a high-res JPG",children:[c.jsx("svg",{className:"w-3 h-3",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"})}),"Export Complete Result"]}),c.jsxs("div",{className:"flex bg-white dark:bg-slate-700 rounded-lg p-1 border border-gray-200 dark:border-slate-600",children:[c.jsx("button",{onClick:()=>sa("Noise"),className:`px-3 py-1 text-xs font-bold rounded transition-colors ${d==="Noise"?"bg-cyan-600 text-white shadow":"text-gray-600 dark:text-slate-300 hover:bg-gray-100 dark:hover:bg-slate-600"}`,children:"Noise ()"}),c.jsx("button",{onClick:()=>sa("SNR"),className:`px-3 py-1 text-xs font-bold rounded transition-colors ${d==="SNR"?"bg-purple-600 text-white shadow":"text-gray-600 dark:text-slate-300 hover:bg-gray-100 dark:hover:bg-slate-600"}`,children:"SNR"}),c.jsx("button",{onClick:()=>sa("Linear"),className:`px-3 py-1 text-xs font-bold rounded transition-colors ${d==="Linear"?"bg-indigo-600 text-white shadow":"text-gray-600 dark:text-slate-300 hover:bg-gray-100 dark:hover:bg-slate-600"}`,children:"Linear (PTC)"})]}),c.jsxs("label",{className:"flex items-center gap-2 text-xs text-gray-600 dark:text-slate-300 cursor-pointer select-none",children:[c.jsx("input",{type:"checkbox",checked:h,onChange:ce=>g(ce.target.checked),className:"rounded border-gray-300 text-cyan-600 focus:ring-cyan-500 bg-gray-100 dark:bg-slate-700 dark:border-slate-600"}),"Log-Log"]}),c.jsx("button",{onClick:t,className:"text-gray-400 hover:text-red-500 transition-colors p-1",children:c.jsx("svg",{className:"w-6 h-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]})]}),c.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-12 gap-0 border-b border-gray-200 dark:border-slate-700 bg-white dark:bg-slate-900 text-sm flex-shrink-0",children:[c.jsxs("div",{className:"lg:col-span-9 p-5 flex flex-col gap-5 border-r border-gray-200 dark:border-slate-700",children:[c.jsxs("div",{className:"flex flex-wrap gap-4 items-center justify-between text-xs",children:[c.jsxs("div",{className:"flex gap-4 items-center",children:[c.jsxs("div",{className:"flex items-center gap-1.5 bg-gray-50 dark:bg-slate-800 rounded-md p-1 border border-gray-200 dark:border-slate-700",children:[c.jsx("span",{className:"font-bold text-gray-500 dark:text-slate-400 pl-1",children:"X:"}),c.jsx("input",{type:"number",placeholder:"Min",value:O,onChange:ce=>E(ce.target.value),className:"w-12 px-1 py-0.5 bg-white dark:bg-slate-900 border border-gray-300 dark:border-slate-600 rounded text-center outline-none"}),c.jsx("span",{className:"text-gray-400",children:"-"}),c.jsx("input",{type:"number",placeholder:"Max",value:I,onChange:ce=>D(ce.target.value),className:"w-12 px-1 py-0.5 bg-white dark:bg-slate-900 border border-gray-300 dark:border-slate-600 rounded text-center outline-none"})]}),c.jsxs("div",{className:"flex items-center gap-1.5 bg-gray-50 dark:bg-slate-800 rounded-md p-1 border border-gray-200 dark:border-slate-700",children:[c.jsx("span",{className:"font-bold text-gray-500 dark:text-slate-400 pl-1",children:"Y:"}),c.jsx("input",{type:"number",placeholder:"Min",value:B,onChange:ce=>z(ce.target.value),className:"w-12 px-1 py-0.5 bg-white dark:bg-slate-900 border border-gray-300 dark:border-slate-600 rounded text-center outline-none"}),c.jsx("span",{className:"text-gray-400",children:"-"}),c.jsx("input",{type:"number",placeholder:"Max",value:Y,onChange:ce=>G(ce.target.value),className:"w-12 px-1 py-0.5 bg-white dark:bg-slate-900 border border-gray-300 dark:border-slate-600 rounded text-center outline-none"})]}),c.jsx("button",{onClick:()=>{E(""),D(""),z(""),G("")},className:"text-xs text-cyan-600 dark:text-cyan-400 hover:underline",children:"Auto"})]}),c.jsxs("div",{className:"flex items-center gap-1 bg-white dark:bg-slate-700 p-1 rounded-lg border border-gray-200 dark:border-slate-600",children:[c.jsx("button",{onClick:()=>Yr("R"),className:`w-6 h-6 text-[10px] font-bold rounded flex items-center justify-center transition-colors ${S.R?"bg-red-500 text-white":"bg-gray-100 dark:bg-slate-600 text-gray-400"}`,children:"R"}),c.jsx("button",{onClick:()=>Yr("G1"),className:`w-6 h-6 text-[10px] font-bold rounded flex items-center justify-center transition-colors ${S.G1?"bg-green-500 text-white":"bg-gray-100 dark:bg-slate-600 text-gray-400"}`,children:"G1"}),c.jsx("button",{onClick:()=>Yr("G2"),className:`w-6 h-6 text-[10px] font-bold rounded flex items-center justify-center transition-colors ${S.G2?"bg-green-400 text-white":"bg-gray-100 dark:bg-slate-600 text-gray-400"}`,children:"G2"}),c.jsx("button",{onClick:()=>Yr("B"),className:`w-6 h-6 text-[10px] font-bold rounded flex items-center justify-center transition-colors ${S.B?"bg-blue-500 text-white":"bg-gray-100 dark:bg-slate-600 text-gray-400"}`,children:"B"})]})]}),c.jsxs("div",{className:"flex flex-wrap items-end gap-8",children:[c.jsxs("div",{className:"flex flex-col bg-gray-50 dark:bg-slate-800/50 p-2 rounded border border-gray-100 dark:border-slate-700",children:[c.jsx("span",{className:"text-[9px] uppercase font-bold text-gray-500 dark:text-slate-400 mb-1",children:"Black Level (0,0 0,1 1,0 1,1)"}),c.jsx("input",{type:"text",value:J,onChange:ce=>K(ce.target.value),className:"w-32 text-xs px-2 py-1 bg-white dark:bg-slate-900 border border-gray-300 dark:border-slate-600 rounded outline-none focus:border-cyan-500 font-mono",placeholder:"0 0 0 0"})]}),c.jsxs("div",{className:"flex flex-col justify-between bg-gray-50 dark:bg-slate-800/50 p-2 rounded border border-gray-100 dark:border-slate-700",children:[c.jsxs("div",{className:"flex justify-between items-center mb-1",children:[c.jsx("span",{className:"text-[9px] uppercase font-bold text-gray-500 dark:text-slate-400 mr-2",children:"Fit Range % (Robust)"}),c.jsx("button",{onClick:()=>{le(!fe),Se(fe?0:1)},className:`px-1.5 py-0.5 text-[9px] rounded border transition-colors ${fe?"bg-cyan-100 text-cyan-700 border-cyan-300 animate-pulse":"bg-white dark:bg-slate-700 border-gray-300 dark:border-slate-600 text-gray-600 dark:text-slate-300 hover:bg-gray-50"}`,children:fe?de===1?"Pick Min":"Pick Max":"Select"})]}),c.jsxs("div",{className:"flex items-center gap-1 text-xs",children:[c.jsx("input",{type:"number",step:"0.1",value:Kt.rangeMin,onChange:ce=>Lt("rangeMin",ce.target.value),onBlur:lr,onKeyDown:ce=>kn(ce,"rangeMin"),className:"w-10 bg-white dark:bg-slate-900 border border-gray-300 dark:border-slate-600 rounded px-1 py-0.5 text-center font-bold"}),c.jsx("span",{className:"text-gray-400",children:"-"}),c.jsx("input",{type:"number",step:"0.1",value:Kt.rangeMax,onChange:ce=>Lt("rangeMax",ce.target.value),onBlur:lr,onKeyDown:ce=>kn(ce,"rangeMax"),className:"w-10 bg-white dark:bg-slate-900 border border-gray-300 dark:border-slate-600 rounded px-1 py-0.5 text-center font-bold"})]})]}),c.jsxs("div",{className:"flex flex-col bg-indigo-50 dark:bg-indigo-900/20 p-2 rounded border border-indigo-100 dark:border-indigo-800/50",children:[c.jsx("span",{className:"text-[9px] uppercase font-bold text-indigo-600 dark:text-indigo-400 mb-1",children:"DR Params"}),c.jsxs("div",{className:"flex items-center gap-3",children:[c.jsxs("div",{className:"flex items-center gap-1",children:[c.jsx("span",{className:"text-[10px] font-bold text-indigo-500 dark:text-indigo-300",children:"Img H:"}),c.jsx("input",{type:"number",value:U,onChange:ce=>V(ce.target.value),onKeyDown:sr,placeholder:"Empty",className:"w-14 px-1 py-0.5 bg-white dark:bg-slate-900 border border-indigo-200 dark:border-indigo-800 rounded text-center font-bold text-indigo-700 dark:text-indigo-300 text-xs placeholder:font-normal placeholder:text-gray-300"})]}),c.jsxs("div",{className:"flex items-center gap-1",children:[c.jsx("span",{className:"text-[10px] font-bold text-indigo-500 dark:text-indigo-300",children:"Tgt SNR:"}),c.jsx("input",{type:"number",value:$,onChange:ce=>L(ce.target.value),className:"w-10 px-1 py-0.5 bg-white dark:bg-slate-900 border border-indigo-200 dark:border-indigo-800 rounded text-center font-bold text-indigo-700 dark:text-indigo-300 text-xs"})]})]})]}),c.jsxs("div",{className:"flex flex-col gap-1 text-[10px] justify-end pb-0.5",children:[c.jsx("button",{onClick:()=>{me(!ee),re&&De(null)},disabled:fe,className:`font-bold rounded border shadow-sm transition-all px-3 py-1.5 ${ee?"bg-amber-100 dark:bg-amber-900/30 text-amber-700 dark:text-amber-400 border-amber-500 animate-pulse":"bg-white dark:bg-slate-800 text-gray-600 dark:text-slate-300 border-gray-300 dark:border-slate-600 hover:bg-gray-50 dark:hover:bg-slate-700"}`,children:ee?"Pick Point":"Select Linear Limit"}),c.jsxs("div",{className:"flex gap-1",children:[c.jsx("button",{onClick:Ar,className:`flex-1 font-bold rounded border shadow-sm transition-all px-2 py-1 ${v==="top3"?"bg-indigo-600 text-white border-indigo-700":"bg-white dark:bg-slate-800 text-gray-600 dark:text-slate-300 border-gray-300 dark:border-slate-600 hover:bg-gray-50"}`,children:"Top 3%"}),c.jsx("button",{onClick:cr,className:`font-bold rounded border shadow-sm transition-all px-2 py-1 ${v==="raw"?"bg-red-600 text-white border-red-700":"text-red-500 border-red-200 hover:bg-red-50"}`,children:"All"})]})]})]}),c.jsxs("div",{className:"flex flex-wrap gap-4 items-center bg-gray-50/50 dark:bg-slate-800/20 p-2 rounded-lg border border-gray-100 dark:border-slate-800",children:[c.jsx("span",{className:"text-[10px] uppercase font-bold text-gray-400 dark:text-slate-500",children:"Metadata"}),c.jsxs("div",{className:"flex gap-2",children:[c.jsx("input",{type:"text",value:rt,onChange:ce=>et(ce.target.value),placeholder:"Tester Name",className:"w-24 text-xs bg-white dark:bg-slate-900 border border-gray-300 dark:border-slate-600 rounded px-2 py-1 text-gray-700 dark:text-slate-300 outline-none focus:border-cyan-500 transition-colors"}),c.jsx("input",{type:"text",value:tt,onChange:ce=>ft(ce.target.value),placeholder:"Camera Model",className:"w-32 text-xs bg-white dark:bg-slate-900 border border-gray-300 dark:border-slate-600 rounded px-2 py-1 text-gray-700 dark:text-slate-300 outline-none focus:border-cyan-500 transition-colors"}),c.jsx("input",{type:"text",value:wt,onChange:ce=>fr(ce.target.value),placeholder:"ISO",className:"w-16 text-xs bg-white dark:bg-slate-900 border border-gray-300 dark:border-slate-600 rounded px-2 py-1 text-gray-700 dark:text-slate-300 outline-none focus:border-cyan-500 transition-colors"})]})]}),c.jsxs("div",{className:"flex flex-wrap gap-4 items-center bg-fuchsia-50/50 dark:bg-fuchsia-900/10 p-2 rounded-lg border border-fuchsia-100 dark:border-fuchsia-900/30",children:[c.jsx("span",{className:"text-[10px] uppercase font-bold text-fuchsia-500 dark:text-fuchsia-400",children:"Markers"}),c.jsxs("div",{className:"flex gap-2 items-center",children:[c.jsx("input",{type:"number",value:ve,onChange:ce=>ye(ce.target.value),placeholder:"X (Signal)",className:"w-20 text-xs bg-white dark:bg-slate-900 border border-gray-300 dark:border-slate-600 rounded px-2 py-1 outline-none focus:border-fuchsia-500 transition-colors"}),c.jsx("input",{type:"number",value:ge,onChange:ce=>ue(ce.target.value),placeholder:"Y (Value)",className:"w-20 text-xs bg-white dark:bg-slate-900 border border-gray-300 dark:border-slate-600 rounded px-2 py-1 outline-none focus:border-fuchsia-500 transition-colors"}),c.jsx("button",{onClick:Le,className:"px-3 py-1 bg-fuchsia-600 hover:bg-fuchsia-500 text-white text-xs font-bold rounded shadow-sm transition-colors active:scale-95",children:"+"}),he.length>0&&c.jsx("button",{onClick:()=>Pe([]),className:"px-2 py-1 bg-gray-200 dark:bg-slate-700 hover:bg-red-500 hover:text-white text-gray-600 dark:text-slate-300 text-xs font-bold rounded shadow-sm transition-colors active:scale-95",children:"Clr"})]}),c.jsxs("div",{className:"text-[10px] text-gray-400 dark:text-slate-500 font-mono",children:[he.length," pts"]})]}),c.jsxs("div",{className:"flex gap-4 text-[10px] pt-1 justify-center sm:justify-start flex-wrap",children:[c.jsxs("label",{className:"flex items-center gap-1 cursor-pointer select-none",children:[c.jsx("input",{type:"checkbox",checked:jt.shot,onChange:ce=>Me({...jt,shot:ce.target.checked}),className:"rounded text-gray-500"})," ",c.jsx("span",{className:"text-gray-500",children:"Shot Noise"})]}),c.jsxs("label",{className:"flex items-center gap-1 cursor-pointer select-none",children:[c.jsx("input",{type:"checkbox",checked:jt.read,onChange:ce=>Me({...jt,read:ce.target.checked}),className:"rounded text-rose-500"})," ",c.jsx("span",{className:"text-rose-500",children:"Read Noise"})]}),c.jsxs("label",{className:"flex items-center gap-1 cursor-pointer select-none",children:[c.jsx("input",{type:"checkbox",checked:jt.prnu,onChange:ce=>Me({...jt,prnu:ce.target.checked}),className:"rounded text-amber-500"})," ",c.jsx("span",{className:"text-amber-500",children:"PRNU"})]}),c.jsxs("label",{className:"flex items-center gap-1 cursor-pointer select-none",children:[c.jsx("input",{type:"checkbox",checked:jt.total,onChange:ce=>Me({...jt,total:ce.target.checked}),className:"rounded text-white"})," ",c.jsx("span",{className:"text-gray-900 dark:text-white font-bold",children:"Model"})]})]})]}),c.jsxs("div",{className:"lg:col-span-3 bg-slate-100 dark:bg-slate-800 p-4 flex flex-col justify-center gap-4",children:[c.jsxs("div",{children:[c.jsxs("div",{className:"flex justify-between items-center mb-1 px-1",children:[c.jsxs("h3",{className:"text-xs font-bold text-gray-500 dark:text-slate-400 uppercase flex items-center gap-2",children:["Fit Parameters (D55 SAT Channel:",nr,")",P&&c.jsx("span",{className:"text-orange-500 animate-pulse text-[10px]",children:"Calculating..."})]}),c.jsxs("div",{className:"flex gap-2 items-center",children:[c.jsx("button",{onClick:Kr,disabled:P,className:`px-3 py-1 text-white text-[10px] font-bold rounded shadow-sm transition-all flex items-center gap-1 active:scale-95 
                                            ${P?"bg-gray-400 cursor-wait":Ja?"bg-orange-500 hover:bg-orange-600 animate-pulse ring-2 ring-orange-400/50":"bg-cyan-600 hover:bg-cyan-500"}
                                        `,title:"Apply Black Level, Auto-detect Read Noise, then Recalculate Fit",children:P?c.jsxs(c.Fragment,{children:[c.jsxs("svg",{className:"w-3 h-3 animate-spin",viewBox:"0 0 24 24",fill:"none",children:[c.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),c.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4z"})]}),"Fitting..."]}):c.jsxs(c.Fragment,{children:[c.jsxs("svg",{className:"w-3 h-3",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:[c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M14.752 11.168l-3.197-2.132A1 1 0 0010 9.87v4.263a1 1 0 001.555.832l3.197-2.132a1 1 0 000-1.664z"}),c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})]}),"Apply & Calc"]})}),c.jsxs("select",{value:pr,onChange:ce=>br(Number(ce.target.value)),className:"text-[9px] bg-slate-200 dark:bg-slate-700 text-gray-600 dark:text-slate-300 rounded px-1 py-0.5 border-none outline-none cursor-pointer hover:bg-slate-300 dark:hover:bg-slate-600 transition-colors",title:"Number of point-pairs to sample for robust regression (Theil-Sen)",children:[c.jsx("option",{value:1e5,children:"100k Pairs"}),c.jsx("option",{value:5e5,children:"500k Pairs"}),c.jsx("option",{value:2e6,children:"2M Pairs"}),c.jsx("option",{value:5e6,children:"5M Pairs"}),c.jsx("option",{value:1e7,children:"10M Pairs"})]}),Sr&&c.jsxs("span",{className:"text-[10px] text-gray-400 dark:text-slate-500 font-mono",title:"Number of points used in regression",children:["N=",Sr.nPoints]})]})]}),c.jsxs("div",{className:"grid grid-cols-3 gap-2",children:[c.jsxs("div",{className:"flex flex-col items-center",children:[c.jsx("label",{className:"text-[10px] text-gray-500 dark:text-slate-400 uppercase tracking-wide mb-1",children:"rn/fpn"}),c.jsx("input",{type:"text",inputMode:"decimal",value:Kt.read,onChange:ce=>Lt("read",ce.target.value),onBlur:()=>Ur("read"),onKeyDown:ce=>kn(ce,"read"),className:"w-full text-center text-2xl font-light bg-transparent text-rose-500 outline-none border-b border-transparent focus:border-rose-500 transition-colors"})]}),c.jsxs("div",{className:"flex flex-col items-center relative group",children:[c.jsxs("label",{className:"text-[10px] text-gray-500 dark:text-slate-400 uppercase tracking-wide mb-1 flex items-center gap-1",children:["Kadc (HSM)",c.jsx("button",{onClick:()=>Te(!0),className:"text-[9px] text-cyan-600 dark:text-cyan-400 hover:underline",children:"Dist."})]}),c.jsx("input",{type:"text",inputMode:"decimal",value:Kt.gain,onChange:ce=>Lt("gain",ce.target.value),onBlur:()=>Ur("gain"),onKeyDown:ce=>kn(ce,"gain"),className:"w-full text-center text-2xl font-light bg-transparent text-slate-700 dark:text-slate-200 outline-none border-b border-transparent focus:border-cyan-500 transition-colors"})]}),c.jsxs("div",{className:"flex flex-col items-center",children:[c.jsx("label",{className:"text-[10px] text-gray-500 dark:text-slate-400 uppercase tracking-wide mb-1",children:"PRNU (%)"}),c.jsx("input",{type:"text",inputMode:"decimal",value:Kt.prnu,onChange:ce=>Lt("prnu",ce.target.value),onBlur:()=>Ur("prnu"),onKeyDown:ce=>kn(ce,"prnu"),className:"w-full text-center text-2xl font-light bg-transparent text-amber-500 outline-none border-b border-transparent focus:border-amber-500 transition-colors"})]})]})]}),c.jsx("div",{className:"h-px bg-gray-200 dark:bg-slate-700 w-full"}),c.jsxs("div",{className:"grid grid-cols-2 gap-2 text-center",children:[c.jsxs("div",{className:"flex flex-col justify-center bg-cyan-50 dark:bg-cyan-900/10 p-2 rounded-lg border border-cyan-100 dark:border-cyan-900/30",children:[c.jsxs("h4",{className:"text-[10px] font-bold text-cyan-600 dark:text-cyan-500 uppercase tracking-wide mb-1 truncate",title:`Manual DR at SNR=${(_e==null?void 0:_e.manualTarget)||$}`,children:["M.DR @ SNR=",(_e==null?void 0:_e.manualTarget)||$]}),c.jsx("div",{className:"text-base font-bold text-cyan-700 dark:text-cyan-400 whitespace-nowrap",children:_e!=null&&_e.manualDR?`${_e.manualDR.toFixed(2)} EV`:"--"})]}),c.jsxs("div",{className:"flex flex-col justify-center bg-emerald-50 dark:bg-emerald-900/10 p-2 rounded-lg border border-emerald-100 dark:border-emerald-900/30",title:isNaN((_e==null?void 0:_e.ptpTarget)||NaN)?"Requires Image Height":`Standard Point-to-Point DR (Target SNR = 16000/${U||"H"})`,children:[c.jsx("h4",{className:"text-[10px] font-bold text-emerald-600 dark:text-emerald-500 uppercase tracking-wide mb-1",children:"PTP DR"}),c.jsx("div",{className:"text-base font-bold text-emerald-700 dark:text-emerald-400 whitespace-nowrap",children:_e!=null&&_e.ptpDR?`${_e.ptpDR.toFixed(2)} EV`:"--"})]}),c.jsxs("div",{className:"flex flex-col justify-center bg-purple-50 dark:bg-purple-900/10 p-2 rounded-lg border border-purple-100 dark:border-purple-900/30",title:isNaN((_e==null?void 0:_e.ptpTarget)||NaN)?"Requires Image Height":`D55 Saturation DR (Target SNR = 16000/${U||"H"} on ${_e==null?void 0:_e.dominantChannel} Channel)`,children:[c.jsxs("h4",{className:"text-[10px] font-bold text-purple-600 dark:text-purple-400 uppercase tracking-wide mb-1 truncate",children:["D55 DR (",_e==null?void 0:_e.dominantChannel,")"]}),c.jsx("div",{className:"text-base font-bold text-purple-700 dark:text-purple-400 whitespace-nowrap",children:_e!=null&&_e.d55DR?`${_e.d55DR.toFixed(2)} EV`:"--"})]}),c.jsxs("div",{className:"flex flex-col justify-center bg-orange-50 dark:bg-orange-900/10 p-2 rounded-lg border border-orange-100 dark:border-orange-900/30",children:[c.jsx("h4",{className:"text-[10px] font-bold text-orange-600 dark:text-orange-400 uppercase tracking-wide mb-1",children:"FWC"}),c.jsx("div",{className:"text-base font-bold text-orange-600 dark:text-orange-400 font-mono whitespace-nowrap truncate",title:St!==null?`${Math.round(St)}`:"",children:St!==null?St>1e4?`${(St/1e3).toFixed(1)}k`:`${Math.round(St)}`:"--"})]})]}),re===null&&c.jsx("div",{className:"text-center text-[10px] text-red-500 animate-pulse font-bold mt-[-10px]",children:"Please select Linear Limit on chart to calc DR"})]})]}),c.jsxs("div",{className:`flex-1 p-4 bg-white dark:bg-slate-900 relative grid grid-cols-[auto_1fr] grid-rows-[1fr_auto] gap-2 ${ee||fe?"cursor-crosshair":""}`,children:[c.jsx("div",{className:"row-start-1 col-start-1 h-full",children:c.jsx(W4,{vertical:!0,min:Ht,max:At,value:[B?parseFloat(B):Ht,Y?parseFloat(Y):At],onChange:([ce,be])=>{z(ce.toString()),G(be.toString())},logScale:h})}),c.jsxs("div",{className:"row-start-1 col-start-2 relative",children:[vt.length===0?c.jsx("div",{className:"flex h-full items-center justify-center text-gray-400",children:"No valid data points found."}):c.jsx(_o,{width:"100%",height:"100%",children:c.jsxs(uie,{margin:{top:20,right:20,bottom:0,left:0},onClick:We,children:[c.jsx("defs",{children:c.jsxs("filter",{id:"glow",height:"300%",width:"300%",x:"-100%",y:"-100%",children:[c.jsx("feGaussianBlur",{stdDeviation:"2",result:"coloredBlur"}),c.jsxs("feMerge",{children:[c.jsx("feMergeNode",{in:"coloredBlur"}),c.jsx("feMergeNode",{in:"SourceGraphic"})]})]})}),c.jsx(so,{strokeDasharray:"3 3",stroke:"#374151",opacity:.2}),c.jsx(Xa,{type:"number",dataKey:"x",name:"Signal",scale:h?"log":"linear",domain:Br(O,I),allowDataOverflow:!0,hide:!0}),c.jsx(Ka,{type:"number",dataKey:"y",name:d,scale:h?"log":"linear",domain:Br(B,Y),label:{value:Sn,angle:-90,position:"insideLeft",fill:"#9ca3af",fontSize:12},tick:{fill:"#9ca3af",fontSize:10},allowDataOverflow:!0}),c.jsx(ra,{content:c.jsx(mn,{}),cursor:{strokeDasharray:"3 3"}}),re&&c.jsx(Ws,{x:re,stroke:"red",strokeDasharray:"3 3",label:{position:"top",value:"Sat",fill:"red",fontSize:10}}),(jt.fitRange||fe)&&c.jsxs(c.Fragment,{children:[c.jsx(Ws,{x:yr,stroke:"#22d3ee",strokeDasharray:"5 5",label:{position:"insideTopLeft",value:`Min: ${rr.min}%`,fill:"#22d3ee",fontSize:9}}),c.jsx(Ws,{x:Xr,stroke:"#22d3ee",strokeDasharray:"5 5",label:{position:"insideTopLeft",value:`Max: ${rr.max}%`,fill:"#22d3ee",fontSize:9}})]}),S.R&&c.jsx(za,{name:"Red",data:Ce.R,fill:"#ef4444",shape:xr,onClick:We,style:s==="dark"?{filter:"url(#glow)"}:void 0},"scatter-R"),S.G1&&c.jsx(za,{name:"Green 1",data:Ce.G1,fill:"#22c55e",shape:xr,onClick:We,style:s==="dark"?{filter:"url(#glow)"}:void 0},"scatter-G1"),S.G2&&c.jsx(za,{name:"Green 2",data:Ce.G2,fill:"#4ade80",shape:xr,onClick:We,style:s==="dark"?{filter:"url(#glow)"}:void 0},"scatter-G2"),S.B&&c.jsx(za,{name:"Blue",data:Ce.B,fill:"#3b82f6",shape:xr,onClick:We,style:s==="dark"?{filter:"url(#glow)"}:void 0},"scatter-B"),jt.shot&&ut.shot.length>0&&c.jsx(za,{name:"Shot Noise (Ideal)",data:ut.shot,line:{stroke:"#94a3b8",strokeWidth:1,strokeDasharray:"5 5"},shape:()=>c.jsx(c.Fragment,{}),legendType:"none",isAnimationActive:!1},"line-shot"),jt.read&&ut.read.length>0&&c.jsx(za,{name:"Read Noise Floor",data:ut.read,line:{stroke:"#f43f5e",strokeWidth:1,strokeDasharray:"3 3"},shape:()=>c.jsx(c.Fragment,{}),legendType:"none",isAnimationActive:!1},"line-read"),jt.prnu&&ut.prnu.length>0&&c.jsx(za,{name:"PRNU (Non-uniformity)",data:ut.prnu,line:{stroke:"#f59e0b",strokeWidth:1,strokeDasharray:"3 3"},shape:()=>c.jsx(c.Fragment,{}),legendType:"none",isAnimationActive:!1},"line-prnu"),jt.total&&ut.total.length>0&&c.jsx(za,{name:"Total Noise Model",data:ut.total,line:{stroke:Da,strokeWidth:2},shape:()=>c.jsx(c.Fragment,{}),legendType:"none",isAnimationActive:!1},"line-total"),Dt.length>0&&c.jsx(za,{name:`Target SNR=${$}`,data:Dt,line:{stroke:"#6366f1",strokeWidth:2,strokeDasharray:"4 2"},shape:()=>c.jsx(c.Fragment,{}),legendType:"none",isAnimationActive:!1},"line-target"),Or.length>0&&c.jsx(za,{name:`PTP Target SNR=${_e!=null&&_e.ptpTarget?_e.ptpTarget.toFixed(1):"?"}`,data:Or,line:{stroke:"#10b981",strokeWidth:2,strokeDasharray:"4 4"},shape:()=>c.jsx(c.Fragment,{}),legendType:"none",isAnimationActive:!1},"line-ptp"),he.length>0&&c.jsx(za,{name:"Manual Markers",data:he,fill:"#d946ef",shape:"star",legendType:"star"},"manual-points")]})}),c.jsx("div",{className:"absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 pointer-events-none select-none opacity-25 mix-blend-normal dark:mix-blend-plus-lighter",children:c.jsx("svg",{viewBox:"0 0 500 60",className:"w-96 h-auto",children:c.jsx("text",{x:"50%",y:"50%",dominantBaseline:"middle",textAnchor:"middle",className:"fill-gray-900 dark:fill-white",fontSize:"36",fontWeight:"bold",style:{fontFamily:"sans-serif",letterSpacing:"0.05em"},children:" y-g-jiang.github.io"})})})]}),c.jsx("div",{className:"row-start-2 col-start-2 w-full",children:c.jsx(W4,{min:Ke,max:Yt,value:[O?parseFloat(O):Ke,I?parseFloat(I):Yt],onChange:([ce,be])=>{E(ce.toString()),D(be.toString())},logScale:h})})]})]})})},jie=({searchTerm:e,onSearchChange:t,manufacturers:r,selectedManufacturer:n,onManufacturerChange:a,cameras:i,onCameraSelect:o})=>c.jsx("div",{className:"sticky top-4 z-10 bg-white/80 dark:bg-slate-900/80 backdrop-blur-sm p-4 rounded-xl border border-gray-200 dark:border-slate-700 shadow-sm",children:c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-5 gap-4",children:[c.jsxs("div",{className:"relative md:col-span-3",children:[c.jsx("input",{type:"text",placeholder:"Search camera model...",value:e,onChange:s=>t(s.target.value),className:"w-full pl-10 pr-4 py-2 bg-gray-50 dark:bg-slate-800 border border-gray-300 dark:border-slate-600 rounded-lg focus:ring-2 focus:ring-cyan-500 focus:border-cyan-500 outline-none transition-all duration-300 text-gray-900 dark:text-slate-200 placeholder-gray-500 dark:placeholder-slate-400"}),c.jsx("svg",{className:"w-5 h-5 text-gray-400 dark:text-slate-400 absolute top-1/2 left-3 transform -translate-y-1/2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})})]}),c.jsx("select",{value:n,onChange:s=>a(s.target.value),className:"w-full md:col-span-1 bg-gray-50 dark:bg-slate-800 border border-gray-300 dark:border-slate-600 rounded-lg px-4 py-2 focus:ring-2 focus:ring-cyan-500 focus:border-cyan-500 outline-none transition-all duration-300 appearance-none text-gray-900 dark:text-slate-200",children:r.map(s=>c.jsx("option",{value:s,children:s},s))}),c.jsxs("select",{onChange:s=>o(s.target.value),className:"w-full md:col-span-1 bg-gray-50 dark:bg-slate-800 border border-gray-300 dark:border-slate-600 rounded-lg px-4 py-2 focus:ring-2 focus:ring-cyan-500 focus:border-cyan-500 outline-none transition-all duration-300 appearance-none text-gray-900 dark:text-slate-200",value:"","aria-label":"Jump to camera model",children:[c.jsx("option",{value:"",disabled:!0,children:"Jump to model..."}),i.map(s=>c.jsx("option",{value:s.id,children:s.name},s.id))]})]})}),Pie=({active:e,payload:t,label:r,theme:n})=>{if(e&&t&&t.length){const a=t[0].payload,i=n==="dark"?"bg-slate-800/80 border-slate-600 text-slate-300":"bg-white/90 border-gray-200 text-gray-700";return c.jsxs("div",{className:`${i} backdrop-blur-sm border p-3 rounded-lg shadow-lg`,children:[c.jsx("p",{className:"label font-bold",children:`ISO ${r}`}),c.jsx("div",{className:"mt-2 space-y-1 text-sm",children:c.jsxs(c.Fragment,{children:[c.jsxs("div",{style:{color:"#f87171"},children:["Red: ",a.R_avg.toFixed(2)," (Range: ",a.R_range[0]," - ",a.R_range[1],")"]}),c.jsxs("div",{style:{color:"#4ade80"},children:["Green 1: ",a.G1_avg.toFixed(2)," (Range: ",a.G1_range[0]," - ",a.G1_range[1],")"]}),c.jsxs("div",{style:{color:"#60a5fa"},children:["Blue: ",a.B_avg.toFixed(2)," (Range: ",a.B_range[0]," - ",a.B_range[1],")"]}),c.jsxs("div",{style:{color:"#86efac"},children:["Green 2: ",a.G2_avg.toFixed(2)," (Range: ",a.G2_range[0]," - ",a.G2_range[1],")"]})]})})]})}return null},_ie=({data:e,theme:t="dark"})=>{const r=_.useMemo(()=>!e||e.length===0?[]:[...new Set(e.map(o=>o.iso))].sort((o,s)=>Number(o)-Number(s)),[e]),n=_.useMemo(()=>{if(!e||e.length===0)return[0,4096];const o=e.flatMap(b=>[...b.R_range,...b.G1_range,...b.G2_range,...b.B_range]);if(o.length===0)return[0,4096];let s=Math.min(...o),l=Math.max(...o);const u=.25,d=l-s;if(d<u){const b=u-d;s-=b/2,l+=b/2}const f=(l-s)*.1,h=s-f,g=l+f;return[h,g]},[e]),a=t==="dark"?"#475569":"#e5e7eb",i=t==="dark"?"#94a3b8":"#6b7280";return!e||e.length===0?c.jsx("div",{className:"flex items-center justify-center h-full text-gray-500 dark:text-slate-500",children:c.jsx("p",{children:"No data available for this mode."})}):c.jsx(_o,{width:"100%",height:"100%",children:c.jsxs(_O,{data:e,margin:{top:5,right:20,left:0,bottom:5},children:[c.jsx(so,{strokeDasharray:"3 3",stroke:a}),c.jsx(Xa,{dataKey:"iso",type:"number",domain:["dataMin","dataMax"],tick:{fill:i,fontSize:12},scale:"log",allowDuplicatedCategory:!1,ticks:r}),c.jsx(Ka,{tick:{fill:i,fontSize:12},domain:n,allowDecimals:!0,tickFormatter:o=>Number(o).toFixed(3)}),c.jsx(ra,{content:c.jsx(Pie,{theme:t})}),c.jsx(To,{wrapperStyle:{fontSize:"14px",color:i}}),c.jsx($i,{type:"monotone",dataKey:"R_range",fill:"#f87171",stroke:"none",fillOpacity:.2,name:"Red",legendType:"none"}),c.jsx(En,{type:"monotone",dataKey:"R_avg",stroke:"#f87171",strokeWidth:2,dot:!1,activeDot:{r:5},name:"Red"}),c.jsx($i,{type:"monotone",dataKey:"G1_range",fill:"#4ade80",stroke:"none",fillOpacity:.2,name:"Green 1",legendType:"none"}),c.jsx(En,{type:"monotone",dataKey:"G1_avg",stroke:"#4ade80",strokeWidth:2,dot:!1,activeDot:{r:5},name:"Green 1"}),c.jsx($i,{type:"monotone",dataKey:"B_range",fill:"#60a5fa",stroke:"none",fillOpacity:.2,name:"Blue",legendType:"none"}),c.jsx(En,{type:"monotone",dataKey:"B_avg",stroke:"#60a5fa",strokeWidth:2,dot:!1,activeDot:{r:5},name:"Blue"}),c.jsx($i,{type:"monotone",dataKey:"G2_range",fill:"#86efac",stroke:"none",fillOpacity:.2,name:"Green 2",legendType:"none"}),c.jsx(En,{type:"monotone",dataKey:"G2_avg",stroke:"#86efac",strokeWidth:2,dot:!1,activeDot:{r:5},name:"Green 2"})]})})},Cie=oe.forwardRef(({camera:e,theme:t="dark"},r)=>{const n=_.useMemo(()=>e.shootingModes.map(f=>f.modeName),[e.shootingModes]),[a,i]=_.useState(n[0]||""),{chartData:o,tableData:s}=_.useMemo(()=>{const f=e.shootingModes.find(b=>b.modeName===a);if(!(f!=null&&f.data))return{chartData:[],tableData:[]};const h=f.data.map(b=>({iso:b.iso,R_range:b.r.range,R_avg:b.r.avg,G1_range:b.g1.range,G1_avg:b.g1.avg,B_range:b.b.range,B_avg:b.b.avg,G2_range:b.g2.range,G2_avg:b.g2.avg})),g=f.data.map(b=>({iso:b.iso,levels:[b.r.avg,b.g1.avg,b.g2.avg,b.b.avg],clipping:b.clipping}));return{chartData:h,tableData:g}},[e.shootingModes,a]),l=`Raw Data (${a})`,u=_.useRef(null),d=_.useRef(null);return _.useEffect(()=>{const f=u.current,h=d.current;if(!f||!h)return;const g=new ResizeObserver(b=>{for(let w of b){const{width:v}=w.contentRect,m=Math.max(8,v/35);h.style.fontSize=`${m}px`}});return g.observe(f),()=>g.disconnect()},[]),c.jsxs("div",{ref:r,className:"bg-white dark:bg-slate-800/50 border border-gray-200 dark:border-slate-700 rounded-xl shadow-lg p-6 flex flex-col gap-6 transform hover:scale-[1.02] hover:border-cyan-500/50 transition-all duration-500 ease-in-out",children:[c.jsxs("div",{className:"border-b border-gray-200 dark:border-slate-700 pb-4",children:[c.jsx("h2",{className:"text-2xl font-bold text-gray-900 dark:text-slate-100",children:e.name}),c.jsx("p",{className:"text-cyan-600 dark:text-cyan-400",children:e.manufacturer})]}),c.jsxs("div",{children:[c.jsxs("div",{className:"flex flex-col sm:flex-row justify-between sm:items-center gap-4 mb-4",children:[c.jsx("h3",{className:"text-lg font-semibold text-gray-800 dark:text-slate-300",children:"Black Level vs. ISO"}),c.jsx("select",{value:a,onChange:f=>i(f.target.value),className:"w-full sm:w-auto bg-gray-50 dark:bg-slate-700 border border-gray-300 dark:border-slate-600 rounded-md px-3 py-1 text-sm outline-none focus:ring-2 focus:ring-cyan-500 transition-all duration-300 text-gray-900 dark:text-slate-200","aria-label":`Select shooting mode for ${e.name}`,children:n.map(f=>c.jsx("option",{value:f,children:f},f))})]}),c.jsxs("div",{ref:u,className:"h-64 relative",children:[c.jsx(_ie,{data:o,theme:t},a),c.jsx("div",{className:"absolute top-1/2 left-[52%] transform -translate-x-1/2 -translate-y-1/2 -rotate-30 pointer-events-none",children:c.jsx("p",{ref:d,className:"font-bold text-gray-900/10 dark:text-slate-200/40 whitespace-nowrap",children:" y-g-jiang.github.io"})})]})]}),c.jsxs("div",{className:"overflow-x-auto",children:[c.jsx("div",{className:"flex justify-between items-center mb-4",children:c.jsx("h3",{className:"text-lg font-semibold text-gray-800 dark:text-slate-300",children:l})}),c.jsxs("table",{className:"w-full text-left border-collapse",children:[c.jsx("thead",{className:"bg-gray-100 dark:bg-slate-700/50",children:c.jsxs("tr",{children:[c.jsx("th",{className:"p-3 font-semibold text-sm text-gray-700 dark:text-slate-300",children:"ISO"}),c.jsx("th",{className:"p-3 font-semibold text-sm text-red-500 dark:text-red-400",children:"Red"}),c.jsx("th",{className:"p-3 font-semibold text-sm text-green-600 dark:text-green-400",children:"Green 1"}),c.jsx("th",{className:"p-3 font-semibold text-sm text-blue-500 dark:text-blue-400",children:"Blue"}),c.jsx("th",{className:"p-3 font-semibold text-sm text-green-500 dark:text-green-300",children:"Green 2"})]})}),c.jsx("tbody",{children:s.map(({iso:f,levels:h,clipping:g})=>c.jsxs("tr",{className:"border-b border-gray-200 dark:border-slate-700/50 last:border-b-0",children:[c.jsxs("td",{className:"p-3 font-mono text-gray-700 dark:text-slate-300 whitespace-nowrap",children:[f,g&&c.jsx("span",{className:"ml-3 text-xs font-semibold text-amber-600 dark:text-amber-400 bg-amber-100 dark:bg-amber-900/50 px-2 py-1 rounded-full align-middle",children:"Clipping"})]}),c.jsx("td",{className:"p-3 font-mono text-red-500 dark:text-red-400",children:h[0].toFixed(2)}),c.jsx("td",{className:"p-3 font-mono text-green-600 dark:text-green-400",children:h[1].toFixed(2)}),c.jsx("td",{className:"p-3 font-mono text-blue-500 dark:text-blue-400",children:h[3].toFixed(2)}),c.jsx("td",{className:"p-3 font-mono text-green-500 dark:text-green-300",children:h[2].toFixed(2)})]},f))})]})]})]})}),Ze=(e,t,r)=>({avg:e,range:[t,r]}),lx=[{id:"sony-a7r2",name:"Sony ILCE-7RM2 (A7R II)",manufacturer:"Sony",shootingModes:[{modeName:"Still (Mechanical Shutter)",data:[{iso:100,r:Ze(512.1,511.95,512.25),g1:Ze(512.05,511.9,512.2),b:Ze(512.12,511.98,512.28),g2:Ze(512.06,511.92,512.22)},{iso:200,r:Ze(512.15,512,512.3),g1:Ze(512.1,511.95,512.25),b:Ze(512.18,512.05,512.35),g2:Ze(512.12,511.98,512.28)},{iso:400,r:Ze(512.25,512.1,512.45),g1:Ze(512.2,512.05,512.4),b:Ze(512.3,512.15,512.5),g2:Ze(512.22,512.08,512.42)},{iso:800,r:Ze(512.5,512.2,512.8),g1:Ze(512.45,512.15,512.75),b:Ze(512.55,512.25,512.85),g2:Ze(512.48,512.18,512.78)},{iso:1600,r:Ze(513.1,512.8,513.4),g1:Ze(513.05,512.75,513.35),b:Ze(513.15,512.85,513.45),g2:Ze(513.08,512.78,513.38)}]}]},{id:"sony-a7c",name:"Sony ILCE-7C",manufacturer:"Sony",shootingModes:[{modeName:"Still (Mechanical)",data:[{iso:100,r:Ze(512.02,511.98,512.05),g1:Ze(512.01,511.97,512.04),b:Ze(512.03,511.99,512.06),g2:Ze(512.01,511.97,512.04)},{iso:640,r:Ze(512.15,512.05,512.25),g1:Ze(512.12,512.02,512.22),b:Ze(512.18,512.08,512.28),g2:Ze(512.13,512.03,512.23)}]}]},{id:"canon-r5",name:"Canon EOS R5",manufacturer:"Canon",shootingModes:[{modeName:"Mechanical Shutter",data:[{iso:100,r:Ze(512,511.8,512.2),g1:Ze(512,511.8,512.2),b:Ze(512,511.8,512.2),g2:Ze(512,511.8,512.2)},{iso:400,r:Ze(512,511.7,512.3),g1:Ze(512,511.7,512.3),b:Ze(512,511.7,512.3),g2:Ze(512,511.7,512.3)},{iso:1600,r:Ze(512.2,511.5,512.8),g1:Ze(512.2,511.5,512.8),b:Ze(512.2,511.5,512.8),g2:Ze(512.2,511.5,512.8)}]}]},{id:"canon-r6",name:"Canon EOS R6",manufacturer:"Canon",shootingModes:[{modeName:"Mechanical Shutter",data:[{iso:100,r:Ze(511.95,511.8,512.1),g1:Ze(511.95,511.8,512.1),b:Ze(511.95,511.8,512.1),g2:Ze(511.95,511.8,512.1)},{iso:800,r:Ze(512.1,511.9,512.3),g1:Ze(512.1,511.9,512.3),b:Ze(512.1,511.9,512.3),g2:Ze(512.1,511.9,512.3)}]}]},{id:"nikon-z9",name:"Nikon Z9",manufacturer:"Nikon",shootingModes:[{modeName:"Electronic Shutter",data:[{iso:64,r:Ze(400,399.9,400.1),g1:Ze(400,399.9,400.1),b:Ze(400,399.9,400.1),g2:Ze(400,399.9,400.1)},{iso:100,r:Ze(400,399.9,400.1),g1:Ze(400,399.9,400.1),b:Ze(400,399.9,400.1),g2:Ze(400,399.9,400.1)}]}]},{id:"nikon-z6-2",name:"Nikon Z 6II",manufacturer:"Nikon",shootingModes:[{modeName:"Still (Lossless)",data:[{iso:100,r:Ze(400.1,399.8,400.3),g1:Ze(400.1,399.8,400.3),b:Ze(400.1,399.8,400.3),g2:Ze(400.1,399.8,400.3)},{iso:800,r:Ze(400.3,399.5,401.1),g1:Ze(400.3,399.5,401.1),b:Ze(400.3,399.5,401.1),g2:Ze(400.3,399.5,401.1)}]}]},{id:"fujifilm-xt4",name:"Fujifilm X-T4",manufacturer:"Fujifilm",shootingModes:[{modeName:"Still (RAF)",data:[{iso:160,r:Ze(1024,1023.8,1024.2),g1:Ze(1024,1023.8,1024.2),b:Ze(1024,1023.8,1024.2),g2:Ze(1024,1023.8,1024.2)},{iso:800,r:Ze(1024.2,1023.5,1025),g1:Ze(1024.2,1023.5,1025),b:Ze(1024.2,1023.5,1025),g2:Ze(1024.2,1023.5,1025)}]}]}],Mie=({isOpen:e,onClose:t,theme:r})=>{const[n,a]=_.useState(""),[i,o]=_.useState("All"),s=_.useMemo(()=>["All",...Array.from(new Set(lx.map(f=>f.manufacturer))).sort()],[]),l=_.useMemo(()=>lx.filter(d=>{const f=d.name.toLowerCase().includes(n.toLowerCase()),h=i==="All"||d.manufacturer===i;return f&&h}),[n,i]),u=d=>{const f=document.getElementById(`camera-${d}`);f&&f.scrollIntoView({behavior:"smooth"})};return e?c.jsx("div",{className:"fixed inset-0 z-[100] flex items-center justify-center bg-black/60 backdrop-blur-sm p-4 animate-in fade-in duration-200",onClick:t,children:c.jsxs("div",{className:"bg-white dark:bg-slate-900 w-full max-w-6xl h-[90vh] rounded-2xl shadow-2xl flex flex-col border border-gray-200 dark:border-slate-700 overflow-hidden",onClick:d=>d.stopPropagation(),children:[c.jsxs("div",{className:"flex justify-between items-center p-5 border-b border-gray-200 dark:border-slate-700 bg-gray-50 dark:bg-slate-800/50",children:[c.jsxs("h2",{className:"text-xl font-bold text-gray-900 dark:text-slate-100 flex items-center gap-2",children:["Camera Black Level Database",c.jsxs("span",{className:"text-xs font-normal bg-cyan-100 dark:bg-cyan-900/30 text-cyan-600 dark:text-cyan-400 px-2 py-0.5 rounded border border-cyan-200 dark:border-cyan-800",children:[lx.length," Models"]})]}),c.jsx("button",{onClick:t,className:"text-gray-400 hover:text-gray-600 dark:hover:text-slate-200 transition-colors p-2 rounded-full hover:bg-gray-100 dark:hover:bg-slate-800",children:c.jsx("svg",{className:"w-6 h-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),c.jsx("div",{className:"p-4 border-b border-gray-200 dark:border-slate-700 bg-gray-50/50 dark:bg-slate-800/30",children:c.jsx(jie,{searchTerm:n,onSearchChange:a,manufacturers:s,selectedManufacturer:i,onManufacturerChange:o,cameras:l,onCameraSelect:u})}),c.jsx("div",{className:"flex-1 overflow-y-auto p-6 scrollbar-thin scrollbar-thumb-gray-300 dark:scrollbar-thumb-slate-700 bg-gray-100 dark:bg-slate-950",children:c.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 xl:grid-cols-2 gap-6",children:[l.map(d=>c.jsx("div",{id:`camera-${d.id}`,children:c.jsx(Cie,{camera:d,theme:r})},d.id)),l.length===0&&c.jsx("div",{className:"col-span-full flex flex-col items-center justify-center py-20 text-gray-400 dark:text-slate-600",children:c.jsx("p",{className:"text-lg",children:"No cameras found matching your criteria."})})]})})]})}):null},Nie=({isOpen:e,onClose:t,zIndex:r=150})=>{const[n,a]=_.useState(""),[i,o]=_.useState(""),[s,l]=_.useState(""),[u,d]=_.useState(""),[f,h]=_.useState(null),g=()=>{const b=parseFloat(n),w=parseFloat(i),v=parseFloat(s),x=parseFloat(u);if(isNaN(b)||isNaN(w)||isNaN(v)||isNaN(x)){h(null);return}const m=b,k=w,P=v*v,j=x*x,S=(m+k)/2;if(S<=1e-9){h(0);return}const M=P*j/S,O=Math.sqrt(M);h(O)};return e?c.jsxs(ml,{initialPosition:{x:window.innerWidth/2-160,y:window.innerHeight/2-200},onClose:t,zIndex:r,className:"w-80 bg-white dark:bg-slate-900 border border-gray-200 dark:border-slate-700 flex flex-col shadow-2xl",children:[c.jsxs("div",{className:"flex justify-between items-center px-4 py-3 border-b border-gray-200 dark:border-slate-700 bg-gray-50 dark:bg-slate-800",children:[c.jsx("h3",{className:"text-sm font-bold text-gray-700 dark:text-slate-200",children:"Cross-Compensation Calc"}),c.jsx("button",{onClick:t,className:"text-gray-400 hover:text-red-500 transition-colors",children:c.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),c.jsxs("div",{className:"p-4 flex flex-col gap-3 text-xs",children:[c.jsxs("div",{className:"flex flex-col gap-1",children:[c.jsx("label",{className:"text-gray-500 dark:text-slate-400 font-bold",children:"H Mean (Power/Var)"}),c.jsx("input",{type:"number",step:"any",value:n,onChange:b=>a(b.target.value),className:"p-2 rounded bg-gray-100 dark:bg-slate-800 border border-gray-300 dark:border-slate-600 outline-none focus:border-indigo-500 text-gray-900 dark:text-slate-100 font-mono"})]}),c.jsxs("div",{className:"flex flex-col gap-1",children:[c.jsx("label",{className:"text-gray-500 dark:text-slate-400 font-bold",children:"V Mean (Power/Var)"}),c.jsx("input",{type:"number",step:"any",value:i,onChange:b=>o(b.target.value),className:"p-2 rounded bg-gray-100 dark:bg-slate-800 border border-gray-300 dark:border-slate-600 outline-none focus:border-indigo-500 text-gray-900 dark:text-slate-100 font-mono"})]}),c.jsxs("div",{className:"flex flex-col gap-1",children:[c.jsx("label",{className:"text-gray-500 dark:text-slate-400 font-bold",children:"H RMS 0 (Sigma)"}),c.jsx("input",{type:"number",step:"any",value:s,onChange:b=>l(b.target.value),className:"p-2 rounded bg-gray-100 dark:bg-slate-800 border border-gray-300 dark:border-slate-600 outline-none focus:border-indigo-500 text-gray-900 dark:text-slate-100 font-mono"})]}),c.jsxs("div",{className:"flex flex-col gap-1",children:[c.jsx("label",{className:"text-gray-500 dark:text-slate-400 font-bold",children:"V RMS 0 (Sigma)"}),c.jsx("input",{type:"number",step:"any",value:u,onChange:b=>d(b.target.value),className:"p-2 rounded bg-gray-100 dark:bg-slate-800 border border-gray-300 dark:border-slate-600 outline-none focus:border-indigo-500 text-gray-900 dark:text-slate-100 font-mono"})]}),c.jsx("button",{onClick:g,className:"mt-2 w-full py-2 bg-indigo-600 hover:bg-indigo-500 text-white font-bold rounded shadow transition-colors active:scale-95",children:"Calculate Sigma"}),f!==null&&c.jsxs("div",{className:"mt-2 p-3 bg-indigo-50 dark:bg-indigo-900/30 border border-indigo-200 dark:border-indigo-800 rounded text-center animate-in fade-in slide-in-from-top-1",children:[c.jsx("span",{className:"block text-[10px] uppercase font-bold text-gray-500 dark:text-slate-400 mb-1",children:"Original White Noise Sigma"}),c.jsx("span",{className:"text-lg font-mono font-bold text-indigo-700 dark:text-indigo-300 select-all",children:f.toFixed(5)})]})]})]}):null},z1=[[.1725,.0838,.0576],[.5481,.2985,.217],[.1103,.1968,.3359],[.1038,.1502,.0521],[.2244,.2177,.4302],[.1232,.519,.4044],[.7168,.199,.0271],[.065,.1063,.3924],[.5417,.0884,.1203],[.1042,.0438,.1396],[.3547,.5078,.0482],[.7805,.3541,.0215],[.0234,.0492,.2916],[.0653,.3019,.0645],[.4294,.0319,.0402],[.8568,.5754,.0079],[.5032,.0889,.3055],[0,.249,.383],[.9163,.9155,.8705],[.5819,.5911,.5839],[.3552,.361,.359],[.1876,.1924,.1917],[.0871,.0901,.0908],[.0321,.0319,.0326]],Oie=[[3.2404542,-1.5371385,-.4985314],[-.969266,1.8760108,.041556],[.0556434,-.2040259,1.0572252]];function Aie(e,t,r,n,a,i,o=.5){const u=[],d=Math.max(.1,Math.min(.9,o)),f=Math.hypot(t.x-e.x,t.y-e.y),h=Math.hypot(n.x-r.x,n.y-r.y),g=Math.hypot(r.x-e.x,r.y-e.y),b=Math.hypot(n.x-t.x,n.y-t.y),w=(f+h)/2/5,v=(g+b)/2/3,x=w*d,m=v*d;for(let k=0;k<4;k++)for(let P=0;P<6;P++){const j=P/5,S=k/3,M=(1-j)*(1-S)*e.x+j*(1-S)*t.x+(1-j)*S*r.x+j*S*n.x,O=(1-j)*(1-S)*e.y+j*(1-S)*t.y+(1-j)*S*r.y+j*S*n.y;u.push({x:M-x/2,y:O-m/2,w:x,h:m})}return u}function CO(e){e.length;const t=e[0].length;return Array(t).fill(0).map((r,n)=>e.map(a=>a[n]))}function Uh(e,t){const r=e.length,n=e[0].length,a=t.length,i=t[0].length;if(n!==a)throw new Error("Matrix dimensions mismatch");const o=Array(r).fill(0).map(()=>Array(i).fill(0));for(let s=0;s<r;s++)for(let l=0;l<i;l++)for(let u=0;u<n;u++)o[s][l]+=e[s][u]*t[u][l];return o}function Tie(e,t){const r=CO(e),n=Uh(r,e);for(let u=0;u<3;u++)n[u][u]+=1e-9;const a=[[n[0][0],n[0][1],n[0][2]],[n[1][0],n[1][1],n[1][2]],[n[2][0],n[2][1],n[2][2]]],i=tc(a);if(!i)throw new Error("Singular Matrix (Check Input Data)");const o=[[i[0][0],i[0][1],i[0][2]],[i[1][0],i[1][1],i[1][2]],[i[2][0],i[2][1],i[2][2]]],s=Uh(r,t);return Uh(o,s)}function Eie(e){const t=e.length,r=e.map((n,a)=>[...n,...Array(t).fill(0).map((i,o)=>a===o?1:0)]);for(let n=0;n<t;n++){let a=n;for(let s=n+1;s<t;s++)Math.abs(r[s][n])>Math.abs(r[a][n])&&(a=s);const i=r[n];r[n]=r[a],r[a]=i;const o=r[n][n];if(Math.abs(o)<1e-12)throw new Error("Singular Matrix");for(let s=n;s<2*t;s++)r[n][s]/=o;for(let s=0;s<t;s++)if(s!==n){const l=r[s][n];for(let u=n;u<2*t;u++)r[s][u]-=l*r[n][u]}}return r.map(n=>n.slice(t))}function Iie(e,t,r){const n=[...e].sort((w,v)=>w.id-v.id);if(n.length!==24)throw new Error("Requires exactly 24 patches");const a=[];n.forEach(w=>{const v=w.rawMeans,x=[v[0]-t[0],v[1]-t[1],v[2]-t[2],v[3]-t[3]];let m,k,P;r?(P=x[0],k=(x[1]+x[2])/2,m=x[3]):(m=x[0],k=(x[1]+x[2])/2,P=x[3]),m=Math.max(0,m),k=Math.max(0,k),P=Math.max(0,P),a.push([m,k,P])});const o=a[18],s=(o[0]+o[1]+o[2])/3,l=1/Math.max(1e-9,s),u=a.map(w=>[w[0]*l,w[1]*l,w[2]*l]),f=Tie(u,z1),h=CO(f);let g;try{g=Eie(h)}catch{throw new Error("CCM Inversion Failed. Input data might be too dark or clipped.")}return{matrix:Uh(g,Oie)}}const $ie=({isOpen:e,onClose:t,patchStats:r,initialIsBGGR:n,zIndex:a=200,sizeRatio:i,onSizeChange:o})=>{const[s,l]=_.useState(n),[u,d]=_.useState(["0","0","0","0"]),[f,h]=_.useState(null),[g,b]=_.useState(null);if(_.useEffect(()=>{if(e&&r&&r.length===24){const S=r[23].rawMeans;u[0]==="0"&&u[1]==="0"&&d([S[0].toFixed(2),S[1].toFixed(2),S[2].toFixed(2),S[3].toFixed(2)])}},[e,r]),_.useEffect(()=>{if(!e||!r||r.length!==24)return;const j=u.map(S=>parseFloat(S));if(!j.some(isNaN))try{const S=Iie(r,j,s);h(S),b(null)}catch(S){b(S.message)}},[e,r,s,u]),!e)return null;const w=(j,S)=>{d(M=>{const O=[...M];return O[j]=S,O})},v=j=>{navigator.clipboard.writeText(j)},x=j=>j?j.map(S=>S.map(M=>M.toFixed(4))):[],m=f?x(f.matrix).flat().join(" "):"",k=s?["B","G1","G2","R"]:["R","G1","G2","B"],P=s?["text-blue-500","text-green-500","text-green-500","text-red-500"]:["text-red-500","text-green-500","text-green-500","text-blue-500"];return c.jsxs(ml,{initialPosition:{x:window.innerWidth/2-200,y:100},onClose:t,zIndex:a,className:"w-[500px] bg-white dark:bg-slate-900 border border-gray-200 dark:border-slate-700 flex flex-col shadow-2xl rounded-xl overflow-hidden",children:[c.jsxs("div",{className:"flex justify-between items-center px-4 py-3 border-b border-gray-200 dark:border-slate-700 bg-gray-50 dark:bg-slate-800",children:[c.jsxs("h3",{className:"text-sm font-bold text-gray-800 dark:text-slate-100 flex items-center gap-2",children:[c.jsx("span",{className:"w-2 h-2 rounded-full bg-yellow-500"}),"Color Lab Result"]}),c.jsx("button",{onClick:t,className:"text-gray-400 hover:text-red-500 transition-colors",children:c.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),c.jsxs("div",{className:"p-5 flex flex-col gap-5",children:[c.jsxs("div",{className:"bg-gray-100 dark:bg-slate-800 p-3 rounded-lg border border-gray-200 dark:border-slate-700",children:[c.jsxs("div",{className:"flex justify-between items-center mb-1",children:[c.jsx("span",{className:"text-[10px] font-bold text-gray-500 dark:text-slate-400 uppercase",children:"Patch Sampling Size"}),c.jsxs("span",{className:"text-xs font-mono font-bold text-cyan-600 dark:text-cyan-400",children:[Math.round(i*100),"%"]})]}),c.jsx("input",{type:"range",min:"0.1",max:"0.9",step:"0.05",value:i,onChange:j=>o(parseFloat(j.target.value)),className:"w-full h-1.5 bg-gray-300 dark:bg-slate-600 rounded-lg appearance-none cursor-pointer accent-cyan-500"})]}),c.jsx("div",{className:"flex justify-center",children:c.jsxs("div",{className:"flex bg-gray-100 dark:bg-slate-800 p-1 rounded-lg border border-gray-200 dark:border-slate-700",children:[c.jsx("button",{onClick:()=>l(!1),className:`px-4 py-1.5 text-xs font-bold rounded transition-all ${s?"text-gray-500 dark:text-slate-400 hover:text-gray-700":"bg-white dark:bg-slate-600 text-indigo-600 dark:text-indigo-300 shadow-sm"}`,children:"RGGB Mode"}),c.jsx("button",{onClick:()=>l(!0),className:`px-4 py-1.5 text-xs font-bold rounded transition-all ${s?"bg-white dark:bg-slate-600 text-indigo-600 dark:text-indigo-300 shadow-sm":"text-gray-500 dark:text-slate-400 hover:text-gray-700"}`,children:"BGGR Mode"})]})}),c.jsxs("div",{className:"bg-gray-50 dark:bg-slate-800/50 p-3 rounded-lg border border-gray-100 dark:border-slate-700",children:[c.jsx("h4",{className:"text-[10px] font-bold text-gray-400 dark:text-slate-500 uppercase mb-2",children:"Input Black Levels ()"}),c.jsx("div",{className:"grid grid-cols-4 gap-2",children:[0,1,2,3].map(j=>c.jsxs("div",{className:"flex flex-col",children:[c.jsx("label",{className:`text-[10px] font-bold mb-1 ${P[j]}`,children:k[j]}),c.jsx("input",{type:"number",step:"0.01",value:u[j],onChange:S=>w(j,S.target.value),className:"w-full px-2 py-1 text-sm font-mono border border-gray-300 dark:border-slate-600 rounded bg-white dark:bg-slate-900 text-gray-900 dark:text-slate-100 outline-none focus:ring-1 focus:ring-yellow-500"})]},j))})]}),g?c.jsx("div",{className:"text-red-500 text-sm text-center bg-red-50 dark:bg-red-900/20 p-2 rounded",children:g}):f?c.jsx(c.Fragment,{children:c.jsxs("div",{className:"bg-gray-50 dark:bg-slate-800/50 p-3 rounded-lg border border-gray-100 dark:border-slate-700",children:[c.jsx("h4",{className:"text-[10px] font-bold text-gray-400 dark:text-slate-500 uppercase mb-2",children:"Calculated Color Matrix (XYZ  Camera RGB)"}),c.jsx("div",{className:"font-mono text-xs text-gray-700 dark:text-slate-300 grid grid-rows-3 gap-1 mb-3",children:x(f.matrix).map((j,S)=>c.jsxs("div",{className:"flex justify-between bg-white dark:bg-slate-900 px-2 py-1 rounded",children:[c.jsx("span",{className:"text-red-500/80 w-1/3 text-right",children:j[0]}),c.jsx("span",{className:"text-green-500/80 w-1/3 text-right",children:j[1]}),c.jsx("span",{className:"text-blue-500/80 w-1/3 text-right",children:j[2]})]},S))}),c.jsx("button",{onClick:()=>v(m),className:"w-full py-1.5 bg-indigo-600 hover:bg-indigo-500 text-white text-xs font-bold rounded shadow transition-transform active:scale-95 flex items-center justify-center gap-2",children:"Copy Matrix String (for customMatrix)"})]})}):c.jsx("div",{className:"text-gray-400 text-sm text-center",children:"Calculating..."})]})]})};function ow(e,t){const r=e.length;let n=0,a=0,i=0,o=0;for(let l=0;l<r;l++)n+=e[l],a+=t[l],i+=e[l]*t[l],o+=e[l]*e[l];const s=r*o-n*n;return s===0?{slope:0,intercept:0}:{slope:(r*i-n*a)/s,intercept:(a*o-n*i)/s}}function Die(e,t){const r=e.length,n=new Array(r).fill(0),a=2*t;for(let i=0;i<r;i++){const o=i>0?e[i-1]:e[0],s=i<r-1?e[i+1]:e[r-1];n[i]=(s-o)/a}return n}function Rie(e){const t=new Array(e.length).fill(0);t[0]=e[0];for(let r=1;r<e.length;r++){let n=e[r]-e[r-1];n>Math.PI?n-=2*Math.PI:n<-Math.PI&&(n+=2*Math.PI),t[r]=t[r-1]+n}return t}function Bie(e){const t=e.length,r=new Array(t).fill(0).map((i,o)=>o),{slope:n,intercept:a}=ow(r,e);return e.map((i,o)=>i-(n*o+a))}function Lie(e,t,r="RGGB"){const n=r.toUpperCase(),a=t%2,i=e%2;return n==="RGGB"||n==="BGGR"?(a+i)%2!==0:n==="GBRG"||n==="GRBG"?(a+i)%2===0:(a+i)%2!==0}function W1(e,t,r,n,a){const i=Math.floor(n.x),o=Math.floor(n.y),s=Math.floor(n.w),l=Math.floor(n.h);if(s<8||l<8)return null;let u=[];for(let le=0;le<l;le++){const de=[],Se=(o+le)*t;for(let he=0;he<s;he++)de.push(e[Se+i+he]);u.push(de)}let d=0,f=0;for(let le=1;le<l-1;le+=2)for(let de=1;de<s-1;de+=2)d+=Math.abs(u[le][de+1]-u[le][de-1]),f+=Math.abs(u[le+1][de]-u[le-1][de]);let h=s,g=l,b=u,w=2,v=!1;if(f>d){w=1,v=!0,b=Array(s).fill(0).map(()=>Array(l).fill(0));for(let le=0;le<l;le++)for(let de=0;de<s;de++)b[de][l-1-le]=u[le][de];h=l,g=s}else w=2;const x=[],m=[];for(let le=0;le<g;le++){const de=b[le],Se=de.map((ve,ye)=>ye===0?0:Math.abs(ve-de[ye-1])),he=Math.max(...Se),Pe=Se.indexOf(he);if(he>1){const ve=Math.max(0,Pe-3),ye=Math.min(h,Pe+4);let ge=0,ue=0;for(let Le=ve;Le<ye;Le++)ge+=Se[Le],ue+=Le*Se[Le];ge>0&&(x.push(ue/ge),m.push(le))}}if(x.length<g*.4)return null;const{slope:k,intercept:P}=ow(m,x),j=Math.cos(Math.atan(k)),S=[],M=[],O=(a==null?void 0:a.greenOnly)??!1,E=(a==null?void 0:a.globalX)??0,I=(a==null?void 0:a.globalY)??0,D=(a==null?void 0:a.bayerPattern)||"RGGB";for(let le=0;le<g;le++){const de=k*le+P;for(let Se=0;Se<h;Se++){if(O){let he,Pe;if(v){const ve=l-1-Se,ye=le;he=E+i+ye,Pe=I+o+ve}else he=E+i+Se,Pe=I+o+le;if(!Lie(he,Pe,D))continue}S.push((Se-de)*j),M.push(b[le][Se])}}const z=Math.min(s,l)/2;let Y=0;for(const le of S)Math.abs(le)<=z&&Y++;let G=.125;if(a!=null&&a.manualBinSize&&a.manualBinSize>0)G=Math.max(.01,Math.min(.5,a.manualBinSize));else if(Y>0){const le=40*z/Y;G=Math.max(.01,Math.min(.125,le))}const $=G,L=Array.from(S.keys()).sort((le,de)=>S[le]-S[de]),U=L.map(le=>S[le]),V=L.map(le=>M[le]);if(U.length===0)return null;const J=U[0],K=U[U.length-1],Q=Math.floor((K-J)/$),te=new Array(Q).fill(0),ee=new Array(Q).fill(0);for(let le=0;le<U.length;le++){const de=Math.floor((U[le]-J)/$);de>=0&&de<Q&&(te[de]+=V[le],ee[de]++)}let me=V[0];for(let le=0;le<Q;le++)ee[le]>0?(te[le]/=ee[le],me=te[le]):te[le]=me;const re=te.slice(0,10).reduce((le,de)=>le+de,0)/10,De=te.slice(-10).reduce((le,de)=>le+de,0)/10;if(re>De){const le=Math.max(...te),de=Math.min(...te);for(let Se=0;Se<te.length;Se++)te[Se]=le-te[Se]+de}const fe=Die(te,$);return{esf:te,lsfFull:fe,binSize:$,orientation:w}}function MO(e,t,r,n=!1,a=0,i=!1){if(e.length===0)return null;const o=4096,s=new rc(o),l=r?1e3/r:1,u=new Float32Array(501);for(let m=0;m<=500;m++)u[m]=m/500*l*2;const d=new Float32Array(501).fill(0);let f=0,h=[],g=[],b=0,w=[];for(const m of e){let k=[...m.lsfFull];const P=m.binSize;let j=0,S=-1/0;for(let ee=0;ee<k.length;ee++)k[ee]>S&&(S=k[ee],j=ee);const M=S*.2;let O=0,E=k.length-1;for(let ee=j;ee>=0;ee--)if(k[ee]<M){O=ee;break}for(let ee=j;ee<k.length;ee++)if(k[ee]<M){E=ee;break}const I=E-O;let D=!1;if(n&&I>0){const ee=I*4,me=[],re=[];if(a>0){const De=Math.max(0,j-ee-a),fe=Math.max(0,j-ee);for(let Se=De;Se<fe;Se++)me.push(Se),re.push(k[Se]);const le=Math.min(k.length,j+ee),de=Math.min(k.length,j+ee+a);for(let Se=le;Se<de;Se++)me.push(Se),re.push(k[Se])}else{for(let De=0;De<Math.max(0,j-ee);De++)me.push(De),re.push(k[De]);for(let De=Math.min(k.length,j+ee);De<k.length;De++)me.push(De),re.push(k[De])}if(me.length>2){const{slope:De,intercept:fe}=ow(me,re);for(let le=0;le<k.length;le++)k[le]=k[le]-(De*le+fe);S=-1/0;for(let le=0;le<k.length;le++)k[le]>S&&(S=k[le],j=le);D=!0}}let B=0,z=0;if(t>0)z=t,B=Math.round(t/P);else{const ee=S*.2;let me=0,re=k.length-1;for(let de=j;de>=0;de--)if(k[de]<ee){me=de;break}for(let de=j;de<k.length;de++)if(k[de]<ee){re=de;break}const fe=(re-me)*P;let le=Math.max(2,fe*8);z=le,B=Math.round(le/P)}b+=z;const Y=Math.max(0,j-B),G=Math.min(k.length,j+B),$=k.slice(Y,G);if($.length<8)continue;const L=new Float32Array(o).fill(0);let U=-1/0,V=0;for(let ee=0;ee<$.length;ee++)$[ee]>U&&(U=$[ee],V=ee);for(let ee=0;ee<$.length;ee++){let me=1;i&&(me=.5*(1-Math.cos(2*Math.PI*ee/($.length-1))));const re=$[ee]*me,De=(ee-V+o)%o;L[De]=re}s.transform(L);const J=[],K=[],Q=[];for(let ee=0;ee<=o/2;ee++){const me=s._real[ee],re=s._imag[ee],De=Math.sqrt(me*me+re*re);J.push(De),K.push(ee/(o*P)*l),Q.push(Math.atan2(re,me))}const te=J[0];if(te>0){for(let ee=0;ee<=500;ee++){const me=u[ee];d[ee]+=H4(me,K,J)/te}if(f++,h.length===0){h=$,g=D?Fie(k):m.esf;const ee=Rie(Q),me=Bie(ee);for(let re=0;re<=500;re++){const De=u[re];w.push(H4(De,K,me))}}}}if(f===0)return null;const v=Array.from(d).map(m=>m/f);let x=null;for(let m=0;m<v.length-1;m++)if(v[m]>=.5&&v[m+1]<.5){x=u[m]+(.5-v[m])*(u[m+1]-u[m])/(v[m+1]-v[m]);break}return{esf:g,lsf:[],lsfCropped:h,mtf:v,ptf:w,freqs:Array.from(u),mtf50:x,calcRadius:b/f}}function Fie(e){const t=new Array(e.length).fill(0);let r=0;for(let n=0;n<e.length;n++)r+=e[n],t[n]=r;return t}function H4(e,t,r){if(e<=t[0])return r[0];if(e>=t[t.length-1])return r[r.length-1];let n=0;for(;e>t[n+1];)n++;const a=(e-t[n])/(t[n+1]-t[n]);return r[n]+a*(r[n+1]-r[n])}const _s=({locked:e,onToggle:t,title:r})=>c.jsx("span",{className:"inline-flex items-center justify-center p-1 rounded hover:bg-gray-200 dark:hover:bg-slate-700 transition-colors cursor-pointer select-none",title:r??(e?"Locked (Auto Fit will NOT change)":"Unlocked (Auto Fit may change)"),onMouseDown:n=>{n.stopPropagation()},onClick:n=>{n.stopPropagation(),t()},children:c.jsx("span",{className:`w-4 h-4 rounded-full border-2 transition-all active:scale-90 flex items-center justify-center ${e?"border-indigo-600 bg-indigo-600":"border-gray-400 dark:border-slate-500 bg-transparent hover:border-gray-500"}`,children:e&&c.jsx("span",{className:"w-2 h-2 rounded-full bg-white"})})}),Gie=({isOpen:e,onClose:t,rawImageData:r,roi:n,zIndex:a=110,onFocus:i,displaySettings:o,isSfrLabOpen:s})=>{const[l,u]=_.useState([]),[d,f]=_.useState(""),[h,g]=_.useState(""),[b,w]=_.useState(12),[v,x]=_.useState(!0),[m,k]=_.useState(!0),[P,j]=_.useState(!0),[S,M]=_.useState(!1),[O,E]=_.useState(!1),[I,D]=_.useState(!1),[B,z]=_.useState(!1),[Y,G]=_.useState("50"),[$,L]=_.useState(!1),[U,V]=_.useState("0.125"),[J,K]=_.useState(!1),[Q,te]=_.useState({aperture:4,olpfSeparationPx:.7,fillFactor:.9,coreSigmaPx:.15,haloSigmaPx:.8,haloWeight:.25,wavelengthUm:.55,rolloff:1}),[ee,me]=_.useState({aperture:!1,olpfSeparationPx:!1,fillFactor:!1,coreSigmaPx:!1,haloSigmaPx:!1,haloWeight:!1,wavelengthUm:!1,rolloff:!1}),[re,De]=_.useState("0"),[fe,le]=_.useState(""),[de,Se]=_.useState(!1),[he,Pe]=_.useState(""),[ve,ye]=_.useState(1),[ge,ue]=_.useState(null),[Le,rt]=_.useState({x:100,y:50}),[et,tt]=_.useState({w:1e3,h:800}),[ft,wt]=_.useState(!1),[fr,Wt]=_.useState(!1),kt=_.useRef({x:0,y:0}),Bt=_.useRef({w:0,h:0}),[Sr,Gr]=_.useState(!1),[rr,Nr]=_.useState(!1),nt=l.length>0?l[l.length-1].binSize:null,Ot=nt?(1/nt).toFixed(1):"-",pr=_.useMemo(()=>n?Math.max(n.w,n.h):100,[n]),jr=(o==null?void 0:o.renderMode)==="advanced-zero-dep",Rr=_.useMemo(()=>{const F=parseFloat(d);return Number.isFinite(F)&&F>0?F:null},[d]),Pr=Rr!==null,Kt=Pr?"lp/mm":"cy/px",Er=(F,Ce,Ee)=>Math.min(Ee,Math.max(Ce,F)),jt=F=>{if(Math.abs(F)<1e-12)return 1;const Ce=Math.PI*F;return Math.sin(Ce)/Ce},Me=F=>F<=0?1:F>=1?0:2/Math.PI*(Math.acos(F)-F*Math.sqrt(1-F*F)),X=(F,Ce,Ee,_t)=>{const He=Er(_t,0,1),dt=Math.max(0,Ce),qe=Math.max(0,Ee),Lt=Math.exp(-2*Math.PI*Math.PI*dt*dt*F*F),Ur=Math.exp(-2*Math.PI*Math.PI*qe*qe*F*F);return(1-He)*Lt+He*Ur},Te=_.useMemo(()=>Pr&&Rr?1e3/Rr:1,[Pr,Rr]),xe=(F,Ce)=>{const{aperture:Ee,olpfSeparationPx:_t,fillFactor:He,coreSigmaPx:dt,haloSigmaPx:qe,haloWeight:Lt,wavelengthUm:Ur,rolloff:Kr}=Ce,lr=Pr?F/Te:F,kn=Math.max(1e-9,Ur)/1e3,Yr=Pr&&Rr?Rr/1e3:5/1e3,Ar=Math.max(1e-6,Ee),Ft=1/(kn*Ar)*Yr,Br=Ft>0?lr/Ft:1e9,We=Me(Br),xr=Math.max(0,_t),mn=Math.abs(Math.cos(Math.PI*lr*xr)),sa=Er(He,0,1),Da=Math.abs(jt(lr*sa)),Sn=Math.max(0,dt),Ja=Math.max(0,qe),ce=X(lr,Sn,Ja,Lt);let be=We*mn*Da*ce;const ke=Math.max(.1,Kr);return be=Math.pow(Math.max(0,be),ke),Math.min(1.2,Math.max(0,be))},ze=()=>{if(!(!r||!n)){if(!jr){alert("Scalar Unmixing is required. Please configure Background/Foreground/BlackLevel in the Sidebar and click 'RUN UNMIXING' first.");return}try{let F=null;const Ce=$?parseFloat(U):void 0;if(o!=null&&o.advancedZeroDep){const Ee=Jb(r,n,o);F=W1(Ee.data,Ee.width,Ee.height,{x:0,y:0,w:Ee.width,h:Ee.height},{greenOnly:P,globalX:n.x,globalY:n.y,bayerPattern:r.bayerPattern,manualBinSize:Ce})}else F=W1(r.data,r.width,r.height,n,{greenOnly:P,globalX:n.x,globalY:n.y,bayerPattern:r.bayerPattern,manualBinSize:Ce});F?u(Ee=>[...Ee,F]):alert("Could not detect valid edge.")}catch(F){console.error(F),alert("Error processing ROI")}}},Je=()=>{u([]),ue(null),ye(1)},ot=()=>{if(!ge)return;const F=parseFloat(d),_t=`data:text/csv;charset=utf-8,Frequency (${!isNaN(F)&&F>0?"lp/mm":"cy/px"}),MTF,Phase(Rad)
`+ge.freqs.map((qe,Lt)=>{const Ur=ge.ptf?ge.ptf[Lt]:0;return`${qe.toFixed(6)},${ge.mtf[Lt].toFixed(6)},${Ur?Ur.toFixed(6):0}`}).join(`
`),He=encodeURI(_t),dt=document.createElement("a");dt.setAttribute("href",He),dt.setAttribute("download",`sfr_data_${Date.now()}.csv`),document.body.appendChild(dt),dt.click(),document.body.removeChild(dt)},Pt=()=>{if(!(ge!=null&&ge.mtf50)||!n)return;const F=n.x+n.w/2,Ce=n.y+n.h/2,Ee=`{${F.toFixed(1)},${Ce.toFixed(1)},${ge.mtf50.toFixed(4)}}`;navigator.clipboard.writeText(Ee)};_.useEffect(()=>{if(l.length===0){ue(null);return}const F=parseFloat(d),Ce=!isNaN(F)&&F>0?F:null,Ee=v?-1:b,_t=B&&parseFloat(Y)||0,He=MO(l,Ee,Ce,m,_t,S);ue(He)},[l,b,v,m,d,B,Y,S]),_.useEffect(()=>{e&&jr&&l.length===0&&n&&r&&ze()},[e]);const Qe=F=>{i&&i(),!rr&&(F.target.closest("button")||F.target.closest("input")||F.target.closest("select")||F.target.closest("label")||(wt(!0),kt.current={x:F.clientX-Le.x,y:F.clientY-Le.y}))},_r=F=>{rr||(F.stopPropagation(),F.preventDefault(),Wt(!0),kt.current={x:F.clientX,y:F.clientY},Bt.current={w:et.w,h:et.h})};_.useEffect(()=>{const F=Ee=>{if(ft)rt({x:Ee.clientX-kt.current.x,y:Ee.clientY-kt.current.y});else if(fr){const _t=Ee.clientX-kt.current.x,He=Ee.clientX-kt.current.y;tt({w:Math.max(600,Bt.current.w+_t),h:Math.max(500,Bt.current.h+He)})}},Ce=()=>{wt(!1),Wt(!1)};return(ft||fr)&&(window.addEventListener("mousemove",F),window.addEventListener("mouseup",Ce)),()=>{window.removeEventListener("mousemove",F),window.removeEventListener("mouseup",Ce)}},[ft,fr]);const sr=_.useMemo(()=>{if(!(ge!=null&&ge.mtf50)||!h)return null;const F=parseFloat(h);if(isNaN(F)||F<=0)return null;let Ce=ge.mtf50;const Ee=parseFloat(d);return!isNaN(Ee)&&Ee>0&&(Ce=ge.mtf50*(Ee/1e3)),Ce*2*F},[ge,h,d]),Jt=O?2:1,vt=Jt*Te,nr=.004,A=_.useMemo(()=>{if(!J)return[];const F=[];for(let Ce=0;Ce<=Jt+1e-12;Ce+=nr){const Ee=Ce*Te;F.push({freq:Ee,modelMtf:xe(Ee,Q)})}return F},[J,Q,Jt,Te]),Ge=_.useMemo(()=>{const F=ge?ge.mtf.map((Ee,_t)=>({freq:ge.freqs[_t],mtf:Ee})).filter(Ee=>Ee.freq<=vt):[];if(!J||A.length===0)return F.map(Ee=>({freq:Ee.freq,mtf:Ee.mtf,modelMtf:null}));const Ce=new Map;for(const Ee of A){const _t=Ee.freq.toFixed(6);Ce.set(_t,{freq:Ee.freq,mtf:null,modelMtf:Ee.modelMtf})}for(const Ee of F){const _t=Ee.freq.toFixed(6),He=Ce.get(_t);He?He.mtf=Ee.mtf:Ce.set(_t,{freq:Ee.freq,mtf:Ee.mtf,modelMtf:null})}return Array.from(Ce.values()).sort((Ee,_t)=>Ee.freq-_t.freq)},[ge,vt,J,A]),Ke=ge?ge.lsfCropped.map((F,Ce)=>({x:Ce,y:F})):[],Yt=ge?ge.esf.map((F,Ce)=>({x:Ce,y:F})):[],Ht=_.useMemo(()=>ge!=null&&ge.ptf?ge.ptf.map((F,Ce)=>({freq:ge.freqs[Ce],ptf:F})).filter(F=>F.freq<=vt):[],[ge,vt]);if(!e)return null;const At={aperture:[.7,64],olpfSeparationPx:[0,5],fillFactor:[.05,1],coreSigmaPx:[0,3],haloSigmaPx:[0,50],haloWeight:[0,1],wavelengthUm:[.4,.7],rolloff:[.2,6]},yr={aperture:.2,olpfSeparationPx:.05,fillFactor:.03,coreSigmaPx:.03,haloSigmaPx:.2,haloWeight:.05,wavelengthUm:.01,rolloff:.1},Xr=()=>{let F=0,Ce=0;for(;F===0;)F=Math.random();for(;Ce===0;)Ce=Math.random();return Math.sqrt(-2*Math.log(F))*Math.cos(2*Math.PI*Ce)},ut=()=>["aperture","olpfSeparationPx","fillFactor","coreSigmaPx","haloSigmaPx","haloWeight","wavelengthUm","rolloff"].filter(Ce=>!ee[Ce]),Dt=(F,Ce)=>Ce.map(Ee=>F[Ee]),Vt=(F,Ce,Ee,_t)=>{const He={...Ce};for(let Lt=0;Lt<Ee.length;Lt++){const Ur=Ee[Lt],[Kr,lr]=At[Ur];He[Ur]=Er(F[Lt],Kr,lr)}Object.keys(_t).forEach(Lt=>{_t[Lt]&&(He[Lt]=Ce[Lt])});const dt=_t.coreSigmaPx,qe=_t.haloSigmaPx;return qe&&!dt?He.coreSigmaPx=Math.min(He.coreSigmaPx,Ce.haloSigmaPx):dt&&!qe?He.haloSigmaPx=Math.max(He.haloSigmaPx,Ce.coreSigmaPx):!dt&&!qe&&(He.haloSigmaPx=Math.max(He.haloSigmaPx,He.coreSigmaPx)),He},ar=(F,Ce)=>{const Ee=[...F];for(let _t=0;_t<Ce.length;_t++){const He=Ce[_t],dt=yr[He],qe=He==="aperture"?.1:He==="wavelengthUm"?.02:.2;Ee[_t]=Ee[_t]+qe*dt*Xr()}return Ee},St=(F,Ce,Ee,_t)=>{const He=F.map(dt=>1/(1+.5*dt*dt));return dt=>{const qe=Vt(dt,Ee,_t,ee);let Lt=0;for(let lr=0;lr<F.length;lr++){const kn=Ce[lr],Ar=xe(F[lr],qe)-kn;Lt+=He[lr]*Ar*Ar}const Kr=1e-4*((ee.olpfSeparationPx?0:qe.olpfSeparationPx*qe.olpfSeparationPx)+(ee.coreSigmaPx?0:qe.coreSigmaPx*qe.coreSigmaPx)+(ee.haloSigmaPx?0:qe.haloSigmaPx*qe.haloSigmaPx)+(ee.rolloff?0:(qe.rolloff-1)*(qe.rolloff-1)));return Lt+Kr}},_e=(F,Ce,Ee,_t=320)=>{const He=Ce.length,dt=new Array(He+1);dt[0]=[...Ce];for(let cr=0;cr<He;cr++){const Ft=[...Ce];Ft[cr]=Ft[cr]+Ee[cr],dt[cr+1]=Ft}const qe=dt.map(cr=>F(cr)),Lt=()=>{const cr=qe.map((We,xr)=>[We,xr]).sort((We,xr)=>We[0]-xr[0]).map(We=>We[1]),Ft=cr.map(We=>dt[We]),Br=cr.map(We=>qe[We]);for(let We=0;We<dt.length;We++)dt[We]=Ft[We];for(let We=0;We<qe.length;We++)qe[We]=Br[We]},Ur=()=>{const cr=new Array(He).fill(0);for(let Ft=0;Ft<He;Ft++){const Br=dt[Ft];for(let We=0;We<He;We++)cr[We]+=Br[We]}for(let Ft=0;Ft<He;Ft++)cr[Ft]/=He;return cr},Kr=(cr,Ft,Br=1)=>cr.map((We,xr)=>We+Br*Ft[xr]),lr=(cr,Ft)=>cr.map((Br,We)=>Br-Ft[We]),kn=1,Yr=2,Ar=.5;for(let cr=0;cr<_t;cr++){Lt();const Ft=dt[0],Br=dt[He],We=Ur(),xr=Kr(We,lr(We,Br),kn),mn=F(xr);if(mn<qe[0]){const Sn=Kr(We,lr(xr,We),Yr),Ja=F(Sn);Ja<mn?(dt[He]=Sn,qe[He]=Ja):(dt[He]=xr,qe[He]=mn);continue}if(mn<qe[He-1]){dt[He]=xr,qe[He]=mn;continue}const sa=Kr(We,lr(Br,We),-.5),Da=F(sa);if(Da<qe[He]){dt[He]=sa,qe[He]=Da;continue}for(let Sn=1;Sn<He+1;Sn++)dt[Sn]=Kr(Ft,lr(dt[Sn],Ft),Ar),qe[Sn]=F(dt[Sn])}return Lt(),{x:dt[0],fx:qe[0]}},Or=async()=>{if(!(ge!=null&&ge.freqs)||!(ge!=null&&ge.mtf)||ge.freqs.length<10){Pe("No enough MTF data to fit.");return}const F=ut();if(F.length===0){Pe("All parameters are locked.");return}const Ce=Math.max(0,parseFloat(re||"0")||0),Ee=vt,_t=(()=>{const We=parseFloat(fe||"");return Number.isFinite(We)&&We>0?We:Ee})(),He=[];for(let We=0;We<ge.freqs.length;We++){const xr=ge.freqs[We],mn=ge.mtf[We];xr>=Ce&&xr<=_t&&Number.isFinite(mn)&&He.push([xr,mn])}if(He.length<10){Pe("Fit range too narrow (need >= 10 points).");return}const qe=Math.max(1,Math.floor(He.length/300)),Lt=He.filter((We,xr)=>xr%qe===0).map(We=>We[0]),Ur=He.filter((We,xr)=>xr%qe===0).map(We=>We[1]);Se(!0),Pe(`Fitting ${F.length} params (${Lt.length} pts) in [${Ce.toFixed(3)}, ${_t.toFixed(3)}] ${Kt} ...`);const Kr=Q,lr=Dt(Kr,F),kn=F.map(We=>yr[We]),Yr=St(Lt,Ur,Kr,F),Ar=7;let cr=lr,Ft=Yr(lr);for(let We=0;We<Ar;We++){const xr=We===0?lr:ar(lr,F),mn=_e(Yr,xr,kn,320);mn.fx<Ft&&(Ft=mn.fx,cr=mn.x),await new Promise(requestAnimationFrame)}const Br=Vt(cr,Kr,F,ee);te(Br),Pe(`Fit done. SSE=${Ft.toExponential(3)}  unlocked=${F.length}  range=[${Ce.toFixed(3)}, ${_t.toFixed(3)}] ${Kt}`),Se(!1)};return c.jsxs("div",{className:`fixed flex flex-col bg-white dark:bg-slate-900 border border-gray-200 dark:border-slate-700 shadow-2xl overflow-hidden ${rr?"rounded-none":"rounded-xl"}`,style:rr?{inset:0,width:"100vw",height:"100vh",zIndex:a??100}:{left:Le.x,top:Le.y,width:et.w,height:Sr?"auto":et.h,zIndex:a??100},onMouseDownCapture:i,children:[c.jsxs("div",{className:`flex justify-between items-center px-4 py-2 border-b border-gray-200 dark:border-slate-700 bg-gray-50 dark:bg-slate-800 select-none ${!rr&&ft?"cursor-grabbing":rr?"":"cursor-grab"}`,onMouseDown:Qe,onDoubleClick:()=>Nr(!rr),children:[c.jsxs("h3",{className:"text-sm font-bold text-orange-600 dark:text-orange-400 flex items-center gap-2 pointer-events-none",children:["SFR Expert (Adaptive Edge Method)",c.jsxs("span",{className:"text-xs bg-orange-100 dark:bg-orange-900/30 text-orange-700 dark:text-orange-300 px-2 py-0.5 rounded border border-orange-200 dark:border-orange-800",children:[l.length," ROI",l.length!==1?"s":""]})]}),c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx("button",{onClick:()=>Nr(!rr),className:"text-gray-400 hover:text-orange-500 transition-colors",title:rr?"Restore":"Maximize",children:rr?c.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 14h6v6M20 10h-6V4"})}):c.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 8V4m0 0h4M20 8V4m0 0h-4M4 16v4m0 0h4M20 16v4m0 0h-4"})})}),c.jsx("button",{onClick:()=>Gr(!Sr),className:"text-gray-400 hover:text-orange-500 transition-colors",children:c.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M20 12H4"})})})]})]}),!Sr&&c.jsxs(c.Fragment,{children:[c.jsxs("div",{className:"p-3 bg-gray-50/50 dark:bg-slate-800/30 border-b border-gray-200 dark:border-slate-700 flex items-center gap-4 flex-wrap text-xs flex-shrink-0",children:[c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx("span",{className:"font-bold text-gray-500 dark:text-slate-400",children:"Pixel Pitch (m):"}),c.jsx("input",{type:"number",value:d,onMouseDown:F=>F.stopPropagation(),onClick:F=>F.stopPropagation(),onChange:F=>f(F.target.value),placeholder:"Default (cy/px)",className:"w-20 px-2 py-1 bg-white dark:bg-slate-900 border border-gray-300 dark:border-slate-600 rounded outline-none focus:border-orange-500"})]}),c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx("span",{className:"font-bold text-gray-500 dark:text-slate-400",children:"Image Height:"}),c.jsx("input",{type:"number",value:h,onMouseDown:F=>F.stopPropagation(),onClick:F=>F.stopPropagation(),onChange:F=>g(F.target.value),placeholder:"px",className:"w-16 px-2 py-1 bg-white dark:bg-slate-900 border border-gray-300 dark:border-slate-600 rounded outline-none focus:border-orange-500"})]}),c.jsxs("div",{className:"flex items-center gap-2 bg-blue-50 dark:bg-blue-900/20 px-2 py-1 rounded border border-blue-100 dark:border-blue-800",children:[c.jsx("span",{className:"font-bold text-blue-600 dark:text-blue-400",children:"Bin:"}),nt?c.jsxs("span",{className:"font-mono text-gray-700 dark:text-gray-300",children:[nt.toFixed(3),"px",c.jsxs("span",{className:"text-[10px] ml-1 text-gray-500",children:["(",Ot,"x)"]})]}):c.jsx("span",{className:"text-gray-400 italic",children:"..."}),c.jsxs("label",{className:"flex items-center gap-1 cursor-pointer select-none ml-2 border-l border-blue-200 dark:border-blue-700 pl-2",onMouseDown:F=>F.stopPropagation(),onClick:F=>F.stopPropagation(),children:[c.jsx("input",{type:"checkbox",checked:$,onChange:F=>{F.stopPropagation(),L(F.target.checked)},className:"w-3 h-3 text-blue-600 rounded focus:ring-blue-500 border-gray-300"}),c.jsx("span",{className:"text-[10px] font-bold text-blue-600 dark:text-blue-400",children:"Manual"})]}),$&&c.jsx("input",{type:"number",value:U,onMouseDown:F=>F.stopPropagation(),onClick:F=>F.stopPropagation(),onChange:F=>V(F.target.value),step:"0.001",min:"0.01",max:"0.5",className:"w-16 px-1 py-0.5 text-xs bg-white dark:bg-slate-900 border border-blue-300 dark:border-blue-600 rounded outline-none focus:border-orange-500",placeholder:"0.125"})]}),c.jsxs("div",{className:"flex items-center gap-4 flex-1 min-w-[500px] border-l border-gray-300 dark:border-slate-600 pl-3",children:[c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsxs("label",{className:"flex items-center gap-1 cursor-pointer select-none",title:"Linear detrending with limited fitting width",onMouseDown:F=>F.stopPropagation(),onClick:F=>F.stopPropagation(),children:[c.jsx("input",{type:"checkbox",checked:m,onChange:F=>{F.stopPropagation(),k(F.target.checked)},className:"w-4 h-4 text-purple-600 rounded focus:ring-purple-500 border-gray-300"}),c.jsx("span",{className:"font-bold text-purple-600 dark:text-purple-400",children:"Deshading"})]}),m&&c.jsxs(c.Fragment,{children:[c.jsxs("label",{className:"flex items-center gap-1 cursor-pointer select-none border-l border-purple-200 dark:border-purple-800 pl-2",onMouseDown:F=>F.stopPropagation(),onClick:F=>F.stopPropagation(),children:[c.jsx("input",{type:"checkbox",checked:B,onChange:F=>{F.stopPropagation(),z(F.target.checked)},className:"w-3 h-3 text-purple-600 rounded focus:ring-purple-500 border-gray-300"}),c.jsx("span",{className:"text-[10px] font-bold text-purple-600 dark:text-purple-400",children:"Limit Fit"})]}),B&&c.jsxs("div",{className:"flex items-center gap-1",title:"Width of data used for fitting (pixels)",children:[c.jsx("input",{type:"number",value:Y,onMouseDown:F=>F.stopPropagation(),onClick:F=>F.stopPropagation(),onChange:F=>G(F.target.value),step:"5",min:"10",max:"500",className:"w-14 px-1 py-0.5 text-xs bg-white dark:bg-slate-900 border border-purple-300 dark:border-purple-600 rounded outline-none focus:border-orange-500"}),c.jsx("span",{className:"text-[10px] text-gray-500",children:"px"})]})]})]}),c.jsxs("label",{className:"flex items-center gap-1 cursor-pointer select-none",onMouseDown:F=>F.stopPropagation(),onClick:F=>F.stopPropagation(),children:[c.jsx("input",{type:"checkbox",checked:P,onChange:F=>{F.stopPropagation(),j(F.target.checked)},className:"w-4 h-4 text-emerald-600 rounded focus:ring-emerald-500 border-gray-300"}),c.jsx("span",{className:"font-bold text-emerald-600 dark:text-emerald-400",children:"G-Only"})]}),c.jsxs("label",{className:"flex items-center gap-1 cursor-pointer select-none",onMouseDown:F=>F.stopPropagation(),onClick:F=>F.stopPropagation(),title:"Apply Hann windowing before FFT",children:[c.jsx("input",{type:"checkbox",checked:S,onChange:F=>{F.stopPropagation(),M(F.target.checked)},className:"w-4 h-4 text-amber-600 rounded focus:ring-amber-500 border-gray-300"}),c.jsx("span",{className:"font-bold text-amber-600 dark:text-amber-400",children:"Hann On"})]}),c.jsxs("label",{className:"flex items-center gap-1 cursor-pointer select-none",onMouseDown:F=>F.stopPropagation(),onClick:F=>F.stopPropagation(),children:[c.jsx("input",{type:"checkbox",checked:O,onChange:F=>{F.stopPropagation(),E(F.target.checked)},className:"w-4 h-4 text-blue-600 rounded focus:ring-blue-500 border-gray-300"}),c.jsx("span",{className:"font-bold text-blue-600 dark:text-blue-400",children:"2 Freq"})]}),c.jsxs("label",{className:"flex items-center gap-1 cursor-pointer select-none",onMouseDown:F=>F.stopPropagation(),onClick:F=>F.stopPropagation(),children:[c.jsx("input",{type:"checkbox",checked:I,onChange:F=>{F.stopPropagation(),D(F.target.checked)},className:"w-4 h-4 text-teal-600 rounded focus:ring-teal-500 border-gray-300"}),c.jsx("span",{className:"font-bold text-teal-600 dark:text-teal-400",children:"Show PTF"})]}),c.jsxs("label",{className:"flex items-center gap-1 cursor-pointer select-none",onMouseDown:F=>F.stopPropagation(),onClick:F=>F.stopPropagation(),children:[c.jsx("input",{type:"checkbox",checked:v,onChange:F=>{F.stopPropagation();const Ce=F.target.checked;x(Ce),Ce||w(pr)},className:"w-4 h-4 text-orange-600 rounded focus:ring-orange-500 border-gray-300"}),c.jsx("span",{className:"font-bold text-gray-600 dark:text-slate-300",children:"Jiang's official NR"})]}),c.jsxs("div",{className:"flex-1 flex flex-col justify-center",children:[c.jsxs("div",{className:"flex justify-between items-baseline",children:[c.jsx("span",{className:"font-bold text-gray-500 dark:text-slate-400",children:v?"Calculated:":"Manual:"}),c.jsxs("span",{className:`font-mono font-bold ${v?"text-green-600 dark:text-green-400":"text-gray-700 dark:text-gray-300"}`,children:[v&&(ge!=null&&ge.calcRadius)?ge.calcRadius.toFixed(2):b.toFixed(1)," px"]})]}),c.jsx("input",{type:"range",min:"2",max:pr,step:"0.5",value:b,onMouseDown:F=>F.stopPropagation(),onChange:F=>{w(parseFloat(F.target.value)),x(!1)},disabled:v,className:`w-full h-1.5 rounded-lg appearance-none cursor-pointer ${v?"bg-gray-200 dark:bg-slate-800":"bg-gray-300 dark:bg-slate-600 accent-orange-500"}`})]})]}),c.jsxs("div",{className:"flex gap-2",children:[c.jsx("button",{onMouseDown:F=>F.stopPropagation(),onClick:F=>{F.stopPropagation(),ze()},disabled:!jr,title:jr?"":"Scalar Unmixing must be active. Run Unmixing in Sidebar first.",className:`px-3 py-1.5 text-white font-bold rounded shadow-sm transition-transform active:scale-95 ${jr?"bg-orange-600 hover:bg-orange-500":"bg-gray-400 cursor-not-allowed"}`,children:jr?"Add Current ROI":"Unmixing Required"}),c.jsx("button",{onMouseDown:F=>F.stopPropagation(),onClick:F=>{F.stopPropagation(),Pt()},disabled:!ge||!ge.mtf50||!n,className:"px-3 py-1.5 bg-cyan-600 hover:bg-cyan-500 disabled:bg-gray-300 disabled:text-gray-500 text-white font-bold rounded shadow-sm transition-transform active:scale-95",children:"Copy Pos/MTF50"}),c.jsx("button",{onMouseDown:F=>F.stopPropagation(),onClick:F=>{F.stopPropagation(),ot()},disabled:!ge,className:"px-3 py-1.5 bg-indigo-600 hover:bg-indigo-500 disabled:bg-gray-300 disabled:text-gray-500 text-white font-bold rounded shadow-sm transition-transform active:scale-95",children:"Export CSV"}),c.jsx("button",{onMouseDown:F=>F.stopPropagation(),onClick:F=>{F.stopPropagation(),Je()},className:"px-3 py-1.5 bg-gray-200 hover:bg-gray-300 dark:bg-slate-700 dark:hover:bg-slate-600 text-gray-600 dark:text-slate-300 font-bold rounded transition-colors",children:"Clear"})]})]}),c.jsxs("div",{className:"px-3 py-2 bg-indigo-50 dark:bg-indigo-900/20 border-b border-indigo-200 dark:border-indigo-800 flex items-center gap-4 flex-wrap text-xs",children:[c.jsxs("label",{className:"flex items-center gap-2 cursor-pointer select-none",onMouseDown:F=>F.stopPropagation(),onClick:F=>F.stopPropagation(),children:[c.jsx("input",{type:"checkbox",checked:J,onChange:F=>{F.stopPropagation(),K(F.target.checked)},className:"w-4 h-4 text-indigo-600 rounded focus:ring-indigo-500 border-gray-300"}),c.jsx("span",{className:"font-bold text-indigo-700 dark:text-indigo-400 text-sm",children:"Show Model Line"})]}),c.jsxs("div",{className:"flex items-center gap-2",title:"F-number (Aperture)",children:[c.jsx(_s,{locked:ee.aperture,onToggle:()=>me(F=>({...F,aperture:!F.aperture}))}),c.jsx("span",{className:"font-bold text-gray-600 dark:text-slate-300",children:"F/"}),c.jsx("input",{type:"number",value:Q.aperture,step:"0.05",min:"0.7",max:"64",onMouseDown:F=>F.stopPropagation(),onClick:F=>F.stopPropagation(),onChange:F=>{const Ce=parseFloat(F.target.value);Number.isFinite(Ce)&&te(Ee=>({...Ee,aperture:Ce}))},className:"w-20 px-1 py-0.5 bg-white dark:bg-slate-900 border border-indigo-300 dark:border-indigo-600 rounded text-xs"})]}),c.jsxs("div",{className:"flex items-center gap-2",title:"OLPF two-image split separation d (px)",children:[c.jsx(_s,{locked:ee.olpfSeparationPx,onToggle:()=>me(F=>({...F,olpfSeparationPx:!F.olpfSeparationPx}))}),c.jsx("span",{className:"font-bold text-gray-600 dark:text-slate-300",children:"OLPF d:"}),c.jsx("input",{type:"number",value:Q.olpfSeparationPx,step:"0.01",min:"0",max:"5",onMouseDown:F=>F.stopPropagation(),onClick:F=>F.stopPropagation(),onChange:F=>{const Ce=parseFloat(F.target.value);Number.isFinite(Ce)&&te(Ee=>({...Ee,olpfSeparationPx:Ce}))},className:"w-20 px-1 py-0.5 bg-white dark:bg-slate-900 border border-indigo-300 dark:border-indigo-600 rounded text-xs"}),c.jsx("span",{className:"text-[10px] text-gray-500",children:"px"})]}),c.jsxs("div",{className:"flex items-center gap-2",title:"Pixel Fill Factor (0..1)",children:[c.jsx(_s,{locked:ee.fillFactor,onToggle:()=>me(F=>({...F,fillFactor:!F.fillFactor}))}),c.jsx("span",{className:"font-bold text-gray-600 dark:text-slate-300",children:"Fill:"}),c.jsx("input",{type:"number",value:Q.fillFactor,step:"0.01",min:"0",max:"1",onMouseDown:F=>F.stopPropagation(),onClick:F=>F.stopPropagation(),onChange:F=>{const Ce=parseFloat(F.target.value);Number.isFinite(Ce)&&te(Ee=>({...Ee,fillFactor:Ce}))},className:"w-20 px-1 py-0.5 bg-white dark:bg-slate-900 border border-indigo-300 dark:border-indigo-600 rounded text-xs"})]}),c.jsxs("div",{className:"flex items-center gap-2",title:"Spherical core sigma (px)",children:[c.jsx(_s,{locked:ee.coreSigmaPx,onToggle:()=>me(F=>({...F,coreSigmaPx:!F.coreSigmaPx}))}),c.jsx("span",{className:"font-bold text-gray-600 dark:text-slate-300",children:"Core :"}),c.jsx("input",{type:"number",value:Q.coreSigmaPx,step:"0.01",min:"0",max:"10",onMouseDown:F=>F.stopPropagation(),onClick:F=>F.stopPropagation(),onChange:F=>{const Ce=parseFloat(F.target.value);Number.isFinite(Ce)&&te(Ee=>({...Ee,coreSigmaPx:Ce}))},className:"w-20 px-1 py-0.5 bg-white dark:bg-slate-900 border border-indigo-300 dark:border-indigo-600 rounded text-xs"}),c.jsx("span",{className:"text-[10px] text-gray-500",children:"px"})]}),c.jsxs("div",{className:"flex items-center gap-2",title:"Spherical halo sigma (px)",children:[c.jsx(_s,{locked:ee.haloSigmaPx,onToggle:()=>me(F=>({...F,haloSigmaPx:!F.haloSigmaPx}))}),c.jsx("span",{className:"font-bold text-gray-600 dark:text-slate-300",children:"Halo :"}),c.jsx("input",{type:"number",value:Q.haloSigmaPx,step:"0.01",min:"0",max:"50",onMouseDown:F=>F.stopPropagation(),onClick:F=>F.stopPropagation(),onChange:F=>{const Ce=parseFloat(F.target.value);Number.isFinite(Ce)&&te(Ee=>({...Ee,haloSigmaPx:Ce}))},className:"w-20 px-1 py-0.5 bg-white dark:bg-slate-900 border border-indigo-300 dark:border-indigo-600 rounded text-xs"}),c.jsx("span",{className:"text-[10px] text-gray-500",children:"px"})]}),c.jsxs("div",{className:"flex items-center gap-2",title:"Halo weight 0..1",children:[c.jsx(_s,{locked:ee.haloWeight,onToggle:()=>me(F=>({...F,haloWeight:!F.haloWeight}))}),c.jsx("span",{className:"font-bold text-gray-600 dark:text-slate-300",children:"Halo w:"}),c.jsx("input",{type:"number",value:Q.haloWeight,step:"0.01",min:"0",max:"1",onMouseDown:F=>F.stopPropagation(),onClick:F=>F.stopPropagation(),onChange:F=>{const Ce=parseFloat(F.target.value);Number.isFinite(Ce)&&te(Ee=>({...Ee,haloWeight:Ce}))},className:"w-20 px-1 py-0.5 bg-white dark:bg-slate-900 border border-indigo-300 dark:border-indigo-600 rounded text-xs"})]}),c.jsxs("div",{className:"flex items-center gap-2",title:"Wavelength (m) for diffraction model",children:[c.jsx(_s,{locked:ee.wavelengthUm,onToggle:()=>me(F=>({...F,wavelengthUm:!F.wavelengthUm}))}),c.jsx("span",{className:"font-bold text-gray-600 dark:text-slate-300",children:":"}),c.jsx("input",{type:"number",value:Q.wavelengthUm,step:"0.01",min:"0.35",max:"0.75",onMouseDown:F=>F.stopPropagation(),onClick:F=>F.stopPropagation(),onChange:F=>{const Ce=parseFloat(F.target.value);Number.isFinite(Ce)&&te(Ee=>({...Ee,wavelengthUm:Ce}))},className:"w-20 px-1 py-0.5 bg-white dark:bg-slate-900 border border-indigo-300 dark:border-indigo-600 rounded text-xs"}),c.jsx("span",{className:"text-[10px] text-gray-500",children:"m"})]}),c.jsxs("div",{className:"flex items-center gap-2",title:"Manual rolloff exponent",children:[c.jsx(_s,{locked:ee.rolloff,onToggle:()=>me(F=>({...F,rolloff:!F.rolloff}))}),c.jsx("span",{className:"font-bold text-gray-600 dark:text-slate-300",children:"Rolloff:"}),c.jsx("input",{type:"number",value:Q.rolloff,step:"0.01",min:"0.1",max:"10",onMouseDown:F=>F.stopPropagation(),onClick:F=>F.stopPropagation(),onChange:F=>{const Ce=parseFloat(F.target.value);Number.isFinite(Ce)&&te(Ee=>({...Ee,rolloff:Ce}))},className:"w-20 px-1 py-0.5 bg-white dark:bg-slate-900 border border-indigo-300 dark:border-indigo-600 rounded text-xs"})]}),c.jsxs("div",{className:"flex items-center gap-2 ml-2",children:[c.jsx("span",{className:"font-bold text-gray-600 dark:text-slate-300",children:"Fit:"}),c.jsx("input",{type:"number",value:re,step:"0.001",min:"0",onMouseDown:F=>F.stopPropagation(),onClick:F=>F.stopPropagation(),onChange:F=>De(F.target.value),className:"w-20 px-1 py-0.5 bg-white dark:bg-slate-900 border border-indigo-300 dark:border-indigo-600 rounded text-xs",title:`Fit range min (${Kt})`}),c.jsx("span",{className:"text-[10px] text-gray-500",children:"to"}),c.jsx("input",{type:"number",value:fe,step:"0.001",min:"0",onMouseDown:F=>F.stopPropagation(),onClick:F=>F.stopPropagation(),onChange:F=>le(F.target.value),className:"w-20 px-1 py-0.5 bg-white dark:bg-slate-900 border border-indigo-300 dark:border-indigo-600 rounded text-xs",placeholder:`${vt.toFixed(2)}`,title:`Fit range max (${Kt}), blank = current max`}),c.jsx("button",{onMouseDown:F=>F.stopPropagation(),onClick:F=>{F.stopPropagation(),de||Or()},disabled:de||!ge,className:`px-2 py-1 rounded font-bold text-white text-xs transition-transform active:scale-95 ${de?"bg-gray-400":"bg-indigo-600 hover:bg-indigo-500"}`,title:"Auto fit UNLOCKED params to measured MTF in the given frequency range",children:de?"Fitting":"Auto Fit"})]}),c.jsx("span",{className:"text-[10px] text-gray-500 dark:text-slate-400 italic ml-2",children:"Dot filled = locked. Auto Fit only changes unlocked params."}),he&&c.jsx("span",{className:"text-[10px] text-gray-500 dark:text-slate-400 italic ml-2",children:he})]}),c.jsxs("div",{className:"flex-1 p-4 overflow-hidden flex flex-col gap-4 bg-white dark:bg-slate-950",children:[c.jsxs("div",{className:"h-[35%] min-h-[180px] flex gap-4",children:[c.jsxs("div",{className:"flex-1 bg-gray-50 dark:bg-slate-900/50 border border-gray-200 dark:border-slate-800 rounded-xl p-2 relative flex flex-col",children:[c.jsx("h4",{className:"text-[10px] font-bold text-gray-500 dark:text-slate-400 absolute top-2 left-3 z-10 bg-white/80 dark:bg-slate-900/80 px-1 rounded",children:"ESF"}),c.jsx("div",{className:"flex-1 min-h-0 w-full",children:c.jsx(_o,{width:"100%",height:"100%",children:c.jsxs(zl,{data:Yt,children:[c.jsx(so,{strokeDasharray:"3 3",stroke:"#374151",opacity:.1}),c.jsx(Xa,{dataKey:"x",hide:!0}),c.jsx(Ka,{hide:!0,domain:["auto","auto"]}),c.jsx(ra,{contentStyle:{fontSize:"10px"}}),c.jsx(En,{type:"monotone",dataKey:"y",stroke:"#3b82f6",strokeWidth:1,dot:!1,isAnimationActive:!1})]})})})]}),c.jsxs("div",{className:"flex-1 bg-gray-50 dark:bg-slate-900/50 border border-gray-200 dark:border-slate-800 rounded-xl p-2 relative flex flex-col",children:[c.jsxs("div",{className:"absolute top-2 left-3 z-10 flex items-center gap-3",children:[c.jsxs("h4",{className:"text-[10px] font-bold text-gray-500 dark:text-slate-400 bg-white/80 dark:bg-slate-900/80 px-1 rounded",children:["LSF ",ve>1?`(x${ve.toFixed(0)})`:""]}),c.jsxs("div",{className:"flex items-center gap-1 bg-white/80 dark:bg-slate-900/80 px-1 rounded border border-gray-200 dark:border-slate-700",children:[c.jsx("span",{className:"text-[9px] text-gray-400 font-bold",children:"Zoom"}),c.jsx("input",{type:"range",min:"1",max:"50",step:"1",value:ve,onMouseDown:F=>F.stopPropagation(),onChange:F=>ye(parseFloat(F.target.value)),className:"w-16 h-1 bg-gray-300 dark:bg-slate-600 rounded-lg appearance-none cursor-pointer accent-red-500"})]})]}),c.jsx("div",{className:"flex-1 min-h-0 w-full",children:c.jsx(_o,{width:"100%",height:"100%",children:c.jsxs(zl,{data:Ke,children:[c.jsx(so,{strokeDasharray:"3 3",stroke:"#374151",opacity:.1}),c.jsx(Ws,{y:0,stroke:"#9ca3af",strokeOpacity:.5,strokeDasharray:"3 3"}),c.jsx(Xa,{dataKey:"x",hide:!0}),c.jsx(Ka,{hide:!1,width:30,tick:{fontSize:9,fill:"#888"},domain:[F=>F,F=>F/ve],allowDataOverflow:!0,tickFormatter:F=>F.toFixed(3)}),c.jsx(ra,{contentStyle:{fontSize:"10px"},formatter:F=>[F.toFixed(5),"Amplitude"]}),c.jsx(En,{type:"monotone",dataKey:"y",stroke:"#ef4444",strokeWidth:2,dot:!1,isAnimationActive:!1})]})})})]})]}),c.jsxs("div",{className:"flex-1 flex gap-4 min-h-[250px]",children:[c.jsxs("div",{className:"flex-1 bg-white dark:bg-slate-900 border border-gray-200 dark:border-slate-800 rounded-xl p-2 relative flex flex-col",children:[c.jsxs("div",{className:"flex justify-between items-start px-2 mb-1",children:[c.jsx("h4",{className:"text-xs font-bold text-gray-500 dark:text-slate-400 uppercase",children:"MTF"}),c.jsxs("div",{className:"flex gap-4 items-center",children:[(ge==null?void 0:ge.mtf50)&&c.jsxs("div",{className:"text-sm font-bold text-gray-600 dark:text-slate-300",children:["MTF50 = ",c.jsxs("span",{className:"text-orange-600 dark:text-orange-400",children:[ge.mtf50.toFixed(2)," ",Kt]})]}),sr!==null&&c.jsxs("div",{className:"text-lg font-bold text-white bg-orange-500 px-3 py-0.5 rounded shadow-lg animate-in fade-in",children:[Math.round(sr)," LW/PH"]})]})]}),c.jsxs("div",{className:"flex-1 relative min-h-0 w-full",children:[c.jsx("div",{className:"absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 pointer-events-none select-none opacity-10",children:c.jsx("svg",{viewBox:"0 0 400 60",className:"w-[30rem] h-auto",children:c.jsx("text",{x:"50%",y:"50%",dominantBaseline:"middle",textAnchor:"middle",className:"fill-gray-900 dark:fill-white",fontSize:"24",fontWeight:"bold",children:" y-g-jiang.github.io"})})}),c.jsx(_o,{width:"100%",height:"100%",children:c.jsxs(zl,{data:Ge,margin:{top:10,right:30,left:10,bottom:20},children:[c.jsx(so,{strokeDasharray:"3 3",stroke:"#374151",opacity:.15}),c.jsx(Xa,{dataKey:"freq",type:"number",domain:[0,vt],tick:{fontSize:10,fill:"#9ca3af"},label:{value:`Frequency (${Kt})`,position:"insideBottom",offset:-10,fontSize:11,fill:"#9ca3af"}}),c.jsx(Ka,{domain:[0,1.1],tick:{fontSize:10,fill:"#9ca3af"},label:{value:"MTF",angle:-90,position:"insideLeft",fontSize:11,fill:"#9ca3af"}}),c.jsx(ra,{contentStyle:{backgroundColor:"rgba(15, 23, 42, 0.9)",border:"none",color:"#fff",fontSize:"11px",borderRadius:"4px"},labelFormatter:F=>`Freq: ${Number(F).toFixed(3)} ${Kt}`,formatter:(F,Ce)=>Ce==="Model"?[F==null?void 0:F.toFixed(4),"Model"]:[F==null?void 0:F.toFixed(4),"Measured"]}),c.jsx(To,{verticalAlign:"top",height:20}),c.jsx(En,{type:"monotone",dataKey:"mtf",name:"Measured",stroke:"#000000",strokeWidth:2,className:"dark:stroke-white",dot:!1,isAnimationActive:!1,connectNulls:!1}),J&&c.jsx(En,{type:"monotone",dataKey:"modelMtf",name:"Model",stroke:"#0066cc",strokeWidth:2,strokeDasharray:"5 5",dot:!1,isAnimationActive:!1,connectNulls:!0}),(ge==null?void 0:ge.mtf50)&&c.jsx(j0,{x:ge.mtf50,y:.5,r:4,fill:"#f97316",stroke:"none",children:c.jsx(wa,{value:"MTF50",position:"top",fill:"#f97316",fontSize:10,fontWeight:"bold"})})]})})]})]}),I&&c.jsxs("div",{className:"flex-1 bg-white dark:bg-slate-900 border border-gray-200 dark:border-slate-800 rounded-xl p-2 relative flex flex-col",children:[c.jsx("div",{className:"flex justify-between items-start px-2 mb-1",children:c.jsx("h4",{className:"text-xs font-bold text-teal-600 dark:text-teal-400 uppercase",children:"PTF / Phase"})}),c.jsx("div",{className:"flex-1 relative min-h-0 w-full",children:c.jsx(_o,{width:"100%",height:"100%",children:c.jsxs(zl,{data:Ht,margin:{top:10,right:30,left:10,bottom:20},children:[c.jsx(so,{strokeDasharray:"3 3",stroke:"#374151",opacity:.15}),c.jsx(Xa,{dataKey:"freq",type:"number",domain:[0,vt],tick:{fontSize:10,fill:"#9ca3af"},label:{value:`Frequency (${Kt})`,position:"insideBottom",offset:-10,fontSize:11,fill:"#9ca3af"}}),c.jsx(Ka,{tick:{fontSize:10,fill:"#9ca3af"},label:{value:"Phase (Rad)",angle:-90,position:"insideLeft",fontSize:11,fill:"#9ca3af"}}),c.jsx(ra,{contentStyle:{backgroundColor:"rgba(15, 23, 42, 0.9)",border:"none",color:"#fff",fontSize:"11px",borderRadius:"4px"},labelFormatter:F=>`Freq: ${Number(F).toFixed(3)} ${Kt}`,formatter:F=>[F==null?void 0:F.toFixed(4),"Phase (Rad)"]}),c.jsx(En,{type:"monotone",dataKey:"ptf",name:"Phase",stroke:"#0d9488",strokeWidth:2,dot:!1,isAnimationActive:!1})]})})})]})]})]})]}),!rr&&c.jsx("div",{className:"absolute bottom-0 right-0 w-4 h-4 cursor-nwse-resize z-50 bg-gray-300 dark:bg-slate-600 rounded-tl hover:bg-orange-500 transition-colors",onMouseDown:_r})]})},Uie=`
import struct
import numpy as np

class Type:
    Short = (3,2); Long = (4,4); Rational = (5,8); Ascii = (2,1); Byte = (1,1)
    Undefined = (7,1); Srational = (10,8); IFD = (13,4)

class Tag:
    NewSubfileType = (254, Type.Long); ImageWidth = (256, Type.Long); ImageLength = (257, Type.Long)
    BitsPerSample = (258, Type.Short); Compression = (259, Type.Short)
    PhotometricInterpretation = (262, Type.Short); Make = (271, Type.Ascii); Model = (272, Type.Ascii)
    StripOffsets = (273, Type.Long); Orientation = (274, Type.Short); SamplesPerPixel = (277, Type.Short)
    RowsPerStrip = (278, Type.Short); StripByteCounts = (279, Type.Long)
    CFARepeatPatternDim = (33421, Type.Short); CFAPattern = (33422, Type.Byte)
    DNGVersion = (50706, Type.Byte); UniqueCameraModel = (50708, Type.Ascii)
    BlackLevel = (50714, Type.Short); WhiteLevel = (50717, Type.Short)
    ColorMatrix1 = (50721, Type.Srational); CalibrationIlluminant1 = (50778, Type.Short)
    BlackLevelRepeatDim = (50713, Type.Short)

class Compression: Uncompressed = 1
class PhotometricInterpretation: Color_Filter_Array = 32803
class CFAPattern: BGGR=[2,1,1,0]; GBRG=[1,2,0,1]; GRBG=[1,0,2,1]; RGGB=[0,1,1,2]

class dngTag(object):
    def __init__(self, tagType, value=[]):
        self.TagId = tagType[0]
        self.DataType = tagType[1]
        self.DataCount = len(value) if not isinstance(value, str) else len(value) + 1
        self.Value = self._pack_value(tagType[1], value)
        self.DataLength = len(self.Value)
        self.selfContained = (self.DataLength <= 4)
        self.DataOffset = 0

    def _pack_value(self, dtype, value):
        tid = dtype[0]
        if tid == 1: return struct.pack('<%sB' % len(value), *value)
        elif tid == 3: return struct.pack('<%sH' % len(value), *value)
        elif tid == 4: return struct.pack('<%sL' % len(value), *value)
        elif tid == 2: return struct.pack('<%ss' % len(value), value.encode("ascii")) + b'\\x00'
        elif tid == 5 or tid == 10: 
            flat = [item for sublist in value for item in sublist]
            fmt = 'L' if tid == 5 else 'l'
            return struct.pack('<%s%s' % (len(flat), fmt), *flat)
        return b''

    def write_directory(self, buf, offset):
        if self.selfContained:
            val = self.Value + b'\\x00' * (4 - len(self.Value))
            struct.pack_into("<HHI4s", buf, offset, self.TagId, self.DataType[0], self.DataCount, val)
        else:
            struct.pack_into("<HHII", buf, offset, self.TagId, self.DataType[0], self.DataCount, self.DataOffset)

    def write_data(self, buf):
        if not self.selfContained:
            struct.pack_into(f"<{len(self.Value)}s", buf, self.DataOffset, self.Value)

def convert_to_dng(raw_bytes, width, height, cfa_str, black_level_list, shift, linear_shift, cm_flat):
    # 1. Pixel Data Processing
    # Ensure raw_bytes is a bytes-like object
    raw_data = np.frombuffer(raw_bytes, dtype=np.uint16).copy()
    
    # Use int32 for calculations to prevent premature overflow and allow negative offsets
    raw_data = raw_data.astype(np.int32)

    # Apply Bit Shift (<<)
    if shift > 0:
        raw_data = raw_data * (1 << shift)
    
    # Apply Linear Offset (+)
    if linear_shift != 0:
        raw_data = raw_data + linear_shift

    # Clip to 16-bit range
    raw_data = np.clip(raw_data, 0, 65535).astype(np.uint16)

    # 2. Metadata Preparation
    white_level = 65019
    # Format Color Matrix for Srational (Value, Denominator)
    color_matrix = [[int(x * 10000), 10000] for x in cm_flat]

    cfa_map = {"BGGR": CFAPattern.BGGR, "GBRG": CFAPattern.GBRG, "GRBG": CFAPattern.GRBG, "RGGB": CFAPattern.RGGB}
    
    tags = [
        dngTag(Tag.NewSubfileType, [0]),
        dngTag(Tag.ImageWidth, [width]),
        dngTag(Tag.ImageLength, [height]),
        dngTag(Tag.BitsPerSample, [16]), 
        dngTag(Tag.Compression, [Compression.Uncompressed]),
        dngTag(Tag.PhotometricInterpretation, [PhotometricInterpretation.Color_Filter_Array]),
        dngTag(Tag.Make, "JO-Workstation"),
        dngTag(Tag.Model, "Manual-16bit"),
        dngTag(Tag.SamplesPerPixel, [1]),
        dngTag(Tag.RowsPerStrip, [height]), 
        dngTag(Tag.CFARepeatPatternDim, [2, 2]),
        dngTag(Tag.CFAPattern, cfa_map.get(cfa_str.upper(), CFAPattern.RGGB)),
        dngTag(Tag.BlackLevelRepeatDim, [2, 2]),
        dngTag(Tag.BlackLevel, [int(x) for x in black_level_list]),
        dngTag(Tag.WhiteLevel, [white_level]),
        dngTag(Tag.ColorMatrix1, color_matrix),
        dngTag(Tag.CalibrationIlluminant1, [21]),
        dngTag(Tag.DNGVersion, [1, 4, 0, 0]),
        dngTag(Tag.UniqueCameraModel, "Generic 16bit Raw")
    ]
    
    pixel_bytes = raw_data.tobytes()
    tags.append(dngTag(Tag.StripOffsets, [0])) 
    tags.append(dngTag(Tag.StripByteCounts, [len(pixel_bytes)]))
    tags.sort(key=lambda x: x.TagId)
    
    ifd_size = 2 + (len(tags) * 12) + 4
    current_data_offset = 8 + ifd_size
    
    for tag in tags:
        if not tag.selfContained:
            tag.DataOffset = current_data_offset
            current_data_offset = (current_data_offset + tag.DataLength + 3) & 0xFFFFFFFC
            
    img_offset = current_data_offset
    for tag in tags:
        if tag.TagId == Tag.StripOffsets[0]:
            tag.Value = struct.pack('<L', img_offset)
            break
            
    buf = bytearray(img_offset + len(pixel_bytes))
    struct.pack_into("<ccbbI", buf, 0, b'I', b'I', 0x2A, 0x00, 8)
    struct.pack_into("<H", buf, 8, len(tags))
    
    offset = 10
    for tag in tags:
        tag.write_directory(buf, offset)
        offset += 12
        
    struct.pack_into("<I", buf, offset, 0)
    for tag in tags:
        tag.write_data(buf)
        
    buf[img_offset:img_offset+len(pixel_bytes)] = pixel_bytes
    return bytes(buf)
`,zie=({isOpen:e,onClose:t,rawImageData:r,fileName:n,zIndex:a=200,onFocus:i})=>{const[o,s]=_.useState(!0),[l,u]=_.useState(!1),[d,f]=_.useState(""),h=_.useRef(null),g=_.useRef(null),[b,w]=_.useState(4),[v,x]=_.useState(0),[m,k]=_.useState(""),[P,j]=_.useState(""),[S,M]=_.useState("RGGB"),[O,E]=_.useState(!1),[I,D]=_.useState(100),[B,z]=_.useState(4e3),[Y,G]=_.useState(0),[$,L]=_.useState(0),U=_.useMemo(()=>Object.keys(hu).sort(),[]);_.useEffect(()=>{e&&!h.current&&(async()=>{try{const Q=await window.loadPyodide();await Q.loadPackage("numpy"),await Q.runPythonAsync(Uie),h.current=Q,s(!1)}catch(Q){console.error("Pyodide Init Failed",Q)}})()},[e]),_.useEffect(()=>{if(e&&r){const K=r.whiteLevel;K>1e4?w(2):K>3e3?w(4):K>6e4&&w(0);const Q=r.bayerPattern?r.bayerPattern.toUpperCase():"RGGB";["RGGB","BGGR","GBRG","GRBG"].includes(Q)?M(Q):M("RGGB");const te=Math.min(r.width,r.height),ee=Math.max(48,Math.round(te/40));D(ee),G(Math.round(ee*10)),L(Math.round(r.height-ee*2))}},[e,r]);const V=async K=>{if(!K.target.files||K.target.files.length===0||!h.current)return;const Q=Array.from(K.target.files);u(!0);const te=m.trim()?m.trim().split(/\s+/).map(Number):[0,0,0,0];for(te.length===1&&!isNaN(te[0])&&te.push(te[0],te[0],te[0]);te.length<4;)te.push(0);const ee=P.trim()?P.trim().split(/[\s,\n]+/).map(Number):[1,0,0,0,1,0,0,0,1];if(ee.length!==9){alert("Color Matrix must contain exactly 9 numeric values."),u(!1);return}const me=h.current;for(let re=0;re<Q.length;re++){const De=Q[re];f(`Processing ${re+1}/${Q.length}: ${De.name}`);try{const fe=await De.arrayBuffer(),le=await pu(fe);let de;if(O){const Le=document.createElement("canvas");Le.width=le.width,Le.height=le.height;const rt=Le.getContext("2d");if(rt){rt.fillStyle="black",rt.fillRect(0,0,Le.width,Le.height),rt.font=`bold ${I}px sans-serif`,rt.fillStyle="white",rt.textBaseline="middle",rt.textAlign="center",rt.fillText("(C)  y-g-jiang.github.io",Y,$);const et=rt.getImageData(0,0,Le.width,Le.height).data;de=new Uint16Array(le.data);const tt=de.length;for(let ft=0;ft<tt;ft++)if(et[ft*4]>128){let wt=de[ft]+B;wt<0&&(wt=0),wt>65535&&(wt=65535),de[ft]=wt}}else de=new Uint16Array(le.data)}else de=le.data;me.globals.set("js_raw_bytes",new Uint8Array(de.buffer,de.byteOffset,de.byteLength)),me.globals.set("js_width",le.width),me.globals.set("js_height",le.height),me.globals.set("js_cfa",S),me.globals.set("js_bl_list",te),me.globals.set("js_shift",b),me.globals.set("js_linear_shift",v),me.globals.set("js_cm_flat",ee);const Se=await me.runPythonAsync(`
                    convert_to_dng(
                        js_raw_bytes.to_py(), 
                        js_width, 
                        js_height, 
                        js_cfa, 
                        js_bl_list.to_py(), 
                        js_shift,
                        js_linear_shift,
                        js_cm_flat.to_py()
                    )
                `),he=Se.toJs();Se.destroy();const Pe=new Blob([he],{type:"image/x-adobe-dng"}),ve=URL.createObjectURL(Pe),ye=document.createElement("a");ye.href=ve;const ge=De.name.substring(0,De.name.lastIndexOf("."))||"image",ue=O?"_wm":"";ye.download=`${ge}_16bit_manual${ue}.dng`,document.body.appendChild(ye),ye.click(),document.body.removeChild(ye),URL.revokeObjectURL(ve),await new Promise(Le=>setTimeout(Le,200))}catch(fe){console.error(`Failed to batch process ${De.name}`,fe)}}u(!1),f(""),K.target.value=""},J=async()=>{if(!(!r||!h.current)){u(!0);try{const K=h.current,Q=m.trim()?m.trim().split(/\s+/).map(Number):[0,0,0,0];if(Q.length===1&&!isNaN(Q[0])&&Q.push(Q[0],Q[0],Q[0]),Q.length<4)for(;Q.length<4;)Q.push(0);const te=P.trim()?P.trim().split(/[\s,\n]+/).map(Number):[1,0,0,0,1,0,0,0,1];if(te.length!==9)throw new Error("Color Matrix must contain exactly 9 numeric values.");const ee=S;let me;if(O){const Pe=document.createElement("canvas");Pe.width=r.width,Pe.height=r.height;const ve=Pe.getContext("2d");if(ve){ve.fillStyle="black",ve.fillRect(0,0,Pe.width,Pe.height),ve.font=`bold ${I}px sans-serif`,ve.fillStyle="white",ve.textBaseline="middle",ve.textAlign="center",ve.fillText("(C)  y-g-jiang.github.io",Y,$);const ye=ve.getImageData(0,0,Pe.width,Pe.height).data;me=new Uint16Array(r.data);const ge=me.length;for(let ue=0;ue<ge;ue++)if(ye[ue*4]>128){let Le=me[ue]+B;Le<0&&(Le=0),Le>65535&&(Le=65535),me[ue]=Le}}else me=new Uint16Array(r.data)}else me=r.data;K.globals.set("js_raw_bytes",new Uint8Array(me.buffer,me.byteOffset,me.byteLength)),K.globals.set("js_width",r.width),K.globals.set("js_height",r.height),K.globals.set("js_cfa",ee),K.globals.set("js_bl_list",Q),K.globals.set("js_shift",b),K.globals.set("js_linear_shift",v),K.globals.set("js_cm_flat",te);const re=await K.runPythonAsync(`
                convert_to_dng(
                    js_raw_bytes.to_py(), 
                    js_width, 
                    js_height, 
                    js_cfa, 
                    js_bl_list.to_py(), 
                    js_shift,
                    js_linear_shift,
                    js_cm_flat.to_py()
                )
            `),De=re.toJs();re.destroy();const fe=new Blob([De],{type:"image/x-adobe-dng"}),le=URL.createObjectURL(fe),de=document.createElement("a");de.href=le;const Se=n.substring(0,n.lastIndexOf("."))||"image",he=O?"_wm":"";de.download=`${Se}_16bit_manual${he}.dng`,document.body.appendChild(de),de.click(),document.body.removeChild(de),URL.revokeObjectURL(le)}catch(K){console.error(K),alert("Export Failed: "+K.message)}finally{u(!1)}}};return e?c.jsxs(ml,{initialPosition:{x:window.innerWidth/2-250,y:50},onClose:t,zIndex:a,onFocus:i,className:"w-[500px] bg-white dark:bg-black border-2 border-black dark:border-white shadow-2xl rounded-none flex flex-col font-mono max-h-[90vh] overflow-y-auto",children:[c.jsxs("div",{className:"flex justify-between items-center px-4 py-2 border-b-2 border-black dark:border-gray-500 bg-gray-200 dark:bg-gray-800",children:[c.jsx("h3",{className:"text-sm font-bold text-black dark:text-white uppercase tracking-widest",children:"16-bit DNG Workstation"}),c.jsx("button",{onClick:t,className:"text-black dark:text-white hover:text-red-600 transition-colors",children:c.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:3,d:"M6 18L18 6M6 6l12 12"})})})]}),c.jsx("div",{className:"p-6 flex flex-col gap-6",children:o?c.jsxs("div",{className:"flex flex-col items-center justify-center py-10 gap-4",children:[c.jsx("div",{className:"w-8 h-8 border-4 border-black dark:border-white border-t-transparent animate-spin"}),c.jsx("p",{className:"text-xs font-bold text-gray-500 animate-pulse"})]}):c.jsxs(c.Fragment,{children:[c.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[c.jsxs("div",{className:"flex flex-col gap-1",children:[c.jsx("label",{className:"text-[10px] font-bold text-gray-500 dark:text-gray-400 uppercase",children:"Width (Read Only)"}),c.jsx("input",{type:"text",readOnly:!0,value:(r==null?void 0:r.width)||0,className:"w-full bg-gray-100 dark:bg-gray-900 border border-black dark:border-gray-600 px-2 py-1 text-sm text-gray-400"})]}),c.jsxs("div",{className:"flex flex-col gap-1",children:[c.jsx("label",{className:"text-[10px] font-bold text-gray-500 dark:text-gray-400 uppercase",children:"Height (Read Only)"}),c.jsx("input",{type:"text",readOnly:!0,value:(r==null?void 0:r.height)||0,className:"w-full bg-gray-100 dark:bg-gray-900 border border-black dark:border-gray-600 px-2 py-1 text-sm text-gray-400"})]})]}),c.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[c.jsxs("div",{className:"col-span-1 flex flex-col gap-1",children:[c.jsx("label",{className:"text-[10px] font-bold text-cyan-600 dark:text-cyan-400 uppercase",children:"Bit Shift (<<)"}),c.jsx("input",{type:"number",value:b,onChange:K=>w(parseInt(K.target.value)||0),className:"w-full bg-white dark:bg-gray-800 border-2 border-black dark:border-gray-500 px-2 py-1 text-sm font-bold"})]}),c.jsxs("div",{className:"col-span-1 flex flex-col gap-1",children:[c.jsx("label",{className:"text-[10px] font-bold text-emerald-600 dark:text-emerald-400 uppercase",children:"Offset (+)"}),c.jsx("input",{type:"number",value:v,onChange:K=>x(parseInt(K.target.value)||0),className:"w-full bg-white dark:bg-gray-800 border-2 border-black dark:border-gray-500 px-2 py-1 text-sm font-bold"})]}),c.jsxs("div",{className:"col-span-1 flex flex-col gap-1",children:[c.jsx("label",{className:"text-[10px] font-bold text-gray-600 dark:text-gray-400 uppercase",children:"Pattern"}),c.jsxs("select",{value:S,onChange:K=>M(K.target.value),className:"w-full bg-white dark:bg-gray-800 border-2 border-black dark:border-gray-500 px-1 py-1 text-sm font-bold",children:[c.jsx("option",{value:"RGGB",children:"RGGB"}),c.jsx("option",{value:"BGGR",children:"BGGR"}),c.jsx("option",{value:"GBRG",children:"GBRG"}),c.jsx("option",{value:"GRBG",children:"GRBG"})]})]})]}),c.jsx("div",{className:"mt-[-10px] grid grid-cols-3 gap-4",children:c.jsx("div",{className:"text-[9px] text-gray-400 dark:text-gray-500 col-span-2",children:"Shift: 4=12bit(x16), 2=14bit(x4). Added after shift."})}),c.jsxs("div",{className:"flex flex-col gap-1",children:[c.jsx("label",{className:"text-[10px] font-bold text-indigo-600 dark:text-indigo-400 uppercase",children:"16bit Black Level (Manual Fill)"}),c.jsx("input",{type:"text",value:m,onChange:K=>k(K.target.value),placeholder:"R G1 B G2",className:"w-full bg-white dark:bg-gray-800 border-2 border-black dark:border-gray-500 px-2 py-1 text-sm font-bold font-mono placeholder:font-normal placeholder:text-gray-400"})]}),c.jsxs("div",{className:"flex flex-col gap-1",children:[c.jsxs("div",{className:"flex justify-between items-end",children:[c.jsx("label",{className:"text-[10px] font-bold text-gray-500 dark:text-gray-400 uppercase",children:"Color Matrix (XYZ to Raw - 9 Values)"}),c.jsxs("select",{className:"text-[10px] bg-gray-100 dark:bg-gray-800 border border-black dark:border-gray-500 rounded-none px-1 py-0.5 max-w-[180px] cursor-pointer",onChange:K=>{const Q=hu[K.target.value];Q&&j(Q),K.target.value=""},defaultValue:"",children:[c.jsx("option",{value:"",disabled:!0,children:"Select Camera Preset..."}),U.map(K=>c.jsx("option",{value:K,children:K},K))]})]}),c.jsx("textarea",{value:P,onChange:K=>j(K.target.value),placeholder:"e.g. 0.94 -0.39 -0.07 -0.28 1.09 0.22 -0.01 0.09 0.57",className:"w-full h-20 bg-white dark:bg-gray-800 border-2 border-black dark:border-gray-500 px-2 py-1 text-xs font-mono resize-none placeholder:font-normal placeholder:text-gray-400"}),c.jsx("span",{className:"text-[8px] text-gray-400 mt-0.5",children:"Enter 9 numbers separated by space or comma."})]}),c.jsxs("div",{className:"border border-gray-300 dark:border-gray-700 bg-gray-50 dark:bg-gray-900 rounded p-3",children:[c.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[c.jsx("input",{type:"checkbox",id:"enableWatermark",checked:O,onChange:K=>E(K.target.checked),className:"rounded border-gray-300 text-indigo-600 focus:ring-indigo-500"}),c.jsx("label",{htmlFor:"enableWatermark",className:"text-xs font-bold text-gray-700 dark:text-gray-300 select-none",children:"Add Watermark: (C)  y-g-jiang.github.io"})]}),O&&c.jsxs("div",{className:"space-y-2 animate-in slide-in-from-top-1",children:[c.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[c.jsxs("div",{className:"flex flex-col gap-1",children:[c.jsx("label",{className:"text-[9px] font-bold text-gray-500 dark:text-gray-400 uppercase",children:"Size (px)"}),c.jsx("input",{type:"number",value:I,onChange:K=>D(Math.max(10,parseInt(K.target.value)||10)),className:"w-full bg-white dark:bg-gray-800 border border-gray-400 dark:border-gray-600 px-2 py-1 text-xs"})]}),c.jsxs("div",{className:"flex flex-col gap-1",children:[c.jsx("label",{className:"text-[9px] font-bold text-gray-500 dark:text-gray-400 uppercase",children:"Depth (Shift DN)"}),c.jsx("input",{type:"number",value:B,onChange:K=>z(parseInt(K.target.value)||0),className:"w-full bg-white dark:bg-gray-800 border border-gray-400 dark:border-gray-600 px-2 py-1 text-xs",placeholder:"+/- value"})]})]}),c.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[c.jsxs("div",{className:"flex flex-col gap-1",children:[c.jsx("label",{className:"text-[9px] font-bold text-gray-500 dark:text-gray-400 uppercase",children:"Center X"}),c.jsx("input",{type:"number",value:Y,onChange:K=>G(parseInt(K.target.value)||0),className:"w-full bg-white dark:bg-gray-800 border border-gray-400 dark:border-gray-600 px-2 py-1 text-xs"})]}),c.jsxs("div",{className:"flex flex-col gap-1",children:[c.jsx("label",{className:"text-[9px] font-bold text-gray-500 dark:text-gray-400 uppercase",children:"Center Y"}),c.jsx("input",{type:"number",value:$,onChange:K=>L(parseInt(K.target.value)||0),className:"w-full bg-white dark:bg-gray-800 border border-gray-400 dark:border-gray-600 px-2 py-1 text-xs"})]})]})]})]}),c.jsxs("div",{className:"flex gap-2",children:[c.jsx("input",{type:"file",ref:g,multiple:!0,className:"hidden",accept:".arw,.cr2,.cr3,.dng,.nef,.orf,.raf,.rw2,.pef,.srw,.sr2,.srf,.x3f,.erf,.mef,.mos,.mrw,.kdc,.dcr,.iiq,.3fr,.fff,.rwl,.nrw,.raw,.tif,.tiff",onChange:V}),c.jsx("button",{onClick:()=>{var K;return(K=g.current)==null?void 0:K.click()},disabled:l,className:"flex-1 py-4 text-sm font-bold uppercase tracking-widest transition-all shadow-[4px_4px_0px_black] active:shadow-none active:translate-x-1 active:translate-y-1 bg-white dark:bg-slate-800 border-2 border-black dark:border-white text-black dark:text-white hover:bg-gray-100 dark:hover:bg-slate-700",children:"Batch Export (Files)"}),c.jsx("button",{onClick:J,disabled:l,className:`flex-[2] py-4 text-sm font-bold uppercase tracking-widest transition-all shadow-[4px_4px_0px_black] active:shadow-none active:translate-x-1 active:translate-y-1 ${l?"bg-gray-400 cursor-wait":"bg-cyan-600 hover:bg-cyan-500 text-white border-2 border-black"}`,children:l?"Processing...":"Export Single"})]}),d&&c.jsx("div",{className:"text-center text-xs font-bold text-cyan-600 dark:text-cyan-400 animate-pulse",children:d})]})})]}):null};async function NO(e={}){var yd,A0,T0;var t,r=e,n=!!globalThis.window,a=!!globalThis.WorkerGlobalScope,i=((A0=(yd=globalThis.process)==null?void 0:yd.versions)==null?void 0:A0.node)&&((T0=globalThis.process)==null?void 0:T0.type)!="renderer";if(i){const{createRequire:p}=await N_(()=>import("./__vite-browser-external-BIHI7g3E.js"),[]);var o=p(import.meta.url)}var s="./this.program",l=(p,y)=>{throw y},u=import.meta.url,d="";function f(p){return r.locateFile?r.locateFile(p,d):d+p}var h,g;if(i){var b=o("fs");u.startsWith("file:")&&(d=o("path").dirname(o("url").fileURLToPath(u))+"/"),g=p=>{p=k(p)?new URL(p):p;var y=b.readFileSync(p);return y},h=async(p,y=!0)=>{p=k(p)?new URL(p):p;var C=b.readFileSync(p,y?void 0:"utf8");return C},process.argv.length>1&&(s=process.argv[1].replace(/\\/g,"/")),process.argv.slice(2),l=(p,y)=>{throw process.exitCode=p,y}}else if(n||a){try{d=new URL(".",u).href}catch{}a&&(g=p=>{var y=new XMLHttpRequest;return y.open("GET",p,!1),y.responseType="arraybuffer",y.send(null),new Uint8Array(y.response)}),h=async p=>{if(k(p))return new Promise((C,N)=>{var R=new XMLHttpRequest;R.open("GET",p,!0),R.responseType="arraybuffer",R.onload=()=>{if(R.status==200||R.status==0&&R.response){C(R.response);return}N(R.status)},R.onerror=N,R.send(null)});var y=await fetch(p,{credentials:"same-origin"});if(y.ok)return y.arrayBuffer();throw new Error(y.status+" : "+y.url)}}var w=console.log.bind(console),v=console.error.bind(console),x,m=!1,k=p=>p.startsWith("file://"),P,j,S,M,O,E,I,D,B,z,Y,G,$=!1;function L(){var p=jc.buffer;S=new Int8Array(p),O=new Int16Array(p),M=new Uint8Array(p),E=new Uint16Array(p),I=new Int32Array(p),D=new Uint32Array(p),B=new Float32Array(p),z=new Float64Array(p),Y=new BigInt64Array(p),G=new BigUint64Array(p)}function U(){if(r.preRun)for(typeof r.preRun=="function"&&(r.preRun=[r.preRun]);r.preRun.length;)ye(r.preRun.shift());Se(ve)}function V(){$=!0,!r.noFSInit&&!A.initialized&&A.init(),fi.da(),A.ignorePermissions=!1}function J(){if(r.postRun)for(typeof r.postRun=="function"&&(r.postRun=[r.postRun]);r.postRun.length;)Pe(r.postRun.shift());Se(he)}function K(p){var C;(C=r.onAbort)==null||C.call(r,p),p="Aborted("+p+")",v(p),m=!0,p+=". Build with -sASSERTIONS for more info.";var y=new WebAssembly.RuntimeError(p);throw j==null||j(y),y}var Q;function te(){return r.locateFile?f("joraw.wasm"):new URL("/assets/joraw-DraTMNgX.wasm",import.meta.url).href}function ee(p){if(p==Q&&x)return new Uint8Array(x);if(g)return g(p);throw"both async and sync fetching of the wasm failed"}async function me(p){if(!x)try{var y=await h(p);return new Uint8Array(y)}catch{}return ee(p)}async function re(p,y){try{var C=await me(p),N=await WebAssembly.instantiate(C,y);return N}catch(R){v(`failed to asynchronously prepare wasm: ${R}`),K(R)}}async function De(p,y,C){if(!p&&!k(y)&&!i)try{var N=fetch(y,{credentials:"same-origin"}),R=await WebAssembly.instantiateStreaming(N,C);return R}catch(H){v(`wasm streaming compile failed: ${H}`),v("falling back to ArrayBuffer instantiation")}return re(y,C)}function fe(){var p={a:Um};return p}async function le(){function p(H,ne){return fi=H.exports,fi=Sl(fi),Gm(fi),L(),fi}function y(H){return p(H.instance)}var C=fe();if(r.instantiateWasm)return new Promise((H,ne)=>{r.instantiateWasm(C,(se,pe)=>{H(p(se))})});Q??(Q=te());var N=await De(x,Q,C),R=y(N);return R}class de{constructor(y){Xt(this,"name","ExitStatus");this.message=`Program terminated with exit(${y})`,this.status=y}}var Se=p=>{for(;p.length>0;)p.shift()(r)},he=[],Pe=p=>he.push(p),ve=[],ye=p=>ve.push(p),ge=!0,ue=p=>C0(p),Le=()=>M0(),rt=9007199254740992,et=-9007199254740992,tt=p=>p<et||p>rt?NaN:Number(p),ft=globalThis.TextDecoder&&new TextDecoder,wt=(p,y,C,N)=>{var R=y+C;if(N)return R;for(;p[y]&&!(y>=R);)++y;return y},fr=(p,y=0,C,N)=>{y>>>=0;var R=wt(p,y,C,N);if(R-y>16&&p.buffer&&ft)return ft.decode(p.subarray(y,R));for(var H="";y<R;){var ne=p[y++];if(!(ne&128)){H+=String.fromCharCode(ne);continue}var se=p[y++]&63;if((ne&224)==192){H+=String.fromCharCode((ne&31)<<6|se);continue}var pe=p[y++]&63;if((ne&240)==224?ne=(ne&15)<<12|se<<6|pe:ne=(ne&7)<<18|se<<12|pe<<6|p[y++]&63,ne<65536)H+=String.fromCharCode(ne);else{var Be=ne-65536;H+=String.fromCharCode(55296|Be>>10,56320|Be&1023)}}return H},Wt=(p,y,C)=>(p>>>=0,p?fr(M,p,y,C):"");function kt(p,y,C,N){return p>>>=0,y>>>=0,N>>>=0,K(`Assertion failed: ${Wt(p)}, at: `+[y?Wt(y):"unknown filename",C,N?Wt(N):"unknown function"])}class Bt{constructor(y){this.excPtr=y,this.ptr=y-24}set_type(y){D[this.ptr+4>>>2>>>0]=y}get_type(){return D[this.ptr+4>>>2>>>0]}set_destructor(y){D[this.ptr+8>>>2>>>0]=y}get_destructor(){return D[this.ptr+8>>>2>>>0]}set_caught(y){y=y?1:0,S[this.ptr+12>>>0]=y}get_caught(){return S[this.ptr+12>>>0]!=0}set_rethrown(y){y=y?1:0,S[this.ptr+13>>>0]=y}get_rethrown(){return S[this.ptr+13>>>0]!=0}init(y,C){this.set_adjusted_ptr(0),this.set_type(y),this.set_destructor(C)}set_adjusted_ptr(y){D[this.ptr+16>>>2>>>0]=y}get_adjusted_ptr(){return D[this.ptr+16>>>2>>>0]}}var Sr=0;function Gr(p,y,C){p>>>=0,y>>>=0,C>>>=0;var N=new Bt(p);throw N.init(y,C),Sr=p,Sr}var rr=()=>{var p=I[+Ge.varargs>>>2>>>0];return Ge.varargs+=4,p},Nr=rr,nt={isAbs:p=>p.charAt(0)==="/",splitPath:p=>{var y=/^(\/?|)([\s\S]*?)((?:\.{1,2}|[^\/]+?|)(\.[^.\/]*|))(?:[\/]*)$/;return y.exec(p).slice(1)},normalizeArray:(p,y)=>{for(var C=0,N=p.length-1;N>=0;N--){var R=p[N];R==="."?p.splice(N,1):R===".."?(p.splice(N,1),C++):C&&(p.splice(N,1),C--)}if(y)for(;C;C--)p.unshift("..");return p},normalize:p=>{var y=nt.isAbs(p),C=p.slice(-1)==="/";return p=nt.normalizeArray(p.split("/").filter(N=>!!N),!y).join("/"),!p&&!y&&(p="."),p&&C&&(p+="/"),(y?"/":"")+p},dirname:p=>{var y=nt.splitPath(p),C=y[0],N=y[1];return!C&&!N?".":(N&&(N=N.slice(0,-1)),C+N)},basename:p=>p&&p.match(/([^\/]+|\/)\/*$/)[1],join:(...p)=>nt.normalize(p.join("/")),join2:(p,y)=>nt.normalize(p+"/"+y)},Ot=()=>{if(i){var p=o("crypto");return y=>p.randomFillSync(y)}return y=>crypto.getRandomValues(y)},pr=p=>{(pr=Ot())(p)},br={resolve:(...p)=>{for(var y="",C=!1,N=p.length-1;N>=-1&&!C;N--){var R=N>=0?p[N]:A.cwd();if(typeof R!="string")throw new TypeError("Arguments to path.resolve must be strings");if(!R)return"";y=R+"/"+y,C=nt.isAbs(R)}return y=nt.normalizeArray(y.split("/").filter(H=>!!H),!C).join("/"),(C?"/":"")+y||"."},relative:(p,y)=>{p=br.resolve(p).slice(1),y=br.resolve(y).slice(1);function C(Be){for(var it=0;it<Be.length&&Be[it]==="";it++);for(var mt=Be.length-1;mt>=0&&Be[mt]==="";mt--);return it>mt?[]:Be.slice(it,mt-it+1)}for(var N=C(p.split("/")),R=C(y.split("/")),H=Math.min(N.length,R.length),ne=H,se=0;se<H;se++)if(N[se]!==R[se]){ne=se;break}for(var pe=[],se=ne;se<N.length;se++)pe.push("..");return pe=pe.concat(R.slice(ne)),pe.join("/")}},jr=[],Rr=p=>{for(var y=0,C=0;C<p.length;++C){var N=p.charCodeAt(C);N<=127?y++:N<=2047?y+=2:N>=55296&&N<=57343?(y+=4,++C):y+=3}return y},Pr=(p,y,C,N)=>{if(C>>>=0,!(N>0))return 0;for(var R=C,H=C+N-1,ne=0;ne<p.length;++ne){var se=p.codePointAt(ne);if(se<=127){if(C>=H)break;y[C++>>>0]=se}else if(se<=2047){if(C+1>=H)break;y[C++>>>0]=192|se>>6,y[C++>>>0]=128|se&63}else if(se<=65535){if(C+2>=H)break;y[C++>>>0]=224|se>>12,y[C++>>>0]=128|se>>6&63,y[C++>>>0]=128|se&63}else{if(C+3>=H)break;y[C++>>>0]=240|se>>18,y[C++>>>0]=128|se>>12&63,y[C++>>>0]=128|se>>6&63,y[C++>>>0]=128|se&63,ne++}}return y[C>>>0]=0,C-R},Kt=(p,y,C)=>{var N=Rr(p)+1,R=new Array(N),H=Pr(p,R,0,R.length);return R.length=H,R},Er=()=>{var H;if(!jr.length){var p=null;if(i){var y=256,C=Buffer.alloc(y),N=0,R=process.stdin.fd;try{N=b.readSync(R,C,0,y)}catch(ne){if(ne.toString().includes("EOF"))N=0;else throw ne}N>0&&(p=C.slice(0,N).toString("utf-8"))}else(H=globalThis.window)!=null&&H.prompt&&(p=window.prompt("Input: "),p!==null&&(p+=`
`));if(!p)return null;jr=Kt(p)}return jr.shift()},jt={ttys:[],init(){},shutdown(){},register(p,y){jt.ttys[p]={input:[],output:[],ops:y},A.registerDevice(p,jt.stream_ops)},stream_ops:{open(p){var y=jt.ttys[p.node.rdev];if(!y)throw new A.ErrnoError(43);p.tty=y,p.seekable=!1},close(p){p.tty.ops.fsync(p.tty)},fsync(p){p.tty.ops.fsync(p.tty)},read(p,y,C,N,R){if(!p.tty||!p.tty.ops.get_char)throw new A.ErrnoError(60);for(var H=0,ne=0;ne<N;ne++){var se;try{se=p.tty.ops.get_char(p.tty)}catch{throw new A.ErrnoError(29)}if(se===void 0&&H===0)throw new A.ErrnoError(6);if(se==null)break;H++,y[C+ne]=se}return H&&(p.node.atime=Date.now()),H},write(p,y,C,N,R){if(!p.tty||!p.tty.ops.put_char)throw new A.ErrnoError(60);try{for(var H=0;H<N;H++)p.tty.ops.put_char(p.tty,y[C+H])}catch{throw new A.ErrnoError(29)}return N&&(p.node.mtime=p.node.ctime=Date.now()),H}},default_tty_ops:{get_char(p){return Er()},put_char(p,y){y===null||y===10?(w(fr(p.output)),p.output=[]):y!=0&&p.output.push(y)},fsync(p){var y;((y=p.output)==null?void 0:y.length)>0&&(w(fr(p.output)),p.output=[])},ioctl_tcgets(p){return{c_iflag:25856,c_oflag:5,c_cflag:191,c_lflag:35387,c_cc:[3,28,127,21,4,0,1,0,17,19,26,0,18,15,23,22,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]}},ioctl_tcsets(p,y,C){return 0},ioctl_tiocgwinsz(p){return[24,80]}},default_tty1_ops:{put_char(p,y){y===null||y===10?(v(fr(p.output)),p.output=[]):y!=0&&p.output.push(y)},fsync(p){var y;((y=p.output)==null?void 0:y.length)>0&&(v(fr(p.output)),p.output=[])}}},Me=p=>{K()},X={ops_table:null,mount(p){return X.createNode(null,"/",16895,0)},createNode(p,y,C,N){if(A.isBlkdev(C)||A.isFIFO(C))throw new A.ErrnoError(63);X.ops_table||(X.ops_table={dir:{node:{getattr:X.node_ops.getattr,setattr:X.node_ops.setattr,lookup:X.node_ops.lookup,mknod:X.node_ops.mknod,rename:X.node_ops.rename,unlink:X.node_ops.unlink,rmdir:X.node_ops.rmdir,readdir:X.node_ops.readdir,symlink:X.node_ops.symlink},stream:{llseek:X.stream_ops.llseek}},file:{node:{getattr:X.node_ops.getattr,setattr:X.node_ops.setattr},stream:{llseek:X.stream_ops.llseek,read:X.stream_ops.read,write:X.stream_ops.write,mmap:X.stream_ops.mmap,msync:X.stream_ops.msync}},link:{node:{getattr:X.node_ops.getattr,setattr:X.node_ops.setattr,readlink:X.node_ops.readlink},stream:{}},chrdev:{node:{getattr:X.node_ops.getattr,setattr:X.node_ops.setattr},stream:A.chrdev_stream_ops}});var R=A.createNode(p,y,C,N);return A.isDir(R.mode)?(R.node_ops=X.ops_table.dir.node,R.stream_ops=X.ops_table.dir.stream,R.contents={}):A.isFile(R.mode)?(R.node_ops=X.ops_table.file.node,R.stream_ops=X.ops_table.file.stream,R.usedBytes=0,R.contents=null):A.isLink(R.mode)?(R.node_ops=X.ops_table.link.node,R.stream_ops=X.ops_table.link.stream):A.isChrdev(R.mode)&&(R.node_ops=X.ops_table.chrdev.node,R.stream_ops=X.ops_table.chrdev.stream),R.atime=R.mtime=R.ctime=Date.now(),p&&(p.contents[y]=R,p.atime=p.mtime=p.ctime=R.atime),R},getFileDataAsTypedArray(p){return p.contents?p.contents.subarray?p.contents.subarray(0,p.usedBytes):new Uint8Array(p.contents):new Uint8Array(0)},expandFileStorage(p,y){var C=p.contents?p.contents.length:0;if(!(C>=y)){var N=1024*1024;y=Math.max(y,C*(C<N?2:1.125)>>>0),C!=0&&(y=Math.max(y,256));var R=p.contents;p.contents=new Uint8Array(y),p.usedBytes>0&&p.contents.set(R.subarray(0,p.usedBytes),0)}},resizeFileStorage(p,y){if(p.usedBytes!=y)if(y==0)p.contents=null,p.usedBytes=0;else{var C=p.contents;p.contents=new Uint8Array(y),C&&p.contents.set(C.subarray(0,Math.min(y,p.usedBytes))),p.usedBytes=y}},node_ops:{getattr(p){var y={};return y.dev=A.isChrdev(p.mode)?p.id:1,y.ino=p.id,y.mode=p.mode,y.nlink=1,y.uid=0,y.gid=0,y.rdev=p.rdev,A.isDir(p.mode)?y.size=4096:A.isFile(p.mode)?y.size=p.usedBytes:A.isLink(p.mode)?y.size=p.link.length:y.size=0,y.atime=new Date(p.atime),y.mtime=new Date(p.mtime),y.ctime=new Date(p.ctime),y.blksize=4096,y.blocks=Math.ceil(y.size/y.blksize),y},setattr(p,y){for(const C of["mode","atime","mtime","ctime"])y[C]!=null&&(p[C]=y[C]);y.size!==void 0&&X.resizeFileStorage(p,y.size)},lookup(p,y){throw X.doesNotExistError||(X.doesNotExistError=new A.ErrnoError(44),X.doesNotExistError.stack="<generic error, no stack>"),X.doesNotExistError},mknod(p,y,C,N){return X.createNode(p,y,C,N)},rename(p,y,C){var N;try{N=A.lookupNode(y,C)}catch{}if(N){if(A.isDir(p.mode))for(var R in N.contents)throw new A.ErrnoError(55);A.hashRemoveNode(N)}delete p.parent.contents[p.name],y.contents[C]=p,p.name=C,y.ctime=y.mtime=p.parent.ctime=p.parent.mtime=Date.now()},unlink(p,y){delete p.contents[y],p.ctime=p.mtime=Date.now()},rmdir(p,y){var C=A.lookupNode(p,y);for(var N in C.contents)throw new A.ErrnoError(55);delete p.contents[y],p.ctime=p.mtime=Date.now()},readdir(p){return[".","..",...Object.keys(p.contents)]},symlink(p,y,C){var N=X.createNode(p,y,41471,0);return N.link=C,N},readlink(p){if(!A.isLink(p.mode))throw new A.ErrnoError(28);return p.link}},stream_ops:{read(p,y,C,N,R){var H=p.node.contents;if(R>=p.node.usedBytes)return 0;var ne=Math.min(p.node.usedBytes-R,N);if(ne>8&&H.subarray)y.set(H.subarray(R,R+ne),C);else for(var se=0;se<ne;se++)y[C+se]=H[R+se];return ne},write(p,y,C,N,R,H){if(y.buffer===S.buffer&&(H=!1),!N)return 0;var ne=p.node;if(ne.mtime=ne.ctime=Date.now(),y.subarray&&(!ne.contents||ne.contents.subarray)){if(H)return ne.contents=y.subarray(C,C+N),ne.usedBytes=N,N;if(ne.usedBytes===0&&R===0)return ne.contents=y.slice(C,C+N),ne.usedBytes=N,N;if(R+N<=ne.usedBytes)return ne.contents.set(y.subarray(C,C+N),R),N}if(X.expandFileStorage(ne,R+N),ne.contents.subarray&&y.subarray)ne.contents.set(y.subarray(C,C+N),R);else for(var se=0;se<N;se++)ne.contents[R+se]=y[C+se];return ne.usedBytes=Math.max(ne.usedBytes,R+N),N},llseek(p,y,C){var N=y;if(C===1?N+=p.position:C===2&&A.isFile(p.node.mode)&&(N+=p.node.usedBytes),N<0)throw new A.ErrnoError(28);return N},mmap(p,y,C,N,R){if(!A.isFile(p.node.mode))throw new A.ErrnoError(43);var H,ne,se=p.node.contents;if(!(R&2)&&se&&se.buffer===S.buffer)ne=!1,H=se.byteOffset;else{if(ne=!0,H=Me(),!H)throw new A.ErrnoError(48);se&&((C>0||C+y<se.length)&&(se.subarray?se=se.subarray(C,C+y):se=Array.prototype.slice.call(se,C,C+y)),S.set(se,H>>>0))}return{ptr:H,allocated:ne}},msync(p,y,C,N,R){return X.stream_ops.write(p,y,0,N,C,!1),0}}},Te=p=>{var y={r:0,"r+":2,w:577,"w+":578,a:1089,"a+":1090},C=y[p];if(typeof C>"u")throw new Error(`Unknown file open mode: ${p}`);return C},xe=(p,y)=>{var C=0;return p&&(C|=365),y&&(C|=146),C},ze=async p=>{var y=await h(p);return new Uint8Array(y)},Je=(...p)=>A.createDataFile(...p),ot=0,Pt=null,Qe=p=>{var C;if(ot--,(C=r.monitorRunDependencies)==null||C.call(r,ot),ot==0&&Pt){var y=Pt;Pt=null,y()}},_r=p=>{var y;ot++,(y=r.monitorRunDependencies)==null||y.call(r,ot)},sr=[],Jt=async(p,y)=>{typeof Browser<"u"&&Browser.init();for(var C of sr)if(C.canHandle(y))return C.handle(p,y);return p},vt=async(p,y,C,N,R,H,ne,se)=>{var pe=y?br.resolve(nt.join2(p,y)):p;_r();try{var Be=C;typeof C=="string"&&(Be=await ze(C)),Be=await Jt(Be,pe),se==null||se(),H||Je(p,y,Be,N,R,ne)}finally{Qe()}},nr=(p,y,C,N,R,H,ne,se,pe,Be)=>{vt(p,y,C,N,R,se,pe,Be).then(H).catch(ne)},A={root:null,mounts:[],devices:{},streams:[],nextInode:1,nameTable:null,currentPath:"/",initialized:!1,ignorePermissions:!0,filesystems:null,syncFSRequests:0,readFiles:{},ErrnoError:class{constructor(p){Xt(this,"name","ErrnoError");this.errno=p}},FSStream:class{constructor(){Xt(this,"shared",{})}get object(){return this.node}set object(p){this.node=p}get isRead(){return(this.flags&2097155)!==1}get isWrite(){return(this.flags&2097155)!==0}get isAppend(){return this.flags&1024}get flags(){return this.shared.flags}set flags(p){this.shared.flags=p}get position(){return this.shared.position}set position(p){this.shared.position=p}},FSNode:class{constructor(p,y,C,N){Xt(this,"node_ops",{});Xt(this,"stream_ops",{});Xt(this,"readMode",365);Xt(this,"writeMode",146);Xt(this,"mounted",null);p||(p=this),this.parent=p,this.mount=p.mount,this.id=A.nextInode++,this.name=y,this.mode=C,this.rdev=N,this.atime=this.mtime=this.ctime=Date.now()}get read(){return(this.mode&this.readMode)===this.readMode}set read(p){p?this.mode|=this.readMode:this.mode&=~this.readMode}get write(){return(this.mode&this.writeMode)===this.writeMode}set write(p){p?this.mode|=this.writeMode:this.mode&=~this.writeMode}get isFolder(){return A.isDir(this.mode)}get isDevice(){return A.isChrdev(this.mode)}},lookupPath(p,y={}){if(!p)throw new A.ErrnoError(44);y.follow_mount??(y.follow_mount=!0),nt.isAbs(p)||(p=A.cwd()+"/"+p);e:for(var C=0;C<40;C++){for(var N=p.split("/").filter(Be=>!!Be),R=A.root,H="/",ne=0;ne<N.length;ne++){var se=ne===N.length-1;if(se&&y.parent)break;if(N[ne]!=="."){if(N[ne]===".."){if(H=nt.dirname(H),A.isRoot(R)){p=H+"/"+N.slice(ne+1).join("/"),C--;continue e}else R=R.parent;continue}H=nt.join2(H,N[ne]);try{R=A.lookupNode(R,N[ne])}catch(Be){if((Be==null?void 0:Be.errno)===44&&se&&y.noent_okay)return{path:H};throw Be}if(A.isMountpoint(R)&&(!se||y.follow_mount)&&(R=R.mounted.root),A.isLink(R.mode)&&(!se||y.follow)){if(!R.node_ops.readlink)throw new A.ErrnoError(52);var pe=R.node_ops.readlink(R);nt.isAbs(pe)||(pe=nt.dirname(H)+"/"+pe),p=pe+"/"+N.slice(ne+1).join("/");continue e}}}return{path:H,node:R}}throw new A.ErrnoError(32)},getPath(p){for(var y;;){if(A.isRoot(p)){var C=p.mount.mountpoint;return y?C[C.length-1]!=="/"?`${C}/${y}`:C+y:C}y=y?`${p.name}/${y}`:p.name,p=p.parent}},hashName(p,y){for(var C=0,N=0;N<y.length;N++)C=(C<<5)-C+y.charCodeAt(N)|0;return(p+C>>>0)%A.nameTable.length},hashAddNode(p){var y=A.hashName(p.parent.id,p.name);p.name_next=A.nameTable[y],A.nameTable[y]=p},hashRemoveNode(p){var y=A.hashName(p.parent.id,p.name);if(A.nameTable[y]===p)A.nameTable[y]=p.name_next;else for(var C=A.nameTable[y];C;){if(C.name_next===p){C.name_next=p.name_next;break}C=C.name_next}},lookupNode(p,y){var C=A.mayLookup(p);if(C)throw new A.ErrnoError(C);for(var N=A.hashName(p.id,y),R=A.nameTable[N];R;R=R.name_next){var H=R.name;if(R.parent.id===p.id&&H===y)return R}return A.lookup(p,y)},createNode(p,y,C,N){var R=new A.FSNode(p,y,C,N);return A.hashAddNode(R),R},destroyNode(p){A.hashRemoveNode(p)},isRoot(p){return p===p.parent},isMountpoint(p){return!!p.mounted},isFile(p){return(p&61440)===32768},isDir(p){return(p&61440)===16384},isLink(p){return(p&61440)===40960},isChrdev(p){return(p&61440)===8192},isBlkdev(p){return(p&61440)===24576},isFIFO(p){return(p&61440)===4096},isSocket(p){return(p&49152)===49152},flagsToPermissionString(p){var y=["r","w","rw"][p&3];return p&512&&(y+="w"),y},nodePermissions(p,y){return A.ignorePermissions?0:y.includes("r")&&!(p.mode&292)||y.includes("w")&&!(p.mode&146)||y.includes("x")&&!(p.mode&73)?2:0},mayLookup(p){if(!A.isDir(p.mode))return 54;var y=A.nodePermissions(p,"x");return y||(p.node_ops.lookup?0:2)},mayCreate(p,y){if(!A.isDir(p.mode))return 54;try{var C=A.lookupNode(p,y);return 20}catch{}return A.nodePermissions(p,"wx")},mayDelete(p,y,C){var N;try{N=A.lookupNode(p,y)}catch(H){return H.errno}var R=A.nodePermissions(p,"wx");if(R)return R;if(C){if(!A.isDir(N.mode))return 54;if(A.isRoot(N)||A.getPath(N)===A.cwd())return 10}else if(A.isDir(N.mode))return 31;return 0},mayOpen(p,y){return p?A.isLink(p.mode)?32:A.isDir(p.mode)&&(A.flagsToPermissionString(y)!=="r"||y&576)?31:A.nodePermissions(p,A.flagsToPermissionString(y)):44},checkOpExists(p,y){if(!p)throw new A.ErrnoError(y);return p},MAX_OPEN_FDS:4096,nextfd(){for(var p=0;p<=A.MAX_OPEN_FDS;p++)if(!A.streams[p])return p;throw new A.ErrnoError(33)},getStreamChecked(p){var y=A.getStream(p);if(!y)throw new A.ErrnoError(8);return y},getStream:p=>A.streams[p],createStream(p,y=-1){return p=Object.assign(new A.FSStream,p),y==-1&&(y=A.nextfd()),p.fd=y,A.streams[y]=p,p},closeStream(p){A.streams[p]=null},dupStream(p,y=-1){var N,R;var C=A.createStream(p,y);return(R=(N=C.stream_ops)==null?void 0:N.dup)==null||R.call(N,C),C},doSetAttr(p,y,C){var N=p==null?void 0:p.stream_ops.setattr,R=N?p:y;N??(N=y.node_ops.setattr),A.checkOpExists(N,63),N(R,C)},chrdev_stream_ops:{open(p){var C,N;var y=A.getDevice(p.node.rdev);p.stream_ops=y.stream_ops,(N=(C=p.stream_ops).open)==null||N.call(C,p)},llseek(){throw new A.ErrnoError(70)}},major:p=>p>>8,minor:p=>p&255,makedev:(p,y)=>p<<8|y,registerDevice(p,y){A.devices[p]={stream_ops:y}},getDevice:p=>A.devices[p],getMounts(p){for(var y=[],C=[p];C.length;){var N=C.pop();y.push(N),C.push(...N.mounts)}return y},syncfs(p,y){typeof p=="function"&&(y=p,p=!1),A.syncFSRequests++,A.syncFSRequests>1&&v(`warning: ${A.syncFSRequests} FS.syncfs operations in flight at once, probably just doing extra work`);var C=A.getMounts(A.root.mount),N=0;function R(se){return A.syncFSRequests--,y(se)}function H(se){if(se)return H.errored?void 0:(H.errored=!0,R(se));++N>=C.length&&R(null)}for(var ne of C)ne.type.syncfs?ne.type.syncfs(ne,p,H):H(null)},mount(p,y,C){var N=C==="/",R=!C,H;if(N&&A.root)throw new A.ErrnoError(10);if(!N&&!R){var ne=A.lookupPath(C,{follow_mount:!1});if(C=ne.path,H=ne.node,A.isMountpoint(H))throw new A.ErrnoError(10);if(!A.isDir(H.mode))throw new A.ErrnoError(54)}var se={type:p,opts:y,mountpoint:C,mounts:[]},pe=p.mount(se);return pe.mount=se,se.root=pe,N?A.root=pe:H&&(H.mounted=se,H.mount&&H.mount.mounts.push(se)),pe},unmount(p){var y=A.lookupPath(p,{follow_mount:!1});if(!A.isMountpoint(y.node))throw new A.ErrnoError(28);var C=y.node,N=C.mounted,R=A.getMounts(N);for(var[H,ne]of Object.entries(A.nameTable))for(;ne;){var se=ne.name_next;R.includes(ne.mount)&&A.destroyNode(ne),ne=se}C.mounted=null;var pe=C.mount.mounts.indexOf(N);C.mount.mounts.splice(pe,1)},lookup(p,y){return p.node_ops.lookup(p,y)},mknod(p,y,C){var N=A.lookupPath(p,{parent:!0}),R=N.node,H=nt.basename(p);if(!H)throw new A.ErrnoError(28);if(H==="."||H==="..")throw new A.ErrnoError(20);var ne=A.mayCreate(R,H);if(ne)throw new A.ErrnoError(ne);if(!R.node_ops.mknod)throw new A.ErrnoError(63);return R.node_ops.mknod(R,H,y,C)},statfs(p){return A.statfsNode(A.lookupPath(p,{follow:!0}).node)},statfsStream(p){return A.statfsNode(p.node)},statfsNode(p){var y={bsize:4096,frsize:4096,blocks:1e6,bfree:5e5,bavail:5e5,files:A.nextInode,ffree:A.nextInode-1,fsid:42,flags:2,namelen:255};return p.node_ops.statfs&&Object.assign(y,p.node_ops.statfs(p.mount.opts.root)),y},create(p,y=438){return y&=4095,y|=32768,A.mknod(p,y,0)},mkdir(p,y=511){return y&=1023,y|=16384,A.mknod(p,y,0)},mkdirTree(p,y){var C=p.split("/"),N="";for(var R of C)if(R){(N||nt.isAbs(p))&&(N+="/"),N+=R;try{A.mkdir(N,y)}catch(H){if(H.errno!=20)throw H}}},mkdev(p,y,C){return typeof C>"u"&&(C=y,y=438),y|=8192,A.mknod(p,y,C)},symlink(p,y){if(!br.resolve(p))throw new A.ErrnoError(44);var C=A.lookupPath(y,{parent:!0}),N=C.node;if(!N)throw new A.ErrnoError(44);var R=nt.basename(y),H=A.mayCreate(N,R);if(H)throw new A.ErrnoError(H);if(!N.node_ops.symlink)throw new A.ErrnoError(63);return N.node_ops.symlink(N,R,p)},rename(p,y){var C=nt.dirname(p),N=nt.dirname(y),R=nt.basename(p),H=nt.basename(y),ne,se,pe;if(ne=A.lookupPath(p,{parent:!0}),se=ne.node,ne=A.lookupPath(y,{parent:!0}),pe=ne.node,!se||!pe)throw new A.ErrnoError(44);if(se.mount!==pe.mount)throw new A.ErrnoError(75);var Be=A.lookupNode(se,R),it=br.relative(p,N);if(it.charAt(0)!==".")throw new A.ErrnoError(28);if(it=br.relative(y,C),it.charAt(0)!==".")throw new A.ErrnoError(55);var mt;try{mt=A.lookupNode(pe,H)}catch{}if(Be!==mt){var ht=A.isDir(Be.mode),Ye=A.mayDelete(se,R,ht);if(Ye)throw new A.ErrnoError(Ye);if(Ye=mt?A.mayDelete(pe,H,ht):A.mayCreate(pe,H),Ye)throw new A.ErrnoError(Ye);if(!se.node_ops.rename)throw new A.ErrnoError(63);if(A.isMountpoint(Be)||mt&&A.isMountpoint(mt))throw new A.ErrnoError(10);if(pe!==se&&(Ye=A.nodePermissions(se,"w"),Ye))throw new A.ErrnoError(Ye);A.hashRemoveNode(Be);try{se.node_ops.rename(Be,pe,H),Be.parent=pe}catch(ir){throw ir}finally{A.hashAddNode(Be)}}},rmdir(p){var y=A.lookupPath(p,{parent:!0}),C=y.node,N=nt.basename(p),R=A.lookupNode(C,N),H=A.mayDelete(C,N,!0);if(H)throw new A.ErrnoError(H);if(!C.node_ops.rmdir)throw new A.ErrnoError(63);if(A.isMountpoint(R))throw new A.ErrnoError(10);C.node_ops.rmdir(C,N),A.destroyNode(R)},readdir(p){var y=A.lookupPath(p,{follow:!0}),C=y.node,N=A.checkOpExists(C.node_ops.readdir,54);return N(C)},unlink(p){var y=A.lookupPath(p,{parent:!0}),C=y.node;if(!C)throw new A.ErrnoError(44);var N=nt.basename(p),R=A.lookupNode(C,N),H=A.mayDelete(C,N,!1);if(H)throw new A.ErrnoError(H);if(!C.node_ops.unlink)throw new A.ErrnoError(63);if(A.isMountpoint(R))throw new A.ErrnoError(10);C.node_ops.unlink(C,N),A.destroyNode(R)},readlink(p){var y=A.lookupPath(p),C=y.node;if(!C)throw new A.ErrnoError(44);if(!C.node_ops.readlink)throw new A.ErrnoError(28);return C.node_ops.readlink(C)},stat(p,y){var C=A.lookupPath(p,{follow:!y}),N=C.node,R=A.checkOpExists(N.node_ops.getattr,63);return R(N)},fstat(p){var y=A.getStreamChecked(p),C=y.node,N=y.stream_ops.getattr,R=N?y:C;return N??(N=C.node_ops.getattr),A.checkOpExists(N,63),N(R)},lstat(p){return A.stat(p,!0)},doChmod(p,y,C,N){A.doSetAttr(p,y,{mode:C&4095|y.mode&-4096,ctime:Date.now(),dontFollow:N})},chmod(p,y,C){var N;if(typeof p=="string"){var R=A.lookupPath(p,{follow:!C});N=R.node}else N=p;A.doChmod(null,N,y,C)},lchmod(p,y){A.chmod(p,y,!0)},fchmod(p,y){var C=A.getStreamChecked(p);A.doChmod(C,C.node,y,!1)},doChown(p,y,C){A.doSetAttr(p,y,{timestamp:Date.now(),dontFollow:C})},chown(p,y,C,N){var R;if(typeof p=="string"){var H=A.lookupPath(p,{follow:!N});R=H.node}else R=p;A.doChown(null,R,N)},lchown(p,y,C){A.chown(p,y,C,!0)},fchown(p,y,C){var N=A.getStreamChecked(p);A.doChown(N,N.node,!1)},doTruncate(p,y,C){if(A.isDir(y.mode))throw new A.ErrnoError(31);if(!A.isFile(y.mode))throw new A.ErrnoError(28);var N=A.nodePermissions(y,"w");if(N)throw new A.ErrnoError(N);A.doSetAttr(p,y,{size:C,timestamp:Date.now()})},truncate(p,y){if(y<0)throw new A.ErrnoError(28);var C;if(typeof p=="string"){var N=A.lookupPath(p,{follow:!0});C=N.node}else C=p;A.doTruncate(null,C,y)},ftruncate(p,y){var C=A.getStreamChecked(p);if(y<0||!(C.flags&2097155))throw new A.ErrnoError(28);A.doTruncate(C,C.node,y)},utime(p,y,C){var N=A.lookupPath(p,{follow:!0}),R=N.node,H=A.checkOpExists(R.node_ops.setattr,63);H(R,{atime:y,mtime:C})},open(p,y,C=438){if(p==="")throw new A.ErrnoError(44);y=typeof y=="string"?Te(y):y,y&64?C=C&4095|32768:C=0;var N,R;if(typeof p=="object")N=p;else{R=p.endsWith("/");var H=A.lookupPath(p,{follow:!(y&131072),noent_okay:!0});N=H.node,p=H.path}var ne=!1;if(y&64)if(N){if(y&128)throw new A.ErrnoError(20)}else{if(R)throw new A.ErrnoError(31);N=A.mknod(p,C|511,0),ne=!0}if(!N)throw new A.ErrnoError(44);if(A.isChrdev(N.mode)&&(y&=-513),y&65536&&!A.isDir(N.mode))throw new A.ErrnoError(54);if(!ne){var se=A.mayOpen(N,y);if(se)throw new A.ErrnoError(se)}y&512&&!ne&&A.truncate(N,0),y&=-131713;var pe=A.createStream({node:N,path:A.getPath(N),flags:y,seekable:!0,position:0,stream_ops:N.stream_ops,ungotten:[],error:!1});return pe.stream_ops.open&&pe.stream_ops.open(pe),ne&&A.chmod(N,C&511),r.logReadFiles&&!(y&1)&&(p in A.readFiles||(A.readFiles[p]=1)),pe},close(p){if(A.isClosed(p))throw new A.ErrnoError(8);p.getdents&&(p.getdents=null);try{p.stream_ops.close&&p.stream_ops.close(p)}catch(y){throw y}finally{A.closeStream(p.fd)}p.fd=null},isClosed(p){return p.fd===null},llseek(p,y,C){if(A.isClosed(p))throw new A.ErrnoError(8);if(!p.seekable||!p.stream_ops.llseek)throw new A.ErrnoError(70);if(C!=0&&C!=1&&C!=2)throw new A.ErrnoError(28);return p.position=p.stream_ops.llseek(p,y,C),p.ungotten=[],p.position},read(p,y,C,N,R){if(N<0||R<0)throw new A.ErrnoError(28);if(A.isClosed(p))throw new A.ErrnoError(8);if((p.flags&2097155)===1)throw new A.ErrnoError(8);if(A.isDir(p.node.mode))throw new A.ErrnoError(31);if(!p.stream_ops.read)throw new A.ErrnoError(28);var H=typeof R<"u";if(!H)R=p.position;else if(!p.seekable)throw new A.ErrnoError(70);var ne=p.stream_ops.read(p,y,C,N,R);return H||(p.position+=ne),ne},write(p,y,C,N,R,H){if(N<0||R<0)throw new A.ErrnoError(28);if(A.isClosed(p))throw new A.ErrnoError(8);if(!(p.flags&2097155))throw new A.ErrnoError(8);if(A.isDir(p.node.mode))throw new A.ErrnoError(31);if(!p.stream_ops.write)throw new A.ErrnoError(28);p.seekable&&p.flags&1024&&A.llseek(p,0,2);var ne=typeof R<"u";if(!ne)R=p.position;else if(!p.seekable)throw new A.ErrnoError(70);var se=p.stream_ops.write(p,y,C,N,R,H);return ne||(p.position+=se),se},mmap(p,y,C,N,R){if(N&2&&!(R&2)&&(p.flags&2097155)!==2)throw new A.ErrnoError(2);if((p.flags&2097155)===1)throw new A.ErrnoError(2);if(!p.stream_ops.mmap)throw new A.ErrnoError(43);if(!y)throw new A.ErrnoError(28);return p.stream_ops.mmap(p,y,C,N,R)},msync(p,y,C,N,R){return p.stream_ops.msync?p.stream_ops.msync(p,y,C,N,R):0},ioctl(p,y,C){if(!p.stream_ops.ioctl)throw new A.ErrnoError(59);return p.stream_ops.ioctl(p,y,C)},readFile(p,y={}){y.flags=y.flags||0,y.encoding=y.encoding||"binary",y.encoding!=="utf8"&&y.encoding!=="binary"&&K(`Invalid encoding type "${y.encoding}"`);var C=A.open(p,y.flags),N=A.stat(p),R=N.size,H=new Uint8Array(R);return A.read(C,H,0,R,0),y.encoding==="utf8"&&(H=fr(H)),A.close(C),H},writeFile(p,y,C={}){C.flags=C.flags||577;var N=A.open(p,C.flags,C.mode);typeof y=="string"&&(y=new Uint8Array(Kt(y))),ArrayBuffer.isView(y)?A.write(N,y,0,y.byteLength,void 0,C.canOwn):K("Unsupported data type"),A.close(N)},cwd:()=>A.currentPath,chdir(p){var y=A.lookupPath(p,{follow:!0});if(y.node===null)throw new A.ErrnoError(44);if(!A.isDir(y.node.mode))throw new A.ErrnoError(54);var C=A.nodePermissions(y.node,"x");if(C)throw new A.ErrnoError(C);A.currentPath=y.path},createDefaultDirectories(){A.mkdir("/tmp"),A.mkdir("/home"),A.mkdir("/home/web_user")},createDefaultDevices(){A.mkdir("/dev"),A.registerDevice(A.makedev(1,3),{read:()=>0,write:(N,R,H,ne,se)=>ne,llseek:()=>0}),A.mkdev("/dev/null",A.makedev(1,3)),jt.register(A.makedev(5,0),jt.default_tty_ops),jt.register(A.makedev(6,0),jt.default_tty1_ops),A.mkdev("/dev/tty",A.makedev(5,0)),A.mkdev("/dev/tty1",A.makedev(6,0));var p=new Uint8Array(1024),y=0,C=()=>(y===0&&(pr(p),y=p.byteLength),p[--y]);A.createDevice("/dev","random",C),A.createDevice("/dev","urandom",C),A.mkdir("/dev/shm"),A.mkdir("/dev/shm/tmp")},createSpecialDirectories(){A.mkdir("/proc");var p=A.mkdir("/proc/self");A.mkdir("/proc/self/fd"),A.mount({mount(){var y=A.createNode(p,"fd",16895,73);return y.stream_ops={llseek:X.stream_ops.llseek},y.node_ops={lookup(C,N){var R=+N,H=A.getStreamChecked(R),ne={parent:null,mount:{mountpoint:"fake"},node_ops:{readlink:()=>H.path},id:R+1};return ne.parent=ne,ne},readdir(){return Array.from(A.streams.entries()).filter(([C,N])=>N).map(([C,N])=>C.toString())}},y}},{},"/proc/self/fd")},createStandardStreams(p,y,C){p?A.createDevice("/dev","stdin",p):A.symlink("/dev/tty","/dev/stdin"),y?A.createDevice("/dev","stdout",null,y):A.symlink("/dev/tty","/dev/stdout"),C?A.createDevice("/dev","stderr",null,C):A.symlink("/dev/tty1","/dev/stderr"),A.open("/dev/stdin",0),A.open("/dev/stdout",1),A.open("/dev/stderr",1)},staticInit(){A.nameTable=new Array(4096),A.mount(X,{},"/"),A.createDefaultDirectories(),A.createDefaultDevices(),A.createSpecialDirectories(),A.filesystems={MEMFS:X}},init(p,y,C){A.initialized=!0,p??(p=r.stdin),y??(y=r.stdout),C??(C=r.stderr),A.createStandardStreams(p,y,C)},quit(){A.initialized=!1;for(var p of A.streams)p&&A.close(p)},findObject(p,y){var C=A.analyzePath(p,y);return C.exists?C.object:null},analyzePath(p,y){try{var C=A.lookupPath(p,{follow:!y});p=C.path}catch{}var N={isRoot:!1,exists:!1,error:0,name:null,path:null,object:null,parentExists:!1,parentPath:null,parentObject:null};try{var C=A.lookupPath(p,{parent:!0});N.parentExists=!0,N.parentPath=C.path,N.parentObject=C.node,N.name=nt.basename(p),C=A.lookupPath(p,{follow:!y}),N.exists=!0,N.path=C.path,N.object=C.node,N.name=C.node.name,N.isRoot=C.path==="/"}catch(R){N.error=R.errno}return N},createPath(p,y,C,N){p=typeof p=="string"?p:A.getPath(p);for(var R=y.split("/").reverse();R.length;){var H=R.pop();if(H){var ne=nt.join2(p,H);try{A.mkdir(ne)}catch(se){if(se.errno!=20)throw se}p=ne}}return ne},createFile(p,y,C,N,R){var H=nt.join2(typeof p=="string"?p:A.getPath(p),y),ne=xe(N,R);return A.create(H,ne)},createDataFile(p,y,C,N,R,H){var ne=y;p&&(p=typeof p=="string"?p:A.getPath(p),ne=y?nt.join2(p,y):p);var se=xe(N,R),pe=A.create(ne,se);if(C){if(typeof C=="string"){for(var Be=new Array(C.length),it=0,mt=C.length;it<mt;++it)Be[it]=C.charCodeAt(it);C=Be}A.chmod(pe,se|146);var ht=A.open(pe,577);A.write(ht,C,0,C.length,0,H),A.close(ht),A.chmod(pe,se)}},createDevice(p,y,C,N){var se;var R=nt.join2(typeof p=="string"?p:A.getPath(p),y),H=xe(!!C,!!N);(se=A.createDevice).major??(se.major=64);var ne=A.makedev(A.createDevice.major++,0);return A.registerDevice(ne,{open(pe){pe.seekable=!1},close(pe){var Be;(Be=N==null?void 0:N.buffer)!=null&&Be.length&&N(10)},read(pe,Be,it,mt,ht){for(var Ye=0,ir=0;ir<mt;ir++){var $r;try{$r=C()}catch{throw new A.ErrnoError(29)}if($r===void 0&&Ye===0)throw new A.ErrnoError(6);if($r==null)break;Ye++,Be[it+ir]=$r}return Ye&&(pe.node.atime=Date.now()),Ye},write(pe,Be,it,mt,ht){for(var Ye=0;Ye<mt;Ye++)try{N(Be[it+Ye])}catch{throw new A.ErrnoError(29)}return mt&&(pe.node.mtime=pe.node.ctime=Date.now()),Ye}}),A.mkdev(R,H,ne)},forceLoadFile(p){if(p.isDevice||p.isFolder||p.link||p.contents)return!0;if(globalThis.XMLHttpRequest)K("Lazy loading should have been performed (contents set) in createLazyFile, but it was not. Lazy loading only works in web workers. Use --embed-file or --preload-file in emcc on the main thread.");else try{p.contents=g(p.url)}catch{throw new A.ErrnoError(29)}},createLazyFile(p,y,C,N,R){class H{constructor(){Xt(this,"lengthKnown",!1);Xt(this,"chunks",[])}get(ht){if(!(ht>this.length-1||ht<0)){var Ye=ht%this.chunkSize,ir=ht/this.chunkSize|0;return this.getter(ir)[Ye]}}setDataGetter(ht){this.getter=ht}cacheLength(){var ht=new XMLHttpRequest;ht.open("HEAD",C,!1),ht.send(null),ht.status>=200&&ht.status<300||ht.status===304||K("Couldn't load "+C+". Status: "+ht.status);var Ye=Number(ht.getResponseHeader("Content-length")),ir,$r=(ir=ht.getResponseHeader("Accept-Ranges"))&&ir==="bytes",yn=(ir=ht.getResponseHeader("Content-Encoding"))&&ir==="gzip",dn=1024*1024;$r||(dn=Ye);var xa=(ei,Ki)=>{ei>Ki&&K("invalid range ("+ei+", "+Ki+") or no bytes requested!"),Ki>Ye-1&&K("only "+Ye+" bytes available! programmer error!");var Nn=new XMLHttpRequest;return Nn.open("GET",C,!1),Ye!==dn&&Nn.setRequestHeader("Range","bytes="+ei+"-"+Ki),Nn.responseType="arraybuffer",Nn.overrideMimeType&&Nn.overrideMimeType("text/plain; charset=x-user-defined"),Nn.send(null),Nn.status>=200&&Nn.status<300||Nn.status===304||K("Couldn't load "+C+". Status: "+Nn.status),Nn.response!==void 0?new Uint8Array(Nn.response||[]):Kt(Nn.responseText||"")},qn=this;qn.setDataGetter(ei=>{var Ki=ei*dn,Nn=(ei+1)*dn-1;return Nn=Math.min(Nn,Ye-1),typeof qn.chunks[ei]>"u"&&(qn.chunks[ei]=xa(Ki,Nn)),typeof qn.chunks[ei]>"u"&&K("doXHR failed!"),qn.chunks[ei]}),(yn||!Ye)&&(dn=Ye=1,Ye=this.getter(0).length,dn=Ye,w("LazyFiles on gzip forces download of the whole file when length is accessed")),this._length=Ye,this._chunkSize=dn,this.lengthKnown=!0}get length(){return this.lengthKnown||this.cacheLength(),this._length}get chunkSize(){return this.lengthKnown||this.cacheLength(),this._chunkSize}}if(globalThis.XMLHttpRequest){a||K("Cannot do synchronous binary XHRs outside webworkers in modern browsers. Use --embed-file or --preload-file in emcc");var ne=new H,se={isDevice:!1,contents:ne}}else var se={isDevice:!1,url:C};var pe=A.createFile(p,y,se,N,R);se.contents?pe.contents=se.contents:se.url&&(pe.contents=null,pe.url=se.url),Object.defineProperties(pe,{usedBytes:{get:function(){return this.contents.length}}});var Be={};for(const[mt,ht]of Object.entries(pe.stream_ops))Be[mt]=(...Ye)=>(A.forceLoadFile(pe),ht(...Ye));function it(mt,ht,Ye,ir,$r){var yn=mt.node.contents;if($r>=yn.length)return 0;var dn=Math.min(yn.length-$r,ir);if(yn.slice)for(var xa=0;xa<dn;xa++)ht[Ye+xa]=yn[$r+xa];else for(var xa=0;xa<dn;xa++)ht[Ye+xa]=yn.get($r+xa);return dn}return Be.read=(mt,ht,Ye,ir,$r)=>(A.forceLoadFile(pe),it(mt,ht,Ye,ir,$r)),Be.mmap=(mt,ht,Ye,ir,$r)=>{A.forceLoadFile(pe);var yn=Me();if(!yn)throw new A.ErrnoError(48);return it(mt,S,yn,ht,Ye),{ptr:yn,allocated:!0}},pe.stream_ops=Be,pe}},Ge={DEFAULT_POLLMASK:5,calculateAt(p,y,C){if(nt.isAbs(y))return y;var N;if(p===-100)N=A.cwd();else{var R=Ge.getStreamFromFD(p);N=R.path}if(y.length==0){if(!C)throw new A.ErrnoError(44);return N}return N+"/"+y},writeStat(p,y){D[p>>>2>>>0]=y.dev,D[p+4>>>2>>>0]=y.mode,D[p+8>>>2>>>0]=y.nlink,D[p+12>>>2>>>0]=y.uid,D[p+16>>>2>>>0]=y.gid,D[p+20>>>2>>>0]=y.rdev,Y[p+24>>>3>>>0]=BigInt(y.size),I[p+32>>>2>>>0]=4096,I[p+36>>>2>>>0]=y.blocks;var C=y.atime.getTime(),N=y.mtime.getTime(),R=y.ctime.getTime();return Y[p+40>>>3>>>0]=BigInt(Math.floor(C/1e3)),D[p+48>>>2>>>0]=C%1e3*1e3*1e3,Y[p+56>>>3>>>0]=BigInt(Math.floor(N/1e3)),D[p+64>>>2>>>0]=N%1e3*1e3*1e3,Y[p+72>>>3>>>0]=BigInt(Math.floor(R/1e3)),D[p+80>>>2>>>0]=R%1e3*1e3*1e3,Y[p+88>>>3>>>0]=BigInt(y.ino),0},writeStatFs(p,y){D[p+4>>>2>>>0]=y.bsize,D[p+60>>>2>>>0]=y.bsize,Y[p+8>>>3>>>0]=BigInt(y.blocks),Y[p+16>>>3>>>0]=BigInt(y.bfree),Y[p+24>>>3>>>0]=BigInt(y.bavail),Y[p+32>>>3>>>0]=BigInt(y.files),Y[p+40>>>3>>>0]=BigInt(y.ffree),D[p+48>>>2>>>0]=y.fsid,D[p+64>>>2>>>0]=y.flags,D[p+56>>>2>>>0]=y.namelen},doMsync(p,y,C,N,R){if(!A.isFile(y.node.mode))throw new A.ErrnoError(43);if(N&2)return 0;var H=M.slice(p,p+C);A.msync(y,H,R,C,N)},getStreamFromFD(p){var y=A.getStreamChecked(p);return y},varargs:void 0,getStr(p){var y=Wt(p);return y}};function Ke(p,y,C){C>>>=0,Ge.varargs=C;try{var N=Ge.getStreamFromFD(p);switch(y){case 0:{var R=rr();if(R<0)return-28;for(;A.streams[R];)R++;var H;return H=A.dupStream(N,R),H.fd}case 1:case 2:return 0;case 3:return N.flags;case 4:{var R=rr();return N.flags|=R,0}case 12:{var R=Nr(),ne=0;return O[R+ne>>>1>>>0]=2,0}case 13:case 14:return 0}return-28}catch(se){if(typeof A>"u"||se.name!=="ErrnoError")throw se;return-se.errno}}function Yt(p,y,C){C>>>=0,Ge.varargs=C;try{var N=Ge.getStreamFromFD(p);switch(y){case 21509:return N.tty?0:-59;case 21505:{if(!N.tty)return-59;if(N.tty.ops.ioctl_tcgets){var R=N.tty.ops.ioctl_tcgets(N),H=Nr();I[H>>>2>>>0]=R.c_iflag||0,I[H+4>>>2>>>0]=R.c_oflag||0,I[H+8>>>2>>>0]=R.c_cflag||0,I[H+12>>>2>>>0]=R.c_lflag||0;for(var ne=0;ne<32;ne++)S[H+ne+17>>>0]=R.c_cc[ne]||0;return 0}return 0}case 21510:case 21511:case 21512:return N.tty?0:-59;case 21506:case 21507:case 21508:{if(!N.tty)return-59;if(N.tty.ops.ioctl_tcsets){for(var H=Nr(),se=I[H>>>2>>>0],pe=I[H+4>>>2>>>0],Be=I[H+8>>>2>>>0],it=I[H+12>>>2>>>0],mt=[],ne=0;ne<32;ne++)mt.push(S[H+ne+17>>>0]);return N.tty.ops.ioctl_tcsets(N.tty,y,{c_iflag:se,c_oflag:pe,c_cflag:Be,c_lflag:it,c_cc:mt})}return 0}case 21519:{if(!N.tty)return-59;var H=Nr();return I[H>>>2>>>0]=0,0}case 21520:return N.tty?-28:-59;case 21537:case 21531:{var H=Nr();return A.ioctl(N,y,H)}case 21523:{if(!N.tty)return-59;if(N.tty.ops.ioctl_tiocgwinsz){var ht=N.tty.ops.ioctl_tiocgwinsz(N.tty),H=Nr();O[H>>>1>>>0]=ht[0],O[H+2>>>1>>>0]=ht[1]}return 0}case 21524:return N.tty?0:-59;case 21515:return N.tty?0:-59;default:return-28}}catch(Ye){if(typeof A>"u"||Ye.name!=="ErrnoError")throw Ye;return-Ye.errno}}function Ht(p,y,C,N){y>>>=0,N>>>=0,Ge.varargs=N;try{y=Ge.getStr(y),y=Ge.calculateAt(p,y);var R=N?rr():0;return A.open(y,C,R).fd}catch(H){if(typeof A>"u"||H.name!=="ErrnoError")throw H;return-H.errno}}function At(p){p>>>=0;try{return p=Ge.getStr(p),A.rmdir(p),0}catch(y){if(typeof A>"u"||y.name!=="ErrnoError")throw y;return-y.errno}}function yr(p,y,C){y>>>=0;try{if(y=Ge.getStr(y),y=Ge.calculateAt(p,y),!C)A.unlink(y);else if(C===512)A.rmdir(y);else return-28;return 0}catch(N){if(typeof A>"u"||N.name!=="ErrnoError")throw N;return-N.errno}}var Xr=()=>K(""),ut=p=>{p>>>=0;for(var y="";;){var C=M[p++>>>0];if(!C)return y;y+=String.fromCharCode(C)}},Dt={},Vt={},ar={},St=class extends Error{constructor(y){super(y),this.name="BindingError"}},_e=p=>{throw new St(p)};function Or(p,y,C={}){var N=y.name;if(p||_e(`type "${N}" must have a positive integer typeid pointer`),Vt.hasOwnProperty(p)){if(C.ignoreDuplicateRegistrations)return;_e(`Cannot register type '${N}' twice`)}if(Vt[p]=y,delete ar[p],Dt.hasOwnProperty(p)){var R=Dt[p];delete Dt[p],R.forEach(H=>H())}}function F(p,y,C={}){return Or(p,y,C)}var Ce=(p,y,C)=>{switch(y){case 1:return C?N=>S[N>>>0]:N=>M[N>>>0];case 2:return C?N=>O[N>>>1>>>0]:N=>E[N>>>1>>>0];case 4:return C?N=>I[N>>>2>>>0]:N=>D[N>>>2>>>0];case 8:return C?N=>Y[N>>>3>>>0]:N=>G[N>>>3>>>0];default:throw new TypeError(`invalid integer width (${y}): ${p}`)}},Ee=function(p,y,C,N,R){p>>>=0,y>>>=0,C>>>=0,y=ut(y);const H=N===0n;let ne=se=>se;if(H){const se=C*8;ne=pe=>BigInt.asUintN(se,pe),R=ne(R)}F(p,{name:y,fromWireType:ne,toWireType:(se,pe)=>(typeof pe=="number"&&(pe=BigInt(pe)),pe),readValueFromPointer:Ce(y,C,!H),destructorFunction:null})};function _t(p,y,C,N){p>>>=0,y>>>=0,y=ut(y),F(p,{name:y,fromWireType:function(R){return!!R},toWireType:function(R,H){return H?C:N},readValueFromPointer:function(R){return this.fromWireType(M[R>>>0])},destructorFunction:null})}var He=p=>({count:p.count,deleteScheduled:p.deleteScheduled,preservePointerOnDelete:p.preservePointerOnDelete,ptr:p.ptr,ptrType:p.ptrType,smartPtr:p.smartPtr,smartPtrType:p.smartPtrType}),dt=p=>{function y(C){return C.$$.ptrType.registeredClass.name}_e(y(p)+" instance already deleted")},qe=!1,Lt=p=>{},Ur=p=>{p.smartPtr?p.smartPtrType.rawDestructor(p.smartPtr):p.ptrType.registeredClass.rawDestructor(p.ptr)},Kr=p=>{p.count.value-=1;var y=p.count.value===0;y&&Ur(p)},lr=p=>globalThis.FinalizationRegistry?(qe=new FinalizationRegistry(y=>{Kr(y.$$)}),lr=y=>{var C=y.$$,N=!!C.smartPtr;if(N){var R={$$:C};qe.register(y,R,y)}return y},Lt=y=>qe.unregister(y),lr(p)):(lr=y=>y,p),kn=()=>{let p=Yr.prototype;Object.assign(p,{isAliasOf(C){if(!(this instanceof Yr)||!(C instanceof Yr))return!1;var N=this.$$.ptrType.registeredClass,R=this.$$.ptr;C.$$=C.$$;for(var H=C.$$.ptrType.registeredClass,ne=C.$$.ptr;N.baseClass;)R=N.upcast(R),N=N.baseClass;for(;H.baseClass;)ne=H.upcast(ne),H=H.baseClass;return N===H&&R===ne},clone(){if(this.$$.ptr||dt(this),this.$$.preservePointerOnDelete)return this.$$.count.value+=1,this;var C=lr(Object.create(Object.getPrototypeOf(this),{$$:{value:He(this.$$)}}));return C.$$.count.value+=1,C.$$.deleteScheduled=!1,C},delete(){this.$$.ptr||dt(this),this.$$.deleteScheduled&&!this.$$.preservePointerOnDelete&&_e("Object already scheduled for deletion"),Lt(this),Kr(this.$$),this.$$.preservePointerOnDelete||(this.$$.smartPtr=void 0,this.$$.ptr=void 0)},isDeleted(){return!this.$$.ptr},deleteLater(){return this.$$.ptr||dt(this),this.$$.deleteScheduled&&!this.$$.preservePointerOnDelete&&_e("Object already scheduled for deletion"),this.$$.deleteScheduled=!0,this}});const y=Symbol.dispose;y&&(p[y]=p.delete)};function Yr(){}var Ar=(p,y)=>Object.defineProperty(y,"name",{value:p}),cr={},Ft=(p,y,C)=>{if(p[y].overloadTable===void 0){var N=p[y];p[y]=function(...R){return p[y].overloadTable.hasOwnProperty(R.length)||_e(`Function '${C}' called with an invalid number of arguments (${R.length}) - expects one of (${p[y].overloadTable})!`),p[y].overloadTable[R.length].apply(this,R)},p[y].overloadTable=[],p[y].overloadTable[N.argCount]=N}},Br=(p,y,C)=>{r.hasOwnProperty(p)?(_e(`Cannot register public name '${p}' twice`),Ft(r,p,p),r[p].overloadTable.hasOwnProperty(C)&&_e(`Cannot register multiple overloads of a function with the same number of arguments (${C})!`),r[p].overloadTable[C]=y):(r[p]=y,r[p].argCount=C)},We=48,xr=57,mn=p=>{p=p.replace(/[^a-zA-Z0-9_]/g,"$");var y=p.charCodeAt(0);return y>=We&&y<=xr?`_${p}`:p};function sa(p,y,C,N,R,H,ne,se){this.name=p,this.constructor=y,this.instancePrototype=C,this.rawDestructor=N,this.baseClass=R,this.getActualType=H,this.upcast=ne,this.downcast=se,this.pureVirtualFunctions=[]}var Da=(p,y,C)=>{for(;y!==C;)y.upcast||_e(`Expected null or instance of ${C.name}, got an instance of ${y.name}`),p=y.upcast(p),y=y.baseClass;return p},Sn=p=>{if(p===null)return"null";var y=typeof p;return y==="object"||y==="array"||y==="function"?p.toString():""+p};function Ja(p,y){if(y===null)return this.isReference&&_e(`null is not a valid ${this.name}`),0;y.$$||_e(`Cannot pass "${Sn(y)}" as a ${this.name}`),y.$$.ptr||_e(`Cannot pass deleted object as a pointer of type ${this.name}`);var C=y.$$.ptrType.registeredClass,N=Da(y.$$.ptr,C,this.registeredClass);return N}function ce(p,y){var C;if(y===null)return this.isReference&&_e(`null is not a valid ${this.name}`),this.isSmartPointer?(C=this.rawConstructor(),p!==null&&p.push(this.rawDestructor,C),C):0;(!y||!y.$$)&&_e(`Cannot pass "${Sn(y)}" as a ${this.name}`),y.$$.ptr||_e(`Cannot pass deleted object as a pointer of type ${this.name}`),!this.isConst&&y.$$.ptrType.isConst&&_e(`Cannot convert argument of type ${y.$$.smartPtrType?y.$$.smartPtrType.name:y.$$.ptrType.name} to parameter type ${this.name}`);var N=y.$$.ptrType.registeredClass;if(C=Da(y.$$.ptr,N,this.registeredClass),this.isSmartPointer)switch(y.$$.smartPtr===void 0&&_e("Passing raw pointer to smart pointer is illegal"),this.sharingPolicy){case 0:y.$$.smartPtrType===this?C=y.$$.smartPtr:_e(`Cannot convert argument of type ${y.$$.smartPtrType?y.$$.smartPtrType.name:y.$$.ptrType.name} to parameter type ${this.name}`);break;case 1:C=y.$$.smartPtr;break;case 2:if(y.$$.smartPtrType===this)C=y.$$.smartPtr;else{var R=y.clone();C=this.rawShare(C,Zr.toHandle(()=>R.delete())),p!==null&&p.push(this.rawDestructor,C)}break;default:_e("Unsupporting sharing policy")}return C}function be(p,y){if(y===null)return this.isReference&&_e(`null is not a valid ${this.name}`),0;y.$$||_e(`Cannot pass "${Sn(y)}" as a ${this.name}`),y.$$.ptr||_e(`Cannot pass deleted object as a pointer of type ${this.name}`),y.$$.ptrType.isConst&&_e(`Cannot convert argument of type ${y.$$.ptrType.name} to parameter type ${this.name}`);var C=y.$$.ptrType.registeredClass,N=Da(y.$$.ptr,C,this.registeredClass);return N}function ke(p){return this.fromWireType(D[p>>>2>>>0])}var ae=(p,y,C)=>{if(y===C)return p;if(C.baseClass===void 0)return null;var N=ae(p,y,C.baseClass);return N===null?null:C.downcast(N)},$e={},pt=(p,y)=>{for(y===void 0&&_e("ptr should not be undefined");p.baseClass;)y=p.upcast(y),p=p.baseClass;return y},yt=(p,y)=>(y=pt(p,y),$e[y]),Tt=class extends Error{constructor(y){super(y),this.name="InternalError"}},Et=p=>{throw new Tt(p)},Mt=(p,y)=>{(!y.ptrType||!y.ptr)&&Et("makeClassHandle requires ptr and ptrType");var C=!!y.smartPtrType,N=!!y.smartPtr;return C!==N&&Et("Both smartPtrType and smartPtr must be specified"),y.count={value:1},lr(Object.create(p,{$$:{value:y,writable:!0}}))};function Ir(p){var y=this.getPointee(p);if(!y)return this.destructor(p),null;var C=yt(this.registeredClass,y);if(C!==void 0){if(C.$$.count.value===0)return C.$$.ptr=y,C.$$.smartPtr=p,C.clone();var N=C.clone();return this.destructor(p),N}function R(){return this.isSmartPointer?Mt(this.registeredClass.instancePrototype,{ptrType:this.pointeeType,ptr:y,smartPtrType:this,smartPtr:p}):Mt(this.registeredClass.instancePrototype,{ptrType:this,ptr:p})}var H=this.registeredClass.getActualType(y),ne=cr[H];if(!ne)return R.call(this);var se;this.isConst?se=ne.constPointerType:se=ne.pointerType;var pe=ae(y,this.registeredClass,se.registeredClass);return pe===null?R.call(this):this.isSmartPointer?Mt(se.registeredClass.instancePrototype,{ptrType:se,ptr:pe,smartPtrType:this,smartPtr:p}):Mt(se.registeredClass.instancePrototype,{ptrType:se,ptr:pe})}var gr=()=>{Object.assign(Cr.prototype,{getPointee(p){return this.rawGetPointee&&(p=this.rawGetPointee(p)),p},destructor(p){var y;(y=this.rawDestructor)==null||y.call(this,p)},readValueFromPointer:ke,fromWireType:Ir})};function Cr(p,y,C,N,R,H,ne,se,pe,Be,it){this.name=p,this.registeredClass=y,this.isReference=C,this.isConst=N,this.isSmartPointer=R,this.pointeeType=H,this.sharingPolicy=ne,this.rawGetPointee=se,this.rawConstructor=pe,this.rawShare=Be,this.rawDestructor=it,!R&&y.baseClass===void 0?N?(this.toWireType=Ja,this.destructorFunction=null):(this.toWireType=be,this.destructorFunction=null):this.toWireType=ce}var Lr=(p,y,C)=>{r.hasOwnProperty(p)||Et("Replacing nonexistent public symbol"),r[p].overloadTable!==void 0&&C!==void 0||(r[p]=y,r[p].argCount=C)},Ie=[],Ct=p=>{var y=Ie[p];return y||(Ie[p]=y=N0.get(p)),y},gt=(p,y,C=[],N=!1)=>{var R=Ct(y),H=R(...C);function ne(se){return p[0]=="p"?se>>>0:se}return ne(H)},zr=(p,y,C=!1)=>(...N)=>gt(p,y,N,C),ur=(p,y,C=!1)=>{p=ut(p);function N(){if(p.includes("p"))return zr(p,y,C);var H=Ct(y);return H}var R=N();return typeof R!="function"&&_e(`unknown function pointer with signature ${p}: ${y}`),R};class Rn extends Error{}var Mr=p=>{var y=_0(p),C=ut(y);return bo(y),C},qr=(p,y)=>{var C=[],N={};function R(H){if(!N[H]&&!Vt[H]){if(ar[H]){ar[H].forEach(R);return}C.push(H),N[H]=!0}}throw y.forEach(R),new Rn(`${p}: `+C.map(Mr).join([", "]))},jn=(p,y,C)=>{p.forEach(se=>ar[se]=y);function N(se){var pe=C(se);pe.length!==p.length&&Et("Mismatched type converter count");for(var Be=0;Be<p.length;++Be)F(p[Be],pe[Be])}var R=new Array(y.length),H=[],ne=0;for(let[se,pe]of y.entries())Vt.hasOwnProperty(pe)?R[se]=Vt[pe]:(H.push(pe),Dt.hasOwnProperty(pe)||(Dt[pe]=[]),Dt[pe].push(()=>{R[se]=Vt[pe],++ne,ne===H.length&&N(R)}));H.length===0&&N(R)};function Qa(p,y,C,N,R,H,ne,se,pe,Be,it,mt,ht){p>>>=0,y>>>=0,C>>>=0,N>>>=0,R>>>=0,H>>>=0,ne>>>=0,se>>>=0,pe>>>=0,Be>>>=0,it>>>=0,mt>>>=0,ht>>>=0,it=ut(it),H=ur(R,H),se&&(se=ur(ne,se)),Be&&(Be=ur(pe,Be)),ht=ur(mt,ht);var Ye=mn(it);Br(Ye,function(){qr(`Cannot construct ${it} due to unbound types`,[N])}),jn([p,y,C],N?[N]:[],ir=>{var E0;ir=ir[0];var $r,yn;N?($r=ir.registeredClass,yn=$r.instancePrototype):yn=Yr.prototype;var dn=Ar(it,function(...Pc){if(Object.getPrototypeOf(this)!==xa)throw new St(`Use 'new' to construct ${it}`);if(qn.constructor_body===void 0)throw new St(`${it} has no accessible constructor`);var I0=qn.constructor_body[Pc.length];if(I0===void 0)throw new St(`Tried to invoke ctor of ${it} with invalid number of parameters (${Pc.length}) - expected (${Object.keys(qn.constructor_body).toString()}) parameters instead!`);return I0.apply(this,Pc)}),xa=Object.create(yn,{constructor:{value:dn}});dn.prototype=xa;var qn=new sa(it,dn,xa,ht,$r,H,se,Be);qn.baseClass&&((E0=qn.baseClass).__derivedClasses??(E0.__derivedClasses=[]),qn.baseClass.__derivedClasses.push(qn));var ei=new Cr(it,qn,!0,!1,!1),Ki=new Cr(it+"*",qn,!1,!1,!1),Nn=new Cr(it+" const*",qn,!1,!0,!1);return cr[p]={pointerType:Ki,constPointerType:Nn},Lr(Ye,dn),[ei,Ki,Nn]})}var go=(p,y)=>{for(var C=[],N=0;N<p;N++)C.push(D[y+N*4>>>2>>>0]);return C},Go=p=>{for(;p.length;){var y=p.pop(),C=p.pop();C(y)}};function Pa(p){for(var y=1;y<p.length;++y)if(p[y]!==null&&p[y].destructorFunction===void 0)return!0;return!1}function Ra(p,y,C,N){var R=Pa(p),H=p.length-2,ne=[],se=["fn"];y&&se.push("thisWired");for(var pe=0;pe<H;++pe)ne.push(`arg${pe}`),se.push(`arg${pe}Wired`);ne=ne.join(","),se=se.join(",");var Be=`return function (${ne}) {
`;R&&(Be+=`var destructors = [];
`);var it=R?"destructors":"null",mt=["humanName","throwBindingError","invoker","fn","runDestructors","fromRetWire","toClassParamWire"];y&&(Be+=`var thisWired = toClassParamWire(${it}, this);
`);for(var pe=0;pe<H;++pe){var ht=`toArg${pe}Wire`;Be+=`var arg${pe}Wired = ${ht}(${it}, arg${pe});
`,mt.push(ht)}if(Be+=(C||N?"var rv = ":"")+`invoker(${se});
`,R)Be+=`runDestructors(destructors);
`;else for(var pe=y?1:2;pe<p.length;++pe){var Ye=pe===1?"thisWired":"arg"+(pe-2)+"Wired";p[pe].destructorFunction!==null&&(Be+=`${Ye}_dtor(${Ye});
`,mt.push(`${Ye}_dtor`))}return C&&(Be+=`var ret = fromRetWire(rv);
return ret;
`),Be+=`}
`,new Function(mt,Be)}function ji(p,y,C,N,R,H){var ne=y.length;ne<2&&_e("argTypes array size mismatch! Must at least get return value and 'this' types!");for(var se=y[1]!==null&&C!==null,pe=Pa(y),Be=!y[0].isVoid,it=y[0],mt=y[1],ht=[p,_e,N,R,Go,it.fromWireType.bind(it),mt==null?void 0:mt.toWireType.bind(mt)],Ye=2;Ye<ne;++Ye){var ir=y[Ye];ht.push(ir.toWireType.bind(ir))}if(!pe)for(var Ye=se?1:2;Ye<y.length;++Ye)y[Ye].destructorFunction!==null&&ht.push(y[Ye].destructorFunction);var yn=Ra(y,se,Be,H)(...ht);return Ar(p,yn)}var sn=function(p,y,C,N,R,H){p>>>=0,C>>>=0,N>>>=0,R>>>=0,H>>>=0;var ne=go(y,C);R=ur(N,R),jn([],[p],se=>{se=se[0];var pe=`constructor ${se.name}`;if(se.registeredClass.constructor_body===void 0&&(se.registeredClass.constructor_body=[]),se.registeredClass.constructor_body[y-1]!==void 0)throw new St(`Cannot register multiple constructors with identical number of parameters (${y-1}) for class '${se.name}'! Overload resolution is currently only performed using the parameter count, not actual type info!`);return se.registeredClass.constructor_body[y-1]=()=>{qr(`Cannot construct ${se.name} due to unbound types`,ne)},jn([],ne,Be=>(Be.splice(1,0,null),se.registeredClass.constructor_body[y-1]=ji(pe,Be,null,R,H),[])),[]})},mo=p=>{p=p.trim();const y=p.indexOf("(");return y===-1?p:p.slice(0,y)},yo=function(p,y,C,N,R,H,ne,se,pe,Be){p>>>=0,y>>>=0,N>>>=0,R>>>=0,H>>>=0,ne>>>=0;var it=go(C,N);y=ut(y),y=mo(y),H=ur(R,H,pe),jn([],[p],mt=>{mt=mt[0];var ht=`${mt.name}.${y}`;y.startsWith("@@")&&(y=Symbol[y.substring(2)]),se&&mt.registeredClass.pureVirtualFunctions.push(y);function Ye(){qr(`Cannot call ${ht} due to unbound types`,it)}var ir=mt.registeredClass.instancePrototype,$r=ir[y];return $r===void 0||$r.overloadTable===void 0&&$r.className!==mt.name&&$r.argCount===C-2?(Ye.argCount=C-2,Ye.className=mt.name,ir[y]=Ye):(Ft(ir,y,ht),ir[y].overloadTable[C-2]=Ye),jn([],it,yn=>{var dn=ji(ht,yn,mt,H,ne,pe);return ir[y].overloadTable===void 0?(dn.argCount=C-2,ir[y]=dn):ir[y].overloadTable[C-2]=dn,[]}),[]})},zi=[],Ba=[0,1,,1,null,1,!0,1,!1,1];function _a(p){p>>>=0,p>9&&--Ba[p+1]===0&&(Ba[p]=void 0,zi.push(p))}var Zr={toValue:p=>(p||_e(`Cannot use deleted val. handle = ${p}`),Ba[p]),toHandle:p=>{switch(p){case void 0:return 2;case null:return 4;case!0:return 6;case!1:return 8;default:{const y=zi.pop()||Ba.length;return Ba[y]=p,Ba[y+1]=1,y}}}},Bn={name:"emscripten::val",fromWireType:p=>{var y=Zr.toValue(p);return _a(p),y},toWireType:(p,y)=>Zr.toHandle(y),readValueFromPointer:ke,destructorFunction:null};function yl(p){return p>>>=0,F(p,Bn)}var Ln=(p,y)=>{switch(y){case 4:return function(C){return this.fromWireType(B[C>>>2>>>0])};case 8:return function(C){return this.fromWireType(z[C>>>3>>>0])};default:throw new TypeError(`invalid float width (${y}): ${p}`)}},at=function(p,y,C){p>>>=0,y>>>=0,C>>>=0,y=ut(y),F(p,{name:y,fromWireType:N=>N,toWireType:(N,R)=>R,readValueFromPointer:Ln(y,C),destructorFunction:null})},qt=function(p,y,C,N,R){p>>>=0,y>>>=0,C>>>=0,y=ut(y);const H=N===0;let ne=pe=>pe;if(H){var se=32-8*C;ne=pe=>pe<<se>>>se,R=ne(R)}F(p,{name:y,fromWireType:ne,toWireType:(pe,Be)=>Be,readValueFromPointer:Ce(y,C,N!==0),destructorFunction:null})};function dr(p,y,C){p>>>=0,C>>>=0;var N=[Int8Array,Uint8Array,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array,BigInt64Array,BigUint64Array],R=N[y];function H(ne){var se=D[ne>>>2>>>0],pe=D[ne+4>>>2>>>0];return new R(S.buffer,pe,se)}C=ut(C),F(p,{name:C,fromWireType:H,readValueFromPointer:H},{ignoreDuplicateRegistrations:!0})}var Gt=Object.assign({optional:!0},Bn);function Kn(p,y){p>>>=0,F(p,Gt)}var Hr=(p,y,C)=>Pr(p,M,y,C);function la(p,y){p>>>=0,y>>>=0,y=ut(y),F(p,{name:y,fromWireType(C){var N=D[C>>>2>>>0],R=C+4,H;return H=Wt(R,N,!0),bo(C),H},toWireType(C,N){N instanceof ArrayBuffer&&(N=new Uint8Array(N));var R,H=typeof N=="string";H||ArrayBuffer.isView(N)&&N.BYTES_PER_ELEMENT==1||_e("Cannot pass non-string to std::string"),H?R=Rr(N):R=N.length;var ne=pd(4+R+1),se=ne+4;return D[ne>>>2>>>0]=R,H?Hr(N,se,R+1):M.set(N,se>>>0),C!==null&&C.push(bo,ne),ne},readValueFromPointer:ke,destructorFunction(C){bo(C)}})}var La=globalThis.TextDecoder?new TextDecoder("utf-16le"):void 0,Fn=(p,y,C)=>{var N=p>>>1,R=wt(E,N,y/2,C);if(R-N>16&&La)return La.decode(E.subarray(N>>>0,R>>>0));for(var H="",ne=N;ne<R;++ne){var se=E[ne>>>0];H+=String.fromCharCode(se)}return H},ga=(p,y,C)=>{if(C??(C=2147483647),C<2)return 0;C-=2;for(var N=y,R=C<p.length*2?C/2:p.length,H=0;H<R;++H){var ne=p.charCodeAt(H);O[y>>>1>>>0]=ne,y+=2}return O[y>>>1>>>0]=0,y-N},tn=p=>p.length*2,Uo=(p,y,C)=>{for(var N="",R=p>>>2,H=0;!(H>=y/4);H++){var ne=D[R+H>>>0];if(!ne&&!C)break;N+=String.fromCodePoint(ne)}return N},Rt=(p,y,C)=>{if(y>>>=0,C??(C=2147483647),C<4)return 0;for(var N=y,R=N+C-4,H=0;H<p.length;++H){var ne=p.codePointAt(H);if(ne>65535&&H++,I[y>>>2>>>0]=ne,y+=4,y+4>R)break}return I[y>>>2>>>0]=0,y-N},zo=p=>{for(var y=0,C=0;C<p.length;++C){var N=p.codePointAt(C);N>65535&&C++,y+=4}return y};function It(p,y,C){p>>>=0,y>>>=0,C>>>=0,C=ut(C);var N,R,H;y===2?(N=Fn,R=ga,H=tn):(N=Uo,R=Rt,H=zo),F(p,{name:C,fromWireType:ne=>{var se=D[ne>>>2>>>0],pe=N(ne+4,se*y,!0);return bo(ne),pe},toWireType:(ne,se)=>{typeof se!="string"&&_e(`Cannot pass non-string to C++ string type ${C}`);var pe=H(se),Be=pd(4+pe+y);return D[Be>>>2>>>0]=pe/y,R(se,Be+4,pe+y),ne!==null&&ne.push(bo,Be),Be},readValueFromPointer:ke,destructorFunction(ne){bo(ne)}})}var Wo=function(p,y){p>>>=0,y>>>=0,y=ut(y),F(p,{isVoid:!0,name:y,fromWireType:()=>{},toWireType:(C,N)=>{}})},vs=()=>{throw 1/0},Wi=[],xl=p=>{var y=Wi.length;return Wi.push(p),y},kc=(p,y)=>{var C=Vt[p];return C===void 0&&_e(`${y} has unknown type ${Mr(p)}`),C},vl=(p,y)=>{for(var C=new Array(p),N=0;N<p;++N)C[N]=kc(D[y+N*4>>>2>>>0],`parameter ${N}`);return C},Ho=(p,y,C)=>{var N=[],R=p(N,C);return N.length&&(D[y>>>2>>>0]=Zr.toHandle(N)),R},xo={},bl=p=>{var y=xo[p];return y===void 0?ut(p):y},wl=function(p,y,C){y>>>=0;var N=8,[R,...H]=vl(p,y),ne=R.toWireType.bind(R),se=H.map(Ye=>Ye.readValueFromPointer.bind(Ye));p--;var pe={toValue:Zr.toValue},Be=se.map((Ye,ir)=>{var $r=`argFromPtr${ir}`;return pe[$r]=Ye,`${$r}(args${ir?"+"+ir*N:""})`}),it;switch(C){case 0:it="toValue(handle)";break;case 2:it="new (toValue(handle))";break;case 3:it="";break;case 1:pe.getStringOrSymbol=bl,it="toValue(handle)[getStringOrSymbol(methodName)]";break}it+=`(${Be})`,R.isVoid||(pe.toReturnWire=ne,pe.emval_returnValue=Ho,it=`return emval_returnValue(toReturnWire, destructorsRef, ${it})`),it=`return function (handle, methodName, destructorsRef, args) {
  ${it}
  }`;var mt=new Function(Object.keys(pe),it)(...Object.values(pe)),ht=`methodCaller<(${H.map(Ye=>Ye.name)}) => ${R.name}>`;return xl(Ar(ht,mt))};function sd(p){return p>>>=0,p?(p=bl(p),Zr.toHandle(globalThis[p])):Zr.toHandle(globalThis)}function kl(p,y){return p>>>=0,y>>>=0,p=Zr.toValue(p),y=Zr.toValue(y),Zr.toHandle(p[y])}function Sc(p){p>>>=0,p>9&&(Ba[p+1]+=1)}function ui(p,y){return p>>>=0,y>>>=0,p=Zr.toValue(p),y=Zr.toValue(y),p instanceof y}function Fa(p,y,C,N,R){return p>>>=0,y>>>=0,C>>>=0,N>>>=0,R>>>=0,Wi[p](y,C,N,R)}function Ga(){return Zr.toHandle([])}function bs(p){return p>>>=0,Zr.toHandle(bl(p))}function ld(){return Zr.toHandle({})}function cd(p){p>>>=0;var y=Zr.toValue(p);Go(y),_a(p)}function ws(p,y,C){p>>>=0,y>>>=0,C>>>=0,p=Zr.toValue(p),y=Zr.toValue(y),C=Zr.toValue(C),p[y]=C}function ks(p){return p>>>=0,p=Zr.toValue(p),Zr.toHandle(typeof p)}function ud(p,y){p=tt(p),y>>>=0;var C=new Date(p*1e3);I[y>>>2>>>0]=C.getUTCSeconds(),I[y+4>>>2>>>0]=C.getUTCMinutes(),I[y+8>>>2>>>0]=C.getUTCHours(),I[y+12>>>2>>>0]=C.getUTCDate(),I[y+16>>>2>>>0]=C.getUTCMonth(),I[y+20>>>2>>>0]=C.getUTCFullYear()-1900,I[y+24>>>2>>>0]=C.getUTCDay();var N=Date.UTC(C.getUTCFullYear(),0,1,0,0,0,0),R=(C.getTime()-N)/(1e3*60*60*24)|0;I[y+28>>>2>>>0]=R}var xt=p=>p%4===0&&(p%100!==0||p%400===0),dd=[0,31,60,91,121,152,182,213,244,274,305,335],fd=[0,31,59,90,120,151,181,212,243,273,304,334],Hi=p=>{var y=xt(p.getFullYear()),C=y?dd:fd,N=C[p.getMonth()]+p.getDate()-1;return N};function Vo(p,y){p=tt(p),y>>>=0;var C=new Date(p*1e3);I[y>>>2>>>0]=C.getSeconds(),I[y+4>>>2>>>0]=C.getMinutes(),I[y+8>>>2>>>0]=C.getHours(),I[y+12>>>2>>>0]=C.getDate(),I[y+16>>>2>>>0]=C.getMonth(),I[y+20>>>2>>>0]=C.getFullYear()-1900,I[y+24>>>2>>>0]=C.getDay();var N=Hi(C)|0;I[y+28>>>2>>>0]=N,I[y+36>>>2>>>0]=-(C.getTimezoneOffset()*60);var R=new Date(C.getFullYear(),0,1),H=new Date(C.getFullYear(),6,1).getTimezoneOffset(),ne=R.getTimezoneOffset(),se=(H!=ne&&C.getTimezoneOffset()==Math.min(ne,H))|0;I[y+32>>>2>>>0]=se}var Xo=function(p){p>>>=0;var y=(()=>{var C=new Date(I[p+20>>>2>>>0]+1900,I[p+16>>>2>>>0],I[p+12>>>2>>>0],I[p+8>>>2>>>0],I[p+4>>>2>>>0],I[p>>>2>>>0],0),N=I[p+32>>>2>>>0],R=C.getTimezoneOffset(),H=new Date(C.getFullYear(),0,1),ne=new Date(C.getFullYear(),6,1).getTimezoneOffset(),se=H.getTimezoneOffset(),pe=Math.min(se,ne);if(N<0)I[p+32>>>2>>>0]=+(ne!=se&&pe==R);else if(N>0!=(pe==R)){var Be=Math.max(se,ne),it=N>0?pe:Be;C.setTime(C.getTime()+(it-R)*6e4)}I[p+24>>>2>>>0]=C.getDay();var mt=Hi(C)|0;I[p+28>>>2>>>0]=mt,I[p>>>2>>>0]=C.getSeconds(),I[p+4>>>2>>>0]=C.getMinutes(),I[p+8>>>2>>>0]=C.getHours(),I[p+12>>>2>>>0]=C.getDate(),I[p+16>>>2>>>0]=C.getMonth(),I[p+20>>>2>>>0]=C.getYear();var ht=C.getTime();return isNaN(ht)?-1:ht/1e3})();return BigInt(y)},Z=function(p,y,C,N){p>>>=0,y>>>=0,C>>>=0,N>>>=0;var R=new Date().getFullYear(),H=new Date(R,0,1),ne=new Date(R,6,1),se=H.getTimezoneOffset(),pe=ne.getTimezoneOffset(),Be=Math.max(se,pe);D[p>>>2>>>0]=Be*60,I[y>>>2>>>0]=+(se!=pe);var it=Ye=>{var ir=Ye>=0?"-":"+",$r=Math.abs(Ye),yn=String(Math.floor($r/60)).padStart(2,"0"),dn=String($r%60).padStart(2,"0");return`UTC${ir}${yn}${dn}`},mt=it(se),ht=it(pe);pe<se?(Hr(mt,C,17),Hr(ht,N,17)):(Hr(mt,N,17),Hr(ht,C,17))},Oe=()=>Date.now(),Qt=()=>4294901760,nn=(p,y)=>Math.ceil(p/y)*y,Pn=p=>{var y=jc.buffer.byteLength,C=(p-y+65535)/65536|0;try{return jc.grow(C),L(),1}catch{}};function Yn(p){p>>>=0;var y=M.length,C=Qt();if(p>C)return!1;for(var N=1;N<=4;N*=2){var R=y*(1+.2/N);R=Math.min(R,p+100663296);var H=Math.min(C,nn(Math.max(p,R),65536)),ne=Pn(H);if(ne)return!0}return!1}var Jr={},ma=()=>s||"./this.program",di=()=>{if(!di.strings){var p=(typeof navigator=="object"&&navigator.language||"C").replace("-","_")+".UTF-8",y={USER:"web_user",LOGNAME:"web_user",PATH:"/",PWD:"/",HOME:"/home/web_user",LANG:p,_:ma()};for(var C in Jr)Jr[C]===void 0?delete y[C]:y[C]=Jr[C];var N=[];for(var C in y)N.push(`${C}=${y[C]}`);di.strings=N}return di.strings};function Pi(p,y){p>>>=0,y>>>=0;var C=0,N=0;for(var R of di()){var H=y+C;D[p+N>>>2>>>0]=H,C+=Hr(R,H,1/0)+1,N+=4}return 0}function vo(p,y){p>>>=0,y>>>=0;var C=di();D[p>>>2>>>0]=C.length;var N=0;for(var R of C)N+=Rr(R)+1;return D[y>>>2>>>0]=N,0}var Vi=0,ya=()=>ge||Vi>0,hd=p=>{var y;ya()||((y=r.onExit)==null||y.call(r,p),m=!0),l(p,new de(p))},Em=(p,y)=>{hd(p)},Im=Em;function $m(p){try{var y=Ge.getStreamFromFD(p);return A.close(y),0}catch(C){if(typeof A>"u"||C.name!=="ErrnoError")throw C;return C.errno}}var Dm=(p,y,C,N)=>{for(var R=0,H=0;H<C;H++){var ne=D[y>>>2>>>0],se=D[y+4>>>2>>>0];y+=8;var pe=A.read(p,S,ne,se,N);if(pe<0)return-1;if(R+=pe,pe<se)break}return R};function Rm(p,y,C,N){y>>>=0,C>>>=0,N>>>=0;try{var R=Ge.getStreamFromFD(p),H=Dm(R,y,C);return D[N>>>2>>>0]=H,0}catch(ne){if(typeof A>"u"||ne.name!=="ErrnoError")throw ne;return ne.errno}}function Bm(p,y,C,N){y=tt(y),N>>>=0;try{if(isNaN(y))return 61;var R=Ge.getStreamFromFD(p);return A.llseek(R,y,C),Y[N>>>3>>>0]=BigInt(R.position),R.getdents&&y===0&&C===0&&(R.getdents=null),0}catch(H){if(typeof A>"u"||H.name!=="ErrnoError")throw H;return H.errno}}var Lm=(p,y,C,N)=>{for(var R=0,H=0;H<C;H++){var ne=D[y>>>2>>>0],se=D[y+4>>>2>>>0];y+=8;var pe=A.write(p,S,ne,se,N);if(pe<0)return-1;if(R+=pe,pe<se)break}return R};function Fm(p,y,C,N){y>>>=0,C>>>=0,N>>>=0;try{var R=Ge.getStreamFromFD(p),H=Lm(R,y,C);return D[N>>>2>>>0]=H,0}catch(ne){if(typeof A>"u"||ne.name!=="ErrnoError")throw ne;return ne.errno}}if(A.createPreloadedFile=nr,A.preloadFile=vt,A.staticInit(),kn(),gr(),r.noExitRuntime&&(ge=r.noExitRuntime),r.preloadPlugins&&(sr=r.preloadPlugins),r.print&&(w=r.print),r.printErr&&(v=r.printErr),r.wasmBinary&&(x=r.wasmBinary),r.arguments&&r.arguments,r.thisProgram&&(s=r.thisProgram),r.preInit)for(typeof r.preInit=="function"&&(r.preInit=[r.preInit]);r.preInit.length>0;)r.preInit.shift()();var _0,bo,pd,Xi,C0,M0,jc,N0;function Gm(p){_0=p.ea,bo=p.fa,pd=p.ga,Xi=p.ia,C0=p.ja,M0=p.ka,jc=p.ca,N0=p.ha}var Um={g:kt,b:Gr,A:Ke,V:Yt,W:Ht,L:At,M:yr,J:Xr,C:Ee,aa:_t,F:Qa,E:sn,o:yo,_:yl,B:at,p:qt,m:dr,X:Kn,$:la,x:It,ba:Wo,H:vs,f:wl,a:_a,q:sd,i:kl,j:Sc,D:ui,e:Fa,k:Ga,c:bs,l:ld,d:cd,h:ws,t:ks,N:ud,O:Vo,P:Xo,Q:Z,Y:Oe,K:Yn,S:Pi,T:vo,Z:Im,y:$m,U:Rm,R:Bm,z:Fm,G:Km,u:O0,n:Wm,s:Hm,v:zm,I:gd,r:Vm,w:Xm};function gd(p){var y=Le();try{Ct(p)()}catch(C){if(ue(y),C!==C+0)throw C;Xi(1,0)}}function zm(p,y){var C=Le();try{return Ct(p)(y)}catch(N){if(ue(C),N!==N+0)throw N;return Xi(1,0),0n}}function Wm(p,y,C,N,R){var H=Le();try{return Ct(p)(y,C,N,R)}catch(ne){if(ue(H),ne!==ne+0)throw ne;Xi(1,0)}}function Hm(p,y,C,N){var R=Le();try{return Ct(p)(y,C,N)}catch(H){if(ue(R),H!==H+0)throw H;Xi(1,0)}}function Vm(p,y){var C=Le();try{Ct(p)(y)}catch(N){if(ue(C),N!==N+0)throw N;Xi(1,0)}}function Xm(p,y,C,N){var R=Le();try{Ct(p)(y,C,N)}catch(H){if(ue(R),H!==H+0)throw H;Xi(1,0)}}function O0(p,y,C,N){var R=Le();try{return Ct(p)(y,C,N)}catch(H){if(ue(R),H!==H+0)throw H;Xi(1,0)}}function Km(p,y,C){var N=Le();try{return Ct(p)(y,C)}catch(R){if(ue(N),R!==R+0)throw R;Xi(1,0)}}function Sl(p){p=Object.assign({},p);var y=N=>R=>N(R)>>>0,C=N=>()=>N()>>>0;return p.ea=y(p.ea),p.ga=y(p.ga),p._emscripten_stack_alloc=y(p._emscripten_stack_alloc),p.ka=C(p.ka),p}function md(){if(ot>0){Pt=md;return}if(U(),ot>0){Pt=md;return}function p(){var y;r.calledRun=!0,!m&&(V(),P==null||P(r),(y=r.onRuntimeInitialized)==null||y.call(r),J())}r.setStatus?(r.setStatus("Running..."),setTimeout(()=>{setTimeout(()=>r.setStatus(""),1),p()},1)):p()}var fi;return fi=await le(),md(),$?t=r:t=new Promise((p,y)=>{P=p,j=y}),t}const Wie=Object.freeze(Object.defineProperty({__proto__:null,default:NO},Symbol.toStringTag,{value:"Module"})),Hie=`
import struct
import numpy as np

class Type:
    Short = (3,2); Long = (4,4); Ascii = (2,1); Byte = (1,1)
    Srational = (10,8)

class Tag:
    NewSubfileType = (254, Type.Long); ImageWidth = (256, Type.Long); ImageLength = (257, Type.Long)
    BitsPerSample = (258, Type.Short); Compression = (259, Type.Short)
    PhotometricInterpretation = (262, Type.Short); Make = (271, Type.Ascii); Model = (272, Type.Ascii)
    StripOffsets = (273, Type.Long); SamplesPerPixel = (277, Type.Short)
    RowsPerStrip = (278, Type.Short); StripByteCounts = (279, Type.Long)
    CFARepeatPatternDim = (33421, Type.Short); CFAPattern = (33422, Type.Byte)
    DNGVersion = (50706, Type.Byte); UniqueCameraModel = (50708, Type.Ascii)
    BlackLevelRepeatDim = (50713, Type.Short)
    BlackLevel = (50714, Type.Short); WhiteLevel = (50717, Type.Short)
    ColorMatrix1 = (50721, Type.Srational); CalibrationIlluminant1 = (50778, Type.Short)

class Compression: Uncompressed = 1
class PhotometricInterpretation: Color_Filter_Array = 32803
class CFAPattern: BGGR=[2,1,1,0]; GBRG=[1,2,0,1]; GRBG=[1,0,2,1]; RGGB=[0,1,1,2]

class dngTag(object):
    def __init__(self, tagType, value=[]):
        self.TagId = tagType[0]
        self.DataType = tagType[1]
        self.DataCount = len(value) if not isinstance(value, str) else len(value) + 1
        self.Value = self._pack_value(tagType[1], value)
        self.DataLength = len(self.Value)
        self.selfContained = (self.DataLength <= 4)
        self.DataOffset = 0

    def _pack_value(self, dtype, value):
        tid = dtype[0]
        if tid == 1: return struct.pack('<%sB' % len(value), *value)
        elif tid == 3: return struct.pack('<%sH' % len(value), *value)
        elif tid == 4: return struct.pack('<%sL' % len(value), *value)
        elif tid == 2: return struct.pack('<%ss' % len(value), value.encode("ascii")) + b'\\x00'
        elif tid == 10:
            flat = [item for sublist in value for item in sublist]  # [[num,den]...]
            return struct.pack('<%sl' % len(flat), *flat)
        return b''

    def write_directory(self, buf, offset):
        if self.selfContained:
            val = self.Value + b'\\x00' * (4 - len(self.Value))
            struct.pack_into("<HHI4s", buf, offset, self.TagId, self.DataType[0], self.DataCount, val)
        else:
            struct.pack_into("<HHII", buf, offset, self.TagId, self.DataType[0], self.DataCount, self.DataOffset)

    def write_data(self, buf):
        if not self.selfContained:
            struct.pack_into(f"<{len(self.Value)}s", buf, self.DataOffset, self.Value)

def pack_dng_from_u16(raw_u16_bytes_le, width, height, cfa_str, black_level_list, cm_flat, make_str, model_str, unique_model_str):
    raw_data = np.frombuffer(raw_u16_bytes_le, dtype=np.uint16).copy()
    raw_data = raw_data.astype(np.int32)
    raw_data = np.clip(raw_data, 0, 65535).astype(np.uint16)

    white_level = 65019
    color_matrix = [[int(x * 10000), 10000] for x in cm_flat]
    cfa_map = {"BGGR": CFAPattern.BGGR, "GBRG": CFAPattern.GBRG, "GRBG": CFAPattern.GRBG, "RGGB": CFAPattern.RGGB}

    tags = [
        dngTag(Tag.NewSubfileType, [0]),
        dngTag(Tag.ImageWidth, [width]),
        dngTag(Tag.ImageLength, [height]),
        dngTag(Tag.BitsPerSample, [16]),
        dngTag(Tag.Compression, [Compression.Uncompressed]),
        dngTag(Tag.PhotometricInterpretation, [PhotometricInterpretation.Color_Filter_Array]),
        dngTag(Tag.Make, make_str),
        dngTag(Tag.Model, model_str),
        dngTag(Tag.SamplesPerPixel, [1]),
        dngTag(Tag.RowsPerStrip, [height]),
        dngTag(Tag.CFARepeatPatternDim, [2, 2]),
        dngTag(Tag.CFAPattern, cfa_map.get(cfa_str.upper(), CFAPattern.RGGB)),
        dngTag(Tag.BlackLevelRepeatDim, [2, 2]),
        dngTag(Tag.BlackLevel, [int(x) for x in black_level_list]),
        dngTag(Tag.WhiteLevel, [white_level]),
        dngTag(Tag.ColorMatrix1, color_matrix),
        dngTag(Tag.CalibrationIlluminant1, [21]),
        dngTag(Tag.DNGVersion, [1, 4, 0, 0]),
        dngTag(Tag.UniqueCameraModel, unique_model_str),
    ]

    pixel_bytes = raw_data.tobytes()
    tags.append(dngTag(Tag.StripOffsets, [0]))
    tags.append(dngTag(Tag.StripByteCounts, [len(pixel_bytes)]))
    tags.sort(key=lambda x: x.TagId)

    ifd_size = 2 + (len(tags) * 12) + 4
    current_data_offset = 8 + ifd_size

    for tag in tags:
        if not tag.selfContained:
            tag.DataOffset = current_data_offset
            current_data_offset = (current_data_offset + tag.DataLength + 3) & 0xFFFFFFFC

    img_offset = current_data_offset
    for tag in tags:
        if tag.TagId == Tag.StripOffsets[0]:
            tag.Value = struct.pack('<L', img_offset)
            break

    buf = bytearray(img_offset + len(pixel_bytes))
    struct.pack_into("<ccbbI", buf, 0, b'I', b'I', 0x2A, 0x00, 8)
    struct.pack_into("<H", buf, 8, len(tags))

    offset = 10
    for tag in tags:
        tag.write_directory(buf, offset)
        offset += 12

    struct.pack_into("<I", buf, offset, 0)
    for tag in tags:
        tag.write_data(buf)

    buf[img_offset:img_offset+len(pixel_bytes)] = pixel_bytes
    return bytes(buf)
`;let cx=null;async function Vie(e){return cx||(cx=(async()=>{if(!window.loadPyodide)throw new Error("Pyodide missing: window.loadPyodide not found.");e==null||e("Loading Pyodide...");const t=await window.loadPyodide();return e==null||e("Loading numpy..."),await t.loadPackage("numpy"),e==null||e("Init DNG writer kernel..."),await t.runPythonAsync(Hie),t})()),cx}let ux=null;async function Xie(){ux||(ux=NO({locateFile:(t,r)=>t.endsWith("joraw.wasm")?new URL("/assets/joraw-DraTMNgX.wasm",import.meta.url).href:r+t}));const e=await ux;return e.LibRaw||e.JoRaw}function Kie(e,t,r,n){const a=t*r,i=new Float32Array(a);let o=0;for(let s=0;s<r;s++){const l=(s&1)<<1;for(let u=0;u<t;u++){const d=l|u&1;i[o]=e[o]-n[d],o++}}return i}function Yie(e,t,r,n){const a=t*r,i=new Uint16Array(a);let o=0;for(let s=0;s<r;s++){const l=(s&1)<<1;for(let u=0;u<t;u++){const d=l|u&1;let f=e[o]+n[d];f<0&&(f=0),f>65535&&(f=65535),i[o]=f+.5|0,o++}}return i}function qie(e){const t=new Uint16Array([255]);if(new Uint8Array(t.buffer)[0]===255)return new Uint8Array(e.buffer,e.byteOffset,e.byteLength);const n=new Uint8Array(e.length*2),a=new DataView(n.buffer);for(let i=0;i<e.length;i++)a.setUint16(i*2,e[i],!0);return n}function Zie(e){const t=e.trim(),r=[];let n=0;const a=d=>d>="0"&&d<="9",i=d=>d>="A"&&d<="Z"||d>="a"&&d<="z";for(;n<t.length;){const d=t[n];if(d<=" "){n++;continue}if(d==="("){r.push({t:"lp"}),n++;continue}if(d===")"){r.push({t:"rp"}),n++;continue}if(d===","){r.push({t:"comma"}),n++;continue}if(d==="+"&&t[n+1]==="+"){r.push({t:"op",v:"++"}),n+=2;continue}if(d==="+"){r.push({t:"op",v:"+"}),n++;continue}if(d==="-"){r.push({t:"op",v:"-"}),n++;continue}if(d==="*"){r.push({t:"op",v:"*"}),n++;continue}if(d==="/"){r.push({t:"op",v:"/"}),n++;continue}if(a(d)||d==="."){let f=n+1;for(;f<t.length&&(a(t[f])||t[f]===".");)f++;const h=Number(t.slice(n,f));if(!Number.isFinite(h))throw new Error(`Bad number: ${t.slice(n,f)}`);r.push({t:"num",v:h}),n=f;continue}if(i(d)){let f=n+1;for(;f<t.length&&i(t[f]);)f++;const h=t.slice(n,f).toUpperCase();let g=f;for(;g<t.length&&t[g]<=" ";)g++;t[g]==="("&&(h==="MAX"||h==="MIN"||h==="MID")?r.push({t:"func",name:h}):r.push({t:"id",v:h}),n=f;continue}throw new Error(`Unexpected char at ${n}: ${d}`)}const o=[];for(let d=0;d<r.length;d++){const f=r[d],h=o[o.length-1],g=!h||h.t==="op"||h.t==="lp"||h.t==="comma";if(f.t==="op"&&(f.v==="-"||f.v==="+")&&g){o.push({t:"num",v:0}),o.push(f);continue}o.push(f)}const s=[],l=d=>d.t==="num"||d.t==="id"||d.t==="rp",u=d=>d.t==="num"||d.t==="id"||d.t==="lp"||d.t==="func";for(let d=0;d<o.length;d++){const f=o[d],h=s[s.length-1];h&&l(h)&&u(f)&&s.push({t:"op",v:"*"}),s.push(f)}return s}function V4(e){return e==="*"||e==="/"?2:1}function Jie(e){const t=[],r=[],n=[];for(const a of e){if(a.t==="num"||a.t==="id"){t.push(a);continue}if(a.t==="func"){r.push(a),n.push(1);continue}if(a.t==="comma"){for(;r.length&&r[r.length-1].t!=="lp";)t.push(r.pop());if(!r.length)throw new Error("Comma found outside parentheses.");if(!n.length)throw new Error("Comma found but no function context.");n[n.length-1]+=1;continue}if(a.t==="lp"){r.push(a);continue}if(a.t==="rp"){for(;r.length&&r[r.length-1].t!=="lp";)t.push(r.pop());if(!r.length)throw new Error("Mismatched parentheses");if(r.pop(),r.length&&r[r.length-1].t==="func"){const i=r.pop(),o=n.pop()??1;t.push({t:"func",name:i.name,argc:o})}continue}if(a.t==="op"){for(;r.length;){const i=r[r.length-1];if(i.t!=="op")break;const o=V4(a.v);if(V4(i.v)>=o)t.push(r.pop());else break}r.push(a);continue}}for(;r.length;){const a=r.pop();if(a.t==="lp"||a.t==="rp")throw new Error("Mismatched parentheses");if(a.t==="func"){const i=n.pop()??1;t.push({t:"func",name:a.name,argc:i})}else t.push(a)}if(n.length!==0)throw new Error("Internal error: argCountStack not empty.");return t}function Qie(e,t){for(let n=1;n<t;n++){const a=e[n];let i=n-1;for(;i>=0&&e[i]>a;)e[i+1]=e[i],i--;e[i+1]=a}const r=t-1>>1;return e[r]}function eoe(e,t,r){if(t.size===0)throw new Error("No RAW loaded.");const n=t.values().next().value,a=n.width,i=n.height,o=a*i,s=new Map,l=x=>{const m=t.get(x);if(!m)throw new Error(`Unknown RAW key: ${x}`);if(m.width!==a||m.height!==i)throw new Error("Dimension mismatch among RAWs.");let k=s.get(x);if(!k){k=new Float64Array(o);const P=m.workF32;for(let j=0;j<o;j++)k[j]=P[j];s.set(x,k)}return{kind:"img",v:k,w:a,h:i,firstId:x}},u=x=>({kind:"scalar",v:x}),d=x=>{if(x.kind==="img")return x;const m=new Float64Array(o);return m.fill(x.v),{kind:"img",v:m,w:a,h:i,firstId:void 0}},f=(x,m)=>x??m,h=[];for(const x of e){if(x.t==="num"){h.push(u(x.v));continue}if(x.t==="id"){h.push(l(x.v));continue}if(x.t==="func"){const m=x.argc??1;if(m<1)throw new Error(`${x.name.toLowerCase()}(...) requires at least 1 argument.`);const k=[];for(let O=0;O<m;O++){const E=h.pop();if(!E)throw new Error(`${x.name.toLowerCase()}(...) missing argument(s).`);k.push(E)}if(k.reverse(),k.every(O=>O.kind==="scalar")){const O=k.map(E=>E.v);for(let E=1;E<O.length;E++){const I=O[E];let D=E-1;for(;D>=0&&O[D]>I;)O[D+1]=O[D],D--;O[D+1]=I}if(x.name==="MAX")h.push(u(O[O.length-1]));else if(x.name==="MIN")h.push(u(O[0]));else{const E=O.length-1>>1;h.push(u(O[E]))}continue}const j=k.map(d),S=j.reduce((O,E)=>f(O,E.firstId),void 0),M=new Float64Array(o);if(x.name==="MAX"||x.name==="MIN"){const O=j[0].v;for(let E=0;E<o;E++)M[E]=O[E];if(x.name==="MAX")for(let E=1;E<j.length;E++){const I=j[E].v;for(let D=0;D<o;D++)I[D]>M[D]&&(M[D]=I[D])}else for(let E=1;E<j.length;E++){const I=j[E].v;for(let D=0;D<o;D++)I[D]<M[D]&&(M[D]=I[D])}h.push({kind:"img",v:M,w:a,h:i,firstId:S});continue}if(x.name==="MID"){const O=j.length,E=new Float64Array(O);for(let I=0;I<o;I++){for(let D=0;D<O;D++)E[D]=j[D].v[I];M[I]=Qie(E,O)}h.push({kind:"img",v:M,w:a,h:i,firstId:S});continue}throw new Error(`Unknown function: ${x.name}`)}if(x.t==="op"){const m=x.v,k=h.pop(),P=h.pop();if(!P||!k)throw new Error(`Operator ${m} missing operands`);if(m==="++"){if(!r)throw new Error("Formula uses '++' but ppRange is null.");const I=d(P),D=d(k),B=D.firstId;if(!B){h.push(I);continue}const z=t.get(B);if(!z)throw new Error(`Mask source RAW not found: ${B}`);const Y=I.v,G=D.v,$=new Float64Array(o),L=r.min,U=r.max,V=z.origU16;for(let J=0;J<o;J++){const K=V[J];$[J]=K>=L&&K<=U?G[J]:Y[J]}h.push({kind:"img",v:$,w:a,h:i,firstId:f(I.firstId,B)});continue}if(P.kind==="scalar"&&k.kind==="scalar"){if(m==="+")h.push(u(P.v+k.v));else if(m==="-")h.push(u(P.v-k.v));else if(m==="*")h.push(u(P.v*k.v));else if(m==="/")h.push(u(P.v/k.v));else throw new Error(`Unsupported op ${m}`);continue}const j=d(P),S=d(k),M=j.v,O=S.v,E=new Float64Array(o);if(m==="+")for(let I=0;I<o;I++)E[I]=M[I]+O[I];else if(m==="-")for(let I=0;I<o;I++)E[I]=M[I]-O[I];else if(m==="*")for(let I=0;I<o;I++)E[I]=M[I]*O[I];else if(m==="/")for(let I=0;I<o;I++)E[I]=M[I]/O[I];else throw new Error(`Unsupported op ${m}`);h.push({kind:"img",v:E,w:a,h:i,firstId:f(j.firstId,S.firstId)});continue}}if(h.length!==1)throw new Error("Expression did not reduce to a single value.");const g=h[0],b=g.kind==="img"?g:d(g),w=new Float32Array(o),v=b.v;for(let x=0;x<o;x++)w[x]=v[x];return w}async function toe(e,t,r,n,a,i,o,s,l){if(Object.keys(e).length===0)throw new Error("No files loaded.");if(!t.trim())throw new Error("Formula empty.");const d=t.includes("++");if(d&&!o)throw new Error("Formula contains '++' but ++Range is not provided.");l==null||l("Parsing formula...");const f=Zie(t),h=Jie(f),g=new Set;for(const B of f)B.t==="id"&&g.add(B.v);for(const B of g)if(!e[B])throw new Error(`Formula references "${B}" but it is not loaded.`);l==null||l("Initializing joraw...");const b=await Xie(),w=[];let v=0,x=0;const m=Array.from(g);for(let B=0;B<m.length;B++){const z=m[B],Y=e[z];l==null||l(`Decoding ${z}: ${Y.name} ...`);const G=await Y.arrayBuffer(),$=new b;try{await $.open(new Uint8Array(G));const L=$.getRawImage(),U=L.width,V=L.height,J=new Uint16Array(L.data),K=Kie(J,U,V,r);if(w.length===0)v=U,x=V;else if(U!==v||V!==x)throw new Error(`Dimension mismatch: ${z} is ${U}x${V}, expected ${v}x${x}.`);w.push({key:z,file:Y,width:U,height:V,origU16:J,workF32:K})}finally{$.delete?$.delete():$.close&&$.close()}}if(w.length===0)throw new Error("No referenced RAWs loaded.");l==null||l("Evaluating expression (float domain)...");const k=new Map(w.map(B=>[B.key,B])),P=eoe(h,k,d?o:null);if(s){let B=-1/0;for(let z=0;z<P.length;z++)P[z]>B&&(B=P[z]);if(B>1e-6){const G=(65019-Math.max(...n))/B;l==null||l(`Auto-filling 16bit: Max=${B.toFixed(2)}, Factor=${G.toFixed(4)}`);for(let $=0;$<P.length;$++)P[$]*=G}}l==null||l("Finalizing to 16-bit (add OutputBL pedestal + clip)...");const j=Yie(P,v,x,n),S=qie(j),M=a&&a.length===9?a:[1,0,0,0,1,0,0,0,1],O=await Vie(l);l==null||l("Packing DNG container..."),O.globals.set("js_raw_u16_le",S),O.globals.set("js_width",v),O.globals.set("js_height",x),O.globals.set("js_cfa",String(i||"RGGB")),O.globals.set("js_bl_out",Array.from(n)),O.globals.set("js_cm_flat",M),O.globals.set("js_make","JO-Workstation"),O.globals.set("js_model","StackingTool"),O.globals.set("js_unique_model","JO StackingTool 16bit");const E=await O.runPythonAsync(`
pack_dng_from_u16(
  js_raw_u16_le.to_py(),
  js_width,
  js_height,
  js_cfa,
  js_bl_out.to_py(),
  js_cm_flat.to_py(),
  js_make,
  js_model,
  js_unique_model
)
  `),I=E.toJs();E.destroy&&E.destroy();const D=new Uint8Array(I.byteLength);return D.set(I),D.buffer}const roe=({isOpen:e,onClose:t,zIndex:r,onFocus:n})=>{const[a,i]=_.useState({}),[o,s]=_.useState(0),[l,u]=_.useState("0 0 0 0"),[d,f]=_.useState("0 0 0 0"),[h,g]=_.useState(()=>localStorage.getItem("stacking_formula")||""),[b,w]=_.useState(!0),[v,x]=_.useState("0-14000"),[m,k]=_.useState(!0),[P,j]=_.useState(""),[S,M]=_.useState("RGGB"),[O,E]=_.useState("Idle"),[I,D]=_.useState(!1),[B,z]=_.useState(null),Y=_.useRef(null),G=_.useMemo(()=>Object.keys(hu).sort(),[]);_.useEffect(()=>{localStorage.setItem("stacking_formula",h)},[h]);const $=Q=>{let te="",ee=Q;for(;ee>=0;)te=String.fromCharCode(ee%26+65)+te,ee=Math.floor(ee/26)-1;return te},L=Q=>{if(Q.target.files&&Q.target.files.length>0){const te={...a};let ee=o;Array.from(Q.target.files).forEach(me=>{const re=$(ee++);te[re]=me}),i(te),s(ee)}Q.target.value=""},U=()=>{i({}),s(0),z(null),E("Idle")},V=(Q,te)=>{const ee=Q.trim().split(/[\s,]+/).map(Number);if(ee.length<1||ee.some(isNaN))throw new Error(`Invalid ${te} Black Level format.`);return[ee[0],ee.length>1?ee[1]:ee[0],ee.length>2?ee[2]:ee[0],ee.length>3?ee[3]:ee[0]]},J=async()=>{if(Object.keys(a).length===0){z("No files loaded.");return}if(!h.trim()){z("Please enter a formula.");return}let Q,te;try{Q=V(l,"Input"),te=V(d,"Output")}catch(re){z(re.message);return}let ee=null;if(b){const re=v.split("-").map(De=>parseFloat(De.trim()));if(re.length===2&&!isNaN(re[0])&&!isNaN(re[1]))ee={min:Math.min(re[0],re[1]),max:Math.max(re[0],re[1])};else{z("Invalid ++Range format. Use min-max (e.g., 0-14000).");return}}else if(h.includes("++")){z("Formula contains '++' operator but ++Range is disabled.");return}let me=null;if(P.trim()&&(me=P.trim().split(/[\s,\n]+/).map(Number),me.length!==9||me.some(isNaN))){z("Color Matrix must be 9 numbers.");return}D(!0),z(null),E("Starting...");try{await new Promise(de=>setTimeout(de,50));const re=await toe(a,h,Q,te,me,S,ee,m,de=>E(de));E("Creating Download...");const De=new Blob([re],{type:"image/x-adobe-dng"}),fe=URL.createObjectURL(De),le=document.createElement("a");le.href=fe,le.download=`Stacked_Result_${Date.now()}.dng`,document.body.appendChild(le),le.click(),document.body.removeChild(le),URL.revokeObjectURL(fe),E("Done!")}catch(re){console.error(re),z(re.message),E("Failed")}finally{D(!1)}},K=()=>{f(l)};return e?c.jsxs(ml,{initialPosition:{x:window.innerWidth/2-250,y:100},onClose:t,zIndex:r,onFocus:n,className:"w-[500px] bg-white dark:bg-slate-900 border-2 border-black dark:border-white shadow-2xl flex flex-col font-mono",children:[c.jsxs("div",{className:"flex justify-between items-center px-4 py-2 border-b-2 border-black dark:border-gray-500 bg-emerald-700 text-white",children:[c.jsx("h3",{className:"text-sm font-bold uppercase tracking-widest",children:"Advanced Math Stacking Tool"}),c.jsx("button",{onClick:t,className:"hover:text-red-300 transition-colors",children:""})]}),c.jsxs("div",{className:"p-4 flex flex-col gap-4 overflow-y-auto max-h-[80vh]",children:[c.jsx("div",{className:"h-28 border border-gray-300 dark:border-slate-700 bg-gray-50 dark:bg-black/30 rounded p-2 overflow-y-auto",children:Object.keys(a).length===0?c.jsx("div",{className:"h-full flex items-center justify-center text-gray-400 text-xs",children:"No files loaded. Click 'Add Files' below."}):c.jsx("div",{className:"space-y-1",children:Object.entries(a).map(([Q,te])=>{const ee=te;return c.jsxs("div",{className:"flex justify-between text-xs border-b border-gray-200 dark:border-slate-800 pb-1 last:border-0",children:[c.jsx("span",{className:"font-bold text-emerald-600 dark:text-emerald-400 w-8",children:Q}),c.jsx("span",{className:"truncate text-gray-700 dark:text-slate-300 flex-1",children:ee.name}),c.jsxs("span",{className:"text-gray-400",children:[(ee.size/1024/1024).toFixed(1),"MB"]})]},Q)})})}),c.jsxs("div",{className:"flex flex-col gap-3 flex-shrink-0",children:[c.jsxs("div",{className:"flex gap-2",children:[c.jsx("input",{type:"file",ref:Y,multiple:!0,className:"hidden",onChange:L,accept:".arw,.cr2,.cr3,.dng,.nef,.orf,.raf,.rw2,.pef,.srw,.sr2,.srf,.x3f,.erf,.mef,.mos,.mrw,.kdc,.dcr,.iiq,.3fr,.fff,.rwl,.nrw,.raw,.tif,.tiff"}),c.jsx("button",{onClick:()=>{var Q;return(Q=Y.current)==null?void 0:Q.click()},className:"flex-1 bg-gray-200 hover:bg-gray-300 dark:bg-slate-800 dark:hover:bg-slate-700 py-1 rounded text-xs font-bold transition-colors",children:"Add Files"}),c.jsx("button",{onClick:U,className:"px-3 bg-red-100 hover:bg-red-200 dark:bg-red-900/30 dark:hover:bg-red-900/50 text-red-600 dark:text-red-400 py-1 rounded text-xs font-bold transition-colors",children:"Clear"})]}),c.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[c.jsxs("div",{className:"flex flex-col gap-2",children:[c.jsxs("div",{children:[c.jsx("label",{className:"text-[10px] font-bold text-gray-500 dark:text-slate-400 uppercase block mb-1",children:"Input BL (Subtract)"}),c.jsx("input",{type:"text",value:l,onChange:Q=>u(Q.target.value),className:"w-full text-xs px-2 py-1 bg-white dark:bg-slate-900 border border-gray-300 dark:border-slate-600 rounded outline-none"}),c.jsx("div",{className:"text-[9px] text-gray-400 mt-0.5",children:"(0,0), (0,1), (1,0), (1,1)"})]}),c.jsxs("div",{children:[c.jsx("label",{className:"text-[10px] font-bold text-gray-500 dark:text-slate-400 uppercase block mb-1",children:"Output BL (Add to Result)"}),c.jsxs("div",{className:"flex gap-1",children:[c.jsx("input",{type:"text",value:d,onChange:Q=>f(Q.target.value),className:"w-full text-xs px-2 py-1 bg-white dark:bg-slate-900 border border-gray-300 dark:border-slate-600 rounded outline-none"}),c.jsx("button",{onClick:K,className:"px-2 bg-gray-200 dark:bg-slate-700 hover:bg-gray-300 rounded text-[9px]",title:"Copy Input to Output",children:""})]})]})]}),c.jsxs("div",{className:"flex flex-col justify-end",children:[c.jsx("label",{className:"text-[10px] font-bold text-gray-500 dark:text-slate-400 uppercase block mb-1",children:"Options"}),c.jsxs("label",{className:"flex items-center gap-1.5 cursor-pointer mb-2",children:[c.jsx("input",{type:"checkbox",checked:m,onChange:Q=>k(Q.target.checked),className:"rounded text-emerald-600 focus:ring-emerald-500"}),c.jsx("span",{className:"text-[10px] font-bold uppercase text-emerald-600 dark:text-emerald-400",children:"16bit (Auto Fill)"})]}),c.jsxs("div",{className:"flex items-center gap-1 mt-1",children:[c.jsx("input",{type:"checkbox",checked:b,onChange:Q=>w(Q.target.checked),className:"rounded",title:"Enable Conditional ++ Operator"}),c.jsx("span",{className:`text-[9px] font-bold uppercase ${b?"text-indigo-600 dark:text-indigo-400":"text-gray-400"}`,children:"++Range:"}),c.jsx("input",{type:"text",value:v,onChange:Q=>x(Q.target.value),disabled:!b,placeholder:"min-max",className:"w-full text-[10px] px-1 py-0.5 bg-white dark:bg-slate-900 border border-gray-300 dark:border-slate-600 rounded outline-none disabled:opacity-50"})]})]})]}),c.jsxs("div",{children:[c.jsx("label",{className:"text-[10px] font-bold text-gray-500 dark:text-slate-400 uppercase block mb-1",children:"Math Formula ( + - * / and ++ )"}),c.jsx("textarea",{value:h,onChange:Q=>g(Q.target.value),placeholder:"e.g. (A+B)/2 or A ++ 4*B",className:"w-full h-14 text-xs px-2 py-1 bg-white dark:bg-slate-900 border border-gray-300 dark:border-slate-600 rounded outline-none resize-none font-mono"}),c.jsxs("p",{className:"text-[9px] text-gray-400 mt-1 leading-tight",children:["Operators: +, -, *, /, ( ). ",c.jsx("br",{}),c.jsx("span",{className:"text-indigo-400 font-bold",children:"++"})," Operator: ",c.jsx("code",{children:"A ++ B"}),' means "Use B if B is in range, else use A". ',c.jsx("br",{}),"Inputs are linearized float32 (Raw - InputBL)."]})]}),c.jsxs("div",{className:"grid grid-cols-3 gap-2 items-end",children:[c.jsxs("div",{className:"col-span-2",children:[c.jsxs("div",{className:"flex justify-between items-end",children:[c.jsx("label",{className:"text-[10px] font-bold text-gray-500 dark:text-slate-400 uppercase",children:"Color Matrix (9 vals)"}),c.jsxs("select",{className:"text-[9px] bg-gray-100 dark:bg-slate-800 border border-black dark:border-slate-500 rounded-none px-1 py-0.5 max-w-[120px] cursor-pointer",onChange:Q=>{const te=hu[Q.target.value];te&&j(te),Q.target.value=""},defaultValue:"",children:[c.jsx("option",{value:"",disabled:!0,children:"Presets..."}),G.map(Q=>c.jsx("option",{value:Q,children:Q},Q))]})]}),c.jsx("input",{type:"text",value:P,onChange:Q=>j(Q.target.value),placeholder:"e.g. 1 0 0 0 1 0 0 0 1",className:"w-full text-xs px-2 py-1 bg-white dark:bg-slate-900 border border-gray-300 dark:border-slate-600 rounded outline-none mt-1"})]}),c.jsxs("div",{children:[c.jsx("label",{className:"text-[10px] font-bold text-gray-500 dark:text-slate-400 uppercase block mb-1",children:"CFA Pattern"}),c.jsxs("select",{value:S,onChange:Q=>M(Q.target.value),className:"w-full bg-white dark:bg-slate-900 border border-gray-300 dark:border-slate-600 rounded px-1 py-1 text-xs font-bold",children:[c.jsx("option",{value:"RGGB",children:"RGGB"}),c.jsx("option",{value:"BGGR",children:"BGGR"}),c.jsx("option",{value:"GBRG",children:"GBRG"}),c.jsx("option",{value:"GRBG",children:"GRBG"})]})]})]}),B&&c.jsx("div",{className:"text-red-500 text-xs bg-red-50 dark:bg-red-900/20 p-2 rounded text-center font-bold",children:B}),c.jsxs("div",{className:"flex items-center gap-2 mt-2",children:[c.jsx("div",{className:"flex-1 text-xs text-emerald-600 dark:text-emerald-400 font-bold truncate",children:O}),c.jsx("button",{onClick:J,disabled:I,className:`px-6 py-2 text-sm font-bold uppercase tracking-wide text-white rounded shadow-md transition-all active:scale-95 ${I?"bg-gray-400 cursor-wait":"bg-emerald-600 hover:bg-emerald-500"}`,children:"Process & Save DNG"})]})]})]})]}):null},noe=`
import struct
import numpy as np

class Type:
    Short = (3,2); Long = (4,4); Rational = (5,8); Ascii = (2,1); Byte = (1,1)
    Undefined = (7,1); Srational = (10,8); IFD = (13,4)

class Tag:
    NewSubfileType = (254, Type.Long); ImageWidth = (256, Type.Long); ImageLength = (257, Type.Long)
    BitsPerSample = (258, Type.Short); Compression = (259, Type.Short)
    PhotometricInterpretation = (262, Type.Short); Make = (271, Type.Ascii); Model = (272, Type.Ascii)
    StripOffsets = (273, Type.Long); Orientation = (274, Type.Short); SamplesPerPixel = (277, Type.Short)
    RowsPerStrip = (278, Type.Short); StripByteCounts = (279, Type.Long)
    CFARepeatPatternDim = (33421, Type.Short); CFAPattern = (33422, Type.Byte)
    DNGVersion = (50706, Type.Byte); UniqueCameraModel = (50708, Type.Ascii)
    BlackLevel = (50714, Type.Short); WhiteLevel = (50717, Type.Short)
    ColorMatrix1 = (50721, Type.Srational); CalibrationIlluminant1 = (50778, Type.Short)
    BlackLevelRepeatDim = (50713, Type.Short)

class Compression: Uncompressed = 1
class PhotometricInterpretation: Color_Filter_Array = 32803
class CFAPattern: BGGR=[2,1,1,0]; GBRG=[1,2,0,1]; GRBG=[1,0,2,1]; RGGB=[0,1,1,2]

class dngTag(object):
    def __init__(self, tagType, value=[]):
        self.TagId = tagType[0]
        self.DataType = tagType[1]
        self.DataCount = len(value) if not isinstance(value, str) else len(value) + 1
        self.Value = self._pack_value(tagType[1], value)
        self.DataLength = len(self.Value)
        self.selfContained = (self.DataLength <= 4)
        self.DataOffset = 0

    def _pack_value(self, dtype, value):
        tid = dtype[0]
        if tid == 1: return struct.pack('<%sB' % len(value), *value)
        elif tid == 3: return struct.pack('<%sH' % len(value), *value)
        elif tid == 4: return struct.pack('<%sL' % len(value), *value)
        elif tid == 2: return struct.pack('<%ss' % len(value), value.encode("ascii")) + b'\\x00'
        elif tid == 5 or tid == 10: 
            flat = [item for sublist in value for item in sublist]
            fmt = 'L' if tid == 5 else 'l'
            return struct.pack('<%s%s' % (len(flat), fmt), *flat)
        return b''

    def write_directory(self, buf, offset):
        if self.selfContained:
            val = self.Value + b'\\x00' * (4 - len(self.Value))
            struct.pack_into("<HHI4s", buf, offset, self.TagId, self.DataType[0], self.DataCount, val)
        else:
            struct.pack_into("<HHII", buf, offset, self.TagId, self.DataType[0], self.DataCount, self.DataOffset)

    def write_data(self, buf):
        if not self.selfContained:
            struct.pack_into(f"<{len(self.Value)}s", buf, self.DataOffset, self.Value)

def convert_to_dng(raw_bytes, width, height, cfa_str, black_level_list, shift, linear_shift, cm_flat):
    # 1. Pixel Data Processing
    # Ensure raw_bytes is a bytes-like object
    raw_data = np.frombuffer(raw_bytes, dtype=np.uint16).copy()
    
    # Use int32 for calculations
    raw_data = raw_data.astype(np.int32)

    # Apply Bit Shift (<<)
    if shift > 0:
        raw_data = raw_data * (1 << shift)
    
    # Apply Linear Offset (+)
    if linear_shift != 0:
        raw_data = raw_data + linear_shift

    # Clip to 16-bit range
    raw_data = np.clip(raw_data, 0, 65535).astype(np.uint16)

    # 2. Metadata Preparation
    white_level = 65019
    # Format Color Matrix for Srational (Value, Denominator)
    color_matrix = [[int(x * 10000), 10000] for x in cm_flat]

    cfa_map = {"BGGR": CFAPattern.BGGR, "GBRG": CFAPattern.GBRG, "GRBG": CFAPattern.GRBG, "RGGB": CFAPattern.RGGB}
    
    tags = [
        dngTag(Tag.NewSubfileType, [0]),
        dngTag(Tag.ImageWidth, [width]),
        dngTag(Tag.ImageLength, [height]),
        dngTag(Tag.BitsPerSample, [16]), 
        dngTag(Tag.Compression, [Compression.Uncompressed]),
        dngTag(Tag.PhotometricInterpretation, [PhotometricInterpretation.Color_Filter_Array]),
        dngTag(Tag.Make, "JO-Workstation"),
        dngTag(Tag.Model, "Z8-Rescued"),
        dngTag(Tag.SamplesPerPixel, [1]),
        dngTag(Tag.RowsPerStrip, [height]), 
        dngTag(Tag.CFARepeatPatternDim, [2, 2]),
        dngTag(Tag.CFAPattern, cfa_map.get(cfa_str.upper(), CFAPattern.RGGB)),
        dngTag(Tag.BlackLevelRepeatDim, [2, 2]),
        dngTag(Tag.BlackLevel, [int(x) for x in black_level_list]),
        dngTag(Tag.WhiteLevel, [white_level]),
        dngTag(Tag.ColorMatrix1, color_matrix),
        dngTag(Tag.CalibrationIlluminant1, [21]),
        dngTag(Tag.DNGVersion, [1, 4, 0, 0]),
        dngTag(Tag.UniqueCameraModel, "Nikon Z 8") 
    ]
    
    pixel_bytes = raw_data.tobytes()
    tags.append(dngTag(Tag.StripOffsets, [0])) 
    tags.append(dngTag(Tag.StripByteCounts, [len(pixel_bytes)]))
    tags.sort(key=lambda x: x.TagId)
    
    ifd_size = 2 + (len(tags) * 12) + 4
    current_data_offset = 8 + ifd_size
    
    for tag in tags:
        if not tag.selfContained:
            tag.DataOffset = current_data_offset
            current_data_offset = (current_data_offset + tag.DataLength + 3) & 0xFFFFFFFC
            
    img_offset = current_data_offset
    for tag in tags:
        if tag.TagId == Tag.StripOffsets[0]:
            tag.Value = struct.pack('<L', img_offset)
            break
            
    buf = bytearray(img_offset + len(pixel_bytes))
    struct.pack_into("<ccbbI", buf, 0, b'I', b'I', 0x2A, 0x00, 8)
    struct.pack_into("<H", buf, 8, len(tags))
    
    offset = 10
    for tag in tags:
        tag.write_directory(buf, offset)
        offset += 12
        
    struct.pack_into("<I", buf, offset, 0)
    for tag in tags:
        tag.write_data(buf)
        
    buf[img_offset:img_offset+len(pixel_bytes)] = pixel_bytes
    return bytes(buf)
`,aoe=[1.1423,-.4564,-.1123,-.4816,1.2895,.2119,-.021,.1061,.7282],ioe=[4032,4032,4032,4032],ooe=2,soe=({isOpen:e,onClose:t,zIndex:r=250,onFocus:n})=>{const[a,i]=_.useState(!0),[o,s]=_.useState(!1),[l,u]=_.useState(""),d=_.useRef(null),f=_.useRef(null);_.useEffect(()=>{e&&!d.current&&(async()=>{try{const b=await window.loadPyodide();await b.loadPackage("numpy"),await b.runPythonAsync(noe),d.current=b,i(!1)}catch(b){console.error("Pyodide Init Failed",b),u("Error loading Python environment.")}})()},[e]);const h=async g=>{if(!g.target.files||g.target.files.length===0||!d.current)return;const b=Array.from(g.target.files);s(!0),u("Starting batch...");const w=d.current;for(let v=0;v<b.length;v++){const x=b[v];u(`Processing ${v+1}/${b.length}: ${x.name}`);try{const m=await x.arrayBuffer(),k=await pu(m),{data:P,width:j,height:S}=k,M=[[0,0,0],[0,0,0],[0,0,0],[0,0,0]];for(let $=0;$<S;$+=2){const L=$*j,U=($+1)*j;for(let V=0;V<j;V+=2){const J=[L+V,L+V+1,U+V,U+V+1];for(let K=0;K<4;K++){const Q=P[J[K]];Q>=1006&&Q<=1008&&M[K][Q-1006]++}}}const O=[-1,-1,-1,-1];for(let $=0;$<4;$++){const L=M[$][0],U=M[$][1],V=M[$][2];V<U?O[$]=1007:V>U&&U<L&&(O[$]=1006)}let E=!1;if(O.some($=>$>-1)){E=!0;for(let $=0;$<S;$+=2){const L=$*j,U=($+1)*j;for(let V=0;V<j;V+=2){const J=[L+V,L+V+1,U+V,U+V+1];for(let K=0;K<4;K++){const Q=O[K];Q>-1&&P[J[K]]<=Q&&(P[J[K]]+=1)}}}}w.globals.set("js_raw_bytes",new Uint8Array(P.buffer,P.byteOffset,P.byteLength)),w.globals.set("js_width",j),w.globals.set("js_height",S),w.globals.set("js_cfa","RGGB"),w.globals.set("js_bl_list",ioe),w.globals.set("js_shift",ooe),w.globals.set("js_linear_shift",0),w.globals.set("js_cm_flat",aoe);const I=await w.runPythonAsync(`
                    convert_to_dng(
                        js_raw_bytes.to_py(), 
                        js_width, 
                        js_height, 
                        js_cfa, 
                        js_bl_list.to_py(), 
                        js_shift,
                        js_linear_shift,
                        js_cm_flat.to_py()
                    )
                `),D=I.toJs();I.destroy();const B=new Blob([D],{type:"image/x-adobe-dng"}),z=URL.createObjectURL(B),Y=document.createElement("a");Y.href=z;const G=x.name.substring(0,x.name.lastIndexOf("."))||"image";Y.download=`${G}_Z8Rescued_16bit.dng`,document.body.appendChild(Y),Y.click(),document.body.removeChild(Y),URL.revokeObjectURL(z),await new Promise($=>setTimeout($,100))}catch(m){console.error(`Error processing ${x.name}`,m),u(`Error on ${x.name}: ${m.message}`)}}s(!1),u("Batch Complete."),g.target.value=""};return e?c.jsxs(ml,{initialPosition:{x:window.innerWidth/2-200,y:150},onClose:t,zIndex:r,onFocus:n,className:"w-[400px] bg-white dark:bg-slate-900 border-2 border-red-600 shadow-[8px_8px_0px_rgba(220,38,38,0.3)] rounded-none flex flex-col font-mono",children:[c.jsxs("div",{className:"flex justify-between items-center px-4 py-2 bg-red-600 text-white border-b-2 border-black dark:border-white",children:[c.jsxs("h3",{className:"text-sm font-bold uppercase tracking-widest flex items-center gap-2",children:[c.jsx("span",{className:"text-xl",children:""}),"  Z8 (Z8 Rescue)"]}),c.jsx("button",{onClick:t,className:"hover:text-black transition-colors font-bold",children:""})]}),c.jsx("div",{className:"p-6 flex flex-col gap-4",children:a?c.jsxs("div",{className:"flex flex-col items-center justify-center py-4",children:[c.jsx("div",{className:"w-6 h-6 border-4 border-red-600 border-t-transparent animate-spin rounded-full"}),c.jsx("p",{className:"text-xs mt-2 text-gray-500",children:"Loading Python Kernel..."})]}):c.jsxs(c.Fragment,{children:[c.jsxs("div",{className:"bg-red-50 dark:bg-red-900/10 border border-red-200 dark:border-red-800 p-3 text-[10px] text-gray-700 dark:text-gray-300 leading-relaxed",children:[c.jsx("strong",{className:"block mb-1 text-red-600 dark:text-red-400",children:"Logic:"}),"1. iso64 preferred",c.jsx("br",{}),"2. PTC",c.jsx("br",{}),"3. Apply bit-shift (x4) to 16-bit.",c.jsx("br",{}),"4. Export DNG with BL=4032 & Z8 Matrix."]}),c.jsxs("div",{className:"flex flex-col gap-2",children:[c.jsx("input",{type:"file",ref:f,multiple:!0,accept:".nef,.dng",className:"hidden",onChange:h}),c.jsx("button",{onClick:()=>{var g;return(g=f.current)==null?void 0:g.click()},disabled:o,className:`w-full py-3 font-bold uppercase text-xs tracking-widest shadow-md transition-all active:translate-y-1 ${o?"bg-gray-400 text-gray-700 cursor-wait":"bg-red-600 hover:bg-red-500 text-white border-2 border-black dark:border-white"}`,children:o?"Rescuing...":"Select Z8 Files & Rescue"})]}),l&&c.jsx("div",{className:"text-center text-[10px] font-bold text-red-600 dark:text-red-400 border-t border-gray-200 dark:border-slate-800 pt-2 animate-pulse",children:l})]})})]}):null};function X4(e,t,r,n=3){const i=r.byteLength,o=8,s=o+i,l=[{id:256,type:4,count:1,value:e},{id:257,type:4,count:1,value:t},{id:258,type:3,count:n,value:n===1?16:[16,16,16]},{id:259,type:3,count:1,value:1},{id:262,type:3,count:1,value:n===1?1:2},{id:273,type:4,count:1,value:o},{id:277,type:3,count:1,value:n},{id:278,type:4,count:1,value:t},{id:279,type:4,count:1,value:i}],u=2+l.length*12+4;let d=0;const f=l.map(m=>{let k=m.type===3?2:4;const P=m.count*k,j=P<=4;let S=0;return j||(S=d,d+=P),{...m,fits:j,totalBytes:P,extraOffset:S}}),h=s+u+d,g=new ArrayBuffer(h),b=new DataView(g),w=new Uint8Array(g);b.setUint16(0,18761,!0),b.setUint16(2,42,!0),b.setUint32(4,s,!0),w.set(new Uint8Array(r.buffer,r.byteOffset,r.byteLength),o);let v=s;b.setUint16(v,l.length,!0),v+=2;const x=s+u;return f.forEach(m=>{if(b.setUint16(v,m.id,!0),b.setUint16(v+2,m.type,!0),b.setUint32(v+4,m.count,!0),m.fits)Array.isArray(m.value)||(m.type===3?b.setUint16(v+8,m.value,!0):b.setUint32(v+8,m.value,!0));else{const k=x+m.extraOffset;b.setUint32(v+8,k,!0),Array.isArray(m.value)&&m.value.forEach((P,j)=>{b.setUint16(k+j*2,P,!0)})}v+=12}),b.setUint32(v,0,!0),g}const loe="http://localhost:5428",coe=(e=!1)=>{const[t,r]=_.useState({isConnected:!1,message:"Initializing...",hasDngConverter:!1});return _.useEffect(()=>{if(e){r({isConnected:!1,message:"Bridge Paused",hasDngConverter:!1});return}const n=async()=>{try{const i=new AbortController,o=setTimeout(()=>i.abort(),1e3),s=await fetch(`${loe}/health`,{method:"GET",signal:i.signal});if(clearTimeout(o),s.ok){const l=await s.json(),u=`Connected (${l.exiftool||"Ready"})`;r(d=>d.isConnected===!0&&d.message===u&&d.version===l.exiftool&&d.hasDngConverter===!!l.dng_converter?d:{isConnected:!0,message:u,version:l.exiftool,hasDngConverter:!!l.dng_converter})}else r(l=>l.isConnected===!1&&l.message==="Service Error"?l:{isConnected:!1,message:"Service Error",hasDngConverter:!1})}catch{r(o=>o.isConnected===!1&&o.message==="Not Detected"?o:{isConnected:!1,message:"Not Detected",hasDngConverter:!1})}};n();const a=setInterval(n,2e3);return()=>clearInterval(a)},[e]),t},uoe="JTR_BlobStore",Bo="raw_files",doe=1,Tm=()=>new Promise((e,t)=>{const r=indexedDB.open(uoe,doe);r.onupgradeneeded=n=>{const a=n.target.result;a.objectStoreNames.contains(Bo)||a.createObjectStore(Bo)},r.onsuccess=()=>e(r.result),r.onerror=()=>t(r.error)}),foe=async(e,t)=>{const r=await Tm();return new Promise((n,a)=>{const i=r.transaction(Bo,"readwrite");i.objectStore(Bo).put(t,e),i.oncomplete=()=>n(),i.onerror=()=>a(i.error)})},hoe=async e=>{const t=await Tm();return new Promise((r,n)=>{const o=t.transaction(Bo,"readonly").objectStore(Bo).get(e);o.onsuccess=()=>r(o.result),o.onerror=()=>n(o.error)})},poe=async()=>{const e=await Tm();return new Promise((t,r)=>{const n=e.transaction(Bo,"readwrite");n.objectStore(Bo).clear(),n.oncomplete=()=>t(),n.onerror=()=>r(n.error)})},OO="jtr_workspace_index",goe=e=>{try{const t=JSON.stringify(e);localStorage.setItem(OO,t)}catch(t){console.error("Failed to save workspace index",t)}},moe=()=>{try{const e=localStorage.getItem(OO);return e?JSON.parse(e):null}catch(e){return console.error("Failed to load workspace index",e),null}},yoe=async e=>{const n=(await Tm()).transaction(Bo,"readwrite").objectStore(Bo),a=n.getAllKeys();a.onsuccess=()=>{a.result.forEach(o=>{e.includes(o)||n.delete(o)})}},xoe=[{x:3050,y:1973},{x:4245,y:1980},{x:3043,y:2870},{x:4243,y:2876}],voe=1195,K4=150,Y4=50,boe=[{x:3528,y:2437.5,ori:2},{x:3775,y:2419,ori:2},{x:3638.5,y:2303,ori:1},{x:3653,y:2548.5,ori:1},{x:3082,y:2413,ori:2},{x:2825,y:2427,ori:2},{x:2946,y:2300.5,ori:1},{x:2966,y:2550,ori:1},{x:3638.5,y:3e3,ori:1},{x:3657.5,y:3248.5,ori:1},{x:3521.5,y:3135,ori:2},{x:3770,y:3108.5,ori:2},{x:4375.5,y:3064.5,ori:2},{x:4620.5,y:3040,ori:2},{x:4486.5,y:2934,ori:1},{x:4509.5,y:3182.5,ori:1},{x:2066.5,y:1726,ori:2},{x:2176.5,y:1597,ori:1},{x:2194.5,y:1843,ori:1},{x:2313.5,y:1705,ori:2},{x:2675.5,y:1799.5,ori:2},{x:2789.5,y:1674,ori:1},{x:2926,y:1787.5,ori:2},{x:2810.5,y:1921.5,ori:1},{x:4380.5,y:1816,ori:2},{x:4497.5,y:1687,ori:1},{x:4513,y:1934.5,ori:1},{x:4628,y:1799.5,ori:2},{x:5099,y:1622.5,ori:1},{x:4985.5,y:1751,ori:2},{x:5122,y:1867.5,ori:1},{x:5229,y:1732,ori:2},{x:2194.5,y:2428,ori:2},{x:2305.5,y:2295.5,ori:1},{x:2327,y:2544,ori:1},{x:2442,y:2405,ori:2},{x:3530.5,y:1741.5,ori:2},{x:3640.5,y:1610,ori:1},{x:3777.5,y:1719.5,ori:2},{x:3666,y:1856.5,ori:1},{x:4222,y:2443.5,ori:2},{x:4470.5,y:2422,ori:2},{x:4334.5,y:2309,ori:1},{x:4356.5,y:2554,ori:1},{x:4965,y:2313,ori:1},{x:4852.5,y:2446,ori:2},{x:4987,y:2561,ori:1},{x:5097,y:2427,ori:2},{x:4981.5,y:3141.5,ori:2},{x:5096,y:3009,ori:1},{x:5222.5,y:3122.5,ori:2},{x:5115.5,y:3256.5,ori:1},{x:2779,y:2928,ori:1},{x:2667,y:3064.5,ori:2},{x:2799,y:3173.5,ori:1},{x:2917.5,y:3043,ori:2},{x:2167.5,y:2993,ori:1},{x:2052,y:3130,ori:2},{x:2187.5,y:3243.5,ori:1},{x:2304.5,y:3108.5,ori:2}];function woe(e,t){let r=[],n=[];for(let o=0;o<4;o++){let s=e[o].x,l=e[o].y,u=t[o].x,d=t[o].y;r.push([s,l,1,0,0,0,-s*u,-l*u]),r.push([0,0,0,s,l,1,-s*d,-l*d]),n.push(u),n.push(d)}const a=8;for(let o=0;o<a;o++){let s=o;for(let l=o+1;l<a;l++)Math.abs(r[l][o])>Math.abs(r[s][o])&&(s=l);[r[o],r[s]]=[r[s],r[o]],[n[o],n[s]]=[n[s],n[o]];for(let l=o+1;l<a;l++){const u=r[l][o]/r[o][o];n[l]-=u*n[o];for(let d=o;d<a;d++)r[l][d]-=u*r[o][d]}}const i=new Array(a).fill(0);for(let o=a-1;o>=0;o--){let s=0;for(let l=o+1;l<a;l++)s+=r[o][l]*i[l];i[o]=(n[o]-s)/r[o][o]}return[[i[0],i[1],i[2]],[i[3],i[4],i[5]],[i[6],i[7],1]]}function koe(e,t,r){const n=e[2][0]*t+e[2][1]*r+e[2][2];return{x:(e[0][0]*t+e[0][1]*r+e[0][2])/n,y:(e[1][0]*t+e[1][1]*r+e[1][2])/n}}function Soe(e){if(e.length!==4)return[];const t=woe(xoe,e),n=Math.hypot(e[1].x-e[0].x,e[1].y-e[0].y)/voe;return boe.map(a=>{const i=koe(t,a.x,a.y);let o,s;return a.ori===1?(o=K4*n,s=Y4*n):(o=Y4*n,s=K4*n),{x:i.x-o/2,y:i.y-s/2,w:o,h:s,ori:a.ori}})}const joe=[[3.2404542,-1.5371385,-.4985314],[-.969266,1.8760108,.041556],[.0556434,-.2040259,1.0572252]];function Poe(e){const t=e.length;if(t===0)return 16383;const r=Math.max(1,Math.floor(t/1e6));let n=0;for(let a=0;a<t;a+=r){const i=e[a];i>n&&(n=i)}return n>17e3?65535:16383}const _oe=`
struct Uniforms {
    width: u32,
    height: u32,
    whiteLevel: f32,
    exposureScale: f32,

    bl0: f32, bl1: f32, bl2: f32, bl3: f32,
    wb0: f32, wb1: f32, wb2: f32, wb3: f32,

    cm0: f32, cm1: f32, cm2: f32,
    cm3: f32, cm4: f32, cm5: f32,
    cm6: f32, cm7: f32, cm8: f32,

    renderMode: u32,
    isBGGR: u32,
    colorDemosaicMode: u32,

    neutral0: f32, neutral1: f32, neutral2: f32,

    hlrEnabled: u32,
    
    // Export specific flags (packed into padding or new fields)
    exportStretch: u32, 
    exportSrgb: u32,
};

struct UnmixParams {
    bl0: f32, bl1: f32, bl2: f32, bl3: f32,
    bg0: f32, bg1: f32, bg2: f32, bg3: f32,
    fg0: f32, fg1: f32, fg2: f32, fg3: f32,
};

@group(0) @binding(0) var<uniform> u : Uniforms;
@group(0) @binding(1) var<storage, read> rawData : array<u32>;
@group(0) @binding(3) var<uniform> unmix : UnmixParams;
@group(0) @binding(4) var<storage, read> lut : array<f32>; // 1024 float buffer

fn srgb_gamma(linear: f32) -> f32 {
    if (linear <= 0.0031308) { return 12.92 * linear; }
    return 1.055 * pow(linear, 1.0 / 2.4) - 0.055;
}

fn clamp01(x: f32) -> f32 { return max(0.0, min(1.0, x)); }
fn clamp_i32(v: i32, lo: i32, hi: i32) -> i32 { return max(lo, min(v, hi)); }

fn smootherstep(edge0: f32, edge1: f32, x: f32) -> f32 {
    let t = clamp01((x - edge0) / max(edge1 - edge0, 1e-6));
    return t*t*t*(t*(t*6.0 - 15.0) + 10.0);
}

fn get_raw_val(idx: u32) -> f32 {
    let u32Idx = idx / 2u;
    let shift = (idx % 2u) * 16u;
    let packed = rawData[u32Idx];
    return f32((packed >> shift) & 0xFFFFu);
}

fn get_bayer_idx(x: u32, y: u32) -> u32 {
    let rowIsOdd = (y % 2u);
    let colIsOdd = (x % 2u);
    return (rowIsOdd * 2u) + colIsOdd;
}

fn get_norm_pixel(x: i32, y: i32) -> f32 {
    let w = i32(u.width);
    let h = i32(u.height);
    let sx = clamp_i32(x, 0, w - 1);
    let sy = clamp_i32(y, 0, h - 1);
    let sxu = u32(sx);
    let syu = u32(sy);
    let idx = syu * u.width + sxu;
    let rawVal = get_raw_val(idx);
    let bIdx = get_bayer_idx(sxu, syu);

    var bl = 0.0;
    var wb = 1.0;
    if (bIdx == 0u) { bl = u.bl0; wb = u.wb0; }
    else if (bIdx == 1u) { bl = u.bl1; wb = u.wb1; }
    else if (bIdx == 2u) { bl = u.bl2; wb = u.wb2; }
    else { bl = u.bl3; wb = u.wb3; }

    let denom = max(u.whiteLevel - bl, 1.0);
    let val = max(0.0, rawVal - bl);
    return (val / denom) * wb;
}

fn shoulder_hue_preserve(rgbIn: vec3f) -> vec3f {
    var rgb = rgbIn;
    let knee = 0.90;
    let mx = max(rgb.x, max(rgb.y, rgb.z));
    if (mx <= knee) { return rgb; }
    let d = mx - knee;
    let mx2 = knee + (d * (1.0 - knee)) / (d + (1.0 - knee));
    let s = mx2 / max(mx, 1e-6);
    return rgb * s;
}

fn apply_lut(val: f32, offset: u32) -> f32 {
    let v = clamp01(val);
    let pos = v * 255.0;
    let idx = u32(pos);
    let f = fract(pos);
    let p0 = lut[offset + idx];
    let idxNext = min(idx + 1u, 255u);
    let p1 = lut[offset + idxNext];
    return mix(p0, p1, f);
}

fn interp_green_edge(xi: i32, yi: i32) -> f32 {
    let left = get_norm_pixel(xi - 1, yi);
    let right = get_norm_pixel(xi + 1, yi);
    let up = get_norm_pixel(xi, yi - 1);
    let down = get_norm_pixel(xi, yi + 1);
    let gradH = abs(left - right);
    let gradV = abs(up - down);
    if (gradH + 1e-6 < gradV) { return (left + right) * 0.5; }
    if (gradV + 1e-6 < gradH) { return (up + down) * 0.5; }
    return (left + right + up + down) * 0.25;
}

fn interp_diag_edge(xi: i32, yi: i32) -> f32 {
    let d1a = get_norm_pixel(xi - 1, yi - 1);
    let d1b = get_norm_pixel(xi + 1, yi + 1);
    let d2a = get_norm_pixel(xi + 1, yi - 1);
    let d2b = get_norm_pixel(xi - 1, yi + 1);
    let gradD1 = abs(d1a - d1b);
    let gradD2 = abs(d2a - d2b);
    if (gradD1 + 1e-6 < gradD2) { return (d1a + d1b) * 0.5; }
    if (gradD2 + 1e-6 < gradD1) { return (d2a + d2b) * 0.5; }
    return (d1a + d1b + d2a + d2b) * 0.25;
}
`,Coe=`
    let x = global_id.x;
    let y = global_id.y;
    if (x >= u.width || y >= u.height) { return; }
    let idx = y * u.width + x;

    var finalR: f32 = 0.0;
    var finalG: f32 = 0.0;
    var finalB: f32 = 0.0;
    
    // We compute 'linear-ish' float values first. 
    // In standard modes, these are 0..1.

    // MODE 0: mosaic gray
    if (u.renderMode == 0u) {
        let rawVal = get_raw_val(idx);
        let bIdx = get_bayer_idx(x, y);
        var bl = 0.0; var wb = 1.0;
        if (bIdx == 0u) { bl = u.bl0; wb = u.wb0; }
        else if (bIdx == 1u) { bl = u.bl1; wb = u.wb1; }
        else if (bIdx == 2u) { bl = u.bl2; wb = u.wb2; }
        else { bl = u.bl3; wb = u.wb3; }

        let val = max(0.0, rawVal - bl);
        var norm = val / max(u.whiteLevel - bl, 1.0);
        norm = clamp01(norm * u.exposureScale * wb);
        // Note: Gamma is applied at output stage for modularity
        finalR = norm; finalG = norm; finalB = norm;
    }
    // MODE 2: advanced unmix
    else if (u.renderMode == 2u) {
        let rawVal = get_raw_val(idx);
        let bIdx = get_bayer_idx(x, y);
        var bl = 0.0; var bg = 0.0; var fg = 0.0;
        if (bIdx == 0u) { bl = unmix.bl0; bg = unmix.bg0; fg = unmix.fg0; }
        else if (bIdx == 1u) { bl = unmix.bl1; bg = unmix.bg1; fg = unmix.fg1; }
        else if (bIdx == 2u) { bl = unmix.bl2; bg = unmix.bg2; fg = unmix.fg2; }
        else { bl = unmix.bl3; bg = unmix.bg3; fg = unmix.fg3; }

        let ref_bg = (unmix.bg1 + unmix.bg3) * 0.5;
        let ref_fg = (unmix.fg1 + unmix.fg3) * 0.5;
        let img_linear = max(0.0, rawVal - bl);
        let denom = fg - bg;
        var alpha = 0.0;
        if (abs(denom) > 1e-9) { alpha = (img_linear - bg) / denom; }

        var val = 0.0;
        if (alpha < 0.0) { val = img_linear * (ref_bg / max(bg, 1e-9)); }
        else if (alpha > 1.0) { val = img_linear * (ref_fg / max(fg, 1e-9)); }
        else { val = (1.0 - alpha) * ref_bg + alpha * ref_fg; }

        var norm = clamp01((val * u.exposureScale) / 65535.0);
        finalR = norm; finalG = norm; finalB = norm;
    }
    // MODE 1: color (bilinear or edge-aware)
    else {
        let xi = i32(x); let yi = i32(y);
        let rowIsOdd = (yi & 1); let colIsOdd = (xi & 1);
        var isRed = false; var isBlue = false;
        if (rowIsOdd == 0 && colIsOdd == 0) {
            if (u.isBGGR == 1u) { isBlue = true; } else { isRed = true; }
        } else if (rowIsOdd == 1 && colIsOdd == 1) {
            if (u.isBGGR == 1u) { isRed = true; } else { isBlue = true; }
        }

        var r_lin: f32 = 0.0; var g_lin: f32 = 0.0; var b_lin: f32 = 0.0;
        let useEdgeAware = (u.colorDemosaicMode == 1u);
        if (isRed) {
            r_lin = get_norm_pixel(xi, yi);
            if (useEdgeAware) {
                g_lin = interp_green_edge(xi, yi);
                b_lin = interp_diag_edge(xi, yi);
            } else {
                g_lin = (get_norm_pixel(xi, yi-1) + get_norm_pixel(xi, yi+1) + get_norm_pixel(xi-1, yi) + get_norm_pixel(xi+1, yi)) * 0.25;
                b_lin = (get_norm_pixel(xi-1, yi-1) + get_norm_pixel(xi+1, yi-1) + get_norm_pixel(xi-1, yi+1) + get_norm_pixel(xi+1, yi+1)) * 0.25;
            }
        } else if (isBlue) {
            b_lin = get_norm_pixel(xi, yi);
            if (useEdgeAware) {
                g_lin = interp_green_edge(xi, yi);
                r_lin = interp_diag_edge(xi, yi);
            } else {
                g_lin = (get_norm_pixel(xi, yi-1) + get_norm_pixel(xi, yi+1) + get_norm_pixel(xi-1, yi) + get_norm_pixel(xi+1, yi)) * 0.25;
                r_lin = (get_norm_pixel(xi-1, yi-1) + get_norm_pixel(xi+1, yi-1) + get_norm_pixel(xi-1, yi+1) + get_norm_pixel(xi+1, yi+1)) * 0.25;
            }
        } else {
            g_lin = get_norm_pixel(xi, yi);
            var horizIsRed = false;
            if (rowIsOdd == 0) { horizIsRed = (u.isBGGR == 0u); }
            else { horizIsRed = (u.isBGGR == 1u); }
            let valH = (get_norm_pixel(xi-1, yi) + get_norm_pixel(xi+1, yi)) * 0.5;
            let valV = (get_norm_pixel(xi, yi-1) + get_norm_pixel(xi, yi+1)) * 0.5;
            if (horizIsRed) { r_lin = valH; b_lin = valV; }
            else { b_lin = valH; r_lin = valV; }
        }

        // HLR
        if (u.hlrEnabled == 1u) {
            let targetWhite = vec3f(u.neutral0, u.neutral1, u.neutral2);
            let isBG = (u.isBGGR == 1u);
            let wbR = select(u.wb0, u.wb3, isBG); 
            let wbB = select(u.wb3, u.wb0, isBG);
            let r_s = r_lin / max(wbR, 1e-6);
            let g_s = g_lin;
            let b_s = b_lin / max(wbB, 1e-6);
            let mag_sensor = max(r_s, max(g_s, b_s));
            let mag_wb = max(r_lin, max(g_lin, b_lin));
            let hl_mask = smootherstep(0.85, 1.00, mag_sensor);
            if (hl_mask > 0.0) {
                let corrected = targetWhite * mag_wb;
                r_lin = mix(r_lin, corrected.x, hl_mask);
                g_lin = mix(g_lin, corrected.y, hl_mask);
                b_lin = mix(b_lin, corrected.z, hl_mask);
            }
        }

        // Matrix
        var rr = u.cm0*r_lin + u.cm1*g_lin + u.cm2*b_lin;
        var gg = u.cm3*r_lin + u.cm4*g_lin + u.cm5*b_lin;
        var bb = u.cm6*r_lin + u.cm7*g_lin + u.cm8*b_lin;

        // Exposure
        rr *= u.exposureScale;
        gg *= u.exposureScale;
        bb *= u.exposureScale;

        // Shoulder
        var rgb2 = shoulder_hue_preserve(vec3f(rr, gg, bb));

        // Curves
        let rgbPos = max(rgb2, vec3f(0.0));
        let luma = dot(rgbPos, vec3f(0.2126, 0.7152, 0.0722));
        let luma2 = apply_lut(luma, 0u);
        var masterScale = 1.0;
        if (luma > 1e-6) { masterScale = luma2 / luma; }
        let mr = rgb2.x * masterScale;
        let mg = rgb2.y * masterScale;
        let mb = rgb2.z * masterScale;

        finalR = apply_lut(mr, 256u);
        finalG = apply_lut(mg, 512u);
        finalB = apply_lut(mb, 768u);
    }
`;function q4(e){let t="",r="";return e==="display"?(t="@group(0) @binding(2) var<storage, read_write> output : array<u32>;",r=`
            // Standard Display Output (Always sRGB Gamma + 8-bit Packing)
            let r_gamma = srgb_gamma(clamp01(finalR));
            let g_gamma = srgb_gamma(clamp01(finalG));
            let b_gamma = srgb_gamma(clamp01(finalB));

            let r8 = u32(r_gamma * 255.0 + 0.5);
            let g8 = u32(g_gamma * 255.0 + 0.5);
            let b8 = u32(b_gamma * 255.0 + 0.5);
            let a8 = 255u;
            output[idx] = (a8 << 24u) | (b8 << 16u) | (g8 << 8u) | r8;
        `):(t="@group(0) @binding(2) var<storage, read_write> output : array<u32>;",r=`
            var r_out = clamp01(finalR);
            var g_out = clamp01(finalG);
            var b_out = clamp01(finalB);

            if (u.exportSrgb == 1u) {
                r_out = srgb_gamma(r_out);
                g_out = srgb_gamma(g_out);
                b_out = srgb_gamma(b_out);
            }

            var scale = 65535.0;
            if (u.exportStretch == 0u) {
                // Approximate raw magnitude restoration
                // get_norm_pixel divided by (White - Black)
                // So multiply by that range to restore DNs
                // Average green BL? Just use bl0 for simplicity or max range
                let bl = u.bl0; 
                scale = max(u.whiteLevel - bl, 1.0);
            }

            let r16 = u32(min(65535.0, r_out * scale));
            let g16 = u32(min(65535.0, g_out * scale));
            let b16 = u32(min(65535.0, b_out * scale));
            let a16 = 65535u; // Fully opaque

            // Pack: Little Endian logic
            // RG pack: (G << 16) | R
            // BA pack: (A << 16) | B
            
            let packedRG = (g16 << 16u) | r16;
            let packedBA = (a16 << 16u) | b16;

            output[idx * 2u] = packedRG;
            output[idx * 2u + 1u] = packedBA;
        `),`
        ${_oe}
        ${t}
        @compute @workgroup_size(16, 16)
        fn main(@builtin(global_invocation_id) global_id : vec3u) {
            ${Coe}
            ${r}
        }
    `}class Moe{constructor(){Xt(this,"device",null);Xt(this,"displayPipeline",null);Xt(this,"exportPipeline",null);Xt(this,"resources",new Map);Xt(this,"uniformBuffer",null);Xt(this,"unmixParamsBuffer",null);Xt(this,"lutBuffer",null);Xt(this,"isInitialized",!1)}async init(){if(this.isInitialized)return!0;if(!navigator.gpu)return console.warn("WebGPU not supported."),!1;try{const t=await navigator.gpu.requestAdapter();if(!t)throw new Error("No GPU adapter found.");const r={};t.limits.maxStorageBufferBindingSize&&(r.maxStorageBufferBindingSize=1024*1024*1024),t.limits.maxBufferSize&&(r.maxBufferSize=1024*1024*1024),this.device=await t.requestDevice({requiredLimits:r});const n=this.device.createBindGroupLayout({entries:[{binding:0,visibility:GPUShaderStage.COMPUTE,buffer:{type:"uniform"}},{binding:1,visibility:GPUShaderStage.COMPUTE,buffer:{type:"read-only-storage"}},{binding:2,visibility:GPUShaderStage.COMPUTE,buffer:{type:"storage"}},{binding:3,visibility:GPUShaderStage.COMPUTE,buffer:{type:"uniform"}},{binding:4,visibility:GPUShaderStage.COMPUTE,buffer:{type:"read-only-storage"}}]}),a=this.device.createShaderModule({code:q4("display")});this.displayPipeline=this.device.createComputePipeline({layout:this.device.createPipelineLayout({bindGroupLayouts:[n]}),compute:{module:a,entryPoint:"main"}});const i=this.device.createShaderModule({code:q4("export")});return this.exportPipeline=this.device.createComputePipeline({layout:this.device.createPipelineLayout({bindGroupLayouts:[n]}),compute:{module:i,entryPoint:"main"}}),this.uniformBuffer=this.device.createBuffer({size:256,usage:GPUBufferUsage.UNIFORM|GPUBufferUsage.COPY_DST}),this.unmixParamsBuffer=this.device.createBuffer({size:64,usage:GPUBufferUsage.UNIFORM|GPUBufferUsage.COPY_DST}),this.lutBuffer=this.device.createBuffer({size:4096,usage:GPUBufferUsage.STORAGE|GPUBufferUsage.COPY_DST}),this.isInitialized=!0,console.log("WebGPU Renderer Initialized"),!0}catch(t){return console.error("WebGPU Init Failed:",t),!1}}hasImage(t){return this.resources.has(t)}async uploadImage(t,r,n,a,i){if(this.isInitialized||await this.init(),!!this.device){if(this.resources.has(t)){const o=this.resources.get(t);if(o&&o.width===n&&o.height===a)return;this.disposeImage(t)}try{const o=n*a,s=Math.ceil(o*2/4)*4,l=this.device.createBuffer({size:s,usage:GPUBufferUsage.STORAGE|GPUBufferUsage.COPY_DST,mappedAtCreation:!0});new Uint16Array(l.getMappedRange()).set(r),l.unmap();const u=o*4,d=this.device.createBuffer({size:u,usage:GPUBufferUsage.STORAGE|GPUBufferUsage.COPY_SRC}),f=this.device.createBuffer({size:u,usage:GPUBufferUsage.MAP_READ|GPUBufferUsage.COPY_DST}),h=this.device.createBindGroup({layout:this.displayPipeline.getBindGroupLayout(0),entries:[{binding:0,resource:{buffer:this.uniformBuffer}},{binding:1,resource:{buffer:l}},{binding:2,resource:{buffer:d}},{binding:3,resource:{buffer:this.unmixParamsBuffer}},{binding:4,resource:{buffer:this.lutBuffer}}]}),g=i??Poe(r);this.resources.set(t,{width:n,height:a,rawBuffer:l,outputBuffer:d,readBuffer:f,bindGroup:h,whiteLevel:g,busy:!1})}catch(o){console.error("[WebGPU] Buffer creation failed",o)}}}updateUniforms(t,r,n,a){const i=Math.pow(2,r.exposure),o=r.blackLevel||[0,0,0,0],s=r.wbGains||[1,1];let l=65532;r.highlightRecovery&&(l=r.customWhiteLevel??t.whiteLevel??16383);let u=[1,1,1,1];r.isBGGR?u=[s[1],1,1,s[0]]:u=[s[0],1,1,s[1]];let d=[[1,0,0],[0,1,0],[0,0,1]],f=[1,0,0,0,1,0,0,0,1],h=null;if(r.customMatrix&&r.customMatrix.length===9){const S=[[r.customMatrix[0],r.customMatrix[1],r.customMatrix[2]],[r.customMatrix[3],r.customMatrix[4],r.customMatrix[5]],[r.customMatrix[6],r.customMatrix[7],r.customMatrix[8]]],M=tc(S);M&&(d=_f(joe,M),f=[d[0][0],d[0][1],d[0][2],d[1][0],d[1][1],d[1][2],d[2][0],d[2][1],d[2][2]],h=tc(d))}const g=f;let b=0;r.renderMode==="zero-dep-color"&&(b=1),r.renderMode==="advanced-zero-dep"&&(b=2);const w=r.zeroDepColorDemosaic==="edge-aware"?1:0;let v=[1,1,1];if(h){v=bT(h,[1,1,1]);const S=Math.max(Math.abs(v[0]),Math.max(Math.abs(v[1]),Math.abs(v[2])));S>1e-6?v=[v[0]/S,v[1]/S,v[2]/S]:v=[1,1,1]}const x=new Float32Array([0,0,l,i,o[0],o[1],o[2],o[3],u[0],u[1],u[2],u[3],g[0],g[1],g[2],g[3],g[4],g[5],g[6],g[7],g[8],0,0,0,v[0],v[1],v[2],0,0,0]),m=new Uint32Array(x.buffer);m[0]=t.width,m[1]=t.height,m[21]=b,m[22]=r.isBGGR?1:0,m[23]=w,m[27]=1,m[28]=a.stretch?1:0,m[29]=a.srgb?1:0,this.device.queue.writeBuffer(this.uniformBuffer,0,x);const k=new Float32Array(16);if(b===2&&r.advancedZeroDep){const S=r.advancedZeroDep;k.set([S.bl[0],S.bl[1],S.bl[2],S.bl[3],Math.max(0,S.bg[0]-S.bl[0]),Math.max(0,S.bg[1]-S.bl[1]),Math.max(0,S.bg[2]-S.bl[2]),Math.max(0,S.bg[3]-S.bl[3]),Math.max(0,S.fg[0]-S.bl[0]),Math.max(0,S.fg[1]-S.bl[1]),Math.max(0,S.fg[2]-S.bl[2]),Math.max(0,S.fg[3]-S.bl[3])])}this.device.queue.writeBuffer(this.unmixParamsBuffer,0,k);const P=new Float32Array(1024),j=r.curves||{master:[{x:0,y:0},{x:1,y:1}],red:[{x:0,y:0},{x:1,y:1}],green:[{x:0,y:0},{x:1,y:1}],blue:[{x:0,y:0},{x:1,y:1}]};P.set(Ia(j.master),0),P.set(Ia(j.red),256),P.set(Ia(j.green),512),P.set(Ia(j.blue),768),this.device.queue.writeBuffer(this.lutBuffer,0,P)}async render(t,r,n){if(this.isInitialized||await this.init(),!this.device||!this.displayPipeline)return null;const a=this.resources.get(t);if(!a||a.busy)return null;a.busy=!0;try{this.updateUniforms(a,r,!1,{stretch:!1,srgb:!0});const i=this.device.createCommandEncoder(),o=i.beginComputePass();o.setPipeline(this.displayPipeline),o.setBindGroup(0,a.bindGroup),o.dispatchWorkgroups(Math.ceil(a.width/16),Math.ceil(a.height/16)),o.end(),i.copyBufferToBuffer(a.outputBuffer,0,a.readBuffer,0,a.width*a.height*4),this.device.queue.submit([i.finish()]),await a.readBuffer.mapAsync(GPUMapMode.READ);const s=new Uint8ClampedArray(a.readBuffer.getMappedRange()),l=new ImageData(new Uint8ClampedArray(s),a.width,a.height);return a.readBuffer.unmap(),l}catch(i){console.error("WebGPU Render Error",i);try{a.readBuffer.unmap()}catch{}return null}finally{a.busy=!1}}async export16Bit(t,r,n,a){if(this.isInitialized||await this.init(),!this.device||!this.exportPipeline)return null;const i=this.resources.get(t);if(!i)return null;const o=i.width*i.height*8,s=this.device.createBuffer({size:o,usage:GPUBufferUsage.STORAGE|GPUBufferUsage.COPY_SRC}),l=this.device.createBuffer({size:o,usage:GPUBufferUsage.MAP_READ|GPUBufferUsage.COPY_DST}),u=this.device.createBindGroup({layout:this.exportPipeline.getBindGroupLayout(0),entries:[{binding:0,resource:{buffer:this.uniformBuffer}},{binding:1,resource:{buffer:i.rawBuffer}},{binding:2,resource:{buffer:s}},{binding:3,resource:{buffer:this.unmixParamsBuffer}},{binding:4,resource:{buffer:this.lutBuffer}}]});this.updateUniforms(i,r,!0,{stretch:n,srgb:a});const d=this.device.createCommandEncoder(),f=d.beginComputePass();f.setPipeline(this.exportPipeline),f.setBindGroup(0,u),f.dispatchWorkgroups(Math.ceil(i.width/16),Math.ceil(i.height/16)),f.end(),d.copyBufferToBuffer(s,0,l,0,o),this.device.queue.submit([d.finish()]),await l.mapAsync(GPUMapMode.READ);const h=new Uint32Array(l.getMappedRange()),g=i.width*i.height,b=new Uint16Array(g*3);for(let w=0;w<g;w++){const v=h[w*2],x=h[w*2+1],m=v&65535,k=v>>>16&65535,P=x&65535;b[w*3]=m,b[w*3+1]=k,b[w*3+2]=P}return l.unmap(),s.destroy(),l.destroy(),b}disposeImage(t){const r=this.resources.get(t);r&&(r.rawBuffer.destroy(),r.outputBuffer.destroy(),r.readBuffer.destroy(),this.resources.delete(t))}disposeAll(){this.resources.forEach(t=>{t.rawBuffer.destroy(),t.outputBuffer.destroy(),t.readBuffer.destroy()}),this.resources.clear()}}const Cs=new Moe,Noe=`
struct LayerUniforms {
  width: u32,
  height: u32,
  blendMode: u32,  // 0=add, 1=subtract
  enabled: u32,
  opacity: f32,
  exposure: f32,
  temperature: f32,
  tint: f32,
  contrast: f32,
  highlights: f32,
  shadows: f32,
  vibrance: f32,
  saturation: f32,
  pad0: f32,
  pad1: f32,
  pad2: f32,
  mixerHue0: vec4f, // red, orange, yellow, green
  mixerHue1: vec4f, // aqua, blue, purple, magenta
  mixerSat0: vec4f,
  mixerSat1: vec4f,
  mixerLum0: vec4f,
  mixerLum1: vec4f,
};

@group(0) @binding(0) var<uniform> u: LayerUniforms;
@group(0) @binding(1) var<storage, read_write> work: array<vec4f>;
@group(0) @binding(2) var<storage, read> maskAlpha: array<f32>;
@group(0) @binding(3) var<storage, read> curveLut: array<f32>;

fn clamp01(x: f32) -> f32 {
  return max(0.0, min(1.0, x));
}

fn smoothstep01(edge0: f32, edge1: f32, x: f32) -> f32 {
  let denom = max(1e-6, edge1 - edge0);
  let t = clamp01((x - edge0) / denom);
  return t * t * (3.0 - 2.0 * t);
}

fn tone_adjust(value: f32, amount: f32, weight: f32) -> f32 {
  let amt = clamp(amount, -1.0, 1.0);
  let w = clamp01(weight);
  if (amt >= 0.0) {
    return value + (1.0 - value) * amt * w;
  }
  return value + value * amt * w;
}

fn rgb_to_hsl(c: vec3f) -> vec3f {
  let r = c.x;
  let g = c.y;
  let b = c.z;
  let maxc = max(r, max(g, b));
  let minc = min(r, min(g, b));
  let l = (maxc + minc) * 0.5;
  if (maxc == minc) {
    return vec3f(0.0, 0.0, l);
  }
  let d = maxc - minc;
  var h = 0.0;
  let s = select(d / (maxc + minc), d / (2.0 - maxc - minc), l > 0.5);
  if (maxc == r) {
    h = (g - b) / d + select(6.0, 0.0, g >= b);
  } else if (maxc == g) {
    h = (b - r) / d + 2.0;
  } else {
    h = (r - g) / d + 4.0;
  }
  h = h / 6.0;
  return vec3f(h, s, l);
}

fn hue2rgb(p: f32, q: f32, t: f32) -> f32 {
  var tt = t;
  if (tt < 0.0) { tt = tt + 1.0; }
  if (tt > 1.0) { tt = tt - 1.0; }
  if (tt < (1.0 / 6.0)) { return p + (q - p) * 6.0 * tt; }
  if (tt < 0.5) { return q; }
  if (tt < (2.0 / 3.0)) { return p + (q - p) * ((2.0 / 3.0) - tt) * 6.0; }
  return p;
}

fn hsl_to_rgb(hsl: vec3f) -> vec3f {
  let h = hsl.x;
  let s = hsl.y;
  let l = hsl.z;
  if (s == 0.0) {
    return vec3f(l, l, l);
  }
  let q = select(l * (1.0 + s), l + s - l * s, l >= 0.5);
  let p = 2.0 * l - q;
  return vec3f(
    hue2rgb(p, q, h + (1.0 / 3.0)),
    hue2rgb(p, q, h),
    hue2rgb(p, q, h - (1.0 / 3.0))
  );
}

fn hue_distance_deg(a: f32, b: f32) -> f32 {
  let d = abs(a - b);
  return min(d, 360.0 - d);
}

fn band_weight(hueDeg: f32, centerDeg: f32) -> f32 {
  return clamp01(1.0 - hue_distance_deg(hueDeg, centerDeg) / 45.0);
}

fn apply_lut(val: f32, offset: u32) -> f32 {
  let v = clamp01(val);
  let pos = v * 255.0;
  let idx = u32(pos);
  let f = fract(pos);
  let p0 = curveLut[offset + idx];
  let idxNext = min(idx + 1u, 255u);
  let p1 = curveLut[offset + idxNext];
  return p0 * (1.0 - f) + p1 * f;
}

@compute @workgroup_size(16, 16)
fn main(@builtin(global_invocation_id) gid: vec3u) {
  if (gid.x >= u.width || gid.y >= u.height) { return; }
  if (u.enabled == 0u) { return; }
  let idx = gid.y * u.width + gid.x;

  let mask = clamp01(maskAlpha[idx] * u.opacity);
  if (mask <= 0.0) { return; }

  let src = work[idx].xyz;
  var adjusted = src;

  if (u.exposure != 0.0) {
    adjusted = adjusted * exp2(u.exposure);
  }

  if (u.temperature != 0.0 || u.tint != 0.0) {
    let t = u.temperature / 100.0;
    let ti = u.tint / 100.0;
    adjusted = vec3f(
      adjusted.x * (1.0 + 0.18 * t + 0.08 * ti),
      adjusted.y * (1.0 - 0.16 * ti),
      adjusted.z * (1.0 - 0.18 * t + 0.08 * ti)
    );
  }

  if (u.contrast != 0.0) {
    let contrastScale = 1.0 + (u.contrast / 100.0);
    adjusted = (adjusted - vec3f(0.5, 0.5, 0.5)) * contrastScale + vec3f(0.5, 0.5, 0.5);
  }

  if (u.highlights != 0.0 || u.shadows != 0.0) {
    let lumaNow = clamp01(dot(adjusted, vec3f(0.2126, 0.7152, 0.0722)));
    let wHighlights = smoothstep01(0.5, 1.0, lumaNow);
    let wShadows = 1.0 - smoothstep01(0.0, 0.5, lumaNow);
    let highlightAmount = u.highlights / 100.0;
    let shadowAmount = u.shadows / 100.0;
    adjusted = vec3f(
      tone_adjust(adjusted.x, highlightAmount, wHighlights),
      tone_adjust(adjusted.y, highlightAmount, wHighlights),
      tone_adjust(adjusted.z, highlightAmount, wHighlights)
    );
    adjusted = vec3f(
      tone_adjust(adjusted.x, shadowAmount, wShadows),
      tone_adjust(adjusted.y, shadowAmount, wShadows),
      tone_adjust(adjusted.z, shadowAmount, wShadows)
    );
  }

  if (
    u.vibrance != 0.0 || u.saturation != 0.0 ||
    u.mixerHue0.x != 0.0 || u.mixerHue0.y != 0.0 || u.mixerHue0.z != 0.0 || u.mixerHue0.w != 0.0 ||
    u.mixerHue1.x != 0.0 || u.mixerHue1.y != 0.0 || u.mixerHue1.z != 0.0 || u.mixerHue1.w != 0.0 ||
    u.mixerSat0.x != 0.0 || u.mixerSat0.y != 0.0 || u.mixerSat0.z != 0.0 || u.mixerSat0.w != 0.0 ||
    u.mixerSat1.x != 0.0 || u.mixerSat1.y != 0.0 || u.mixerSat1.z != 0.0 || u.mixerSat1.w != 0.0 ||
    u.mixerLum0.x != 0.0 || u.mixerLum0.y != 0.0 || u.mixerLum0.z != 0.0 || u.mixerLum0.w != 0.0 ||
    u.mixerLum1.x != 0.0 || u.mixerLum1.y != 0.0 || u.mixerLum1.z != 0.0 || u.mixerLum1.w != 0.0
  ) {
    var hsl = rgb_to_hsl(vec3f(clamp01(adjusted.x), clamp01(adjusted.y), clamp01(adjusted.z)));

    if (u.vibrance != 0.0) {
      let vib = u.vibrance / 100.0;
      hsl.y = select(clamp01(hsl.y + vib * hsl.y), clamp01(hsl.y + vib * (1.0 - hsl.y)), vib >= 0.0);
    }
    if (u.saturation != 0.0) {
      hsl.y = clamp01(hsl.y + (u.saturation / 100.0));
    }

    let hueDeg = fract(hsl.x) * 360.0;
    let w0 = band_weight(hueDeg, 0.0);
    let w1 = band_weight(hueDeg, 30.0);
    let w2 = band_weight(hueDeg, 60.0);
    let w3 = band_weight(hueDeg, 120.0);
    let w4 = band_weight(hueDeg, 180.0);
    let w5 = band_weight(hueDeg, 240.0);
    let w6 = band_weight(hueDeg, 285.0);
    let w7 = band_weight(hueDeg, 320.0);

    let sumW = w0 + w1 + w2 + w3 + w4 + w5 + w6 + w7;
    if (sumW > 1e-6) {
      let hueSum =
        w0 * u.mixerHue0.x + w1 * u.mixerHue0.y + w2 * u.mixerHue0.z + w3 * u.mixerHue0.w +
        w4 * u.mixerHue1.x + w5 * u.mixerHue1.y + w6 * u.mixerHue1.z + w7 * u.mixerHue1.w;
      let satSum =
        w0 * u.mixerSat0.x + w1 * u.mixerSat0.y + w2 * u.mixerSat0.z + w3 * u.mixerSat0.w +
        w4 * u.mixerSat1.x + w5 * u.mixerSat1.y + w6 * u.mixerSat1.z + w7 * u.mixerSat1.w;
      let lumSum =
        w0 * u.mixerLum0.x + w1 * u.mixerLum0.y + w2 * u.mixerLum0.z + w3 * u.mixerLum0.w +
        w4 * u.mixerLum1.x + w5 * u.mixerLum1.y + w6 * u.mixerLum1.z + w7 * u.mixerLum1.w;
      let invW = 1.0 / sumW;
      let chromaWeight = clamp01((hsl.y - 0.03) / 0.25);
      let hueShiftNorm = ((hueSum * invW) / 100.0) * (45.0 / 360.0) * chromaWeight;
      hsl.x = fract(hsl.x + hueShiftNorm);
      hsl.y = clamp01(hsl.y + ((satSum * invW) / 100.0) * chromaWeight);
      hsl.z = clamp01(hsl.z + ((lumSum * invW) / 100.0) * chromaWeight);
    }

    adjusted = hsl_to_rgb(hsl);
  }

  let luma = max(0.0, dot(adjusted, vec3f(0.2126, 0.7152, 0.0722)));
  let lumaMapped = apply_lut(luma, 0u);
  let masterScale = select(1.0, lumaMapped / luma, luma > 1e-6);
  let mr = clamp01(adjusted.x * masterScale);
  let mg = clamp01(adjusted.y * masterScale);
  let mb = clamp01(adjusted.z * masterScale);
  adjusted = vec3f(
    apply_lut(mr, 256u),
    apply_lut(mg, 512u),
    apply_lut(mb, 768u)
  );

  let blendValue = select(adjusted, (2.0 * src - adjusted), u.blendMode == 1u);
  let mixed = src * (1.0 - mask) + blendValue * mask;
  work[idx] = vec4f(mixed, 1.0);
}
`,Ooe=`
struct OutputUniforms {
  width: u32,
  height: u32,
};

@group(0) @binding(0) var<uniform> u: OutputUniforms;
@group(0) @binding(1) var<storage, read> work: array<vec4f>;
@group(0) @binding(2) var<storage, read_write> outBuf: array<u32>;

fn clamp01(x: f32) -> f32 {
  return max(0.0, min(1.0, x));
}

@compute @workgroup_size(16, 16)
fn main(@builtin(global_invocation_id) gid: vec3u) {
  if (gid.x >= u.width || gid.y >= u.height) { return; }
  let idx = gid.y * u.width + gid.x;
  let v = work[idx];
  let r8 = u32(clamp01(v.x) * 255.0 + 0.5);
  let g8 = u32(clamp01(v.y) * 255.0 + 0.5);
  let b8 = u32(clamp01(v.z) * 255.0 + 0.5);
  let a8 = 255u;
  outBuf[idx] = (a8 << 24u) | (b8 << 16u) | (g8 << 8u) | r8;
}
`;class Aoe{constructor(){Xt(this,"device",null);Xt(this,"layerPipeline",null);Xt(this,"outputPipeline",null);Xt(this,"layerBindGroupLayout",null);Xt(this,"outputBindGroupLayout",null);Xt(this,"layerUniformBuffer",null);Xt(this,"outputUniformBuffer",null);Xt(this,"initialized",!1);Xt(this,"resources",new Map);Xt(this,"maskCpuCache",new Map);Xt(this,"maxBufferSize",256*1024*1024);Xt(this,"maxStorageBufferBindingSize",128*1024*1024);Xt(this,"lastRenderBusy",!1)}async init(){var t,r;if(this.initialized)return!0;if(!navigator.gpu)return!1;try{const n=await navigator.gpu.requestAdapter();if(!n)return!1;const a={};(t=n.limits)!=null&&t.maxBufferSize&&(this.maxBufferSize=Number(n.limits.maxBufferSize),a.maxBufferSize=this.maxBufferSize),(r=n.limits)!=null&&r.maxStorageBufferBindingSize&&(this.maxStorageBufferBindingSize=Number(n.limits.maxStorageBufferBindingSize),a.maxStorageBufferBindingSize=this.maxStorageBufferBindingSize),this.device=await n.requestDevice({requiredLimits:Object.keys(a).length?a:void 0});const i=this.device.createShaderModule({code:Noe}),o=this.device.createShaderModule({code:Ooe});return this.layerBindGroupLayout=this.device.createBindGroupLayout({entries:[{binding:0,visibility:GPUShaderStage.COMPUTE,buffer:{type:"uniform"}},{binding:1,visibility:GPUShaderStage.COMPUTE,buffer:{type:"storage"}},{binding:2,visibility:GPUShaderStage.COMPUTE,buffer:{type:"read-only-storage"}},{binding:3,visibility:GPUShaderStage.COMPUTE,buffer:{type:"read-only-storage"}}]}),this.outputBindGroupLayout=this.device.createBindGroupLayout({entries:[{binding:0,visibility:GPUShaderStage.COMPUTE,buffer:{type:"uniform"}},{binding:1,visibility:GPUShaderStage.COMPUTE,buffer:{type:"read-only-storage"}},{binding:2,visibility:GPUShaderStage.COMPUTE,buffer:{type:"storage"}}]}),this.layerPipeline=this.device.createComputePipeline({layout:this.device.createPipelineLayout({bindGroupLayouts:[this.layerBindGroupLayout]}),compute:{module:i,entryPoint:"main"}}),this.outputPipeline=this.device.createComputePipeline({layout:this.device.createPipelineLayout({bindGroupLayouts:[this.outputBindGroupLayout]}),compute:{module:o,entryPoint:"main"}}),this.layerUniformBuffer=this.device.createBuffer({size:160,usage:GPUBufferUsage.UNIFORM|GPUBufferUsage.COPY_DST}),this.outputUniformBuffer=this.device.createBuffer({size:16,usage:GPUBufferUsage.UNIFORM|GPUBufferUsage.COPY_DST}),this.initialized=!0,!0}catch(n){return console.error("[PS GPU] init failed",n),!1}}getMaskData(t){const r=`${t.id}:${t.version}`,n=this.maskCpuCache.get(r);if(n)return n;const a=t.alpha;if(this.maskCpuCache.set(r,a),this.maskCpuCache.size>48){const i=this.maskCpuCache.keys().next().value;i&&this.maskCpuCache.delete(i)}return a}ensureResource(t){if(!this.device)return null;let r=this.resources.get(t.id);const n=t.width*t.height,a=n*16,i=n*4;if(a>this.maxBufferSize||a>this.maxStorageBufferBindingSize)return console.warn(`[PS GPU] image too large for current storage buffer limits: ${a} bytes, maxStorageBufferBindingSize=${this.maxStorageBufferBindingSize}, maxBufferSize=${this.maxBufferSize}`),null;if(i>this.maxBufferSize||i>this.maxStorageBufferBindingSize)return console.warn(`[PS GPU] output too large for current storage buffer limits: ${i} bytes, maxStorageBufferBindingSize=${this.maxStorageBufferBindingSize}, maxBufferSize=${this.maxBufferSize}`),null;if(r&&(r.width!==t.width||r.height!==t.height)&&(this.dispose(t.id),r=void 0),!r){const o=new Float32Array(n*4);for(let f=0,h=0;f<n;f++,h+=3){const g=f*4;o[g]=t.baseRgb[h],o[g+1]=t.baseRgb[h+1],o[g+2]=t.baseRgb[h+2],o[g+3]=1}const s=this.device.createBuffer({size:a,usage:GPUBufferUsage.COPY_SRC|GPUBufferUsage.COPY_DST});this.device.queue.writeBuffer(s,0,o);const l=this.device.createBuffer({size:a,usage:GPUBufferUsage.COPY_DST|GPUBufferUsage.STORAGE}),u=this.device.createBuffer({size:i,usage:GPUBufferUsage.STORAGE|GPUBufferUsage.COPY_SRC}),d=this.device.createBuffer({size:i,usage:GPUBufferUsage.MAP_READ|GPUBufferUsage.COPY_DST});r={width:t.width,height:t.height,pixelCount:n,baseBuffer:s,workBuffer:l,outputBuffer:u,readBuffer:d,busy:!1,maskGpuCache:new Map,curveGpuCache:new Map},this.resources.set(t.id,r)}return r}ensureMaskBuffer(t,r){if(!this.device)return null;const n=`${r.id}:${r.version}`,a=[];for(const l of t.maskGpuCache.keys())l.startsWith(`${r.id}:`)&&l!==n&&a.push(l);for(const l of a){const u=t.maskGpuCache.get(l);u&&u.destroy(),t.maskGpuCache.delete(l)}const i=t.maskGpuCache.get(n);if(i)return i;const o=this.getMaskData(r),s=this.device.createBuffer({size:o.byteLength,usage:GPUBufferUsage.STORAGE|GPUBufferUsage.COPY_DST});return this.device.queue.writeBuffer(s,0,o),t.maskGpuCache.set(n,s),s}ensureCurveBuffer(t,r,n){if(!this.device)return null;const a=Lg(n),i=JSON.stringify(a),o=new Float32Array(1024);o.set(Ia(a.master),0),o.set(Ia(a.red),256),o.set(Ia(a.green),512),o.set(Ia(a.blue),768);let s=t.curveGpuCache.get(r);return s||(s={buffer:this.device.createBuffer({size:o.byteLength,usage:GPUBufferUsage.STORAGE|GPUBufferUsage.COPY_DST}),signature:""},t.curveGpuCache.set(r,s)),s.signature!==i&&(this.device.queue.writeBuffer(s.buffer,0,o),s.signature=i),s.buffer}async renderPreview(t){if(!this.initialized&&!await this.init()||!this.device||!this.layerPipeline||!this.outputPipeline||!this.layerUniformBuffer||!this.outputUniformBuffer)return null;const r=this.ensureResource(t);if(!r)return null;if(r.busy)return this.lastRenderBusy=!0,null;this.lastRenderBusy=!1,r.busy=!0;const n=[];try{const a=new Map;for(const f of t.layers)f.enabled&&a.set(f.maskId,f);const i=this.device.createCommandEncoder();i.copyBufferToBuffer(r.baseBuffer,0,r.workBuffer,0,r.pixelCount*16);for(const f of t.masks){const h=a.get(f.id);if(!h||!f.visible)continue;const g=this.ensureMaskBuffer(r,f),b=this.ensureCurveBuffer(r,h.id,h.curves);if(!g||!b)continue;const w=g0(h.basic),v=m0(h.mixer),x=new Float32Array(40),m=new Uint32Array(x.buffer);m[0]=r.width,m[1]=r.height,m[2]=h.blendMode==="subtract"?1:0,m[3]=h.enabled?1:0,x[4]=h.opacity,x[5]=w.exposure,x[6]=w.temperature,x[7]=w.tint,x[8]=w.contrast,x[9]=w.highlights,x[10]=w.shadows,x[11]=w.vibrance,x[12]=w.saturation,x[16]=v.red.hue,x[17]=v.orange.hue,x[18]=v.yellow.hue,x[19]=v.green.hue,x[20]=v.aqua.hue,x[21]=v.blue.hue,x[22]=v.purple.hue,x[23]=v.magenta.hue,x[24]=v.red.saturation,x[25]=v.orange.saturation,x[26]=v.yellow.saturation,x[27]=v.green.saturation,x[28]=v.aqua.saturation,x[29]=v.blue.saturation,x[30]=v.purple.saturation,x[31]=v.magenta.saturation,x[32]=v.red.luminance,x[33]=v.orange.luminance,x[34]=v.yellow.luminance,x[35]=v.green.luminance,x[36]=v.aqua.luminance,x[37]=v.blue.luminance,x[38]=v.purple.luminance,x[39]=v.magenta.luminance;const k=this.device.createBuffer({size:160,usage:GPUBufferUsage.UNIFORM|GPUBufferUsage.COPY_DST});this.device.queue.writeBuffer(k,0,x),n.push(k);const P=this.device.createBindGroup({layout:this.layerBindGroupLayout,entries:[{binding:0,resource:{buffer:k}},{binding:1,resource:{buffer:r.workBuffer}},{binding:2,resource:{buffer:g}},{binding:3,resource:{buffer:b}}]}),j=i.beginComputePass();j.setPipeline(this.layerPipeline),j.setBindGroup(0,P),j.dispatchWorkgroups(Math.ceil(r.width/16),Math.ceil(r.height/16)),j.end()}const o=new Uint32Array(4);o[0]=r.width,o[1]=r.height,this.device.queue.writeBuffer(this.outputUniformBuffer,0,o);const s=this.device.createBindGroup({layout:this.outputBindGroupLayout,entries:[{binding:0,resource:{buffer:this.outputUniformBuffer}},{binding:1,resource:{buffer:r.workBuffer}},{binding:2,resource:{buffer:r.outputBuffer}}]}),l=i.beginComputePass();l.setPipeline(this.outputPipeline),l.setBindGroup(0,s),l.dispatchWorkgroups(Math.ceil(r.width/16),Math.ceil(r.height/16)),l.end(),i.copyBufferToBuffer(r.outputBuffer,0,r.readBuffer,0,r.pixelCount*4),this.device.queue.submit([i.finish()]),await r.readBuffer.mapAsync(GPUMapMode.READ);const u=new Uint8ClampedArray(r.readBuffer.getMappedRange()),d=new ImageData(new Uint8ClampedArray(u),r.width,r.height);return r.readBuffer.unmap(),d}catch(a){console.error("[PS GPU] render failed",a);try{r.readBuffer.unmap()}catch{}return null}finally{for(const a of n)try{a.destroy()}catch{}r.busy=!1}}dispose(t){const r=this.resources.get(t);if(r){r.baseBuffer.destroy(),r.workBuffer.destroy(),r.outputBuffer.destroy(),r.readBuffer.destroy();for(const n of r.maskGpuCache.values())n.destroy();for(const n of r.curveGpuCache.values())n.buffer.destroy();this.resources.delete(t)}}wasBusyLastRender(){return this.lastRenderBusy}}const jh=new Aoe,Ph=1024,Z4=/\.(arw|cr2|cr3|dng|nef|orf|raf|rw2|pef|srw|sr2|srf|x3f|erf|mef|mos|mrw|kdc|dcr|iiq|3fr|fff|rwl|nrw|raw)$/i,Bd="jiangtherapee onlinecsv",J4="jiangtherapee.ps.workflow.json",Q4=80,Toe=20,Eoe=6,Wn=e=>({x:e.x,y:e.y}),Yl=e=>({...e,p1:Wn(e.p1),p2:Wn(e.p2)}),AO=e=>{switch(e.type){case"crop":return{type:"crop",rect:{...e.rect}};case"rotate":return{type:"rotate",angleDeg:e.angleDeg};case"flipH":return{type:"flipH"};case"flipV":return{type:"flipV"};case"upright":return{type:"upright",guides:e.guides.map(Yl)}}},Ts=e=>e.map(AO),Gu=e=>e.type==="ellipse"?{...e,center:Wn(e.center)}:{...e,points:e.points.map(t=>Wn(t))},sw=e=>{const t=g0(e==null?void 0:e.basic),r=e==null?void 0:e.hsl;return!(e!=null&&e.basic)&&r&&(t.saturation=Math.max(-100,Math.min(100,Number(r.saturation)||0)),t.exposure=Math.max(-5,Math.min(5,(Number(r.lightness)||0)/100*1.5))),t},lw=e=>{const t=m0(e==null?void 0:e.mixer),r=e==null?void 0:e.hsl;if(!(e!=null&&e.mixer)&&r&&Number.isFinite(Number(r.hue))){const n=Math.max(-100,Math.min(100,Number(r.hue)/180*100));return{red:{...t.red,hue:n},orange:{...t.orange,hue:n},yellow:{...t.yellow,hue:n},green:{...t.green,hue:n},aqua:{...t.aqua,hue:n},blue:{...t.blue,hue:n},purple:{...t.purple,hue:n},magenta:{...t.magenta,hue:n}}}return t},_h=e=>({...e,baseRgb:e.baseRgb,masks:e.masks.map(t=>({...t,alpha:t.alpha,items:(t.items||[]).map(Gu)})),layers:e.layers.map(t=>({...t,basic:sw(t),mixer:lw(t),curves:{master:t.curves.master.map(Wn),red:t.curves.red.map(Wn),green:t.curves.green.map(Wn),blue:t.curves.blue.map(Wn)}})),guides:e.guides.map(t=>({...t,p1:Wn(t.p1),p2:Wn(t.p2)})),transform:{rotationDeg:e.transform.rotationDeg,crop:e.transform.crop?{...e.transform.crop}:null},history:e.history.map(t=>({...t}))}),kg=e=>{var t,r,n,a;return{...e,basic:sw(e),mixer:lw(e),curves:{master:(((t=e.curves)==null?void 0:t.master)||[{x:0,y:0},{x:1,y:1}]).map(Wn),red:(((r=e.curves)==null?void 0:r.red)||[{x:0,y:0},{x:1,y:1}]).map(Wn),green:(((n=e.curves)==null?void 0:n.green)||[{x:0,y:0},{x:1,y:1}]).map(Wn),blue:(((a=e.curves)==null?void 0:a.blue)||[{x:0,y:0},{x:1,y:1}]).map(Wn)}}},Ioe=e=>({id:e.id,name:e.name,shape:e.shape,visible:e.visible,overlayVisible:e.overlayVisible??!0,items:(e.items||[]).map(Gu)}),ej=(e,t)=>({width:e.width,height:e.height,transformOps:Ts(t),masks:e.masks.map(Ioe),layers:e.layers.map(kg),guides:e.guides.map(Yl),selectedMaskId:e.selectedMaskId,selectedLayerId:e.selectedLayerId,selectedMaskItemId:e.selectedMaskItemId,selectedGuideId:e.selectedGuideId,transform:{rotationDeg:e.transform.rotationDeg,crop:e.transform.crop?{...e.transform.crop}:null}}),tj=(e,t)=>{var b,w,v;const r=Number(t.width),n=Number(t.height);if(!Number.isFinite(r)||!Number.isFinite(n)||r<=0||n<=0)throw new Error("Invalid workflow canvas size.");const a=Ts(t.transformOps||[]),i=$oe(e,a);if(i.width!==r||i.height!==n)throw new Error(`Workflow transform replay size mismatch: expected ${r}x${n}, got ${i.width}x${i.height}.`);const o=(t.masks||[]).map(x=>({id:x.id,name:x.name,shape:x.shape||"full",width:r,height:n,alpha:new Float32Array(r*n),featherPx:0,visible:x.visible!==!1,overlayVisible:x.overlayVisible!==!1,version:1,items:(x.items||[]).map(Gu)})),s=((b=o[0])==null?void 0:b.id)||"",l=(t.layers||[]).map(x=>({...kg(x),maskId:o.some(m=>m.id===x.maskId)?x.maskId:s})),u=(t.guides||[]).map(Yl),d=o.some(x=>x.id===t.selectedMaskId)?t.selectedMaskId:((w=o[0])==null?void 0:w.id)||"",f=l.some(x=>x.id===t.selectedLayerId)?t.selectedLayerId:((v=l[0])==null?void 0:v.id)||"",h=t.selectedGuideId&&u.some(x=>x.id===t.selectedGuideId)?t.selectedGuideId:null,g=t.selectedMaskItemId&&o.some(x=>(x.items||[]).some(m=>m.id===t.selectedMaskItemId))?t.selectedMaskItemId:null;return y_({...i,width:r,height:n,masks:o,layers:l,guides:u,selectedMaskId:d,selectedLayerId:f,selectedMaskItemId:g,selectedGuideId:h,transform:t.transform?{rotationDeg:Number(t.transform.rotationDeg)||0,crop:t.transform.crop?{...t.transform.crop}:null}:{rotationDeg:0,crop:null}})},dx=e=>{const t={...e,baseRgb:e.baseRgb,masks:e.masks.map(r=>({...r,alpha:new Float32Array(r.width*r.height),items:(r.items||[]).map(Gu)})),layers:e.layers.map(r=>({...r,basic:sw(r),mixer:lw(r),curves:{master:r.curves.master.map(Wn),red:r.curves.red.map(Wn),green:r.curves.green.map(Wn),blue:r.curves.blue.map(Wn)}})),guides:e.guides.map(r=>({...r,p1:Wn(r.p1),p2:Wn(r.p2)})),transform:{rotationDeg:e.transform.rotationDeg,crop:e.transform.crop?{...e.transform.crop}:null},history:e.history.map(r=>({...r}))};return y_(t)},$oe=(e,t)=>{var n;let r=e;for(const a of t){if(a.type==="crop"){r=k_(r,a.rect);continue}if(a.type==="rotate"){r=S_(r,a.angleDeg);continue}if(a.type==="flipH"){r=j_(r);continue}if(a.type==="flipV"){r=P_(r);continue}const i={...r,guides:a.guides.map(Yl),selectedGuideId:((n=a.guides[0])==null?void 0:n.id)||null};r=__(i)}return r},Doe=e=>{const t=atob(e);let r="";for(let n=0;n<t.length;n++)r+=`%${t.charCodeAt(n).toString(16).padStart(2,"0")}`;return decodeURIComponent(r)},rj=e=>{const t=e.trim();return t.startsWith('"')&&t.endsWith('"')?t.slice(1,-1).replace(/""/g,'"'):t},Roe=e=>{const t=[];let r="",n=!1;for(let a=0;a<e.length;a++){const i=e[a];if(i==='"'){n&&e[a+1]==='"'?(r+='"',a++):n=!n;continue}if(i===","&&!n){t.push(r),r="";continue}r+=i}return t.push(r),t},nj=e=>(e||"image").replace(/\.[^/.]+$/,"")||"image",Boe=(e,t,r)=>{const n=e.width,a=e.height,i=new ImageData(t,r),o=e.data,s=i.data,l=n/t,u=a/r;for(let d=0;d<r;d++){const f=Math.floor(d*u),h=d*t*4,g=f*n*4;for(let b=0;b<t;b++){const v=Math.floor(b*l)*4,x=h+b*4,m=g+v;s[x]=o[m],s[x+1]=o[m+1],s[x+2]=o[m+2],s[x+3]=o[m+3]}}return i},Loe=(e,t)=>{if(!e)return null;if(t){const r=e.bayerPattern.toUpperCase(),n=l=>{const u=[];for(let d=0;d<4;d++)r[d]===l&&u.push(d);return u},a=t.BlackLevelRed,i=t.BlackLevelGreen,o=t.BlackLevelBlue;if(a!==void 0&&i!==void 0&&o!==void 0){const l=parseFloat(a),u=parseFloat(i),d=parseFloat(o);if(!isNaN(l)&&!isNaN(u)&&!isNaN(d)){const f=[0,0,0,0];if(f.fill(u),n("R").forEach(h=>f[h]=l),n("G").forEach(h=>f[h]=u),n("B").forEach(h=>d),f.some(h=>h>0))return f}}let s=t.BlackLevel;if(s===void 0&&(s=t.BlackLevel2),s!==void 0){let l=[];if(Array.isArray(s)?l=s.map(Number):typeof s=="string"?l=s.trim().split(/\s+/).map(Number):typeof s=="number"&&(l=[s,s,s,s]),l.length===1&&!isNaN(l[0])&&(l=[l[0],l[0],l[0],l[0]]),l.length>=4&&!l.slice(0,4).some(isNaN)&&l.some(u=>u>0))return[l[0],l[1],l[2],l[3]]}}return e.blackLevels&&e.blackLevels.length===4?[e.blackLevels[0],e.blackLevels[1],e.blackLevels[2],e.blackLevels[3]]:null},Foe=({stats:e,onClose:t,onMinimize:r,isBGGR:n,onToggleBGGR:a,onOpenWindow:i,displaySettings:o,zIndex:s,onFocus:l,rawImageData:u})=>{if(!e)return null;const d=!!o.showKadc,f=o.blackLevel||[0,0,0,0],h=!!o.subtractBlackLevelFromStats&&!!o.blackLevel,g=_.useMemo(()=>{if(!e||!u||!o.advancedZeroDep||o.renderMode!=="advanced-zero-dep")return null;try{const{x:k,y:P,width:j,height:S}=e,M=Jb(u,{x:k,y:P,w:j,h:S},o),O=[0,0,0,0],E=[0,0,0,0],I=Math.floor(P),D=Math.floor(k);for(let B=0;B<M.height;B++){const z=B*M.width;for(let Y=0;Y<M.width;Y++){const G=M.data[z+Y],$=I+B,L=D+Y,U=$%2,V=L%2,J=U*2+V;O[J]+=G,E[J]++}}return O.map((B,z)=>E[z]>0?B/E[z]:0)}catch(k){return console.error("Unmix calc error",k),null}},[e,u,o]),b=(k,P,j)=>d?P<=1e-4?0:(k-j)/P:null,w=(k,P)=>h?k-f[P]:k,v=()=>{if(!h){alert(`Sub. BL
Please enable 'Sub. BL' in Tools sidebar first.`);return}let k,P,j,S;n?(S=0,P=1,j=2,k=3):(k=0,P=1,j=2,S=3);const M=E=>e.means[E]-f[E],O=E=>e.stdDevs[E];localStorage.setItem("import_signal_r",M(k).toString()),localStorage.setItem("import_signal_g1",M(P).toString()),localStorage.setItem("import_signal_g2",M(j).toString()),localStorage.setItem("import_signal_b",M(S).toString()),localStorage.setItem("import_sigma_r",O(k).toString()),localStorage.setItem("import_sigma_g1",O(P).toString()),localStorage.setItem("import_sigma_g2",O(j).toString()),localStorage.setItem("import_sigma_b",O(S).toString()),window.open("https://y-g-jiang.github.io/XJZS.html","_blank")},x=n?[{name:"B",desc:"(0,0)",mean:w(e.means[0],0),std:e.stdDevs[0],color:"text-blue-500",snr:b(e.means[0],e.stdDevs[0],f[0]),unmixed:g?g[0]:null},{name:"G1",desc:"(0,1)",mean:w(e.means[1],1),std:e.stdDevs[1],color:"text-green-500",snr:b(e.means[1],e.stdDevs[1],f[1]),unmixed:g?g[1]:null},{name:"G2",desc:"(1,0)",mean:w(e.means[2],2),std:e.stdDevs[2],color:"text-green-500",snr:b(e.means[2],e.stdDevs[2],f[2]),unmixed:g?g[2]:null},{name:"R",desc:"(1,1)",mean:w(e.means[3],3),std:e.stdDevs[3],color:"text-red-500",snr:b(e.means[3],e.stdDevs[3],f[3]),unmixed:g?g[3]:null}]:[{name:"R",desc:"(0,0)",mean:w(e.means[0],0),std:e.stdDevs[0],color:"text-red-500",snr:b(e.means[0],e.stdDevs[0],f[0]),unmixed:g?g[0]:null},{name:"G1",desc:"(0,1)",mean:w(e.means[1],1),std:e.stdDevs[1],color:"text-green-500",snr:b(e.means[1],e.stdDevs[1],f[1]),unmixed:g?g[1]:null},{name:"G2",desc:"(1,0)",mean:w(e.means[2],2),std:e.stdDevs[2],color:"text-green-500",snr:b(e.means[2],e.stdDevs[2],f[2]),unmixed:g?g[2]:null},{name:"B",desc:"(1,1)",mean:w(e.means[3],3),std:e.stdDevs[3],color:"text-blue-500",snr:b(e.means[3],e.stdDevs[3],f[3]),unmixed:g?g[3]:null}],m=g?"w-96":d?"w-80":"w-60";return c.jsxs(ml,{className:`${m} p-0 overflow-hidden transition-all duration-300 bg-white dark:bg-black border-2 border-black dark:border-white shadow-[4px_4px_0px_rgba(0,0,0,0.5)] dark:shadow-[4px_4px_0px_rgba(255,255,255,0.2)]`,onClose:t,zIndex:s,onFocus:l,initialPosition:{x:20,y:80},children:[c.jsxs("div",{className:"flex justify-between items-center px-3 py-2 border-b border-gray-100 dark:border-slate-800 bg-gray-50/50 dark:bg-slate-800/50 select-none",children:[c.jsxs("h3",{className:"text-xs font-bold text-gray-700 dark:text-slate-300 uppercase tracking-wider flex items-center gap-2",children:["ROI Analysis",c.jsxs("span",{className:"text-[10px] font-normal text-gray-400 bg-gray-200 dark:bg-slate-700 px-1.5 py-0.5 rounded",children:[Math.round(e.width),"",Math.round(e.height)]})]}),c.jsxs("div",{className:"flex items-center gap-1",children:[c.jsx("button",{onClick:r,className:"text-gray-400 hover:text-gray-600 dark:hover:text-slate-300 transition-colors p-1 rounded-md hover:bg-gray-200 dark:hover:bg-slate-700 relative z-20",children:c.jsx("svg",{className:"w-3.5 h-3.5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M20 12H4"})})}),c.jsx("button",{onClick:t,className:"text-gray-400 hover:text-red-500 dark:hover:text-red-400 transition-colors p-1 rounded-md hover:bg-gray-200 dark:hover:bg-slate-700 relative z-20",children:c.jsx("svg",{className:"w-3.5 h-3.5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]})]}),c.jsxs("div",{className:"p-3",children:[c.jsxs("div",{className:"flex justify-between items-center mb-3",children:[c.jsxs("div",{className:"text-[10px] text-gray-400 dark:text-slate-500 font-mono leading-tight",children:["X: ",Math.round(e.x),c.jsx("br",{}),"Y: ",Math.round(e.y)]}),c.jsx("button",{onClick:()=>a(!n),className:"text-[10px] font-bold px-2 py-1 rounded bg-gray-100 hover:bg-gray-200 dark:bg-slate-800 dark:hover:bg-slate-700 text-gray-600 dark:text-slate-300 transition-colors border border-gray-200 dark:border-slate-700 relative z-20",title:"Toggle Bayer Pattern Interpretation",children:n?"BGGR":"RGGB"})]}),c.jsxs("table",{className:"w-full mb-3",children:[c.jsx("thead",{children:c.jsxs("tr",{className:"text-[10px] text-gray-400 dark:text-slate-500 border-b border-gray-100 dark:border-slate-800",children:[c.jsx("th",{className:"text-left pb-1 font-medium",children:"Ch"}),c.jsxs("th",{className:"text-right pb-1 font-medium",children:["Mean",h?"*":""]}),c.jsx("th",{className:"text-right pb-1 font-medium",children:"Std()"}),d&&c.jsx("th",{className:"text-right pb-1 font-medium text-cyan-600 dark:text-cyan-400",children:"k"}),g&&c.jsx("th",{className:"text-right pb-1 font-medium text-indigo-600 dark:text-indigo-400",children:"Unmix"})]})}),c.jsx("tbody",{className:"font-mono text-xs",children:x.map((k,P)=>c.jsxs("tr",{className:"group hover:bg-gray-50 dark:hover:bg-slate-800/30 transition-colors",children:[c.jsxs("td",{className:"py-1",children:[c.jsx("span",{className:`font-bold ${k.color}`,children:k.name}),c.jsx("span",{className:"text-[9px] text-gray-300 dark:text-slate-600 ml-1 hidden group-hover:inline",children:k.desc})]}),c.jsx("td",{className:"py-1 text-right text-gray-700 dark:text-slate-200 font-semibold",children:k.mean.toFixed(2)}),c.jsx("td",{className:"py-1 text-right text-gray-500 dark:text-slate-400",children:k.std.toFixed(2)}),d&&c.jsx("td",{className:"py-1 text-right text-cyan-600 dark:text-cyan-400 font-bold",children:k.snr!==null?k.snr.toFixed(2):"-"}),g&&c.jsx("td",{className:"py-1 text-right text-indigo-600 dark:text-indigo-400 font-bold",children:k.unmixed!==null?k.unmixed.toFixed(1):"-"})]},P))})]}),h&&c.jsx("div",{className:"mb-2 text-[9px] text-gray-400 dark:text-slate-500 text-right italic",children:"* Mean adjusted by Black Level"}),c.jsxs("div",{className:"flex flex-wrap gap-2",children:[c.jsx("button",{onClick:()=>i("histogram"),className:"relative z-20 flex-1 min-w-[50px] py-1.5 bg-cyan-600 hover:bg-cyan-500 text-white text-[10px] font-bold uppercase tracking-wide rounded shadow-sm hover:shadow transition-all active:scale-95 flex items-center justify-center gap-1",children:"Hist"}),c.jsx("button",{onClick:()=>i("quant"),className:"relative z-20 flex-1 min-w-[50px] py-1.5 bg-teal-600 hover:bg-teal-500 text-white text-[10px] font-bold uppercase tracking-wide rounded shadow-sm hover:shadow transition-all active:scale-95 flex items-center justify-center gap-1",children:"Quant"}),c.jsx("button",{onClick:()=>i("fft"),className:"relative z-20 flex-1 min-w-[50px] py-1.5 bg-purple-600 hover:bg-purple-500 text-white text-[10px] font-bold uppercase tracking-wide rounded shadow-sm hover:shadow transition-all active:scale-95 flex items-center justify-center gap-1",children:"FFT"}),c.jsx("button",{onClick:()=>i("pearson"),className:"relative z-20 flex-1 min-w-[50px] py-1.5 bg-indigo-600 hover:bg-indigo-500 text-white text-[10px] font-bold uppercase tracking-wide rounded shadow-sm hover:shadow transition-all active:scale-95 flex items-center justify-center gap-1",children:"PCC"}),c.jsx("button",{onClick:v,className:"relative z-20 flex-1 min-w-[50px] py-1.5 bg-pink-600 hover:bg-pink-500 text-white text-[10px] font-bold uppercase tracking-wide rounded shadow-sm hover:shadow transition-all active:scale-95 flex items-center justify-center gap-1",children:"ColorN"})]})]})]})},Goe=()=>{var dw;const[e,t]=_.useState("init"),[r,n]=_.useState("Checking storage..."),[a,i]=_.useState(null),o=_.useRef(!1),[s,l]=_.useState("dark"),[u,d]=_.useState(!1);_.useEffect(()=>((async()=>{const W=await Cs.init();d(W),console.log("WebGPU Available:",W)})(),()=>{Cs.disposeAll()}),[]),_.useEffect(()=>{const T=window.document.documentElement;T.classList.remove(s==="dark"?"light":"dark"),T.classList.add(s)},[s]);const[f,h]=_.useState(!1),[g,b]=_.useState(!1),[w,v]=_.useState(!1),[x,m]=_.useState(!1),[k,P]=_.useState(!1),[j,S]=_.useState(!1),M=coe(f||g||w),[O,E]=_.useState(!1),[I,D]=_.useState([]),[B,z]=_.useState(-1),[Y,G]=_.useState([]),$=_.useMemo(()=>I[B],[I,B]),L=_.useRef(null);_.useEffect(()=>{L.current=$||null},[$]);const U=_.useRef({}),V=($==null?void 0:$.file)||null,J=($==null?void 0:$.imageElement)||null,K=($==null?void 0:$.rawImageData)||null,Q=($==null?void 0:$.rawFileBuffer)||null,te=($==null?void 0:$.renderedRawImageData)||null,ee=($==null?void 0:$.referenceImageData)||null,me=($==null?void 0:$.sampledImageData)||null,re=($==null?void 0:$.exifData)||null,De=($==null?void 0:$.isThreePlane)||!1,fe=($==null?void 0:$.psDocument)||null,le=($==null?void 0:$.xtransPhase)||{x:0,y:0},de=($==null?void 0:$.displaySettings)||{exposure:0,demosaicMethod:3,blackLevel:void 0,wbGains:[1,1],showKadc:!0,subtractBlackLevelFromStats:!0},Se=_.useMemo(()=>fe?{...fe,guides:[],selectedGuideId:null}:null,[fe==null?void 0:fe.id,fe==null?void 0:fe.width,fe==null?void 0:fe.height,fe==null?void 0:fe.baseRgb,fe==null?void 0:fe.masks,fe==null?void 0:fe.layers,fe==null?void 0:fe.selectedMaskId,fe==null?void 0:fe.selectedLayerId,fe==null?void 0:fe.transform,fe==null?void 0:fe.historyIndex]),[he,Pe]=_.useState(!1),[ve,ye]=_.useState(null),[ge,ue]=_.useState(!1),[Le,rt]=_.useState(!1),[et,tt]=_.useState(null),[ft,wt]=_.useState([]),[fr,Wt]=_.useState(100),[kt,Bt]=_.useState(!0),[Sr,Gr]=_.useState(!1),[rr,Nr]=_.useState(null),[nt,Ot]=_.useState(!1),[pr,br]=_.useState(!1),[jr,Rr]=_.useState(!1),[Pr,Kt]=_.useState(!1),[Er,jt]=_.useState(!1),[Me,X]=_.useState("1.0"),[Te,xe]=_.useState(!1),[ze,Je]=_.useState(!1),[ot,Pt]=_.useState(!1),[Qe,_r]=_.useState(!1),[sr,Jt]=_.useState(!1),[vt,nr]=_.useState(32),[A,Ge]=_.useState(.35),[Ke,Yt]=_.useState(.6),[Ht,At]=_.useState(24),[yr,Xr]=_.useState("add"),[ut,Dt]=_.useState(null),[Vt,ar]=_.useState("off"),[St,_e]=_.useState(null),[Or,F]=_.useState(null),[Ce,Ee]=_.useState(!1),[_t,He]=_.useState(null),[dt,qe]=_.useState(null),Lt=_.useRef({}),Ur=_.useRef(null),Kr=_.useRef([]),lr=_.useRef(null),kn=_.useRef(null);_.useEffect(()=>{lr.current=_t},[_t]),_.useEffect(()=>{kn.current=dt},[dt]);const[Yr,Ar]=_.useState([]),[cr,Ft]=_.useState(!1),[Br,We]=_.useState(0),[xr,mn]=_.useState([]),[sa,Da]=_.useState(!1),[Sn,Ja]=_.useState({x:0,y:0}),[ce,be]=_.useState(!1),[ke,ae]=_.useState(!1),[$e,pt]=_.useState([]),[yt,Tt]=_.useState(0),[Et,Mt]=_.useState(null),[Ir,gr]=_.useState(!1),[Cr,Lr]=_.useState([]),[Ie,Ct]=_.useState(.5),[gt,zr]=_.useState(!1),[ur,Rn]=_.useState(2),[Mr,qr]=_.useState(1),[jn,Qa]=_.useState([]),[go,Go]=_.useState(null),[Pa,Ra]=_.useState(0),[ji,sn]=_.useState([]),[mo,yo]=_.useState([]),[zi,Ba]=_.useState(64),[_a,Zr]=_.useState(10),[Bn,yl]=_.useState(10),[Ln,at]=_.useState(4),[qt,dr]=_.useState(1),[Gt,Kn]=_.useState(0),[Hr,la]=_.useState("processed"),[La,Fn]=_.useState(!1),ga=_.useMemo(()=>de.blackLevel?de.blackLevel:K!=null&&K.blackLevels?[K.blackLevels[0],K.blackLevels[1],K.blackLevels[2],K.blackLevels[3]]:[0,0,0,0],[de.blackLevel,K]),tn=(re==null?void 0:re.ImageHeight)||(re==null?void 0:re.ExifImageHeight)||(K==null?void 0:K.height)||0,[Uo,Rt]=_.useState(null),[zo,It]=_.useState(null),[Wo,vs]=_.useState({x:0,y:0}),[Wi,xl]=_.useState(1),[kc,vl]=_.useState("pan"),Ho=_.useRef(null),xo=_.useRef(null);_.useEffect(()=>{if(u&&$&&$.rawImageData&&$.id){const{data:T,width:W,height:q}=$.rawImageData;Cs.uploadImage($.id,T,W,q)}},[u,$==null?void 0:$.id]),_.useEffect(()=>{const T=moe();T&&T.sessions.length>0?(i(T),t("prompt")):t("idle")},[]),_.useCallback(async()=>{o.current=!0,n("Cleaning up..."),localStorage.removeItem("jtr_workspace_index");try{await poe()}catch(T){console.error("Failed to clear DB",T)}t("idle"),i(null),o.current=!1},[]),_.useCallback(async()=>{if(!a)return;t("restoring"),n("Restoring layout...");const T=a;if(l(T.theme),Bt(T.sidebarOpen),T.sessions.length>0){n(`Restoring ${T.sessions.length} images...`);const W=[];for(const q of T.sessions){if(o.current)return;await new Promise(ie=>setTimeout(ie,50));try{const ie=await hoe(q.id);if(ie){const we={id:q.id,fileName:q.fileName,file:null,imageElement:null,rawImageData:null,rawFileBuffer:ie,renderedRawImageData:null,referenceImageData:null,sampledImageData:null,exifData:null,isThreePlane:q.isThreePlane,displaySettings:q.displaySettings,originalRawFileBuffer:null,isXTransOriginal:!1,isXTransConverted:!1,xtransPhase:{x:0,y:0},psDocument:null},{previewBlob:Ae,analysisData:Ve}=await Oc(ie);let Xe=null;if(Ve)try{q.displaySettings.renderMode==="zero-dependency"?Xe=await Oy(ie,q.displaySettings):q.displaySettings.renderMode==="advanced-zero-dep"?Xe=await T8(ie,q.displaySettings):q.displaySettings.renderMode==="zero-dep-color"?Xe=await A8(ie,q.displaySettings):Xe=await O8(ie,q.displaySettings)}catch(bt){console.error("Render failed",bt),Xe=await Oy(ie,q.displaySettings)}const ct=URL.createObjectURL(Ae),Ne=new Image;Ne.src=ct,await new Promise(bt=>{Ne.onload=()=>bt()}),W.push({...we,rawImageData:Ve,renderedRawImageData:Xe,previewUrl:ct,imageElement:Ne,exifData:Ve.metadata})}}catch(ie){console.error(`Failed to restore session ${q.id}`,ie)}}if(o.current)return;if(D(W),T.activeSessionId){const q=W.findIndex(ie=>ie.id===T.activeSessionId);q>=0?z(q):W.length>0&&z(0)}wt(T.windows)}o.current||t("idle")},[a]);const bl=_.useCallback(async()=>{Rr(!1);const T=$;if(u&&T&&T.id&&Cs.hasImage(T.id)&&(T.displaySettings.renderMode||"standard")!=="standard"){It("Exporting via WebGPU...");try{const ie=await Cs.export16Bit(T.id,T.displaySettings,Pr,Er);if(ie){const we=X4(T.rawImageData.width,T.rawImageData.height,ie,3),Ae=new Blob([we],{type:"image/tiff"}),Ve=URL.createObjectURL(Ae),Xe=document.createElement("a");Xe.href=Ve,Xe.download=`export_webgpu_${Date.now()}.tiff`,document.body.appendChild(Xe),Xe.click(),document.body.removeChild(Xe),URL.revokeObjectURL(Ve),It(null);return}}catch(ie){console.error("WebGPU Export Failed, falling back to CPU",ie)}}!Q||!$||(It("Exporting 16-bit TIFF (CPU)..."),setTimeout(async()=>{try{const W=await W_(Q,de,Pr,Er),q=X4(W.width,W.height,W.data,W.channels),ie=new Blob([q],{type:"image/tiff"}),we=URL.createObjectURL(ie),Ae=document.createElement("a");Ae.href=we,Ae.download=`export_${Date.now()}.tiff`,document.body.appendChild(Ae),Ae.click(),document.body.removeChild(Ae),URL.revokeObjectURL(we)}catch(W){Rt("Export failed: "+W.message)}finally{It(null)}},100))},[Q,$,de,Pr,Er,u]),wl=_.useCallback(()=>{!Q||!$||Rr(!0)},[Q,$]),sd=_.useCallback(async()=>{},[K,$,Me,ga]);_.useEffect(()=>{const T=W=>{(W.ctrlKey||W.metaKey)&&W.key.toLowerCase()==="s"&&(W.preventDefault(),wl())};return window.addEventListener("keydown",T),()=>window.removeEventListener("keydown",T)},[wl]);const kl=_.useRef(null),Sc=_.useCallback(()=>{e==="idle"&&(kl.current&&clearTimeout(kl.current),kl.current=window.setTimeout(async()=>{var q;const T={version:1,timestamp:Date.now(),activeSessionId:((q=I[B])==null?void 0:q.id)||null,theme:s,sidebarOpen:kt,sessions:I.map(ie=>({id:ie.id,fileName:ie.fileName,fileType:ie.file?ie.file.type:"application/octet-stream",fileSize:ie.rawFileBuffer?ie.rawFileBuffer.byteLength:0,displaySettings:ie.displaySettings,isThreePlane:ie.isThreePlane})),windows:ft.map(ie=>({id:ie.id,type:ie.type,roi:ie.roi,zIndex:ie.zIndex,initialPosition:ie.initialPosition,sessionId:ie.sessionId,isBGGR:ie.isBGGR,isMinimized:ie.isMinimized||!1,internalState:ie.internalState}))};goe(T);const W=I.map(ie=>ie.id);yoe(W)},1e3))},[I,ft,B,s,kt,e]);_.useEffect(()=>{Sc()},[Sc]);const ui=_.useCallback(T=>{D(W=>W.map((q,ie)=>ie===B?{...q,...T}:q))},[B]),Fa=_.useCallback((T,W)=>{D(q=>q.map(ie=>ie.id===T?{...ie,...W}:ie))},[]),Ga=_.useCallback((T,W)=>({...T,history:W.entries.map(q=>({id:q.id,label:q.label,timestamp:q.timestamp})),historyIndex:W.index}),[]),bs=_.useCallback((T,W,q="Initialize PS Document",ie=[])=>{const we=_h(W),Ve={entries:[{id:`history_${Date.now()}_${Math.random().toString(36).slice(2,7)}`,label:q,timestamp:Date.now(),doc:we,transformOps:Ts(ie)}],index:0};return U.current[T]=Ve,Ga(W,Ve)},[Ga]);_.useEffect(()=>{const T=new Set(I.map(W=>W.id));Object.keys(U.current).forEach(W=>{T.has(W)||delete U.current[W]}),Object.keys(Lt.current).forEach(W=>{T.has(W)||delete Lt.current[W]})},[I]);const ld=()=>z(T=>Math.min(T+1,I.length-1)),cd=()=>z(T=>Math.max(0,T-1));_.useEffect(()=>{if(K&&ve){const T=Pl(K.data,K.width,K.height,ve.x,ve.y,ve.width,ve.height);ye(T)}},[K]);const ws=_.useCallback(async T=>{const W=T.displaySettings.renderMode||"standard";if(u&&Cs.hasImage(T.id)&&W!=="standard"&&T.rawImageData){const we=await Cs.export16Bit(T.id,T.displaySettings,!0,!0);if(we)return{width:T.rawImageData.width,height:T.rawImageData.height,data:MT(we)}}return Z4.test(T.fileName)&&T.rawFileBuffer?await E8(T.rawFileBuffer,T.displaySettings):T.renderedRawImageData?{width:T.renderedRawImageData.width,height:T.renderedRawImageData.height,data:x_(T.renderedRawImageData)}:T.imageElement?await NT(T.imageElement):null},[u]),ks=_.useCallback(async T=>{if(T.psDocument)return;const W=await ws(T);if(!W)throw new Error("Failed to build PS source buffer.");const q=Sk(T.id,W.width,W.height,W.data),ie=bs(T.id,q,"Initialize PS Document");Fa(T.id,{psDocument:ie})},[ws,Fa,bs]),ud=_.useCallback(async()=>{const T=!Qe;if(T&&$){It("Preparing PS Mode Float32 source...");try{await ks($)}catch(W){Rt(`PS Mode init failed: ${W.message||W}`),It(null);return}It(null)}_r(T),T?(Te&&xe(!1),ze&&Je(!1),ke&&ae(!1),ot&&Pt(!1),Tt(0),Lr([]),Ar([]),Ft(!1),We(0)):(Jt(!1),Dt(null),ar("off"),_e(null),qe(null),He(null))},[Qe,$,ks,Te,ze,ke,ot]);_.useEffect(()=>{if(!Qe||!$||$.psDocument)return;let T=!1;return(async()=>{try{await ks($)}catch(W){T||console.error("PS document auto-init failed:",W)}})(),()=>{T=!0}},[Qe,$,ks]),_.useEffect(()=>{if(!Qe||!Se){He(null);return}if(Ce)return;let T=!1;return(async()=>{var Ae;let W=null;const q=kn.current,ie=lr.current,we=((Ae=L.current)==null?void 0:Ae.id)||Se.id;if(u)if(W=await jh.renderPreview(Se),W)Lt.current[we]=!0;else{const Ve=jh.wasBusyLastRender(),Xe=!!Lt.current[we];if(Ve||Xe)return}W||(q&&ie?W=VT(Se,ie,q):W=ov(Se)),T||(He(W),q&&qe(null))})(),()=>{T=!0}},[Qe,Se,u,Ce]);const xt=_.useCallback((T,W)=>{var Ue;const q=L.current;if(!(q!=null&&q.psDocument))return;const ie={label:(W==null?void 0:W.label)||"PS Edit",trackHistory:(W==null?void 0:W.trackHistory)!==!1,transformOp:W==null?void 0:W.transformOp},we=T(q.psDocument);if(we===q.psDocument)return;if(!ie.trackHistory){const Ut=U.current[q.id],or=Ut?Ga(we,Ut):we;Fa(q.id,{psDocument:or});return}let Ae=U.current[q.id];Ae||(Ae={entries:[{id:`history_${Date.now()}_${Math.random().toString(36).slice(2,7)}`,label:"Initialize PS Document",timestamp:Date.now(),doc:_h(q.psDocument),transformOps:[]}],index:0});const Ve=((Ue=Ae.entries[Ae.index])==null?void 0:Ue.transformOps)||[],Xe=ie.transformOp?[...Ve,AO(ie.transformOp)]:Ve,ct=Ae.entries.slice(0,Ae.index+1);ct.push({id:`history_${Date.now()}_${Math.random().toString(36).slice(2,7)}`,label:ie.label,timestamp:Date.now(),doc:_h(we),transformOps:Ts(Xe)});let Ne=ct.length-1;if(ct.length>Q4){const Ut=ct.length-Q4;ct.splice(0,Ut),Ne=Math.max(0,Ne-Ut)}const bt={entries:ct,index:Ne};U.current[q.id]=bt;const Nt=Ga(we,bt);Fa(q.id,{psDocument:Nt})},[Fa,Ga]),dd=_.useCallback(()=>{const T=L.current;if(!(T!=null&&T.psDocument))return;const W=U.current[T.id];if(!W||W.index<=0)return;const q=W.index-1,ie={...W,index:q};U.current[T.id]=ie;const we=dx(ie.entries[q].doc),Ae=Ga(we,ie);Fa(T.id,{psDocument:Ae}),qe(null),He(null)},[Fa,Ga]),fd=_.useCallback(T=>{const W=L.current;if(!(W!=null&&W.psDocument))return;const q=U.current[W.id];if(!q||T<0||T>=q.entries.length)return;const ie={...q,index:T};U.current[W.id]=ie;const we=dx(ie.entries[T].doc),Ae=Ga(we,ie);Fa(W.id,{psDocument:Ae}),qe(null),He(null)},[Fa,Ga]),Hi=_.useCallback((T,W)=>{const q=URL.createObjectURL(T),ie=document.createElement("a");ie.href=q,ie.download=W,document.body.appendChild(ie),ie.click(),document.body.removeChild(ie),URL.revokeObjectURL(q)},[]),Vo=_.useCallback((T,W,q)=>new Promise((ie,we)=>{const Ae=document.createElement("canvas");Ae.width=T.width,Ae.height=T.height;const Ve=Ae.getContext("2d");if(!Ve){we(new Error("Failed to get 2D canvas context."));return}Ve.putImageData(T,0,0),Ae.toBlob(Xe=>{if(!Xe){we(new Error("Failed to encode image blob."));return}ie(Xe)},W,q)}),[]),Xo=_.useCallback(async()=>{const T=L.current;if(!T)return null;const W=nj(T.fileName);if(Qe&&T.psDocument){if(lr.current)return{imageData:lr.current,baseName:W};let q=null;if(u)if(q=await jh.renderPreview(T.psDocument),q)Lt.current[T.id]=!0;else{const ie=jh.wasBusyLastRender(),we=!!Lt.current[T.id];if(ie||we)return null}return q||(q=ov(T.psDocument)),{imageData:q,baseName:W}}if(Hr==="reference"&&T.referenceImageData)return{imageData:T.referenceImageData,baseName:W};if(Hr==="sampled"&&T.sampledImageData)return{imageData:T.sampledImageData,baseName:W};if(T.renderedRawImageData)return{imageData:T.renderedRawImageData,baseName:W};if(T.imageElement){const q=T.imageElement.naturalWidth||T.imageElement.width,ie=T.imageElement.naturalHeight||T.imageElement.height,we=document.createElement("canvas");we.width=q,we.height=ie;const Ae=we.getContext("2d");return Ae?(Ae.drawImage(T.imageElement,0,0,q,ie),{imageData:Ae.getImageData(0,0,q,ie),baseName:W}):null}return null},[Qe,u,Hr]),Z=_.useCallback(async()=>{try{const T=await Xo();if(!T){Rt("No image available for PNG export.");return}const W=await Vo(T.imageData,"image/png");Hi(W,`${T.baseName}_ps_export_${Date.now()}.png`)}catch(T){Rt(`PNG export failed: ${(T==null?void 0:T.message)||T}`)}},[Xo,Vo,Hi]),Oe=_.useCallback(async()=>{try{const T=await Xo();if(!T){Rt("No image available for JPEG export.");return}const W=await Vo(T.imageData,"image/jpeg",.92);Hi(W,`${T.baseName}_ps_export_${Date.now()}.jpg`)}catch(T){Rt(`JPEG export failed: ${(T==null?void 0:T.message)||T}`)}},[Xo,Vo,Hi]),Qt=_.useCallback(async()=>{var W,q,ie,we,Ae,Ve;const T=L.current;if(!(T!=null&&T.psDocument)){Rt("No PS workflow to export.");return}It("Exporting PS workflow...");try{const Xe=T.psDocument,ct=((W=T.rawImageData)==null?void 0:W.width)||((q=T.imageElement)==null?void 0:q.naturalWidth)||((ie=T.imageElement)==null?void 0:ie.width)||Xe.width,Ne=((we=T.rawImageData)==null?void 0:we.height)||((Ae=T.imageElement)==null?void 0:Ae.naturalHeight)||((Ve=T.imageElement)==null?void 0:Ve.height)||Xe.height,bt={signature:Bd,version:3,exportedAt:new Date().toISOString(),sourceFileName:T.fileName,sourceWidth:ct,sourceHeight:Ne,width:Xe.width,height:Xe.height,displaySettings:{...T.displaySettings},psUi:{brushEnabled:sr,brushSize:vt,brushOpacity:A,brushFeather:Ke,ellipseFeather:Ht,brushMode:yr},flow:(()=>{var ln,wr;const or=U.current[T.id],xn=((wr=(ln=or==null?void 0:or.entries)==null?void 0:ln[or.index])==null?void 0:wr.transformOps)||[];return ej(Xe,xn)})(),history:(()=>{const or=U.current[T.id];if(!or||or.entries.length===0)return;const xn=Math.max(0,Math.min(or.entries.length-1,or.index)),ln=Math.max(0,xn-Toe+1),wr=or.entries.slice(ln,xn+1);return{index:wr.length-1,entries:wr.map(Tr=>({id:Tr.id,label:Tr.label,timestamp:Tr.timestamp,flow:ej(Tr.doc,Tr.transformOps||[])}))}})()},Ue=JSON.stringify({format:J4,version:1,payload:bt}),Ut=new Blob([Ue],{type:"application/json;charset=utf-8"});Hi(Ut,`${nj(T.fileName)}_ps_workflow.json`)}catch(Xe){Rt(`Export workflow failed: ${(Xe==null?void 0:Xe.message)||Xe}`)}finally{It(null)}},[Hi,sr,vt,A,Ke,Ht,yr]),nn=_.useCallback(async T=>{var q,ie,we,Ae,Ve,Xe,ct;if(!L.current){Rt("Load an image first, then import workflow file.");return}It("Importing PS workflow...");try{const Ne=L.current;if(!Ne)throw new Error("Session disappeared during import.");const bt=await T.text(),Nt=bt.trim();if(!Nt)throw new Error("Workflow file is empty.");let Ue=null;if(Nt.startsWith("{")){let hr;try{hr=JSON.parse(Nt)}catch{throw new Error("Invalid workflow JSON.")}const Gn=hr;if((Gn==null?void 0:Gn.format)===J4&&(Gn!=null&&Gn.payload))Ue=Gn.payload;else if(hr!=null&&hr.payload&&((q=hr==null?void 0:hr.payload)==null?void 0:q.signature)===Bd)Ue=hr.payload;else if((hr==null?void 0:hr.signature)===Bd)Ue=hr;else throw new Error("Invalid workflow JSON signature.")}else{const hr={};if(bt.split(/\r?\n/).map(Gn=>Gn.trim()).filter(Boolean).forEach(Gn=>{const _i=Roe(Gn);if(_i.length<2)return;const wo=rj(_i[0]).trim().toLowerCase(),ko=rj(_i.slice(1).join(","));hr[wo]=ko}),hr.signature!==Bd)throw new Error("Invalid workflow CSV signature.");Ue=hr.payload_json?JSON.parse(hr.payload_json):hr.payload_b64?JSON.parse(Doe(hr.payload_b64)):null}if(!Ue)throw new Error("Missing workflow payload.");if(Ue.signature!==Bd)throw new Error("Workflow payload signature mismatch.");const Ut=Number(Ue.sourceWidth||Ue.width),or=Number(Ue.sourceHeight||Ue.height),xn=((ie=Ne.rawImageData)==null?void 0:ie.width)||((we=Ne.imageElement)==null?void 0:we.naturalWidth)||((Ae=Ne.imageElement)==null?void 0:Ae.width)||Ut,ln=((Ve=Ne.rawImageData)==null?void 0:Ve.height)||((Xe=Ne.imageElement)==null?void 0:Xe.naturalHeight)||((ct=Ne.imageElement)==null?void 0:ct.height)||or;if(Ut!==xn||or!==ln)throw new Error(`Source size mismatch: workflow expects ${Ut}x${or}, current file is ${xn}x${ln}.`);const wr=Number(Ue.width),Tr=Number(Ue.height);if(!Number.isFinite(wr)||!Number.isFinite(Tr)||wr<=0||Tr<=0)throw new Error("Invalid workflow canvas size.");const vn=await ws(Ne);if(!vn)throw new Error("Failed to rebuild source image for workflow import.");const Zn=Sk(Ne.id,vn.width,vn.height,vn.data),ca={width:Number(Ue.flow.width||Ue.width),height:Number(Ue.flow.height||Ue.height),transformOps:Ts(Ue.flow.transformOps||[]),masks:(Ue.flow.masks||[]).map(hr=>({...hr,items:(hr.items||[]).map(Gu)})),layers:(Ue.flow.layers||[]).map(kg),guides:(Ue.flow.guides||[]).map(Yl),selectedMaskId:Ue.flow.selectedMaskId||"",selectedLayerId:Ue.flow.selectedLayerId||"",selectedMaskItemId:Ue.flow.selectedMaskItemId??null,selectedGuideId:Ue.flow.selectedGuideId??null,transform:Ue.flow.transform?{rotationDeg:Number(Ue.flow.transform.rotationDeg)||0,crop:Ue.flow.transform.crop?{...Ue.flow.transform.crop}:null}:{rotationDeg:0,crop:null}},Jn=tj(Zn,ca);let Ca;const hi=Ue.history;if(hi&&Array.isArray(hi.entries)&&hi.entries.length>0){const hr=Number(hi.index),Gn=Number.isFinite(hr)?Math.max(0,Math.min(hi.entries.length-1,hr)):hi.entries.length-1,_i=Math.max(0,Gn-Eoe+1),wo=hi.entries.slice(_i,Gn+1),ko=[];for(const Cc of wo){const Ma=Cc.flow||ca,fw={width:Number(Ma.width||ca.width),height:Number(Ma.height||ca.height),transformOps:Ts(Ma.transformOps||[]),masks:(Ma.masks||[]).map(hw=>({...hw,items:(hw.items||[]).map(Gu)})),layers:(Ma.layers||[]).map(kg),guides:(Ma.guides||[]).map(Yl),selectedMaskId:Ma.selectedMaskId||"",selectedLayerId:Ma.selectedLayerId||"",selectedMaskItemId:Ma.selectedMaskItemId??null,selectedGuideId:Ma.selectedGuideId??null,transform:Ma.transform?{rotationDeg:Number(Ma.transform.rotationDeg)||0,crop:Ma.transform.crop?{...Ma.transform.crop}:null}:{rotationDeg:0,crop:null}},zO=tj(Zn,fw);ko.push({id:Cc.id||`history_${Date.now()}_${Math.random().toString(36).slice(2,7)}`,label:Cc.label||"PS Edit",timestamp:Number(Cc.timestamp)||Date.now(),doc:_h(zO),transformOps:Ts(fw.transformOps||[])})}const D0=ko.length-1,jl={entries:ko,index:D0};U.current[Ne.id]=jl;const _c=dx(ko[D0].doc);Ca=Ga(_c,jl)}else{const hr=Ts(ca.transformOps||[]);Ca=bs(Ne.id,Jn,"Import Workflow",hr)}Fa(Ne.id,{psDocument:Ca,displaySettings:Ue.displaySettings?{...Ue.displaySettings}:Ne.displaySettings}),Ue.psUi&&(Jt(!!Ue.psUi.brushEnabled),nr(Math.max(1,Number(Ue.psUi.brushSize)||32)),Ge(Math.max(0,Math.min(1,Number(Ue.psUi.brushOpacity)||.35))),Yt(Math.max(0,Math.min(1,Number(Ue.psUi.brushFeather)||0))),At(Math.max(0,Number(Ue.psUi.ellipseFeather)||0)),Xr(Ue.psUi.brushMode==="subtract"?"subtract":"add")),Dt(null),ar("off"),_e(null),qe(null),He(null)}catch(Ne){Rt(`Import workflow failed: ${(Ne==null?void 0:Ne.message)||Ne}`)}finally{It(null)}},[ws,bs,Fa,Ga]),Pn=_.useCallback(T=>{xt(W=>{const q=W.layers.find(ie=>ie.id===T);return{...W,selectedLayerId:T,selectedMaskId:q?q.maskId:W.selectedMaskId}},{trackHistory:!1}),qe(null)},[xt]),Yn=_.useCallback(T=>{xt(W=>v_(W,T),{trackHistory:!1}),qe(null)},[xt]),Jr=_.useCallback(T=>{xt(W=>DT(W,T),{trackHistory:!1})},[xt]),ma=_.useCallback((T,W)=>{xt(q=>RT(q,T,W),{label:"Edit Ellipse"}),qe(null)},[xt]),di=_.useCallback((T,W)=>{xt(q=>BT(q,T,W),{label:"Toggle Mask Overlay"})},[xt]),Pi=_.useCallback(()=>{xt(T=>Ub(T),{label:"Add Mask"}),qe(null)},[xt]),vo=_.useCallback(()=>{ar("center"),_e(null)},[]),Vi=_.useCallback(()=>{ar("off"),_e(null)},[]),ya=_.useCallback(T=>{Vt==="center"&&(_e({center:T,radiusX:1,radiusY:1,rotationDeg:0}),ar("drag"))},[Vt]),hd=_.useCallback((T,W)=>{if(Vt!=="drag"||!St)return;const q=T.x-St.center.x,ie=T.y-St.center.y,we={...St,radiusX:Math.max(1,Math.abs(q)),radiusY:Math.max(1,Math.abs(ie))};_e(we),W==="end"&&(xt(Ae=>ET(Ae,we,Ht,yr),{label:"Add Ellipse Item"}),ar("off"),_e(null),qe(null))},[Vt,St,xt,Ht,yr]),Em=_.useCallback(()=>{if(!ve){Rt("Create an ROI first, then crop.");return}const T={x:ve.x,y:ve.y,w:ve.width,h:ve.height};xt(W=>k_(W,T),{label:"Crop To ROI",transformOp:{type:"crop",rect:T}}),qe(null),He(null),ye(null),tt(null)},[xt,ve]),Im=_.useCallback(T=>{xt(W=>S_(W,T),{label:`Rotate ${T.toFixed(1)}deg`,transformOp:{type:"rotate",angleDeg:T}}),qe(null),He(null),ye(null),tt(null)},[xt]),$m=_.useCallback(()=>{xt(T=>j_(T),{label:"Flip Horizontal",transformOp:{type:"flipH"}}),qe(null),He(null),ye(null),tt(null)},[xt]),Dm=_.useCallback(()=>{xt(T=>P_(T),{label:"Flip Vertical",transformOp:{type:"flipV"}}),qe(null),He(null),ye(null),tt(null)},[xt]),Rm=_.useCallback(()=>{var W,q;const T=(((q=(W=L.current)==null?void 0:W.psDocument)==null?void 0:q.guides)||[]).map(Yl);xt(ie=>__(ie),{label:"Apply Upright",transformOp:{type:"upright",guides:T}}),qe(null),He(null),ye(null),tt(null)},[xt]),Bm=_.useCallback(T=>{xt(W=>OT(W,T),{label:`Add ${T==="horizontal"?"H":"V"} Guide`})},[xt]),Lm=_.useCallback(T=>{xt(W=>AT(W,T),{trackHistory:!1})},[xt]),Fm=_.useCallback((T,W,q)=>{xt(ie=>jk(ie,T,W,q),{label:"Edit Guide"})},[xt]),_0=_.useCallback(T=>{Dt(T)},[]),bo=_.useCallback(()=>{Dt(null)},[]),pd=_.useCallback(T=>{const W=ut;W&&(xt(q=>{if(!q.selectedGuideId)return q;const ie=q.guides.find(Ae=>Ae.id===q.selectedGuideId);if(!ie)return q;const we={x:T.x,y:T.y};return jk(q,ie.id,W==="p1"?we:ie.p1,W==="p2"?we:ie.p2)},{label:"Pick Guide Endpoint"}),Dt(null))},[xt,ut]),Xi=_.useCallback(T=>{xt(W=>TT(W,T),{label:"Delete Guide"})},[xt]),C0=_.useCallback((T,W)=>{xt(q=>({...q,layers:q.layers.map(ie=>ie.id===T?{...ie,maskId:W}:ie),selectedLayerId:T,selectedMaskId:W}),{label:"Bind Layer To Mask"}),qe(null)},[xt]),M0=_.useCallback((T,W)=>{xt(q=>({...q,layers:q.layers.map(ie=>ie.id===T?{...ie,blendMode:W}:ie)}),{label:"Set Layer Blend"})},[xt]),jc=_.useCallback((T,W)=>{xt(q=>({...q,layers:q.layers.map(ie=>ie.id===T?{...ie,opacity:Math.max(0,Math.min(1,W))}:ie)}),{label:"Set Layer Opacity"})},[xt]),N0=_.useCallback((T,W)=>{const q=g0(W);xt(ie=>({...ie,layers:ie.layers.map(we=>we.id===T?{...we,basic:q}:we)}),{label:"Set Layer Basic"}),qe(null)},[xt]),Gm=_.useCallback((T,W)=>{const q=m0(W);xt(ie=>({...ie,layers:ie.layers.map(we=>we.id===T?{...we,mixer:q}:we)}),{label:"Set Layer Mixer"}),qe(null)},[xt]),Um=_.useCallback((T,W)=>{var Ve,Xe;const q=ct=>{const Ne=(ct||[]).map(bt=>({x:Math.max(0,Math.min(1,Number((bt==null?void 0:bt.x)??0))),y:Math.max(0,Math.min(1,Number((bt==null?void 0:bt.y)??0)))})).filter(bt=>!Number.isNaN(bt.x)&&!Number.isNaN(bt.y)).sort((bt,Nt)=>bt.x-Nt.x);return Ne.length<2?[{x:0,y:0},{x:1,y:1}]:(Ne[0].x=0,Ne[Ne.length-1].x=1,Ne)};xt(ct=>({...ct,layers:ct.layers.map(Ne=>Ne.id===T?{...Ne,curves:{master:q(W.master),red:q(W.red),green:q(W.green),blue:q(W.blue)}}:Ne)}),{label:`Edit ${T} Curves`});const ie=L.current,we=(Ve=ie==null?void 0:ie.psDocument)==null?void 0:Ve.layers.find(ct=>ct.id===T),Ae=we?(Xe=ie==null?void 0:ie.psDocument)==null?void 0:Xe.masks.find(ct=>ct.id===we.maskId):null;qe(Ae?CT(Ae):null)},[xt]),gd=_.useCallback(T=>{Kr.current.push({x:T.x,y:T.y}),xt(q=>IT(q,T.x,T.y,vt,A,yr,Ke),{trackHistory:!1});const W={x0:Math.floor(T.x-vt-2),y0:Math.floor(T.y-vt-2),x1:Math.ceil(T.x+vt+2),y1:Math.ceil(T.y+vt+2)};qe(q=>q?{x0:Math.min(q.x0,W.x0),y0:Math.min(q.y0,W.y0),x1:Math.max(q.x1,W.x1),y1:Math.max(q.y1,W.y1)}:W)},[xt,vt,A,yr,Ke]),zm=_.useCallback((T,W)=>{if(!sr)return;if(W==="start"&&(Ee(!0),Kr.current=[]),W==="end"){Or!==null&&(cancelAnimationFrame(Or),F(null));const ie=Ur.current;ie&&gd(ie);const we=Kr.current;we.length>0&&xt(Ae=>$T(Ae,we,vt,A,yr,Ke),{label:"Brush Stroke"}),Ur.current=null,Kr.current=[],Ee(!1);return}if(Ur.current=T,Or!==null)return;const q=requestAnimationFrame(()=>{F(null);const ie=Ur.current;ie&&gd(ie)});F(q)},[sr,Or,gd,xt,vt,A,yr,Ke]);_.useEffect(()=>()=>{Or!==null&&cancelAnimationFrame(Or)},[Or]);const Wm=T=>{if(!ve||!$)return;const W=Date.now().toString()+Math.random().toString().slice(2,5),q=Math.max(fr,...ft.map(Ae=>Ae.zIndex),100),ie=ft.length%10*30,we=T==="fft"?{x:50,y:50}:T==="histogram"?{x:100,y:100}:{x:150,y:150};wt(Ae=>[...Ae,{id:W,type:T,roi:{x:ve.x,y:ve.y,w:ve.width,h:ve.height},zIndex:q+1,initialPosition:{x:we.x+ie,y:we.y+ie},sessionId:$.id,isBGGR:ge,isMinimized:!1,stackFiles:(T==="fft"||T==="pearson"||T==="histogram")&&Y.length>0?Y:void 0}])},Hm=T=>{wt(W=>W.filter(q=>q.id!==T))},Vm=T=>{wt(W=>W.map(q=>q.id===T?{...q,isMinimized:!0}:q))},Xm=T=>{wt(W=>W.map(q=>q.id===T?{...q,isMinimized:!1}:q)),O0(T)},O0=T=>{wt(W=>{const q=Math.max(fr,...W.map(ie=>ie.zIndex));return W.map(ie=>ie.id===T?{...ie,zIndex:q+1}:ie)})},Km=(T,W)=>{wt(q=>q.map(ie=>ie.id===T?{...ie,internalState:{...ie.internalState,...W}}:ie))},Sl=()=>{const T=Math.max(fr,...ft.map(W=>W.zIndex));Wt(T+1)},md=(T,W)=>{wt(q=>q.map(ie=>ie.id===T?{...ie,roi:W}:ie))};_.useEffect(()=>{if(!re)return;const T=re.CFAPattern2||re.CFAPattern;if(T){let W="";Array.isArray(T)?W=T.join(""):typeof T=="string"?W=T.replace(/[\s,]+/g,""):typeof T=="number"&&(W=String(T)),W==="0112"?ue(!1):W==="2110"&&ue(!0)}},[re]),_.useEffect(()=>{Qe||(Jt(!1),Dt(null),ar("off"),_e(null),Ee(!1),qe(null))},[Qe]),_.useEffect(()=>{(!Qe||!(fe!=null&&fe.selectedGuideId))&&Dt(null)},[Qe,fe==null?void 0:fe.selectedGuideId]),_.useEffect(()=>{let T;const W=()=>{if(gt&&sa){const q=Date.now()/1e3,ie=.55+.45*Math.sin(q*ur);qr(ie),T=requestAnimationFrame(W)}else qr(1)};return gt&&sa?W():qr(1),()=>{T&&cancelAnimationFrame(T)}},[gt,sa,ur]),_.useEffect(()=>{const T=W=>{W.key==="Escape"&&sa&&(Da(!1),Ja({x:0,y:0}),zr(!1))};return window.addEventListener("keydown",T),()=>window.removeEventListener("keydown",T)},[sa]),_.useEffect(()=>()=>{I.forEach(T=>{T.previewUrl&&URL.revokeObjectURL(T.previewUrl)}),xo.current&&xo.current.terminate()},[]);const fi=async(T,W=!0)=>{W&&(vs({x:0,y:0}),xl(1),Ra(0),sn([]),yo([]),Gr(!1),Nr(null),Pe(!1),ae(!1),pt([]),Lr([]),Tt(0),Ar([]));let q=null;if(M.isConnected){const Nt=new FormData;Nt.append("file",T);try{const Ut=await(await fetch("http://localhost:5428/read",{method:"POST",body:Nt})).json();if(Ut.success){let or=Ut.data;Array.isArray(or)&&or.length===1&&(or=or[0]),q=or}}catch(Ue){console.warn("Auto Exif fetch failed",Ue)}}const ie=T.name.toLowerCase(),we=Z4.test(ie),Ae=/\.(jpe?g|png|tif|tiff)$/i.test(ie),Ve=["image/jpeg","image/png","image/tiff"].includes(T.type),Xe=T.type==="image/x-adobe-dng"||/\.dng$/i.test(ie);if(!(we||Xe||Ae||Ve)){Rt("Unsupported file type. Please load a JPG, PNG, or a supported RAW file.");return}let Ne={file:T,exifData:q,psDocument:null};if(we||Xe)try{W?It("Processing RAW file (this may take a moment)..."):Fn(!0);const Nt=await T.arrayBuffer();Ne.rawFileBuffer=Nt;const{previewBlob:Ue,analysisData:Ut}=await Oc(Nt);Ne.rawImageData=Ut,!q&&Ut.metadata&&(Ne.exifData=Ut.metadata),Ne.isThreePlane=Ut.isThreePlane||!1,Ut.isThreePlane&&W&&Pe(!0);let or=!1,xn=null,ln=!1;if(Ut.isXTrans){ln=!0,xn=Nt;const vn=(await lh(Nt,0,0)).dngBuffer,Zn=await Oc(vn);Ne.rawFileBuffer=vn,Ne.rawImageData=Zn.analysisData,Ne.previewUrl=URL.createObjectURL(Zn.previewBlob),or=!0}else Ne.previewUrl=URL.createObjectURL(Ue);Ne.originalRawFileBuffer=xn,Ne.isXTransOriginal=ln,Ne.isXTransConverted=or,Ne.xtransPhase={x:0,y:0};const wr=new Image;if(wr.src=Ne.previewUrl||"",await new Promise((Tr,vn)=>{wr.onload=()=>{Ne.imageElement=wr,Tr()},wr.onerror=()=>{Tr()}}),W){const Tr=Ne.rawImageData||Ut,vn=Loe(Tr,q||Tr.metadata);let Zn;vn&&vn.some(Ca=>Ca>0)&&(Zn=vn);const ca={exposure:0,demosaicMethod:-1,blackLevel:Zn,wbGains:[1,1],showKadc:!1,subtractBlackLevelFromStats:!1,renderMode:"zero-dependency"},Jn=Ne.rawFileBuffer;if(Jn&&(we||T.type==="image/x-adobe-dng"))try{const Ca=await Oy(Jn,ca);Ne.renderedRawImageData=Ca,Ne.displaySettings=ca}catch(Ca){console.error("Initial Zero-Dep Render Failed",Ca)}}}catch(Nt){Rt(`Failed to process RAW file: ${Nt.message}`),It(null),Fn(!1);return}else try{It("Processing image...");const{previewBlob:Nt,analysisData:Ue}=await k8(T);Ne.rawImageData=Ue,!q&&Ue.metadata&&(Ne.exifData=Ue.metadata),Ne.rawFileBuffer=await T.arrayBuffer(),Ne.isThreePlane=Ue.isThreePlane||!1,Ne.isXTransOriginal=!1,Ne.isXTransConverted=!1,Ne.originalRawFileBuffer=null;const Ut=URL.createObjectURL(Nt);Ne.previewUrl=Ut;const or=new Image;or.src=Ut,await new Promise(xn=>{or.onload=()=>{Ne.imageElement=or,xn()},or.onerror=()=>{Rt("Could not load the image file."),xn()}})}catch(Nt){Rt(`Failed to process image: ${Nt.message}`),It(null);return}const bt=Date.now().toString()+Math.random();if(Ne.rawFileBuffer&&await foe(bt,Ne.rawFileBuffer),W){const Nt={exposure:0,demosaicMethod:-1,blackLevel:void 0,wbGains:[1,1],showKadc:!1,subtractBlackLevelFromStats:!1,renderMode:"zero-dependency"},Ue={id:bt,fileName:T.name,file:T,imageElement:null,rawImageData:null,rawFileBuffer:null,renderedRawImageData:null,referenceImageData:null,sampledImageData:null,exifData:null,isThreePlane:!1,displaySettings:Nt,originalRawFileBuffer:null,isXTransOriginal:!1,isXTransConverted:!1,xtransPhase:{x:0,y:0},psDocument:null,...Ne};D(Ut=>{const or=[...Ut,Ue];return z(or.length-1),or})}else ui(Ne);It(null),Fn(!1)},yd=_.useCallback(async()=>{const T=Ph,W=Ph,q=new Uint16Array(T*W),ie=Math.max(2,Ln),we=Gt*ie;for(let ct=0;ct<W;ct++)for(let Ne=0;Ne<T;Ne++){const bt=.5+.5*Math.sin(2*Math.PI*(Ne+we)/ie);q[ct*T+Ne]=Math.round(1e3+bt*9e3)}const Ae=Fh(T,W,q,[0,0,0,0],16383,"RGGB"),Ve=new Blob([Ae],{type:"image/x-adobe-dng"}),Xe=new File([Ve],"pattern_test.dng",{type:"image/x-adobe-dng"});await fi(Xe,(V==null?void 0:V.name)!=="pattern_test.dng")},[Ln,Gt,qt,V]),A0=T=>{var q;const W=(q=T.target.files)==null?void 0:q[0];W&&fi(W,!0)},T0=async(T,W)=>{if(W==="convert"){It("Converting RAW via Bridge...");try{const q=new FormData;q.append("file",T);const ie=await fetch("http://localhost:5428/convert",{method:"POST",body:q});if(!ie.ok)throw new Error("Conversion failed on server");const we=await ie.blob(),Ae=new File([we],T.name.replace(/\.[^/.]+$/,"")+".dng",{type:"image/x-adobe-dng"});await fi(Ae,!0)}catch(q){Rt("DNG Conversion Failed: "+q.message)}finally{It(null)}}else fi(T,!0)},p=async(T,W,q,ie)=>{It("Processing Pair Difference...");try{const we=await T.arrayBuffer(),Ae=await W.arrayBuffer(),Ve=await Ny(we,Ae,q,ie),Xe=Fh(Ve.width,Ve.height,Ve.rawData,[32768,32768,32768,32768],65535,"RGGB"),ct=new Blob([Xe],{type:"image/x-adobe-dng"}),Ne=new File([ct],`Diff_${T.name}_${W.name}.dng`,{type:"image/x-adobe-dng"});await fi(Ne,!0)}catch(we){Rt("Pair Processing Failed: "+we.message)}finally{It(null)}},y=async T=>{const W=Array.from(T).sort((q,ie)=>q.name.localeCompare(ie.name,void 0,{numeric:!0}));if(W.length<2){Rt("Need at least 2 files for batch diff.");return}It("Batch Difference Processing...");try{for(let q=0;q<W.length-1;q+=2){const ie=W[q],we=W[q+1];It(`Processing pair ${q/2+1}: ${ie.name} - ${we.name}`);const Ae=await ie.arrayBuffer(),Ve=await we.arrayBuffer(),Xe=await Ny(Ae,Ve,!1,!0),ct=Fh(Xe.width,Xe.height,Xe.rawData,[32768,32768,32768,32768],65535,"RGGB"),Ne=new Blob([ct],{type:"image/x-adobe-dng"}),bt=URL.createObjectURL(Ne),Nt=document.createElement("a");Nt.href=bt,Nt.download=`Diff_${ie.name}_vs_${we.name}.dng`,document.body.appendChild(Nt),Nt.click(),document.body.removeChild(Nt),URL.revokeObjectURL(bt),await new Promise(Ue=>setTimeout(Ue,200))}}catch(q){Rt("Batch Diff Failed: "+q.message)}finally{It(null)}},C=T=>{G(Array.from(T)),It(`Loaded ${T.length} files for Stack FFT. Open Stack Lab to process.`),setTimeout(()=>It(null),2e3)},N=()=>{Ot(!0)},R=()=>{Ot(!1),la("sampled"),It("Generating..."),setTimeout(()=>yd(),50)},H=_.useRef({period:Ln,fill:qt,phase:Gt});_.useEffect(()=>{(V==null?void 0:V.name)==="pattern_test.dng"&&(H.current.period!==Ln||H.current.fill!==qt||H.current.phase!==Gt)&&(H.current={period:Ln,fill:qt,phase:Gt},yd())},[Ln,qt,Gt,V]);const ne=_.useCallback(async T=>{var ie;if(ui({displaySettings:T}),!L.current)return;const W=L.current.id;if(T.renderMode==="zero-dependency"||T.renderMode==="zero-dep-color"||T.renderMode==="advanced-zero-dep")if(u)try{Fn(!0);const we=((ie=L.current.rawImageData)==null?void 0:ie.whiteLevel)||16383,Ae=await Cs.render(W,T,we);if(Ae){ui({renderedRawImageData:Ae}),Fn(!1);return}else throw new Error("WebGPU returned null frame.")}catch(we){console.error("WebGPU Render failed:",we),Fn(!1);return}else{Rt("WebGPU not ready/supported. These modes require WebGPU.");return}if(!Q)return;Fn(!0),xo.current&&xo.current.terminate();const q=new Worker(new URL("/assets/renderWorker-B6LAImCA.js",import.meta.url),{type:"module"});xo.current=q,q.onmessage=we=>{const{success:Ae,imageData:Ve,error:Xe}=we.data;if(Ae){let ct=Ve;(V==null?void 0:V.name)==="pattern_test.dng"&&(ct=Boe(Ve,Ph,Ph)),ui({renderedRawImageData:ct})}else Rt(Xe||"Unknown worker error");Fn(!1),q.terminate(),xo.current=null},q.postMessage({buffer:Q.slice(0),settings:T})},[Q,V,ui,u]),se=async(T,W)=>{It("Re-sampling X-Trans with new Phase...");try{const ie=(await lh(W,T.x,T.y)).dngBuffer,we=await Oc(ie),Ae=URL.createObjectURL(we.previewBlob),Ve=new Image;Ve.src=Ae,await new Promise(Xe=>{Ve.onload=()=>Xe()}),$!=null&&$.previewUrl&&URL.revokeObjectURL($.previewUrl),ui({rawFileBuffer:ie,rawImageData:we.analysisData,previewUrl:Ae,imageElement:Ve,xtransPhase:T}),ye(null)}catch(q){console.error("X-Trans Phase Update Failed",q),Rt("Phase Update Failed: "+q.message)}finally{It(null)}},pe=T=>{if(!$||!$.originalRawFileBuffer||!$.isXTransConverted)return;const W={...$.xtransPhase,...T};se(W,$.originalRawFileBuffer)},Be=_.useCallback(async T=>{if($)if(T){if($.isXTransConverted)return;const W=$.originalRawFileBuffer||$.rawFileBuffer;if(!W)return;It("Converting X-Trans to Pseudo-Bayer DNG...");try{const q=$.xtransPhase||{x:0,y:0},we=(await lh(W,q.x,q.y)).dngBuffer,Ae=await Oc(we),Ve=URL.createObjectURL(Ae.previewBlob),Xe=new Image;Xe.src=Ve,await new Promise(ct=>{Xe.onload=()=>ct()}),$.previewUrl&&URL.revokeObjectURL($.previewUrl),ui({rawFileBuffer:we,rawImageData:Ae.analysisData,previewUrl:Ve,imageElement:Xe,isXTransConverted:!0,originalRawFileBuffer:W}),ye(null)}catch(q){console.error("X-Trans Conversion Failed",q),Rt("Failed to convert X-Trans: "+q.message)}finally{It(null)}}else{if(!$.isXTransConverted)return;const W=$.originalRawFileBuffer;if(!W){Rt("Original X-Trans buffer lost. Cannot revert.");return}It("Reverting to Native X-Trans...");try{const q=await Oc(W),ie=URL.createObjectURL(q.previewBlob),we=new Image;we.src=ie,await new Promise(Ae=>{we.onload=()=>Ae()}),$.previewUrl&&URL.revokeObjectURL($.previewUrl),ui({rawFileBuffer:W,rawImageData:q.analysisData,previewUrl:ie,imageElement:we,isXTransConverted:!1}),ye(null)}catch(q){console.error("X-Trans Revert Failed",q),Rt("Failed to revert X-Trans: "+q.message)}finally{It(null)}}},[$,ui]),it=T=>{if(Ho.current){const W=Ho.current,{width:q,height:ie}=W.getBoundingClientRect(),we=q/2,Ae=ie/2,Ve=T/Wi,Xe=we-(we-Wo.x)*Ve,ct=Ae-(Ae-Wo.y)*Ve;vs({x:Xe,y:ct})}xl(T)},mt=T=>{if(!T)return;if(!K){ye(null);return}if(cr){T.w>0&&T.h>0&&Ar(q=>[...q,T]);return}Le&&rt(!1);const W=Pl(K.data,K.width,K.height,T.x,T.y,T.w,T.h);ye(W)},ht=T=>{tt(T),mt(T)},Ye=()=>{vl(T=>T==="pan"?"select":"pan")},ir=(T,W,q)=>{Ar(ie=>{if(ie.length===0)return ie;if(T==="move")return ie.map(we=>({...we,x:we.x+W,y:we.y+q}));if(T==="scale"){const we=ie.reduce((Ve,Xe)=>Ve+Xe.x+Xe.w/2,0)/ie.length,Ae=ie.reduce((Ve,Xe)=>Ve+Xe.y+Xe.h/2,0)/ie.length;return ie.map(Ve=>{const Xe=Ve.x+Ve.w/2,ct=Ve.y+Ve.h/2,Ne=we+(Xe-we)*W,bt=Ae+(ct-Ae)*q,Nt=Ve.w*W,Ue=Ve.h*q;return{...Ve,x:Ne-Nt/2,y:bt-Ue/2,w:Nt,h:Ue}})}return ie})},$r=()=>{if(Yr.length===0){Rt("No ROIs to save.");return}let T=`Index,X,Y,W,H,Orientation
`;Yr.forEach((we,Ae)=>{T+=`${Ae+1},${we.x.toFixed(2)},${we.y.toFixed(2)},${we.w.toFixed(2)},${we.h.toFixed(2)},${we.ori||0}
`});const W=new Blob([T],{type:"text/csv;charset=utf-8;"}),q=URL.createObjectURL(W),ie=document.createElement("a");ie.setAttribute("href",q),ie.setAttribute("download",`sfr_plate_template_${Date.now()}.csv`),document.body.appendChild(ie),ie.click(),document.body.removeChild(ie),URL.revokeObjectURL(q)},yn=T=>{if(!T||T.length===0){Rt("No valid ROIs found in file.");return}Ar(W=>[...W,...T])},dn=T=>{if(Yr.length===0){Rt("ROIs ");return}if(!K||de.renderMode!=="advanced-zero-dep"){Rt("Advanced Zero-Dep (Unmixed) mode required for scalar SFR calc.");return}It("Computing Batch SFR..."),setTimeout(()=>{try{const W=[];for(const q of Yr){const ie=Jb(K,q,de),we=W1(ie.data,ie.width,ie.height,{x:0,y:0,w:ie.width,h:ie.height},{greenOnly:T.greenOnly,globalX:q.x,globalY:q.y,bayerPattern:K.bayerPattern});if(we){const Ae=T.useNR?-1:12,Ve=MO([we],Ae,null,T.useDeshading);Ve&&Ve.mtf50!==null&&W.push({x:q.x+q.w/2,y:q.y+q.h/2,mtf50:Ve.mtf50,orientation:we.orientation})}}if(W.length>0){const q=W.map(ie=>`{${ie.x.toFixed(1)},${ie.y.toFixed(1)},${ie.mtf50.toFixed(4)},${ie.orientation}}`).join("");navigator.clipboard.writeText(q).then(()=>alert(`Computed ${W.length}/${Yr.length} ROIs. Copied results to clipboard.`)).catch(ie=>Rt("Failed to copy results: "+ie))}else Rt("Failed to compute valid SFR for any selected ROIs.")}catch(W){Rt("Batch Compute Failed: "+W.message)}finally{It(null)}},100)},xa=T=>{if(Pa===0||Pa>4)return;const W=[...ji,T];sn(W),Pa===4?(ei(W),Ra(0)):Ra(Pa+1)},qn=(T,W,q,ie)=>{const we=T[0],Ae=T[1],Ve=T[2],Xe=T[3],ct=W/2,Ne=[];for(let bt=0;bt<q;bt++){const Nt=q>1?bt/(q-1):.5;for(let Ue=0;Ue<ie;Ue++){const Ut=ie>1?Ue/(ie-1):.5,or=we.x*(1-Ut)+Ae.x*Ut,xn=we.y*(1-Ut)+Ae.y*Ut,ln=Ve.x*(1-Ut)+Xe.x*Ut,wr=Ve.y*(1-Ut)+Xe.y*Ut,Tr=or*(1-Nt)+ln*Nt,vn=xn*(1-Nt)+wr*Nt,Zn=Tr-ct,ca=vn-ct;Ne.push({x:Zn,y:ca,w:W,h:W})}}return Ne},ei=T=>{!K||!$||(It("Calculating DR Lab Grid..."),setTimeout(()=>{try{const W=qn(T,zi,_a,Bn);yo(W);const Ae=[...[`#BlackLevel: ${(de.blackLevel||[0,0,0,0]).join(",")}`,`#ImageHeight: ${K.height}`],"Filename,Row,Col,R_Mean,G1_Mean,G2_Mean,B_Mean,R_Std,G1_Std,G2_Std,B_Std"],Ve=`img${$.fileName||"image"}`;W.forEach((Nt,Ue)=>{const Ut=Math.floor(Ue/Bn)+1,or=Ue%Bn+1,xn=Pl(K.data,K.width,K.height,Nt.x,Nt.y,Nt.w,Nt.h),ln=xn.means,wr=xn.stdDevs,Tr=`${Ve},${Ut},${or},${ln[0].toFixed(4)},${ln[1].toFixed(4)},${ln[2].toFixed(4)},${ln[3].toFixed(4)},${wr[0].toFixed(4)},${wr[1].toFixed(4)},${wr[2].toFixed(4)},${wr[3].toFixed(4)}`;Ae.push(Tr)});const Xe=Ae.join(`
`),ct=new Blob([Xe],{type:"text/csv;charset=utf-8;"}),Ne=URL.createObjectURL(ct),bt=document.createElement("a");bt.setAttribute("href",Ne),bt.setAttribute("download","dr_lab_results.csv"),document.body.appendChild(bt),bt.click(),document.body.removeChild(bt),URL.revokeObjectURL(Ne),sn([])}catch(W){Rt("DR Lab Error: "+W.message)}finally{It(null)}},100))},Ki=async(T,W)=>{if(ji.length<4&&mo.length<1){Rt("Please mark the grid on an image first before running batch processing.");return}let q=mo;if(q.length===0&&ji.length===4&&(q=qn(ji,zi,_a,Bn)),q.length===0){Rt("No grid definitions found. Mark corners first.");return}It(W==="pair"?"Batch Pair Difference (Sigma = Diff/sqrt(2))":"Batch Processing...");const we=(de.blackLevel||[0,0,0,0]).join(","),Ae=K?K.height:0,Xe=[...[`#BlackLevel: ${we}`,`#ImageHeight: ${Ae}`,W==="pair"?"#Mode: Pair Difference (Sigma = Diff/sqrt(2), Full Float Stats)":"#Mode: Independent"],"Filename,Row,Col,R_Mean,G1_Mean,G2_Mean,B_Mean,R_Std,G1_Std,G2_Std,B_Std"],ct=Array.from(T).sort((Ue,Ut)=>Ue.name.localeCompare(Ut.name,void 0,{numeric:!0}));if(W==="pair"&&ct.length<2){Rt("Need at least 2 files for Pair processing."),It(null);return}const Ne=L.current,bt=(Ne==null?void 0:Ne.isXTransConverted)||!1,Nt=(Ne==null?void 0:Ne.xtransPhase)||{x:0,y:0};try{const Ue=async wr=>{let Tr=await wr.arrayBuffer();return bt&&(Tr=(await lh(Tr,Nt.x,Nt.y)).dngBuffer),Tr};if(W==="single")for(let wr=0;wr<ct.length;wr++){const Tr=ct[wr];It(`Processing ${wr+1}/${ct.length}: ${Tr.name}...`);const vn=await Ue(Tr),Zn=await pu(vn),ca=`img${Tr.name}`;q.forEach((Jn,Ca)=>{const hi=Math.floor(Ca/_a)+1,hr=Ca%Bn+1,Gn=Pl(Zn.data,Zn.width,Zn.height,Jn.x,Jn.y,Jn.w,Jn.h),_i=Gn.means,wo=Gn.stdDevs,ko=`${ca},${hi},${hr},${_i[0].toFixed(4)},${_i[1].toFixed(4)},${_i[2].toFixed(4)},${_i[3].toFixed(4)},${wo[0].toFixed(4)},${wo[1].toFixed(4)},${wo[2].toFixed(4)},${wo[3].toFixed(4)}`;Xe.push(ko)})}else for(let wr=0;wr<ct.length-1;wr+=2){const Tr=ct[wr],vn=ct[wr+1],Zn=`img${Tr.name} & ${vn.name}`;It(`Processing Pair ${Math.floor(wr/2)+1}/${Math.floor(ct.length/2)}: ${Tr.name} & ${vn.name}...`);const ca=await Ue(Tr),Jn=await pu(ca),Ca=await Ue(vn),hi=await Ny(ca,Ca,!1,!1);q.forEach((hr,Gn)=>{const _i=Math.floor(Gn/_a)+1,wo=Gn%Bn+1,ko=Pl(Jn.data,Jn.width,Jn.height,hr.x,hr.y,hr.w,hr.h),D0=Pl(hi.rawData,hi.width,hi.height,hr.x,hr.y,hr.w,hr.h),jl=ko.means,_c=D0.stdDevs.map(Ma=>Ma/1.41421356),Cc=`${Zn},${_i},${wo},${jl[0].toFixed(4)},${jl[1].toFixed(4)},${jl[2].toFixed(4)},${jl[3].toFixed(4)},${_c[0].toFixed(4)},${_c[1].toFixed(4)},${_c[2].toFixed(4)},${_c[3].toFixed(4)}`;Xe.push(Cc)})}const Ut=Xe.join(`
`),or=new Blob([Ut],{type:"text/csv;charset=utf-8;"}),xn=URL.createObjectURL(or),ln=document.createElement("a");ln.href=xn,ln.setAttribute("download",`dr_lab_batch_${W}_${new Date().getTime()}.csv`),document.body.appendChild(ln),ln.click(),document.body.removeChild(ln),URL.revokeObjectURL(xn)}catch(Ue){console.error("Batch Error",Ue),Rt("Batch Processing Failed: "+Ue.message)}finally{It(null)}},Nn=()=>{pt([]),Tt(1)},E0=T=>{if(!ke||yt===0)return;const W=[...$e,T];pt(W),W.length===4&&K?(Pc(W,Ie),Tt(0)):Tt(q=>q+1)},Pc=(T,W)=>{K&&(It("Analyzing Color Chart..."),setTimeout(()=>{try{const q=Aie(T[0],T[1],T[2],T[3],K.width,K.height,W);Lr(q);const we=q.map((Ae,Ve)=>{const Xe=Pl(K.data,K.width,K.height,Ae.x,Ae.y,Ae.w,Ae.h);return{id:Ve,rawMeans:Xe.means,refRGB:[0,0,0]}}).map((Ae,Ve)=>({...Ae,refRGB:z1[Ve]||[0,0,0]}));Mt(we),gr(!0)}catch(q){Rt("Color Lab Error: "+q.message)}finally{It(null)}},100))},I0=T=>{Ct(T),$e.length===4&&Pc($e,T)},EO=()=>{gr(!1)},IO=()=>{re||Nr("No EXIF data found. The file might not contain metadata or it was stripped during processing."),Gr(!0)},$O=async T=>{It("Parsing PTC Data...");const W=[];let q=null;try{for(let ie=0;ie<T.length;ie++){const Ae=(await T[ie].text()).split(`
`);let Ve=!0;for(const Xe of Ae){const ct=Xe.trim();if(!ct)continue;if(ct.startsWith("#")){if(ct.includes("BlackLevel:")){const Jn=ct.split(":")[1].trim().split(",");if(Jn.length>=4){const Ca=Jn.map(Number);q||(q={}),q.blackLevel=Ca}}if(ct.includes("ImageHeight:")){const Jn=parseInt(ct.split(":")[1].trim());isNaN(Jn)||(q||(q={}),q.height=Jn)}continue}if(Ve){ct.toLowerCase().includes("mean")&&ct.toLowerCase().includes("std")&&(Ve=!1);continue}const Ne=ct.split(",");if(Ne.length<5)continue;let bt=0,Nt;isNaN(parseFloat(Ne[0]))&&(Nt=Ne[0],bt=1);const Ue=parseInt(Ne[bt]),Ut=parseInt(Ne[bt+1]),or=parseFloat(Ne[bt+2]),xn=parseFloat(Ne[bt+3]),ln=parseFloat(Ne[bt+4]),wr=parseFloat(Ne[bt+5]),Tr=parseFloat(Ne[bt+6]),vn=parseFloat(Ne[bt+7]),Zn=parseFloat(Ne[bt+8]),ca=parseFloat(Ne[bt+9]);!isNaN(or)&&!isNaN(Tr)&&W.push({channel:"R",mean:or,std:Tr,filename:Nt,row:Ue,col:Ut}),!isNaN(xn)&&!isNaN(vn)&&W.push({channel:"G1",mean:xn,std:vn,filename:Nt,row:Ue,col:Ut}),!isNaN(ln)&&!isNaN(Zn)&&W.push({channel:"G2",mean:ln,std:Zn,filename:Nt,row:Ue,col:Ut}),!isNaN(wr)&&!isNaN(ca)&&W.push({channel:"B",mean:wr,std:ca,filename:Nt,row:Ue,col:Ut})}}Qa(W),Go(q),h(!0)}catch(ie){console.error("PTC Parse Error",ie),Rt("Failed to parse CSV files: "+ie.message)}finally{It(null)}},DO=()=>{if(!Q||!$)return;const T=new Blob([Q],{type:"image/x-adobe-dng"}),W=URL.createObjectURL(T),q=document.createElement("a");q.href=W;const ie=$.fileName||"image.dng",we=ie.toLowerCase().endsWith(".dng")?ie:ie.replace(/\.[^/.]+$/,"")+".dng";q.download=we,document.body.appendChild(q),q.click(),document.body.removeChild(q),URL.revokeObjectURL(W)},RO=()=>{Ra(1),sn([]),yo([])},cw=()=>{window.open("https://github.com/y-g-jiang/y-g-jiang.github.io/blob/main/drtest.png","_blank")},BO=_.useMemo(()=>Et?Et.map((T,W)=>({...T,refRGB:z1[W]||[0,0,0]})):[],[Et]),LO=()=>{We(1),mn([]),Ar([])},FO=T=>{if(Br===0)return;const W=[...xr,T];if(mn(W),W.length===4){We(0);try{const q=Soe(W);Ar(q),dn({useNR:!0,useDeshading:!0,greenOnly:!1})}catch(q){console.error("Standard Chart Gen Error",q),Rt("Failed to generate chart ROIs.")}}else We(q=>q+1)},GO=_.useMemo(()=>{if(!Qe||!fe)return null;const T=fe.masks.find(W=>W.id===fe.selectedMaskId);return!T||!(T.overlayVisible??!0)?null:{alpha:T.alpha,width:T.width,height:T.height,version:T.version}},[Qe,fe]),UO=_.useMemo(()=>{if(!Qe||!fe||Vt!=="off")return null;const T=fe.masks.find(q=>q.id===fe.selectedMaskId);if(!T)return null;const W=(T.items||[]).find(q=>q.id===fe.selectedMaskItemId);return!W||W.type!=="ellipse"?null:{id:W.id,center:W.center,radiusX:W.radiusX,radiusY:W.radiusY,rotationDeg:W.rotationDeg}},[Qe,fe,Vt]);let $0=_t||te||J;Qe||(Hr==="reference"&&ee?$0=ee:Hr==="sampled"&&me&&($0=me));const uw=zo||La;return c.jsxs("div",{className:"flex flex-col h-screen bg-[#d4d4d4] dark:bg-[#111111] text-black dark:text-gray-200 font-mono transition-colors duration-300 overflow-hidden",children:[c.jsx("div",{className:"p-4 pb-0 flex-shrink-0",children:c.jsx(xT,{onLoadImage:A0,onFileSelected:T0,onGenerateFakeDng:N,fileName:V?V.name:null,hasGeneratedData:(V==null?void 0:V.name)==="pattern_test.dng",viewMode:Hr,onSetViewMode:la,patternPeriod:Ln,onPatternPeriodChange:at,fillFactor:qt,onFillFactorChange:dr,patternPhase:Gt,onPatternPhaseChange:Kn,showPatternControls:(V==null?void 0:V.name)==="pattern_test.dng",onOpenAbout:()=>br(!0),onShowExif:IO,bridgeStatus:M,onBridgeClick:()=>E(!0),isDrLabOpen:Te,onToggleDrLab:()=>{xe(!Te),Ra(0),sn([]),yo([]),ze&&Je(!1),ke&&ae(!1),ot&&Pt(!1),Qe&&_r(!1),Tt(0),Lr([]),Ar([]),Ft(!1),We(0)},isColorLabOpen:ke,onToggleColorLab:()=>{ae(!ke),pt([]),Tt(0),Lr([]),Te&&xe(!1),ze&&Je(!1),ot&&Pt(!1),Qe&&_r(!1),Ar([]),Ft(!1),We(0)},isFftLabOpen:ze,onToggleFftLab:()=>{Je(!ze),Te&&xe(!1),ke&&ae(!1),ot&&Pt(!1),Qe&&_r(!1),Tt(0),Lr([]),Ar([]),Ft(!1),We(0)},isSfrLabOpen:ot,onToggleSfrLab:()=>{Pt(!ot),Te&&xe(!1),ke&&ae(!1),ze&&Je(!1),Qe&&_r(!1),Tt(0),Lr([]),Ar([]),Ft(!1),We(0)},isPsModeOpen:Qe,onTogglePsMode:ud,onGenerateTestPic:cw,onPTCFilesSelected:$O,onDownloadDng:DO,isThreePlane:De,onOpenDatabase:()=>b(!0),isSidebarOpen:kt,onToggleSidebar:()=>Bt(!kt),stretchMultiplier:Me,onStretchMultiplierChange:X,onStretchDngExport:sd,isRawLoaded:!!K,onOpenSaveZ8:()=>S(!0)})}),c.jsxs("div",{className:"flex flex-1 overflow-hidden p-4 pt-2 gap-4 relative",children:[c.jsxs("div",{className:"flex-1 relative bg-gray-200 dark:bg-black border-4 border-gray-500 dark:border-gray-700 shadow-[inset_2px_2px_8px_rgba(0,0,0,0.2)] overflow-hidden transition-colors duration-300",ref:Ho,children:[uw&&c.jsxs("div",{className:"absolute bottom-4 right-4 z-50 flex items-center gap-2 bg-white/90 dark:bg-black/90 px-3 py-1.5 border-2 border-black dark:border-white shadow-[4px_4px_0px_black] dark:shadow-[4px_4px_0px_gray]",children:[c.jsx("div",{className:"w-4 h-4 border-2 border-black dark:border-white border-t-transparent animate-spin"}),c.jsx("span",{className:"text-xs font-bold text-black dark:text-white uppercase",children:zo||"Processing..."})]}),u&&c.jsx("div",{className:"absolute top-2 left-2 z-30 pointer-events-none opacity-50 hover:opacity-100 transition-opacity",children:c.jsx("span",{className:"text-[9px] font-bold text-cyan-500 bg-black/50 px-1 py-0.5 rounded border border-cyan-500/50",children:" WebGPU"})}),I.length>1&&c.jsxs("div",{className:"absolute bottom-4 left-1/2 -translate-x-1/2 z-50 flex items-center gap-4 bg-white/90 dark:bg-slate-900/90 px-4 py-2 rounded-full shadow-lg border border-gray-200 dark:border-slate-700",children:[c.jsx("button",{onClick:cd,disabled:B===0,className:"p-1 hover:bg-gray-200 dark:hover:bg-slate-700 rounded-full disabled:opacity-30",children:c.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})})}),c.jsxs("span",{className:"font-mono text-xs font-bold text-gray-700 dark:text-gray-300",children:[B+1," / ",I.length]}),c.jsx("button",{onClick:ld,disabled:B===I.length-1,className:"p-1 hover:bg-gray-200 dark:hover:bg-slate-700 rounded-full disabled:opacity-30",children:c.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})})]}),c.jsxs("div",{className:"absolute bottom-4 left-4 z-40 flex flex-col-reverse gap-2 items-start pointer-events-none",children:[Le&&ve&&c.jsxs("button",{onClick:()=>rt(!1),className:"pointer-events-auto bg-white dark:bg-slate-800 border-2 border-black dark:border-white shadow-[4px_4px_0px_rgba(0,0,0,0.5)] px-3 py-2 text-xs font-bold uppercase tracking-widest hover:translate-x-1 transition-transform flex items-center gap-2",children:[c.jsx("span",{className:"w-2 h-2 rounded-full bg-green-500 animate-pulse"}),"ROI Stats"]}),ft.filter(T=>T.isMinimized).map(T=>c.jsxs("button",{onClick:()=>Xm(T.id),className:"pointer-events-auto bg-white dark:bg-slate-800 border-2 border-black dark:border-white shadow-[4px_4px_0px_rgba(0,0,0,0.5)] px-3 py-2 text-xs font-bold uppercase tracking-widest hover:translate-x-1 transition-transform flex items-center gap-2",children:[c.jsx("span",{className:`w-2 h-2 rounded-full animate-pulse ${T.type==="histogram"?"bg-cyan-500":T.type==="fft"?"bg-purple-500":T.type==="quant"?"bg-teal-500":"bg-indigo-500"}`}),T.type==="histogram"?"Histogram":T.type==="fft"?"Power Spectrum":T.type==="quant"?"Quantization":"Pearson"]},T.id))]}),c.jsx(bie,{isOpen:pr,onClose:()=>br(!1)}),c.jsx(wie,{isOpen:Sr,onClose:()=>Gr(!1),data:re,fileName:V?V.name:"",warning:rr}),c.jsx(Sie,{isOpen:f,onClose:()=>h(!1),data:jn,blackLevel:ga,imageHeight:tn,isBGGR:ge,importedMetadata:go||void 0,theme:s,initialCameraModel:(re==null?void 0:re.Model)||"",initialISO:(re==null?void 0:re.ISO)||((dw=re==null?void 0:re.ISOSpeedRatings)==null?void 0:dw.toString())||""}),c.jsx(Mie,{isOpen:g,onClose:()=>b(!1),theme:s}),c.jsx(Nie,{isOpen:w,onClose:()=>v(!1),zIndex:200}),c.jsx($ie,{isOpen:Ir,onClose:EO,patchStats:BO,initialIsBGGR:ge,sizeRatio:Ie,onSizeChange:I0}),c.jsx(Gie,{isOpen:ot,isSfrLabOpen:ot,onClose:()=>{},rawImageData:K,roi:ve?{x:ve.x,y:ve.y,w:ve.width,h:ve.height}:null,zIndex:200,onFocus:Sl,displaySettings:de}),c.jsx(zie,{isOpen:x,onClose:()=>m(!1),rawImageData:K,fileName:(V==null?void 0:V.name)||"image.dng",zIndex:300,onFocus:Sl}),c.jsx(roe,{isOpen:k,onClose:()=>P(!1),zIndex:350,onFocus:Sl}),c.jsx(soe,{isOpen:j,onClose:()=>S(!1),zIndex:400,onFocus:Sl}),c.jsx(el,{isOpen:nt,onClose:()=>Ot(!1),onConfirm:R,title:"High Resource Usage Warning",confirmText:"I know the risk and insist to continue",message:c.jsxs("div",{className:"flex flex-col gap-2",children:[c.jsx("p",{children:"Patter DNG mode involves high-frequency refreshing and heavy computation. Due to current memory management limitations, repeated use may lead to browser memory overflow or crashes. Please proceed with caution."}),c.jsx("p",{className:"text-xs text-gray-500"})]})}),c.jsx(el,{isOpen:O,onClose:()=>E(!1),onConfirm:()=>{window.open("https://y-g-jiang.github.io/jiangbridge.exe","_blank"),E(!1)},title:"JiangBridge Connection / ",confirmText:"Download Bridge App",cancelText:"Cancel",message:c.jsxs("div",{className:"flex flex-col gap-4 text-left",children:[c.jsx("p",{className:"font-bold text-gray-800 dark:text-gray-200",children:"JiangBridge"}),c.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:'JiangBridge is optional for this webpage, but recommended for full functionality. Simply double-click and run it once after system startup. If the indicator light does not turn green after double-clicking, please consider checking whether the web page is allowed to "View and connect to any device on the network".'})]})}),c.jsx(el,{isOpen:jr,onClose:()=>Rr(!1),onConfirm:bl,title:"Export 16-bit TIFF Options",confirmText:"Confirm Export",message:c.jsxs("div",{className:"flex flex-col gap-4 text-left",children:[c.jsxs("div",{className:"grid grid-cols-2 gap-4 bg-gray-50 dark:bg-slate-800/80 p-4 border border-gray-400 dark:border-600",children:[c.jsxs("div",{className:"flex flex-col items-center gap-3",children:[c.jsxs("div",{className:"flex flex-col items-center text-center",children:[c.jsx("span",{className:"font-bold text-xs text-gray-800 dark:text-slate-200",children:"Stretch ()"}),c.jsx("span",{className:"text-[9px] text-gray-500 dark:text-slate-400 mt-0.5",children:"Map [0, White] to [0, 65535]"})]}),c.jsx("div",{onClick:()=>Kt(!Pr),className:`relative w-12 h-6 border-2 border-black dark:border-white cursor-pointer ${Pr?"bg-black dark:bg-white":"bg-gray-300 dark:bg-slate-600"}`,children:c.jsx("div",{className:`absolute top-0.5 left-0.5 w-4 h-4 bg-white dark:bg-black shadow-sm transition-transform ${Pr?"translate-x-6":""}`})})]}),c.jsxs("div",{className:"flex flex-col items-center gap-3",children:[c.jsxs("div",{className:"flex flex-col items-center text-center",children:[c.jsx("span",{className:"font-bold text-xs text-gray-800 dark:text-slate-200",children:"sRGB Gamma"}),c.jsx("span",{className:"text-[9px] text-gray-500 dark:text-slate-400 mt-0.5",children:"Apply non-linear contrast"})]}),c.jsx("div",{onClick:()=>jt(!Er),className:`relative w-12 h-6 border-2 border-black dark:border-white cursor-pointer ${Er?"bg-black dark:bg-white":"bg-gray-300 dark:bg-slate-600"}`,children:c.jsx("div",{className:`absolute top-0.5 left-0.5 w-4 h-4 bg-white dark:bg-black shadow-sm transition-transform ${Er?"translate-x-6":""}`})})]})]}),c.jsxs("div",{className:"p-3 bg-gray-200 dark:bg-slate-800 text-[11px] text-black dark:text-white italic border border-gray-400 dark:border-gray-600 text-center font-mono",children:[Pr&&!Er&&"Mode: Stretched Linear. Histogram preserved but range expanded.",!Pr&&Er&&"Mode: Native DN + sRGB. Best for analyzing raw distribution contrast.",Pr&&Er&&"Mode: Ready-to-Use. Conventional 16-bit development.",!Pr&&!Er&&"Mode: Native Linear. Pure physical sensor DN values."]})]})}),!Le&&c.jsx(Foe,{stats:ve,onClose:()=>{ye(null),tt(null)},onMinimize:()=>rt(!0),isBGGR:ge,onToggleBGGR:ue,onOpenWindow:Wm,displaySettings:de,zIndex:fr,onFocus:Sl,rawImageData:K}),ft.map(T=>{if(T.isMinimized)return null;const W=I.find(we=>we.id===T.sessionId),q=W==null?void 0:W.rawImageData;if(!q)return null;const ie={key:T.id,isOpen:!0,onClose:()=>Hm(T.id),onMinimize:()=>Vm(T.id),rawImageData:q,roi:T.roi,isBGGR:T.isBGGR,zIndex:T.zIndex,onFocus:()=>O0(T.id),initialPosition:T.initialPosition,initialInternalState:T.internalState,onUpdateState:we=>Km(T.id,we),stackFiles:T.stackFiles};return T.type==="histogram"?c.jsx(die,{...ie}):T.type==="fft"?c.jsx(gie,{...ie,onUpdateROI:we=>md(T.id,we)}):T.type==="quant"?c.jsx(mie,{...ie}):T.type==="pearson"?c.jsx(yie,{...ie}):null}),Uo&&c.jsx("div",{className:"absolute inset-0 z-50 flex items-center justify-center bg-white/90 dark:bg-black/90 p-8",children:c.jsxs("div",{className:"max-w-md text-center p-6 bg-white dark:bg-black rounded-none border-2 border-red-600 shadow-[8px_8px_0px_rgba(200,0,0,0.5)]",children:[c.jsx("h3",{className:"text-xl font-bold text-red-600 uppercase mb-2",children:"Notice"}),c.jsx("p",{className:"text-black dark:text-white mb-6 whitespace-pre-wrap font-mono",children:Uo}),c.jsx("button",{onClick:()=>Rt(null),className:"px-4 py-2 bg-gray-200 hover:bg-gray-300 dark:bg-gray-800 dark:hover:bg-gray-700 border-2 border-black dark:border-white text-black dark:text-white transition-colors uppercase font-bold",children:"Dismiss"})]})}),!$0&&!uw&&!Uo&&c.jsx("div",{className:"absolute inset-0 flex flex-col items-center justify-center text-gray-400 dark:text-gray-600 select-none font-mono",children:c.jsx("p",{className:"text-lg",children:"Load an image or generate a pattern"})}),c.jsx(vT,{image:$0,zoom:Wi,pan:Wo,onPanChange:vs,onZoomChange:it,onSelectionChange:mt,forcedSelection:et,theme:s,touchAction:kc,isMarking:Pa>0||ke&&yt>0||Br>0||Qe&&Vt!=="off",onPointClick:T=>{Pa>0?xa(T):ke&&yt>0?E0(T):Br>0&&FO(T)},markers:ji,gridRects:mo,colorLabPoints:$e,colorLabRects:Cr,sfrRects:Yr,psMaskOverlay:GO,psMaskDirtyRect:dt,psGuides:Qe&&fe?fe.guides:[],psSelectedGuideId:Qe&&fe?fe.selectedGuideId:null,psGuidePickTarget:Qe?ut:null,psEllipseTool:Qe?{mode:Vt,draft:St}:{mode:"off",draft:null},psEditableEllipse:UO,psBrush:{enabled:Qe&&sr,size:vt,opacity:A,mode:yr},onPsBrushPaint:zm,onPsGuidePickPoint:pd,onPsEllipseCenterPick:ya,onPsEllipseDrag:hd,onPsEditEllipse:ma}),Br>0&&xr.map((T,W)=>c.jsxs("div",{className:"absolute pointer-events-none z-30",style:{left:T.x*Wi+Wo.x,top:T.y*Wi+Wo.y,transform:"translate(-50%, -50%)"},children:[c.jsx("div",{className:"w-3 h-3 border-2 border-cyan-400 rounded-full flex items-center justify-center bg-transparent",children:c.jsx("div",{className:"w-1 h-1 bg-cyan-400 rounded-full"})}),c.jsx("div",{className:"text-[10px] font-bold text-cyan-400 absolute top-3 left-1/2 -translate-x-1/2 bg-black/50 px-1 rounded",children:W+1})]},W)),c.jsx("div",{className:"absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 w-1/2 z-30 pointer-events-none select-none opacity-20 mix-blend-normal dark:mix-blend-plus-lighter",children:c.jsx("svg",{viewBox:"0 0 500 60",className:"w-full h-auto drop-shadow-none",children:c.jsx("text",{x:"50%",y:"50%",dominantBaseline:"middle",textAnchor:"middle",className:"fill-black dark:fill-white",fontSize:"26",fontWeight:"bold",style:{fontFamily:"Courier New, monospace",letterSpacing:"0.05em"},children:" y-g-jiang.github.io"})})}),K&&!Pa&&!ke&&!cr&&!Br&&c.jsxs("div",{className:"absolute bottom-4 left-4 z-30 pointer-events-none opacity-60 text-[10px] text-black dark:text-white font-mono bg-white/50 dark:bg-black/50 px-1",children:["Hold ",c.jsx("b",{children:"Shift"})," + Drag to calculate Raw ROI stats"]}),cr&&c.jsx("div",{className:"absolute bottom-4 left-1/2 -translate-x-1/2 z-30 pointer-events-none text-sm font-bold text-red-500 bg-black/80 px-4 py-2 rounded-full border border-red-500 animate-pulse shadow-lg",children:"Manual Batch Marking Active (Shift+Drag to add)"}),Br>0&&c.jsxs("div",{className:"absolute bottom-4 left-1/2 -translate-x-1/2 z-30 pointer-events-none text-sm font-bold text-emerald-500 bg-black/80 px-4 py-2 rounded-full border border-emerald-500 animate-pulse shadow-lg",children:["Calibration: Click Corner ",Br,"/4"]}),ke&&yt>0&&c.jsxs("div",{className:"absolute top-4 left-1/2 -translate-x-1/2 z-30 pointer-events-none text-sm font-bold text-yellow-500 bg-black/80 px-4 py-2 rounded-full border border-yellow-500 animate-pulse shadow-lg",children:[$e.length===0&&"Click Top-Left Corner of Chart",$e.length===1&&"Click Top-Right Corner",$e.length===2&&"Click Bottom-Left Corner",$e.length===3&&"Click Bottom-Right Corner",$e.length===4&&"Processing..."]}),c.jsx(V8,{zoom:Wi,onZoomChange:it,onResetView:()=>{xl(1),vs({x:0,y:0})},touchAction:kc,onToggleTouchAction:Ye})]}),kt&&c.jsx("div",{className:"w-80 flex-shrink-0 bg-white dark:bg-black border-4 border-gray-500 dark:border-gray-700 shadow-[inset_2px_2px_8px_rgba(0,0,0,0.2)] overflow-hidden transition-all duration-300",children:c.jsx(B8,{rawImageData:K,displaySettings:de,onApplyDisplaySettings:ne,onSetSelection:ht,exifData:re,isBridgeConnected:M.isConnected,isDrLabOpen:Te,drMarkingStep:Pa,onStartMarking:RO,onGenerateTestPic:cw,drRoiSize:zi,onDrRoiSizeChange:Ba,drGridRows:_a,onDrGridRowsChange:Zr,drGridCols:Bn,onDrGridColsChange:yl,onBatchDrLab:Ki,hasDrMarkers:mo.length>0,isFftLabOpen:ze,onProcessPair:p,onProcessBatchDiff:y,onProcessStackFft:C,onOpenCrossCalc:()=>v(!0),isThreePlane:De,onToggleXTrans:Be,xtransPhase:le,onXTransPhaseChange:pe,isXTransConverted:$==null?void 0:$.isXTransConverted,roiStats:ve,isBGGR:ge,isColorLabOpen:ke,colorLabMarkingStep:yt,onStartColorLabMarking:Nn,isSfrLabOpen:ot,onOpenDngExport:()=>m(!0),sfrRectCount:Yr.length,isBatchMarkingMode:cr,onToggleBatchMarking:()=>Ft(!cr),onClearBatchMarks:()=>Ar([]),onBatchCompute:dn,stdChartStep:Br,onStartStandardCalibration:LO,onSaveBatchTemplate:$r,onImportBatchTemplate:yn,onBatchTransform:ir,onOpenStackingTool:()=>P(!0),isPsModeOpen:Qe,psDocument:fe,canCreatePsEllipse:!!fe,psBrushEnabled:sr,psBrushSize:vt,psBrushOpacity:A,psBrushFeather:Ke,psEllipseFeather:Ht,psBrushMode:yr,onPsAddMask:Pi,onPsAddEllipseMask:vo,onPsCancelEllipseTool:Vi,onPsFlipHorizontal:$m,onPsFlipVertical:Dm,onPsCropToRoi:Em,onPsRotateCanvas:Im,onPsApplyUpright:Rm,onPsSelectLayer:Pn,onPsSelectMask:Yn,onPsBindLayerMask:C0,onPsSetLayerBlendMode:M0,onPsSetLayerOpacity:jc,onPsSetLayerBasic:N0,onPsSetLayerMixer:Gm,onPsSetLayerCurves:Um,onPsSelectMaskItem:Jr,onPsUpdateEllipseItem:ma,onPsSetMaskOverlayVisible:di,onPsAddGuide:Bm,onPsSelectGuide:Lm,onPsSetGuideEndpoints:Fm,psGuidePickTarget:ut,onPsStartGuidePointPick:_0,onPsCancelGuidePointPick:bo,onPsDeleteGuide:Xi,onPsUndo:dd,onPsJumpHistoryIndex:fd,onPsExportWorkflowCsv:Qt,onPsImportWorkflowCsv:nn,onPsExportPng:Z,onPsExportJpeg:Oe,onPsBrushEnabledChange:Jt,onPsBrushSizeChange:nr,onPsBrushOpacityChange:Ge,onPsBrushFeatherChange:Yt,onPsEllipseFeatherChange:At,onPsBrushModeChange:Xr})}),c.jsx(X8,{theme:s,setTheme:l})]})]})},TO=document.getElementById("root");if(!TO)throw new Error("Could not find root element to mount to");const Uoe=fx.createRoot(TO);Uoe.render(c.jsx(oe.StrictMode,{children:c.jsx(Goe,{})}));
