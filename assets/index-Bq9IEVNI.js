var i6=Object.defineProperty;var o6=(e,t,r)=>t in e?i6(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r;var Ht=(e,t,r)=>o6(e,typeof t!="symbol"?t+"":t,r);(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))n(a);new MutationObserver(a=>{for(const i of a)if(i.type==="childList")for(const o of i.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&n(o)}).observe(document,{childList:!0,subtree:!0});function r(a){const i={};return a.integrity&&(i.integrity=a.integrity),a.referrerPolicy&&(i.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?i.credentials="include":a.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function n(a){if(a.ep)return;a.ep=!0;const i=r(a);fetch(a.href,i)}})();var K0=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function dn(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var p_={exports:{}},Tg={},g_={exports:{}},Pr={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var O0=Symbol.for("react.element"),s6=Symbol.for("react.portal"),l6=Symbol.for("react.fragment"),c6=Symbol.for("react.strict_mode"),u6=Symbol.for("react.profiler"),d6=Symbol.for("react.provider"),f6=Symbol.for("react.context"),h6=Symbol.for("react.forward_ref"),p6=Symbol.for("react.suspense"),g6=Symbol.for("react.memo"),m6=Symbol.for("react.lazy"),kw=Symbol.iterator;function y6(e){return e===null||typeof e!="object"?null:(e=kw&&e[kw]||e["@@iterator"],typeof e=="function"?e:null)}var m_={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},y_=Object.assign,x_={};function ed(e,t,r){this.props=e,this.context=t,this.refs=x_,this.updater=r||m_}ed.prototype.isReactComponent={};ed.prototype.setState=function(e,t){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")};ed.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function v_(){}v_.prototype=ed.prototype;function J1(e,t,r){this.props=e,this.context=t,this.refs=x_,this.updater=r||m_}var Q1=J1.prototype=new v_;Q1.constructor=J1;y_(Q1,ed.prototype);Q1.isPureReactComponent=!0;var Sw=Array.isArray,b_=Object.prototype.hasOwnProperty,eb={current:null},w_={key:!0,ref:!0,__self:!0,__source:!0};function k_(e,t,r){var n,a={},i=null,o=null;if(t!=null)for(n in t.ref!==void 0&&(o=t.ref),t.key!==void 0&&(i=""+t.key),t)b_.call(t,n)&&!w_.hasOwnProperty(n)&&(a[n]=t[n]);var s=arguments.length-2;if(s===1)a.children=r;else if(1<s){for(var l=Array(s),u=0;u<s;u++)l[u]=arguments[u+2];a.children=l}if(e&&e.defaultProps)for(n in s=e.defaultProps,s)a[n]===void 0&&(a[n]=s[n]);return{$$typeof:O0,type:e,key:i,ref:o,props:a,_owner:eb.current}}function x6(e,t){return{$$typeof:O0,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}function tb(e){return typeof e=="object"&&e!==null&&e.$$typeof===O0}function v6(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(r){return t[r]})}var _w=/\/+/g;function Jm(e,t){return typeof e=="object"&&e!==null&&e.key!=null?v6(""+e.key):t.toString(36)}function $h(e,t,r,n,a){var i=typeof e;(i==="undefined"||i==="boolean")&&(e=null);var o=!1;if(e===null)o=!0;else switch(i){case"string":case"number":o=!0;break;case"object":switch(e.$$typeof){case O0:case s6:o=!0}}if(o)return o=e,a=a(o),e=n===""?"."+Jm(o,0):n,Sw(a)?(r="",e!=null&&(r=e.replace(_w,"$&/")+"/"),$h(a,t,r,"",function(u){return u})):a!=null&&(tb(a)&&(a=x6(a,r+(!a.key||o&&o.key===a.key?"":(""+a.key).replace(_w,"$&/")+"/")+e)),t.push(a)),1;if(o=0,n=n===""?".":n+":",Sw(e))for(var s=0;s<e.length;s++){i=e[s];var l=n+Jm(i,s);o+=$h(i,t,r,l,a)}else if(l=y6(e),typeof l=="function")for(e=l.call(e),s=0;!(i=e.next()).done;)i=i.value,l=n+Jm(i,s++),o+=$h(i,t,r,l,a);else if(i==="object")throw t=String(e),Error("Objects are not valid as a React child (found: "+(t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return o}function Y0(e,t,r){if(e==null)return e;var n=[],a=0;return $h(e,n,"","",function(i){return t.call(r,i,a++)}),n}function b6(e){if(e._status===-1){var t=e._result;t=t(),t.then(function(r){(e._status===0||e._status===-1)&&(e._status=1,e._result=r)},function(r){(e._status===0||e._status===-1)&&(e._status=2,e._result=r)}),e._status===-1&&(e._status=0,e._result=t)}if(e._status===1)return e._result.default;throw e._result}var Za={current:null},Lh={transition:null},w6={ReactCurrentDispatcher:Za,ReactCurrentBatchConfig:Lh,ReactCurrentOwner:eb};function S_(){throw Error("act(...) is not supported in production builds of React.")}Pr.Children={map:Y0,forEach:function(e,t,r){Y0(e,function(){t.apply(this,arguments)},r)},count:function(e){var t=0;return Y0(e,function(){t++}),t},toArray:function(e){return Y0(e,function(t){return t})||[]},only:function(e){if(!tb(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};Pr.Component=ed;Pr.Fragment=l6;Pr.Profiler=u6;Pr.PureComponent=J1;Pr.StrictMode=c6;Pr.Suspense=p6;Pr.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=w6;Pr.act=S_;Pr.cloneElement=function(e,t,r){if(e==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var n=y_({},e.props),a=e.key,i=e.ref,o=e._owner;if(t!=null){if(t.ref!==void 0&&(i=t.ref,o=eb.current),t.key!==void 0&&(a=""+t.key),e.type&&e.type.defaultProps)var s=e.type.defaultProps;for(l in t)b_.call(t,l)&&!w_.hasOwnProperty(l)&&(n[l]=t[l]===void 0&&s!==void 0?s[l]:t[l])}var l=arguments.length-2;if(l===1)n.children=r;else if(1<l){s=Array(l);for(var u=0;u<l;u++)s[u]=arguments[u+2];n.children=s}return{$$typeof:O0,type:e.type,key:a,ref:i,props:n,_owner:o}};Pr.createContext=function(e){return e={$$typeof:f6,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},e.Provider={$$typeof:d6,_context:e},e.Consumer=e};Pr.createElement=k_;Pr.createFactory=function(e){var t=k_.bind(null,e);return t.type=e,t};Pr.createRef=function(){return{current:null}};Pr.forwardRef=function(e){return{$$typeof:h6,render:e}};Pr.isValidElement=tb;Pr.lazy=function(e){return{$$typeof:m6,_payload:{_status:-1,_result:e},_init:b6}};Pr.memo=function(e,t){return{$$typeof:g6,type:e,compare:t===void 0?null:t}};Pr.startTransition=function(e){var t=Lh.transition;Lh.transition={};try{e()}finally{Lh.transition=t}};Pr.unstable_act=S_;Pr.useCallback=function(e,t){return Za.current.useCallback(e,t)};Pr.useContext=function(e){return Za.current.useContext(e)};Pr.useDebugValue=function(){};Pr.useDeferredValue=function(e){return Za.current.useDeferredValue(e)};Pr.useEffect=function(e,t){return Za.current.useEffect(e,t)};Pr.useId=function(){return Za.current.useId()};Pr.useImperativeHandle=function(e,t,r){return Za.current.useImperativeHandle(e,t,r)};Pr.useInsertionEffect=function(e,t){return Za.current.useInsertionEffect(e,t)};Pr.useLayoutEffect=function(e,t){return Za.current.useLayoutEffect(e,t)};Pr.useMemo=function(e,t){return Za.current.useMemo(e,t)};Pr.useReducer=function(e,t,r){return Za.current.useReducer(e,t,r)};Pr.useRef=function(e){return Za.current.useRef(e)};Pr.useState=function(e){return Za.current.useState(e)};Pr.useSyncExternalStore=function(e,t,r){return Za.current.useSyncExternalStore(e,t,r)};Pr.useTransition=function(){return Za.current.useTransition()};Pr.version="18.3.1";g_.exports=Pr;var P=g_.exports;const oe=dn(P);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var k6=P,S6=Symbol.for("react.element"),_6=Symbol.for("react.fragment"),j6=Object.prototype.hasOwnProperty,P6=k6.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,C6={key:!0,ref:!0,__self:!0,__source:!0};function __(e,t,r){var n,a={},i=null,o=null;r!==void 0&&(i=""+r),t.key!==void 0&&(i=""+t.key),t.ref!==void 0&&(o=t.ref);for(n in t)j6.call(t,n)&&!C6.hasOwnProperty(n)&&(a[n]=t[n]);if(e&&e.defaultProps)for(n in t=e.defaultProps,t)a[n]===void 0&&(a[n]=t[n]);return{$$typeof:S6,type:e,key:i,ref:o,props:a,_owner:P6.current}}Tg.Fragment=_6;Tg.jsx=__;Tg.jsxs=__;p_.exports=Tg;var c=p_.exports,vx={},j_={exports:{}},Mi={},P_={exports:{}},C_={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(e){function t(U,X){var V=U.length;U.push(X);e:for(;0<V;){var z=V-1>>>1,q=U[z];if(0<a(q,X))U[z]=X,U[V]=q,V=z;else break e}}function r(U){return U.length===0?null:U[0]}function n(U){if(U.length===0)return null;var X=U[0],V=U.pop();if(V!==X){U[0]=V;e:for(var z=0,q=U.length,te=q>>>1;z<te;){var ie=2*(z+1)-1,he=U[ie],ee=ie+1,Le=U[ee];if(0>a(he,V))ee<q&&0>a(Le,he)?(U[z]=Le,U[ee]=V,z=ee):(U[z]=he,U[ie]=V,z=ie);else if(ee<q&&0>a(Le,V))U[z]=Le,U[ee]=V,z=ee;else break e}}return X}function a(U,X){var V=U.sortIndex-X.sortIndex;return V!==0?V:U.id-X.id}if(typeof performance=="object"&&typeof performance.now=="function"){var i=performance;e.unstable_now=function(){return i.now()}}else{var o=Date,s=o.now();e.unstable_now=function(){return o.now()-s}}var l=[],u=[],d=1,f=null,h=3,g=!1,v=!1,w=!1,b=typeof setTimeout=="function"?setTimeout:null,x=typeof clearTimeout=="function"?clearTimeout:null,y=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function _(U){for(var X=r(u);X!==null;){if(X.callback===null)n(u);else if(X.startTime<=U)n(u),X.sortIndex=X.expirationTime,t(l,X);else break;X=r(u)}}function j(U){if(w=!1,_(U),!v)if(r(l)!==null)v=!0,I(S);else{var X=r(u);X!==null&&G(j,X.startTime-U)}}function S(U,X){v=!1,w&&(w=!1,x(N),N=-1),g=!0;var V=h;try{for(_(X),f=r(l);f!==null&&(!(f.expirationTime>X)||U&&!D());){var z=f.callback;if(typeof z=="function"){f.callback=null,h=f.priorityLevel;var q=z(f.expirationTime<=X);X=e.unstable_now(),typeof q=="function"?f.callback=q:f===r(l)&&n(l),_(X)}else n(l);f=r(l)}if(f!==null)var te=!0;else{var ie=r(u);ie!==null&&G(j,ie.startTime-X),te=!1}return te}finally{f=null,h=V,g=!1}}var k=!1,M=null,N=-1,T=5,A=-1;function D(){return!(e.unstable_now()-A<T)}function $(){if(M!==null){var U=e.unstable_now();A=U;var X=!0;try{X=M(!0,U)}finally{X?B():(k=!1,M=null)}}else k=!1}var B;if(typeof y=="function")B=function(){y($)};else if(typeof MessageChannel<"u"){var J=new MessageChannel,W=J.port2;J.port1.onmessage=$,B=function(){W.postMessage(null)}}else B=function(){b($,0)};function I(U){M=U,k||(k=!0,B())}function G(U,X){N=b(function(){U(e.unstable_now())},X)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(U){U.callback=null},e.unstable_continueExecution=function(){v||g||(v=!0,I(S))},e.unstable_forceFrameRate=function(U){0>U||125<U?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):T=0<U?Math.floor(1e3/U):5},e.unstable_getCurrentPriorityLevel=function(){return h},e.unstable_getFirstCallbackNode=function(){return r(l)},e.unstable_next=function(U){switch(h){case 1:case 2:case 3:var X=3;break;default:X=h}var V=h;h=X;try{return U()}finally{h=V}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(U,X){switch(U){case 1:case 2:case 3:case 4:case 5:break;default:U=3}var V=h;h=U;try{return X()}finally{h=V}},e.unstable_scheduleCallback=function(U,X,V){var z=e.unstable_now();switch(typeof V=="object"&&V!==null?(V=V.delay,V=typeof V=="number"&&0<V?z+V:z):V=z,U){case 1:var q=-1;break;case 2:q=250;break;case 5:q=1073741823;break;case 4:q=1e4;break;default:q=5e3}return q=V+q,U={id:d++,callback:X,priorityLevel:U,startTime:V,expirationTime:q,sortIndex:-1},V>z?(U.sortIndex=V,t(u,U),r(l)===null&&U===r(u)&&(w?(x(N),N=-1):w=!0,G(j,V-z))):(U.sortIndex=q,t(l,U),v||g||(v=!0,I(S))),U},e.unstable_shouldYield=D,e.unstable_wrapCallback=function(U){var X=h;return function(){var V=h;h=X;try{return U.apply(this,arguments)}finally{h=V}}}})(C_);P_.exports=C_;var M6=P_.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var N6=P,Ci=M6;function Fe(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,r=1;r<arguments.length;r++)t+="&args[]="+encodeURIComponent(arguments[r]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var M_=new Set,Nf={};function vc(e,t){mu(e,t),mu(e+"Capture",t)}function mu(e,t){for(Nf[e]=t,e=0;e<t.length;e++)M_.add(t[e])}var cs=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),bx=Object.prototype.hasOwnProperty,O6=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,jw={},Pw={};function A6(e){return bx.call(Pw,e)?!0:bx.call(jw,e)?!1:O6.test(e)?Pw[e]=!0:(jw[e]=!0,!1)}function E6(e,t,r,n){if(r!==null&&r.type===0)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return n?!1:r!==null?!r.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function T6(e,t,r,n){if(t===null||typeof t>"u"||E6(e,t,r,n))return!0;if(n)return!1;if(r!==null)switch(r.type){case 3:return!t;case 4:return t===!1;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}function Ja(e,t,r,n,a,i,o){this.acceptsBooleans=t===2||t===3||t===4,this.attributeName=n,this.attributeNamespace=a,this.mustUseProperty=r,this.propertyName=e,this.type=t,this.sanitizeURL=i,this.removeEmptyString=o}var Pa={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){Pa[e]=new Ja(e,0,!1,e,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];Pa[t]=new Ja(t,1,!1,e[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(e){Pa[e]=new Ja(e,2,!1,e.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){Pa[e]=new Ja(e,2,!1,e,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){Pa[e]=new Ja(e,3,!1,e.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(e){Pa[e]=new Ja(e,3,!0,e,null,!1,!1)});["capture","download"].forEach(function(e){Pa[e]=new Ja(e,4,!1,e,null,!1,!1)});["cols","rows","size","span"].forEach(function(e){Pa[e]=new Ja(e,6,!1,e,null,!1,!1)});["rowSpan","start"].forEach(function(e){Pa[e]=new Ja(e,5,!1,e.toLowerCase(),null,!1,!1)});var rb=/[\-:]([a-z])/g;function nb(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(rb,nb);Pa[t]=new Ja(t,1,!1,e,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(rb,nb);Pa[t]=new Ja(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(rb,nb);Pa[t]=new Ja(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(e){Pa[e]=new Ja(e,1,!1,e.toLowerCase(),null,!1,!1)});Pa.xlinkHref=new Ja("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(e){Pa[e]=new Ja(e,1,!1,e.toLowerCase(),null,!0,!0)});function ab(e,t,r,n){var a=Pa.hasOwnProperty(t)?Pa[t]:null;(a!==null?a.type!==0:n||!(2<t.length)||t[0]!=="o"&&t[0]!=="O"||t[1]!=="n"&&t[1]!=="N")&&(T6(t,r,a,n)&&(r=null),n||a===null?A6(t)&&(r===null?e.removeAttribute(t):e.setAttribute(t,""+r)):a.mustUseProperty?e[a.propertyName]=r===null?a.type===3?!1:"":r:(t=a.attributeName,n=a.attributeNamespace,r===null?e.removeAttribute(t):(a=a.type,r=a===3||a===4&&r===!0?"":""+r,n?e.setAttributeNS(n,t,r):e.setAttribute(t,r))))}var ms=N6.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,q0=Symbol.for("react.element"),Wc=Symbol.for("react.portal"),Vc=Symbol.for("react.fragment"),ib=Symbol.for("react.strict_mode"),wx=Symbol.for("react.profiler"),N_=Symbol.for("react.provider"),O_=Symbol.for("react.context"),ob=Symbol.for("react.forward_ref"),kx=Symbol.for("react.suspense"),Sx=Symbol.for("react.suspense_list"),sb=Symbol.for("react.memo"),Bs=Symbol.for("react.lazy"),A_=Symbol.for("react.offscreen"),Cw=Symbol.iterator;function Ld(e){return e===null||typeof e!="object"?null:(e=Cw&&e[Cw]||e["@@iterator"],typeof e=="function"?e:null)}var En=Object.assign,Qm;function of(e){if(Qm===void 0)try{throw Error()}catch(r){var t=r.stack.trim().match(/\n( *(at )?)/);Qm=t&&t[1]||""}return`
`+Qm+e}var ey=!1;function ty(e,t){if(!e||ey)return"";ey=!0;var r=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(t,[])}catch(u){var n=u}Reflect.construct(e,[],t)}else{try{t.call()}catch(u){n=u}e.call(t.prototype)}else{try{throw Error()}catch(u){n=u}e()}}catch(u){if(u&&n&&typeof u.stack=="string"){for(var a=u.stack.split(`
`),i=n.stack.split(`
`),o=a.length-1,s=i.length-1;1<=o&&0<=s&&a[o]!==i[s];)s--;for(;1<=o&&0<=s;o--,s--)if(a[o]!==i[s]){if(o!==1||s!==1)do if(o--,s--,0>s||a[o]!==i[s]){var l=`
`+a[o].replace(" at new "," at ");return e.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",e.displayName)),l}while(1<=o&&0<=s);break}}}finally{ey=!1,Error.prepareStackTrace=r}return(e=e?e.displayName||e.name:"")?of(e):""}function I6(e){switch(e.tag){case 5:return of(e.type);case 16:return of("Lazy");case 13:return of("Suspense");case 19:return of("SuspenseList");case 0:case 2:case 15:return e=ty(e.type,!1),e;case 11:return e=ty(e.type.render,!1),e;case 1:return e=ty(e.type,!0),e;default:return""}}function _x(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case Vc:return"Fragment";case Wc:return"Portal";case wx:return"Profiler";case ib:return"StrictMode";case kx:return"Suspense";case Sx:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case O_:return(e.displayName||"Context")+".Consumer";case N_:return(e._context.displayName||"Context")+".Provider";case ob:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case sb:return t=e.displayName||null,t!==null?t:_x(e.type)||"Memo";case Bs:t=e._payload,e=e._init;try{return _x(e(t))}catch{}}return null}function R6(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=t.render,e=e.displayName||e.name||"",t.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return _x(t);case 8:return t===ib?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t}return null}function pl(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function E_(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function D6(e){var t=E_(e)?"checked":"value",r=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),n=""+e[t];if(!e.hasOwnProperty(t)&&typeof r<"u"&&typeof r.get=="function"&&typeof r.set=="function"){var a=r.get,i=r.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return a.call(this)},set:function(o){n=""+o,i.call(this,o)}}),Object.defineProperty(e,t,{enumerable:r.enumerable}),{getValue:function(){return n},setValue:function(o){n=""+o},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function Z0(e){e._valueTracker||(e._valueTracker=D6(e))}function T_(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var r=t.getValue(),n="";return e&&(n=E_(e)?e.checked?"true":"false":e.value),e=n,e!==r?(t.setValue(e),!0):!1}function Qh(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function jx(e,t){var r=t.checked;return En({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:r??e._wrapperState.initialChecked})}function Mw(e,t){var r=t.defaultValue==null?"":t.defaultValue,n=t.checked!=null?t.checked:t.defaultChecked;r=pl(t.value!=null?t.value:r),e._wrapperState={initialChecked:n,initialValue:r,controlled:t.type==="checkbox"||t.type==="radio"?t.checked!=null:t.value!=null}}function I_(e,t){t=t.checked,t!=null&&ab(e,"checked",t,!1)}function Px(e,t){I_(e,t);var r=pl(t.value),n=t.type;if(r!=null)n==="number"?(r===0&&e.value===""||e.value!=r)&&(e.value=""+r):e.value!==""+r&&(e.value=""+r);else if(n==="submit"||n==="reset"){e.removeAttribute("value");return}t.hasOwnProperty("value")?Cx(e,t.type,r):t.hasOwnProperty("defaultValue")&&Cx(e,t.type,pl(t.defaultValue)),t.checked==null&&t.defaultChecked!=null&&(e.defaultChecked=!!t.defaultChecked)}function Nw(e,t,r){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var n=t.type;if(!(n!=="submit"&&n!=="reset"||t.value!==void 0&&t.value!==null))return;t=""+e._wrapperState.initialValue,r||t===e.value||(e.value=t),e.defaultValue=t}r=e.name,r!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,r!==""&&(e.name=r)}function Cx(e,t,r){(t!=="number"||Qh(e.ownerDocument)!==e)&&(r==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+r&&(e.defaultValue=""+r))}var sf=Array.isArray;function iu(e,t,r,n){if(e=e.options,t){t={};for(var a=0;a<r.length;a++)t["$"+r[a]]=!0;for(r=0;r<e.length;r++)a=t.hasOwnProperty("$"+e[r].value),e[r].selected!==a&&(e[r].selected=a),a&&n&&(e[r].defaultSelected=!0)}else{for(r=""+pl(r),t=null,a=0;a<e.length;a++){if(e[a].value===r){e[a].selected=!0,n&&(e[a].defaultSelected=!0);return}t!==null||e[a].disabled||(t=e[a])}t!==null&&(t.selected=!0)}}function Mx(e,t){if(t.dangerouslySetInnerHTML!=null)throw Error(Fe(91));return En({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function Ow(e,t){var r=t.value;if(r==null){if(r=t.children,t=t.defaultValue,r!=null){if(t!=null)throw Error(Fe(92));if(sf(r)){if(1<r.length)throw Error(Fe(93));r=r[0]}t=r}t==null&&(t=""),r=t}e._wrapperState={initialValue:pl(r)}}function R_(e,t){var r=pl(t.value),n=pl(t.defaultValue);r!=null&&(r=""+r,r!==e.value&&(e.value=r),t.defaultValue==null&&e.defaultValue!==r&&(e.defaultValue=r)),n!=null&&(e.defaultValue=""+n)}function Aw(e){var t=e.textContent;t===e._wrapperState.initialValue&&t!==""&&t!==null&&(e.value=t)}function D_(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Nx(e,t){return e==null||e==="http://www.w3.org/1999/xhtml"?D_(t):e==="http://www.w3.org/2000/svg"&&t==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var J0,$_=function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(t,r,n,a){MSApp.execUnsafeLocalFunction(function(){return e(t,r,n,a)})}:e}(function(e,t){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=t;else{for(J0=J0||document.createElement("div"),J0.innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=J0.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}});function Of(e,t){if(t){var r=e.firstChild;if(r&&r===e.lastChild&&r.nodeType===3){r.nodeValue=t;return}}e.textContent=t}var df={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},$6=["Webkit","ms","Moz","O"];Object.keys(df).forEach(function(e){$6.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),df[t]=df[e]})});function L_(e,t,r){return t==null||typeof t=="boolean"||t===""?"":r||typeof t!="number"||t===0||df.hasOwnProperty(e)&&df[e]?(""+t).trim():t+"px"}function B_(e,t){e=e.style;for(var r in t)if(t.hasOwnProperty(r)){var n=r.indexOf("--")===0,a=L_(r,t[r],n);r==="float"&&(r="cssFloat"),n?e.setProperty(r,a):e[r]=a}}var L6=En({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Ox(e,t){if(t){if(L6[e]&&(t.children!=null||t.dangerouslySetInnerHTML!=null))throw Error(Fe(137,e));if(t.dangerouslySetInnerHTML!=null){if(t.children!=null)throw Error(Fe(60));if(typeof t.dangerouslySetInnerHTML!="object"||!("__html"in t.dangerouslySetInnerHTML))throw Error(Fe(61))}if(t.style!=null&&typeof t.style!="object")throw Error(Fe(62))}}function Ax(e,t){if(e.indexOf("-")===-1)return typeof t.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Ex=null;function lb(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var Tx=null,ou=null,su=null;function Ew(e){if(e=T0(e)){if(typeof Tx!="function")throw Error(Fe(280));var t=e.stateNode;t&&(t=Lg(t),Tx(e.stateNode,e.type,t))}}function F_(e){ou?su?su.push(e):su=[e]:ou=e}function U_(){if(ou){var e=ou,t=su;if(su=ou=null,Ew(e),t)for(e=0;e<t.length;e++)Ew(t[e])}}function G_(e,t){return e(t)}function z_(){}var ry=!1;function W_(e,t,r){if(ry)return e(t,r);ry=!0;try{return G_(e,t,r)}finally{ry=!1,(ou!==null||su!==null)&&(z_(),U_())}}function Af(e,t){var r=e.stateNode;if(r===null)return null;var n=Lg(r);if(n===null)return null;r=n[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(n=!n.disabled)||(e=e.type,n=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!n;break e;default:e=!1}if(e)return null;if(r&&typeof r!="function")throw Error(Fe(231,t,typeof r));return r}var Ix=!1;if(cs)try{var Bd={};Object.defineProperty(Bd,"passive",{get:function(){Ix=!0}}),window.addEventListener("test",Bd,Bd),window.removeEventListener("test",Bd,Bd)}catch{Ix=!1}function B6(e,t,r,n,a,i,o,s,l){var u=Array.prototype.slice.call(arguments,3);try{t.apply(r,u)}catch(d){this.onError(d)}}var ff=!1,ep=null,tp=!1,Rx=null,F6={onError:function(e){ff=!0,ep=e}};function U6(e,t,r,n,a,i,o,s,l){ff=!1,ep=null,B6.apply(F6,arguments)}function G6(e,t,r,n,a,i,o,s,l){if(U6.apply(this,arguments),ff){if(ff){var u=ep;ff=!1,ep=null}else throw Error(Fe(198));tp||(tp=!0,Rx=u)}}function bc(e){var t=e,r=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,t.flags&4098&&(r=t.return),e=t.return;while(e)}return t.tag===3?r:null}function V_(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function Tw(e){if(bc(e)!==e)throw Error(Fe(188))}function z6(e){var t=e.alternate;if(!t){if(t=bc(e),t===null)throw Error(Fe(188));return t!==e?null:e}for(var r=e,n=t;;){var a=r.return;if(a===null)break;var i=a.alternate;if(i===null){if(n=a.return,n!==null){r=n;continue}break}if(a.child===i.child){for(i=a.child;i;){if(i===r)return Tw(a),e;if(i===n)return Tw(a),t;i=i.sibling}throw Error(Fe(188))}if(r.return!==n.return)r=a,n=i;else{for(var o=!1,s=a.child;s;){if(s===r){o=!0,r=a,n=i;break}if(s===n){o=!0,n=a,r=i;break}s=s.sibling}if(!o){for(s=i.child;s;){if(s===r){o=!0,r=i,n=a;break}if(s===n){o=!0,n=i,r=a;break}s=s.sibling}if(!o)throw Error(Fe(189))}}if(r.alternate!==n)throw Error(Fe(190))}if(r.tag!==3)throw Error(Fe(188));return r.stateNode.current===r?e:t}function H_(e){return e=z6(e),e!==null?X_(e):null}function X_(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var t=X_(e);if(t!==null)return t;e=e.sibling}return null}var K_=Ci.unstable_scheduleCallback,Iw=Ci.unstable_cancelCallback,W6=Ci.unstable_shouldYield,V6=Ci.unstable_requestPaint,Fn=Ci.unstable_now,H6=Ci.unstable_getCurrentPriorityLevel,cb=Ci.unstable_ImmediatePriority,Y_=Ci.unstable_UserBlockingPriority,rp=Ci.unstable_NormalPriority,X6=Ci.unstable_LowPriority,q_=Ci.unstable_IdlePriority,Ig=null,To=null;function K6(e){if(To&&typeof To.onCommitFiberRoot=="function")try{To.onCommitFiberRoot(Ig,e,void 0,(e.current.flags&128)===128)}catch{}}var yo=Math.clz32?Math.clz32:Z6,Y6=Math.log,q6=Math.LN2;function Z6(e){return e>>>=0,e===0?32:31-(Y6(e)/q6|0)|0}var Q0=64,eh=4194304;function lf(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function np(e,t){var r=e.pendingLanes;if(r===0)return 0;var n=0,a=e.suspendedLanes,i=e.pingedLanes,o=r&268435455;if(o!==0){var s=o&~a;s!==0?n=lf(s):(i&=o,i!==0&&(n=lf(i)))}else o=r&~a,o!==0?n=lf(o):i!==0&&(n=lf(i));if(n===0)return 0;if(t!==0&&t!==n&&!(t&a)&&(a=n&-n,i=t&-t,a>=i||a===16&&(i&4194240)!==0))return t;if(n&4&&(n|=r&16),t=e.entangledLanes,t!==0)for(e=e.entanglements,t&=n;0<t;)r=31-yo(t),a=1<<r,n|=e[r],t&=~a;return n}function J6(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Q6(e,t){for(var r=e.suspendedLanes,n=e.pingedLanes,a=e.expirationTimes,i=e.pendingLanes;0<i;){var o=31-yo(i),s=1<<o,l=a[o];l===-1?(!(s&r)||s&n)&&(a[o]=J6(s,t)):l<=t&&(e.expiredLanes|=s),i&=~s}}function Dx(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function Z_(){var e=Q0;return Q0<<=1,!(Q0&4194240)&&(Q0=64),e}function ny(e){for(var t=[],r=0;31>r;r++)t.push(e);return t}function A0(e,t,r){e.pendingLanes|=t,t!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,t=31-yo(t),e[t]=r}function eA(e,t){var r=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var n=e.eventTimes;for(e=e.expirationTimes;0<r;){var a=31-yo(r),i=1<<a;t[a]=0,n[a]=-1,e[a]=-1,r&=~i}}function ub(e,t){var r=e.entangledLanes|=t;for(e=e.entanglements;r;){var n=31-yo(r),a=1<<n;a&t|e[n]&t&&(e[n]|=t),r&=~a}}var rn=0;function J_(e){return e&=-e,1<e?4<e?e&268435455?16:536870912:4:1}var Q_,db,ej,tj,rj,$x=!1,th=[],nl=null,al=null,il=null,Ef=new Map,Tf=new Map,zs=[],tA="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Rw(e,t){switch(e){case"focusin":case"focusout":nl=null;break;case"dragenter":case"dragleave":al=null;break;case"mouseover":case"mouseout":il=null;break;case"pointerover":case"pointerout":Ef.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":Tf.delete(t.pointerId)}}function Fd(e,t,r,n,a,i){return e===null||e.nativeEvent!==i?(e={blockedOn:t,domEventName:r,eventSystemFlags:n,nativeEvent:i,targetContainers:[a]},t!==null&&(t=T0(t),t!==null&&db(t)),e):(e.eventSystemFlags|=n,t=e.targetContainers,a!==null&&t.indexOf(a)===-1&&t.push(a),e)}function rA(e,t,r,n,a){switch(t){case"focusin":return nl=Fd(nl,e,t,r,n,a),!0;case"dragenter":return al=Fd(al,e,t,r,n,a),!0;case"mouseover":return il=Fd(il,e,t,r,n,a),!0;case"pointerover":var i=a.pointerId;return Ef.set(i,Fd(Ef.get(i)||null,e,t,r,n,a)),!0;case"gotpointercapture":return i=a.pointerId,Tf.set(i,Fd(Tf.get(i)||null,e,t,r,n,a)),!0}return!1}function nj(e){var t=$l(e.target);if(t!==null){var r=bc(t);if(r!==null){if(t=r.tag,t===13){if(t=V_(r),t!==null){e.blockedOn=t,rj(e.priority,function(){ej(r)});return}}else if(t===3&&r.stateNode.current.memoizedState.isDehydrated){e.blockedOn=r.tag===3?r.stateNode.containerInfo:null;return}}}e.blockedOn=null}function Bh(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var r=Lx(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(r===null){r=e.nativeEvent;var n=new r.constructor(r.type,r);Ex=n,r.target.dispatchEvent(n),Ex=null}else return t=T0(r),t!==null&&db(t),e.blockedOn=r,!1;t.shift()}return!0}function Dw(e,t,r){Bh(e)&&r.delete(t)}function nA(){$x=!1,nl!==null&&Bh(nl)&&(nl=null),al!==null&&Bh(al)&&(al=null),il!==null&&Bh(il)&&(il=null),Ef.forEach(Dw),Tf.forEach(Dw)}function Ud(e,t){e.blockedOn===t&&(e.blockedOn=null,$x||($x=!0,Ci.unstable_scheduleCallback(Ci.unstable_NormalPriority,nA)))}function If(e){function t(a){return Ud(a,e)}if(0<th.length){Ud(th[0],e);for(var r=1;r<th.length;r++){var n=th[r];n.blockedOn===e&&(n.blockedOn=null)}}for(nl!==null&&Ud(nl,e),al!==null&&Ud(al,e),il!==null&&Ud(il,e),Ef.forEach(t),Tf.forEach(t),r=0;r<zs.length;r++)n=zs[r],n.blockedOn===e&&(n.blockedOn=null);for(;0<zs.length&&(r=zs[0],r.blockedOn===null);)nj(r),r.blockedOn===null&&zs.shift()}var lu=ms.ReactCurrentBatchConfig,ap=!0;function aA(e,t,r,n){var a=rn,i=lu.transition;lu.transition=null;try{rn=1,fb(e,t,r,n)}finally{rn=a,lu.transition=i}}function iA(e,t,r,n){var a=rn,i=lu.transition;lu.transition=null;try{rn=4,fb(e,t,r,n)}finally{rn=a,lu.transition=i}}function fb(e,t,r,n){if(ap){var a=Lx(e,t,r,n);if(a===null)hy(e,t,n,ip,r),Rw(e,n);else if(rA(a,e,t,r,n))n.stopPropagation();else if(Rw(e,n),t&4&&-1<tA.indexOf(e)){for(;a!==null;){var i=T0(a);if(i!==null&&Q_(i),i=Lx(e,t,r,n),i===null&&hy(e,t,n,ip,r),i===a)break;a=i}a!==null&&n.stopPropagation()}else hy(e,t,n,null,r)}}var ip=null;function Lx(e,t,r,n){if(ip=null,e=lb(n),e=$l(e),e!==null)if(t=bc(e),t===null)e=null;else if(r=t.tag,r===13){if(e=V_(t),e!==null)return e;e=null}else if(r===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return ip=e,null}function aj(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(H6()){case cb:return 1;case Y_:return 4;case rp:case X6:return 16;case q_:return 536870912;default:return 16}default:return 16}}var Hs=null,hb=null,Fh=null;function ij(){if(Fh)return Fh;var e,t=hb,r=t.length,n,a="value"in Hs?Hs.value:Hs.textContent,i=a.length;for(e=0;e<r&&t[e]===a[e];e++);var o=r-e;for(n=1;n<=o&&t[r-n]===a[i-n];n++);return Fh=a.slice(e,1<n?1-n:void 0)}function Uh(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function rh(){return!0}function $w(){return!1}function Ni(e){function t(r,n,a,i,o){this._reactName=r,this._targetInst=a,this.type=n,this.nativeEvent=i,this.target=o,this.currentTarget=null;for(var s in e)e.hasOwnProperty(s)&&(r=e[s],this[s]=r?r(i):i[s]);return this.isDefaultPrevented=(i.defaultPrevented!=null?i.defaultPrevented:i.returnValue===!1)?rh:$w,this.isPropagationStopped=$w,this}return En(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var r=this.nativeEvent;r&&(r.preventDefault?r.preventDefault():typeof r.returnValue!="unknown"&&(r.returnValue=!1),this.isDefaultPrevented=rh)},stopPropagation:function(){var r=this.nativeEvent;r&&(r.stopPropagation?r.stopPropagation():typeof r.cancelBubble!="unknown"&&(r.cancelBubble=!0),this.isPropagationStopped=rh)},persist:function(){},isPersistent:rh}),t}var td={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},pb=Ni(td),E0=En({},td,{view:0,detail:0}),oA=Ni(E0),ay,iy,Gd,Rg=En({},E0,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:gb,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==Gd&&(Gd&&e.type==="mousemove"?(ay=e.screenX-Gd.screenX,iy=e.screenY-Gd.screenY):iy=ay=0,Gd=e),ay)},movementY:function(e){return"movementY"in e?e.movementY:iy}}),Lw=Ni(Rg),sA=En({},Rg,{dataTransfer:0}),lA=Ni(sA),cA=En({},E0,{relatedTarget:0}),oy=Ni(cA),uA=En({},td,{animationName:0,elapsedTime:0,pseudoElement:0}),dA=Ni(uA),fA=En({},td,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),hA=Ni(fA),pA=En({},td,{data:0}),Bw=Ni(pA),gA={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},mA={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},yA={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function xA(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=yA[e])?!!t[e]:!1}function gb(){return xA}var vA=En({},E0,{key:function(e){if(e.key){var t=gA[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=Uh(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?mA[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:gb,charCode:function(e){return e.type==="keypress"?Uh(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?Uh(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),bA=Ni(vA),wA=En({},Rg,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Fw=Ni(wA),kA=En({},E0,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:gb}),SA=Ni(kA),_A=En({},td,{propertyName:0,elapsedTime:0,pseudoElement:0}),jA=Ni(_A),PA=En({},Rg,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),CA=Ni(PA),MA=[9,13,27,32],mb=cs&&"CompositionEvent"in window,hf=null;cs&&"documentMode"in document&&(hf=document.documentMode);var NA=cs&&"TextEvent"in window&&!hf,oj=cs&&(!mb||hf&&8<hf&&11>=hf),Uw=" ",Gw=!1;function sj(e,t){switch(e){case"keyup":return MA.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function lj(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var Hc=!1;function OA(e,t){switch(e){case"compositionend":return lj(t);case"keypress":return t.which!==32?null:(Gw=!0,Uw);case"textInput":return e=t.data,e===Uw&&Gw?null:e;default:return null}}function AA(e,t){if(Hc)return e==="compositionend"||!mb&&sj(e,t)?(e=ij(),Fh=hb=Hs=null,Hc=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return oj&&t.locale!=="ko"?null:t.data;default:return null}}var EA={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function zw(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!EA[e.type]:t==="textarea"}function cj(e,t,r,n){F_(n),t=op(t,"onChange"),0<t.length&&(r=new pb("onChange","change",null,r,n),e.push({event:r,listeners:t}))}var pf=null,Rf=null;function TA(e){bj(e,0)}function Dg(e){var t=Yc(e);if(T_(t))return e}function IA(e,t){if(e==="change")return t}var uj=!1;if(cs){var sy;if(cs){var ly="oninput"in document;if(!ly){var Ww=document.createElement("div");Ww.setAttribute("oninput","return;"),ly=typeof Ww.oninput=="function"}sy=ly}else sy=!1;uj=sy&&(!document.documentMode||9<document.documentMode)}function Vw(){pf&&(pf.detachEvent("onpropertychange",dj),Rf=pf=null)}function dj(e){if(e.propertyName==="value"&&Dg(Rf)){var t=[];cj(t,Rf,e,lb(e)),W_(TA,t)}}function RA(e,t,r){e==="focusin"?(Vw(),pf=t,Rf=r,pf.attachEvent("onpropertychange",dj)):e==="focusout"&&Vw()}function DA(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return Dg(Rf)}function $A(e,t){if(e==="click")return Dg(t)}function LA(e,t){if(e==="input"||e==="change")return Dg(t)}function BA(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var vo=typeof Object.is=="function"?Object.is:BA;function Df(e,t){if(vo(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var r=Object.keys(e),n=Object.keys(t);if(r.length!==n.length)return!1;for(n=0;n<r.length;n++){var a=r[n];if(!bx.call(t,a)||!vo(e[a],t[a]))return!1}return!0}function Hw(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function Xw(e,t){var r=Hw(e);e=0;for(var n;r;){if(r.nodeType===3){if(n=e+r.textContent.length,e<=t&&n>=t)return{node:r,offset:t-e};e=n}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=Hw(r)}}function fj(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?fj(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function hj(){for(var e=window,t=Qh();t instanceof e.HTMLIFrameElement;){try{var r=typeof t.contentWindow.location.href=="string"}catch{r=!1}if(r)e=t.contentWindow;else break;t=Qh(e.document)}return t}function yb(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}function FA(e){var t=hj(),r=e.focusedElem,n=e.selectionRange;if(t!==r&&r&&r.ownerDocument&&fj(r.ownerDocument.documentElement,r)){if(n!==null&&yb(r)){if(t=n.start,e=n.end,e===void 0&&(e=t),"selectionStart"in r)r.selectionStart=t,r.selectionEnd=Math.min(e,r.value.length);else if(e=(t=r.ownerDocument||document)&&t.defaultView||window,e.getSelection){e=e.getSelection();var a=r.textContent.length,i=Math.min(n.start,a);n=n.end===void 0?i:Math.min(n.end,a),!e.extend&&i>n&&(a=n,n=i,i=a),a=Xw(r,i);var o=Xw(r,n);a&&o&&(e.rangeCount!==1||e.anchorNode!==a.node||e.anchorOffset!==a.offset||e.focusNode!==o.node||e.focusOffset!==o.offset)&&(t=t.createRange(),t.setStart(a.node,a.offset),e.removeAllRanges(),i>n?(e.addRange(t),e.extend(o.node,o.offset)):(t.setEnd(o.node,o.offset),e.addRange(t)))}}for(t=[],e=r;e=e.parentNode;)e.nodeType===1&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof r.focus=="function"&&r.focus(),r=0;r<t.length;r++)e=t[r],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var UA=cs&&"documentMode"in document&&11>=document.documentMode,Xc=null,Bx=null,gf=null,Fx=!1;function Kw(e,t,r){var n=r.window===r?r.document:r.nodeType===9?r:r.ownerDocument;Fx||Xc==null||Xc!==Qh(n)||(n=Xc,"selectionStart"in n&&yb(n)?n={start:n.selectionStart,end:n.selectionEnd}:(n=(n.ownerDocument&&n.ownerDocument.defaultView||window).getSelection(),n={anchorNode:n.anchorNode,anchorOffset:n.anchorOffset,focusNode:n.focusNode,focusOffset:n.focusOffset}),gf&&Df(gf,n)||(gf=n,n=op(Bx,"onSelect"),0<n.length&&(t=new pb("onSelect","select",null,t,r),e.push({event:t,listeners:n}),t.target=Xc)))}function nh(e,t){var r={};return r[e.toLowerCase()]=t.toLowerCase(),r["Webkit"+e]="webkit"+t,r["Moz"+e]="moz"+t,r}var Kc={animationend:nh("Animation","AnimationEnd"),animationiteration:nh("Animation","AnimationIteration"),animationstart:nh("Animation","AnimationStart"),transitionend:nh("Transition","TransitionEnd")},cy={},pj={};cs&&(pj=document.createElement("div").style,"AnimationEvent"in window||(delete Kc.animationend.animation,delete Kc.animationiteration.animation,delete Kc.animationstart.animation),"TransitionEvent"in window||delete Kc.transitionend.transition);function $g(e){if(cy[e])return cy[e];if(!Kc[e])return e;var t=Kc[e],r;for(r in t)if(t.hasOwnProperty(r)&&r in pj)return cy[e]=t[r];return e}var gj=$g("animationend"),mj=$g("animationiteration"),yj=$g("animationstart"),xj=$g("transitionend"),vj=new Map,Yw="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function ml(e,t){vj.set(e,t),vc(t,[e])}for(var uy=0;uy<Yw.length;uy++){var dy=Yw[uy],GA=dy.toLowerCase(),zA=dy[0].toUpperCase()+dy.slice(1);ml(GA,"on"+zA)}ml(gj,"onAnimationEnd");ml(mj,"onAnimationIteration");ml(yj,"onAnimationStart");ml("dblclick","onDoubleClick");ml("focusin","onFocus");ml("focusout","onBlur");ml(xj,"onTransitionEnd");mu("onMouseEnter",["mouseout","mouseover"]);mu("onMouseLeave",["mouseout","mouseover"]);mu("onPointerEnter",["pointerout","pointerover"]);mu("onPointerLeave",["pointerout","pointerover"]);vc("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));vc("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));vc("onBeforeInput",["compositionend","keypress","textInput","paste"]);vc("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));vc("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));vc("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var cf="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),WA=new Set("cancel close invalid load scroll toggle".split(" ").concat(cf));function qw(e,t,r){var n=e.type||"unknown-event";e.currentTarget=r,G6(n,t,void 0,e),e.currentTarget=null}function bj(e,t){t=(t&4)!==0;for(var r=0;r<e.length;r++){var n=e[r],a=n.event;n=n.listeners;e:{var i=void 0;if(t)for(var o=n.length-1;0<=o;o--){var s=n[o],l=s.instance,u=s.currentTarget;if(s=s.listener,l!==i&&a.isPropagationStopped())break e;qw(a,s,u),i=l}else for(o=0;o<n.length;o++){if(s=n[o],l=s.instance,u=s.currentTarget,s=s.listener,l!==i&&a.isPropagationStopped())break e;qw(a,s,u),i=l}}}if(tp)throw e=Rx,tp=!1,Rx=null,e}function vn(e,t){var r=t[Vx];r===void 0&&(r=t[Vx]=new Set);var n=e+"__bubble";r.has(n)||(wj(t,e,2,!1),r.add(n))}function fy(e,t,r){var n=0;t&&(n|=4),wj(r,e,n,t)}var ah="_reactListening"+Math.random().toString(36).slice(2);function $f(e){if(!e[ah]){e[ah]=!0,M_.forEach(function(r){r!=="selectionchange"&&(WA.has(r)||fy(r,!1,e),fy(r,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[ah]||(t[ah]=!0,fy("selectionchange",!1,t))}}function wj(e,t,r,n){switch(aj(t)){case 1:var a=aA;break;case 4:a=iA;break;default:a=fb}r=a.bind(null,t,r,e),a=void 0,!Ix||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(a=!0),n?a!==void 0?e.addEventListener(t,r,{capture:!0,passive:a}):e.addEventListener(t,r,!0):a!==void 0?e.addEventListener(t,r,{passive:a}):e.addEventListener(t,r,!1)}function hy(e,t,r,n,a){var i=n;if(!(t&1)&&!(t&2)&&n!==null)e:for(;;){if(n===null)return;var o=n.tag;if(o===3||o===4){var s=n.stateNode.containerInfo;if(s===a||s.nodeType===8&&s.parentNode===a)break;if(o===4)for(o=n.return;o!==null;){var l=o.tag;if((l===3||l===4)&&(l=o.stateNode.containerInfo,l===a||l.nodeType===8&&l.parentNode===a))return;o=o.return}for(;s!==null;){if(o=$l(s),o===null)return;if(l=o.tag,l===5||l===6){n=i=o;continue e}s=s.parentNode}}n=n.return}W_(function(){var u=i,d=lb(r),f=[];e:{var h=vj.get(e);if(h!==void 0){var g=pb,v=e;switch(e){case"keypress":if(Uh(r)===0)break e;case"keydown":case"keyup":g=bA;break;case"focusin":v="focus",g=oy;break;case"focusout":v="blur",g=oy;break;case"beforeblur":case"afterblur":g=oy;break;case"click":if(r.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":g=Lw;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":g=lA;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":g=SA;break;case gj:case mj:case yj:g=dA;break;case xj:g=jA;break;case"scroll":g=oA;break;case"wheel":g=CA;break;case"copy":case"cut":case"paste":g=hA;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":g=Fw}var w=(t&4)!==0,b=!w&&e==="scroll",x=w?h!==null?h+"Capture":null:h;w=[];for(var y=u,_;y!==null;){_=y;var j=_.stateNode;if(_.tag===5&&j!==null&&(_=j,x!==null&&(j=Af(y,x),j!=null&&w.push(Lf(y,j,_)))),b)break;y=y.return}0<w.length&&(h=new g(h,v,null,r,d),f.push({event:h,listeners:w}))}}if(!(t&7)){e:{if(h=e==="mouseover"||e==="pointerover",g=e==="mouseout"||e==="pointerout",h&&r!==Ex&&(v=r.relatedTarget||r.fromElement)&&($l(v)||v[us]))break e;if((g||h)&&(h=d.window===d?d:(h=d.ownerDocument)?h.defaultView||h.parentWindow:window,g?(v=r.relatedTarget||r.toElement,g=u,v=v?$l(v):null,v!==null&&(b=bc(v),v!==b||v.tag!==5&&v.tag!==6)&&(v=null)):(g=null,v=u),g!==v)){if(w=Lw,j="onMouseLeave",x="onMouseEnter",y="mouse",(e==="pointerout"||e==="pointerover")&&(w=Fw,j="onPointerLeave",x="onPointerEnter",y="pointer"),b=g==null?h:Yc(g),_=v==null?h:Yc(v),h=new w(j,y+"leave",g,r,d),h.target=b,h.relatedTarget=_,j=null,$l(d)===u&&(w=new w(x,y+"enter",v,r,d),w.target=_,w.relatedTarget=b,j=w),b=j,g&&v)t:{for(w=g,x=v,y=0,_=w;_;_=$c(_))y++;for(_=0,j=x;j;j=$c(j))_++;for(;0<y-_;)w=$c(w),y--;for(;0<_-y;)x=$c(x),_--;for(;y--;){if(w===x||x!==null&&w===x.alternate)break t;w=$c(w),x=$c(x)}w=null}else w=null;g!==null&&Zw(f,h,g,w,!1),v!==null&&b!==null&&Zw(f,b,v,w,!0)}}e:{if(h=u?Yc(u):window,g=h.nodeName&&h.nodeName.toLowerCase(),g==="select"||g==="input"&&h.type==="file")var S=IA;else if(zw(h))if(uj)S=LA;else{S=DA;var k=RA}else(g=h.nodeName)&&g.toLowerCase()==="input"&&(h.type==="checkbox"||h.type==="radio")&&(S=$A);if(S&&(S=S(e,u))){cj(f,S,r,d);break e}k&&k(e,h,u),e==="focusout"&&(k=h._wrapperState)&&k.controlled&&h.type==="number"&&Cx(h,"number",h.value)}switch(k=u?Yc(u):window,e){case"focusin":(zw(k)||k.contentEditable==="true")&&(Xc=k,Bx=u,gf=null);break;case"focusout":gf=Bx=Xc=null;break;case"mousedown":Fx=!0;break;case"contextmenu":case"mouseup":case"dragend":Fx=!1,Kw(f,r,d);break;case"selectionchange":if(UA)break;case"keydown":case"keyup":Kw(f,r,d)}var M;if(mb)e:{switch(e){case"compositionstart":var N="onCompositionStart";break e;case"compositionend":N="onCompositionEnd";break e;case"compositionupdate":N="onCompositionUpdate";break e}N=void 0}else Hc?sj(e,r)&&(N="onCompositionEnd"):e==="keydown"&&r.keyCode===229&&(N="onCompositionStart");N&&(oj&&r.locale!=="ko"&&(Hc||N!=="onCompositionStart"?N==="onCompositionEnd"&&Hc&&(M=ij()):(Hs=d,hb="value"in Hs?Hs.value:Hs.textContent,Hc=!0)),k=op(u,N),0<k.length&&(N=new Bw(N,e,null,r,d),f.push({event:N,listeners:k}),M?N.data=M:(M=lj(r),M!==null&&(N.data=M)))),(M=NA?OA(e,r):AA(e,r))&&(u=op(u,"onBeforeInput"),0<u.length&&(d=new Bw("onBeforeInput","beforeinput",null,r,d),f.push({event:d,listeners:u}),d.data=M))}bj(f,t)})}function Lf(e,t,r){return{instance:e,listener:t,currentTarget:r}}function op(e,t){for(var r=t+"Capture",n=[];e!==null;){var a=e,i=a.stateNode;a.tag===5&&i!==null&&(a=i,i=Af(e,r),i!=null&&n.unshift(Lf(e,i,a)),i=Af(e,t),i!=null&&n.push(Lf(e,i,a))),e=e.return}return n}function $c(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function Zw(e,t,r,n,a){for(var i=t._reactName,o=[];r!==null&&r!==n;){var s=r,l=s.alternate,u=s.stateNode;if(l!==null&&l===n)break;s.tag===5&&u!==null&&(s=u,a?(l=Af(r,i),l!=null&&o.unshift(Lf(r,l,s))):a||(l=Af(r,i),l!=null&&o.push(Lf(r,l,s)))),r=r.return}o.length!==0&&e.push({event:t,listeners:o})}var VA=/\r\n?/g,HA=/\u0000|\uFFFD/g;function Jw(e){return(typeof e=="string"?e:""+e).replace(VA,`
`).replace(HA,"")}function ih(e,t,r){if(t=Jw(t),Jw(e)!==t&&r)throw Error(Fe(425))}function sp(){}var Ux=null,Gx=null;function zx(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var Wx=typeof setTimeout=="function"?setTimeout:void 0,XA=typeof clearTimeout=="function"?clearTimeout:void 0,Qw=typeof Promise=="function"?Promise:void 0,KA=typeof queueMicrotask=="function"?queueMicrotask:typeof Qw<"u"?function(e){return Qw.resolve(null).then(e).catch(YA)}:Wx;function YA(e){setTimeout(function(){throw e})}function py(e,t){var r=t,n=0;do{var a=r.nextSibling;if(e.removeChild(r),a&&a.nodeType===8)if(r=a.data,r==="/$"){if(n===0){e.removeChild(a),If(t);return}n--}else r!=="$"&&r!=="$?"&&r!=="$!"||n++;r=a}while(r);If(t)}function ol(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?")break;if(t==="/$")return null}}return e}function ek(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="$"||r==="$!"||r==="$?"){if(t===0)return e;t--}else r==="/$"&&t++}e=e.previousSibling}return null}var rd=Math.random().toString(36).slice(2),No="__reactFiber$"+rd,Bf="__reactProps$"+rd,us="__reactContainer$"+rd,Vx="__reactEvents$"+rd,qA="__reactListeners$"+rd,ZA="__reactHandles$"+rd;function $l(e){var t=e[No];if(t)return t;for(var r=e.parentNode;r;){if(t=r[us]||r[No]){if(r=t.alternate,t.child!==null||r!==null&&r.child!==null)for(e=ek(e);e!==null;){if(r=e[No])return r;e=ek(e)}return t}e=r,r=e.parentNode}return null}function T0(e){return e=e[No]||e[us],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function Yc(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(Fe(33))}function Lg(e){return e[Bf]||null}var Hx=[],qc=-1;function yl(e){return{current:e}}function kn(e){0>qc||(e.current=Hx[qc],Hx[qc]=null,qc--)}function mn(e,t){qc++,Hx[qc]=e.current,e.current=t}var gl={},$a=yl(gl),di=yl(!1),tc=gl;function yu(e,t){var r=e.type.contextTypes;if(!r)return gl;var n=e.stateNode;if(n&&n.__reactInternalMemoizedUnmaskedChildContext===t)return n.__reactInternalMemoizedMaskedChildContext;var a={},i;for(i in r)a[i]=t[i];return n&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=a),a}function fi(e){return e=e.childContextTypes,e!=null}function lp(){kn(di),kn($a)}function tk(e,t,r){if($a.current!==gl)throw Error(Fe(168));mn($a,t),mn(di,r)}function kj(e,t,r){var n=e.stateNode;if(t=t.childContextTypes,typeof n.getChildContext!="function")return r;n=n.getChildContext();for(var a in n)if(!(a in t))throw Error(Fe(108,R6(e)||"Unknown",a));return En({},r,n)}function cp(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||gl,tc=$a.current,mn($a,e),mn(di,di.current),!0}function rk(e,t,r){var n=e.stateNode;if(!n)throw Error(Fe(169));r?(e=kj(e,t,tc),n.__reactInternalMemoizedMergedChildContext=e,kn(di),kn($a),mn($a,e)):kn(di),mn(di,r)}var Qo=null,Bg=!1,gy=!1;function Sj(e){Qo===null?Qo=[e]:Qo.push(e)}function JA(e){Bg=!0,Sj(e)}function xl(){if(!gy&&Qo!==null){gy=!0;var e=0,t=rn;try{var r=Qo;for(rn=1;e<r.length;e++){var n=r[e];do n=n(!0);while(n!==null)}Qo=null,Bg=!1}catch(a){throw Qo!==null&&(Qo=Qo.slice(e+1)),K_(cb,xl),a}finally{rn=t,gy=!1}}return null}var Zc=[],Jc=0,up=null,dp=0,Li=[],Bi=0,rc=null,es=1,ts="";function El(e,t){Zc[Jc++]=dp,Zc[Jc++]=up,up=e,dp=t}function _j(e,t,r){Li[Bi++]=es,Li[Bi++]=ts,Li[Bi++]=rc,rc=e;var n=es;e=ts;var a=32-yo(n)-1;n&=~(1<<a),r+=1;var i=32-yo(t)+a;if(30<i){var o=a-a%5;i=(n&(1<<o)-1).toString(32),n>>=o,a-=o,es=1<<32-yo(t)+a|r<<a|n,ts=i+e}else es=1<<i|r<<a|n,ts=e}function xb(e){e.return!==null&&(El(e,1),_j(e,1,0))}function vb(e){for(;e===up;)up=Zc[--Jc],Zc[Jc]=null,dp=Zc[--Jc],Zc[Jc]=null;for(;e===rc;)rc=Li[--Bi],Li[Bi]=null,ts=Li[--Bi],Li[Bi]=null,es=Li[--Bi],Li[Bi]=null}var Pi=null,ji=null,_n=!1,fo=null;function jj(e,t){var r=Fi(5,null,null,0);r.elementType="DELETED",r.stateNode=t,r.return=e,t=e.deletions,t===null?(e.deletions=[r],e.flags|=16):t.push(r)}function nk(e,t){switch(e.tag){case 5:var r=e.type;return t=t.nodeType!==1||r.toLowerCase()!==t.nodeName.toLowerCase()?null:t,t!==null?(e.stateNode=t,Pi=e,ji=ol(t.firstChild),!0):!1;case 6:return t=e.pendingProps===""||t.nodeType!==3?null:t,t!==null?(e.stateNode=t,Pi=e,ji=null,!0):!1;case 13:return t=t.nodeType!==8?null:t,t!==null?(r=rc!==null?{id:es,overflow:ts}:null,e.memoizedState={dehydrated:t,treeContext:r,retryLane:1073741824},r=Fi(18,null,null,0),r.stateNode=t,r.return=e,e.child=r,Pi=e,ji=null,!0):!1;default:return!1}}function Xx(e){return(e.mode&1)!==0&&(e.flags&128)===0}function Kx(e){if(_n){var t=ji;if(t){var r=t;if(!nk(e,t)){if(Xx(e))throw Error(Fe(418));t=ol(r.nextSibling);var n=Pi;t&&nk(e,t)?jj(n,r):(e.flags=e.flags&-4097|2,_n=!1,Pi=e)}}else{if(Xx(e))throw Error(Fe(418));e.flags=e.flags&-4097|2,_n=!1,Pi=e}}}function ak(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;Pi=e}function oh(e){if(e!==Pi)return!1;if(!_n)return ak(e),_n=!0,!1;var t;if((t=e.tag!==3)&&!(t=e.tag!==5)&&(t=e.type,t=t!=="head"&&t!=="body"&&!zx(e.type,e.memoizedProps)),t&&(t=ji)){if(Xx(e))throw Pj(),Error(Fe(418));for(;t;)jj(e,t),t=ol(t.nextSibling)}if(ak(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(Fe(317));e:{for(e=e.nextSibling,t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="/$"){if(t===0){ji=ol(e.nextSibling);break e}t--}else r!=="$"&&r!=="$!"&&r!=="$?"||t++}e=e.nextSibling}ji=null}}else ji=Pi?ol(e.stateNode.nextSibling):null;return!0}function Pj(){for(var e=ji;e;)e=ol(e.nextSibling)}function xu(){ji=Pi=null,_n=!1}function bb(e){fo===null?fo=[e]:fo.push(e)}var QA=ms.ReactCurrentBatchConfig;function zd(e,t,r){if(e=r.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(r._owner){if(r=r._owner,r){if(r.tag!==1)throw Error(Fe(309));var n=r.stateNode}if(!n)throw Error(Fe(147,e));var a=n,i=""+e;return t!==null&&t.ref!==null&&typeof t.ref=="function"&&t.ref._stringRef===i?t.ref:(t=function(o){var s=a.refs;o===null?delete s[i]:s[i]=o},t._stringRef=i,t)}if(typeof e!="string")throw Error(Fe(284));if(!r._owner)throw Error(Fe(290,e))}return e}function sh(e,t){throw e=Object.prototype.toString.call(t),Error(Fe(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function ik(e){var t=e._init;return t(e._payload)}function Cj(e){function t(x,y){if(e){var _=x.deletions;_===null?(x.deletions=[y],x.flags|=16):_.push(y)}}function r(x,y){if(!e)return null;for(;y!==null;)t(x,y),y=y.sibling;return null}function n(x,y){for(x=new Map;y!==null;)y.key!==null?x.set(y.key,y):x.set(y.index,y),y=y.sibling;return x}function a(x,y){return x=ul(x,y),x.index=0,x.sibling=null,x}function i(x,y,_){return x.index=_,e?(_=x.alternate,_!==null?(_=_.index,_<y?(x.flags|=2,y):_):(x.flags|=2,y)):(x.flags|=1048576,y)}function o(x){return e&&x.alternate===null&&(x.flags|=2),x}function s(x,y,_,j){return y===null||y.tag!==6?(y=ky(_,x.mode,j),y.return=x,y):(y=a(y,_),y.return=x,y)}function l(x,y,_,j){var S=_.type;return S===Vc?d(x,y,_.props.children,j,_.key):y!==null&&(y.elementType===S||typeof S=="object"&&S!==null&&S.$$typeof===Bs&&ik(S)===y.type)?(j=a(y,_.props),j.ref=zd(x,y,_),j.return=x,j):(j=Kh(_.type,_.key,_.props,null,x.mode,j),j.ref=zd(x,y,_),j.return=x,j)}function u(x,y,_,j){return y===null||y.tag!==4||y.stateNode.containerInfo!==_.containerInfo||y.stateNode.implementation!==_.implementation?(y=Sy(_,x.mode,j),y.return=x,y):(y=a(y,_.children||[]),y.return=x,y)}function d(x,y,_,j,S){return y===null||y.tag!==7?(y=ql(_,x.mode,j,S),y.return=x,y):(y=a(y,_),y.return=x,y)}function f(x,y,_){if(typeof y=="string"&&y!==""||typeof y=="number")return y=ky(""+y,x.mode,_),y.return=x,y;if(typeof y=="object"&&y!==null){switch(y.$$typeof){case q0:return _=Kh(y.type,y.key,y.props,null,x.mode,_),_.ref=zd(x,null,y),_.return=x,_;case Wc:return y=Sy(y,x.mode,_),y.return=x,y;case Bs:var j=y._init;return f(x,j(y._payload),_)}if(sf(y)||Ld(y))return y=ql(y,x.mode,_,null),y.return=x,y;sh(x,y)}return null}function h(x,y,_,j){var S=y!==null?y.key:null;if(typeof _=="string"&&_!==""||typeof _=="number")return S!==null?null:s(x,y,""+_,j);if(typeof _=="object"&&_!==null){switch(_.$$typeof){case q0:return _.key===S?l(x,y,_,j):null;case Wc:return _.key===S?u(x,y,_,j):null;case Bs:return S=_._init,h(x,y,S(_._payload),j)}if(sf(_)||Ld(_))return S!==null?null:d(x,y,_,j,null);sh(x,_)}return null}function g(x,y,_,j,S){if(typeof j=="string"&&j!==""||typeof j=="number")return x=x.get(_)||null,s(y,x,""+j,S);if(typeof j=="object"&&j!==null){switch(j.$$typeof){case q0:return x=x.get(j.key===null?_:j.key)||null,l(y,x,j,S);case Wc:return x=x.get(j.key===null?_:j.key)||null,u(y,x,j,S);case Bs:var k=j._init;return g(x,y,_,k(j._payload),S)}if(sf(j)||Ld(j))return x=x.get(_)||null,d(y,x,j,S,null);sh(y,j)}return null}function v(x,y,_,j){for(var S=null,k=null,M=y,N=y=0,T=null;M!==null&&N<_.length;N++){M.index>N?(T=M,M=null):T=M.sibling;var A=h(x,M,_[N],j);if(A===null){M===null&&(M=T);break}e&&M&&A.alternate===null&&t(x,M),y=i(A,y,N),k===null?S=A:k.sibling=A,k=A,M=T}if(N===_.length)return r(x,M),_n&&El(x,N),S;if(M===null){for(;N<_.length;N++)M=f(x,_[N],j),M!==null&&(y=i(M,y,N),k===null?S=M:k.sibling=M,k=M);return _n&&El(x,N),S}for(M=n(x,M);N<_.length;N++)T=g(M,x,N,_[N],j),T!==null&&(e&&T.alternate!==null&&M.delete(T.key===null?N:T.key),y=i(T,y,N),k===null?S=T:k.sibling=T,k=T);return e&&M.forEach(function(D){return t(x,D)}),_n&&El(x,N),S}function w(x,y,_,j){var S=Ld(_);if(typeof S!="function")throw Error(Fe(150));if(_=S.call(_),_==null)throw Error(Fe(151));for(var k=S=null,M=y,N=y=0,T=null,A=_.next();M!==null&&!A.done;N++,A=_.next()){M.index>N?(T=M,M=null):T=M.sibling;var D=h(x,M,A.value,j);if(D===null){M===null&&(M=T);break}e&&M&&D.alternate===null&&t(x,M),y=i(D,y,N),k===null?S=D:k.sibling=D,k=D,M=T}if(A.done)return r(x,M),_n&&El(x,N),S;if(M===null){for(;!A.done;N++,A=_.next())A=f(x,A.value,j),A!==null&&(y=i(A,y,N),k===null?S=A:k.sibling=A,k=A);return _n&&El(x,N),S}for(M=n(x,M);!A.done;N++,A=_.next())A=g(M,x,N,A.value,j),A!==null&&(e&&A.alternate!==null&&M.delete(A.key===null?N:A.key),y=i(A,y,N),k===null?S=A:k.sibling=A,k=A);return e&&M.forEach(function($){return t(x,$)}),_n&&El(x,N),S}function b(x,y,_,j){if(typeof _=="object"&&_!==null&&_.type===Vc&&_.key===null&&(_=_.props.children),typeof _=="object"&&_!==null){switch(_.$$typeof){case q0:e:{for(var S=_.key,k=y;k!==null;){if(k.key===S){if(S=_.type,S===Vc){if(k.tag===7){r(x,k.sibling),y=a(k,_.props.children),y.return=x,x=y;break e}}else if(k.elementType===S||typeof S=="object"&&S!==null&&S.$$typeof===Bs&&ik(S)===k.type){r(x,k.sibling),y=a(k,_.props),y.ref=zd(x,k,_),y.return=x,x=y;break e}r(x,k);break}else t(x,k);k=k.sibling}_.type===Vc?(y=ql(_.props.children,x.mode,j,_.key),y.return=x,x=y):(j=Kh(_.type,_.key,_.props,null,x.mode,j),j.ref=zd(x,y,_),j.return=x,x=j)}return o(x);case Wc:e:{for(k=_.key;y!==null;){if(y.key===k)if(y.tag===4&&y.stateNode.containerInfo===_.containerInfo&&y.stateNode.implementation===_.implementation){r(x,y.sibling),y=a(y,_.children||[]),y.return=x,x=y;break e}else{r(x,y);break}else t(x,y);y=y.sibling}y=Sy(_,x.mode,j),y.return=x,x=y}return o(x);case Bs:return k=_._init,b(x,y,k(_._payload),j)}if(sf(_))return v(x,y,_,j);if(Ld(_))return w(x,y,_,j);sh(x,_)}return typeof _=="string"&&_!==""||typeof _=="number"?(_=""+_,y!==null&&y.tag===6?(r(x,y.sibling),y=a(y,_),y.return=x,x=y):(r(x,y),y=ky(_,x.mode,j),y.return=x,x=y),o(x)):r(x,y)}return b}var vu=Cj(!0),Mj=Cj(!1),fp=yl(null),hp=null,Qc=null,wb=null;function kb(){wb=Qc=hp=null}function Sb(e){var t=fp.current;kn(fp),e._currentValue=t}function Yx(e,t,r){for(;e!==null;){var n=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,n!==null&&(n.childLanes|=t)):n!==null&&(n.childLanes&t)!==t&&(n.childLanes|=t),e===r)break;e=e.return}}function cu(e,t){hp=e,wb=Qc=null,e=e.dependencies,e!==null&&e.firstContext!==null&&(e.lanes&t&&(ci=!0),e.firstContext=null)}function Vi(e){var t=e._currentValue;if(wb!==e)if(e={context:e,memoizedValue:t,next:null},Qc===null){if(hp===null)throw Error(Fe(308));Qc=e,hp.dependencies={lanes:0,firstContext:e}}else Qc=Qc.next=e;return t}var Ll=null;function _b(e){Ll===null?Ll=[e]:Ll.push(e)}function Nj(e,t,r,n){var a=t.interleaved;return a===null?(r.next=r,_b(t)):(r.next=a.next,a.next=r),t.interleaved=r,ds(e,n)}function ds(e,t){e.lanes|=t;var r=e.alternate;for(r!==null&&(r.lanes|=t),r=e,e=e.return;e!==null;)e.childLanes|=t,r=e.alternate,r!==null&&(r.childLanes|=t),r=e,e=e.return;return r.tag===3?r.stateNode:null}var Fs=!1;function jb(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Oj(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function is(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function sl(e,t,r){var n=e.updateQueue;if(n===null)return null;if(n=n.shared,Gr&2){var a=n.pending;return a===null?t.next=t:(t.next=a.next,a.next=t),n.pending=t,ds(e,r)}return a=n.interleaved,a===null?(t.next=t,_b(n)):(t.next=a.next,a.next=t),n.interleaved=t,ds(e,r)}function Gh(e,t,r){if(t=t.updateQueue,t!==null&&(t=t.shared,(r&4194240)!==0)){var n=t.lanes;n&=e.pendingLanes,r|=n,t.lanes=r,ub(e,r)}}function ok(e,t){var r=e.updateQueue,n=e.alternate;if(n!==null&&(n=n.updateQueue,r===n)){var a=null,i=null;if(r=r.firstBaseUpdate,r!==null){do{var o={eventTime:r.eventTime,lane:r.lane,tag:r.tag,payload:r.payload,callback:r.callback,next:null};i===null?a=i=o:i=i.next=o,r=r.next}while(r!==null);i===null?a=i=t:i=i.next=t}else a=i=t;r={baseState:n.baseState,firstBaseUpdate:a,lastBaseUpdate:i,shared:n.shared,effects:n.effects},e.updateQueue=r;return}e=r.lastBaseUpdate,e===null?r.firstBaseUpdate=t:e.next=t,r.lastBaseUpdate=t}function pp(e,t,r,n){var a=e.updateQueue;Fs=!1;var i=a.firstBaseUpdate,o=a.lastBaseUpdate,s=a.shared.pending;if(s!==null){a.shared.pending=null;var l=s,u=l.next;l.next=null,o===null?i=u:o.next=u,o=l;var d=e.alternate;d!==null&&(d=d.updateQueue,s=d.lastBaseUpdate,s!==o&&(s===null?d.firstBaseUpdate=u:s.next=u,d.lastBaseUpdate=l))}if(i!==null){var f=a.baseState;o=0,d=u=l=null,s=i;do{var h=s.lane,g=s.eventTime;if((n&h)===h){d!==null&&(d=d.next={eventTime:g,lane:0,tag:s.tag,payload:s.payload,callback:s.callback,next:null});e:{var v=e,w=s;switch(h=t,g=r,w.tag){case 1:if(v=w.payload,typeof v=="function"){f=v.call(g,f,h);break e}f=v;break e;case 3:v.flags=v.flags&-65537|128;case 0:if(v=w.payload,h=typeof v=="function"?v.call(g,f,h):v,h==null)break e;f=En({},f,h);break e;case 2:Fs=!0}}s.callback!==null&&s.lane!==0&&(e.flags|=64,h=a.effects,h===null?a.effects=[s]:h.push(s))}else g={eventTime:g,lane:h,tag:s.tag,payload:s.payload,callback:s.callback,next:null},d===null?(u=d=g,l=f):d=d.next=g,o|=h;if(s=s.next,s===null){if(s=a.shared.pending,s===null)break;h=s,s=h.next,h.next=null,a.lastBaseUpdate=h,a.shared.pending=null}}while(!0);if(d===null&&(l=f),a.baseState=l,a.firstBaseUpdate=u,a.lastBaseUpdate=d,t=a.shared.interleaved,t!==null){a=t;do o|=a.lane,a=a.next;while(a!==t)}else i===null&&(a.shared.lanes=0);ac|=o,e.lanes=o,e.memoizedState=f}}function sk(e,t,r){if(e=t.effects,t.effects=null,e!==null)for(t=0;t<e.length;t++){var n=e[t],a=n.callback;if(a!==null){if(n.callback=null,n=r,typeof a!="function")throw Error(Fe(191,a));a.call(n)}}}var I0={},Io=yl(I0),Ff=yl(I0),Uf=yl(I0);function Bl(e){if(e===I0)throw Error(Fe(174));return e}function Pb(e,t){switch(mn(Uf,t),mn(Ff,e),mn(Io,I0),e=t.nodeType,e){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:Nx(null,"");break;default:e=e===8?t.parentNode:t,t=e.namespaceURI||null,e=e.tagName,t=Nx(t,e)}kn(Io),mn(Io,t)}function bu(){kn(Io),kn(Ff),kn(Uf)}function Aj(e){Bl(Uf.current);var t=Bl(Io.current),r=Nx(t,e.type);t!==r&&(mn(Ff,e),mn(Io,r))}function Cb(e){Ff.current===e&&(kn(Io),kn(Ff))}var On=yl(0);function gp(e){for(var t=e;t!==null;){if(t.tag===13){var r=t.memoizedState;if(r!==null&&(r=r.dehydrated,r===null||r.data==="$?"||r.data==="$!"))return t}else if(t.tag===19&&t.memoizedProps.revealOrder!==void 0){if(t.flags&128)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var my=[];function Mb(){for(var e=0;e<my.length;e++)my[e]._workInProgressVersionPrimary=null;my.length=0}var zh=ms.ReactCurrentDispatcher,yy=ms.ReactCurrentBatchConfig,nc=0,An=null,na=null,pa=null,mp=!1,mf=!1,Gf=0,eE=0;function Aa(){throw Error(Fe(321))}function Nb(e,t){if(t===null)return!1;for(var r=0;r<t.length&&r<e.length;r++)if(!vo(e[r],t[r]))return!1;return!0}function Ob(e,t,r,n,a,i){if(nc=i,An=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,zh.current=e===null||e.memoizedState===null?aE:iE,e=r(n,a),mf){i=0;do{if(mf=!1,Gf=0,25<=i)throw Error(Fe(301));i+=1,pa=na=null,t.updateQueue=null,zh.current=oE,e=r(n,a)}while(mf)}if(zh.current=yp,t=na!==null&&na.next!==null,nc=0,pa=na=An=null,mp=!1,t)throw Error(Fe(300));return e}function Ab(){var e=Gf!==0;return Gf=0,e}function Mo(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return pa===null?An.memoizedState=pa=e:pa=pa.next=e,pa}function Hi(){if(na===null){var e=An.alternate;e=e!==null?e.memoizedState:null}else e=na.next;var t=pa===null?An.memoizedState:pa.next;if(t!==null)pa=t,na=e;else{if(e===null)throw Error(Fe(310));na=e,e={memoizedState:na.memoizedState,baseState:na.baseState,baseQueue:na.baseQueue,queue:na.queue,next:null},pa===null?An.memoizedState=pa=e:pa=pa.next=e}return pa}function zf(e,t){return typeof t=="function"?t(e):t}function xy(e){var t=Hi(),r=t.queue;if(r===null)throw Error(Fe(311));r.lastRenderedReducer=e;var n=na,a=n.baseQueue,i=r.pending;if(i!==null){if(a!==null){var o=a.next;a.next=i.next,i.next=o}n.baseQueue=a=i,r.pending=null}if(a!==null){i=a.next,n=n.baseState;var s=o=null,l=null,u=i;do{var d=u.lane;if((nc&d)===d)l!==null&&(l=l.next={lane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),n=u.hasEagerState?u.eagerState:e(n,u.action);else{var f={lane:d,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null};l===null?(s=l=f,o=n):l=l.next=f,An.lanes|=d,ac|=d}u=u.next}while(u!==null&&u!==i);l===null?o=n:l.next=s,vo(n,t.memoizedState)||(ci=!0),t.memoizedState=n,t.baseState=o,t.baseQueue=l,r.lastRenderedState=n}if(e=r.interleaved,e!==null){a=e;do i=a.lane,An.lanes|=i,ac|=i,a=a.next;while(a!==e)}else a===null&&(r.lanes=0);return[t.memoizedState,r.dispatch]}function vy(e){var t=Hi(),r=t.queue;if(r===null)throw Error(Fe(311));r.lastRenderedReducer=e;var n=r.dispatch,a=r.pending,i=t.memoizedState;if(a!==null){r.pending=null;var o=a=a.next;do i=e(i,o.action),o=o.next;while(o!==a);vo(i,t.memoizedState)||(ci=!0),t.memoizedState=i,t.baseQueue===null&&(t.baseState=i),r.lastRenderedState=i}return[i,n]}function Ej(){}function Tj(e,t){var r=An,n=Hi(),a=t(),i=!vo(n.memoizedState,a);if(i&&(n.memoizedState=a,ci=!0),n=n.queue,Eb(Dj.bind(null,r,n,e),[e]),n.getSnapshot!==t||i||pa!==null&&pa.memoizedState.tag&1){if(r.flags|=2048,Wf(9,Rj.bind(null,r,n,a,t),void 0,null),ga===null)throw Error(Fe(349));nc&30||Ij(r,t,a)}return a}function Ij(e,t,r){e.flags|=16384,e={getSnapshot:t,value:r},t=An.updateQueue,t===null?(t={lastEffect:null,stores:null},An.updateQueue=t,t.stores=[e]):(r=t.stores,r===null?t.stores=[e]:r.push(e))}function Rj(e,t,r,n){t.value=r,t.getSnapshot=n,$j(t)&&Lj(e)}function Dj(e,t,r){return r(function(){$j(t)&&Lj(e)})}function $j(e){var t=e.getSnapshot;e=e.value;try{var r=t();return!vo(e,r)}catch{return!0}}function Lj(e){var t=ds(e,1);t!==null&&xo(t,e,1,-1)}function lk(e){var t=Mo();return typeof e=="function"&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:zf,lastRenderedState:e},t.queue=e,e=e.dispatch=nE.bind(null,An,e),[t.memoizedState,e]}function Wf(e,t,r,n){return e={tag:e,create:t,destroy:r,deps:n,next:null},t=An.updateQueue,t===null?(t={lastEffect:null,stores:null},An.updateQueue=t,t.lastEffect=e.next=e):(r=t.lastEffect,r===null?t.lastEffect=e.next=e:(n=r.next,r.next=e,e.next=n,t.lastEffect=e)),e}function Bj(){return Hi().memoizedState}function Wh(e,t,r,n){var a=Mo();An.flags|=e,a.memoizedState=Wf(1|t,r,void 0,n===void 0?null:n)}function Fg(e,t,r,n){var a=Hi();n=n===void 0?null:n;var i=void 0;if(na!==null){var o=na.memoizedState;if(i=o.destroy,n!==null&&Nb(n,o.deps)){a.memoizedState=Wf(t,r,i,n);return}}An.flags|=e,a.memoizedState=Wf(1|t,r,i,n)}function ck(e,t){return Wh(8390656,8,e,t)}function Eb(e,t){return Fg(2048,8,e,t)}function Fj(e,t){return Fg(4,2,e,t)}function Uj(e,t){return Fg(4,4,e,t)}function Gj(e,t){if(typeof t=="function")return e=e(),t(e),function(){t(null)};if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function zj(e,t,r){return r=r!=null?r.concat([e]):null,Fg(4,4,Gj.bind(null,t,e),r)}function Tb(){}function Wj(e,t){var r=Hi();t=t===void 0?null:t;var n=r.memoizedState;return n!==null&&t!==null&&Nb(t,n[1])?n[0]:(r.memoizedState=[e,t],e)}function Vj(e,t){var r=Hi();t=t===void 0?null:t;var n=r.memoizedState;return n!==null&&t!==null&&Nb(t,n[1])?n[0]:(e=e(),r.memoizedState=[e,t],e)}function Hj(e,t,r){return nc&21?(vo(r,t)||(r=Z_(),An.lanes|=r,ac|=r,e.baseState=!0),t):(e.baseState&&(e.baseState=!1,ci=!0),e.memoizedState=r)}function tE(e,t){var r=rn;rn=r!==0&&4>r?r:4,e(!0);var n=yy.transition;yy.transition={};try{e(!1),t()}finally{rn=r,yy.transition=n}}function Xj(){return Hi().memoizedState}function rE(e,t,r){var n=cl(e);if(r={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null},Kj(e))Yj(t,r);else if(r=Nj(e,t,r,n),r!==null){var a=qa();xo(r,e,n,a),qj(r,t,n)}}function nE(e,t,r){var n=cl(e),a={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null};if(Kj(e))Yj(t,a);else{var i=e.alternate;if(e.lanes===0&&(i===null||i.lanes===0)&&(i=t.lastRenderedReducer,i!==null))try{var o=t.lastRenderedState,s=i(o,r);if(a.hasEagerState=!0,a.eagerState=s,vo(s,o)){var l=t.interleaved;l===null?(a.next=a,_b(t)):(a.next=l.next,l.next=a),t.interleaved=a;return}}catch{}finally{}r=Nj(e,t,a,n),r!==null&&(a=qa(),xo(r,e,n,a),qj(r,t,n))}}function Kj(e){var t=e.alternate;return e===An||t!==null&&t===An}function Yj(e,t){mf=mp=!0;var r=e.pending;r===null?t.next=t:(t.next=r.next,r.next=t),e.pending=t}function qj(e,t,r){if(r&4194240){var n=t.lanes;n&=e.pendingLanes,r|=n,t.lanes=r,ub(e,r)}}var yp={readContext:Vi,useCallback:Aa,useContext:Aa,useEffect:Aa,useImperativeHandle:Aa,useInsertionEffect:Aa,useLayoutEffect:Aa,useMemo:Aa,useReducer:Aa,useRef:Aa,useState:Aa,useDebugValue:Aa,useDeferredValue:Aa,useTransition:Aa,useMutableSource:Aa,useSyncExternalStore:Aa,useId:Aa,unstable_isNewReconciler:!1},aE={readContext:Vi,useCallback:function(e,t){return Mo().memoizedState=[e,t===void 0?null:t],e},useContext:Vi,useEffect:ck,useImperativeHandle:function(e,t,r){return r=r!=null?r.concat([e]):null,Wh(4194308,4,Gj.bind(null,t,e),r)},useLayoutEffect:function(e,t){return Wh(4194308,4,e,t)},useInsertionEffect:function(e,t){return Wh(4,2,e,t)},useMemo:function(e,t){var r=Mo();return t=t===void 0?null:t,e=e(),r.memoizedState=[e,t],e},useReducer:function(e,t,r){var n=Mo();return t=r!==void 0?r(t):t,n.memoizedState=n.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},n.queue=e,e=e.dispatch=rE.bind(null,An,e),[n.memoizedState,e]},useRef:function(e){var t=Mo();return e={current:e},t.memoizedState=e},useState:lk,useDebugValue:Tb,useDeferredValue:function(e){return Mo().memoizedState=e},useTransition:function(){var e=lk(!1),t=e[0];return e=tE.bind(null,e[1]),Mo().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,r){var n=An,a=Mo();if(_n){if(r===void 0)throw Error(Fe(407));r=r()}else{if(r=t(),ga===null)throw Error(Fe(349));nc&30||Ij(n,t,r)}a.memoizedState=r;var i={value:r,getSnapshot:t};return a.queue=i,ck(Dj.bind(null,n,i,e),[e]),n.flags|=2048,Wf(9,Rj.bind(null,n,i,r,t),void 0,null),r},useId:function(){var e=Mo(),t=ga.identifierPrefix;if(_n){var r=ts,n=es;r=(n&~(1<<32-yo(n)-1)).toString(32)+r,t=":"+t+"R"+r,r=Gf++,0<r&&(t+="H"+r.toString(32)),t+=":"}else r=eE++,t=":"+t+"r"+r.toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},iE={readContext:Vi,useCallback:Wj,useContext:Vi,useEffect:Eb,useImperativeHandle:zj,useInsertionEffect:Fj,useLayoutEffect:Uj,useMemo:Vj,useReducer:xy,useRef:Bj,useState:function(){return xy(zf)},useDebugValue:Tb,useDeferredValue:function(e){var t=Hi();return Hj(t,na.memoizedState,e)},useTransition:function(){var e=xy(zf)[0],t=Hi().memoizedState;return[e,t]},useMutableSource:Ej,useSyncExternalStore:Tj,useId:Xj,unstable_isNewReconciler:!1},oE={readContext:Vi,useCallback:Wj,useContext:Vi,useEffect:Eb,useImperativeHandle:zj,useInsertionEffect:Fj,useLayoutEffect:Uj,useMemo:Vj,useReducer:vy,useRef:Bj,useState:function(){return vy(zf)},useDebugValue:Tb,useDeferredValue:function(e){var t=Hi();return na===null?t.memoizedState=e:Hj(t,na.memoizedState,e)},useTransition:function(){var e=vy(zf)[0],t=Hi().memoizedState;return[e,t]},useMutableSource:Ej,useSyncExternalStore:Tj,useId:Xj,unstable_isNewReconciler:!1};function oo(e,t){if(e&&e.defaultProps){t=En({},t),e=e.defaultProps;for(var r in e)t[r]===void 0&&(t[r]=e[r]);return t}return t}function qx(e,t,r,n){t=e.memoizedState,r=r(n,t),r=r==null?t:En({},t,r),e.memoizedState=r,e.lanes===0&&(e.updateQueue.baseState=r)}var Ug={isMounted:function(e){return(e=e._reactInternals)?bc(e)===e:!1},enqueueSetState:function(e,t,r){e=e._reactInternals;var n=qa(),a=cl(e),i=is(n,a);i.payload=t,r!=null&&(i.callback=r),t=sl(e,i,a),t!==null&&(xo(t,e,a,n),Gh(t,e,a))},enqueueReplaceState:function(e,t,r){e=e._reactInternals;var n=qa(),a=cl(e),i=is(n,a);i.tag=1,i.payload=t,r!=null&&(i.callback=r),t=sl(e,i,a),t!==null&&(xo(t,e,a,n),Gh(t,e,a))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var r=qa(),n=cl(e),a=is(r,n);a.tag=2,t!=null&&(a.callback=t),t=sl(e,a,n),t!==null&&(xo(t,e,n,r),Gh(t,e,n))}};function uk(e,t,r,n,a,i,o){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(n,i,o):t.prototype&&t.prototype.isPureReactComponent?!Df(r,n)||!Df(a,i):!0}function Zj(e,t,r){var n=!1,a=gl,i=t.contextType;return typeof i=="object"&&i!==null?i=Vi(i):(a=fi(t)?tc:$a.current,n=t.contextTypes,i=(n=n!=null)?yu(e,a):gl),t=new t(r,i),e.memoizedState=t.state!==null&&t.state!==void 0?t.state:null,t.updater=Ug,e.stateNode=t,t._reactInternals=e,n&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=a,e.__reactInternalMemoizedMaskedChildContext=i),t}function dk(e,t,r,n){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(r,n),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(r,n),t.state!==e&&Ug.enqueueReplaceState(t,t.state,null)}function Zx(e,t,r,n){var a=e.stateNode;a.props=r,a.state=e.memoizedState,a.refs={},jb(e);var i=t.contextType;typeof i=="object"&&i!==null?a.context=Vi(i):(i=fi(t)?tc:$a.current,a.context=yu(e,i)),a.state=e.memoizedState,i=t.getDerivedStateFromProps,typeof i=="function"&&(qx(e,t,i,r),a.state=e.memoizedState),typeof t.getDerivedStateFromProps=="function"||typeof a.getSnapshotBeforeUpdate=="function"||typeof a.UNSAFE_componentWillMount!="function"&&typeof a.componentWillMount!="function"||(t=a.state,typeof a.componentWillMount=="function"&&a.componentWillMount(),typeof a.UNSAFE_componentWillMount=="function"&&a.UNSAFE_componentWillMount(),t!==a.state&&Ug.enqueueReplaceState(a,a.state,null),pp(e,r,a,n),a.state=e.memoizedState),typeof a.componentDidMount=="function"&&(e.flags|=4194308)}function wu(e,t){try{var r="",n=t;do r+=I6(n),n=n.return;while(n);var a=r}catch(i){a=`
Error generating stack: `+i.message+`
`+i.stack}return{value:e,source:t,stack:a,digest:null}}function by(e,t,r){return{value:e,source:null,stack:r??null,digest:t??null}}function Jx(e,t){try{console.error(t.value)}catch(r){setTimeout(function(){throw r})}}var sE=typeof WeakMap=="function"?WeakMap:Map;function Jj(e,t,r){r=is(-1,r),r.tag=3,r.payload={element:null};var n=t.value;return r.callback=function(){vp||(vp=!0,lv=n),Jx(e,t)},r}function Qj(e,t,r){r=is(-1,r),r.tag=3;var n=e.type.getDerivedStateFromError;if(typeof n=="function"){var a=t.value;r.payload=function(){return n(a)},r.callback=function(){Jx(e,t)}}var i=e.stateNode;return i!==null&&typeof i.componentDidCatch=="function"&&(r.callback=function(){Jx(e,t),typeof n!="function"&&(ll===null?ll=new Set([this]):ll.add(this));var o=t.stack;this.componentDidCatch(t.value,{componentStack:o!==null?o:""})}),r}function fk(e,t,r){var n=e.pingCache;if(n===null){n=e.pingCache=new sE;var a=new Set;n.set(t,a)}else a=n.get(t),a===void 0&&(a=new Set,n.set(t,a));a.has(r)||(a.add(r),e=wE.bind(null,e,t,r),t.then(e,e))}function hk(e){do{var t;if((t=e.tag===13)&&(t=e.memoizedState,t=t!==null?t.dehydrated!==null:!0),t)return e;e=e.return}while(e!==null);return null}function pk(e,t,r,n,a){return e.mode&1?(e.flags|=65536,e.lanes=a,e):(e===t?e.flags|=65536:(e.flags|=128,r.flags|=131072,r.flags&=-52805,r.tag===1&&(r.alternate===null?r.tag=17:(t=is(-1,1),t.tag=2,sl(r,t,1))),r.lanes|=1),e)}var lE=ms.ReactCurrentOwner,ci=!1;function Va(e,t,r,n){t.child=e===null?Mj(t,null,r,n):vu(t,e.child,r,n)}function gk(e,t,r,n,a){r=r.render;var i=t.ref;return cu(t,a),n=Ob(e,t,r,n,i,a),r=Ab(),e!==null&&!ci?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~a,fs(e,t,a)):(_n&&r&&xb(t),t.flags|=1,Va(e,t,n,a),t.child)}function mk(e,t,r,n,a){if(e===null){var i=r.type;return typeof i=="function"&&!Ub(i)&&i.defaultProps===void 0&&r.compare===null&&r.defaultProps===void 0?(t.tag=15,t.type=i,eP(e,t,i,n,a)):(e=Kh(r.type,null,n,t,t.mode,a),e.ref=t.ref,e.return=t,t.child=e)}if(i=e.child,!(e.lanes&a)){var o=i.memoizedProps;if(r=r.compare,r=r!==null?r:Df,r(o,n)&&e.ref===t.ref)return fs(e,t,a)}return t.flags|=1,e=ul(i,n),e.ref=t.ref,e.return=t,t.child=e}function eP(e,t,r,n,a){if(e!==null){var i=e.memoizedProps;if(Df(i,n)&&e.ref===t.ref)if(ci=!1,t.pendingProps=n=i,(e.lanes&a)!==0)e.flags&131072&&(ci=!0);else return t.lanes=e.lanes,fs(e,t,a)}return Qx(e,t,r,n,a)}function tP(e,t,r){var n=t.pendingProps,a=n.children,i=e!==null?e.memoizedState:null;if(n.mode==="hidden")if(!(t.mode&1))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},mn(tu,ki),ki|=r;else{if(!(r&1073741824))return e=i!==null?i.baseLanes|r:r,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,mn(tu,ki),ki|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},n=i!==null?i.baseLanes:r,mn(tu,ki),ki|=n}else i!==null?(n=i.baseLanes|r,t.memoizedState=null):n=r,mn(tu,ki),ki|=n;return Va(e,t,a,r),t.child}function rP(e,t){var r=t.ref;(e===null&&r!==null||e!==null&&e.ref!==r)&&(t.flags|=512,t.flags|=2097152)}function Qx(e,t,r,n,a){var i=fi(r)?tc:$a.current;return i=yu(t,i),cu(t,a),r=Ob(e,t,r,n,i,a),n=Ab(),e!==null&&!ci?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~a,fs(e,t,a)):(_n&&n&&xb(t),t.flags|=1,Va(e,t,r,a),t.child)}function yk(e,t,r,n,a){if(fi(r)){var i=!0;cp(t)}else i=!1;if(cu(t,a),t.stateNode===null)Vh(e,t),Zj(t,r,n),Zx(t,r,n,a),n=!0;else if(e===null){var o=t.stateNode,s=t.memoizedProps;o.props=s;var l=o.context,u=r.contextType;typeof u=="object"&&u!==null?u=Vi(u):(u=fi(r)?tc:$a.current,u=yu(t,u));var d=r.getDerivedStateFromProps,f=typeof d=="function"||typeof o.getSnapshotBeforeUpdate=="function";f||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(s!==n||l!==u)&&dk(t,o,n,u),Fs=!1;var h=t.memoizedState;o.state=h,pp(t,n,o,a),l=t.memoizedState,s!==n||h!==l||di.current||Fs?(typeof d=="function"&&(qx(t,r,d,n),l=t.memoizedState),(s=Fs||uk(t,r,s,n,h,l,u))?(f||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount()),typeof o.componentDidMount=="function"&&(t.flags|=4194308)):(typeof o.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=n,t.memoizedState=l),o.props=n,o.state=l,o.context=u,n=s):(typeof o.componentDidMount=="function"&&(t.flags|=4194308),n=!1)}else{o=t.stateNode,Oj(e,t),s=t.memoizedProps,u=t.type===t.elementType?s:oo(t.type,s),o.props=u,f=t.pendingProps,h=o.context,l=r.contextType,typeof l=="object"&&l!==null?l=Vi(l):(l=fi(r)?tc:$a.current,l=yu(t,l));var g=r.getDerivedStateFromProps;(d=typeof g=="function"||typeof o.getSnapshotBeforeUpdate=="function")||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(s!==f||h!==l)&&dk(t,o,n,l),Fs=!1,h=t.memoizedState,o.state=h,pp(t,n,o,a);var v=t.memoizedState;s!==f||h!==v||di.current||Fs?(typeof g=="function"&&(qx(t,r,g,n),v=t.memoizedState),(u=Fs||uk(t,r,u,n,h,v,l)||!1)?(d||typeof o.UNSAFE_componentWillUpdate!="function"&&typeof o.componentWillUpdate!="function"||(typeof o.componentWillUpdate=="function"&&o.componentWillUpdate(n,v,l),typeof o.UNSAFE_componentWillUpdate=="function"&&o.UNSAFE_componentWillUpdate(n,v,l)),typeof o.componentDidUpdate=="function"&&(t.flags|=4),typeof o.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof o.componentDidUpdate!="function"||s===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||s===e.memoizedProps&&h===e.memoizedState||(t.flags|=1024),t.memoizedProps=n,t.memoizedState=v),o.props=n,o.state=v,o.context=l,n=u):(typeof o.componentDidUpdate!="function"||s===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||s===e.memoizedProps&&h===e.memoizedState||(t.flags|=1024),n=!1)}return ev(e,t,r,n,i,a)}function ev(e,t,r,n,a,i){rP(e,t);var o=(t.flags&128)!==0;if(!n&&!o)return a&&rk(t,r,!1),fs(e,t,i);n=t.stateNode,lE.current=t;var s=o&&typeof r.getDerivedStateFromError!="function"?null:n.render();return t.flags|=1,e!==null&&o?(t.child=vu(t,e.child,null,i),t.child=vu(t,null,s,i)):Va(e,t,s,i),t.memoizedState=n.state,a&&rk(t,r,!0),t.child}function nP(e){var t=e.stateNode;t.pendingContext?tk(e,t.pendingContext,t.pendingContext!==t.context):t.context&&tk(e,t.context,!1),Pb(e,t.containerInfo)}function xk(e,t,r,n,a){return xu(),bb(a),t.flags|=256,Va(e,t,r,n),t.child}var tv={dehydrated:null,treeContext:null,retryLane:0};function rv(e){return{baseLanes:e,cachePool:null,transitions:null}}function aP(e,t,r){var n=t.pendingProps,a=On.current,i=!1,o=(t.flags&128)!==0,s;if((s=o)||(s=e!==null&&e.memoizedState===null?!1:(a&2)!==0),s?(i=!0,t.flags&=-129):(e===null||e.memoizedState!==null)&&(a|=1),mn(On,a&1),e===null)return Kx(t),e=t.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?(t.mode&1?e.data==="$!"?t.lanes=8:t.lanes=1073741824:t.lanes=1,null):(o=n.children,e=n.fallback,i?(n=t.mode,i=t.child,o={mode:"hidden",children:o},!(n&1)&&i!==null?(i.childLanes=0,i.pendingProps=o):i=Wg(o,n,0,null),e=ql(e,n,r,null),i.return=t,e.return=t,i.sibling=e,t.child=i,t.child.memoizedState=rv(r),t.memoizedState=tv,e):Ib(t,o));if(a=e.memoizedState,a!==null&&(s=a.dehydrated,s!==null))return cE(e,t,o,n,s,a,r);if(i){i=n.fallback,o=t.mode,a=e.child,s=a.sibling;var l={mode:"hidden",children:n.children};return!(o&1)&&t.child!==a?(n=t.child,n.childLanes=0,n.pendingProps=l,t.deletions=null):(n=ul(a,l),n.subtreeFlags=a.subtreeFlags&14680064),s!==null?i=ul(s,i):(i=ql(i,o,r,null),i.flags|=2),i.return=t,n.return=t,n.sibling=i,t.child=n,n=i,i=t.child,o=e.child.memoizedState,o=o===null?rv(r):{baseLanes:o.baseLanes|r,cachePool:null,transitions:o.transitions},i.memoizedState=o,i.childLanes=e.childLanes&~r,t.memoizedState=tv,n}return i=e.child,e=i.sibling,n=ul(i,{mode:"visible",children:n.children}),!(t.mode&1)&&(n.lanes=r),n.return=t,n.sibling=null,e!==null&&(r=t.deletions,r===null?(t.deletions=[e],t.flags|=16):r.push(e)),t.child=n,t.memoizedState=null,n}function Ib(e,t){return t=Wg({mode:"visible",children:t},e.mode,0,null),t.return=e,e.child=t}function lh(e,t,r,n){return n!==null&&bb(n),vu(t,e.child,null,r),e=Ib(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function cE(e,t,r,n,a,i,o){if(r)return t.flags&256?(t.flags&=-257,n=by(Error(Fe(422))),lh(e,t,o,n)):t.memoizedState!==null?(t.child=e.child,t.flags|=128,null):(i=n.fallback,a=t.mode,n=Wg({mode:"visible",children:n.children},a,0,null),i=ql(i,a,o,null),i.flags|=2,n.return=t,i.return=t,n.sibling=i,t.child=n,t.mode&1&&vu(t,e.child,null,o),t.child.memoizedState=rv(o),t.memoizedState=tv,i);if(!(t.mode&1))return lh(e,t,o,null);if(a.data==="$!"){if(n=a.nextSibling&&a.nextSibling.dataset,n)var s=n.dgst;return n=s,i=Error(Fe(419)),n=by(i,n,void 0),lh(e,t,o,n)}if(s=(o&e.childLanes)!==0,ci||s){if(n=ga,n!==null){switch(o&-o){case 4:a=2;break;case 16:a=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:a=32;break;case 536870912:a=268435456;break;default:a=0}a=a&(n.suspendedLanes|o)?0:a,a!==0&&a!==i.retryLane&&(i.retryLane=a,ds(e,a),xo(n,e,a,-1))}return Fb(),n=by(Error(Fe(421))),lh(e,t,o,n)}return a.data==="$?"?(t.flags|=128,t.child=e.child,t=kE.bind(null,e),a._reactRetry=t,null):(e=i.treeContext,ji=ol(a.nextSibling),Pi=t,_n=!0,fo=null,e!==null&&(Li[Bi++]=es,Li[Bi++]=ts,Li[Bi++]=rc,es=e.id,ts=e.overflow,rc=t),t=Ib(t,n.children),t.flags|=4096,t)}function vk(e,t,r){e.lanes|=t;var n=e.alternate;n!==null&&(n.lanes|=t),Yx(e.return,t,r)}function wy(e,t,r,n,a){var i=e.memoizedState;i===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:n,tail:r,tailMode:a}:(i.isBackwards=t,i.rendering=null,i.renderingStartTime=0,i.last=n,i.tail=r,i.tailMode=a)}function iP(e,t,r){var n=t.pendingProps,a=n.revealOrder,i=n.tail;if(Va(e,t,n.children,r),n=On.current,n&2)n=n&1|2,t.flags|=128;else{if(e!==null&&e.flags&128)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&vk(e,r,t);else if(e.tag===19)vk(e,r,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}n&=1}if(mn(On,n),!(t.mode&1))t.memoizedState=null;else switch(a){case"forwards":for(r=t.child,a=null;r!==null;)e=r.alternate,e!==null&&gp(e)===null&&(a=r),r=r.sibling;r=a,r===null?(a=t.child,t.child=null):(a=r.sibling,r.sibling=null),wy(t,!1,a,r,i);break;case"backwards":for(r=null,a=t.child,t.child=null;a!==null;){if(e=a.alternate,e!==null&&gp(e)===null){t.child=a;break}e=a.sibling,a.sibling=r,r=a,a=e}wy(t,!0,r,null,i);break;case"together":wy(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function Vh(e,t){!(t.mode&1)&&e!==null&&(e.alternate=null,t.alternate=null,t.flags|=2)}function fs(e,t,r){if(e!==null&&(t.dependencies=e.dependencies),ac|=t.lanes,!(r&t.childLanes))return null;if(e!==null&&t.child!==e.child)throw Error(Fe(153));if(t.child!==null){for(e=t.child,r=ul(e,e.pendingProps),t.child=r,r.return=t;e.sibling!==null;)e=e.sibling,r=r.sibling=ul(e,e.pendingProps),r.return=t;r.sibling=null}return t.child}function uE(e,t,r){switch(t.tag){case 3:nP(t),xu();break;case 5:Aj(t);break;case 1:fi(t.type)&&cp(t);break;case 4:Pb(t,t.stateNode.containerInfo);break;case 10:var n=t.type._context,a=t.memoizedProps.value;mn(fp,n._currentValue),n._currentValue=a;break;case 13:if(n=t.memoizedState,n!==null)return n.dehydrated!==null?(mn(On,On.current&1),t.flags|=128,null):r&t.child.childLanes?aP(e,t,r):(mn(On,On.current&1),e=fs(e,t,r),e!==null?e.sibling:null);mn(On,On.current&1);break;case 19:if(n=(r&t.childLanes)!==0,e.flags&128){if(n)return iP(e,t,r);t.flags|=128}if(a=t.memoizedState,a!==null&&(a.rendering=null,a.tail=null,a.lastEffect=null),mn(On,On.current),n)break;return null;case 22:case 23:return t.lanes=0,tP(e,t,r)}return fs(e,t,r)}var oP,nv,sP,lP;oP=function(e,t){for(var r=t.child;r!==null;){if(r.tag===5||r.tag===6)e.appendChild(r.stateNode);else if(r.tag!==4&&r.child!==null){r.child.return=r,r=r.child;continue}if(r===t)break;for(;r.sibling===null;){if(r.return===null||r.return===t)return;r=r.return}r.sibling.return=r.return,r=r.sibling}};nv=function(){};sP=function(e,t,r,n){var a=e.memoizedProps;if(a!==n){e=t.stateNode,Bl(Io.current);var i=null;switch(r){case"input":a=jx(e,a),n=jx(e,n),i=[];break;case"select":a=En({},a,{value:void 0}),n=En({},n,{value:void 0}),i=[];break;case"textarea":a=Mx(e,a),n=Mx(e,n),i=[];break;default:typeof a.onClick!="function"&&typeof n.onClick=="function"&&(e.onclick=sp)}Ox(r,n);var o;r=null;for(u in a)if(!n.hasOwnProperty(u)&&a.hasOwnProperty(u)&&a[u]!=null)if(u==="style"){var s=a[u];for(o in s)s.hasOwnProperty(o)&&(r||(r={}),r[o]="")}else u!=="dangerouslySetInnerHTML"&&u!=="children"&&u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&u!=="autoFocus"&&(Nf.hasOwnProperty(u)?i||(i=[]):(i=i||[]).push(u,null));for(u in n){var l=n[u];if(s=a!=null?a[u]:void 0,n.hasOwnProperty(u)&&l!==s&&(l!=null||s!=null))if(u==="style")if(s){for(o in s)!s.hasOwnProperty(o)||l&&l.hasOwnProperty(o)||(r||(r={}),r[o]="");for(o in l)l.hasOwnProperty(o)&&s[o]!==l[o]&&(r||(r={}),r[o]=l[o])}else r||(i||(i=[]),i.push(u,r)),r=l;else u==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,s=s?s.__html:void 0,l!=null&&s!==l&&(i=i||[]).push(u,l)):u==="children"?typeof l!="string"&&typeof l!="number"||(i=i||[]).push(u,""+l):u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&(Nf.hasOwnProperty(u)?(l!=null&&u==="onScroll"&&vn("scroll",e),i||s===l||(i=[])):(i=i||[]).push(u,l))}r&&(i=i||[]).push("style",r);var u=i;(t.updateQueue=u)&&(t.flags|=4)}};lP=function(e,t,r,n){r!==n&&(t.flags|=4)};function Wd(e,t){if(!_n)switch(e.tailMode){case"hidden":t=e.tail;for(var r=null;t!==null;)t.alternate!==null&&(r=t),t=t.sibling;r===null?e.tail=null:r.sibling=null;break;case"collapsed":r=e.tail;for(var n=null;r!==null;)r.alternate!==null&&(n=r),r=r.sibling;n===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:n.sibling=null}}function Ea(e){var t=e.alternate!==null&&e.alternate.child===e.child,r=0,n=0;if(t)for(var a=e.child;a!==null;)r|=a.lanes|a.childLanes,n|=a.subtreeFlags&14680064,n|=a.flags&14680064,a.return=e,a=a.sibling;else for(a=e.child;a!==null;)r|=a.lanes|a.childLanes,n|=a.subtreeFlags,n|=a.flags,a.return=e,a=a.sibling;return e.subtreeFlags|=n,e.childLanes=r,t}function dE(e,t,r){var n=t.pendingProps;switch(vb(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Ea(t),null;case 1:return fi(t.type)&&lp(),Ea(t),null;case 3:return n=t.stateNode,bu(),kn(di),kn($a),Mb(),n.pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),(e===null||e.child===null)&&(oh(t)?t.flags|=4:e===null||e.memoizedState.isDehydrated&&!(t.flags&256)||(t.flags|=1024,fo!==null&&(dv(fo),fo=null))),nv(e,t),Ea(t),null;case 5:Cb(t);var a=Bl(Uf.current);if(r=t.type,e!==null&&t.stateNode!=null)sP(e,t,r,n,a),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!n){if(t.stateNode===null)throw Error(Fe(166));return Ea(t),null}if(e=Bl(Io.current),oh(t)){n=t.stateNode,r=t.type;var i=t.memoizedProps;switch(n[No]=t,n[Bf]=i,e=(t.mode&1)!==0,r){case"dialog":vn("cancel",n),vn("close",n);break;case"iframe":case"object":case"embed":vn("load",n);break;case"video":case"audio":for(a=0;a<cf.length;a++)vn(cf[a],n);break;case"source":vn("error",n);break;case"img":case"image":case"link":vn("error",n),vn("load",n);break;case"details":vn("toggle",n);break;case"input":Mw(n,i),vn("invalid",n);break;case"select":n._wrapperState={wasMultiple:!!i.multiple},vn("invalid",n);break;case"textarea":Ow(n,i),vn("invalid",n)}Ox(r,i),a=null;for(var o in i)if(i.hasOwnProperty(o)){var s=i[o];o==="children"?typeof s=="string"?n.textContent!==s&&(i.suppressHydrationWarning!==!0&&ih(n.textContent,s,e),a=["children",s]):typeof s=="number"&&n.textContent!==""+s&&(i.suppressHydrationWarning!==!0&&ih(n.textContent,s,e),a=["children",""+s]):Nf.hasOwnProperty(o)&&s!=null&&o==="onScroll"&&vn("scroll",n)}switch(r){case"input":Z0(n),Nw(n,i,!0);break;case"textarea":Z0(n),Aw(n);break;case"select":case"option":break;default:typeof i.onClick=="function"&&(n.onclick=sp)}n=a,t.updateQueue=n,n!==null&&(t.flags|=4)}else{o=a.nodeType===9?a:a.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=D_(r)),e==="http://www.w3.org/1999/xhtml"?r==="script"?(e=o.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof n.is=="string"?e=o.createElement(r,{is:n.is}):(e=o.createElement(r),r==="select"&&(o=e,n.multiple?o.multiple=!0:n.size&&(o.size=n.size))):e=o.createElementNS(e,r),e[No]=t,e[Bf]=n,oP(e,t,!1,!1),t.stateNode=e;e:{switch(o=Ax(r,n),r){case"dialog":vn("cancel",e),vn("close",e),a=n;break;case"iframe":case"object":case"embed":vn("load",e),a=n;break;case"video":case"audio":for(a=0;a<cf.length;a++)vn(cf[a],e);a=n;break;case"source":vn("error",e),a=n;break;case"img":case"image":case"link":vn("error",e),vn("load",e),a=n;break;case"details":vn("toggle",e),a=n;break;case"input":Mw(e,n),a=jx(e,n),vn("invalid",e);break;case"option":a=n;break;case"select":e._wrapperState={wasMultiple:!!n.multiple},a=En({},n,{value:void 0}),vn("invalid",e);break;case"textarea":Ow(e,n),a=Mx(e,n),vn("invalid",e);break;default:a=n}Ox(r,a),s=a;for(i in s)if(s.hasOwnProperty(i)){var l=s[i];i==="style"?B_(e,l):i==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,l!=null&&$_(e,l)):i==="children"?typeof l=="string"?(r!=="textarea"||l!=="")&&Of(e,l):typeof l=="number"&&Of(e,""+l):i!=="suppressContentEditableWarning"&&i!=="suppressHydrationWarning"&&i!=="autoFocus"&&(Nf.hasOwnProperty(i)?l!=null&&i==="onScroll"&&vn("scroll",e):l!=null&&ab(e,i,l,o))}switch(r){case"input":Z0(e),Nw(e,n,!1);break;case"textarea":Z0(e),Aw(e);break;case"option":n.value!=null&&e.setAttribute("value",""+pl(n.value));break;case"select":e.multiple=!!n.multiple,i=n.value,i!=null?iu(e,!!n.multiple,i,!1):n.defaultValue!=null&&iu(e,!!n.multiple,n.defaultValue,!0);break;default:typeof a.onClick=="function"&&(e.onclick=sp)}switch(r){case"button":case"input":case"select":case"textarea":n=!!n.autoFocus;break e;case"img":n=!0;break e;default:n=!1}}n&&(t.flags|=4)}t.ref!==null&&(t.flags|=512,t.flags|=2097152)}return Ea(t),null;case 6:if(e&&t.stateNode!=null)lP(e,t,e.memoizedProps,n);else{if(typeof n!="string"&&t.stateNode===null)throw Error(Fe(166));if(r=Bl(Uf.current),Bl(Io.current),oh(t)){if(n=t.stateNode,r=t.memoizedProps,n[No]=t,(i=n.nodeValue!==r)&&(e=Pi,e!==null))switch(e.tag){case 3:ih(n.nodeValue,r,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&ih(n.nodeValue,r,(e.mode&1)!==0)}i&&(t.flags|=4)}else n=(r.nodeType===9?r:r.ownerDocument).createTextNode(n),n[No]=t,t.stateNode=n}return Ea(t),null;case 13:if(kn(On),n=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(_n&&ji!==null&&t.mode&1&&!(t.flags&128))Pj(),xu(),t.flags|=98560,i=!1;else if(i=oh(t),n!==null&&n.dehydrated!==null){if(e===null){if(!i)throw Error(Fe(318));if(i=t.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(Fe(317));i[No]=t}else xu(),!(t.flags&128)&&(t.memoizedState=null),t.flags|=4;Ea(t),i=!1}else fo!==null&&(dv(fo),fo=null),i=!0;if(!i)return t.flags&65536?t:null}return t.flags&128?(t.lanes=r,t):(n=n!==null,n!==(e!==null&&e.memoizedState!==null)&&n&&(t.child.flags|=8192,t.mode&1&&(e===null||On.current&1?oa===0&&(oa=3):Fb())),t.updateQueue!==null&&(t.flags|=4),Ea(t),null);case 4:return bu(),nv(e,t),e===null&&$f(t.stateNode.containerInfo),Ea(t),null;case 10:return Sb(t.type._context),Ea(t),null;case 17:return fi(t.type)&&lp(),Ea(t),null;case 19:if(kn(On),i=t.memoizedState,i===null)return Ea(t),null;if(n=(t.flags&128)!==0,o=i.rendering,o===null)if(n)Wd(i,!1);else{if(oa!==0||e!==null&&e.flags&128)for(e=t.child;e!==null;){if(o=gp(e),o!==null){for(t.flags|=128,Wd(i,!1),n=o.updateQueue,n!==null&&(t.updateQueue=n,t.flags|=4),t.subtreeFlags=0,n=r,r=t.child;r!==null;)i=r,e=n,i.flags&=14680066,o=i.alternate,o===null?(i.childLanes=0,i.lanes=e,i.child=null,i.subtreeFlags=0,i.memoizedProps=null,i.memoizedState=null,i.updateQueue=null,i.dependencies=null,i.stateNode=null):(i.childLanes=o.childLanes,i.lanes=o.lanes,i.child=o.child,i.subtreeFlags=0,i.deletions=null,i.memoizedProps=o.memoizedProps,i.memoizedState=o.memoizedState,i.updateQueue=o.updateQueue,i.type=o.type,e=o.dependencies,i.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),r=r.sibling;return mn(On,On.current&1|2),t.child}e=e.sibling}i.tail!==null&&Fn()>ku&&(t.flags|=128,n=!0,Wd(i,!1),t.lanes=4194304)}else{if(!n)if(e=gp(o),e!==null){if(t.flags|=128,n=!0,r=e.updateQueue,r!==null&&(t.updateQueue=r,t.flags|=4),Wd(i,!0),i.tail===null&&i.tailMode==="hidden"&&!o.alternate&&!_n)return Ea(t),null}else 2*Fn()-i.renderingStartTime>ku&&r!==1073741824&&(t.flags|=128,n=!0,Wd(i,!1),t.lanes=4194304);i.isBackwards?(o.sibling=t.child,t.child=o):(r=i.last,r!==null?r.sibling=o:t.child=o,i.last=o)}return i.tail!==null?(t=i.tail,i.rendering=t,i.tail=t.sibling,i.renderingStartTime=Fn(),t.sibling=null,r=On.current,mn(On,n?r&1|2:r&1),t):(Ea(t),null);case 22:case 23:return Bb(),n=t.memoizedState!==null,e!==null&&e.memoizedState!==null!==n&&(t.flags|=8192),n&&t.mode&1?ki&1073741824&&(Ea(t),t.subtreeFlags&6&&(t.flags|=8192)):Ea(t),null;case 24:return null;case 25:return null}throw Error(Fe(156,t.tag))}function fE(e,t){switch(vb(t),t.tag){case 1:return fi(t.type)&&lp(),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return bu(),kn(di),kn($a),Mb(),e=t.flags,e&65536&&!(e&128)?(t.flags=e&-65537|128,t):null;case 5:return Cb(t),null;case 13:if(kn(On),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(Fe(340));xu()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return kn(On),null;case 4:return bu(),null;case 10:return Sb(t.type._context),null;case 22:case 23:return Bb(),null;case 24:return null;default:return null}}var ch=!1,Ia=!1,hE=typeof WeakSet=="function"?WeakSet:Set,dt=null;function eu(e,t){var r=e.ref;if(r!==null)if(typeof r=="function")try{r(null)}catch(n){Dn(e,t,n)}else r.current=null}function av(e,t,r){try{r()}catch(n){Dn(e,t,n)}}var bk=!1;function pE(e,t){if(Ux=ap,e=hj(),yb(e)){if("selectionStart"in e)var r={start:e.selectionStart,end:e.selectionEnd};else e:{r=(r=e.ownerDocument)&&r.defaultView||window;var n=r.getSelection&&r.getSelection();if(n&&n.rangeCount!==0){r=n.anchorNode;var a=n.anchorOffset,i=n.focusNode;n=n.focusOffset;try{r.nodeType,i.nodeType}catch{r=null;break e}var o=0,s=-1,l=-1,u=0,d=0,f=e,h=null;t:for(;;){for(var g;f!==r||a!==0&&f.nodeType!==3||(s=o+a),f!==i||n!==0&&f.nodeType!==3||(l=o+n),f.nodeType===3&&(o+=f.nodeValue.length),(g=f.firstChild)!==null;)h=f,f=g;for(;;){if(f===e)break t;if(h===r&&++u===a&&(s=o),h===i&&++d===n&&(l=o),(g=f.nextSibling)!==null)break;f=h,h=f.parentNode}f=g}r=s===-1||l===-1?null:{start:s,end:l}}else r=null}r=r||{start:0,end:0}}else r=null;for(Gx={focusedElem:e,selectionRange:r},ap=!1,dt=t;dt!==null;)if(t=dt,e=t.child,(t.subtreeFlags&1028)!==0&&e!==null)e.return=t,dt=e;else for(;dt!==null;){t=dt;try{var v=t.alternate;if(t.flags&1024)switch(t.tag){case 0:case 11:case 15:break;case 1:if(v!==null){var w=v.memoizedProps,b=v.memoizedState,x=t.stateNode,y=x.getSnapshotBeforeUpdate(t.elementType===t.type?w:oo(t.type,w),b);x.__reactInternalSnapshotBeforeUpdate=y}break;case 3:var _=t.stateNode.containerInfo;_.nodeType===1?_.textContent="":_.nodeType===9&&_.documentElement&&_.removeChild(_.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(Fe(163))}}catch(j){Dn(t,t.return,j)}if(e=t.sibling,e!==null){e.return=t.return,dt=e;break}dt=t.return}return v=bk,bk=!1,v}function yf(e,t,r){var n=t.updateQueue;if(n=n!==null?n.lastEffect:null,n!==null){var a=n=n.next;do{if((a.tag&e)===e){var i=a.destroy;a.destroy=void 0,i!==void 0&&av(t,r,i)}a=a.next}while(a!==n)}}function Gg(e,t){if(t=t.updateQueue,t=t!==null?t.lastEffect:null,t!==null){var r=t=t.next;do{if((r.tag&e)===e){var n=r.create;r.destroy=n()}r=r.next}while(r!==t)}}function iv(e){var t=e.ref;if(t!==null){var r=e.stateNode;switch(e.tag){case 5:e=r;break;default:e=r}typeof t=="function"?t(e):t.current=e}}function cP(e){var t=e.alternate;t!==null&&(e.alternate=null,cP(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&(delete t[No],delete t[Bf],delete t[Vx],delete t[qA],delete t[ZA])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function uP(e){return e.tag===5||e.tag===3||e.tag===4}function wk(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||uP(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function ov(e,t,r){var n=e.tag;if(n===5||n===6)e=e.stateNode,t?r.nodeType===8?r.parentNode.insertBefore(e,t):r.insertBefore(e,t):(r.nodeType===8?(t=r.parentNode,t.insertBefore(e,r)):(t=r,t.appendChild(e)),r=r._reactRootContainer,r!=null||t.onclick!==null||(t.onclick=sp));else if(n!==4&&(e=e.child,e!==null))for(ov(e,t,r),e=e.sibling;e!==null;)ov(e,t,r),e=e.sibling}function sv(e,t,r){var n=e.tag;if(n===5||n===6)e=e.stateNode,t?r.insertBefore(e,t):r.appendChild(e);else if(n!==4&&(e=e.child,e!==null))for(sv(e,t,r),e=e.sibling;e!==null;)sv(e,t,r),e=e.sibling}var ka=null,lo=!1;function Ts(e,t,r){for(r=r.child;r!==null;)dP(e,t,r),r=r.sibling}function dP(e,t,r){if(To&&typeof To.onCommitFiberUnmount=="function")try{To.onCommitFiberUnmount(Ig,r)}catch{}switch(r.tag){case 5:Ia||eu(r,t);case 6:var n=ka,a=lo;ka=null,Ts(e,t,r),ka=n,lo=a,ka!==null&&(lo?(e=ka,r=r.stateNode,e.nodeType===8?e.parentNode.removeChild(r):e.removeChild(r)):ka.removeChild(r.stateNode));break;case 18:ka!==null&&(lo?(e=ka,r=r.stateNode,e.nodeType===8?py(e.parentNode,r):e.nodeType===1&&py(e,r),If(e)):py(ka,r.stateNode));break;case 4:n=ka,a=lo,ka=r.stateNode.containerInfo,lo=!0,Ts(e,t,r),ka=n,lo=a;break;case 0:case 11:case 14:case 15:if(!Ia&&(n=r.updateQueue,n!==null&&(n=n.lastEffect,n!==null))){a=n=n.next;do{var i=a,o=i.destroy;i=i.tag,o!==void 0&&(i&2||i&4)&&av(r,t,o),a=a.next}while(a!==n)}Ts(e,t,r);break;case 1:if(!Ia&&(eu(r,t),n=r.stateNode,typeof n.componentWillUnmount=="function"))try{n.props=r.memoizedProps,n.state=r.memoizedState,n.componentWillUnmount()}catch(s){Dn(r,t,s)}Ts(e,t,r);break;case 21:Ts(e,t,r);break;case 22:r.mode&1?(Ia=(n=Ia)||r.memoizedState!==null,Ts(e,t,r),Ia=n):Ts(e,t,r);break;default:Ts(e,t,r)}}function kk(e){var t=e.updateQueue;if(t!==null){e.updateQueue=null;var r=e.stateNode;r===null&&(r=e.stateNode=new hE),t.forEach(function(n){var a=SE.bind(null,e,n);r.has(n)||(r.add(n),n.then(a,a))})}}function no(e,t){var r=t.deletions;if(r!==null)for(var n=0;n<r.length;n++){var a=r[n];try{var i=e,o=t,s=o;e:for(;s!==null;){switch(s.tag){case 5:ka=s.stateNode,lo=!1;break e;case 3:ka=s.stateNode.containerInfo,lo=!0;break e;case 4:ka=s.stateNode.containerInfo,lo=!0;break e}s=s.return}if(ka===null)throw Error(Fe(160));dP(i,o,a),ka=null,lo=!1;var l=a.alternate;l!==null&&(l.return=null),a.return=null}catch(u){Dn(a,t,u)}}if(t.subtreeFlags&12854)for(t=t.child;t!==null;)fP(t,e),t=t.sibling}function fP(e,t){var r=e.alternate,n=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(no(t,e),Co(e),n&4){try{yf(3,e,e.return),Gg(3,e)}catch(w){Dn(e,e.return,w)}try{yf(5,e,e.return)}catch(w){Dn(e,e.return,w)}}break;case 1:no(t,e),Co(e),n&512&&r!==null&&eu(r,r.return);break;case 5:if(no(t,e),Co(e),n&512&&r!==null&&eu(r,r.return),e.flags&32){var a=e.stateNode;try{Of(a,"")}catch(w){Dn(e,e.return,w)}}if(n&4&&(a=e.stateNode,a!=null)){var i=e.memoizedProps,o=r!==null?r.memoizedProps:i,s=e.type,l=e.updateQueue;if(e.updateQueue=null,l!==null)try{s==="input"&&i.type==="radio"&&i.name!=null&&I_(a,i),Ax(s,o);var u=Ax(s,i);for(o=0;o<l.length;o+=2){var d=l[o],f=l[o+1];d==="style"?B_(a,f):d==="dangerouslySetInnerHTML"?$_(a,f):d==="children"?Of(a,f):ab(a,d,f,u)}switch(s){case"input":Px(a,i);break;case"textarea":R_(a,i);break;case"select":var h=a._wrapperState.wasMultiple;a._wrapperState.wasMultiple=!!i.multiple;var g=i.value;g!=null?iu(a,!!i.multiple,g,!1):h!==!!i.multiple&&(i.defaultValue!=null?iu(a,!!i.multiple,i.defaultValue,!0):iu(a,!!i.multiple,i.multiple?[]:"",!1))}a[Bf]=i}catch(w){Dn(e,e.return,w)}}break;case 6:if(no(t,e),Co(e),n&4){if(e.stateNode===null)throw Error(Fe(162));a=e.stateNode,i=e.memoizedProps;try{a.nodeValue=i}catch(w){Dn(e,e.return,w)}}break;case 3:if(no(t,e),Co(e),n&4&&r!==null&&r.memoizedState.isDehydrated)try{If(t.containerInfo)}catch(w){Dn(e,e.return,w)}break;case 4:no(t,e),Co(e);break;case 13:no(t,e),Co(e),a=e.child,a.flags&8192&&(i=a.memoizedState!==null,a.stateNode.isHidden=i,!i||a.alternate!==null&&a.alternate.memoizedState!==null||($b=Fn())),n&4&&kk(e);break;case 22:if(d=r!==null&&r.memoizedState!==null,e.mode&1?(Ia=(u=Ia)||d,no(t,e),Ia=u):no(t,e),Co(e),n&8192){if(u=e.memoizedState!==null,(e.stateNode.isHidden=u)&&!d&&e.mode&1)for(dt=e,d=e.child;d!==null;){for(f=dt=d;dt!==null;){switch(h=dt,g=h.child,h.tag){case 0:case 11:case 14:case 15:yf(4,h,h.return);break;case 1:eu(h,h.return);var v=h.stateNode;if(typeof v.componentWillUnmount=="function"){n=h,r=h.return;try{t=n,v.props=t.memoizedProps,v.state=t.memoizedState,v.componentWillUnmount()}catch(w){Dn(n,r,w)}}break;case 5:eu(h,h.return);break;case 22:if(h.memoizedState!==null){_k(f);continue}}g!==null?(g.return=h,dt=g):_k(f)}d=d.sibling}e:for(d=null,f=e;;){if(f.tag===5){if(d===null){d=f;try{a=f.stateNode,u?(i=a.style,typeof i.setProperty=="function"?i.setProperty("display","none","important"):i.display="none"):(s=f.stateNode,l=f.memoizedProps.style,o=l!=null&&l.hasOwnProperty("display")?l.display:null,s.style.display=L_("display",o))}catch(w){Dn(e,e.return,w)}}}else if(f.tag===6){if(d===null)try{f.stateNode.nodeValue=u?"":f.memoizedProps}catch(w){Dn(e,e.return,w)}}else if((f.tag!==22&&f.tag!==23||f.memoizedState===null||f===e)&&f.child!==null){f.child.return=f,f=f.child;continue}if(f===e)break e;for(;f.sibling===null;){if(f.return===null||f.return===e)break e;d===f&&(d=null),f=f.return}d===f&&(d=null),f.sibling.return=f.return,f=f.sibling}}break;case 19:no(t,e),Co(e),n&4&&kk(e);break;case 21:break;default:no(t,e),Co(e)}}function Co(e){var t=e.flags;if(t&2){try{e:{for(var r=e.return;r!==null;){if(uP(r)){var n=r;break e}r=r.return}throw Error(Fe(160))}switch(n.tag){case 5:var a=n.stateNode;n.flags&32&&(Of(a,""),n.flags&=-33);var i=wk(e);sv(e,i,a);break;case 3:case 4:var o=n.stateNode.containerInfo,s=wk(e);ov(e,s,o);break;default:throw Error(Fe(161))}}catch(l){Dn(e,e.return,l)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function gE(e,t,r){dt=e,hP(e)}function hP(e,t,r){for(var n=(e.mode&1)!==0;dt!==null;){var a=dt,i=a.child;if(a.tag===22&&n){var o=a.memoizedState!==null||ch;if(!o){var s=a.alternate,l=s!==null&&s.memoizedState!==null||Ia;s=ch;var u=Ia;if(ch=o,(Ia=l)&&!u)for(dt=a;dt!==null;)o=dt,l=o.child,o.tag===22&&o.memoizedState!==null?jk(a):l!==null?(l.return=o,dt=l):jk(a);for(;i!==null;)dt=i,hP(i),i=i.sibling;dt=a,ch=s,Ia=u}Sk(e)}else a.subtreeFlags&8772&&i!==null?(i.return=a,dt=i):Sk(e)}}function Sk(e){for(;dt!==null;){var t=dt;if(t.flags&8772){var r=t.alternate;try{if(t.flags&8772)switch(t.tag){case 0:case 11:case 15:Ia||Gg(5,t);break;case 1:var n=t.stateNode;if(t.flags&4&&!Ia)if(r===null)n.componentDidMount();else{var a=t.elementType===t.type?r.memoizedProps:oo(t.type,r.memoizedProps);n.componentDidUpdate(a,r.memoizedState,n.__reactInternalSnapshotBeforeUpdate)}var i=t.updateQueue;i!==null&&sk(t,i,n);break;case 3:var o=t.updateQueue;if(o!==null){if(r=null,t.child!==null)switch(t.child.tag){case 5:r=t.child.stateNode;break;case 1:r=t.child.stateNode}sk(t,o,r)}break;case 5:var s=t.stateNode;if(r===null&&t.flags&4){r=s;var l=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":l.autoFocus&&r.focus();break;case"img":l.src&&(r.src=l.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(t.memoizedState===null){var u=t.alternate;if(u!==null){var d=u.memoizedState;if(d!==null){var f=d.dehydrated;f!==null&&If(f)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(Fe(163))}Ia||t.flags&512&&iv(t)}catch(h){Dn(t,t.return,h)}}if(t===e){dt=null;break}if(r=t.sibling,r!==null){r.return=t.return,dt=r;break}dt=t.return}}function _k(e){for(;dt!==null;){var t=dt;if(t===e){dt=null;break}var r=t.sibling;if(r!==null){r.return=t.return,dt=r;break}dt=t.return}}function jk(e){for(;dt!==null;){var t=dt;try{switch(t.tag){case 0:case 11:case 15:var r=t.return;try{Gg(4,t)}catch(l){Dn(t,r,l)}break;case 1:var n=t.stateNode;if(typeof n.componentDidMount=="function"){var a=t.return;try{n.componentDidMount()}catch(l){Dn(t,a,l)}}var i=t.return;try{iv(t)}catch(l){Dn(t,i,l)}break;case 5:var o=t.return;try{iv(t)}catch(l){Dn(t,o,l)}}}catch(l){Dn(t,t.return,l)}if(t===e){dt=null;break}var s=t.sibling;if(s!==null){s.return=t.return,dt=s;break}dt=t.return}}var mE=Math.ceil,xp=ms.ReactCurrentDispatcher,Rb=ms.ReactCurrentOwner,zi=ms.ReactCurrentBatchConfig,Gr=0,ga=null,Kn=null,ja=0,ki=0,tu=yl(0),oa=0,Vf=null,ac=0,zg=0,Db=0,xf=null,si=null,$b=0,ku=1/0,Jo=null,vp=!1,lv=null,ll=null,uh=!1,Xs=null,bp=0,vf=0,cv=null,Hh=-1,Xh=0;function qa(){return Gr&6?Fn():Hh!==-1?Hh:Hh=Fn()}function cl(e){return e.mode&1?Gr&2&&ja!==0?ja&-ja:QA.transition!==null?(Xh===0&&(Xh=Z_()),Xh):(e=rn,e!==0||(e=window.event,e=e===void 0?16:aj(e.type)),e):1}function xo(e,t,r,n){if(50<vf)throw vf=0,cv=null,Error(Fe(185));A0(e,r,n),(!(Gr&2)||e!==ga)&&(e===ga&&(!(Gr&2)&&(zg|=r),oa===4&&Ws(e,ja)),hi(e,n),r===1&&Gr===0&&!(t.mode&1)&&(ku=Fn()+500,Bg&&xl()))}function hi(e,t){var r=e.callbackNode;Q6(e,t);var n=np(e,e===ga?ja:0);if(n===0)r!==null&&Iw(r),e.callbackNode=null,e.callbackPriority=0;else if(t=n&-n,e.callbackPriority!==t){if(r!=null&&Iw(r),t===1)e.tag===0?JA(Pk.bind(null,e)):Sj(Pk.bind(null,e)),KA(function(){!(Gr&6)&&xl()}),r=null;else{switch(J_(n)){case 1:r=cb;break;case 4:r=Y_;break;case 16:r=rp;break;case 536870912:r=q_;break;default:r=rp}r=wP(r,pP.bind(null,e))}e.callbackPriority=t,e.callbackNode=r}}function pP(e,t){if(Hh=-1,Xh=0,Gr&6)throw Error(Fe(327));var r=e.callbackNode;if(uu()&&e.callbackNode!==r)return null;var n=np(e,e===ga?ja:0);if(n===0)return null;if(n&30||n&e.expiredLanes||t)t=wp(e,n);else{t=n;var a=Gr;Gr|=2;var i=mP();(ga!==e||ja!==t)&&(Jo=null,ku=Fn()+500,Yl(e,t));do try{vE();break}catch(s){gP(e,s)}while(!0);kb(),xp.current=i,Gr=a,Kn!==null?t=0:(ga=null,ja=0,t=oa)}if(t!==0){if(t===2&&(a=Dx(e),a!==0&&(n=a,t=uv(e,a))),t===1)throw r=Vf,Yl(e,0),Ws(e,n),hi(e,Fn()),r;if(t===6)Ws(e,n);else{if(a=e.current.alternate,!(n&30)&&!yE(a)&&(t=wp(e,n),t===2&&(i=Dx(e),i!==0&&(n=i,t=uv(e,i))),t===1))throw r=Vf,Yl(e,0),Ws(e,n),hi(e,Fn()),r;switch(e.finishedWork=a,e.finishedLanes=n,t){case 0:case 1:throw Error(Fe(345));case 2:Tl(e,si,Jo);break;case 3:if(Ws(e,n),(n&130023424)===n&&(t=$b+500-Fn(),10<t)){if(np(e,0)!==0)break;if(a=e.suspendedLanes,(a&n)!==n){qa(),e.pingedLanes|=e.suspendedLanes&a;break}e.timeoutHandle=Wx(Tl.bind(null,e,si,Jo),t);break}Tl(e,si,Jo);break;case 4:if(Ws(e,n),(n&4194240)===n)break;for(t=e.eventTimes,a=-1;0<n;){var o=31-yo(n);i=1<<o,o=t[o],o>a&&(a=o),n&=~i}if(n=a,n=Fn()-n,n=(120>n?120:480>n?480:1080>n?1080:1920>n?1920:3e3>n?3e3:4320>n?4320:1960*mE(n/1960))-n,10<n){e.timeoutHandle=Wx(Tl.bind(null,e,si,Jo),n);break}Tl(e,si,Jo);break;case 5:Tl(e,si,Jo);break;default:throw Error(Fe(329))}}}return hi(e,Fn()),e.callbackNode===r?pP.bind(null,e):null}function uv(e,t){var r=xf;return e.current.memoizedState.isDehydrated&&(Yl(e,t).flags|=256),e=wp(e,t),e!==2&&(t=si,si=r,t!==null&&dv(t)),e}function dv(e){si===null?si=e:si.push.apply(si,e)}function yE(e){for(var t=e;;){if(t.flags&16384){var r=t.updateQueue;if(r!==null&&(r=r.stores,r!==null))for(var n=0;n<r.length;n++){var a=r[n],i=a.getSnapshot;a=a.value;try{if(!vo(i(),a))return!1}catch{return!1}}}if(r=t.child,t.subtreeFlags&16384&&r!==null)r.return=t,t=r;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function Ws(e,t){for(t&=~Db,t&=~zg,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var r=31-yo(t),n=1<<r;e[r]=-1,t&=~n}}function Pk(e){if(Gr&6)throw Error(Fe(327));uu();var t=np(e,0);if(!(t&1))return hi(e,Fn()),null;var r=wp(e,t);if(e.tag!==0&&r===2){var n=Dx(e);n!==0&&(t=n,r=uv(e,n))}if(r===1)throw r=Vf,Yl(e,0),Ws(e,t),hi(e,Fn()),r;if(r===6)throw Error(Fe(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,Tl(e,si,Jo),hi(e,Fn()),null}function Lb(e,t){var r=Gr;Gr|=1;try{return e(t)}finally{Gr=r,Gr===0&&(ku=Fn()+500,Bg&&xl())}}function ic(e){Xs!==null&&Xs.tag===0&&!(Gr&6)&&uu();var t=Gr;Gr|=1;var r=zi.transition,n=rn;try{if(zi.transition=null,rn=1,e)return e()}finally{rn=n,zi.transition=r,Gr=t,!(Gr&6)&&xl()}}function Bb(){ki=tu.current,kn(tu)}function Yl(e,t){e.finishedWork=null,e.finishedLanes=0;var r=e.timeoutHandle;if(r!==-1&&(e.timeoutHandle=-1,XA(r)),Kn!==null)for(r=Kn.return;r!==null;){var n=r;switch(vb(n),n.tag){case 1:n=n.type.childContextTypes,n!=null&&lp();break;case 3:bu(),kn(di),kn($a),Mb();break;case 5:Cb(n);break;case 4:bu();break;case 13:kn(On);break;case 19:kn(On);break;case 10:Sb(n.type._context);break;case 22:case 23:Bb()}r=r.return}if(ga=e,Kn=e=ul(e.current,null),ja=ki=t,oa=0,Vf=null,Db=zg=ac=0,si=xf=null,Ll!==null){for(t=0;t<Ll.length;t++)if(r=Ll[t],n=r.interleaved,n!==null){r.interleaved=null;var a=n.next,i=r.pending;if(i!==null){var o=i.next;i.next=a,n.next=o}r.pending=n}Ll=null}return e}function gP(e,t){do{var r=Kn;try{if(kb(),zh.current=yp,mp){for(var n=An.memoizedState;n!==null;){var a=n.queue;a!==null&&(a.pending=null),n=n.next}mp=!1}if(nc=0,pa=na=An=null,mf=!1,Gf=0,Rb.current=null,r===null||r.return===null){oa=1,Vf=t,Kn=null;break}e:{var i=e,o=r.return,s=r,l=t;if(t=ja,s.flags|=32768,l!==null&&typeof l=="object"&&typeof l.then=="function"){var u=l,d=s,f=d.tag;if(!(d.mode&1)&&(f===0||f===11||f===15)){var h=d.alternate;h?(d.updateQueue=h.updateQueue,d.memoizedState=h.memoizedState,d.lanes=h.lanes):(d.updateQueue=null,d.memoizedState=null)}var g=hk(o);if(g!==null){g.flags&=-257,pk(g,o,s,i,t),g.mode&1&&fk(i,u,t),t=g,l=u;var v=t.updateQueue;if(v===null){var w=new Set;w.add(l),t.updateQueue=w}else v.add(l);break e}else{if(!(t&1)){fk(i,u,t),Fb();break e}l=Error(Fe(426))}}else if(_n&&s.mode&1){var b=hk(o);if(b!==null){!(b.flags&65536)&&(b.flags|=256),pk(b,o,s,i,t),bb(wu(l,s));break e}}i=l=wu(l,s),oa!==4&&(oa=2),xf===null?xf=[i]:xf.push(i),i=o;do{switch(i.tag){case 3:i.flags|=65536,t&=-t,i.lanes|=t;var x=Jj(i,l,t);ok(i,x);break e;case 1:s=l;var y=i.type,_=i.stateNode;if(!(i.flags&128)&&(typeof y.getDerivedStateFromError=="function"||_!==null&&typeof _.componentDidCatch=="function"&&(ll===null||!ll.has(_)))){i.flags|=65536,t&=-t,i.lanes|=t;var j=Qj(i,s,t);ok(i,j);break e}}i=i.return}while(i!==null)}xP(r)}catch(S){t=S,Kn===r&&r!==null&&(Kn=r=r.return);continue}break}while(!0)}function mP(){var e=xp.current;return xp.current=yp,e===null?yp:e}function Fb(){(oa===0||oa===3||oa===2)&&(oa=4),ga===null||!(ac&268435455)&&!(zg&268435455)||Ws(ga,ja)}function wp(e,t){var r=Gr;Gr|=2;var n=mP();(ga!==e||ja!==t)&&(Jo=null,Yl(e,t));do try{xE();break}catch(a){gP(e,a)}while(!0);if(kb(),Gr=r,xp.current=n,Kn!==null)throw Error(Fe(261));return ga=null,ja=0,oa}function xE(){for(;Kn!==null;)yP(Kn)}function vE(){for(;Kn!==null&&!W6();)yP(Kn)}function yP(e){var t=bP(e.alternate,e,ki);e.memoizedProps=e.pendingProps,t===null?xP(e):Kn=t,Rb.current=null}function xP(e){var t=e;do{var r=t.alternate;if(e=t.return,t.flags&32768){if(r=fE(r,t),r!==null){r.flags&=32767,Kn=r;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{oa=6,Kn=null;return}}else if(r=dE(r,t,ki),r!==null){Kn=r;return}if(t=t.sibling,t!==null){Kn=t;return}Kn=t=e}while(t!==null);oa===0&&(oa=5)}function Tl(e,t,r){var n=rn,a=zi.transition;try{zi.transition=null,rn=1,bE(e,t,r,n)}finally{zi.transition=a,rn=n}return null}function bE(e,t,r,n){do uu();while(Xs!==null);if(Gr&6)throw Error(Fe(327));r=e.finishedWork;var a=e.finishedLanes;if(r===null)return null;if(e.finishedWork=null,e.finishedLanes=0,r===e.current)throw Error(Fe(177));e.callbackNode=null,e.callbackPriority=0;var i=r.lanes|r.childLanes;if(eA(e,i),e===ga&&(Kn=ga=null,ja=0),!(r.subtreeFlags&2064)&&!(r.flags&2064)||uh||(uh=!0,wP(rp,function(){return uu(),null})),i=(r.flags&15990)!==0,r.subtreeFlags&15990||i){i=zi.transition,zi.transition=null;var o=rn;rn=1;var s=Gr;Gr|=4,Rb.current=null,pE(e,r),fP(r,e),FA(Gx),ap=!!Ux,Gx=Ux=null,e.current=r,gE(r),V6(),Gr=s,rn=o,zi.transition=i}else e.current=r;if(uh&&(uh=!1,Xs=e,bp=a),i=e.pendingLanes,i===0&&(ll=null),K6(r.stateNode),hi(e,Fn()),t!==null)for(n=e.onRecoverableError,r=0;r<t.length;r++)a=t[r],n(a.value,{componentStack:a.stack,digest:a.digest});if(vp)throw vp=!1,e=lv,lv=null,e;return bp&1&&e.tag!==0&&uu(),i=e.pendingLanes,i&1?e===cv?vf++:(vf=0,cv=e):vf=0,xl(),null}function uu(){if(Xs!==null){var e=J_(bp),t=zi.transition,r=rn;try{if(zi.transition=null,rn=16>e?16:e,Xs===null)var n=!1;else{if(e=Xs,Xs=null,bp=0,Gr&6)throw Error(Fe(331));var a=Gr;for(Gr|=4,dt=e.current;dt!==null;){var i=dt,o=i.child;if(dt.flags&16){var s=i.deletions;if(s!==null){for(var l=0;l<s.length;l++){var u=s[l];for(dt=u;dt!==null;){var d=dt;switch(d.tag){case 0:case 11:case 15:yf(8,d,i)}var f=d.child;if(f!==null)f.return=d,dt=f;else for(;dt!==null;){d=dt;var h=d.sibling,g=d.return;if(cP(d),d===u){dt=null;break}if(h!==null){h.return=g,dt=h;break}dt=g}}}var v=i.alternate;if(v!==null){var w=v.child;if(w!==null){v.child=null;do{var b=w.sibling;w.sibling=null,w=b}while(w!==null)}}dt=i}}if(i.subtreeFlags&2064&&o!==null)o.return=i,dt=o;else e:for(;dt!==null;){if(i=dt,i.flags&2048)switch(i.tag){case 0:case 11:case 15:yf(9,i,i.return)}var x=i.sibling;if(x!==null){x.return=i.return,dt=x;break e}dt=i.return}}var y=e.current;for(dt=y;dt!==null;){o=dt;var _=o.child;if(o.subtreeFlags&2064&&_!==null)_.return=o,dt=_;else e:for(o=y;dt!==null;){if(s=dt,s.flags&2048)try{switch(s.tag){case 0:case 11:case 15:Gg(9,s)}}catch(S){Dn(s,s.return,S)}if(s===o){dt=null;break e}var j=s.sibling;if(j!==null){j.return=s.return,dt=j;break e}dt=s.return}}if(Gr=a,xl(),To&&typeof To.onPostCommitFiberRoot=="function")try{To.onPostCommitFiberRoot(Ig,e)}catch{}n=!0}return n}finally{rn=r,zi.transition=t}}return!1}function Ck(e,t,r){t=wu(r,t),t=Jj(e,t,1),e=sl(e,t,1),t=qa(),e!==null&&(A0(e,1,t),hi(e,t))}function Dn(e,t,r){if(e.tag===3)Ck(e,e,r);else for(;t!==null;){if(t.tag===3){Ck(t,e,r);break}else if(t.tag===1){var n=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof n.componentDidCatch=="function"&&(ll===null||!ll.has(n))){e=wu(r,e),e=Qj(t,e,1),t=sl(t,e,1),e=qa(),t!==null&&(A0(t,1,e),hi(t,e));break}}t=t.return}}function wE(e,t,r){var n=e.pingCache;n!==null&&n.delete(t),t=qa(),e.pingedLanes|=e.suspendedLanes&r,ga===e&&(ja&r)===r&&(oa===4||oa===3&&(ja&130023424)===ja&&500>Fn()-$b?Yl(e,0):Db|=r),hi(e,t)}function vP(e,t){t===0&&(e.mode&1?(t=eh,eh<<=1,!(eh&130023424)&&(eh=4194304)):t=1);var r=qa();e=ds(e,t),e!==null&&(A0(e,t,r),hi(e,r))}function kE(e){var t=e.memoizedState,r=0;t!==null&&(r=t.retryLane),vP(e,r)}function SE(e,t){var r=0;switch(e.tag){case 13:var n=e.stateNode,a=e.memoizedState;a!==null&&(r=a.retryLane);break;case 19:n=e.stateNode;break;default:throw Error(Fe(314))}n!==null&&n.delete(t),vP(e,r)}var bP;bP=function(e,t,r){if(e!==null)if(e.memoizedProps!==t.pendingProps||di.current)ci=!0;else{if(!(e.lanes&r)&&!(t.flags&128))return ci=!1,uE(e,t,r);ci=!!(e.flags&131072)}else ci=!1,_n&&t.flags&1048576&&_j(t,dp,t.index);switch(t.lanes=0,t.tag){case 2:var n=t.type;Vh(e,t),e=t.pendingProps;var a=yu(t,$a.current);cu(t,r),a=Ob(null,t,n,e,a,r);var i=Ab();return t.flags|=1,typeof a=="object"&&a!==null&&typeof a.render=="function"&&a.$$typeof===void 0?(t.tag=1,t.memoizedState=null,t.updateQueue=null,fi(n)?(i=!0,cp(t)):i=!1,t.memoizedState=a.state!==null&&a.state!==void 0?a.state:null,jb(t),a.updater=Ug,t.stateNode=a,a._reactInternals=t,Zx(t,n,e,r),t=ev(null,t,n,!0,i,r)):(t.tag=0,_n&&i&&xb(t),Va(null,t,a,r),t=t.child),t;case 16:n=t.elementType;e:{switch(Vh(e,t),e=t.pendingProps,a=n._init,n=a(n._payload),t.type=n,a=t.tag=jE(n),e=oo(n,e),a){case 0:t=Qx(null,t,n,e,r);break e;case 1:t=yk(null,t,n,e,r);break e;case 11:t=gk(null,t,n,e,r);break e;case 14:t=mk(null,t,n,oo(n.type,e),r);break e}throw Error(Fe(306,n,""))}return t;case 0:return n=t.type,a=t.pendingProps,a=t.elementType===n?a:oo(n,a),Qx(e,t,n,a,r);case 1:return n=t.type,a=t.pendingProps,a=t.elementType===n?a:oo(n,a),yk(e,t,n,a,r);case 3:e:{if(nP(t),e===null)throw Error(Fe(387));n=t.pendingProps,i=t.memoizedState,a=i.element,Oj(e,t),pp(t,n,null,r);var o=t.memoizedState;if(n=o.element,i.isDehydrated)if(i={element:n,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},t.updateQueue.baseState=i,t.memoizedState=i,t.flags&256){a=wu(Error(Fe(423)),t),t=xk(e,t,n,r,a);break e}else if(n!==a){a=wu(Error(Fe(424)),t),t=xk(e,t,n,r,a);break e}else for(ji=ol(t.stateNode.containerInfo.firstChild),Pi=t,_n=!0,fo=null,r=Mj(t,null,n,r),t.child=r;r;)r.flags=r.flags&-3|4096,r=r.sibling;else{if(xu(),n===a){t=fs(e,t,r);break e}Va(e,t,n,r)}t=t.child}return t;case 5:return Aj(t),e===null&&Kx(t),n=t.type,a=t.pendingProps,i=e!==null?e.memoizedProps:null,o=a.children,zx(n,a)?o=null:i!==null&&zx(n,i)&&(t.flags|=32),rP(e,t),Va(e,t,o,r),t.child;case 6:return e===null&&Kx(t),null;case 13:return aP(e,t,r);case 4:return Pb(t,t.stateNode.containerInfo),n=t.pendingProps,e===null?t.child=vu(t,null,n,r):Va(e,t,n,r),t.child;case 11:return n=t.type,a=t.pendingProps,a=t.elementType===n?a:oo(n,a),gk(e,t,n,a,r);case 7:return Va(e,t,t.pendingProps,r),t.child;case 8:return Va(e,t,t.pendingProps.children,r),t.child;case 12:return Va(e,t,t.pendingProps.children,r),t.child;case 10:e:{if(n=t.type._context,a=t.pendingProps,i=t.memoizedProps,o=a.value,mn(fp,n._currentValue),n._currentValue=o,i!==null)if(vo(i.value,o)){if(i.children===a.children&&!di.current){t=fs(e,t,r);break e}}else for(i=t.child,i!==null&&(i.return=t);i!==null;){var s=i.dependencies;if(s!==null){o=i.child;for(var l=s.firstContext;l!==null;){if(l.context===n){if(i.tag===1){l=is(-1,r&-r),l.tag=2;var u=i.updateQueue;if(u!==null){u=u.shared;var d=u.pending;d===null?l.next=l:(l.next=d.next,d.next=l),u.pending=l}}i.lanes|=r,l=i.alternate,l!==null&&(l.lanes|=r),Yx(i.return,r,t),s.lanes|=r;break}l=l.next}}else if(i.tag===10)o=i.type===t.type?null:i.child;else if(i.tag===18){if(o=i.return,o===null)throw Error(Fe(341));o.lanes|=r,s=o.alternate,s!==null&&(s.lanes|=r),Yx(o,r,t),o=i.sibling}else o=i.child;if(o!==null)o.return=i;else for(o=i;o!==null;){if(o===t){o=null;break}if(i=o.sibling,i!==null){i.return=o.return,o=i;break}o=o.return}i=o}Va(e,t,a.children,r),t=t.child}return t;case 9:return a=t.type,n=t.pendingProps.children,cu(t,r),a=Vi(a),n=n(a),t.flags|=1,Va(e,t,n,r),t.child;case 14:return n=t.type,a=oo(n,t.pendingProps),a=oo(n.type,a),mk(e,t,n,a,r);case 15:return eP(e,t,t.type,t.pendingProps,r);case 17:return n=t.type,a=t.pendingProps,a=t.elementType===n?a:oo(n,a),Vh(e,t),t.tag=1,fi(n)?(e=!0,cp(t)):e=!1,cu(t,r),Zj(t,n,a),Zx(t,n,a,r),ev(null,t,n,!0,e,r);case 19:return iP(e,t,r);case 22:return tP(e,t,r)}throw Error(Fe(156,t.tag))};function wP(e,t){return K_(e,t)}function _E(e,t,r,n){this.tag=e,this.key=r,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=n,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Fi(e,t,r,n){return new _E(e,t,r,n)}function Ub(e){return e=e.prototype,!(!e||!e.isReactComponent)}function jE(e){if(typeof e=="function")return Ub(e)?1:0;if(e!=null){if(e=e.$$typeof,e===ob)return 11;if(e===sb)return 14}return 2}function ul(e,t){var r=e.alternate;return r===null?(r=Fi(e.tag,t,e.key,e.mode),r.elementType=e.elementType,r.type=e.type,r.stateNode=e.stateNode,r.alternate=e,e.alternate=r):(r.pendingProps=t,r.type=e.type,r.flags=0,r.subtreeFlags=0,r.deletions=null),r.flags=e.flags&14680064,r.childLanes=e.childLanes,r.lanes=e.lanes,r.child=e.child,r.memoizedProps=e.memoizedProps,r.memoizedState=e.memoizedState,r.updateQueue=e.updateQueue,t=e.dependencies,r.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},r.sibling=e.sibling,r.index=e.index,r.ref=e.ref,r}function Kh(e,t,r,n,a,i){var o=2;if(n=e,typeof e=="function")Ub(e)&&(o=1);else if(typeof e=="string")o=5;else e:switch(e){case Vc:return ql(r.children,a,i,t);case ib:o=8,a|=8;break;case wx:return e=Fi(12,r,t,a|2),e.elementType=wx,e.lanes=i,e;case kx:return e=Fi(13,r,t,a),e.elementType=kx,e.lanes=i,e;case Sx:return e=Fi(19,r,t,a),e.elementType=Sx,e.lanes=i,e;case A_:return Wg(r,a,i,t);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case N_:o=10;break e;case O_:o=9;break e;case ob:o=11;break e;case sb:o=14;break e;case Bs:o=16,n=null;break e}throw Error(Fe(130,e==null?e:typeof e,""))}return t=Fi(o,r,t,a),t.elementType=e,t.type=n,t.lanes=i,t}function ql(e,t,r,n){return e=Fi(7,e,n,t),e.lanes=r,e}function Wg(e,t,r,n){return e=Fi(22,e,n,t),e.elementType=A_,e.lanes=r,e.stateNode={isHidden:!1},e}function ky(e,t,r){return e=Fi(6,e,null,t),e.lanes=r,e}function Sy(e,t,r){return t=Fi(4,e.children!==null?e.children:[],e.key,t),t.lanes=r,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function PE(e,t,r,n,a){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=ny(0),this.expirationTimes=ny(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=ny(0),this.identifierPrefix=n,this.onRecoverableError=a,this.mutableSourceEagerHydrationData=null}function Gb(e,t,r,n,a,i,o,s,l){return e=new PE(e,t,r,s,l),t===1?(t=1,i===!0&&(t|=8)):t=0,i=Fi(3,null,null,t),e.current=i,i.stateNode=e,i.memoizedState={element:n,isDehydrated:r,cache:null,transitions:null,pendingSuspenseBoundaries:null},jb(i),e}function CE(e,t,r){var n=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Wc,key:n==null?null:""+n,children:e,containerInfo:t,implementation:r}}function kP(e){if(!e)return gl;e=e._reactInternals;e:{if(bc(e)!==e||e.tag!==1)throw Error(Fe(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(fi(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(t!==null);throw Error(Fe(171))}if(e.tag===1){var r=e.type;if(fi(r))return kj(e,r,t)}return t}function SP(e,t,r,n,a,i,o,s,l){return e=Gb(r,n,!0,e,a,i,o,s,l),e.context=kP(null),r=e.current,n=qa(),a=cl(r),i=is(n,a),i.callback=t??null,sl(r,i,a),e.current.lanes=a,A0(e,a,n),hi(e,n),e}function Vg(e,t,r,n){var a=t.current,i=qa(),o=cl(a);return r=kP(r),t.context===null?t.context=r:t.pendingContext=r,t=is(i,o),t.payload={element:e},n=n===void 0?null:n,n!==null&&(t.callback=n),e=sl(a,t,o),e!==null&&(xo(e,a,o,i),Gh(e,a,o)),o}function kp(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function Mk(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var r=e.retryLane;e.retryLane=r!==0&&r<t?r:t}}function zb(e,t){Mk(e,t),(e=e.alternate)&&Mk(e,t)}function ME(){return null}var _P=typeof reportError=="function"?reportError:function(e){console.error(e)};function Wb(e){this._internalRoot=e}Hg.prototype.render=Wb.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(Fe(409));Vg(e,t,null,null)};Hg.prototype.unmount=Wb.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;ic(function(){Vg(null,e,null,null)}),t[us]=null}};function Hg(e){this._internalRoot=e}Hg.prototype.unstable_scheduleHydration=function(e){if(e){var t=tj();e={blockedOn:null,target:e,priority:t};for(var r=0;r<zs.length&&t!==0&&t<zs[r].priority;r++);zs.splice(r,0,e),r===0&&nj(e)}};function Vb(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function Xg(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function Nk(){}function NE(e,t,r,n,a){if(a){if(typeof n=="function"){var i=n;n=function(){var u=kp(o);i.call(u)}}var o=SP(t,n,e,0,null,!1,!1,"",Nk);return e._reactRootContainer=o,e[us]=o.current,$f(e.nodeType===8?e.parentNode:e),ic(),o}for(;a=e.lastChild;)e.removeChild(a);if(typeof n=="function"){var s=n;n=function(){var u=kp(l);s.call(u)}}var l=Gb(e,0,!1,null,null,!1,!1,"",Nk);return e._reactRootContainer=l,e[us]=l.current,$f(e.nodeType===8?e.parentNode:e),ic(function(){Vg(t,l,r,n)}),l}function Kg(e,t,r,n,a){var i=r._reactRootContainer;if(i){var o=i;if(typeof a=="function"){var s=a;a=function(){var l=kp(o);s.call(l)}}Vg(t,o,e,a)}else o=NE(r,t,e,a,n);return kp(o)}Q_=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var r=lf(t.pendingLanes);r!==0&&(ub(t,r|1),hi(t,Fn()),!(Gr&6)&&(ku=Fn()+500,xl()))}break;case 13:ic(function(){var n=ds(e,1);if(n!==null){var a=qa();xo(n,e,1,a)}}),zb(e,1)}};db=function(e){if(e.tag===13){var t=ds(e,134217728);if(t!==null){var r=qa();xo(t,e,134217728,r)}zb(e,134217728)}};ej=function(e){if(e.tag===13){var t=cl(e),r=ds(e,t);if(r!==null){var n=qa();xo(r,e,t,n)}zb(e,t)}};tj=function(){return rn};rj=function(e,t){var r=rn;try{return rn=e,t()}finally{rn=r}};Tx=function(e,t,r){switch(t){case"input":if(Px(e,r),t=r.name,r.type==="radio"&&t!=null){for(r=e;r.parentNode;)r=r.parentNode;for(r=r.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<r.length;t++){var n=r[t];if(n!==e&&n.form===e.form){var a=Lg(n);if(!a)throw Error(Fe(90));T_(n),Px(n,a)}}}break;case"textarea":R_(e,r);break;case"select":t=r.value,t!=null&&iu(e,!!r.multiple,t,!1)}};G_=Lb;z_=ic;var OE={usingClientEntryPoint:!1,Events:[T0,Yc,Lg,F_,U_,Lb]},Vd={findFiberByHostInstance:$l,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},AE={bundleType:Vd.bundleType,version:Vd.version,rendererPackageName:Vd.rendererPackageName,rendererConfig:Vd.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:ms.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=H_(e),e===null?null:e.stateNode},findFiberByHostInstance:Vd.findFiberByHostInstance||ME,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var dh=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!dh.isDisabled&&dh.supportsFiber)try{Ig=dh.inject(AE),To=dh}catch{}}Mi.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=OE;Mi.createPortal=function(e,t){var r=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Vb(t))throw Error(Fe(200));return CE(e,t,null,r)};Mi.createRoot=function(e,t){if(!Vb(e))throw Error(Fe(299));var r=!1,n="",a=_P;return t!=null&&(t.unstable_strictMode===!0&&(r=!0),t.identifierPrefix!==void 0&&(n=t.identifierPrefix),t.onRecoverableError!==void 0&&(a=t.onRecoverableError)),t=Gb(e,1,!1,null,null,r,!1,n,a),e[us]=t.current,$f(e.nodeType===8?e.parentNode:e),new Wb(t)};Mi.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(Fe(188)):(e=Object.keys(e).join(","),Error(Fe(268,e)));return e=H_(t),e=e===null?null:e.stateNode,e};Mi.flushSync=function(e){return ic(e)};Mi.hydrate=function(e,t,r){if(!Xg(t))throw Error(Fe(200));return Kg(null,e,t,!0,r)};Mi.hydrateRoot=function(e,t,r){if(!Vb(e))throw Error(Fe(405));var n=r!=null&&r.hydratedSources||null,a=!1,i="",o=_P;if(r!=null&&(r.unstable_strictMode===!0&&(a=!0),r.identifierPrefix!==void 0&&(i=r.identifierPrefix),r.onRecoverableError!==void 0&&(o=r.onRecoverableError)),t=SP(t,null,e,1,r??null,a,!1,i,o),e[us]=t.current,$f(e),n)for(e=0;e<n.length;e++)r=n[e],a=r._getVersion,a=a(r._source),t.mutableSourceEagerHydrationData==null?t.mutableSourceEagerHydrationData=[r,a]:t.mutableSourceEagerHydrationData.push(r,a);return new Hg(t)};Mi.render=function(e,t,r){if(!Xg(t))throw Error(Fe(200));return Kg(null,e,t,!1,r)};Mi.unmountComponentAtNode=function(e){if(!Xg(e))throw Error(Fe(40));return e._reactRootContainer?(ic(function(){Kg(null,null,e,!1,function(){e._reactRootContainer=null,e[us]=null})}),!0):!1};Mi.unstable_batchedUpdates=Lb;Mi.unstable_renderSubtreeIntoContainer=function(e,t,r,n){if(!Xg(r))throw Error(Fe(200));if(e==null||e._reactInternals===void 0)throw Error(Fe(38));return Kg(e,t,r,!1,n)};Mi.version="18.3.1-next-f1338f8080-20240426";function jP(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(jP)}catch(e){console.error(e)}}jP(),j_.exports=Mi;var EE=j_.exports,Ok=EE;vx.createRoot=Ok.createRoot,vx.hydrateRoot=Ok.hydrateRoot;const dl=({isOpen:e,onClose:t,onConfirm:r,title:n,message:a,confirmText:i="I know the risk and insist to continue",cancelText:o="Cancel"})=>e?c.jsx("div",{className:"fixed inset-0 z-[100] flex items-center justify-center bg-black/60 backdrop-blur-sm p-4 animate-in fade-in duration-200",children:c.jsxs("div",{className:"bg-white dark:bg-slate-900 w-full max-w-md rounded-2xl shadow-2xl border border-amber-500/30 overflow-hidden transform transition-all scale-100",children:[c.jsxs("div",{className:"bg-amber-500/10 p-6 flex flex-col items-center justify-center border-b border-amber-500/20",children:[c.jsx("div",{className:"w-16 h-16 bg-amber-100 dark:bg-amber-900/30 rounded-full flex items-center justify-center mb-4",children:c.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-10 w-10 text-amber-600 dark:text-amber-500",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})})}),c.jsx("h3",{className:"text-xl font-bold text-gray-900 dark:text-white text-center",children:n})]}),c.jsx("div",{className:"p-6",children:c.jsx("div",{className:"text-gray-600 dark:text-slate-300 text-center text-sm leading-relaxed",children:a})}),c.jsxs("div",{className:"p-4 bg-gray-50 dark:bg-slate-800/50 flex gap-3 justify-end border-t border-gray-200 dark:border-slate-800",children:[c.jsx("button",{onClick:t,className:"px-4 py-2 bg-white hover:bg-gray-100 dark:bg-slate-700 dark:hover:bg-slate-600 text-gray-700 dark:text-slate-200 font-semibold rounded-lg border border-gray-300 dark:border-slate-600 transition-colors text-sm",children:o}),c.jsx("button",{onClick:r,className:"px-4 py-2 bg-amber-600 hover:bg-amber-700 text-white font-bold rounded-lg shadow-lg shadow-amber-500/20 transition-all active:scale-95 text-sm",children:i})]})]})}):null,TE=({onFileSelected:e,onGenerateFakeDng:t,fileName:r,hasGeneratedData:n,viewMode:a,onSetViewMode:i,patternPeriod:o,onPatternPeriodChange:s,fillFactor:l,onFillFactorChange:u,patternPhase:d,onPatternPhaseChange:f,showPatternControls:h,onOpenAbout:g,onShowExif:v,bridgeStatus:w,onBridgeClick:b,isDrLabOpen:x,onToggleDrLab:y,isColorLabOpen:_,onToggleColorLab:j,isFftLabOpen:S,onToggleFftLab:k,isSfrLabOpen:M,onToggleSfrLab:N,onGenerateTestPic:T,onPTCFilesSelected:A,onDownloadDng:D,isThreePlane:$,onOpenDatabase:B,isSidebarOpen:J,onToggleSidebar:W,onOpenSaveZ8:I,isPsModeOpen:G,onTogglePsMode:U})=>{const X=P.useRef(null),V=P.useRef(null),[z,q]=P.useState(!1),[te,ie]=P.useState(!1),[he,ee]=P.useState(!1),[Le,fe]=P.useState("direct"),ce=P.useRef(null),de=P.useRef(null);P.useEffect(()=>{const me=Be=>{ce.current&&!ce.current.contains(Be.target)&&ie(!1),de.current&&!de.current.contains(Be.target)&&ee(!1)};return document.addEventListener("mousedown",me),()=>document.removeEventListener("mousedown",me)},[]);const Ne=me=>{var Be,Se;if(G){ie(!1);return}ie(!1),me==="direct"?(fe("direct"),(Be=X.current)==null||Be.click()):!w.isConnected||!w.hasDngConverter?q(!0):(fe("convert"),(Se=X.current)==null||Se.click())},pe=me=>{var Se;if(G){me.target.value="";return}const Be=(Se=me.target.files)==null?void 0:Se[0];Be&&e(Be,Le),me.target.value=""},ke=me=>{me.target.files&&me.target.files.length>0&&A(me.target.files),me.target.value=""};return r==="pattern_test.dng"||(r==null||r.startsWith("Diff_")),c.jsxs("header",{className:"flex flex-col sm:flex-row justify-between items-center gap-4 mb-4 flex-shrink-0 relative z-50 font-mono",children:[c.jsx(dl,{isOpen:z,onClose:()=>q(!1),onConfirm:()=>q(!1),title:"DNG Converter Missing",confirmText:"OK",cancelText:"Cancel",message:c.jsxs("div",{className:"flex flex-col gap-4",children:[c.jsx("p",{className:"font-bold text-red-600 dark:text-red-400 text-base",children:"JiangBridge Offline or Adobe DNG Converter not installed"}),c.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"To use the conversion feature, you must run JiangBridge locally and have Adobe DNG Converter installed on your system."})]})}),c.jsxs("div",{className:"flex items-center gap-4",children:[c.jsx("h1",{className:"text-xl sm:text-2xl font-bold text-black dark:text-white text-center sm:text-left tracking-tight border-2 border-black dark:border-white px-2 py-1 bg-white dark:bg-black",children:"Jiangtherapee_Online"}),c.jsx("p",{className:"text-sm text-gray-600 dark:text-slate-400 hidden lg:block max-w-xs truncate font-bold",title:r||"No image loaded",children:r||"No_Image_Loaded"}),$&&c.jsx("span",{className:"bg-red-100 text-red-700 dark:bg-red-900/30 dark:text-red-400 border-2 border-red-500 dark:border-red-800 text-[10px] font-bold px-2 py-1 animate-pulse",children:" 3-PLANE / RGB MODE"})]}),c.jsxs("div",{className:"flex items-center gap-4 flex-wrap justify-end",children:[c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsxs("button",{onClick:w.isConnected?void 0:b,className:`px-3 py-1.5 text-xs font-bold transition-all duration-200 flex items-center gap-1.5 shadow-[2px_2px_0px_black] border-2 border-black dark:border-gray-500 ${w.isConnected?"bg-emerald-100 text-emerald-900 border-emerald-800 dark:bg-emerald-900/30 dark:text-emerald-400 dark:border-emerald-600 cursor-default":"bg-pink-100 text-pink-900 border-pink-800 dark:bg-pink-900/30 dark:text-pink-400 dark:border-pink-600 hover:bg-pink-200 dark:hover:bg-pink-900/50 cursor-pointer animate-pulse"}`,title:w.isConnected?"Local Bridge Service Connected":"Click to download Jiangbridge",children:[c.jsx("span",{className:`w-2 h-2 ${w.isConnected?"bg-emerald-600":"bg-pink-600"}`}),w.isConnected?`JiangBridge Ready ${w.hasDngConverter?"DNG+":""}`:"JiangBridge Offline"]}),x&&c.jsxs("button",{onClick:y,className:"px-3 py-1.5 text-xs font-bold transition-all duration-200 flex items-center gap-1.5 shadow-[2px_2px_0px_black] border-2 border-indigo-800 bg-indigo-100 text-indigo-900 dark:bg-indigo-900/30 dark:text-indigo-400 dark:border-indigo-600 hover:bg-indigo-200 dark:hover:bg-indigo-900/50 cursor-pointer animate-in fade-in",title:"Click to turn off DR Lab",children:[c.jsx("span",{className:"w-2 h-2 bg-indigo-600 animate-pulse"}),"DR Lab On"]}),_&&c.jsxs("button",{onClick:j,className:"px-3 py-1.5 text-xs font-bold transition-all duration-200 flex items-center gap-1.5 shadow-[2px_2px_0px_black] border-2 border-yellow-800 bg-yellow-100 text-yellow-900 dark:bg-yellow-900/30 dark:text-yellow-400 dark:border-yellow-600 hover:bg-yellow-200 dark:hover:bg-yellow-900/50 cursor-pointer animate-in fade-in",title:"Click to turn off Color Lab",children:[c.jsx("span",{className:"w-2 h-2 bg-yellow-500 animate-pulse"}),"Color Lab On"]}),S&&c.jsxs("button",{onClick:k,className:"px-3 py-1.5 text-xs font-bold transition-all duration-200 flex items-center gap-1.5 shadow-[2px_2px_0px_black] border-2 border-fuchsia-800 bg-fuchsia-100 text-fuchsia-900 dark:bg-fuchsia-900/30 dark:text-fuchsia-400 dark:border-fuchsia-600 hover:bg-fuchsia-200 dark:hover:bg-fuchsia-900/50 cursor-pointer animate-in fade-in",title:"Click to turn off FFT Lab",children:[c.jsx("span",{className:"w-2 h-2 bg-fuchsia-600 animate-pulse"}),"FFT Lab On"]}),M&&c.jsxs("button",{onClick:N,className:"px-3 py-1.5 text-xs font-bold transition-all duration-200 flex items-center gap-1.5 shadow-[2px_2px_0px_black] border-2 border-orange-800 bg-orange-100 text-orange-900 dark:bg-orange-900/30 dark:text-orange-400 dark:border-orange-600 hover:bg-orange-200 dark:hover:bg-orange-900/50 cursor-pointer animate-in fade-in",title:"Click to turn off SFR Lab",children:[c.jsx("span",{className:"w-2 h-2 bg-orange-600 animate-pulse"}),"SFR Lab On"]}),G&&c.jsxs("button",{className:"px-3 py-1.5 text-xs font-bold transition-all duration-200 flex items-center gap-1.5 shadow-[2px_2px_0px_black] border-2 border-teal-800 bg-teal-100 text-teal-900 dark:bg-teal-900/30 dark:text-teal-400 dark:border-teal-600 cursor-default animate-in fade-in",title:"PS Mode is locked",children:[c.jsx("span",{className:"w-2 h-2 bg-teal-500 animate-pulse"}),"PS Mode On"]})]}),c.jsx("input",{type:"file",ref:X,onChange:pe,className:"hidden"}),c.jsx("input",{type:"file",ref:V,onChange:ke,className:"hidden",multiple:!0,accept:".csv"}),c.jsxs("div",{className:"relative inline-block text-left",ref:de,children:[c.jsxs("button",{onClick:()=>ee(!he),className:"bg-purple-700 hover:bg-purple-600 text-white font-bold py-2 px-4 border-2 border-black dark:border-white shadow-[4px_4px_0px_black] dark:shadow-[4px_4px_0px_gray] active:translate-x-[2px] active:translate-y-[2px] active:shadow-[2px_2px_0px_black] transition-all duration-100 text-sm whitespace-nowrap flex items-center gap-2",children:["TOOLS",c.jsx("svg",{className:`w-4 h-4 transition-transform duration-200 ${he?"rotate-180":""}`,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),he&&c.jsx("div",{className:"absolute right-0 mt-2 w-56 bg-white dark:bg-slate-800 shadow-[8px_8px_0px_rgba(0,0,0,0.5)] ring-1 ring-black ring-opacity-5 focus:outline-none z-50 overflow-hidden origin-top-right transition-all animate-in fade-in slide-in-from-top-2 border-2 border-black dark:border-gray-500",children:c.jsxs("div",{className:"py-1",children:[c.jsxs("button",{onClick:()=>{ee(!1),U&&!G&&U(),x&&y(),S&&k(),_&&j&&j(),M&&N&&N()},className:`w-full text-left px-4 py-3 text-sm transition-colors flex items-center gap-2 border-b border-gray-300 dark:border-gray-600 ${G?"bg-teal-100 dark:bg-teal-900/40 text-teal-800 dark:text-teal-300 font-bold":"text-gray-800 dark:text-slate-200 hover:bg-gray-200 dark:hover:bg-slate-700"}`,children:[c.jsx("svg",{className:"w-4 h-4 text-teal-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 6V4m0 2a2 2 0 100 4m0-4a2 2 0 110 4m-6 8a2 2 0 100-4m0 4a2 2 0 110-4m0 4v2m0-6V4m6 6v10m6-2a2 2 0 100-4m0 4a2 2 0 110-4m0 4v2m0-6V4"})}),c.jsxs("span",{children:["PS Mode ",G?"(On)":""]})]}),c.jsxs("button",{onClick:()=>{ee(!1),x||y(),S&&k(),_&&j&&j(),M&&N&&N(),G&&U()},className:`w-full text-left px-4 py-3 text-sm transition-colors flex items-center gap-2 border-b border-gray-300 dark:border-gray-600 ${x?"bg-indigo-100 dark:bg-indigo-900/40 text-indigo-800 dark:text-indigo-300 font-bold":"text-gray-800 dark:text-slate-200 hover:bg-gray-200 dark:hover:bg-slate-700"}`,children:[c.jsx("svg",{className:"w-4 h-4 text-indigo-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19.428 15.428a2 2 0 00-1.022-.547l-2.384-.477a6 6 0 00-3.86.517l-.318.158a6 6 0 01-3.86.517L6.05 15.21a2 2 0 00-1.806.547M8 4h8l-1 1v5.172a2 2 0 00.586 1.414l5 5c1.26 1.26.367 3.414-1.415 3.414H4.828c-1.782 0-2.674-2.154-1.414-3.414l5-5A2 2 0 009 10.172V5L8 4z"})}),c.jsxs("span",{children:["DR Lab ",x?"(On)":""]})]}),c.jsxs("button",{onClick:()=>{ee(!1),j&&!_&&j(),x&&y(),S&&k(),M&&N&&N(),G&&U()},className:`w-full text-left px-4 py-3 text-sm transition-colors flex items-center gap-2 border-b border-gray-300 dark:border-gray-600 ${_?"bg-yellow-100 dark:bg-yellow-900/40 text-yellow-800 dark:text-yellow-300 font-bold":"text-gray-800 dark:text-slate-200 hover:bg-gray-200 dark:hover:bg-slate-700"}`,children:[c.jsx("svg",{className:"w-4 h-4 text-yellow-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M7 21a4 4 0 01-4-4V5a2 2 0 012-2h4a2 2 0 012 2v12a4 4 0 01-4 4zm0 0h12a2 2 0 002-2v-4a2 2 0 00-2-2h-2.343M11 7.343l1.657-1.657a2 2 0 012.828 0l2.829 2.829a2 2 0 010 2.828l-8.486 8.485M7 17h.01"})}),c.jsxs("span",{children:["Color Lab ",_?"(On)":""]})]}),c.jsxs("button",{onClick:()=>{ee(!1),N&&!M&&N(),x&&y(),S&&k(),_&&j&&j(),G&&U()},className:`w-full text-left px-4 py-3 text-sm transition-colors flex items-center gap-2 border-b border-gray-300 dark:border-gray-600 ${M?"bg-orange-100 dark:bg-orange-900/40 text-orange-800 dark:text-orange-300 font-bold":"text-gray-800 dark:text-slate-200 hover:bg-gray-200 dark:hover:bg-slate-700"}`,children:[c.jsx("svg",{className:"w-4 h-4 text-orange-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 10V3L4 14h7v7l9-11h-7z"})}),c.jsxs("span",{children:["SFR Lab ",M?"(On)":""]})]}),c.jsxs("button",{onClick:()=>{ee(!1),S||k(),x&&y(),_&&j&&j(),M&&N&&N(),G&&U()},className:`w-full text-left px-4 py-3 text-sm transition-colors flex items-center gap-2 border-b border-gray-300 dark:border-gray-600 ${S?"bg-fuchsia-100 dark:bg-fuchsia-900/40 text-fuchsia-800 dark:text-fuchsia-300 font-bold":"text-gray-800 dark:text-slate-200 hover:bg-gray-200 dark:hover:bg-slate-700"}`,children:[c.jsx("svg",{className:"w-4 h-4 text-fuchsia-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2m0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"})}),c.jsxs("span",{children:["Stack Lab ",S?"(On)":""]})]}),c.jsx("div",{className:"border-t border-gray-300 dark:border-gray-600 my-1"}),c.jsxs("button",{onClick:()=>{ee(!1),I==null||I()},className:"w-full text-left px-4 py-2 text-sm text-red-600 dark:text-red-400 hover:bg-gray-200 dark:hover:bg-slate-700 transition-colors flex items-center gap-2",children:[c.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})}),c.jsx("span",{children:" Z8 (Save Z8)"})]}),c.jsxs("button",{onClick:()=>{ee(!1),t()},className:"w-full text-left px-4 py-2 text-sm text-gray-800 dark:text-slate-200 hover:bg-gray-200 dark:hover:bg-slate-700 transition-colors flex items-center gap-2",children:[c.jsx("svg",{className:"w-4 h-4 text-purple-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"})}),c.jsx("span",{children:"Generate Pattern DNG"})]}),c.jsxs("button",{onClick:()=>{var me;ee(!1),(me=V.current)==null||me.click()},className:"w-full text-left px-4 py-2 text-sm text-gray-800 dark:text-slate-200 hover:bg-gray-200 dark:hover:bg-slate-700 transition-colors flex items-center gap-2",children:[c.jsx("svg",{className:"w-4 h-4 text-emerald-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M7 12l3-3 3 3 4-4M8 21l4-4 4 4M3 4h18M4 4h16v12a1 1 0 01-1 1H5a1 1 0 01-1-1V4z"})}),c.jsx("span",{children:"Generate PTC"})]}),c.jsxs("button",{onClick:()=>{ee(!1),window.open("https://y-g-jiang.github.io/CP.html","_blank")},className:"w-full text-left px-4 py-2 text-sm text-gray-800 dark:text-slate-200 hover:bg-gray-200 dark:hover:bg-slate-700 transition-colors flex items-center gap-2",children:[c.jsx("svg",{className:"w-4 h-4 text-teal-500",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2m0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"})}),c.jsx("span",{children:"Generate MTF Contour"})]})]})})]}),c.jsxs("div",{className:"relative inline-block text-left",ref:ce,children:[c.jsxs("button",{onClick:()=>!G&&ie(!te),disabled:G,className:`bg-cyan-700 text-white font-bold py-2 px-4 border-2 border-black dark:border-white shadow-[4px_4px_0px_black] dark:shadow-[4px_4px_0px_gray] transition-all duration-100 text-sm whitespace-nowrap flex items-center gap-2 ${G?"opacity-50 cursor-not-allowed":"hover:bg-cyan-600 active:translate-x-[2px] active:translate-y-[2px] active:shadow-[2px_2px_0px_black]"}`,title:G?"Load Image is disabled while PS Mode is active":void 0,children:["Load Image",c.jsx("svg",{className:`w-4 h-4 transition-transform duration-200 ${te?"rotate-180":""}`,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),te&&c.jsx("div",{className:"absolute right-0 mt-2 w-56 bg-white dark:bg-slate-800 shadow-[8px_8px_0px_rgba(0,0,0,0.5)] ring-1 ring-black ring-opacity-5 focus:outline-none z-50 overflow-hidden origin-top-right transition-all animate-in fade-in slide-in-from-top-2 border-2 border-black dark:border-gray-500",children:c.jsxs("div",{className:"py-1",children:[c.jsxs("button",{onClick:()=>Ne("direct"),className:"w-full text-left px-4 py-3 text-sm text-gray-800 dark:text-slate-200 hover:bg-gray-200 dark:hover:bg-slate-700 transition-colors flex items-center gap-2 border-b border-gray-300 dark:border-gray-600",children:[c.jsx("svg",{className:"w-4 h-4 text-cyan-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-8l-4-4m0 0L8 8m4-4v12"})}),c.jsx("span",{children:"Load Image (Direct)"})]}),c.jsxs("button",{onClick:()=>Ne("convert"),className:"w-full text-left px-4 py-3 text-sm text-gray-800 dark:text-slate-200 hover:bg-gray-200 dark:hover:bg-slate-700 transition-colors flex items-center gap-2",children:[c.jsx("svg",{className:"w-4 h-4 text-purple-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19.428 15.428a2 2 0 00-1.022-.547l-2.384-.477a6 6 0 00-3.86.517l-.318.158a6 6 0 01-3.86.517L6.05 15.21a2 2 0 00-1.806.547M8 4h8l-1 1v5.172a2 2 0 00.586 1.414l5 5c1.26 1.26.367 3.414-1.415 3.414H4.828c-1.782 0-2.674-2.154-1.414-3.414l5-5A2 2 0 009 10.172V5L8 4z"})}),c.jsx("span",{children:"Convert to Adobe DNG & Load"})]})]})})]}),r&&v&&c.jsxs("button",{onClick:v,className:"bg-orange-600 hover:bg-orange-500 text-white font-bold py-2 px-4 border-2 border-black dark:border-white shadow-[4px_4px_0px_black] dark:shadow-[4px_4px_0px_gray] active:translate-x-[2px] active:translate-y-[2px] active:shadow-[2px_2px_0px_black] transition-all duration-100 text-sm whitespace-nowrap flex items-center gap-1",title:"View EXIF Data",children:[c.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),"EXIF"]}),c.jsx("button",{onClick:g,className:"bg-teal-700 hover:bg-teal-600 text-white font-bold py-2 px-4 border-2 border-black dark:border-white shadow-[4px_4px_0px_black] dark:shadow-[4px_4px_0px_gray] active:translate-x-[2px] active:translate-y-[2px] active:shadow-[2px_2px_0px_black] transition-all duration-100 text-sm whitespace-nowrap",children:"About/Tutorial/Tools"}),c.jsx("a",{href:"https://y-g-jiang.github.io/index.html",target:"_blank",rel:"noopener noreferrer",className:"bg-gray-300 hover:bg-gray-200 dark:bg-slate-700 dark:hover:bg-slate-600 text-black dark:text-white font-bold py-2 px-4 border-2 border-black dark:border-white shadow-[4px_4px_0px_black] dark:shadow-[4px_4px_0px_gray] active:translate-x-[2px] active:translate-y-[2px] active:shadow-[2px_2px_0px_black] transition-all duration-100 text-sm no-underline",children:"Home"}),c.jsxs("button",{onClick:W,className:`bg-slate-700 hover:bg-slate-600 text-white font-bold py-2 px-3 border-2 border-black dark:border-white shadow-[4px_4px_0px_black] dark:shadow-[4px_4px_0px_gray] active:translate-x-[2px] active:translate-y-[2px] active:shadow-[2px_2px_0px_black] transition-all duration-100 text-sm whitespace-nowrap flex items-center gap-2 ${J?"":"ring-2 ring-cyan-500 ring-offset-2 dark:ring-offset-black"}`,title:J?"Hide Control Panel":"Show Control Panel",children:[c.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:J?c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 5l7 7-7 7M5 5l7 7-7 7"}):c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11 19l-7-7 7-7m8 14l-7-7 7-7"})}),c.jsx("span",{className:"hidden sm:inline",children:J?"Hide Panel":"Show Panel"})]})]})]})},IE=({image:e,zoom:t,pan:r,onPanChange:n,onZoomChange:a,onSelectionChange:i,forcedSelection:o,theme:s,touchAction:l="pan",isMarking:u=!1,onPointClick:d,markers:f=[],gridRects:h=[],colorLabPoints:g=[],colorLabRects:v=[],sfrRects:w=[],psMaskOverlay:b=null,psMaskDirtyRect:x=null,psGuides:y=[],psSelectedGuideId:_=null,psGuidePickTarget:j=null,psEllipseTool:S={mode:"off",draft:null},psEditableEllipse:k=null,psBrush:M,onPsBrushPaint:N,onPsGuidePickPoint:T,onPsEllipseCenterPick:A,onPsEllipseDrag:D,onPsEditEllipse:$})=>{var Xt;const B=P.useRef(null),J=P.useRef(document.createElement("canvas")),W=P.useRef(null),I=P.useRef(null),[G,U]=P.useState(!1),[X,V]=P.useState({x:0,y:0}),z=P.useRef(null),q=P.useRef(null),te=P.useRef(null),[ie,he]=P.useState(!1),[ee,Le]=P.useState(null),[fe,ce]=P.useState(null),[de,Ne]=P.useState(!1),[pe,ke]=P.useState(!1),[me,Be]=P.useState(!1),[Se,we]=P.useState(null),Re=P.useRef(null),it=P.useRef(null),Qe=P.useRef(null),se=P.useRef(null),Xe=Te=>{Re.current=Te,we(Te)};P.useEffect(()=>{o!==void 0&&ce(o)},[o]),P.useEffect(()=>{me||Xe(null)},[me,k==null?void 0:k.id]),P.useEffect(()=>{if(!b){W.current=null,I.current=null;return}if(!W.current||!I.current||I.current.width!==b.width||I.current.height!==b.height||!x){const gr=document.createElement("canvas");gr.width=b.width,gr.height=b.height;const Qt=gr.getContext("2d");if(!Qt)return;const jt=Qt.createImageData(b.width,b.height);for(let mr=0;mr<b.alpha.length;mr++){const R=Math.max(0,Math.min(1,b.alpha[mr])),sr=mr*4;jt.data[sr]=255,jt.data[sr+1]=56,jt.data[sr+2]=56,jt.data[sr+3]=Math.round(R*128)}Qt.putImageData(jt,0,0),W.current=gr,I.current={width:b.width,height:b.height};return}const Ce=W.current.getContext("2d");if(!Ce)return;const ye=Math.max(0,Math.floor(x.x0)),ze=Math.max(0,Math.floor(x.y0)),ot=Math.min(b.width-1,Math.ceil(x.x1)),ct=Math.min(b.height-1,Math.ceil(x.y1)),Ct=Math.max(0,ot-ye+1),tt=Math.max(0,ct-ze+1);if(Ct<=0||tt<=0)return;const Hr=Ce.createImageData(Ct,tt);for(let gr=0;gr<tt;gr++){const jt=(ze+gr)*b.width,mr=gr*Ct;for(let R=0;R<Ct;R++){const sr=ye+R,Fr=Math.max(0,Math.min(1,b.alpha[jt+sr])),Me=(mr+R)*4;Hr.data[Me]=255,Hr.data[Me+1]=56,Hr.data[Me+2]=56,Hr.data[Me+3]=Math.round(Fr*128)}}Ce.putImageData(Hr,ye,ze)},[b==null?void 0:b.alpha,b==null?void 0:b.width,b==null?void 0:b.height,b==null?void 0:b.version,x]);const ht=P.useCallback(()=>{const Te=B.current,Q=Te==null?void 0:Te.getContext("2d");return{canvas:Te,ctx:Q}},[]);P.useEffect(()=>{const Te=J.current,Q=Te.getContext("2d");if(!e||!Q)return;let Ce=0,ye=0;e instanceof ImageData?(Ce=e.width,ye=e.height):e instanceof HTMLImageElement&&(Ce=e.naturalWidth,ye=e.naturalHeight),!(Ce===0||ye===0)&&((Te.width!==Ce||Te.height!==ye)&&(Te.width=Ce,Te.height=ye),e instanceof ImageData?Q.putImageData(e,0,0):(Q.clearRect(0,0,Ce,ye),Q.drawImage(e,0,0)))},[e]);const Zt=P.useCallback(()=>{const{canvas:Te,ctx:Q}=ht();if(!Te||!Q||!e)return;if(Q.setTransform(1,0,0,1,0,0),Q.fillStyle=s==="dark"?"rgb(15, 23, 42)":"rgb(243, 244, 246)",Q.fillRect(0,0,Te.width,Te.height),Q.setTransform(t,0,0,t,r.x,r.y),J.current.width>0&&(Q.imageSmoothingEnabled=!1,Q.drawImage(J.current,0,0)),W.current&&(Q.imageSmoothingEnabled=!1,Q.drawImage(W.current,0,0)),y&&y.length>0){Q.save();for(const ye of y){if(ye.visible===!1)continue;const ze=_===ye.id;Q.strokeStyle=ze?"#f59e0b":"#22d3ee",Q.lineWidth=ze?2/t:1/t,Q.setLineDash([8/t,6/t]),Q.beginPath(),Q.moveTo(ye.p1.x,ye.p1.y),Q.lineTo(ye.p2.x,ye.p2.y),Q.stroke();const ot=3/t;Q.fillStyle=ze?"#f59e0b":"#22d3ee",Q.beginPath(),Q.arc(ye.p1.x,ye.p1.y,ot,0,Math.PI*2),Q.arc(ye.p2.x,ye.p2.y,ot,0,Math.PI*2),Q.fill()}Q.restore()}if(S.mode!=="off"&&S.draft){const ye=S.draft;Q.save(),Q.strokeStyle="#f59e0b",Q.lineWidth=2/t,Q.setLineDash([6/t,4/t]),Q.beginPath(),Q.ellipse(ye.center.x,ye.center.y,Math.max(1,ye.radiusX),Math.max(1,ye.radiusY),ye.rotationDeg*Math.PI/180,0,Math.PI*2),Q.stroke(),Q.setLineDash([]),Q.fillStyle="#f59e0b",Q.beginPath(),Q.arc(ye.center.x,ye.center.y,3/t,0,Math.PI*2),Q.fill(),Q.restore()}const Ce=me&&Se?Se:k;if(Ce&&S.mode==="off"){const ye=Ce,ze=pr(ye),ot=4/t;Q.save(),Q.strokeStyle="#14b8a6",Q.lineWidth=1.5/t,Q.setLineDash([5/t,3/t]),Q.beginPath(),Q.ellipse(ye.center.x,ye.center.y,Math.max(1,ye.radiusX),Math.max(1,ye.radiusY),ye.rotationDeg*Math.PI/180,0,Math.PI*2),Q.stroke(),Q.setLineDash([]),Q.strokeStyle="#22d3ee",Q.beginPath(),Q.moveTo(ze.center.x,ze.center.y),Q.lineTo(ze.rotHandle.x,ze.rotHandle.y),Q.stroke();const ct=(Ct,tt)=>{Q.fillStyle=tt,Q.beginPath(),Q.arc(Ct.x,Ct.y,ot,0,Math.PI*2),Q.fill(),Q.strokeStyle="#0f172a",Q.lineWidth=1/t,Q.stroke()};ct(ze.center,"#f59e0b"),ct(ze.rxHandle,"#38bdf8"),ct(ze.ryHandle,"#818cf8"),ct(ze.rotHandle,"#22d3ee"),Q.restore()}if(fe){Q.strokeStyle="#06b6d4",Q.lineWidth=1/t,Q.fillStyle="rgba(6, 182, 212, 0.2)",Q.beginPath(),Q.rect(fe.x,fe.y,fe.w,fe.h),Q.fill(),Q.stroke(),Q.save(),Q.fillStyle="#fff";const ye=Math.max(10,14/t);Q.font=`${ye}px monospace`,Q.shadowColor="rgba(0,0,0,0.8)",Q.shadowBlur=4,Q.shadowOffsetX=1,Q.shadowOffsetY=1,Q.fillText(`${Math.round(fe.w)}x${Math.round(fe.h)}`,fe.x,fe.y-5/t),Q.restore()}if(h&&h.length>0){Q.save(),Q.strokeStyle="#f59e0b",Q.lineWidth=1/t,Q.globalAlpha=.8,Q.beginPath(),h.forEach(ot=>{Q.rect(ot.x,ot.y,ot.w,ot.h)}),Q.stroke();const ye=h[0];Q.fillStyle="#f59e0b";const ze=Math.max(10,12/t);Q.font=`${ze}px monospace`,Q.fillText(`${Math.round(ye.w)}x${Math.round(ye.h)}`,ye.x,ye.y-4/t),Q.restore()}if(f&&f.length>0){Q.save();const ye=6/t,ze=Math.max(12,16/t);Q.font=`bold ${ze}px sans-serif`,Q.textAlign="center",Q.textBaseline="middle",f.forEach((ot,ct)=>{Q.beginPath(),Q.arc(ot.x,ot.y,ye,0,2*Math.PI),Q.fillStyle="white",Q.fill(),Q.strokeStyle="#4338ca",Q.lineWidth=2/t,Q.stroke(),Q.fillStyle="#4338ca",Q.fillText((ct+1).toString(),ot.x,ot.y-12/t)}),Q.restore()}if(g&&g.length>0){Q.save();const ye=5/t,ze=Math.max(10,14/t);Q.font=`bold ${ze}px sans-serif`,Q.textAlign="center",Q.textBaseline="middle",g.forEach((ot,ct)=>{Q.fillStyle="yellow",Q.fillRect(ot.x-ye,ot.y-ye,ye*2,ye*2),Q.strokeStyle="black",Q.lineWidth=1/t,Q.strokeRect(ot.x-ye,ot.y-ye,ye*2,ye*2),Q.fillStyle="yellow",Q.shadowColor="black",Q.shadowBlur=2,Q.fillText((ct+1).toString(),ot.x,ot.y-10/t)}),Q.restore()}if(v&&v.length>0){if(Q.save(),Q.strokeStyle="yellow",Q.lineWidth=1/t,Q.globalAlpha=.9,Q.beginPath(),v.forEach(ye=>{Q.rect(ye.x,ye.y,ye.w,ye.h)}),Q.stroke(),v[0]){const ye=v[0];Q.fillStyle="yellow",Q.shadowColor="black",Q.shadowBlur=3;const ze=Math.max(10,12/t);Q.font=`${ze}px monospace`,Q.fillText(`${Math.round(ye.w)}x${Math.round(ye.h)}`,ye.x,ye.y-4/t)}Q.restore()}w&&w.length>0&&(Q.save(),Q.strokeStyle="#ef4444",Q.lineWidth=2/t,Q.globalAlpha=.9,Q.beginPath(),w.forEach(ye=>{Q.rect(ye.x,ye.y,ye.w,ye.h)}),Q.stroke(),Q.restore())},[ht,e,t,r,s,fe,h,f,g,v,w,b==null?void 0:b.version,y,_,S,k,me,Se]);P.useEffect(()=>{const{canvas:Te}=ht();if(!Te)return;const Q=new ResizeObserver(()=>{Te.width=Te.clientWidth,Te.height=Te.clientHeight,Zt()});return Q.observe(Te),()=>Q.disconnect()},[ht,Zt]),P.useEffect(()=>{Zt()},[Zt,e,r,t,s,fe,h,f,g,v,w,y,_,k,me,Se]);const Jt=Te=>{const{canvas:Q}=ht();if(!Q)return{x:0,y:0};const Ce=Q.getBoundingClientRect();return{x:Te.clientX-Ce.left,y:Te.clientY-Ce.top}},Ut=(Te,Q)=>({x:(Te-r.x)/t,y:(Q-r.y)/t}),Lt=Te=>{const Q=Te*Math.PI/180,Ce={x:Math.cos(Q),y:Math.sin(Q)},ye={x:-Math.sin(Q),y:Math.cos(Q)};return{ux:Ce,uy:ye}},pr=Te=>{const{ux:Q,uy:Ce}=Lt(Te.rotationDeg),ye=Te.center,ze=Math.max(1,Te.radiusX),ot=Math.max(1,Te.radiusY),ct={x:ye.x+Q.x*ze,y:ye.y+Q.y*ze},Ct={x:ye.x+Ce.x*ot,y:ye.y+Ce.y*ot},tt={x:ye.x+Q.x*(ze+28/t),y:ye.y+Q.y*(ze+28/t)};return{center:ye,rxHandle:ct,ryHandle:Ct,rotHandle:tt,ux:Q,uy:Ce}},ir=(Te,Q)=>{const Ce=Te.x-Q.x,ye=Te.y-Q.y;return Ce*Ce+ye*ye},zt=Te=>{const Q=me&&Se?Se:k;if(!Q||S.mode!=="off")return null;const Ce=pr(Q),ye=8/t,ze=ye*ye;if(ir(Te,Ce.rotHandle)<=ze)return"rotate";if(ir(Te,Ce.rxHandle)<=ze)return"radiusX";if(ir(Te,Ce.ryHandle)<=ze)return"radiusY";if(ir(Te,Ce.center)<=ze)return"move";const ot=Te.x-Ce.center.x,ct=Te.y-Ce.center.y,Ct=ot*Ce.ux.x+ct*Ce.ux.y,tt=ot*Ce.uy.x+ct*Ce.uy.y,Hr=Ct/Math.max(1,Q.radiusX),gr=tt/Math.max(1,Q.radiusY);return Hr*Hr+gr*gr<=1.05*1.05?"move":null},Tr=Te=>{if(!k||!$||S.mode!=="off")return!1;const Q=zt(Te);return Q?(Qe.current=Q,se.current={itemId:k.id,startMouse:Te,center:{...k.center},radiusX:k.radiusX,radiusY:k.radiusY,rotationDeg:k.rotationDeg},Xe({id:k.id,center:{...k.center},radiusX:k.radiusX,radiusY:k.radiusY,rotationDeg:k.rotationDeg}),Be(!0),!0):!1},lt=Te=>{if(!me)return!1;const Q=Qe.current,Ce=se.current;if(!Q||!Ce)return!1;const ye={id:Ce.itemId,center:{...Ce.center},radiusX:Ce.radiusX,radiusY:Ce.radiusY,rotationDeg:Ce.rotationDeg};if(Q==="move")return ye.center={x:Ce.center.x+(Te.x-Ce.startMouse.x),y:Ce.center.y+(Te.y-Ce.startMouse.y)},Xe(ye),!0;if(Q==="rotate"){const tt=Math.atan2(Te.y-Ce.center.y,Te.x-Ce.center.x)*180/Math.PI;return ye.rotationDeg=tt,Xe(ye),!0}const{ux:ze,uy:ot}=Lt(Ce.rotationDeg),ct=Te.x-Ce.center.x,Ct=Te.y-Ce.center.y;if(Q==="radiusX"){const tt=Math.max(1,Math.abs(ct*ze.x+Ct*ze.y));return ye.radiusX=tt,Xe(ye),!0}if(Q==="radiusY"){const tt=Math.max(1,Math.abs(ct*ot.x+Ct*ot.y));return ye.radiusY=tt,Xe(ye),!0}return!1},Nt=()=>{if(!me||!$)return;const Te=se.current,Q=Re.current||Se;!Te||!Q||$(Te.itemId,{center:Q.center,radiusX:Q.radiusX,radiusY:Q.radiusY,rotationDeg:Q.rotationDeg})},wr=Te=>{Te.preventDefault();const Q=Jt(Te),Ce=Ut(Q.x,Q.y);if(it.current=Ce,S.mode==="center"&&A){A(Ce);return}if(S.mode==="drag"&&D){D(Ce,"start"),ke(!0);return}if(!Tr(Ce)){if(j&&T){T(Ce);return}if(M!=null&&M.enabled&&N&&!u&&l!=="select"&&!Te.shiftKey){const ye=Ut(Q.x,Q.y);N(ye,"start"),Ne(!0);return}if(u&&d){const ye=Ut(Q.x,Q.y);d(ye);return}if(l==="select"||Te.shiftKey){he(!0);const ye=Ut(Q.x,Q.y),ze={x:Math.floor(ye.x),y:Math.floor(ye.y)};Le(ze),ce(null),i&&i(null)}else U(!0),V({x:Q.x-r.x,y:Q.y-r.y})}},kr=Te=>{const Q=Jt(Te),Ce=Ut(Q.x,Q.y);if(it.current=Ce,!lt(Ce)){if(pe&&D){D(Ce,"move");return}if(de&&N){N(Ce,"move");return}if(ie&&ee){const ye=Ut(Q.x,Q.y),ze=Math.floor(ye.x),ot=Math.floor(ye.y),ct=Math.min(ee.x,ze),Ct=Math.min(ee.y,ot),tt=Math.max(ee.x,ze),Hr=Math.max(ee.y,ot),gr=tt-ct+1,Qt=Hr-Ct+1;ce({x:ct,y:Ct,w:gr,h:Qt})}else G&&n({x:Q.x-X.x,y:Q.y-X.y})}},_r=()=>{pe&&D&&(D(it.current||{x:0,y:0},"end"),ke(!1)),me&&(Nt(),Be(!1),Xe(null),Qe.current=null,se.current=null),de&&(N&&N({x:0,y:0},"end"),Ne(!1)),ie&&(he(!1),fe&&i&&fe.w>0&&fe.h>0&&i(fe)),U(!1)},zr=Te=>{var Q;if(Te.touches.length===1){const Ce=Te.touches[0],ye=(Q=B.current)==null?void 0:Q.getBoundingClientRect();if(!ye)return;const ze=Ce.clientX-ye.left,ot=Ce.clientY-ye.top,ct=Ut(ze,ot);if(it.current=ct,S.mode==="center"&&A){A(ct);return}if(S.mode==="drag"&&D){D(ct,"start"),ke(!0);return}if(Tr(ct))return;if(j&&T){T(ct);return}if(u&&d){const Ct=Ut(ze,ot);d(Ct);return}if(M!=null&&M.enabled&&N&&l!=="select"){const Ct=Ut(ze,ot);N(Ct,"start"),Ne(!0);return}if(l==="select"){const Ct=Ut(ze,ot),tt={x:Math.floor(Ct.x),y:Math.floor(Ct.y)};Le(tt),he(!0),ce(null),i&&i(null)}else te.current={x:ze,y:ot},V({x:ze-r.x,y:ot-r.y}),U(!0)}else if(Te.touches.length===2){const Ce=Math.hypot(Te.touches[0].clientX-Te.touches[1].clientX,Te.touches[0].clientY-Te.touches[1].clientY);z.current=Ce,q.current=t,U(!1),he(!1)}},Or=Te=>{var Q;if(Te.touches.length===1){const Ce=Te.touches[0],ye=(Q=B.current)==null?void 0:Q.getBoundingClientRect();if(!ye)return;const ze=Ce.clientX-ye.left,ot=Ce.clientY-ye.top,ct=Ut(ze,ot);if(it.current=ct,lt(ct))return;if(pe&&D){D(ct,"move");return}if(u)return;if(de&&N){N(ct,"move");return}if(ie&&ee){const Ct=Ut(ze,ot),tt=Math.floor(Ct.x),Hr=Math.floor(Ct.y),gr=Math.min(ee.x,tt),Qt=Math.min(ee.y,Hr),jt=Math.max(ee.x,tt),mr=Math.max(ee.y,Hr),R=jt-gr+1,sr=mr-Qt+1;ce({x:gr,y:Qt,w:R,h:sr})}else G&&n({x:ze-X.x,y:ot-X.y})}else if(Te.touches.length===2&&z.current&&q.current&&a){const ye=Math.hypot(Te.touches[0].clientX-Te.touches[1].clientX,Te.touches[0].clientY-Te.touches[1].clientY)/z.current;a(q.current*ye)}},or=()=>{pe&&D&&(D(it.current||{x:0,y:0},"end"),ke(!1)),me&&(Nt(),Be(!1),Xe(null),Qe.current=null,se.current=null),de&&N&&(N({x:0,y:0},"end"),Ne(!1)),ie&&(he(!1),fe&&i&&fe.w>0&&fe.h>0&&i(fe)),U(!1),z.current=null,q.current=null,te.current=null},Br=S.mode!=="off"||j?"cursor-crosshair":me?"cursor-grabbing":k?"cursor-pointer":M!=null&&M.enabled||u||l==="select"||(Xt=window.event)!=null&&Xt.shiftKey?"cursor-crosshair":"cursor-grab active:cursor-grabbing";return c.jsx("canvas",{ref:B,className:`w-full h-full block touch-none ${Br}`,onMouseDown:wr,onMouseMove:kr,onMouseUp:_r,onMouseLeave:_r,onTouchStart:zr,onTouchMove:Or,onTouchEnd:or,onTouchCancel:or,tabIndex:0})},RE="modulepreload",DE=function(e){return"/"+e},Ak={},St=function(t,r,n){let a=Promise.resolve();if(r&&r.length>0){document.getElementsByTagName("link");const o=document.querySelector("meta[property=csp-nonce]"),s=(o==null?void 0:o.nonce)||(o==null?void 0:o.getAttribute("nonce"));a=Promise.allSettled(r.map(l=>{if(l=DE(l),l in Ak)return;Ak[l]=!0;const u=l.endsWith(".css"),d=u?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${l}"]${d}`))return;const f=document.createElement("link");if(f.rel=u?"stylesheet":RE,u||(f.as="script"),f.crossOrigin="",f.href=l,s&&f.setAttribute("nonce",s),document.head.appendChild(f),u)return new Promise((h,g)=>{f.addEventListener("load",h),f.addEventListener("error",()=>g(new Error(`Unable to preload CSS for ${l}`)))})}))}function i(o){const s=new Event("vite:preloadError",{cancelable:!0});if(s.payload=o,window.dispatchEvent(s),!s.defaultPrevented)throw o}return a.then(o=>{for(const s of o||[])s.status==="rejected"&&i(s.reason);return t().catch(i)})};function oc(e){const[[t,r,n],[a,i,o],[s,l,u]]=e,d=t*(i*u-o*l)-r*(a*u-o*s)+n*(a*l-i*s);if(Math.abs(d)<1e-10)return null;const f=1/d;return[[(i*u-o*l)*f,(n*l-r*u)*f,(r*o-n*i)*f],[(o*s-a*u)*f,(t*u-n*s)*f,(n*a-t*o)*f],[(a*l-i*s)*f,(r*s-t*l)*f,(t*i-r*a)*f]]}function $E(e,t){const[[r,n,a],[i,o,s],[l,u,d]]=e,[f,h,g]=t;return[r*f+n*h+a*g,i*f+o*h+s*g,l*f+u*h+d*g]}function Hf(e,t){const r=[[0,0,0],[0,0,0],[0,0,0]];for(let n=0;n<3;n++)for(let a=0;a<3;a++)for(let i=0;i<3;i++)r[n][a]+=e[n][i]*t[i][a];return r}function LE(e){const t=e.length;if(t<2)return s=>{var l;return((l=e[0])==null?void 0:l.y)||0};const r=[...e].sort((s,l)=>s.x-l.x),n=r.map(s=>s.x),a=r.map(s=>s.y),i=new Float32Array(t-1),o=new Float32Array(t);for(let s=0;s<t-1;s++){const l=n[s+1]-n[s],u=a[s+1]-a[s];i[s]=u/(l||1e-9)}o[0]=i[0];for(let s=1;s<t-1;s++)o[s]=(i[s-1]+i[s])*.5;o[t-1]=i[t-2];for(let s=0;s<t-1;s++)if(i[s]===0)o[s]=0,o[s+1]=0;else{const l=o[s]/i[s],u=o[s+1]/i[s],d=l*l+u*u;if(d>9){const f=3/Math.sqrt(d);o[s]=l*f*i[s],o[s+1]=u*f*i[s]}}return s=>{let l=0;if(s<=n[0])return a[0];if(s>=n[t-1])return a[t-1];for(;s>n[l+1]&&l<t-2;)l++;const u=n[l+1]-n[l],d=1/u,h=(s-n[l])*d,g=h*h,v=g*h,w=2*v-3*g+1,b=v-2*g+h,x=-2*v+3*g,y=v-g,_=w*a[l]+b*u*o[l]+x*a[l+1]+y*u*o[l+1];return Math.max(0,Math.min(1,_))}}function Da(e,t=256){const r=LE(e),n=new Float32Array(t);for(let a=0;a<t;a++){const i=a/(t-1);n[a]=r(i)}return n}class sc{constructor(t){Ht(this,"size");Ht(this,"isPowerOfTwo");Ht(this,"_real");Ht(this,"_imag");Ht(this,"_scratch",null);Ht(this,"_rev",null);Ht(this,"_m",0);Ht(this,"_internalFFT",null);Ht(this,"_chirpReal",null);Ht(this,"_chirpImag",null);Ht(this,"_bReal",null);Ht(this,"_bImag",null);Ht(this,"_hanning",null);Ht(this,"_windowSumSq",0);this.size=t,this.isPowerOfTwo=(t&t-1)===0&&t>0,this._real=new Float32Array(t),this._imag=new Float32Array(t),this.isPowerOfTwo?this.initRadix2():this.initBluestein()}initRadix2(){const t=this.size,r=Math.log2(t);this._rev=new Uint32Array(t);for(let n=0;n<t;n++){let a=0,i=n;for(let o=0;o<r;o++)a=a<<1|i&1,i>>>=1;this._rev[n]=a}}initBluestein(){const t=this.size;this._m=Math.pow(2,Math.ceil(Math.log2(2*t-1))),this._internalFFT=new sc(this._m),this._chirpReal=new Float32Array(t),this._chirpImag=new Float32Array(t);for(let a=0;a<t;a++){const i=-Math.PI*(a*a)/t;this._chirpReal[a]=Math.cos(i),this._chirpImag[a]=Math.sin(i)}const r=new Float32Array(this._m),n=new Float32Array(this._m);for(let a=0;a<t;a++)r[a]=this._chirpReal[a],n[a]=-this._chirpImag[a];for(let a=1;a<t;a++)r[this._m-a]=r[a],n[this._m-a]=n[a];this._internalFFT.transform(r,n),this._bReal=new Float32Array(this._internalFFT._real),this._bImag=new Float32Array(this._internalFFT._imag)}initHanning(){if(this._hanning)return;const t=this.size;this._hanning=new Float32Array(t);let r=0;for(let n=0;n<t;n++){const a=.5*(1-Math.cos(2*Math.PI*n/(t-1)));this._hanning[n]=a,r+=a*a}this._windowSumSq=r}transform(t,r){this.isPowerOfTwo?this.transformRadix2(t,r):this.transformBluestein(t,r)}transformRadix2(t,r){const n=this.size,a=this._rev,i=this._real,o=this._imag;if(t===i)for(let s=0;s<n;s++){const l=a[s];if(s<l){const u=i[s],d=o[s];i[s]=i[l],o[s]=o[l],i[l]=u,o[l]=d}}else for(let s=0;s<n;s++){const l=a[s];i[s]=t[l],o[s]=r?r[l]:0}for(let s=2;s<=n;s*=2){const l=s/2,u=-2*Math.PI/s,d=Math.cos(u),f=Math.sin(u);for(let h=0;h<n;h+=s){let g=1,v=0;for(let w=0;w<l;w++){const b=h+w,x=h+w+l,y=g*i[x]-v*o[x],_=g*o[x]+v*i[x],j=i[b],S=o[b];i[b]=j+y,o[b]=S+_,i[x]=j-y,o[x]=S-_;const k=g*d-v*f,M=g*f+v*d;g=k,v=M}}}}transformBluestein(t,r){const n=this.size,a=this._m,i=this._internalFFT,o=i._real,s=i._imag;o.fill(0),s.fill(0);for(let f=0;f<n;f++){const h=t[f],g=r?r[f]:0,v=this._chirpReal[f],w=this._chirpImag[f];o[f]=h*v-g*w,s[f]=h*w+g*v}i.transformRadix2(o,s);for(let f=0;f<a;f++){const h=i._real[f],g=i._imag[f],v=this._bReal[f],w=this._bImag[f];i._real[f]=h*v-g*w,i._imag[f]=h*w+g*v}const l=i._real,u=i._imag;for(let f=0;f<a;f++)u[f]=-u[f];i.transformRadix2(l,u);const d=1/a;for(let f=0;f<n;f++){const h=i._real[f]*d,g=-i._imag[f]*d,v=this._chirpReal[f],w=this._chirpImag[f];this._real[f]=h*v-g*w,this._imag[f]=h*w+g*v}}calculateSpectrum(t,r,n=!1){const a=this.size;let i=0;for(let d=0;d<a;d++)i+=t[d];const o=i/a;this._scratch||(this._scratch=new Float32Array(a));const s=this._scratch;if(n){this.initHanning();const d=this._hanning;for(let f=0;f<a;f++)s[f]=(t[f]-o)*d[f]}else for(let d=0;d<a;d++)s[d]=t[d]-o;this.transform(s);const l=r.length;let u=1/a;n&&this._windowSumSq>0&&(u=1/this._windowSumSq);for(let d=0;d<l;d++){const f=this._real[d],h=this._imag[d];r[d]+=(f*f+h*h)*u}}}function Ek(e,t,r,n=!1){const a=new sc(t),i=new sc(r),o=t*r,s=new Float32Array(o),l=new Float32Array(o);let u=null,d=null;if(n){u=new Float32Array(t);for(let w=0;w<t;w++)u[w]=.5*(1-Math.cos(2*Math.PI*w/(t-1)));d=new Float32Array(r);for(let w=0;w<r;w++)d[w]=.5*(1-Math.cos(2*Math.PI*w/(r-1)))}for(let w=0;w<r;w++){const b=w*t,x=a._real;let y=0;for(let j=0;j<t;j++)y+=e[b+j];const _=y/t;if(u)for(let j=0;j<t;j++)x[j]=(e[b+j]-_)*u[j];else for(let j=0;j<t;j++)x[j]=e[b+j]-_;a.transform(x);for(let j=0;j<t;j++)s[b+j]=a._real[j],l[b+j]=a._imag[j]}for(let w=0;w<t;w++){const b=i._real,x=i._imag;for(let y=0;y<r;y++){const _=y*t+w;let j=s[_],S=l[_];d&&(j*=d[y],S*=d[y]),b[y]=j,x[y]=S}i.transform(b,x);for(let y=0;y<r;y++){const _=y*t+w;s[_]=i._real[y],l[_]=i._imag[y]}}const f=new Float32Array(o);let h=1,g=t,v=r;if(n&&u&&d){g=0;for(let w=0;w<t;w++)g+=u[w]*u[w];v=0;for(let w=0;w<r;w++)v+=d[w]*d[w]}h=1/(g*v);for(let w=0;w<o;w++)f[w]=(s[w]*s[w]+l[w]*l[w])*h;return f}function Tk(e,t,r){const n=new Float32Array(e.length),a=Math.floor(t/2),i=Math.floor(r/2);for(let o=0;o<r;o++)for(let s=0;s<t;s++){const l=(s+a)%t,u=(o+i)%r,d=o*t+s,f=u*t+l;n[f]=e[d]}return n}const lc=e=>`${e}_${Date.now()}_${Math.random().toString(36).slice(2,8)}`,Lr=e=>Math.max(0,Math.min(1,e)),du=e=>{const t=Lr(e);return t<=.0031308?12.92*t:1.055*Math.pow(t,1/2.4)-.055},_y=e=>{const t=Lr(e);return t<=.04045?t/12.92:Math.pow((t+.055)/1.055,2.4)},fh=[{x:0,y:0},{x:1,y:1}],hh=e=>e.map(t=>({x:t.x,y:t.y})),Hb=()=>({master:hh(fh),red:hh(fh),green:hh(fh),blue:hh(fh)}),BE=["red","orange","yellow","green","aqua","blue","purple","magenta"],PP=()=>({exposure:0,temperature:0,tint:0,contrast:0,highlights:0,shadows:0,vibrance:0,saturation:0}),Is=()=>({hue:0,saturation:0,luminance:0}),Xb=()=>({red:Is(),orange:Is(),yellow:Is(),green:Is(),aqua:Is(),blue:Is(),purple:Is(),magenta:Is()}),so=(e,t,r,n=0)=>{const a=Number(e);return Number.isFinite(a)?Math.max(t,Math.min(r,a)):n},Su=e=>({exposure:so(e==null?void 0:e.exposure,-5,5,0),temperature:so(e==null?void 0:e.temperature,-100,100,0),tint:so(e==null?void 0:e.tint,-100,100,0),contrast:so(e==null?void 0:e.contrast,-100,100,0),highlights:so(e==null?void 0:e.highlights,-100,100,0),shadows:so(e==null?void 0:e.shadows,-100,100,0),vibrance:so(e==null?void 0:e.vibrance,-100,100,0),saturation:so(e==null?void 0:e.saturation,-100,100,0)}),_u=e=>{const t=Xb(),r=n=>{var a,i,o;return{hue:so((a=e==null?void 0:e[n])==null?void 0:a.hue,-100,100,t[n].hue),saturation:so((i=e==null?void 0:e[n])==null?void 0:i.saturation,-100,100,t[n].saturation),luminance:so((o=e==null?void 0:e[n])==null?void 0:o.luminance,-100,100,t[n].luminance)}};return{red:r("red"),orange:r("orange"),yellow:r("yellow"),green:r("green"),aqua:r("aqua"),blue:r("blue"),purple:r("purple"),magenta:r("magenta")}},Yg=e=>{const t=Hb();if(!e)return t;const r=n=>{const a=e==null?void 0:e[n];if(!Array.isArray(a)||a.length<2)return t[n];const i=a.map(o=>({x:Math.max(0,Math.min(1,Number((o==null?void 0:o.x)??0))),y:Math.max(0,Math.min(1,Number((o==null?void 0:o.y)??0)))})).filter(o=>!Number.isNaN(o.x)&&!Number.isNaN(o.y)).sort((o,s)=>o.x-s.x);return i.length<2?t[n]:(i[0].x=0,i[i.length-1].x=1,i)};return{master:r("master"),red:r("red"),green:r("green"),blue:r("blue")}},FE=(e,t,r,n,a,i,o,s,l)=>{const u=Math.max(1,i),d=Lr(o),f=Lr(l),h=u,g=u*(1+f*1.5),v=g*g,w=Math.max(0,Math.floor(n-g)),b=Math.max(0,Math.floor(a-g)),x=Math.min(t-1,Math.ceil(n+g)),y=Math.min(r-1,Math.ceil(a+g));for(let _=b;_<=y;_++){const j=_*t;for(let S=w;S<=x;S++){const k=S-n,M=_-a,N=k*k+M*M;if(N>v)continue;const T=Math.sqrt(N);let A=1;if(T>h){const J=Math.max(1e-6,g-h);A=Lr((g-T)/J)}const D=Lr(d*A),$=j+S,B=e[$];e[$]=s==="add"?B+(1-B)*D:B*(1-D)}}},UE=(e,t,r,n)=>{const a=n.center.x,i=n.center.y,o=Math.max(1,n.radiusX),s=Math.max(1,n.radiusY),l=Math.max(1,Math.min(o,s)),u=Math.max(0,Math.min(n.featherPx,l*.95)),d=n.rotationDeg*Math.PI/180,f=Math.cos(d),h=Math.sin(d),g=Math.ceil(Math.max(o,s))+2,v=Math.max(0,Math.floor(a-g)),w=Math.max(0,Math.floor(i-g)),b=Math.min(t-1,Math.ceil(a+g)),x=Math.min(r-1,Math.ceil(i+g));for(let y=w;y<=x;y++){const _=y*t;for(let j=v;j<=b;j++){const S=j-a,k=y-i,M=S*f+k*h,N=-S*h+k*f,T=Math.sqrt(M*M/(o*o)+N*N/(s*s));if(T>1)continue;let A=1;if(u>0){const B=(1-T)*l;A=Lr(B/u)}const D=_+j,$=e[D];e[D]=n.mode==="add"?$+(1-$)*A:$*(1-A)}}},Kb=e=>{const t=new Float32Array(e.width*e.height);for(const r of e.items||[])if(r.visible)if(r.type==="ellipse")UE(t,e.width,e.height,r);else for(const n of r.points)FE(t,e.width,e.height,n.x,n.y,r.sizePx,r.opacity,r.mode,r.feather);return t};function CP(e){const t=e.masks.map(r=>{const n=Kb(r);return{...r,alpha:n,version:r.version+1}});return{...e,masks:t}}function GE(e){const t=e.width,r=e.height,n=e.alpha;let a=t,i=r,o=-1,s=-1;for(let u=0;u<r;u++){const d=u*t;for(let f=0;f<t;f++)n[d+f]<=1e-4||(f<a&&(a=f),u<i&&(i=u),f>o&&(o=f),u>s&&(s=u))}if(o<a||s<i)return null;const l=2;return{x0:Math.max(0,a-l),y0:Math.max(0,i-l),x1:Math.min(t-1,o+l),y1:Math.min(r-1,s+l)}}function Ik(e,t,r,n){return{id:e,width:t,height:r,baseRgb:n,masks:[],layers:[],guides:[],selectedGuideId:null,selectedMaskId:"",selectedLayerId:"",selectedMaskItemId:null,transform:{rotationDeg:0,crop:null},history:[{id:lc("history"),label:"Initialize PS Document",timestamp:Date.now()}],historyIndex:0}}function zE(e){const t=new Float32Array(e.length);for(let r=0;r<e.length;r++)t[r]=e[r]/65535;return t}function MP(e){const t=new Float32Array(e.width*e.height*3),r=e.data;for(let n=0,a=0;n<r.length;n+=4,a+=3)t[a]=_y(r[n]/255),t[a+1]=_y(r[n+1]/255),t[a+2]=_y(r[n+2]/255);return t}async function WE(e){const t=e.naturalWidth||e.width,r=e.naturalHeight||e.height,n=document.createElement("canvas");n.width=t,n.height=r;const a=n.getContext("2d");if(!a)throw new Error("Failed to create 2D context for raster-to-float conversion.");a.drawImage(e,0,0,t,r);const i=a.getImageData(0,0,t,r);return{width:t,height:r,data:MP(i)}}function Yb(e){const t=lc("mask"),r=lc("layer"),n={id:t,name:`Mask ${e.masks.length+1}`,shape:"full",width:e.width,height:e.height,alpha:new Float32Array(e.width*e.height),version:1,featherPx:0,visible:!0,overlayVisible:!0,items:[]},a={id:r,name:`Layer ${e.layers.length+1}`,maskId:t,blendMode:"add",enabled:!0,opacity:1,basic:PP(),mixer:Xb(),curves:Hb()};return{...e,masks:[...e.masks,n],layers:[...e.layers,a],selectedMaskId:t,selectedLayerId:r,selectedMaskItemId:null}}function NP(e,t){if(!e.masks.some(o=>o.id===t))return e;const n=e.layers.find(o=>o.maskId===t);if(n)return{...e,selectedMaskId:t,selectedLayerId:n.id,selectedMaskItemId:null};const a=lc("layer"),i={id:a,name:`Layer ${e.layers.length+1}`,maskId:t,blendMode:"add",enabled:!0,opacity:1,basic:PP(),mixer:Xb(),curves:Hb()};return{...e,layers:[...e.layers,i],selectedMaskId:t,selectedLayerId:a,selectedMaskItemId:null}}function VE(e,t){const r=(e.width-1)*.5,n=(e.height-1)*.5,a=Math.max(8,e.width*.4),i=Math.max(8,e.height*.4),o={id:lc("guide"),orientation:t,p1:t==="horizontal"?{x:r-a*.5,y:n}:{x:r,y:n-i*.5},p2:t==="horizontal"?{x:r+a*.5,y:n}:{x:r,y:n+i*.5},visible:!0};return{...e,guides:[...e.guides,o],selectedGuideId:o.id}}function HE(e,t){return t===null?{...e,selectedGuideId:null}:e.guides.some(n=>n.id===t)?{...e,selectedGuideId:t}:e}function Rk(e,t,r,n){const a=s=>({x:Math.max(0,Math.min(e.width-1,s.x)),y:Math.max(0,Math.min(e.height-1,s.y))});let i=!1;const o=e.guides.map(s=>{if(s.id!==t)return s;const l=a(r),u=a(n);return Math.abs(l.x-s.p1.x)<1e-6&&Math.abs(l.y-s.p1.y)<1e-6&&Math.abs(u.x-s.p2.x)<1e-6&&Math.abs(u.y-s.p2.y)<1e-6?s:(i=!0,{...s,p1:l,p2:u})});return i?{...e,guides:o}:e}function XE(e,t){const r=e.guides.filter(n=>n.id!==t);return r.length===e.guides.length?e:{...e,guides:r,selectedGuideId:e.selectedGuideId===t?null:e.selectedGuideId}}function KE(e,t,r=0,n="add"){var d;const a=e.selectedMaskId?e:Yb(e),i=a.selectedMaskId;if(!i)return a;const o=a.masks.map(f=>{if(f.id!==i)return f;const h=f.items||[],g={id:lc("item"),name:`Ellipse ${h.filter(b=>b.type==="ellipse").length+1}`,type:"ellipse",mode:n,visible:!0,center:{x:t.center.x,y:t.center.y},radiusX:Math.max(1,t.radiusX),radiusY:Math.max(1,t.radiusY),rotationDeg:t.rotationDeg??0,featherPx:Math.max(0,r)},v=[...h,g];return{...f,shape:"ellipse",items:v,alpha:Kb({...f,items:v}),version:f.version+1}}),s=o.find(f=>f.id===i),l=(s==null?void 0:s.items)||[],u=((d=l[l.length-1])==null?void 0:d.id)||null;return{...a,masks:o,selectedMaskItemId:u}}function YE(e,t,r,n,a,i,o=1){const s=e.selectedMaskId?e:Yb(e);if(!s.selectedMaskId)return s;const l=Math.max(1,n),u=Lr(a),d=Lr(o),f=l,h=l*(1+d*1.5),g=h*h,v=s.masks.map(w=>{if(w.id!==s.selectedMaskId)return w;const b=w.alpha,x=Math.max(0,Math.floor(t-h)),y=Math.max(0,Math.floor(r-h)),_=Math.min(w.width-1,Math.ceil(t+h)),j=Math.min(w.height-1,Math.ceil(r+h));for(let S=y;S<=j;S++){const k=S*w.width;for(let M=x;M<=_;M++){const N=M-t,T=S-r,A=N*N+T*T;if(A>g)continue;const D=Math.sqrt(A);let $=1;if(D>f){const I=Math.max(1e-6,h-f);$=Lr((h-D)/I)}const B=Lr(u*$),J=k+M,W=b[J];b[J]=i==="add"?W+(1-W)*B:W*(1-B)}}return{...w,alpha:b,version:w.version+1}});return{...s,masks:v}}function qE(e,t,r,n,a,i){var d;if(!e.selectedMaskId||t.length===0)return e;const o=e.masks.map(f=>{if(f.id!==e.selectedMaskId)return f;const h=f.items||[],g=t.map(_=>({x:_.x,y:_.y})),v=Math.max(1,r),w=Lr(n),b=Lr(i),x=h[h.length-1];if(x&&x.type==="brush"&&tT(x,{points:g,sizePx:v,opacity:w,mode:a,feather:b})){const _=x.points[x.points.length-1],j=g.filter((k,M)=>M!==0||Math.hypot(k.x-_.x,k.y-_.y)>.5),S={...x,points:[...x.points,...j]};return{...f,shape:"brush",items:[...h.slice(0,-1),S]}}const y={id:lc("item"),name:`Brush ${h.filter(_=>_.type==="brush").length+1}`,type:"brush",mode:a,visible:!0,sizePx:v,opacity:w,feather:b,points:g};return{...f,shape:"brush",items:[...h,y]}}),s=o.find(f=>f.id===e.selectedMaskId),l=(s==null?void 0:s.items)||[],u=((d=l[l.length-1])==null?void 0:d.id)||null;return{...e,masks:o,selectedMaskItemId:u}}function ZE(e,t){if(!t)return{...e,selectedMaskItemId:null};const r=e.selectedMaskId?e.masks.find(i=>i.id===e.selectedMaskId):null;if(r&&(r.items||[]).some(i=>i.id===t))return{...e,selectedMaskItemId:t};const n=e.masks.find(i=>(i.items||[]).some(o=>o.id===t));return n?{...NP(e,n.id),selectedMaskItemId:t}:{...e,selectedMaskItemId:null}}function JE(e,t,r){if(!e.selectedMaskId)return e;let n=!1;const a=e.masks.map(i=>{if(i.id!==e.selectedMaskId)return i;const o=(i.items||[]).map(s=>s.id!==t||s.type!=="ellipse"?s:(n=!0,{...s,...r,center:r.center?{x:r.center.x,y:r.center.y}:s.center,radiusX:r.radiusX!==void 0?Math.max(1,r.radiusX):s.radiusX,radiusY:r.radiusY!==void 0?Math.max(1,r.radiusY):s.radiusY,featherPx:r.featherPx!==void 0?Math.max(0,r.featherPx):s.featherPx}));return n?{...i,items:o,alpha:Kb({...i,items:o}),version:i.version+1}:i});return n?{...e,masks:a}:e}function QE(e,t,r){let n=!1;const a=e.masks.map(i=>i.id!==t||(i.overlayVisible??!0)===r?i:(n=!0,{...i,overlayVisible:r}));return n?{...e,masks:a}:e}const bf=(e,t)=>[e[0]*t[0]+e[1]*t[3]+e[2]*t[6],e[0]*t[1]+e[1]*t[4]+e[2]*t[7],e[0]*t[2]+e[1]*t[5]+e[2]*t[8],e[3]*t[0]+e[4]*t[3]+e[5]*t[6],e[3]*t[1]+e[4]*t[4]+e[5]*t[7],e[3]*t[2]+e[4]*t[5]+e[5]*t[8],e[6]*t[0]+e[7]*t[3]+e[8]*t[6],e[6]*t[1]+e[7]*t[4]+e[8]*t[7],e[6]*t[2]+e[7]*t[5]+e[8]*t[8]],eT=e=>{const t=e[0],r=e[1],n=e[2],a=e[3],i=e[4],o=e[5],s=e[6],l=e[7],u=e[8],d=i*u-o*l,f=-(a*u-o*s),h=a*l-i*s,g=-(r*u-n*l),v=t*u-n*s,w=-(t*l-r*s),b=r*o-n*i,x=-(t*o-n*a),y=t*i-r*a,_=t*d+r*f+n*h;if(Math.abs(_)<1e-12)return null;const j=1/_;return[d*j,g*j,b*j,f*j,v*j,x*j,h*j,w*j,y*j]},Ha=(e,t)=>{const r=t.x,n=t.y,a=e[6]*r+e[7]*n+e[8];return Math.abs(a)<1e-12?{x:0,y:0}:{x:(e[0]*r+e[1]*n+e[2])/a,y:(e[3]*r+e[4]*n+e[5])/a}},tT=(e,t)=>{if(e.mode!==t.mode||Math.abs(e.sizePx-t.sizePx)>.25||Math.abs(e.opacity-t.opacity)>.02||Math.abs(e.feather-t.feather)>.02||e.points.length===0||t.points.length===0)return!1;const r=e.points[e.points.length-1],n=t.points[0],a=Math.hypot(r.x-n.x,r.y-n.y),i=Math.max(4,Math.min(e.sizePx,t.sizePx)*1.5);return a<=i},rT=(e,t)=>{const r=e.rotationDeg*Math.PI/180,n=Math.cos(r),a=Math.sin(r),i=-a,o=n,s=e.center,l={x:s.x+n*e.radiusX,y:s.y+a*e.radiusX},u={x:s.x+i*e.radiusY,y:s.y+o*e.radiusY},d=Ha(t,s),f=Ha(t,l),h=Ha(t,u),g=Math.max(1,Math.hypot(f.x-d.x,f.y-d.y)),v=Math.max(1,Math.hypot(h.x-d.x,h.y-d.y)),w=Math.atan2(f.y-d.y,f.x-d.x)*180/Math.PI;return{...e,center:d,radiusX:g,radiusY:v,rotationDeg:w}},Ks=(e,t,r,n,a,i,o=0)=>{if(n<0||a<0||n>t-1||a>r-1)return 0;const s=Math.floor(n),l=Math.floor(a),u=Math.min(t-1,s+1),d=Math.min(r-1,l+1),f=n-s,h=a-l,g=(j,S)=>i===1?S*t+j:(S*t+j)*3+o,v=e[g(s,l)],w=e[g(u,l)],b=e[g(s,d)],x=e[g(u,d)],y=v*(1-f)+w*f,_=b*(1-f)+x*f;return y*(1-h)+_*h},OP=(e,t,r)=>{const a=[{x:0,y:0},{x:e-1,y:0},{x:e-1,y:t-1},{x:0,y:t-1}].map(s=>Ha(r,s)),i=a.map(s=>s.x),o=a.map(s=>s.y);return{minX:Math.min(...i),maxX:Math.max(...i),minY:Math.min(...o),maxY:Math.max(...o)}},AP=(e,t)=>{const r=OP(e.width,e.height,t),n=-r.minX,a=-r.minY,o=bf([1,0,n,0,1,a,0,0,1],t),s=eT(o);if(!s)return e;const l=Math.max(1,Math.ceil(r.maxX-r.minX+1)),u=Math.max(1,Math.ceil(r.maxY-r.minY+1)),d=new Float32Array(l*u*3);for(let g=0;g<u;g++)for(let v=0;v<l;v++){const w=Ha(s,{x:v,y:g}),b=(g*l+v)*3;d[b]=Ks(e.baseRgb,e.width,e.height,w.x,w.y,3,0),d[b+1]=Ks(e.baseRgb,e.width,e.height,w.x,w.y,3,1),d[b+2]=Ks(e.baseRgb,e.width,e.height,w.x,w.y,3,2)}const f=e.masks.map(g=>{const v=new Float32Array(l*u);for(let b=0;b<u;b++)for(let x=0;x<l;x++){const y=Ha(s,{x,y:b});v[b*l+x]=Ks(g.alpha,g.width,g.height,y.x,y.y,1)}const w=(g.items||[]).map(b=>b.type==="brush"?{...b,points:b.points.map(x=>Ha(o,x)).filter(x=>x.x>=0&&x.y>=0&&x.x<=l-1&&x.y<=u-1)}:rT(b,o)).filter(b=>b.type==="ellipse"?b.center.x>=-Math.max(b.radiusX,b.radiusY)&&b.center.y>=-Math.max(b.radiusX,b.radiusY)&&b.center.x<=l-1+Math.max(b.radiusX,b.radiusY)&&b.center.y<=u-1+Math.max(b.radiusX,b.radiusY):b.points.length>0);return{...g,width:l,height:u,alpha:v,version:g.version+1,featherPx:0,items:w}}),h=e.guides.map(g=>({...g,p1:Ha(o,g.p1),p2:Ha(o,g.p2)}));return{...e,width:l,height:u,baseRgb:d,masks:f,guides:h,selectedMaskItemId:f.some(g=>(g.items||[]).some(v=>v.id===e.selectedMaskItemId))?e.selectedMaskItemId:null,transform:{rotationDeg:0,crop:null}}},nT=(e,t,r,n,a,i)=>{let o=0,s=1;const l=t.x-e.x,u=t.y-e.y,d=(f,h)=>{if(Math.abs(f)<1e-12)return h>=0;const g=h/f;return f<0?g>s?!1:(g>o&&(o=g),!0):g<o?!1:(g<s&&(s=g),!0)};return!d(-l,e.x-r)||!d(l,a-e.x)||!d(-u,e.y-n)||!d(u,i-e.y)?null:{p1:{x:e.x+o*l,y:e.y+o*u},p2:{x:e.x+s*l,y:e.y+s*u}}};function EP(e,t){const r=Math.max(0,Math.min(e.width-1,Math.floor(t.x))),n=Math.max(0,Math.min(e.height-1,Math.floor(t.y))),a=Math.max(r+1,Math.min(e.width,Math.ceil(t.x+t.w))),i=Math.max(n+1,Math.min(e.height,Math.ceil(t.y+t.h))),o=a-r,s=i-n;if(o===e.width&&s===e.height&&r===0&&n===0)return e;const l=new Float32Array(o*s*3);for(let f=0;f<s;f++)for(let h=0;h<o;h++){const g=((f+n)*e.width+(h+r))*3,v=(f*o+h)*3;l[v]=e.baseRgb[g],l[v+1]=e.baseRgb[g+1],l[v+2]=e.baseRgb[g+2]}const u=e.masks.map(f=>{const h=new Float32Array(o*s);for(let v=0;v<s;v++)for(let w=0;w<o;w++)h[v*o+w]=f.alpha[(v+n)*f.width+(w+r)];const g=(f.items||[]).map(v=>v.type==="brush"?{...v,points:v.points.map(w=>({x:w.x-r,y:w.y-n})).filter(w=>w.x>=0&&w.y>=0&&w.x<=o-1&&w.y<=s-1)}:{...v,center:{x:v.center.x-r,y:v.center.y-n}}).filter(v=>v.type==="ellipse"?v.center.x>=-Math.max(v.radiusX,v.radiusY)&&v.center.y>=-Math.max(v.radiusX,v.radiusY)&&v.center.x<=o-1+Math.max(v.radiusX,v.radiusY)&&v.center.y<=s-1+Math.max(v.radiusX,v.radiusY):v.points.length>0);return{...f,width:o,height:s,alpha:h,version:f.version+1,featherPx:0,items:g}}),d=e.guides.map(f=>{const h=nT(f.p1,f.p2,r,n,a-1,i-1);return h?{...f,p1:{x:h.p1.x-r,y:h.p1.y-n},p2:{x:h.p2.x-r,y:h.p2.y-n}}:null}).filter(Boolean);return{...e,width:o,height:s,baseRgb:l,masks:u,guides:d,selectedGuideId:d.some(f=>f.id===e.selectedGuideId)?e.selectedGuideId:null,selectedMaskItemId:u.some(f=>(f.items||[]).some(h=>h.id===e.selectedMaskItemId))?e.selectedMaskItemId:null,transform:{rotationDeg:0,crop:null}}}function TP(e,t){const r=t*Math.PI/180,n=Math.cos(r),a=Math.sin(r),i=(e.width-1)*.5,o=(e.height-1)*.5,s=[1,0,-i,0,1,-o,0,0,1],l=[n,-a,0,a,n,0,0,0,1],d=bf([1,0,i,0,1,o,0,0,1],bf(l,s)),f=OP(e.width,e.height,d),h=bf([1,0,-f.minX,0,1,-f.minY,0,0,1],d),g=AP(e,d),v=g.masks.map(w=>{const b=e.masks.find(y=>y.id===w.id);if(!b)return w;const x=(b.items||[]).map(y=>y.type==="brush"?{...y,points:y.points.map(_=>Ha(h,_)).filter(_=>_.x>=0&&_.y>=0&&_.x<=g.width-1&&_.y<=g.height-1)}:{...y,center:Ha(h,y.center),rotationDeg:y.rotationDeg+t}).filter(y=>y.type==="ellipse"?!0:y.points.length>0);return{...w,items:x}});return{...g,masks:v,selectedMaskItemId:v.some(w=>(w.items||[]).some(b=>b.id===e.selectedMaskItemId))?e.selectedMaskItemId:null}}function IP(e){const t=e.width,r=e.height,n=new Float32Array(e.baseRgb.length);for(let i=0;i<r;i++)for(let o=0;o<t;o++){const s=t-1-o,l=(i*t+s)*3,u=(i*t+o)*3;n[u]=e.baseRgb[l],n[u+1]=e.baseRgb[l+1],n[u+2]=e.baseRgb[l+2]}const a=e.masks.map(i=>{const o=new Float32Array(i.alpha.length);for(let s=0;s<r;s++)for(let l=0;l<t;l++)o[s*t+l]=i.alpha[s*t+(t-1-l)];return{...i,alpha:o,version:i.version+1,items:(i.items||[]).map(s=>s.type==="brush"?{...s,points:s.points.map(l=>({x:t-1-l.x,y:l.y}))}:{...s,center:{x:t-1-s.center.x,y:s.center.y},rotationDeg:-s.rotationDeg})}});return{...e,baseRgb:n,masks:a,guides:e.guides.map(i=>({...i,p1:{x:t-1-i.p1.x,y:i.p1.y},p2:{x:t-1-i.p2.x,y:i.p2.y}}))}}function RP(e){const t=e.width,r=e.height,n=new Float32Array(e.baseRgb.length);for(let i=0;i<r;i++){const o=r-1-i;for(let s=0;s<t;s++){const l=(o*t+s)*3,u=(i*t+s)*3;n[u]=e.baseRgb[l],n[u+1]=e.baseRgb[l+1],n[u+2]=e.baseRgb[l+2]}}const a=e.masks.map(i=>{const o=new Float32Array(i.alpha.length);for(let s=0;s<r;s++){const l=r-1-s;for(let u=0;u<t;u++)o[s*t+u]=i.alpha[l*t+u]}return{...i,alpha:o,version:i.version+1,items:(i.items||[]).map(s=>s.type==="brush"?{...s,points:s.points.map(l=>({x:l.x,y:r-1-l.y}))}:{...s,center:{x:s.center.x,y:r-1-s.center.y},rotationDeg:-s.rotationDeg})}});return{...e,baseRgb:n,masks:a,guides:e.guides.map(i=>({...i,p1:{x:i.p1.x,y:r-1-i.p1.y},p2:{x:i.p2.x,y:r-1-i.p2.y}}))}}function DP(e,t){const r=e.width,n=e.height;if(r<=1||n<=1)return e;const a=(r-1)*.5,i=(n-1)*.5,o=Math.max(1e-6,Math.hypot(a,i)),s=t.model,l=Number.isFinite(Number(t.k1))?Number(t.k1):0,u=Number.isFinite(Number(t.k2))?Number(t.k2):0,d=Number.isFinite(Number(t.a))?Number(t.a):0,f=Number.isFinite(Number(t.b))?Number(t.b):0,h=Number.isFinite(Number(t.c))?Number(t.c):0,g=j=>{const S=Math.max(0,j);if(s==="poly3")return l*S*S*S+(1-l)*S;if(s==="poly5"){const T=S*S;return S*(1+l*T+u*T*T)}const k=S*S,M=k*S,N=M*S;return d*N+f*M+h*k+(1-d-f-h)*S},v=j=>{const S=Math.max(0,j);if(S<=1e-8)return 0;let k=S;for(let M=0;M<8;M++){const N=g(k)-S;if(Math.abs(N)<1e-7)break;const T=1e-4,A=g(k+T),D=g(Math.max(0,k-T)),$=(A-D)/(2*T);if(!Number.isFinite($)||Math.abs($)<1e-8)break;if(k-=N/$,!Number.isFinite(k))return S;k=Math.max(0,Math.min(4,k))}return k},w=j=>{const S=j.x-a,k=j.y-i,M=Math.hypot(S,k)/o;if(M<=1e-8)return{x:a,y:i};const T=v(M)/M;return{x:a+S*T,y:i+k*T}},b=j=>{const S=j.rotationDeg*Math.PI/180,k=Math.cos(S),M=Math.sin(S),N=-M,T=k,A=j.center,D={x:A.x+k*j.radiusX,y:A.y+M*j.radiusX},$={x:A.x+N*j.radiusY,y:A.y+T*j.radiusY},B=w(A),J=w(D),W=w($),I=Math.max(1,Math.hypot(J.x-B.x,J.y-B.y)),G=Math.max(1,Math.hypot(W.x-B.x,W.y-B.y)),U=Math.atan2(J.y-B.y,J.x-B.x)*180/Math.PI;return{...j,center:B,radiusX:I,radiusY:G,rotationDeg:U}},x=new Float32Array(e.baseRgb.length);for(let j=0;j<n;j++)for(let S=0;S<r;S++){const k=S-a,M=j-i,N=Math.hypot(k,M)/o,T=g(N),A=N>1e-8?T/N:1,D=a+k*A,$=i+M*A,B=(j*r+S)*3;x[B]=Ks(e.baseRgb,r,n,D,$,3,0),x[B+1]=Ks(e.baseRgb,r,n,D,$,3,1),x[B+2]=Ks(e.baseRgb,r,n,D,$,3,2)}const y=e.masks.map(j=>{const S=new Float32Array(j.alpha.length);for(let M=0;M<n;M++)for(let N=0;N<r;N++){const T=N-a,A=M-i,D=Math.hypot(T,A)/o,$=g(D),B=D>1e-8?$/D:1,J=a+T*B,W=i+A*B;S[M*r+N]=Ks(j.alpha,r,n,J,W,1)}const k=(j.items||[]).map(M=>M.type==="brush"?{...M,points:M.points.map(w).filter(N=>N.x>=0&&N.y>=0&&N.x<=r-1&&N.y<=n-1)}:b(M)).filter(M=>M.type==="ellipse"?M.center.x>=-Math.max(M.radiusX,M.radiusY)&&M.center.y>=-Math.max(M.radiusX,M.radiusY)&&M.center.x<=r-1+Math.max(M.radiusX,M.radiusY)&&M.center.y<=n-1+Math.max(M.radiusX,M.radiusY):M.points.length>0);return{...j,alpha:S,version:j.version+1,items:k,featherPx:0}}),_=e.guides.map(j=>({...j,p1:w(j.p1),p2:w(j.p2)}));return{...e,baseRgb:x,masks:y,guides:_,selectedMaskItemId:y.some(j=>(j.items||[]).some(S=>S.id===e.selectedMaskItemId))?e.selectedMaskItemId:null,transform:{rotationDeg:0,crop:null}}}const Yh=(e,t)=>[e[1]*t[2]-e[2]*t[1],e[2]*t[0]-e[0]*t[2],e[0]*t[1]-e[1]*t[0]],ph=(e,t)=>Yh([e.x,e.y,1],[t.x,t.y,1]),fv=(e,t)=>{const r=Math.hypot(e,t);return r<1e-8?null:{x:e/r,y:t/r}},Dk=e=>{if(e.length===0)return null;let t=0,r=0;for(const n of e)t*n.x+r*n.y<0?(t-=n.x,r-=n.y):(t+=n.x,r+=n.y);return fv(t,r)};function $P(e){const t=e.guides.filter(N=>N.visible!==!1&&N.orientation==="horizontal").slice(0,2),r=e.guides.filter(N=>N.visible!==!1&&N.orientation==="vertical").slice(0,2);if(t.length<2||r.length<2)return e;const n=ph(t[0].p1,t[0].p2),a=ph(t[1].p1,t[1].p2),i=ph(r[0].p1,r[0].p2),o=ph(r[1].p1,r[1].p2),s=Yh(n,a),l=Yh(i,o),u=Yh(s,l);if(Math.abs(u[2])<1e-12)return e;const d=u[0]/u[2],f=u[1]/u[2],h=[1,0,0,0,1,0,d,f,1],g=t.map(N=>{const T=Ha(h,N.p1),A=Ha(h,N.p2);return fv(A.x-T.x,A.y-T.y)}).filter(Boolean),v=r.map(N=>{const T=Ha(h,N.p1),A=Ha(h,N.p2);return fv(A.x-T.x,A.y-T.y)}).filter(Boolean),w=Dk(g),b=Dk(v);if(!w||!b)return e;const x=w.x*b.y-w.y*b.x;if(Math.abs(x)<1e-8)return e;const y=1/x,_=b.y*y,j=-b.x*y,S=-w.y*y,k=w.x*y;return AP(e,bf([_,j,0,S,k,0,0,0,1],h))}function aT(e,t,r){const n=Math.max(e,t,r),a=Math.min(e,t,r),i=(n+a)/2;if(n===a)return[0,0,i];const o=n-a,s=i>.5?o/(2-n-a):o/(n+a);let l=0;switch(n){case e:l=(t-r)/o+(t<r?6:0);break;case t:l=(r-e)/o+2;break;default:l=(e-t)/o+4;break}return l/=6,[l,s,i]}function jy(e,t,r){let n=r;return n<0&&(n+=1),n>1&&(n-=1),n<1/6?e+(t-e)*6*n:n<1/2?t:n<2/3?e+(t-e)*(2/3-n)*6:e}function iT(e,t,r){if(t===0)return[r,r,r];const n=r<.5?r*(1+t):r+t-r*t,a=2*r-n;return[jy(a,n,e+1/3),jy(a,n,e),jy(a,n,e-1/3)]}const oT=[0,30,60,120,180,240,285,320],LP=e=>{const t=[],r=[],n=[];let a=!1;for(const i of BE){const o=e[i];t.push(o.hue),r.push(o.saturation),n.push(o.luminance),(Math.abs(o.hue)>1e-6||Math.abs(o.saturation)>1e-6||Math.abs(o.luminance)>1e-6)&&(a=!0)}return{hue:t,saturation:r,luminance:n,hasAdjust:a}},$k=(e,t,r)=>{if(Math.abs(t-e)<1e-9)return r<e?0:1;const n=Lr((r-e)/(t-e));return n*n*(3-2*n)},Lc=(e,t,r)=>{const n=Math.max(-1,Math.min(1,t)),a=Lr(r);return n>=0?e+(1-e)*n*a:e+e*n*a};function BP(e,t,r,n,a,i){let o=e,s=t,l=r;if(n.exposure!==0){const x=Math.pow(2,n.exposure);o*=x,s*=x,l*=x}if(n.temperature!==0||n.tint!==0){const x=n.temperature/100,y=n.tint/100;o*=1+.18*x+.08*y,s*=1-.16*y,l*=1-.18*x+.08*y}if(n.contrast!==0){const x=1+n.contrast/100;o=(o-.5)*x+.5,s=(s-.5)*x+.5,l=(l-.5)*x+.5}if(n.highlights!==0||n.shadows!==0){const x=Lr(o*.2126+s*.7152+l*.0722),y=$k(.5,1,x),_=1-$k(0,.5,x);if(n.highlights!==0){const j=n.highlights/100;o=Lc(o,j,y),s=Lc(s,j,y),l=Lc(l,j,y)}if(n.shadows!==0){const j=n.shadows/100;o=Lc(o,j,_),s=Lc(s,j,_),l=Lc(l,j,_)}}if(n.vibrance!==0||n.saturation!==0||a.hasAdjust){let[x,y,_]=aT(Lr(o),Lr(s),Lr(l));if(n.vibrance!==0){const j=n.vibrance/100;y=j>=0?Lr(y+j*(1-y)):Lr(y+j*y)}if(n.saturation!==0&&(y=Lr(y+n.saturation/100)),a.hasAdjust){const j=(x%1+1)%1*360;let S=0,k=0,M=0,N=0;for(let T=0;T<8;T++){const A=oT[T];let D=Math.abs(j-A);D>180&&(D=360-D);const $=Lr(1-D/45);$<=0||(S+=$,k+=$*a.hue[T],M+=$*a.saturation[T],N+=$*a.luminance[T])}if(S>1e-6){const T=Lr((y-.03)/.25),A=1/S,D=k*A/100*(45/360)*T;x=(x+D)%1,x<0&&(x+=1),y=Lr(y+M*A/100*T),_=Lr(_+N*A/100*T)}}[o,s,l]=iT(x,y,_)}const d=Math.max(0,o*.2126+s*.7152+l*.0722),f=Math.min(255,Math.max(0,Math.round(Lr(d)*255))),h=i.master[f],g=d>1e-6?h/d:1,v=Lr(o*g),w=Lr(s*g),b=Lr(l*g);return o=i.red[Math.min(255,Math.max(0,Math.round(v*255)))],s=i.green[Math.min(255,Math.max(0,Math.round(w*255)))],l=i.blue[Math.min(255,Math.max(0,Math.round(b*255)))],[o,s,l]}function hv(e){const t=new Float32Array(e.baseRgb),r=new Map,n=new Map,a=e.width*e.height;for(const s of e.layers)s.enabled&&r.set(s.maskId,s);for(const s of e.masks){const l=r.get(s.id);if(!l||!l.enabled||!s.visible)continue;const u=Su(l.basic),d=_u(l.mixer),f=LP(d),h=Yg(l.curves),g=`${l.id}:${JSON.stringify(h)}`;let v=n.get(g);v||(v={master:Da(h.master),red:Da(h.red),green:Da(h.green),blue:Da(h.blue)},n.set(g,v));const w=s.alpha,b=Lr(l.opacity);for(let x=0;x<a;x++){const y=Lr(w[x]*b);if(y<=0)continue;const _=x*3,j=t[_],S=t[_+1],k=t[_+2],[M,N,T]=BP(j,S,k,u,f,v),A=l.blendMode==="subtract"?2*j-M:M,D=l.blendMode==="subtract"?2*S-N:N,$=l.blendMode==="subtract"?2*k-T:T;t[_]=j*(1-y)+A*y,t[_+1]=S*(1-y)+D*y,t[_+2]=k*(1-y)+$*y}}const i=new ImageData(e.width,e.height),o=i.data;for(let s=0,l=0;s<a;s++,l+=3){const u=s*4;o[u]=Math.round(du(t[l])*255),o[u+1]=Math.round(du(t[l+1])*255),o[u+2]=Math.round(du(t[l+2])*255),o[u+3]=255}return i}function sT(e,t,r){if(t.width!==e.width||t.height!==e.height)return hv(e);const n=Math.max(0,Math.floor(r.x0)),a=Math.max(0,Math.floor(r.y0)),i=Math.min(e.width-1,Math.ceil(r.x1)),o=Math.min(e.height-1,Math.ceil(r.y1));if(i<n||o<a)return t;const s=new Uint8ClampedArray(t.data),l=new ImageData(s,e.width,e.height),u=l.data,d=new Map,f=new Map;for(const g of e.layers)g.enabled&&d.set(g.maskId,g);const h=[];for(const g of e.masks){const v=d.get(g.id);if(!v||!v.enabled||!g.visible)continue;const w=Su(v.basic),b=_u(v.mixer),x=LP(b),y=Yg(v.curves),_=`${v.id}:${JSON.stringify(y)}`;let j=f.get(_);j||(j={master:Da(y.master),red:Da(y.red),green:Da(y.green),blue:Da(y.blue)},f.set(_,j)),h.push({mask:g,layer:v,alpha:g.alpha,opacity:Lr(v.opacity),basic:w,mixerArrays:x,lutPack:j})}for(let g=a;g<=o;g++){const v=g*e.width;for(let w=n;w<=i;w++){const b=v+w,x=b*3;let y=e.baseRgb[x],_=e.baseRgb[x+1],j=e.baseRgb[x+2];for(const k of h){const M=Lr(k.alpha[b]*k.opacity);if(M<=0)continue;const[N,T,A]=BP(y,_,j,k.basic,k.mixerArrays,k.lutPack),D=k.layer.blendMode==="subtract"?2*y-N:N,$=k.layer.blendMode==="subtract"?2*_-T:T,B=k.layer.blendMode==="subtract"?2*j-A:A;y=y*(1-M)+D*M,_=_*(1-M)+$*M,j=j*(1-M)+B*M}const S=b*4;u[S]=Math.round(du(y)*255),u[S+1]=Math.round(du(_)*255),u[S+2]=Math.round(du(j)*255),u[S+3]=255}}return l}const Lk=[{id:"red",label:"Red",color:"#ef4444"},{id:"orange",label:"Orange",color:"#fb923c"},{id:"yellow",label:"Yellow",color:"#facc15"},{id:"green",label:"Green",color:"#22c55e"},{id:"aqua",label:"Aqua",color:"#14b8a6"},{id:"blue",label:"Blue",color:"#3b82f6"},{id:"purple",label:"Purple",color:"#8b5cf6"},{id:"magenta",label:"Magenta",color:"#d946ef"}],Py={exposure:0,temperature:0,tint:0,contrast:0,highlights:0,shadows:0,vibrance:0,saturation:0},Cy={red:{hue:0,saturation:0,luminance:0},orange:{hue:0,saturation:0,luminance:0},yellow:{hue:0,saturation:0,luminance:0},green:{hue:0,saturation:0,luminance:0},aqua:{hue:0,saturation:0,luminance:0},blue:{hue:0,saturation:0,luminance:0},purple:{hue:0,saturation:0,luminance:0},magenta:{hue:0,saturation:0,luminance:0}},lT=e=>{const t=[...e].sort((l,u)=>l.x-u.x),r=t.length,n=t.map(l=>l.x),a=t.map(l=>l.y);if(r<2)return l=>r===1?a[0]:0;const i=new Array(r-1).fill(0);for(let l=0;l<r-1;l++){const u=n[l+1]-n[l],d=a[l+1]-a[l];i[l]=u!==0?d/u:0}const o=new Array(r).fill(0);o[0]=i[0],o[r-1]=i[r-2];for(let l=1;l<r-1;l++)i[l-1]*i[l]<=0?o[l]=0:o[l]=(i[l-1]+i[l])/2;for(let l=0;l<r-1;l++){if(i[l]===0){o[l]=0,o[l+1]=0;continue}const u=o[l]/i[l],d=o[l+1]/i[l],f=u*u+d*d;if(f>9){const h=3/Math.sqrt(f);o[l]=h*u*i[l],o[l+1]=h*d*i[l]}}const s=(l,u)=>{const d=n[l],f=n[l+1],h=a[l],g=a[l+1],v=f-d;if(v<=0)return h;const w=(u-d)/v,b=w*w,x=b*w,y=2*x-3*b+1,_=x-2*b+w,j=-2*x+3*b,S=x-b;return Math.max(0,Math.min(1,y*h+_*v*o[l]+j*g+S*v*o[l+1]))};return l=>{if(l<=n[0])return a[0];if(l>=n[r-1])return a[r-1];let u=0;for(;u<r-2&&l>n[u+1];)u++;return s(u,l)}},cT=({channel:e,points:t,onChange:r})=>{const n=P.useRef(null),[a,i]=P.useState(null),[o,s]=P.useState(()=>[...t].sort((w,b)=>w.x-b.x)),l=P.useRef(o),u=w=>{l.current=w,s(w)};P.useEffect(()=>{if(a!==null)return;const w=[...t].sort((b,x)=>b.x-x.x);u(w)},[t,a]);const d=P.useMemo(()=>[...o].sort((w,b)=>w.x-b.x),[o]),f=P.useMemo(()=>{if(d.length<2)return"";const w=lT(d);let b=`M ${d[0].x*256} ${256-d[0].y*256}`;for(let x=1;x<=120;x++){const y=x/120,_=w(y);b+=` L ${y*256} ${256-_*256}`}return b},[d]),h=w=>{if(!n.current)return{x:0,y:0};const b=n.current.getBoundingClientRect();return{x:Math.max(0,Math.min(1,(w.clientX-b.left)/b.width)),y:Math.max(0,Math.min(1,1-(w.clientY-b.top)/b.height))}},g=w=>{if(a!==null)return;const b=h(w);if(d.some(y=>Math.abs(y.x-b.x)<.04))return;const x=[...d,b].sort((y,_)=>y.x-_.x);u(x),r(x)};P.useEffect(()=>{const w=x=>{if(a===null)return;const y=h(x),_=[...l.current].sort((M,N)=>M.x-N.x);let j=0,S=1;a>0&&(j=_[a-1].x+.01),a<_.length-1&&(S=_[a+1].x-.01),a===0?y.x=0:a===_.length-1?y.x=1:y.x=Math.max(j,Math.min(S,y.x));const k=[..._];k[a]=y,u(k)},b=()=>{if(a!==null){const x=[...l.current].sort((y,_)=>y.x-_.x);r(x)}i(null)};return a!==null&&(window.addEventListener("mousemove",w),window.addEventListener("mouseup",b)),()=>{window.removeEventListener("mousemove",w),window.removeEventListener("mouseup",b)}},[a,r,d]);const v=e==="master"?"#94a3b8":e==="red"?"#ef4444":e==="green"?"#22c55e":"#3b82f6";return c.jsx("div",{className:"w-full aspect-square bg-white dark:bg-slate-900 border border-gray-300 dark:border-slate-700 rounded relative select-none",children:c.jsxs("svg",{ref:n,width:"100%",height:"100%",viewBox:"0 0 256 256",className:"cursor-crosshair",onMouseDown:g,children:[c.jsx("path",{d:"M64,0 v256 M128,0 v256 M192,0 v256",stroke:"rgba(128,128,128,0.2)",strokeDasharray:"4 4"}),c.jsx("path",{d:"M0,64 h256 M0,128 h256 M0,192 h256",stroke:"rgba(128,128,128,0.2)",strokeDasharray:"4 4"}),c.jsx("line",{x1:"0",y1:"256",x2:"256",y2:"0",stroke:"rgba(128,128,128,0.1)"}),c.jsx("path",{d:f,fill:"none",stroke:v,strokeWidth:"2"}),d.map((w,b)=>c.jsx("circle",{cx:w.x*256,cy:256-w.y*256,r:a===b?6:4,fill:v,stroke:"white",strokeWidth:"1.5",className:"cursor-pointer",onMouseDown:x=>{x.stopPropagation(),x.preventDefault(),i(b)},onDoubleClick:x=>{if(x.stopPropagation(),b===0||b===d.length-1)return;const y=d.filter((_,j)=>j!==b);u(y),r(y)}},b))]})})},ao=({value:e,min:t,max:r,step:n,className:a,onPreview:i,onCommit:o,resetValue:s=0})=>{const[l,u]=P.useState(e),d=P.useRef(!1),f=P.useRef(e);P.useEffect(()=>{d.current||(u(e),f.current=e)},[e]);const h=()=>{const v=Math.max(t,Math.min(r,l)),w=f.current;d.current=!1,Math.abs(v-w)>1e-9&&o(v),f.current=v},g=()=>{const v=Math.max(t,Math.min(r,s)),w=d.current?f.current:e;d.current=!1,u(v),i==null||i(v),Math.abs(v-w)>1e-9&&o(v),f.current=v};return c.jsx("input",{type:"range",min:t,max:r,step:n,value:l,onChange:v=>{const w=Number(v.target.value);u(w),i==null||i(w)},onPointerDown:()=>{d.current=!0,f.current=e},onPointerUp:h,onPointerCancel:h,onMouseUp:h,onTouchEnd:h,onBlur:h,onDoubleClick:g,className:a})},uT=({inline:e=!1,doc:t,brushEnabled:r,brushSize:n,brushOpacity:a,brushFeather:i,ellipseFeather:o,brushMode:s,onAddMask:l,onAddEllipseMask:u,onCancelEllipseTool:d,onSelectLayer:f,onSelectMask:h,onBindLayerMask:g,onSetLayerBlendMode:v,onSetLayerOpacity:w,onSetLayerBasic:b,onSetLayerMixer:x,onPreviewLayerBasic:y,onPreviewLayerMixer:_,onSetLayerCurves:j,onSelectMaskItem:S,onUpdateEllipseItem:k,onSetMaskOverlayVisible:M,onBrushEnabledChange:N,onBrushSizeChange:T,onBrushOpacityChange:A,onBrushFeatherChange:D,onEllipseFeatherChange:$,onBrushModeChange:B})=>{var Re,it,Qe;const[J,W]=P.useState("master"),[I,G]=P.useState("orange"),[U,X]=P.useState(null),[V,z]=P.useState(!1),[q,te]=P.useState(!1),ie=e?"w-full p-2 bg-white dark:bg-black border border-gray-300 dark:border-slate-700 text-xs":"absolute top-3 right-3 z-40 w-80 max-h-[90%] overflow-y-auto p-3 bg-white/95 dark:bg-black/95 border-2 border-black dark:border-white shadow-[6px_6px_0px_rgba(0,0,0,0.6)] text-xs";if(!t)return c.jsx("div",{className:e?"w-full p-2 bg-white dark:bg-black border border-gray-300 dark:border-slate-700":"absolute top-3 right-3 z-40 w-80 p-3 bg-white/90 dark:bg-black/90 border-2 border-black dark:border-white",children:c.jsx("p",{className:"text-xs font-bold",children:"PS document not ready."})});const he=t.masks.find(se=>se.id===t.selectedMaskId)||null,ee=he&&t.layers.find(se=>se.maskId===he.id)||null,Le=((Re=he==null?void 0:he.items)==null?void 0:Re.find(se=>se.id===t.selectedMaskItemId))||null,fe=Le&&Le.type==="ellipse"?Le:null,ce=Yg(ee==null?void 0:ee.curves),de=(ee==null?void 0:ee.basic)||Py,pe=((ee==null?void 0:ee.mixer)||Cy)[I]||{hue:0,saturation:0,luminance:0};P.useEffect(()=>{W("master"),G("orange")},[ee==null?void 0:ee.id]),P.useEffect(()=>{he&&X(he.id)},[he==null?void 0:he.id]);const ke=(se,Xe,ht)=>{b(se.id,{...se.basic||Py,[Xe]:ht})},me=(se,Xe,ht)=>{y==null||y(se.id,{...se.basic||Py,[Xe]:ht})},Be=(se,Xe,ht,Zt)=>{const Jt=se.mixer||Cy;x(se.id,{...Jt,[Xe]:{...Jt[Xe]||{hue:0,saturation:0,luminance:0},[ht]:Zt}})},Se=(se,Xe,ht,Zt)=>{const Jt=se.mixer||Cy;_==null||_(se.id,{...Jt,[Xe]:{...Jt[Xe]||{hue:0,saturation:0,luminance:0},[ht]:Zt}})},we=se=>{ee&&j(ee.id,{...ce,[J]:se})};return c.jsxs("div",{className:ie,children:[c.jsx("div",{className:"font-bold mb-2",children:"PS Masks"}),c.jsxs("div",{className:"grid grid-cols-3 gap-2 mb-3",children:[c.jsx("button",{onClick:l,className:"px-2 py-1 bg-cyan-600 text-white font-bold border border-black",children:"+ Mask"}),c.jsx("button",{onClick:()=>{const se=!V;z(se),N(se)},className:`px-2 py-1 font-bold border border-black ${V?"bg-white text-black":"bg-emerald-600 text-white"}`,children:"+ Brush"}),c.jsx("button",{onClick:()=>{const se=!q;te(se),se?u():d()},className:`px-2 py-1 font-bold border border-black ${q?"bg-white text-black":"bg-violet-600 text-white"}`,children:"+ Ellipse"})]}),q&&c.jsxs("label",{className:"block mb-3",children:[c.jsxs("span",{className:"block mb-1",children:["New Ellipse Feather ",Math.round(o)," px"]}),c.jsx("input",{type:"range",min:0,max:256,step:1,value:o,onChange:se=>$(Number(se.target.value)),className:"w-full"})]}),c.jsxs("div",{className:"mb-3",children:[c.jsx("div",{className:"font-semibold mb-1",children:"Masks"}),c.jsxs("div",{className:"space-y-1 max-h-52 overflow-auto border border-gray-300 dark:border-slate-700 p-1",children:[t.masks.map(se=>c.jsxs("div",{className:"border border-gray-300 dark:border-slate-700",children:[c.jsxs("div",{className:"flex",children:[c.jsx("button",{onClick:()=>X(U===se.id?null:se.id),className:"w-7 px-1 py-1 border-r border-gray-300 dark:border-slate-700 bg-gray-100 dark:bg-slate-800",title:U===se.id?"Collapse mask":"Expand mask",children:U===se.id?"v":">"}),c.jsx("button",{onClick:()=>h(se.id),className:`flex-1 text-left px-2 py-1 ${t.selectedMaskId===se.id?"bg-emerald-100 dark:bg-emerald-900/40":"bg-white dark:bg-slate-900"}`,children:se.name}),c.jsx("button",{onClick:()=>M(se.id,!(se.overlayVisible??!0)),className:`px-2 py-1 border-l border-gray-300 dark:border-slate-700 text-[11px] font-bold ${se.overlayVisible??!0?"bg-rose-100 dark:bg-rose-900/40 text-rose-700 dark:text-rose-300":"bg-gray-100 dark:bg-slate-800 text-gray-500 dark:text-slate-400"}`,title:"Toggle red mask overlay",children:"Eye"})]}),U===se.id&&c.jsxs("div",{className:"p-1 border-t border-gray-300 dark:border-slate-700 space-y-1 bg-gray-50 dark:bg-slate-900/40",children:[(se.items||[]).map(Xe=>c.jsxs("button",{onClick:()=>S(Xe.id),className:`w-full text-left px-2 py-1 border text-[11px] ${t.selectedMaskId===se.id&&t.selectedMaskItemId===Xe.id?"bg-violet-100 dark:bg-violet-900/40 border-violet-500":"bg-white dark:bg-slate-900 border-gray-300 dark:border-slate-700"}`,children:[(Xe.type==="brush",Xe.name)," (",Xe.mode==="add"?"Add":"Subtract",")"]},Xe.id)),(se.items||[]).length===0&&c.jsx("div",{className:"px-2 py-1 text-[11px] text-gray-500",children:"No brush/ellipse items."})]})]},se.id)),t.masks.length===0&&c.jsx("div",{className:"px-2 py-2 text-[11px] text-gray-500",children:"No masks yet."})]})]}),V&&c.jsxs("div",{className:"mb-3 border border-gray-300 dark:border-slate-700 p-2",children:[c.jsx("div",{className:"font-semibold mb-2",children:"Brush"}),c.jsx("div",{className:"grid grid-cols-1 gap-2 mb-2",children:c.jsxs("select",{value:s,onChange:se=>B(se.target.value),className:"border border-gray-400 dark:border-slate-600 bg-white dark:bg-slate-900 p-1",children:[c.jsx("option",{value:"add",children:"Paint Add"}),c.jsx("option",{value:"subtract",children:"Paint Subtract"})]})}),c.jsxs("label",{className:"block mb-2",children:[c.jsxs("span",{className:"block mb-1",children:["Size ",n,"px"]}),c.jsx("input",{type:"range",min:1,max:200,step:1,value:n,onChange:se=>T(Number(se.target.value)),className:"w-full"})]}),c.jsxs("label",{className:"block mb-2",children:[c.jsxs("span",{className:"block mb-1",children:["Opacity ",a.toFixed(2)]}),c.jsx("input",{type:"range",min:.01,max:1,step:.01,value:a,onChange:se=>A(Number(se.target.value)),className:"w-full"})]}),c.jsxs("label",{className:"block",children:[c.jsxs("span",{className:"block mb-1",children:["Feather ",Math.round(i*100),"%"]}),c.jsx("input",{type:"range",min:0,max:1,step:.01,value:i,onChange:se=>D(Number(se.target.value)),className:"w-full"})]})]}),fe&&c.jsxs("div",{className:"mb-3 border border-gray-300 dark:border-slate-700 p-2",children:[c.jsx("div",{className:"font-semibold mb-2",children:"Selected Ellipse"}),c.jsxs("label",{className:"block mb-2",children:[c.jsx("span",{className:"block mb-1",children:"Mode"}),c.jsxs("select",{value:fe.mode,onChange:se=>k(fe.id,{mode:se.target.value}),className:"w-full border border-gray-400 dark:border-slate-600 bg-white dark:bg-slate-900 p-1",children:[c.jsx("option",{value:"add",children:"Add"}),c.jsx("option",{value:"subtract",children:"Subtract"})]})]}),c.jsxs("div",{className:"grid grid-cols-2 gap-2 mb-2",children:[c.jsxs("label",{className:"text-[11px]",children:[c.jsx("span",{className:"block mb-1",children:"Center X"}),c.jsx("input",{type:"number",step:1,value:fe.center.x,onChange:se=>k(fe.id,{center:{...fe.center,x:Number(se.target.value)}}),className:"w-full border border-gray-400 dark:border-slate-600 bg-white dark:bg-slate-900 p-1"})]}),c.jsxs("label",{className:"text-[11px]",children:[c.jsx("span",{className:"block mb-1",children:"Center Y"}),c.jsx("input",{type:"number",step:1,value:fe.center.y,onChange:se=>k(fe.id,{center:{...fe.center,y:Number(se.target.value)}}),className:"w-full border border-gray-400 dark:border-slate-600 bg-white dark:bg-slate-900 p-1"})]}),c.jsxs("label",{className:"text-[11px]",children:[c.jsx("span",{className:"block mb-1",children:"Radius X"}),c.jsx("input",{type:"number",min:1,step:1,value:fe.radiusX,onChange:se=>k(fe.id,{radiusX:Number(se.target.value)}),className:"w-full border border-gray-400 dark:border-slate-600 bg-white dark:bg-slate-900 p-1"})]}),c.jsxs("label",{className:"text-[11px]",children:[c.jsx("span",{className:"block mb-1",children:"Radius Y"}),c.jsx("input",{type:"number",min:1,step:1,value:fe.radiusY,onChange:se=>k(fe.id,{radiusY:Number(se.target.value)}),className:"w-full border border-gray-400 dark:border-slate-600 bg-white dark:bg-slate-900 p-1"})]})]}),c.jsxs("label",{className:"block mb-2",children:[c.jsxs("span",{className:"block mb-1",children:["Rotation ",fe.rotationDeg.toFixed(1)," deg"]}),c.jsx("input",{type:"range",min:-180,max:180,step:.1,value:fe.rotationDeg,onChange:se=>k(fe.id,{rotationDeg:Number(se.target.value)}),className:"w-full"})]}),c.jsxs("label",{className:"block",children:[c.jsxs("span",{className:"block mb-1",children:["Feather ",Math.round(fe.featherPx)," px"]}),c.jsx("input",{type:"range",min:0,max:512,step:1,value:fe.featherPx,onChange:se=>k(fe.id,{featherPx:Number(se.target.value)}),className:"w-full"})]})]}),ee&&c.jsxs("div",{className:"mb-3 border border-gray-300 dark:border-slate-700 p-2",children:[c.jsx("div",{className:"font-semibold mb-2",children:"Mask Adjustment"}),c.jsxs("label",{className:"block mb-2",children:[c.jsx("span",{className:"block mb-1",children:"Blend"}),c.jsxs("select",{value:ee.blendMode,onChange:se=>v(ee.id,se.target.value),className:"w-full border border-gray-400 dark:border-slate-600 bg-white dark:bg-slate-900 p-1",children:[c.jsx("option",{value:"add",children:"Add"}),c.jsx("option",{value:"subtract",children:"Subtract"})]})]}),c.jsxs("div",{className:"mb-2 text-[11px] text-gray-500",children:["Bound Mask: ",c.jsx("span",{className:"font-semibold text-gray-700 dark:text-gray-300",children:((it=t.masks.find(se=>se.id===ee.maskId))==null?void 0:it.name)||"None"})]}),c.jsxs("label",{className:"block mb-2",children:[c.jsxs("span",{className:"block mb-1",children:["Opacity ",ee.opacity.toFixed(2)]}),c.jsx("input",{type:"range",min:0,max:1,step:.01,value:ee.opacity,onChange:se=>w(ee.id,Number(se.target.value)),className:"w-full"})]}),c.jsxs("div",{className:"mt-3 border border-gray-300 dark:border-slate-700 p-2",children:[c.jsx("div",{className:"font-semibold mb-2",children:"Basic"}),c.jsxs("label",{className:"block mb-2",children:[c.jsxs("div",{className:"flex items-center justify-between mb-1",children:[c.jsx("span",{children:"Exposure"}),c.jsx("span",{className:"text-[11px]",children:de.exposure.toFixed(2)})]}),c.jsx(ao,{value:de.exposure,min:-5,max:5,step:.01,onPreview:se=>me(ee,"exposure",se),onCommit:se=>ke(ee,"exposure",se),className:"w-full"})]}),c.jsxs("label",{className:"block mb-2",children:[c.jsxs("div",{className:"flex items-center justify-between mb-1",children:[c.jsx("span",{children:"Temperature"}),c.jsx("span",{className:"text-[11px]",children:Math.round(de.temperature)})]}),c.jsx(ao,{value:de.temperature,min:-100,max:100,step:1,onPreview:se=>me(ee,"temperature",se),onCommit:se=>ke(ee,"temperature",se),className:"w-full"})]}),c.jsxs("label",{className:"block mb-2",children:[c.jsxs("div",{className:"flex items-center justify-between mb-1",children:[c.jsx("span",{children:"Tint (G/M)"}),c.jsx("span",{className:"text-[11px]",children:Math.round(de.tint)})]}),c.jsx(ao,{value:de.tint,min:-100,max:100,step:1,onPreview:se=>me(ee,"tint",se),onCommit:se=>ke(ee,"tint",se),className:"w-full"})]}),c.jsxs("label",{className:"block mb-2",children:[c.jsxs("div",{className:"flex items-center justify-between mb-1",children:[c.jsx("span",{children:"Contrast"}),c.jsx("span",{className:"text-[11px]",children:Math.round(de.contrast)})]}),c.jsx(ao,{value:de.contrast,min:-100,max:100,step:1,onPreview:se=>me(ee,"contrast",se),onCommit:se=>ke(ee,"contrast",se),className:"w-full"})]}),c.jsxs("label",{className:"block mb-2",children:[c.jsxs("div",{className:"flex items-center justify-between mb-1",children:[c.jsx("span",{children:"Highlights"}),c.jsx("span",{className:"text-[11px]",children:Math.round(de.highlights)})]}),c.jsx(ao,{value:de.highlights,min:-100,max:100,step:1,onPreview:se=>me(ee,"highlights",se),onCommit:se=>ke(ee,"highlights",se),className:"w-full"})]}),c.jsxs("label",{className:"block mb-2",children:[c.jsxs("div",{className:"flex items-center justify-between mb-1",children:[c.jsx("span",{children:"Shadows"}),c.jsx("span",{className:"text-[11px]",children:Math.round(de.shadows)})]}),c.jsx(ao,{value:de.shadows,min:-100,max:100,step:1,onPreview:se=>me(ee,"shadows",se),onCommit:se=>ke(ee,"shadows",se),className:"w-full"})]}),c.jsxs("label",{className:"block mb-2",children:[c.jsxs("div",{className:"flex items-center justify-between mb-1",children:[c.jsx("span",{children:"Vibrance"}),c.jsx("span",{className:"text-[11px]",children:Math.round(de.vibrance)})]}),c.jsx(ao,{value:de.vibrance,min:-100,max:100,step:1,onPreview:se=>me(ee,"vibrance",se),onCommit:se=>ke(ee,"vibrance",se),className:"w-full"})]}),c.jsxs("label",{className:"block",children:[c.jsxs("div",{className:"flex items-center justify-between mb-1",children:[c.jsx("span",{children:"Saturation"}),c.jsx("span",{className:"text-[11px]",children:Math.round(de.saturation)})]}),c.jsx(ao,{value:de.saturation,min:-100,max:100,step:1,onPreview:se=>me(ee,"saturation",se),onCommit:se=>ke(ee,"saturation",se),className:"w-full"})]})]}),c.jsxs("div",{className:"mt-3 border border-gray-300 dark:border-slate-700 p-2",children:[c.jsx("div",{className:"font-semibold mb-2",children:"Color Mixer"}),c.jsx("div",{className:"flex items-center gap-2 mb-2 flex-wrap",children:Lk.map(se=>c.jsx("button",{onClick:()=>G(se.id),className:`w-5 h-5 rounded-full border-2 ${I===se.id?"border-black dark:border-white scale-110":"border-gray-500 dark:border-slate-500"} transition-transform`,style:{backgroundColor:se.color},title:se.label},se.id))}),c.jsxs("div",{className:"text-[11px] text-gray-500 mb-2",children:["Band: ",(Qe=Lk.find(se=>se.id===I))==null?void 0:Qe.label]}),c.jsxs("label",{className:"block mb-2",children:[c.jsxs("div",{className:"flex items-center justify-between mb-1",children:[c.jsx("span",{children:"Hue"}),c.jsx("span",{className:"text-[11px]",children:Math.round(pe.hue)})]}),c.jsx(ao,{value:pe.hue,min:-100,max:100,step:1,onPreview:se=>Se(ee,I,"hue",se),onCommit:se=>Be(ee,I,"hue",se),className:"w-full"})]}),c.jsxs("label",{className:"block mb-2",children:[c.jsxs("div",{className:"flex items-center justify-between mb-1",children:[c.jsx("span",{children:"Saturation"}),c.jsx("span",{className:"text-[11px]",children:Math.round(pe.saturation)})]}),c.jsx(ao,{value:pe.saturation,min:-100,max:100,step:1,onPreview:se=>Se(ee,I,"saturation",se),onCommit:se=>Be(ee,I,"saturation",se),className:"w-full"})]}),c.jsxs("label",{className:"block",children:[c.jsxs("div",{className:"flex items-center justify-between mb-1",children:[c.jsx("span",{children:"Luminance"}),c.jsx("span",{className:"text-[11px]",children:Math.round(pe.luminance)})]}),c.jsx(ao,{value:pe.luminance,min:-100,max:100,step:1,onPreview:se=>Se(ee,I,"luminance",se),onCommit:se=>Be(ee,I,"luminance",se),className:"w-full"})]})]}),c.jsxs("div",{className:"mt-3",children:[c.jsx("div",{className:"font-semibold mb-1",children:"Layer Curves"}),c.jsx("div",{className:"flex gap-1 mb-2",children:["master","red","green","blue"].map(se=>c.jsx("button",{onClick:()=>W(se),className:`flex-1 py-1 text-[11px] font-bold uppercase rounded transition-colors ${J===se?"bg-slate-700 text-white":"bg-gray-200 dark:bg-slate-800 text-gray-600 dark:text-gray-400 hover:bg-gray-300 dark:hover:bg-slate-700"}`,children:se==="master"?"Luma":se},se))}),c.jsx(cT,{channel:J,points:ce[J],onChange:we}),c.jsx("div",{className:"text-[10px] text-gray-400 mt-1 text-center",children:"Click add, drag move, double-click remove."})]})]}),!ee&&he&&c.jsx("div",{className:"mb-3 border border-gray-300 dark:border-slate-700 p-2 text-[11px] text-gray-500",children:"No adjustment layer bound to this mask."})]})},ju={"Canon EOS R5":"0.9766 -0.2953 -0.1254 -0.4276 1.2116 0.2433 -0.0437 0.1336 0.5131","Canon EOS 7D Mark II":"0.7268 -0.1082 -0.0969 -0.4186 1.1839 0.2663 -0.0825 0.2029 0.5839","Canon EOS R3":"0.9423 -0.2839 -0.1195 -0.4532 1.2377 0.2415 -0.0483 0.1374 0.5276","Canon EOS 5D Mark III":"0.6722 -0.0635 -0.0963 -0.4287 1.246 0.2028 -0.0908 0.2162 0.5668","Canon EOS 5DS R":"0.625 -0.0711 -0.0808 -0.5153 1.2794 0.2636 -0.1249 0.2198 0.561","Canon EOS R6":"0.8293 -0.1611 -0.1132 -0.4759 1.2711 0.2275 -0.1013 0.2415 0.5509","Samsung NX U":"0.7557 -0.2522 -0.0739 -0.4679 1.2949 0.1894 -0.084 0.1777 0.5311","Canon EOS R5 Mark II":"0.9396 -0.2598 -0.1207 -0.4408 1.2296 0.2369 -0.0505 0.1575 0.6077","Canon EOS 5DS":"0.625 -0.0711 -0.0808 -0.5153 1.2794 0.2636 -0.1249 0.2198 0.561","Canon EOS R":"0.8293 -0.1789 -0.1094 -0.5025 1.2925 0.2327 -0.1199 0.2769 0.6108","Canon EOS R6 Mark II":"0.9539 -0.2795 -0.1224 -0.4175 1.1998 0.2458 -0.0465 0.1755 0.6048","Canon EOS R7":"1.0424 -0.3138 -0.13 -0.4221 1.1938 0.2584 -0.0547 0.1658 0.6183","Canon EOS 5D Mark IV":"0.6446 -0.0366 -0.0864 -0.4436 1.2204 0.2513 -0.0952 0.2496 0.6348","Canon EOS-1D X Mark III":"0.8971 -0.2022 -0.1242 -0.5405 1.3249 0.238 -0.128 0.2483 0.6072","Sony ILCE-7M3":"0.7374 -0.2389 -0.0551 -0.5435 1.3162 0.2519 -0.1006 0.1795 0.6552","Hasselblad 50-15-Coated5":"0.5002 -0.0878 0.0111 -0.4856 1.1929 0.3338 -0.1183 0.2041 0.7022","Canon EOS-1D X":"0.6847 -0.0614 -0.1014 -0.4669 1.2737 0.2139 -0.1197 0.2488 0.6846","Fujifilm GFX 100":"1.6212 -0.8423 -0.1583 -0.4336 1.2583 0.1937 -0.0195 0.0726 0.6199","Phase One IQ180":"0.6294 0.0686 -0.0712 -0.5435 1.3417 0.2211 -0.1006 0.2435 0.5042","Phase One IQ3 100MP":"0.2423 0 0 0 0.9901 0 0 0 0.7989","Canon EOS-1D X Mark II":"0.7596 -0.0978 -0.0967 -0.4808 1.2571 0.2503 -0.1398 0.2567 0.5752","Canon PowerShot Pro70":"-0.5106 1.0695 0.1576 0.382 0.0053 0.4566 -0.6497 1.0736 0.6701 -0.3336 1.1887 0.1394","Sony ILCE-9":"0.6389 -0.1703 -0.0378 -0.4562 1.2265 0.2587 -0.067 0.1489 0.655","Sony ILCE-7CR":"0.82 -0.2976 -0.0719 -0.4296 1.2053 0.2532 -0.0429 0.1282 0.5774","Sony ILCE-7S":"0.5838 -0.143 -0.0246 -0.3497 1.1477 0.2297 -0.0748 0.1885 0.5778","Sony ILCE-7RM3":"0.664 -0.1847 -0.0503 -0.5238 1.301 0.2474 -0.0993 0.1673 0.6527","Sony DSC-RX1RM3":"0.9034 -0.349 -0.0777 -0.4004 1.1841 0.2448 -0.0484 0.1352 0.5552","Sony ILCE-6100":"0.7657 -0.2847 -0.0607 -0.4083 1.1966 0.2389 -0.0684 0.1418 0.5844","Sony ILCE-7RM2":"0.6629 -0.19 -0.0483 -0.4618 1.2349 0.255 -0.0622 0.1381 0.6514","Sony ILCE-5100":"0.5991 -0.1456 -0.0455 -0.4764 1.2135 0.298 -0.0707 0.1425 0.6701","Sony ILCE-7M2":"0.5271 -0.0712 -0.0347 -0.6153 1.3653 0.2763 -0.1601 0.2366 0.7242","Sony ILCE-7RM5":"0.82 -0.2976 -0.0719 -0.4296 1.2053 0.2532 -0.0429 0.1282 0.5774","Sony ILCA-77M2":"0.5991 -0.1732 -0.0443 -0.41 1.1989 0.2381 -0.0704 0.1467 0.5992","Sony ZV-1M2":"0.828 -0.2987 -0.0703 -0.3531 1.1645 0.2133 -0.055 0.1542 0.5312","Sony ILCE-7SM2":"0.5838 -0.143 -0.0246 -0.3497 1.1477 0.2297 -0.0748 0.1885 0.5778","Sony DSC-RX100M7":"1.0315 -0.439 -0.0937 -0.4859 1.2734 0.2365 -0.0734 0.1537 0.5997","Sony ILCE-6300":"0.5973 -0.1695 -0.0419 -0.3826 1.1797 0.2293 -0.0639 0.1398 0.5789","Sony ILCA-99M2":"0.666 -0.1918 -0.0471 -0.4613 1.2398 0.2485 -0.0649 0.1433 0.6447","Sony ILCE-9M3":"0.9811 -0.3908 -0.0752 -0.3704 1.1577 0.2417 -0.0073 0.095 0.598","Sony ILCE-9M2":"0.6389 -0.1703 -0.0378 -0.4562 1.2265 0.2587 -0.067 0.1489 0.655","Sony DSC-RX100M6":"0.7325 -0.2321 -0.0596 -0.3494 1.1674 0.2055 -0.0668 0.1562 0.5031","Sony ZV-E10M2":"0.6972 -0.2408 -0.06 -0.433 1.2101 0.2515 -0.0388 0.1277 0.5847","Sony DSC-RX100M4":"0.6596 -0.2079 -0.0562 -0.4782 1.3016 0.1933 -0.097 0.1581 0.5181","Sony ILCE-7SM3":"0.6912 -0.2127 -0.0469 -0.447 1.2175 0.2587 -0.0398 0.1478 0.6492","Sony ILCE-7":"0.5271 -0.0712 -0.0347 -0.6153 1.3653 0.2763 -0.1601 0.2366 0.7242","Sony ILCE-6000":"0.5991 -0.1456 -0.0455 -0.4764 1.2135 0.298 -0.0707 0.1425 0.6701","Sony ILCE-1":"0.8161 -0.2947 -0.0739 -0.4811 1.2668 0.2389 -0.0437 0.1229 0.6524","Sony ILCE-7M4":"0.746 -0.2365 -0.0588 -0.5687 1.3442 0.2474 -0.0624 0.1156 0.6584","Sony ILCE-7R":"0.4913 -0.0541 -0.0202 -0.613 1.3513 0.2906 -0.1564 0.2151 0.7183","Fujifilm X100VI":"1.1809 -0.5358 -0.1141 -0.4248 1.2164 0.2343 -0.0514 0.1097 0.5848","Fujifilm X-H2":"1.1809 -0.5358 -0.1141 -0.4248 1.2164 0.2343 -0.0514 0.1097 0.5848","Fujifilm X-A3":"1.2407 -0.5222 -0.1086 -0.2971 1.1116 0.212 -0.0294 0.1029 0.5284","Fujifilm X-H2S":"1.2836 -0.5909 -0.1032 -0.3087 1.1132 0.2236 -0.0035 0.0872 0.533","Fujifilm X-Pro3":"1.3426 -0.6334 -0.1177 -0.4244 1.2136 0.2371 -0.058 0.1303 0.598","Fujifilm X-T50":"1.1809 -0.5358 -0.1141 -0.4248 1.2164 0.2343 -0.0514 0.1097 0.5848","Fujifilm X-T2":"1.1434 -0.4948 -0.121 -0.3746 1.2042 0.1903 -0.0666 0.1479 0.5235","Fujifilm X-T5":"1.1809 -0.5358 -0.1141 -0.4248 1.2164 0.2343 -0.0514 0.1097 0.5848","Fujifilm X-Pro2":"1.1434 -0.4948 -0.121 -0.3746 1.2042 0.1903 -0.0666 0.1479 0.5235","Fujifilm X-A7":"1.5055 -0.7391 -0.1274 -0.4062 1.2071 0.2238 -0.061 0.1217 0.6147","Fujifilm X-H1":"1.1434 -0.4948 -0.121 -0.3746 1.2042 0.1903 -0.0666 0.1479 0.5235","Fujifilm X-S20":"1.2836 -0.5909 -0.1032 -0.3087 1.1132 0.2236 -0.0035 0.0872 0.533","Fujifilm X-S10":"1.3426 -0.6334 -0.1177 -0.4244 1.2136 0.2371 -0.058 0.1303 0.598","Fujifilm X-T30":"1.3426 -0.6334 -0.1177 -0.4244 1.2136 0.2371 -0.058 0.1303 0.598","Fujifilm X30":"1.2328 -0.5256 -0.1144 -0.4469 1.2927 0.1675 -0.0087 0.1291 0.4351","Fujifilm GFX 50R":"1.1756 -0.4754 -0.0874 -0.3056 1.1045 0.2305 -0.0381 0.1457 0.6006","Fujifilm X100V":"1.3717 -0.649 -0.1154 -0.4348 1.2266 0.2335 -0.069 0.1286 0.6134","Fujifilm X-A5":"1.1673 -0.476 -0.1041 -0.3988 1.2058 0.2166 -0.0771 0.1417 0.5569","Fujifilm X100F":"1.1434 -0.4948 -0.121 -0.3746 1.2042 0.1903 -0.0666 0.1479 0.5235","Fujifilm X-T100":"1.1673 -0.476 -0.1041 -0.3988 1.2058 0.2166 -0.0771 0.1417 0.5569","Fujifilm XQ1":"0.9252 -0.2704 -0.1064 -0.5893 1.4265 0.1717 -0.1101 0.2341 0.4349","Fujifilm X-T4":"1.3426 -0.6334 -0.1177 -0.4244 1.2136 0.2371 -0.058 0.1303 0.598","Fujifilm X-E3":"1.1434 -0.4948 -0.121 -0.3746 1.2042 0.1903 -0.0666 0.1479 0.5235","Fujifilm X-T20":"1.1434 -0.4948 -0.121 -0.3746 1.2042 0.1903 -0.0666 0.1479 0.5235","Fujifilm X-A2":"1.0763 -0.456 -0.0917 -0.3346 1.1311 0.2322 -0.0475 0.1135 0.5843","Fujifilm GFX 50S":"1.1756 -0.4754 -0.0874 -0.3056 1.1045 0.2305 -0.0381 0.1457 0.6006","Fujifilm X-A1":"1.1086 -0.4555 -0.0839 -0.3512 1.131 0.2517 -0.0815 0.1341 0.594","Fujifilm X70":"1.045 -0.4329 -0.0878 -0.3217 1.1105 0.2421 -0.0752 0.1758 0.6519","Fujifilm FinePix S1":"1.2297 -0.4882 -0.1202 -0.2106 1.0691 0.1623 -0.0088 0.1312 0.479","Fujifilm XQ2":"0.9252 -0.2704 -0.1064 -0.5893 1.4265 0.1717 -0.1101 0.2341 0.4349","Fujifilm X-E2":"0.8458 -0.2451 -0.0855 -0.4597 1.2447 0.2407 -0.1475 0.2482 0.6526","Fujifilm GFX 100RF":"1.2806 -0.5779 -0.111 -0.3546 1.1507 0.2318 -0.0177 0.0996 0.5715","Fujifilm X-T10":"0.8458 -0.2451 -0.0855 -0.4597 1.2447 0.2407 -0.1475 0.2482 0.6526","Fujifilm X-E5":"1.1809 -0.5358 -0.1141 -0.4248 1.2164 0.2343 -0.0514 0.1097 0.5848","Fujifilm X100T":"1.0592 -0.4262 -0.1008 -0.3514 1.1355 0.2465 -0.087 0.2025 0.6386","Fujifilm X100S":"1.0592 -0.4262 -0.1008 -0.3514 1.1355 0.2465 -0.087 0.2025 0.6386","Fujifilm X-T3":"1.3426 -0.6334 -0.1177 -0.4244 1.2136 0.2371 -0.058 0.1303 0.598","Fujifilm X-M5":"1.2836 -0.5909 -0.1032 -0.3087 1.1132 0.2236 -0.0035 0.0872 0.533","Fujifilm X-M1":"1.0413 -0.3996 -0.0993 -0.3721 1.164 0.2361 -0.0733 0.154 0.6011","Fujifilm X-T1":"0.8458 -0.2451 -0.0855 -0.4597 1.2447 0.2407 -0.1475 0.2482 0.6526","Fujifilm X20":"1.1768 -0.4971 -0.1133 -0.4904 1.2927 0.2183 -0.048 0.1723 0.4605","Fujifilm GFX 50S II":"1.1756 -0.4754 -0.0874 -0.3056 1.1045 0.2305 -0.0381 0.1457 0.6006","Fujifilm X-Pro1":"1.0413 -0.3996 -0.0993 -0.3721 1.164 0.2361 -0.0733 0.154 0.6011","Fujifilm XF10":"1.1673 -0.476 -0.1041 -0.3988 1.2058 0.2166 -0.0771 0.1417 0.5569","Fujifilm X-E2S":"1.1562 -0.5118 -0.0961 -0.3022 1.1007 0.2311 -0.0525 0.1569 0.6097","Nikon Coolpix P330":"1.0321 -0.392 -0.0931 -0.275 1.1146 0.1824 -0.0442 0.1545 0.5539","Nikon Coolpix P1000":"1.4294 -0.6116 -0.1333 -0.1628 1.0219 0.1637 -0.0014 0.1158 0.5022","Nikon Coolpix P340":"1.0321 -0.392 -0.0931 -0.275 1.1146 0.1824 -0.0442 0.1545 0.5539","Nikon Coolpix P7800":"1.0321 -0.392 -0.0931 -0.275 1.1146 0.1824 -0.0442 0.1545 0.5539","Nikon Coolpix P7700":"1.0321 -0.392 -0.0931 -0.275 1.1146 0.1824 -0.0442 0.1545 0.5539","Nikon 1 S2":"0.6612 -0.1342 -0.0618 -0.3338 1.1055 0.2623 -0.0174 0.1792 0.5075","Nikon D3300":"0.6988 -0.1384 -0.0714 -0.5631 1.341 0.2447 -0.1485 0.2204 0.7318","Nikon D3200":"0.7013 -0.1408 -0.0635 -0.5268 1.2902 0.264 -0.147 0.2801 0.7379","Nikon Z 8":"1.1423 -0.4564 -0.1123 -0.4816 1.2895 0.2119 -0.021 0.1061 0.7282","Nikon D810A":"1.1973 -0.5685 -0.0888 -0.1965 1.0326 0.1901 -0.0115 0.1123 0.7169","Nikon D5500":"0.8821 -0.2938 -0.0785 -0.4178 1.2142 0.2287 -0.0824 0.1651 0.686","Nikon Z 6 3":"1.1206 -0.4286 -0.0941 -0.4879 1.2847 0.2251 -0.0745 0.1654 0.7374","Nikon D750":"0.902 -0.289 -0.0715 -0.4535 1.2436 0.2348 -0.0934 0.1919 0.7086","Nikon Z 6":"0.9943 -0.3269 -0.0839 -0.5323 1.3269 0.2259 -0.1198 0.2083 0.7557","Nikon D500":"0.8813 -0.321 -0.1036 -0.4703 1.2868 0.2021 -0.1054 0.194 0.6129","Nikon D3400":"0.6988 -0.1384 -0.0714 -0.5631 1.341 0.2447 -0.1485 0.2204 0.7318","Nikon D5300":"0.6988 -0.1384 -0.0714 -0.5631 1.341 0.2447 -0.1485 0.2204 0.7318","Nikon D5600":"0.8821 -0.2938 -0.0785 -0.4178 1.2142 0.2287 -0.0824 0.1651 0.686","Nikon D780":"0.9943 -0.3269 -0.0839 -0.5323 1.3269 0.2259 -0.1198 0.2083 0.7557","Nikon Z 6 2":"0.9943 -0.3269 -0.0839 -0.5323 1.3269 0.2259 -0.1198 0.2083 0.7557","Nikon D5":"0.92 -0.3522 -0.0992 -0.5755 1.3803 0.2117 -0.0753 0.1486 0.6338","Nikon 1 J4":"0.5958 -0.1559 -0.0571 -0.4021 1.1453 0.2939 -0.0634 0.1548 0.5087","Nikon D800":"0.7866 -0.2108 -0.0555 -0.4869 1.2483 0.2681 -0.1176 0.2069 0.7501","Nikon 1 S1":"0.8994 -0.2667 -0.0865 -0.4594 1.2324 0.2552 -0.0699 0.1786 0.626","Nikon D850":"1.0405 -0.3755 -0.127 -0.5461 1.3787 0.1793 -0.104 0.2015 0.6785","Nikon 1 J3":"0.6588 -0.1305 -0.0693 -0.3277 1.0987 0.2634 -0.0355 0.2016 0.5106","Nikon D7200":"0.8322 -0.3112 -0.1047 -0.6367 1.4342 0.2179 -0.0988 0.1638 0.6394","Nikon Z 5":"0.8695 -0.2558 -0.0648 -0.5015 1.2711 0.2575 -0.1279 0.2215 0.7514","Nikon Z 50":"1.164 -0.4829 -0.1079 -0.5107 1.3006 0.2325 -0.0972 0.1711 0.738","Nikon Z 7 2":"1.3705 -0.6004 -0.14 -0.5464 1.3568 0.2062 -0.094 0.1706 0.7618","Nikon 1 J5":"0.752 -0.2518 -0.0645 -0.3844 1.2102 0.1945 -0.0913 0.2249 0.6835","Nikon Z 5 2":"1.3133 -0.5542 -0.128 -0.4325 1.2543 0.1972 0.0034 0.0792 0.7662","Nikon Z fc":"1.164 -0.4829 -0.1079 -0.5107 1.3006 0.2325 -0.0972 0.1711 0.738","Nikon Z f":"1.1607 -0.4491 -0.0977 -0.4522 1.246 0.2304 -0.0458 0.1519 0.7616","Nikon D610":"0.8178 -0.2245 -0.0609 -0.4857 1.2394 0.2776 -0.1207 0.2086 0.7298","Nikon Z 7":"1.3705 -0.6004 -0.14 -0.5464 1.3568 0.2062 -0.094 0.1706 0.7618","Nikon Df":"0.8598 -0.2848 -0.0857 -0.5618 1.3606 0.2195 -0.1002 0.1773 0.7137","Nikon 1 V3":"0.5958 -0.1559 -0.0571 -0.4021 1.1453 0.2939 -0.0634 0.1548 0.5087","Nikon D7000":"0.8198 -0.2239 -0.0724 -0.4871 1.2389 0.2798 -0.1043 0.205 0.7181","Nikon Z 9":"1.3389 -0.6049 -0.1441 -0.4544 1.2757 0.1969 0.0229 0.0498 0.739","Nikon Z 50 2":"1.164 -0.4829 -0.1079 -0.5107 1.3006 0.2325 -0.0972 0.1711 0.738","Nikon D4S":"0.8598 -0.2848 -0.0857 -0.5618 1.3606 0.2195 -0.1002 0.1773 0.7137","Nikon D810":"0.9369 -0.3195 -0.0791 -0.4488 1.243 0.2301 -0.0893 0.1796 0.6872","Nikon D4":"0.8598 -0.2848 -0.0857 -0.5618 1.3606 0.2195 -0.1002 0.1773 0.7137","DXO ONE":"0.6596 -0.2079 -0.0562 -0.4782 1.3016 0.1933 -0.097 0.1581 0.5181","DXO-ONE":"0.6596 -0.2079 -0.0562 -0.4782 1.3016 0.1933 -0.097 0.1581 0.5181","Nikon D800E":"0.7866 -0.2108 -0.0555 -0.4869 1.2483 0.2681 -0.1176 0.2069 0.7501","ZEISS ZX1":"1 -0.4766 -0.0938 -0.2969 1.1328 0.1875 -0.0313 0.1094 0.7422","PENTAX K-50":"0.8628 -0.2607 -0.1156 -0.3995 1.2301 0.1881 -0.099 0.1735 0.6595","PENTAX K-500":"0.8513 -0.2572 -0.114 -0.3995 1.2301 0.1881 -0.1003 0.1758 0.6683","PENTAX K-3 II":"0.8571 -0.259 -0.1148 -0.3995 1.2301 0.1881 -0.1052 0.1844 0.7013","PENTAX K-S2":"0.8009 -0.2517 -0.114 -0.3882 1.235 0.1689 -0.0844 0.1493 0.6312","PENTAX K-3":"0.8761 -0.2648 -0.1173 -0.3995 1.2301 0.1881 -0.0901 0.1579 0.6001","PENTAX KP":"0.7357 -0.2031 -0.132 -0.4842 1.3555 0.1349 -0.1538 0.2416 0.5736","PENTAX MX-1":"0.8804 -0.2523 -0.1238 -0.2423 1.1627 0.086 -0.0682 0.1774 0.4753","PENTAX K-70":"0.8117 -0.2078 -0.1275 -0.4359 1.2953 0.1515 -0.1096 0.1965 0.6073","PENTAX K-3 Mark III":"0.6842 -0.1581 -0.0867 -0.4614 1.2728 0.2065 -0.0639 0.1428 0.5682","PENTAX 645Z":"0.9829 -0.31 -0.1271 -0.3685 1.2133 0.1721 -0.1068 0.1977 0.6854","PENTAX K-1":"0.8566 -0.2746 -0.1201 -0.3612 1.2204 0.155 -0.0893 0.168 0.6264","PENTAX Q7":"1.2995 -0.5593 -0.1107 -0.1879 1.0139 0.2027 -0.0064 0.1233 0.4919","Canon PowerShot SX60 HS":"1.3161 -0.5451 -0.1344 -0.1989 1.0654 0.1531 -0.0047 0.1271 0.4955","Canon PowerShot G15":"0.7474 -0.2301 -0.0567 -0.4056 1.1456 0.2975 -0.0222 0.0716 0.4181","Canon PowerShot G5 X Mark II":"1.1629 -0.5713 -0.0914 -0.2706 1.109 0.1842 -0.0206 0.1225 0.5515","Canon PowerShot G16":"0.802 -0.2687 -0.0682 -0.3704 1.1879 0.2052 -0.0965 0.1921 0.5556","Canon PowerShot S120":"0.6961 -0.1685 -0.0695 -0.4625 1.2945 0.1836 -0.1114 0.2152 0.5518","Canon PowerShot G1 X":"0.7378 -0.1255 -0.1043 -0.4088 1.2251 0.2048 -0.0876 0.1946 0.5805","Canon EOS M5":"0.8532 -0.0701 -0.1167 -0.4095 1.1879 0.2508 -0.0797 0.2424 0.701","Canon EOS M6":"0.8532 -0.0701 -0.1167 -0.4095 1.1879 0.2508 -0.0797 0.2424 0.701","Canon PowerShot G7 X":"0.9602 -0.3823 -0.0937 -0.2984 1.1495 0.1675 -0.0407 0.1415 0.5049","Canon PowerShot G7 X Mark II":"0.9602 -0.3823 -0.0937 -0.2984 1.1495 0.1675 -0.0407 0.1415 0.5049","Canon PowerShot G9 X":"0.9602 -0.3823 -0.0937 -0.2984 1.1495 0.1675 -0.0407 0.1415 0.5049","Canon PowerShot G3 X":"0.9701 -0.3857 -0.0921 -0.3149 1.1537 0.1817 -0.0786 0.1817 0.5147","Canon EOS 6D Mark II":"0.6875 -0.097 -0.0932 -0.4691 1.2459 0.2501 -0.0874 0.1953 0.5809","Canon PowerShot G1 X Mark III":"0.8532 -0.0701 -0.1167 -0.4095 1.1879 0.2508 -0.0797 0.2424 0.701","Canon PowerShot G9 X Mark II":"1.0056 -0.4131 -0.0944 -0.2576 1.1143 0.1625 -0.0238 0.1294 0.5179","Canon EOS 200D":"0.7377 -0.0742 -0.0998 -0.4235 1.1981 0.2549 -0.0673 0.1918 0.5538","Canon EOS R10":"0.9269 -0.2012 -0.1107 -0.399 1.1762 0.2527 -0.0569 0.2093 0.4913","Canon PowerShot G5 X":"0.9602 -0.3823 -0.0937 -0.2984 1.1495 0.1675 -0.0407 0.1415 0.5049","Canon PowerShot G1 X Mark II":"0.7378 -0.1255 -0.1043 -0.4088 1.2251 0.2048 -0.0876 0.1946 0.5805","Canon EOS M100":"0.8532 -0.0701 -0.1167 -0.4095 1.1879 0.2508 -0.0797 0.2424 0.701","Canon EOS RP":"0.8608 -0.2097 -0.1178 -0.5425 1.3265 0.2383 -0.1149 0.2238 0.568","Canon EOS 7D":"0.6844 -0.0996 -0.0856 -0.3876 1.1761 0.2396 -0.0593 0.1772 0.6198","Canon EOS 90D":"1.1498 -0.3759 -0.1516 -0.5073 1.2954 0.2349 -0.0892 0.1867 0.6118","Canon PowerShot V1":"1.26 -0.4747 -0.2027 -0.611 1.5868 -0.0029 0.011 0.0479 0.6011","Canon EOS M3":"0.6362 -0.0823 -0.0847 -0.4426 1.2109 0.2616 -0.0743 0.1857 0.5635","Canon PowerShot G7 X Mark III":"1.1629 -0.5713 -0.0914 -0.2706 1.109 0.1842 -0.0206 0.1225 0.5515","Canon EOS M50":"0.8532 -0.0701 -0.1167 -0.4095 1.1879 0.2508 -0.0797 0.2424 0.701","Canon EOS 80D":"0.7457 -0.0671 -0.0937 -0.4849 1.2495 0.2643 -0.1213 0.2354 0.5492","Canon EOS M200":"1.0463 -0.2173 -0.1437 -0.4856 1.2635 0.2482 -0.1216 0.2915 0.7237","Canon EOS R100":"0.823 -0.1515 -0.1032 -0.4179 1.2005 0.2454 -0.0649 0.2076 0.4711","Canon EOS 700D":"0.6602 -0.0841 -0.0939 -0.4472 1.2458 0.2247 -0.0975 0.2039 0.6148","Canon EOS 100D":"0.6602 -0.0841 -0.0939 -0.4472 1.2458 0.2247 -0.0975 0.2039 0.6148","Canon EOS M6 Mark II":"1.1498 -0.3759 -0.1516 -0.5073 1.2954 0.2349 -0.0892 0.1867 0.6118","Canon EOS 70D":"0.7034 -0.0804 -0.1014 -0.442 1.2564 0.2058 -0.0851 0.1994 0.5758","Canon EOS R8":"0.9539 -0.2795 -0.1224 -0.4175 1.1998 0.2458 -0.0465 0.1755 0.6048","Canon EOS 6D":"0.7034 -0.0804 -0.1014 -0.442 1.2564 0.2058 -0.0851 0.1994 0.5758","Canon EOS R50 V":"0.9089 -0.181 -0.1209 -0.4294 1.2116 0.2454 -0.0498 0.1862 0.4923","Canon EOS 77D":"0.7377 -0.0742 -0.0998 -0.4235 1.1981 0.2549 -0.0673 0.1918 0.5538","LEICA M10":"0.8249 -0.2849 -0.062 -0.5415 1.4756 0.0565 -0.0957 0.3074 0.6517","LEICA Q (Typ 116)":"1.1865 -0.4523 -0.1441 -0.5423 1.4458 0.0935 -0.1587 0.2687 0.483","LEICA Q3 43":"1.1111 -0.3816 -0.1057 -0.375 1.2107 0.1829 -0.0947 0.1868 0.4645","LEICA Q2":"1.1865 -0.4523 -0.1441 -0.5423 1.4458 0.0935 -0.1587 0.2687 0.483","LEICA SL (Typ 601)":"1.1865 -0.4523 -0.1441 -0.5423 1.4458 0.0935 -0.1587 0.2687 0.483","LEICA D-Lux 8":"0.8585 -0.3127 -0.0833 -0.4005 1.225 0.1953 -0.065 0.1494 0.4862","LEICA T (Typ 701)":"0.5463 -0.0988 -0.0364 -0.4634 1.2036 0.2946 -0.0766 0.1389 0.6522","LEICA X (Typ 113)":"0.7712 -0.2059 -0.0653 -0.3882 1.1494 0.2726 -0.071 0.1332 0.5958","PENTAX K-1 Mark II":"0.8935 -0.2864 -0.1253 -0.3612 1.2204 0.155 -0.0905 0.1702 0.6346","Panasonic DMC-ZS40":"0.8607 -0.2822 -0.0808 -0.3755 1.193 0.2049 -0.082 0.206 0.5224","Panasonic DMC-CM1":"0.877 -0.3194 -0.082 -0.2871 1.1281 0.1803 -0.0513 0.1552 0.4434","Panasonic DC-G9":"0.7685 -0.2375 -0.0634 -0.3687 1.17 0.2249 -0.0748 0.1546 0.5111","Panasonic DMC-ZS50":"0.8802 -0.3135 -0.0789 -0.3151 1.1468 0.1904 -0.055 0.1745 0.481","Panasonic DMC-GX85":"0.7771 -0.302 -0.0629 -0.4029 1.195 0.2345 -0.0821 0.1977 0.6119","Panasonic DMC-LX9":"0.779 -0.2736 -0.0755 -0.3452 1.187 0.1769 -0.0628 0.1647 0.4898","Panasonic DC-FZ80":"1.1532 -0.4324 -0.1066 -0.2375 1.0847 0.1749 -0.0564 0.1699 0.4351","Panasonic DMC-FZ300":"0.8378 -0.2798 -0.0769 -0.3068 1.141 0.1877 -0.0538 0.1792 0.4623","Panasonic DMC-GX8":"0.7564 -0.2263 -0.0606 -0.3148 1.1239 0.2177 -0.054 0.1435 0.4853","Panasonic DC-S1RM2":"0.9941 -0.4056 -0.0871 -0.3745 1.1604 0.2433 -0.0254 0.1132 0.5526","Panasonic DC-GH6":"0.7949 -0.3491 -0.071 -0.3435 1.1681 0.1977 -0.0503 0.1622 0.5065","Panasonic DC-S1":"0.9744 -0.3905 -0.0779 -0.4899 1.2807 0.2324 -0.0798 0.163 0.5827","Olympus E-M5":"0.838 -0.263 -0.0639 -0.2887 1.0725 0.2496 -0.0627 0.1427 0.5438","Panasonic DMC-ZS100":"0.779 -0.2736 -0.0755 -0.3452 1.187 0.1769 -0.0628 0.1647 0.4898","Olympus E-M5 Mark II":"0.9422 -0.3258 -0.0711 -0.2655 1.0898 0.2015 -0.0512 0.1354 0.5512","Panasonic DC-GF9":"0.761 -0.278 -0.0576 -0.4614 1.2195 0.2733 -0.1375 0.2393 0.649","Panasonic DMC-GF7":"0.761 -0.278 -0.0576 -0.4614 1.2195 0.2733 -0.1375 0.2393 0.649","Olympus PEN-F":"0.9476 -0.3182 -0.0765 -0.2613 1.0958 0.1893 -0.0449 0.1315 0.5268","Panasonic DC-S1H":"0.9397 -0.3719 -0.0805 -0.5425 1.3326 0.2309 -0.0972 0.1715 0.6034","Panasonic DMC-LX100":"0.8844 -0.3538 -0.0768 -0.3709 1.1762 0.22 -0.0698 0.1792 0.522","Panasonic DMC-FZ2500":"0.7386 -0.2443 -0.0743 -0.3437 1.1864 0.1757 -0.0608 0.166 0.4766","Panasonic DC-G99":"0.9657 -0.3963 -0.0748 -0.3361 1.1378 0.2258 -0.0568 0.1415 0.5158","Panasonic DC-LX100M2":"0.8585 -0.3127 -0.0833 -0.4005 1.225 0.1953 -0.065 0.1494 0.4862","Panasonic DC-S1R":"1.1822 -0.5321 -0.1249 -0.5958 1.5114 0.0766 -0.0614 0.1264 0.7043","Panasonic DC-G9M2":"0.8325 -0.3456 -0.0623 -0.433 1.2089 0.2528 -0.086 0.2646 0.5984","Panasonic DC-S9":"0.9983 -0.389 -0.0841 -0.418 1.2164 0.2263 -0.0249 0.1139 0.5766","Panasonic DC-ZS200":"0.779 -0.2736 -0.0755 -0.3452 1.187 0.1769 -0.0628 0.1647 0.4898","Panasonic DC-GX9":"0.7564 -0.2263 -0.0606 -0.3148 1.1239 0.2177 -0.054 0.1435 0.4853","Panasonic DMC-G8":"0.761 -0.278 -0.0576 -0.4614 1.2195 0.2733 -0.1375 0.2393 0.649","Panasonic DMC-ZS60":"0.855 -0.2908 -0.0842 -0.3195 1.1529 0.1881 -0.0338 0.1603 0.4631","Panasonic DC-S1M2":"1.073 -0.4442 -0.0922 -0.4478 1.2504 0.2199 -0.038 0.1198 0.6039","Panasonic DC-GH5S":"0.6929 -0.2355 -0.0708 -0.4192 1.2534 0.1828 -0.1097 0.1989 0.5195","Panasonic DC-S5":"0.9744 -0.3905 -0.0779 -0.4899 1.2807 0.2324 -0.0798 0.163 0.5827","Panasonic DC-GH5M2":"0.93 -0.3659 -0.0755 -0.2981 1.0988 0.2287 -0.019 0.1077 0.5016","Panasonic DC-FZ1000M2":"0.9803 -0.4185 -0.0992 -0.4066 1.2578 0.1628 -0.0838 0.1824 0.5288","Panasonic DC-GH5":"0.7641 -0.2336 -0.0605 -0.3218 1.1299 0.2187 -0.0485 0.1338 0.5121","Panasonic DMC-GX7":"0.761 -0.278 -0.0576 -0.4614 1.2195 0.2733 -0.1375 0.2393 0.649","Panasonic DMC-LX7":"1.0148 -0.3743 -0.0991 -0.2837 1.1366 0.1659 -0.0701 0.1893 0.4899","Panasonic DC-GH7":"0.8573 -0.3575 -0.0678 -0.4252 1.2079 0.2451 -0.0808 0.2524 0.5936","Panasonic DC-S5M2":"1.0308 -0.4206 -0.0783 -0.4088 1.2102 0.2229 -0.0125 0.1051 0.5912","Panasonic DMC-LF1":"0.9379 -0.3267 -0.0816 -0.3227 1.156 0.1881 -0.0926 0.1928 0.534","Panasonic DMC-G7":"0.761 -0.278 -0.0576 -0.4614 1.2195 0.2733 -0.1375 0.2393 0.649","Olympus E-M1X":"1.1896 -0.511 -0.1076 -0.3181 1.1378 0.2048 -0.0519 0.1224 0.5166","OM Digital Solutions OM-1":"0.9488 -0.3984 -0.0714 -0.2887 1.0945 0.2229 -0.0137 0.096 0.5786","Olympus E-M10":"0.838 -0.263 -0.0639 -0.2887 1.0725 0.2496 -0.0627 0.1427 0.5438","Olympus E-M1 Mark III":"1.1896 -0.511 -0.1076 -0.3181 1.1378 0.2048 -0.0519 0.1224 0.5166","Olympus TG-4":"1.1426 -0.4159 -0.1126 -0.2066 1.0678 0.1593 -0.012 0.1327 0.4998","Olympus E-P5":"0.838 -0.263 -0.0639 -0.2887 1.0725 0.2496 -0.0627 0.1427 0.5438","Olympus E-M10 Mark II":"0.838 -0.263 -0.0639 -0.2887 1.0725 0.2496 -0.0627 0.1427 0.5438","Olympus E-M1":"0.7687 -0.1984 -0.0606 -0.4327 1.1928 0.2721 -0.1381 0.2339 0.6452","Olympus E-PL5":"0.838 -0.263 -0.0639 -0.2887 1.0725 0.2496 -0.0627 0.1427 0.5438","Panasonic DMC-GM1":"0.677 -0.1895 -0.0744 -0.5232 1.3145 0.2303 -0.1664 0.2691 0.5703","Panasonic DMC-GF6":"0.813 -0.2801 -0.0946 -0.352 1.1289 0.2552 -0.1314 0.2511 0.5791","Panasonic DMC-FZ1000":"0.783 -0.2696 -0.0763 -0.3325 1.1667 0.1866 -0.0641 0.1712 0.4824","Panasonic DMC-GH4":"0.7122 -0.2108 -0.0512 -0.3155 1.1201 0.2231 -0.0541 0.1423 0.5045","Panasonic DMC-GM5":"0.8238 -0.3244 -0.0679 -0.3921 1.1814 0.2384 -0.0836 0.2022 0.5852","OM Digital Solutions OM-5 Mark II":"1.2008 -0.523 -0.1123 -0.2265 1.0496 0.2046 0.0069 0.0734 0.4938",M1:"0.7712 -0.2059 -0.0653 -0.3882 1.1494 0.2726 -0.071 0.1332 0.5958","Olympus XZ-2":"0.9777 -0.3483 -0.0925 -0.2886 1.1297 0.18 -0.0602 0.1663 0.5134","Olympus E-M1 Mark II":"0.9383 -0.317 -0.0763 -0.2457 1.0702 0.202 -0.0384 0.1236 0.5552","Olympus E-PL7":"0.9197 -0.319 -0.0659 -0.2606 1.083 0.2039 -0.0458 0.125 0.5458","OM Digital Solutions OM-5":"1.1896 -0.511 -0.1076 -0.3181 1.1378 0.2048 -0.0519 0.1224 0.5166","Olympus E-M5 Mark III":"1.1896 -0.511 -0.1076 -0.3181 1.1378 0.2048 -0.0519 0.1224 0.5166","Olympus STYLUS 1":"0.836 -0.242 -0.088 -0.3928 1.2353 0.1739 -0.1381 0.2416 0.5173","RICOH GR IV":"0.6428 -0.1485 -0.0814 -0.4614 1.2728 0.2065 -0.0667 0.1489 0.5924","RICOH GR III":"0.6093 -0.1407 -0.0772 -0.4614 1.2728 0.2065 -0.0663 0.1481 0.5892","GR II":"0.4717 -0.085 -0.0431 -0.4977 1.2805 0.2417 -0.0641 0.1474 0.6143","Olympus E-M10 Mark III":"0.838 -0.263 -0.0639 -0.2887 1.0725 0.2496 -0.0627 0.1427 0.5438","Samsung NX1":"1.0686 -0.4042 -0.1052 -0.3595 1.3238 0.0276 -0.0464 0.1259 0.5931","Samsung NX2000":"0.7557 -0.2522 -0.0739 -0.4679 1.2949 0.1894 -0.084 0.1777 0.5311","Samsung NX500":"1.0686 -0.4042 -0.1052 -0.3595 1.3238 0.0276 -0.0464 0.1259 0.5931","Samsung NX300":"0.7557 -0.2522 -0.0739 -0.4679 1.2949 0.1894 -0.084 0.1777 0.5311","Samsung NX30":"0.7557 -0.2522 -0.0739 -0.4679 1.2949 0.1894 -0.084 0.1777 0.5311","Samsung NX mini":"0.5222 -0.1196 -0.055 -0.654 1.4649 0.2009 -0.1666 0.2819 0.5657","SIGMA fp L":"1.079 -0.2673 -0.228 -0.6718 1.5773 0.0854 -0.1473 0.2047 0.4597","sd Quattro H":"1.2907 0.0532 -0.3603 0.2957 0.7904 -0.0911 0.0255 0.7093 0.3228","Phase One IQ4 150MP":"0.6644 -0.2257 -0.0804 -0.6459 1.4562 0.2019 -0.1221 0.1876 0.6411","Sony ILCE-7RM4":"0.7662 -0.2686 -0.066 -0.524 1.2965 0.253 -0.0796 0.1508 0.6167","Fujifilm X-E4":"1.3426 -0.6334 -0.1177 -0.4244 1.2136 0.2371 -0.058 0.1303 0.598"};function qh(e,t,r,n=[0,0,0,0],a=65535,i="RGGB",o=null){const l=e*t*2,u=8,d=u+l,f="Fake",h="StretchedNoiseCam",g="StretchedNoiseCam",v=W=>{const I=new Uint8Array(W.length+1);for(let G=0;G<W.length;G++)I[G]=W.charCodeAt(G);return I[W.length]=0,I},w=v(f),b=v(h),x=v(g),y=W=>{const I=[0,0,0,0],G={R:0,G:1,B:2},U=W.toUpperCase();for(let X=0;X<4;X++)I[X]=G[U[X]]??1;return I},_=W=>{const I=[];return W.forEach(G=>{I.push(Math.round(G*1e4)),I.push(1e4)}),I},j=[{id:254,type:4,count:1,value:0},{id:256,type:4,count:1,value:e},{id:257,type:4,count:1,value:t},{id:258,type:3,count:1,value:16},{id:259,type:3,count:1,value:1},{id:262,type:3,count:1,value:32803},{id:271,type:2,count:w.length,value:w},{id:272,type:2,count:b.length,value:b},{id:273,type:4,count:1,value:u},{id:277,type:3,count:1,value:1},{id:278,type:4,count:1,value:t},{id:279,type:4,count:1,value:l},{id:33421,type:3,count:2,value:[2,2]},{id:33422,type:1,count:4,value:y(i)},{id:50706,type:1,count:4,value:[1,4,0,0]},{id:50714,type:3,count:4,value:n.map(W=>Math.round(W))},{id:50715,type:4,count:1,value:Math.round(a)},{id:50717,type:2,count:x.length,value:x}];o&&o.length===9&&(j.push({id:50721,type:10,count:9,value:_(o)}),j.push({id:50778,type:3,count:1,value:21})),j.sort((W,I)=>W.id-I.id);const S=2+j.length*12+4;let k=0;const M=j.map(W=>{let I=1;W.type===3&&(I=2),W.type===4&&(I=4),(W.type===5||W.type===10)&&(I=8);const G=W.count*I,U=G<=4;let X=0;return U||(X=k,k+=G,k%2!==0&&k++),{...W,fits:U,totalBytes:G,extraOffset:X,typeSize:I}}),N=d+S,T=N+k,A=new ArrayBuffer(T),D=new DataView(A),$=new Uint8Array(A);D.setUint16(0,18761,!0),D.setUint16(2,42,!0),D.setUint32(4,d,!0);const B=new Uint8Array(r.buffer,r.byteOffset,r.byteLength);$.set(B,u);let J=d;return D.setUint16(J,j.length,!0),J+=2,M.forEach(W=>{if(D.setUint16(J,W.id,!0),D.setUint16(J+2,W.type,!0),D.setUint32(J+4,W.count,!0),W.fits){const I=J+8;Array.isArray(W.value)?W.value.forEach((G,U)=>{W.type===1&&D.setUint8(I+U,G),W.type===3&&D.setUint16(I+U*2,G,!0)}):(W.type===3&&D.setUint16(I,W.value,!0),W.type===4&&D.setUint32(I,W.value,!0))}else{const I=N+W.extraOffset;D.setUint32(J+8,I,!0),W.value instanceof Uint8Array?$.set(W.value,I):Array.isArray(W.value)&&W.value.forEach((G,U)=>{W.type===1&&D.setUint8(I+U,G),W.type===2&&D.setUint8(I+U,G),W.type===3&&D.setUint16(I+U*2,G,!0),W.type===4&&D.setUint32(I+U*4,G,!0),(W.type===5||W.type===10)&&(W.type===10?D.setInt32(I+U*4,G,!0):D.setUint32(I+U*4,G,!0))})}J+=12}),D.setUint32(J,0,!0),A}var qg=typeof self<"u"?self:global;const Xf=typeof navigator<"u",dT=Xf&&typeof HTMLImageElement>"u",Sp=!(typeof global>"u"||typeof process>"u"||!process.versions||!process.versions.node),Zg=qg.Buffer,gh=qg.BigInt,Jg=!!Zg,fT=e=>e;function _p(e,t=fT){if(Sp)try{return typeof require=="function"?Promise.resolve(t(require(e))):import(e).then(t)}catch{console.warn(`Couldn't load ${e}`)}}let qb=qg.fetch;const hT=e=>qb=e;if(!qg.fetch){const e=_p("http",n=>n),t=_p("https",n=>n),r=(n,{headers:a}={})=>new Promise(async(i,o)=>{let{port:s,hostname:l,pathname:u,protocol:d,search:f}=new URL(n);const h={method:"GET",hostname:l,path:encodeURI(u)+f,headers:a};s!==""&&(h.port=Number(s));const g=(d==="https:"?await t:await e).request(h,v=>{if(v.statusCode===301||v.statusCode===302){let w=new URL(v.headers.location,n).toString();return r(w,{headers:a}).then(i).catch(o)}i({status:v.statusCode,arrayBuffer:()=>new Promise(w=>{let b=[];v.on("data",x=>b.push(x)),v.on("end",()=>w(Buffer.concat(b)))})})});g.on("error",o),g.end()});hT(r)}function Ft(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}const jp=e=>FP(e)?void 0:e,pT=e=>e!==void 0;function FP(e){return e===void 0||(e instanceof Map?e.size===0:Object.values(e).filter(pT).length===0)}function Yn(e){let t=new Error(e);throw delete t.stack,t}function Fl(e){return(e=function(t){for(;t.endsWith("\0");)t=t.slice(0,-1);return t}(e).trim())===""?void 0:e}function pv(e){let t=function(r){let n=0;return r.ifd0.enabled&&(n+=1024),r.exif.enabled&&(n+=2048),r.makerNote&&(n+=2048),r.userComment&&(n+=1024),r.gps.enabled&&(n+=512),r.interop.enabled&&(n+=100),r.ifd1.enabled&&(n+=1024),n+2048}(e);return e.jfif.enabled&&(t+=50),e.xmp.enabled&&(t+=2e4),e.iptc.enabled&&(t+=14e3),e.icc.enabled&&(t+=6e3),t}const gv=e=>String.fromCharCode.apply(null,e),Bk=typeof TextDecoder<"u"?new TextDecoder("utf-8"):void 0;function UP(e){return Bk?Bk.decode(e):Jg?Buffer.from(e).toString("utf8"):decodeURIComponent(escape(gv(e)))}class li{static from(t,r){return t instanceof this&&t.le===r?t:new li(t,void 0,void 0,r)}constructor(t,r=0,n,a){if(typeof a=="boolean"&&(this.le=a),Array.isArray(t)&&(t=new Uint8Array(t)),t===0)this.byteOffset=0,this.byteLength=0;else if(t instanceof ArrayBuffer){n===void 0&&(n=t.byteLength-r);let i=new DataView(t,r,n);this._swapDataView(i)}else if(t instanceof Uint8Array||t instanceof DataView||t instanceof li){n===void 0&&(n=t.byteLength-r),(r+=t.byteOffset)+n>t.byteOffset+t.byteLength&&Yn("Creating view outside of available memory in ArrayBuffer");let i=new DataView(t.buffer,r,n);this._swapDataView(i)}else if(typeof t=="number"){let i=new DataView(new ArrayBuffer(t));this._swapDataView(i)}else Yn("Invalid input argument for BufferView: "+t)}_swapArrayBuffer(t){this._swapDataView(new DataView(t))}_swapBuffer(t){this._swapDataView(new DataView(t.buffer,t.byteOffset,t.byteLength))}_swapDataView(t){this.dataView=t,this.buffer=t.buffer,this.byteOffset=t.byteOffset,this.byteLength=t.byteLength}_lengthToEnd(t){return this.byteLength-t}set(t,r,n=li){return t instanceof DataView||t instanceof li?t=new Uint8Array(t.buffer,t.byteOffset,t.byteLength):t instanceof ArrayBuffer&&(t=new Uint8Array(t)),t instanceof Uint8Array||Yn("BufferView.set(): Invalid data argument."),this.toUint8().set(t,r),new n(this,r,t.byteLength)}subarray(t,r){return r=r||this._lengthToEnd(t),new li(this,t,r)}toUint8(){return new Uint8Array(this.buffer,this.byteOffset,this.byteLength)}getUint8Array(t,r){return new Uint8Array(this.buffer,this.byteOffset+t,r)}getString(t=0,r=this.byteLength){return UP(this.getUint8Array(t,r))}getLatin1String(t=0,r=this.byteLength){let n=this.getUint8Array(t,r);return gv(n)}getUnicodeString(t=0,r=this.byteLength){const n=[];for(let a=0;a<r&&t+a<this.byteLength;a+=2)n.push(this.getUint16(t+a));return gv(n)}getInt8(t){return this.dataView.getInt8(t)}getUint8(t){return this.dataView.getUint8(t)}getInt16(t,r=this.le){return this.dataView.getInt16(t,r)}getInt32(t,r=this.le){return this.dataView.getInt32(t,r)}getUint16(t,r=this.le){return this.dataView.getUint16(t,r)}getUint32(t,r=this.le){return this.dataView.getUint32(t,r)}getFloat32(t,r=this.le){return this.dataView.getFloat32(t,r)}getFloat64(t,r=this.le){return this.dataView.getFloat64(t,r)}getFloat(t,r=this.le){return this.dataView.getFloat32(t,r)}getDouble(t,r=this.le){return this.dataView.getFloat64(t,r)}getUintBytes(t,r,n){switch(r){case 1:return this.getUint8(t,n);case 2:return this.getUint16(t,n);case 4:return this.getUint32(t,n);case 8:return this.getUint64&&this.getUint64(t,n)}}getUint(t,r,n){switch(r){case 8:return this.getUint8(t,n);case 16:return this.getUint16(t,n);case 32:return this.getUint32(t,n);case 64:return this.getUint64&&this.getUint64(t,n)}}toString(t){return this.dataView.toString(t,this.constructor.name)}ensureChunk(){}}function mv(e,t){Yn(`${e} '${t}' was not loaded, try using full build of exifr.`)}let Zb=class extends Map{constructor(t){super(),this.kind=t}get(t,r){return this.has(t)||mv(this.kind,t),r&&(t in r||function(n,a){Yn(`Unknown ${n} '${a}'.`)}(this.kind,t),r[t].enabled||mv(this.kind,t)),super.get(t)}keyList(){return Array.from(this.keys())}};var Fo=new Zb("file parser"),Hn=new Zb("segment parser"),zo=new Zb("file reader");function gT(e,t){return typeof e=="string"?Fk(e,t):Xf&&!dT&&e instanceof HTMLImageElement?Fk(e.src,t):e instanceof Uint8Array||e instanceof ArrayBuffer||e instanceof DataView?new li(e):Xf&&e instanceof Blob?yv(e,t,"blob",uc):void Yn("Invalid input argument")}function Fk(e,t){return(r=e).startsWith("data:")||r.length>1e4?xv(e,t,"base64"):Sp&&e.includes("://")?yv(e,t,"url",cc):Sp?xv(e,t,"fs"):Xf?yv(e,t,"url",cc):void Yn("Invalid input argument");var r}async function yv(e,t,r,n){return zo.has(r)?xv(e,t,r):n?async function(a,i){let o=await i(a);return new li(o)}(e,n):void Yn(`Parser ${r} is not loaded`)}async function xv(e,t,r){let n=new(zo.get(r))(e,t);return await n.read(),n}const cc=e=>qb(e).then(t=>t.arrayBuffer()),uc=e=>new Promise((t,r)=>{let n=new FileReader;n.onloadend=()=>t(n.result||new ArrayBuffer),n.onerror=r,n.readAsArrayBuffer(e)});class mT extends Map{get tagKeys(){return this.allKeys||(this.allKeys=Array.from(this.keys())),this.allKeys}get tagValues(){return this.allValues||(this.allValues=Array.from(this.values())),this.allValues}}function Gn(e,t,r){let n=new mT;for(let[a,i]of r)n.set(a,i);if(Array.isArray(t))for(let a of t)e.set(a,n);else e.set(t,n);return n}function dc(e,t,r){let n,a=e.get(t);for(n of r)a.set(n[0],n[1])}const ma=new Map,wo=new Map,fl=new Map,Ys=["chunked","firstChunkSize","firstChunkSizeNode","firstChunkSizeBrowser","chunkSize","chunkLimit"],nd=["jfif","xmp","icc","iptc","ihdr"],fc=["tiff",...nd],Rn=["ifd0","ifd1","exif","gps","interop"],qs=[...fc,...Rn],Zs=["makerNote","userComment"],ad=["translateKeys","translateValues","reviveValues","multiSegment"],Js=[...ad,"sanitize","mergeOutput","silentErrors"];class GP{get translate(){return this.translateKeys||this.translateValues||this.reviveValues}}class Hd extends GP{get needed(){return this.enabled||this.deps.size>0}constructor(t,r,n,a){if(super(),Ft(this,"enabled",!1),Ft(this,"skip",new Set),Ft(this,"pick",new Set),Ft(this,"deps",new Set),Ft(this,"translateKeys",!1),Ft(this,"translateValues",!1),Ft(this,"reviveValues",!1),this.key=t,this.enabled=r,this.parse=this.enabled,this.applyInheritables(a),this.canBeFiltered=Rn.includes(t),this.canBeFiltered&&(this.dict=ma.get(t)),n!==void 0)if(Array.isArray(n))this.parse=this.enabled=!0,this.canBeFiltered&&n.length>0&&this.translateTagSet(n,this.pick);else if(typeof n=="object"){if(this.enabled=!0,this.parse=n.parse!==!1,this.canBeFiltered){let{pick:i,skip:o}=n;i&&i.length>0&&this.translateTagSet(i,this.pick),o&&o.length>0&&this.translateTagSet(o,this.skip)}this.applyInheritables(n)}else n===!0||n===!1?this.parse=this.enabled=n:Yn(`Invalid options argument: ${n}`)}applyInheritables(t){let r,n;for(r of ad)n=t[r],n!==void 0&&(this[r]=n)}translateTagSet(t,r){if(this.dict){let n,a,{tagKeys:i,tagValues:o}=this.dict;for(n of t)typeof n=="string"?(a=o.indexOf(n),a===-1&&(a=i.indexOf(Number(n))),a!==-1&&r.add(Number(i[a]))):r.add(n)}else for(let n of t)r.add(n)}finalizeFilters(){!this.enabled&&this.deps.size>0?(this.enabled=!0,Pp(this.pick,this.deps)):this.enabled&&this.pick.size>0&&Pp(this.pick,this.deps)}}var za={jfif:!1,tiff:!0,xmp:!1,icc:!1,iptc:!1,ifd0:!0,ifd1:!1,exif:!0,gps:!0,interop:!1,ihdr:void 0,makerNote:!1,userComment:!1,multiSegment:!1,skip:[],pick:[],translateKeys:!0,translateValues:!0,reviveValues:!0,sanitize:!0,mergeOutput:!0,silentErrors:!0,chunked:!0,firstChunkSize:void 0,firstChunkSizeNode:512,firstChunkSizeBrowser:65536,chunkSize:65536,chunkLimit:5},Uk=new Map;let wc=class extends GP{static useCached(t){let r=Uk.get(t);return r!==void 0||(r=new this(t),Uk.set(t,r)),r}constructor(t){super(),t===!0?this.setupFromTrue():t===void 0?this.setupFromUndefined():Array.isArray(t)?this.setupFromArray(t):typeof t=="object"?this.setupFromObject(t):Yn(`Invalid options argument ${t}`),this.firstChunkSize===void 0&&(this.firstChunkSize=Xf?this.firstChunkSizeBrowser:this.firstChunkSizeNode),this.mergeOutput&&(this.ifd1.enabled=!1),this.filterNestedSegmentTags(),this.traverseTiffDependencyTree(),this.checkLoadedPlugins()}setupFromUndefined(){let t;for(t of Ys)this[t]=za[t];for(t of Js)this[t]=za[t];for(t of Zs)this[t]=za[t];for(t of qs)this[t]=new Hd(t,za[t],void 0,this)}setupFromTrue(){let t;for(t of Ys)this[t]=za[t];for(t of Js)this[t]=za[t];for(t of Zs)this[t]=!0;for(t of qs)this[t]=new Hd(t,!0,void 0,this)}setupFromArray(t){let r;for(r of Ys)this[r]=za[r];for(r of Js)this[r]=za[r];for(r of Zs)this[r]=za[r];for(r of qs)this[r]=new Hd(r,!1,void 0,this);this.setupGlobalFilters(t,void 0,Rn)}setupFromObject(t){let r;for(r of(Rn.ifd0=Rn.ifd0||Rn.image,Rn.ifd1=Rn.ifd1||Rn.thumbnail,Object.assign(this,t),Ys))this[r]=My(t[r],za[r]);for(r of Js)this[r]=My(t[r],za[r]);for(r of Zs)this[r]=My(t[r],za[r]);for(r of fc)this[r]=new Hd(r,za[r],t[r],this);for(r of Rn)this[r]=new Hd(r,za[r],t[r],this.tiff);this.setupGlobalFilters(t.pick,t.skip,Rn,qs),t.tiff===!0?this.batchEnableWithBool(Rn,!0):t.tiff===!1?this.batchEnableWithUserValue(Rn,t):Array.isArray(t.tiff)?this.setupGlobalFilters(t.tiff,void 0,Rn):typeof t.tiff=="object"&&this.setupGlobalFilters(t.tiff.pick,t.tiff.skip,Rn)}batchEnableWithBool(t,r){for(let n of t)this[n].enabled=r}batchEnableWithUserValue(t,r){for(let n of t){let a=r[n];this[n].enabled=a!==!1&&a!==void 0}}setupGlobalFilters(t,r,n,a=n){if(t&&t.length){for(let o of a)this[o].enabled=!1;let i=Gk(t,n);for(let[o,s]of i)Pp(this[o].pick,s),this[o].enabled=!0}else if(r&&r.length){let i=Gk(r,n);for(let[o,s]of i)Pp(this[o].skip,s)}}filterNestedSegmentTags(){let{ifd0:t,exif:r,xmp:n,iptc:a,icc:i}=this;this.makerNote?r.deps.add(37500):r.skip.add(37500),this.userComment?r.deps.add(37510):r.skip.add(37510),n.enabled||t.skip.add(700),a.enabled||t.skip.add(33723),i.enabled||t.skip.add(34675)}traverseTiffDependencyTree(){let{ifd0:t,exif:r,gps:n,interop:a}=this;a.needed&&(r.deps.add(40965),t.deps.add(40965)),r.needed&&t.deps.add(34665),n.needed&&t.deps.add(34853),this.tiff.enabled=Rn.some(i=>this[i].enabled===!0)||this.makerNote||this.userComment;for(let i of Rn)this[i].finalizeFilters()}get onlyTiff(){return!nd.map(t=>this[t].enabled).some(t=>t===!0)&&this.tiff.enabled}checkLoadedPlugins(){for(let t of fc)this[t].enabled&&!Hn.has(t)&&mv("segment parser",t)}};function Gk(e,t){let r,n,a,i,o=[];for(a of t){for(i of(r=ma.get(a),n=[],r))(e.includes(i[0])||e.includes(i[1]))&&n.push(i[0]);n.length&&o.push([a,n])}return o}function My(e,t){return e!==void 0?e:t!==void 0?t:void 0}function Pp(e,t){for(let r of t)e.add(r)}Ft(wc,"default",za);class vl{constructor(t){Ft(this,"parsers",{}),Ft(this,"output",{}),Ft(this,"errors",[]),Ft(this,"pushToErrors",r=>this.errors.push(r)),this.options=wc.useCached(t)}async read(t){this.file=await gT(t,this.options)}setup(){if(this.fileParser)return;let{file:t}=this,r=t.getUint16(0);for(let[n,a]of Fo)if(a.canHandle(t,r))return this.fileParser=new a(this.options,this.file,this.parsers),t[n]=!0;this.file.close&&this.file.close(),Yn("Unknown file format")}async parse(){let{output:t,errors:r}=this;return this.setup(),this.options.silentErrors?(await this.executeParsers().catch(this.pushToErrors),r.push(...this.fileParser.errors)):await this.executeParsers(),this.file.close&&this.file.close(),this.options.silentErrors&&r.length>0&&(t.errors=r),jp(t)}async executeParsers(){let{output:t}=this;await this.fileParser.parse();let r=Object.values(this.parsers).map(async n=>{let a=await n.parse();n.assignToOutput(t,a)});this.options.silentErrors&&(r=r.map(n=>n.catch(this.pushToErrors))),await Promise.all(r)}async extractThumbnail(){this.setup();let{options:t,file:r}=this,n=Hn.get("tiff",t);var a;if(r.tiff?a={start:0,type:"tiff"}:r.jpeg&&(a=await this.fileParser.getOrFindSegment("tiff")),a===void 0)return;let i=await this.fileParser.ensureSegmentChunk(a),o=this.parsers.tiff=new n(i,t,r),s=await o.extractThumbnail();return r.close&&r.close(),s}}async function Qg(e,t){let r=new vl(t);return await r.read(e),r.parse()}var yT=Object.freeze({__proto__:null,parse:Qg,Exifr:vl,fileParsers:Fo,segmentParsers:Hn,fileReaders:zo,tagKeys:ma,tagValues:wo,tagRevivers:fl,createDictionary:Gn,extendDictionary:dc,fetchUrlAsArrayBuffer:cc,readBlobAsArrayBuffer:uc,chunkedProps:Ys,otherSegments:nd,segments:fc,tiffBlocks:Rn,segmentsAndBlocks:qs,tiffExtractables:Zs,inheritables:ad,allFormatters:Js,Options:wc});class em{constructor(t,r,n){Ft(this,"errors",[]),Ft(this,"ensureSegmentChunk",async a=>{let i=a.start,o=a.size||65536;if(this.file.chunked)if(this.file.available(i,o))a.chunk=this.file.subarray(i,o);else try{a.chunk=await this.file.readChunk(i,o)}catch(s){Yn(`Couldn't read segment: ${JSON.stringify(a)}. ${s.message}`)}else this.file.byteLength>i+o?a.chunk=this.file.subarray(i,o):a.size===void 0?a.chunk=this.file.subarray(i):Yn("Segment unreachable: "+JSON.stringify(a));return a.chunk}),this.extendOptions&&this.extendOptions(t),this.options=t,this.file=r,this.parsers=n}injectSegment(t,r){this.options[t].enabled&&this.createParser(t,r)}createParser(t,r){let n=new(Hn.get(t))(r,this.options,this.file);return this.parsers[t]=n}createParsers(t){for(let r of t){let{type:n,chunk:a}=r,i=this.options[n];if(i&&i.enabled){let o=this.parsers[n];o&&o.append||o||this.createParser(n,a)}}}async readSegments(t){let r=t.map(this.ensureSegmentChunk);await Promise.all(r)}}let po=class{static findPosition(t,r){let n=t.getUint16(r+2)+2,a=typeof this.headerLength=="function"?this.headerLength(t,r,n):this.headerLength,i=r+a,o=n-a;return{offset:r,length:n,headerLength:a,start:i,size:o,end:i+o}}static parse(t,r={}){return new this(t,new wc({[this.type]:r}),t).parse()}normalizeInput(t){return t instanceof li?t:new li(t)}constructor(t,r={},n){Ft(this,"errors",[]),Ft(this,"raw",new Map),Ft(this,"handleError",a=>{if(!this.options.silentErrors)throw a;this.errors.push(a.message)}),this.chunk=this.normalizeInput(t),this.file=n,this.type=this.constructor.type,this.globalOptions=this.options=r,this.localOptions=r[this.type],this.canTranslate=this.localOptions&&this.localOptions.translate}translate(){this.canTranslate&&(this.translated=this.translateBlock(this.raw,this.type))}get output(){return this.translated?this.translated:this.raw?Object.fromEntries(this.raw):void 0}translateBlock(t,r){let n=fl.get(r),a=wo.get(r),i=ma.get(r),o=this.options[r],s=o.reviveValues&&!!n,l=o.translateValues&&!!a,u=o.translateKeys&&!!i,d={};for(let[f,h]of t)s&&n.has(f)?h=n.get(f)(h):l&&a.has(f)&&(h=this.translateValue(h,a.get(f))),u&&i.has(f)&&(f=i.get(f)||f),d[f]=h;return d}translateValue(t,r){return r[t]||r.DEFAULT||t}assignToOutput(t,r){this.assignObjectToOutput(t,this.constructor.type,r)}assignObjectToOutput(t,r,n){if(this.globalOptions.mergeOutput)return Object.assign(t,n);t[r]?Object.assign(t[r],n):t[r]=n}};Ft(po,"headerLength",4),Ft(po,"type",void 0),Ft(po,"multiSegment",!1),Ft(po,"canHandle",()=>!1);function xT(e){return e===192||e===194||e===196||e===219||e===221||e===218||e===254}function vT(e){return e>=224&&e<=239}function bT(e,t,r){for(let[n,a]of Hn)if(a.canHandle(e,t,r))return n}class zk extends em{constructor(...t){super(...t),Ft(this,"appSegments",[]),Ft(this,"jpegSegments",[]),Ft(this,"unknownSegments",[])}static canHandle(t,r){return r===65496}async parse(){await this.findAppSegments(),await this.readSegments(this.appSegments),this.mergeMultiSegments(),this.createParsers(this.mergedAppSegments||this.appSegments)}setupSegmentFinderArgs(t){t===!0?(this.findAll=!0,this.wanted=new Set(Hn.keyList())):(t=t===void 0?Hn.keyList().filter(r=>this.options[r].enabled):t.filter(r=>this.options[r].enabled&&Hn.has(r)),this.findAll=!1,this.remaining=new Set(t),this.wanted=new Set(t)),this.unfinishedMultiSegment=!1}async findAppSegments(t=0,r){this.setupSegmentFinderArgs(r);let{file:n,findAll:a,wanted:i,remaining:o}=this;if(!a&&this.file.chunked&&(a=Array.from(i).some(s=>{let l=Hn.get(s),u=this.options[s];return l.multiSegment&&u.multiSegment}),a&&await this.file.readWhole()),t=this.findAppSegmentsInRange(t,n.byteLength),!this.options.onlyTiff&&n.chunked){let s=!1;for(;o.size>0&&!s&&(n.canReadNextChunk||this.unfinishedMultiSegment);){let{nextChunkOffset:l}=n,u=this.appSegments.some(d=>!this.file.available(d.offset||d.start,d.length||d.size));if(s=t>l&&!u?!await n.readNextChunk(t):!await n.readNextChunk(l),(t=this.findAppSegmentsInRange(t,n.byteLength))===void 0)return}}}findAppSegmentsInRange(t,r){r-=2;let n,a,i,o,s,l,{file:u,findAll:d,wanted:f,remaining:h,options:g}=this;for(;t<r;t++)if(u.getUint8(t)===255){if(n=u.getUint8(t+1),vT(n)){if(a=u.getUint16(t+2),i=bT(u,t,a),i&&f.has(i)&&(o=Hn.get(i),s=o.findPosition(u,t),l=g[i],s.type=i,this.appSegments.push(s),!d&&(o.multiSegment&&l.multiSegment?(this.unfinishedMultiSegment=s.chunkNumber<s.chunkCount,this.unfinishedMultiSegment||h.delete(i)):h.delete(i),h.size===0)))break;g.recordUnknownSegments&&(s=po.findPosition(u,t),s.marker=n,this.unknownSegments.push(s)),t+=a+1}else if(xT(n)){if(a=u.getUint16(t+2),n===218&&g.stopAfterSos!==!1)return;g.recordJpegSegments&&this.jpegSegments.push({offset:t,length:a,marker:n}),t+=a+1}}return t}mergeMultiSegments(){if(!this.appSegments.some(r=>r.multiSegment))return;let t=function(r,n){let a,i,o,s=new Map;for(let l=0;l<r.length;l++)a=r[l],i=a[n],s.has(i)?o=s.get(i):s.set(i,o=[]),o.push(a);return Array.from(s)}(this.appSegments,"type");this.mergedAppSegments=t.map(([r,n])=>{let a=Hn.get(r,this.options);return a.handleMultiSegments?{type:r,chunk:a.handleMultiSegments(n)}:n[0]})}getSegment(t){return this.appSegments.find(r=>r.type===t)}async getOrFindSegment(t){let r=this.getSegment(t);return r===void 0&&(await this.findAppSegments(0,[t]),r=this.getSegment(t)),r}}Ft(zk,"type","jpeg"),Fo.set("jpeg",zk);const wT=[void 0,1,1,2,4,8,1,1,2,4,8,4,8,4];class kT extends po{parseHeader(){var t=this.chunk.getUint16();t===18761?this.le=!0:t===19789&&(this.le=!1),this.chunk.le=this.le,this.headerParsed=!0}parseTags(t,r,n=new Map){let{pick:a,skip:i}=this.options[r];a=new Set(a);let o=a.size>0,s=i.size===0,l=this.chunk.getUint16(t);t+=2;for(let u=0;u<l;u++){let d=this.chunk.getUint16(t);if(o){if(a.has(d)&&(n.set(d,this.parseTag(t,d,r)),a.delete(d),a.size===0))break}else!s&&i.has(d)||n.set(d,this.parseTag(t,d,r));t+=12}return n}parseTag(t,r,n){let{chunk:a}=this,i=a.getUint16(t+2),o=a.getUint32(t+4),s=wT[i];if(s*o<=4?t+=8:t=a.getUint32(t+8),(i<1||i>13)&&Yn(`Invalid TIFF value type. block: ${n.toUpperCase()}, tag: ${r.toString(16)}, type: ${i}, offset ${t}`),t>a.byteLength&&Yn(`Invalid TIFF value offset. block: ${n.toUpperCase()}, tag: ${r.toString(16)}, type: ${i}, offset ${t} is outside of chunk size ${a.byteLength}`),i===1)return a.getUint8Array(t,o);if(i===2)return Fl(a.getString(t,o));if(i===7)return a.getUint8Array(t,o);if(o===1)return this.parseTagValue(i,t);{let l=new(function(d){switch(d){case 1:return Uint8Array;case 3:return Uint16Array;case 4:return Uint32Array;case 5:return Array;case 6:return Int8Array;case 8:return Int16Array;case 9:return Int32Array;case 10:return Array;case 11:return Float32Array;case 12:return Float64Array;default:return Array}}(i))(o),u=s;for(let d=0;d<o;d++)l[d]=this.parseTagValue(i,t),t+=u;return l}}parseTagValue(t,r){let{chunk:n}=this;switch(t){case 1:return n.getUint8(r);case 3:return n.getUint16(r);case 4:return n.getUint32(r);case 5:return n.getUint32(r)/n.getUint32(r+4);case 6:return n.getInt8(r);case 8:return n.getInt16(r);case 9:return n.getInt32(r);case 10:return n.getInt32(r)/n.getInt32(r+4);case 11:return n.getFloat(r);case 12:return n.getDouble(r);case 13:return n.getUint32(r);default:Yn(`Invalid tiff type ${t}`)}}}class Ny extends kT{static canHandle(t,r){return t.getUint8(r+1)===225&&t.getUint32(r+4)===1165519206&&t.getUint16(r+8)===0}async parse(){this.parseHeader();let{options:t}=this;return t.ifd0.enabled&&await this.parseIfd0Block(),t.exif.enabled&&await this.safeParse("parseExifBlock"),t.gps.enabled&&await this.safeParse("parseGpsBlock"),t.interop.enabled&&await this.safeParse("parseInteropBlock"),t.ifd1.enabled&&await this.safeParse("parseThumbnailBlock"),this.createOutput()}safeParse(t){let r=this[t]();return r.catch!==void 0&&(r=r.catch(this.handleError)),r}findIfd0Offset(){this.ifd0Offset===void 0&&(this.ifd0Offset=this.chunk.getUint32(4))}findIfd1Offset(){if(this.ifd1Offset===void 0){this.findIfd0Offset();let t=this.chunk.getUint16(this.ifd0Offset),r=this.ifd0Offset+2+12*t;this.ifd1Offset=this.chunk.getUint32(r)}}parseBlock(t,r){let n=new Map;return this[r]=n,this.parseTags(t,r,n),n}async parseIfd0Block(){if(this.ifd0)return;let{file:t}=this;this.findIfd0Offset(),this.ifd0Offset<8&&Yn("Malformed EXIF data"),!t.chunked&&this.ifd0Offset>t.byteLength&&Yn(`IFD0 offset points to outside of file.
this.ifd0Offset: ${this.ifd0Offset}, file.byteLength: ${t.byteLength}`),t.tiff&&await t.ensureChunk(this.ifd0Offset,pv(this.options));let r=this.parseBlock(this.ifd0Offset,"ifd0");return r.size!==0?(this.exifOffset=r.get(34665),this.interopOffset=r.get(40965),this.gpsOffset=r.get(34853),this.xmp=r.get(700),this.iptc=r.get(33723),this.icc=r.get(34675),this.options.sanitize&&(r.delete(34665),r.delete(40965),r.delete(34853),r.delete(700),r.delete(33723),r.delete(34675)),r):void 0}async parseExifBlock(){if(this.exif||(this.ifd0||await this.parseIfd0Block(),this.exifOffset===void 0))return;this.file.tiff&&await this.file.ensureChunk(this.exifOffset,pv(this.options));let t=this.parseBlock(this.exifOffset,"exif");return this.interopOffset||(this.interopOffset=t.get(40965)),this.makerNote=t.get(37500),this.userComment=t.get(37510),this.options.sanitize&&(t.delete(40965),t.delete(37500),t.delete(37510)),this.unpack(t,41728),this.unpack(t,41729),t}unpack(t,r){let n=t.get(r);n&&n.length===1&&t.set(r,n[0])}async parseGpsBlock(){if(this.gps||(this.ifd0||await this.parseIfd0Block(),this.gpsOffset===void 0))return;let t=this.parseBlock(this.gpsOffset,"gps");return t&&t.has(2)&&t.has(4)&&(t.set("latitude",Wk(...t.get(2),t.get(1))),t.set("longitude",Wk(...t.get(4),t.get(3)))),t}async parseInteropBlock(){if(!this.interop&&(this.ifd0||await this.parseIfd0Block(),this.interopOffset!==void 0||this.exif||await this.parseExifBlock(),this.interopOffset!==void 0))return this.parseBlock(this.interopOffset,"interop")}async parseThumbnailBlock(t=!1){if(!this.ifd1&&!this.ifd1Parsed&&(!this.options.mergeOutput||t))return this.findIfd1Offset(),this.ifd1Offset>0&&(this.parseBlock(this.ifd1Offset,"ifd1"),this.ifd1Parsed=!0),this.ifd1}async extractThumbnail(){if(this.headerParsed||this.parseHeader(),this.ifd1Parsed||await this.parseThumbnailBlock(!0),this.ifd1===void 0)return;let t=this.ifd1.get(513),r=this.ifd1.get(514);return this.chunk.getUint8Array(t,r)}get image(){return this.ifd0}get thumbnail(){return this.ifd1}createOutput(){let t,r,n,a={};for(r of Rn)if(t=this[r],!FP(t))if(n=this.canTranslate?this.translateBlock(t,r):Object.fromEntries(t),this.options.mergeOutput){if(r==="ifd1")continue;Object.assign(a,n)}else a[r]=n;return this.makerNote&&(a.makerNote=this.makerNote),this.userComment&&(a.userComment=this.userComment),a}assignToOutput(t,r){if(this.globalOptions.mergeOutput)Object.assign(t,r);else for(let[n,a]of Object.entries(r))this.assignObjectToOutput(t,n,a)}}function Wk(e,t,r,n){var a=e+t/60+r/3600;return n!=="S"&&n!=="W"||(a*=-1),a}Ft(Ny,"type","tiff"),Ft(Ny,"headerLength",10),Hn.set("tiff",Ny);var ST=Object.freeze({__proto__:null,default:yT,Exifr:vl,fileParsers:Fo,segmentParsers:Hn,fileReaders:zo,tagKeys:ma,tagValues:wo,tagRevivers:fl,createDictionary:Gn,extendDictionary:dc,fetchUrlAsArrayBuffer:cc,readBlobAsArrayBuffer:uc,chunkedProps:Ys,otherSegments:nd,segments:fc,tiffBlocks:Rn,segmentsAndBlocks:qs,tiffExtractables:Zs,inheritables:ad,allFormatters:Js,Options:wc,parse:Qg});const Jb={ifd0:!1,ifd1:!1,exif:!1,gps:!1,interop:!1,sanitize:!1,reviveValues:!0,translateKeys:!1,translateValues:!1,mergeOutput:!1},Qb=Object.assign({},Jb,{firstChunkSize:4e4,gps:[1,2,3,4]});async function zP(e){let t=new vl(Qb);await t.read(e);let r=await t.parse();if(r&&r.gps){let{latitude:n,longitude:a}=r.gps;return{latitude:n,longitude:a}}}const e2=Object.assign({},Jb,{tiff:!1,ifd1:!0,mergeOutput:!1});async function WP(e){let t=new vl(e2);await t.read(e);let r=await t.extractThumbnail();return r&&Jg?Zg.from(r):r}async function VP(e){let t=await this.thumbnail(e);if(t!==void 0){let r=new Blob([t]);return URL.createObjectURL(r)}}const t2=Object.assign({},Jb,{firstChunkSize:4e4,ifd0:[274]});async function r2(e){let t=new vl(t2);await t.read(e);let r=await t.parse();if(r&&r.ifd0)return r.ifd0[274]}const n2=Object.freeze({1:{dimensionSwapped:!1,scaleX:1,scaleY:1,deg:0,rad:0},2:{dimensionSwapped:!1,scaleX:-1,scaleY:1,deg:0,rad:0},3:{dimensionSwapped:!1,scaleX:1,scaleY:1,deg:180,rad:180*Math.PI/180},4:{dimensionSwapped:!1,scaleX:-1,scaleY:1,deg:180,rad:180*Math.PI/180},5:{dimensionSwapped:!0,scaleX:1,scaleY:-1,deg:90,rad:90*Math.PI/180},6:{dimensionSwapped:!0,scaleX:1,scaleY:1,deg:90,rad:90*Math.PI/180},7:{dimensionSwapped:!0,scaleX:1,scaleY:-1,deg:270,rad:270*Math.PI/180},8:{dimensionSwapped:!0,scaleX:1,scaleY:1,deg:270,rad:270*Math.PI/180}});let Ul=!0,Gl=!0;if(typeof navigator=="object"){let e=navigator.userAgent;if(e.includes("iPad")||e.includes("iPhone")){let t=e.match(/OS (\d+)_(\d+)/);if(t){let[,r,n]=t;Ul=Number(r)+.1*Number(n)<13.4,Gl=!1}}else if(e.includes("OS X 10")){let[,t]=e.match(/OS X 10[_.](\d+)/);Ul=Gl=Number(t)<15}if(e.includes("Chrome/")){let[,t]=e.match(/Chrome\/(\d+)/);Ul=Gl=Number(t)<81}else if(e.includes("Firefox/")){let[,t]=e.match(/Firefox\/(\d+)/);Ul=Gl=Number(t)<77}}async function HP(e){let t=await r2(e);return Object.assign({canvas:Ul,css:Gl},n2[t])}class _T extends li{constructor(...t){super(...t),Ft(this,"ranges",new jT),this.byteLength!==0&&this.ranges.add(0,this.byteLength)}_tryExtend(t,r,n){if(t===0&&this.byteLength===0&&n){let a=new DataView(n.buffer||n,n.byteOffset,n.byteLength);this._swapDataView(a)}else{let a=t+r;if(a>this.byteLength){let{dataView:i}=this._extend(a);this._swapDataView(i)}}}_extend(t){let r;r=Jg?Zg.allocUnsafe(t):new Uint8Array(t);let n=new DataView(r.buffer,r.byteOffset,r.byteLength);return r.set(new Uint8Array(this.buffer,this.byteOffset,this.byteLength),0),{uintView:r,dataView:n}}subarray(t,r,n=!1){return r=r||this._lengthToEnd(t),n&&this._tryExtend(t,r),this.ranges.add(t,r),super.subarray(t,r)}set(t,r,n=!1){n&&this._tryExtend(r,t.byteLength,t);let a=super.set(t,r);return this.ranges.add(r,a.byteLength),a}async ensureChunk(t,r){this.chunked&&(this.ranges.available(t,r)||await this.readChunk(t,r))}available(t,r){return this.ranges.available(t,r)}}class jT{constructor(){Ft(this,"list",[])}get length(){return this.list.length}add(t,r,n=0){let a=t+r,i=this.list.filter(o=>Vk(t,o.offset,a)||Vk(t,o.end,a));if(i.length>0){t=Math.min(t,...i.map(s=>s.offset)),a=Math.max(a,...i.map(s=>s.end)),r=a-t;let o=i.shift();o.offset=t,o.length=r,o.end=a,this.list=this.list.filter(s=>!i.includes(s))}else this.list.push({offset:t,length:r,end:a})}available(t,r){let n=t+r;return this.list.some(a=>a.offset<=t&&n<=a.end)}}function Vk(e,t,r){return e<=t&&t<=r}class tm extends _T{constructor(t,r){super(0),Ft(this,"chunksRead",0),this.input=t,this.options=r}async readWhole(){this.chunked=!1,await this.readChunk(this.nextChunkOffset)}async readChunked(){this.chunked=!0,await this.readChunk(0,this.options.firstChunkSize)}async readNextChunk(t=this.nextChunkOffset){if(this.fullyRead)return this.chunksRead++,!1;let r=this.options.chunkSize,n=await this.readChunk(t,r);return!!n&&n.byteLength===r}async readChunk(t,r){if(this.chunksRead++,(r=this.safeWrapAddress(t,r))!==0)return this._readChunk(t,r)}safeWrapAddress(t,r){return this.size!==void 0&&t+r>this.size?Math.max(0,this.size-t):r}get nextChunkOffset(){if(this.ranges.list.length!==0)return this.ranges.list[0].length}get canReadNextChunk(){return this.chunksRead<this.options.chunkLimit}get fullyRead(){return this.size!==void 0&&this.nextChunkOffset===this.size}read(){return this.options.chunked?this.readChunked():this.readWhole()}close(){}}zo.set("blob",class extends tm{async readWhole(){this.chunked=!1;let e=await uc(this.input);this._swapArrayBuffer(e)}readChunked(){return this.chunked=!0,this.size=this.input.size,super.readChunked()}async _readChunk(e,t){let r=t?e+t:void 0,n=this.input.slice(e,r),a=await uc(n);return this.set(a,e,!0)}});var PT=Object.freeze({__proto__:null,default:ST,Exifr:vl,fileParsers:Fo,segmentParsers:Hn,fileReaders:zo,tagKeys:ma,tagValues:wo,tagRevivers:fl,createDictionary:Gn,extendDictionary:dc,fetchUrlAsArrayBuffer:cc,readBlobAsArrayBuffer:uc,chunkedProps:Ys,otherSegments:nd,segments:fc,tiffBlocks:Rn,segmentsAndBlocks:qs,tiffExtractables:Zs,inheritables:ad,allFormatters:Js,Options:wc,parse:Qg,gpsOnlyOptions:Qb,gps:zP,thumbnailOnlyOptions:e2,thumbnail:WP,thumbnailUrl:VP,orientationOnlyOptions:t2,orientation:r2,rotations:n2,get rotateCanvas(){return Ul},get rotateCss(){return Gl},rotation:HP});zo.set("url",class extends tm{async readWhole(){this.chunked=!1;let e=await cc(this.input);e instanceof ArrayBuffer?this._swapArrayBuffer(e):e instanceof Uint8Array&&this._swapBuffer(e)}async _readChunk(e,t){let r=t?e+t-1:void 0,n=this.options.httpHeaders||{};(e||r)&&(n.range=`bytes=${[e,r].join("-")}`);let a=await qb(this.input,{headers:n}),i=await a.arrayBuffer(),o=i.byteLength;if(a.status!==416)return o!==t&&(this.size=e+o),this.set(i,e,!0)}});li.prototype.getUint64=function(e){let t=this.getUint32(e),r=this.getUint32(e+4);return t<1048575?t<<32|r:typeof gh!==void 0?(console.warn("Using BigInt because of type 64uint but JS can only handle 53b numbers."),gh(t)<<gh(32)|gh(r)):void Yn("Trying to read 64b value but JS can only handle 53b numbers.")};class CT extends em{parseBoxes(t=0){let r=[];for(;t<this.file.byteLength-4;){let n=this.parseBoxHead(t);if(r.push(n),n.length===0)break;t+=n.length}return r}parseSubBoxes(t){t.boxes=this.parseBoxes(t.start)}findBox(t,r){return t.boxes===void 0&&this.parseSubBoxes(t),t.boxes.find(n=>n.kind===r)}parseBoxHead(t){let r=this.file.getUint32(t),n=this.file.getString(t+4,4),a=t+8;return r===1&&(r=this.file.getUint64(t+8),a+=8),{offset:t,length:r,kind:n,start:a}}parseBoxFullHead(t){if(t.version!==void 0)return;let r=this.file.getUint32(t.start);t.version=r>>24,t.start+=4}}class XP extends CT{static canHandle(t,r){if(r!==0)return!1;let n=t.getUint16(2);if(n>50)return!1;let a=16,i=[];for(;a<n;)i.push(t.getString(a,4)),a+=4;return i.includes(this.type)}async parse(){let t=this.file.getUint32(0),r=this.parseBoxHead(t);for(;r.kind!=="meta";)t+=r.length,await this.file.ensureChunk(t,16),r=this.parseBoxHead(t);await this.file.ensureChunk(r.offset,r.length),this.parseBoxFullHead(r),this.parseSubBoxes(r),this.options.icc.enabled&&await this.findIcc(r),this.options.tiff.enabled&&await this.findExif(r)}async registerSegment(t,r,n){await this.file.ensureChunk(r,n);let a=this.file.subarray(r,n);this.createParser(t,a)}async findIcc(t){let r=this.findBox(t,"iprp");if(r===void 0)return;let n=this.findBox(r,"ipco");if(n===void 0)return;let a=this.findBox(n,"colr");a!==void 0&&await this.registerSegment("icc",a.offset+12,a.length)}async findExif(t){let r=this.findBox(t,"iinf");if(r===void 0)return;let n=this.findBox(t,"iloc");if(n===void 0)return;let a=this.findExifLocIdInIinf(r),i=this.findExtentInIloc(n,a);if(i===void 0)return;let[o,s]=i;await this.file.ensureChunk(o,s);let l=4+this.file.getUint32(o);o+=l,s-=l,await this.registerSegment("tiff",o,s)}findExifLocIdInIinf(t){this.parseBoxFullHead(t);let r,n,a,i,o=t.start,s=this.file.getUint16(o);for(o+=2;s--;){if(r=this.parseBoxHead(o),this.parseBoxFullHead(r),n=r.start,r.version>=2&&(a=r.version===3?4:2,i=this.file.getString(n+a+2,4),i==="Exif"))return this.file.getUintBytes(n,a);o+=r.length}}get8bits(t){let r=this.file.getUint8(t);return[r>>4,15&r]}findExtentInIloc(t,r){this.parseBoxFullHead(t);let n=t.start,[a,i]=this.get8bits(n++),[o,s]=this.get8bits(n++),l=t.version===2?4:2,u=t.version===1||t.version===2?2:0,d=s+a+i,f=t.version===2?4:2,h=this.file.getUintBytes(n,f);for(n+=f;h--;){let g=this.file.getUintBytes(n,l);n+=l+u+2+o;let v=this.file.getUint16(n);if(n+=2,g===r)return v>1&&console.warn(`ILOC box has more than one extent but we're only processing one
Please create an issue at https://github.com/MikeKovarik/exifr with this file`),[this.file.getUintBytes(n+s,a),this.file.getUintBytes(n+s+a,i)];n+=v*d}}}class KP extends XP{}Ft(KP,"type","heic");class Hk extends XP{}Ft(Hk,"type","avif"),Fo.set("heic",KP),Fo.set("avif",Hk),Gn(ma,["ifd0","ifd1"],[[256,"ImageWidth"],[257,"ImageHeight"],[258,"BitsPerSample"],[259,"Compression"],[262,"PhotometricInterpretation"],[270,"ImageDescription"],[271,"Make"],[272,"Model"],[273,"StripOffsets"],[274,"Orientation"],[277,"SamplesPerPixel"],[278,"RowsPerStrip"],[279,"StripByteCounts"],[282,"XResolution"],[283,"YResolution"],[284,"PlanarConfiguration"],[296,"ResolutionUnit"],[301,"TransferFunction"],[305,"Software"],[306,"ModifyDate"],[315,"Artist"],[316,"HostComputer"],[317,"Predictor"],[318,"WhitePoint"],[319,"PrimaryChromaticities"],[513,"ThumbnailOffset"],[514,"ThumbnailLength"],[529,"YCbCrCoefficients"],[530,"YCbCrSubSampling"],[531,"YCbCrPositioning"],[532,"ReferenceBlackWhite"],[700,"ApplicationNotes"],[33432,"Copyright"],[33723,"IPTC"],[34665,"ExifIFD"],[34675,"ICC"],[34853,"GpsIFD"],[330,"SubIFD"],[40965,"InteropIFD"],[40091,"XPTitle"],[40092,"XPComment"],[40093,"XPAuthor"],[40094,"XPKeywords"],[40095,"XPSubject"]]),Gn(ma,"exif",[[33434,"ExposureTime"],[33437,"FNumber"],[34850,"ExposureProgram"],[34852,"SpectralSensitivity"],[34855,"ISO"],[34858,"TimeZoneOffset"],[34859,"SelfTimerMode"],[34864,"SensitivityType"],[34865,"StandardOutputSensitivity"],[34866,"RecommendedExposureIndex"],[34867,"ISOSpeed"],[34868,"ISOSpeedLatitudeyyy"],[34869,"ISOSpeedLatitudezzz"],[36864,"ExifVersion"],[36867,"DateTimeOriginal"],[36868,"CreateDate"],[36873,"GooglePlusUploadCode"],[36880,"OffsetTime"],[36881,"OffsetTimeOriginal"],[36882,"OffsetTimeDigitized"],[37121,"ComponentsConfiguration"],[37122,"CompressedBitsPerPixel"],[37377,"ShutterSpeedValue"],[37378,"ApertureValue"],[37379,"BrightnessValue"],[37380,"ExposureCompensation"],[37381,"MaxApertureValue"],[37382,"SubjectDistance"],[37383,"MeteringMode"],[37384,"LightSource"],[37385,"Flash"],[37386,"FocalLength"],[37393,"ImageNumber"],[37394,"SecurityClassification"],[37395,"ImageHistory"],[37396,"SubjectArea"],[37500,"MakerNote"],[37510,"UserComment"],[37520,"SubSecTime"],[37521,"SubSecTimeOriginal"],[37522,"SubSecTimeDigitized"],[37888,"AmbientTemperature"],[37889,"Humidity"],[37890,"Pressure"],[37891,"WaterDepth"],[37892,"Acceleration"],[37893,"CameraElevationAngle"],[40960,"FlashpixVersion"],[40961,"ColorSpace"],[40962,"ExifImageWidth"],[40963,"ExifImageHeight"],[40964,"RelatedSoundFile"],[41483,"FlashEnergy"],[41486,"FocalPlaneXResolution"],[41487,"FocalPlaneYResolution"],[41488,"FocalPlaneResolutionUnit"],[41492,"SubjectLocation"],[41493,"ExposureIndex"],[41495,"SensingMethod"],[41728,"FileSource"],[41729,"SceneType"],[41730,"CFAPattern"],[41985,"CustomRendered"],[41986,"ExposureMode"],[41987,"WhiteBalance"],[41988,"DigitalZoomRatio"],[41989,"FocalLengthIn35mmFormat"],[41990,"SceneCaptureType"],[41991,"GainControl"],[41992,"Contrast"],[41993,"Saturation"],[41994,"Sharpness"],[41996,"SubjectDistanceRange"],[42016,"ImageUniqueID"],[42032,"OwnerName"],[42033,"SerialNumber"],[42034,"LensInfo"],[42035,"LensMake"],[42036,"LensModel"],[42037,"LensSerialNumber"],[42080,"CompositeImage"],[42081,"CompositeImageCount"],[42082,"CompositeImageExposureTimes"],[42240,"Gamma"],[59932,"Padding"],[59933,"OffsetSchema"],[65e3,"OwnerName"],[65001,"SerialNumber"],[65002,"Lens"],[65100,"RawFile"],[65101,"Converter"],[65102,"WhiteBalance"],[65105,"Exposure"],[65106,"Shadows"],[65107,"Brightness"],[65108,"Contrast"],[65109,"Saturation"],[65110,"Sharpness"],[65111,"Smoothness"],[65112,"MoireFilter"],[40965,"InteropIFD"]]),Gn(ma,"gps",[[0,"GPSVersionID"],[1,"GPSLatitudeRef"],[2,"GPSLatitude"],[3,"GPSLongitudeRef"],[4,"GPSLongitude"],[5,"GPSAltitudeRef"],[6,"GPSAltitude"],[7,"GPSTimeStamp"],[8,"GPSSatellites"],[9,"GPSStatus"],[10,"GPSMeasureMode"],[11,"GPSDOP"],[12,"GPSSpeedRef"],[13,"GPSSpeed"],[14,"GPSTrackRef"],[15,"GPSTrack"],[16,"GPSImgDirectionRef"],[17,"GPSImgDirection"],[18,"GPSMapDatum"],[19,"GPSDestLatitudeRef"],[20,"GPSDestLatitude"],[21,"GPSDestLongitudeRef"],[22,"GPSDestLongitude"],[23,"GPSDestBearingRef"],[24,"GPSDestBearing"],[25,"GPSDestDistanceRef"],[26,"GPSDestDistance"],[27,"GPSProcessingMethod"],[28,"GPSAreaInformation"],[29,"GPSDateStamp"],[30,"GPSDifferential"],[31,"GPSHPositioningError"]]),Gn(wo,["ifd0","ifd1"],[[274,{1:"Horizontal (normal)",2:"Mirror horizontal",3:"Rotate 180",4:"Mirror vertical",5:"Mirror horizontal and rotate 270 CW",6:"Rotate 90 CW",7:"Mirror horizontal and rotate 90 CW",8:"Rotate 270 CW"}],[296,{1:"None",2:"inches",3:"cm"}]]);let wf=Gn(wo,"exif",[[34850,{0:"Not defined",1:"Manual",2:"Normal program",3:"Aperture priority",4:"Shutter priority",5:"Creative program",6:"Action program",7:"Portrait mode",8:"Landscape mode"}],[37121,{0:"-",1:"Y",2:"Cb",3:"Cr",4:"R",5:"G",6:"B"}],[37383,{0:"Unknown",1:"Average",2:"CenterWeightedAverage",3:"Spot",4:"MultiSpot",5:"Pattern",6:"Partial",255:"Other"}],[37384,{0:"Unknown",1:"Daylight",2:"Fluorescent",3:"Tungsten (incandescent light)",4:"Flash",9:"Fine weather",10:"Cloudy weather",11:"Shade",12:"Daylight fluorescent (D 5700 - 7100K)",13:"Day white fluorescent (N 4600 - 5400K)",14:"Cool white fluorescent (W 3900 - 4500K)",15:"White fluorescent (WW 3200 - 3700K)",17:"Standard light A",18:"Standard light B",19:"Standard light C",20:"D55",21:"D65",22:"D75",23:"D50",24:"ISO studio tungsten",255:"Other"}],[37385,{0:"Flash did not fire",1:"Flash fired",5:"Strobe return light not detected",7:"Strobe return light detected",9:"Flash fired, compulsory flash mode",13:"Flash fired, compulsory flash mode, return light not detected",15:"Flash fired, compulsory flash mode, return light detected",16:"Flash did not fire, compulsory flash mode",24:"Flash did not fire, auto mode",25:"Flash fired, auto mode",29:"Flash fired, auto mode, return light not detected",31:"Flash fired, auto mode, return light detected",32:"No flash function",65:"Flash fired, red-eye reduction mode",69:"Flash fired, red-eye reduction mode, return light not detected",71:"Flash fired, red-eye reduction mode, return light detected",73:"Flash fired, compulsory flash mode, red-eye reduction mode",77:"Flash fired, compulsory flash mode, red-eye reduction mode, return light not detected",79:"Flash fired, compulsory flash mode, red-eye reduction mode, return light detected",89:"Flash fired, auto mode, red-eye reduction mode",93:"Flash fired, auto mode, return light not detected, red-eye reduction mode",95:"Flash fired, auto mode, return light detected, red-eye reduction mode"}],[41495,{1:"Not defined",2:"One-chip color area sensor",3:"Two-chip color area sensor",4:"Three-chip color area sensor",5:"Color sequential area sensor",7:"Trilinear sensor",8:"Color sequential linear sensor"}],[41728,{1:"Film Scanner",2:"Reflection Print Scanner",3:"Digital Camera"}],[41729,{1:"Directly photographed"}],[41985,{0:"Normal",1:"Custom",2:"HDR (no original saved)",3:"HDR (original saved)",4:"Original (for HDR)",6:"Panorama",7:"Portrait HDR",8:"Portrait"}],[41986,{0:"Auto",1:"Manual",2:"Auto bracket"}],[41987,{0:"Auto",1:"Manual"}],[41990,{0:"Standard",1:"Landscape",2:"Portrait",3:"Night",4:"Other"}],[41991,{0:"None",1:"Low gain up",2:"High gain up",3:"Low gain down",4:"High gain down"}],[41996,{0:"Unknown",1:"Macro",2:"Close",3:"Distant"}],[42080,{0:"Unknown",1:"Not a Composite Image",2:"General Composite Image",3:"Composite Image Captured While Shooting"}]]);const Xk={1:"No absolute unit of measurement",2:"Inch",3:"Centimeter"};wf.set(37392,Xk),wf.set(41488,Xk);const Oy={0:"Normal",1:"Low",2:"High"};function Kk(e){return typeof e=="object"&&e.length!==void 0?e[0]:e}function Yk(e){let t=Array.from(e).slice(1);return t[1]>15&&(t=t.map(r=>String.fromCharCode(r))),t[2]!=="0"&&t[2]!==0||t.pop(),t.join(".")}function Ay(e){if(typeof e=="string"){var[t,r,n,a,i,o]=e.trim().split(/[-: ]/g).map(Number),s=new Date(t,r-1,n);return Number.isNaN(a)||Number.isNaN(i)||Number.isNaN(o)||(s.setHours(a),s.setMinutes(i),s.setSeconds(o)),Number.isNaN(+s)?e:s}}function Xd(e){if(typeof e=="string")return e;let t=[];if(e[1]===0&&e[e.length-1]===0)for(let r=0;r<e.length;r+=2)t.push(qk(e[r+1],e[r]));else for(let r=0;r<e.length;r+=2)t.push(qk(e[r],e[r+1]));return Fl(String.fromCodePoint(...t))}function qk(e,t){return e<<8|t}wf.set(41992,Oy),wf.set(41993,Oy),wf.set(41994,Oy),Gn(fl,["ifd0","ifd1"],[[50827,function(e){return typeof e!="string"?UP(e):e}],[306,Ay],[40091,Xd],[40092,Xd],[40093,Xd],[40094,Xd],[40095,Xd]]),Gn(fl,"exif",[[40960,Yk],[36864,Yk],[36867,Ay],[36868,Ay],[40962,Kk],[40963,Kk]]),Gn(fl,"gps",[[0,e=>Array.from(e).join(".")],[7,e=>Array.from(e).join(":")]]);class Ey extends po{static canHandle(t,r){return t.getUint8(r+1)===225&&t.getUint32(r+4)===1752462448&&t.getString(r+4,20)==="http://ns.adobe.com/"}static headerLength(t,r){return t.getString(r+4,34)==="http://ns.adobe.com/xmp/extension/"?79:33}static findPosition(t,r){let n=super.findPosition(t,r);return n.multiSegment=n.extended=n.headerLength===79,n.multiSegment?(n.chunkCount=t.getUint8(r+72),n.chunkNumber=t.getUint8(r+76),t.getUint8(r+77)!==0&&n.chunkNumber++):(n.chunkCount=1/0,n.chunkNumber=-1),n}static handleMultiSegments(t){return t.map(r=>r.chunk.getString()).join("")}normalizeInput(t){return typeof t=="string"?t:li.from(t).getString()}parse(t=this.chunk){if(!this.localOptions.parse)return t;t=function(i){let o={},s={};for(let l of JP)o[l]=[],s[l]=0;return i.replace(AT,(l,u,d)=>{if(u==="<"){let f=++s[d];return o[d].push(f),`${l}#${f}`}return`${l}#${o[d].pop()}`})}(t);let r=fu.findAll(t,"rdf","Description");r.length===0&&r.push(new fu("rdf","Description",void 0,t));let n,a={};for(let i of r)for(let o of i.properties)n=OT(o.ns,a),YP(o,n);return function(i){let o;for(let s in i)o=i[s]=jp(i[s]),o===void 0&&delete i[s];return jp(i)}(a)}assignToOutput(t,r){if(this.localOptions.parse)for(let[n,a]of Object.entries(r))switch(n){case"tiff":this.assignObjectToOutput(t,"ifd0",a);break;case"exif":this.assignObjectToOutput(t,"exif",a);break;case"xmlns":break;default:this.assignObjectToOutput(t,n,a)}else t.xmp=r}}Ft(Ey,"type","xmp"),Ft(Ey,"multiSegment",!0),Hn.set("xmp",Ey);class Cp{static findAll(t){return qP(t,/([a-zA-Z0-9-]+):([a-zA-Z0-9-]+)=("[^"]*"|'[^']*')/gm).map(Cp.unpackMatch)}static unpackMatch(t){let r=t[1],n=t[2],a=t[3].slice(1,-1);return a=ZP(a),new Cp(r,n,a)}constructor(t,r,n){this.ns=t,this.name=r,this.value=n}serialize(){return this.value}}class fu{static findAll(t,r,n){if(r!==void 0||n!==void 0){r=r||"[\\w\\d-]+",n=n||"[\\w\\d-]+";var a=new RegExp(`<(${r}):(${n})(#\\d+)?((\\s+?[\\w\\d-:]+=("[^"]*"|'[^']*'))*\\s*)(\\/>|>([\\s\\S]*?)<\\/\\1:\\2\\3>)`,"gm")}else a=/<([\w\d-]+):([\w\d-]+)(#\d+)?((\s+?[\w\d-:]+=("[^"]*"|'[^']*'))*\s*)(\/>|>([\s\S]*?)<\/\1:\2\3>)/gm;return qP(t,a).map(fu.unpackMatch)}static unpackMatch(t){let r=t[1],n=t[2],a=t[4],i=t[8];return new fu(r,n,a,i)}constructor(t,r,n,a){this.ns=t,this.name=r,this.attrString=n,this.innerXml=a,this.attrs=Cp.findAll(n),this.children=fu.findAll(a),this.value=this.children.length===0?ZP(a):void 0,this.properties=[...this.attrs,...this.children]}get isPrimitive(){return this.value!==void 0&&this.attrs.length===0&&this.children.length===0}get isListContainer(){return this.children.length===1&&this.children[0].isList}get isList(){let{ns:t,name:r}=this;return t==="rdf"&&(r==="Seq"||r==="Bag"||r==="Alt")}get isListItem(){return this.ns==="rdf"&&this.name==="li"}serialize(){if(this.properties.length===0&&this.value===void 0)return;if(this.isPrimitive)return this.value;if(this.isListContainer)return this.children[0].serialize();if(this.isList)return NT(this.children.map(MT));if(this.isListItem&&this.children.length===1&&this.attrs.length===0)return this.children[0].serialize();let t={};for(let r of this.properties)YP(r,t);return this.value!==void 0&&(t.value=this.value),jp(t)}}function YP(e,t){let r=e.serialize();r!==void 0&&(t[e.name]=r)}var MT=e=>e.serialize(),NT=e=>e.length===1?e[0]:e,OT=(e,t)=>t[e]?t[e]:t[e]={};function qP(e,t){let r,n=[];if(!e)return n;for(;(r=t.exec(e))!==null;)n.push(r);return n}function ZP(e){if(function(n){return n==null||n==="null"||n==="undefined"||n===""||n.trim()===""}(e))return;let t=Number(e);if(!Number.isNaN(t))return t;let r=e.toLowerCase();return r==="true"||r!=="false"&&e.trim()}const JP=["rdf:li","rdf:Seq","rdf:Bag","rdf:Alt","rdf:Description"],AT=new RegExp(`(<|\\/)(${JP.join("|")})`,"g");var QP=Object.freeze({__proto__:null,default:PT,Exifr:vl,fileParsers:Fo,segmentParsers:Hn,fileReaders:zo,tagKeys:ma,tagValues:wo,tagRevivers:fl,createDictionary:Gn,extendDictionary:dc,fetchUrlAsArrayBuffer:cc,readBlobAsArrayBuffer:uc,chunkedProps:Ys,otherSegments:nd,segments:fc,tiffBlocks:Rn,segmentsAndBlocks:qs,tiffExtractables:Zs,inheritables:ad,allFormatters:Js,Options:wc,parse:Qg,gpsOnlyOptions:Qb,gps:zP,thumbnailOnlyOptions:e2,thumbnail:WP,thumbnailUrl:VP,orientationOnlyOptions:t2,orientation:r2,rotations:n2,get rotateCanvas(){return Ul},get rotateCss(){return Gl},rotation:HP});let Zk=_p("fs",e=>e.promises);zo.set("fs",class extends tm{async readWhole(){this.chunked=!1,this.fs=await Zk;let e=await this.fs.readFile(this.input);this._swapBuffer(e)}async readChunked(){this.chunked=!0,this.fs=await Zk,await this.open(),await this.readChunk(0,this.options.firstChunkSize)}async open(){this.fh===void 0&&(this.fh=await this.fs.open(this.input,"r"),this.size=(await this.fh.stat(this.input)).size)}async _readChunk(e,t){this.fh===void 0&&await this.open(),e+t>this.size&&(t=this.size-e);var r=this.subarray(e,t,!0);return await this.fh.read(r.dataView,0,t,e),r}async close(){if(this.fh){let e=this.fh;this.fh=void 0,await e.close()}}});zo.set("base64",class extends tm{constructor(...e){super(...e),this.input=this.input.replace(/^data:([^;]+);base64,/gim,""),this.size=this.input.length/4*3,this.input.endsWith("==")?this.size-=2:this.input.endsWith("=")&&(this.size-=1)}async _readChunk(e,t){let r,n,a=this.input;e===void 0?(e=0,r=0,n=0):(r=4*Math.floor(e/3),n=e-r/4*3),t===void 0&&(t=this.size);let i=e+t,o=r+4*Math.ceil(i/3);a=a.slice(r,o);let s=Math.min(t,this.size-e);if(Jg){let l=Zg.from(a,"base64").slice(n,n+s);return this.set(l,e,!0)}{let l=this.subarray(e,s,!0),u=atob(a),d=l.toUint8();for(let f=0;f<s;f++)d[f]=u.charCodeAt(n+f);return l}}});class Jk extends em{static canHandle(t,r){return r===18761||r===19789}extendOptions(t){let{ifd0:r,xmp:n,iptc:a,icc:i}=t;n.enabled&&r.deps.add(700),a.enabled&&r.deps.add(33723),i.enabled&&r.deps.add(34675),r.finalizeFilters()}async parse(){let{tiff:t,xmp:r,iptc:n,icc:a}=this.options;if(t.enabled||r.enabled||n.enabled||a.enabled){let i=Math.max(pv(this.options),this.options.chunkSize);await this.file.ensureChunk(0,i),this.createParser("tiff",this.file),this.parsers.tiff.parseHeader(),await this.parsers.tiff.parseIfd0Block(),this.adaptTiffPropAsSegment("xmp"),this.adaptTiffPropAsSegment("iptc"),this.adaptTiffPropAsSegment("icc")}}adaptTiffPropAsSegment(t){if(this.parsers.tiff[t]){let r=this.parsers.tiff[t];this.injectSegment(t,r)}}}Ft(Jk,"type","tiff"),Fo.set("tiff",Jk);let ET=_p("zlib");const TT=["ihdr","iccp","text","itxt","exif"];class Qk extends em{constructor(...t){super(...t),Ft(this,"catchError",r=>this.errors.push(r)),Ft(this,"metaChunks",[]),Ft(this,"unknownChunks",[])}static canHandle(t,r){return r===35152&&t.getUint32(0)===2303741511&&t.getUint32(4)===218765834}async parse(){let{file:t}=this;await this.findPngChunksInRange(8,t.byteLength),await this.readSegments(this.metaChunks),this.findIhdr(),this.parseTextChunks(),await this.findExif().catch(this.catchError),await this.findXmp().catch(this.catchError),await this.findIcc().catch(this.catchError)}async findPngChunksInRange(t,r){let{file:n}=this;for(;t<r;){let a=n.getUint32(t),i=n.getUint32(t+4),o=n.getString(t+4,4).toLowerCase(),s=a+4+4+4,l={type:o,offset:t,length:s,start:t+4+4,size:a,marker:i};TT.includes(o)?this.metaChunks.push(l):this.unknownChunks.push(l),t+=s}}parseTextChunks(){let t=this.metaChunks.filter(r=>r.type==="text");for(let r of t){let[n,a]=this.file.getString(r.start,r.size).split("\0");this.injectKeyValToIhdr(n,a)}}injectKeyValToIhdr(t,r){let n=this.parsers.ihdr;n&&n.raw.set(t,r)}findIhdr(){let t=this.metaChunks.find(r=>r.type==="ihdr");t&&this.options.ihdr.enabled!==!1&&this.createParser("ihdr",t.chunk)}async findExif(){let t=this.metaChunks.find(r=>r.type==="exif");t&&this.injectSegment("tiff",t.chunk)}async findXmp(){let t=this.metaChunks.filter(r=>r.type==="itxt");for(let r of t)r.chunk.getString(0,17)==="XML:com.adobe.xmp"&&this.injectSegment("xmp",r.chunk)}async findIcc(){let t=this.metaChunks.find(s=>s.type==="iccp");if(!t)return;let{chunk:r}=t,n=r.getUint8Array(0,81),a=0;for(;a<80&&n[a]!==0;)a++;let i=a+2,o=r.getString(0,a);if(this.injectKeyValToIhdr("ProfileName",o),Sp){let s=await ET,l=r.getUint8Array(i);l=s.inflateSync(l),this.injectSegment("icc",l)}}}Ft(Qk,"type","png"),Fo.set("png",Qk),Gn(ma,"interop",[[1,"InteropIndex"],[2,"InteropVersion"],[4096,"RelatedImageFileFormat"],[4097,"RelatedImageWidth"],[4098,"RelatedImageHeight"]]),dc(ma,"ifd0",[[11,"ProcessingSoftware"],[254,"SubfileType"],[255,"OldSubfileType"],[263,"Thresholding"],[264,"CellWidth"],[265,"CellLength"],[266,"FillOrder"],[269,"DocumentName"],[280,"MinSampleValue"],[281,"MaxSampleValue"],[285,"PageName"],[286,"XPosition"],[287,"YPosition"],[290,"GrayResponseUnit"],[297,"PageNumber"],[321,"HalftoneHints"],[322,"TileWidth"],[323,"TileLength"],[332,"InkSet"],[337,"TargetPrinter"],[18246,"Rating"],[18249,"RatingPercent"],[33550,"PixelScale"],[34264,"ModelTransform"],[34377,"PhotoshopSettings"],[50706,"DNGVersion"],[50707,"DNGBackwardVersion"],[50708,"UniqueCameraModel"],[50709,"LocalizedCameraModel"],[50736,"DNGLensInfo"],[50739,"ShadowScale"],[50740,"DNGPrivateData"],[33920,"IntergraphMatrix"],[33922,"ModelTiePoint"],[34118,"SEMInfo"],[34735,"GeoTiffDirectory"],[34736,"GeoTiffDoubleParams"],[34737,"GeoTiffAsciiParams"],[50341,"PrintIM"],[50721,"ColorMatrix1"],[50722,"ColorMatrix2"],[50723,"CameraCalibration1"],[50724,"CameraCalibration2"],[50725,"ReductionMatrix1"],[50726,"ReductionMatrix2"],[50727,"AnalogBalance"],[50728,"AsShotNeutral"],[50729,"AsShotWhiteXY"],[50730,"BaselineExposure"],[50731,"BaselineNoise"],[50732,"BaselineSharpness"],[50734,"LinearResponseLimit"],[50735,"CameraSerialNumber"],[50741,"MakerNoteSafety"],[50778,"CalibrationIlluminant1"],[50779,"CalibrationIlluminant2"],[50781,"RawDataUniqueID"],[50827,"OriginalRawFileName"],[50828,"OriginalRawFileData"],[50831,"AsShotICCProfile"],[50832,"AsShotPreProfileMatrix"],[50833,"CurrentICCProfile"],[50834,"CurrentPreProfileMatrix"],[50879,"ColorimetricReference"],[50885,"SRawType"],[50898,"PanasonicTitle"],[50899,"PanasonicTitle2"],[50931,"CameraCalibrationSig"],[50932,"ProfileCalibrationSig"],[50933,"ProfileIFD"],[50934,"AsShotProfileName"],[50936,"ProfileName"],[50937,"ProfileHueSatMapDims"],[50938,"ProfileHueSatMapData1"],[50939,"ProfileHueSatMapData2"],[50940,"ProfileToneCurve"],[50941,"ProfileEmbedPolicy"],[50942,"ProfileCopyright"],[50964,"ForwardMatrix1"],[50965,"ForwardMatrix2"],[50966,"PreviewApplicationName"],[50967,"PreviewApplicationVersion"],[50968,"PreviewSettingsName"],[50969,"PreviewSettingsDigest"],[50970,"PreviewColorSpace"],[50971,"PreviewDateTime"],[50972,"RawImageDigest"],[50973,"OriginalRawFileDigest"],[50981,"ProfileLookTableDims"],[50982,"ProfileLookTableData"],[51043,"TimeCodes"],[51044,"FrameRate"],[51058,"TStop"],[51081,"ReelName"],[51089,"OriginalDefaultFinalSize"],[51090,"OriginalBestQualitySize"],[51091,"OriginalDefaultCropSize"],[51105,"CameraLabel"],[51107,"ProfileHueSatMapEncoding"],[51108,"ProfileLookTableEncoding"],[51109,"BaselineExposureOffset"],[51110,"DefaultBlackRender"],[51111,"NewRawImageDigest"],[51112,"RawToPreviewGain"]]);let eS=[[273,"StripOffsets"],[279,"StripByteCounts"],[288,"FreeOffsets"],[289,"FreeByteCounts"],[291,"GrayResponseCurve"],[292,"T4Options"],[293,"T6Options"],[300,"ColorResponseUnit"],[320,"ColorMap"],[324,"TileOffsets"],[325,"TileByteCounts"],[326,"BadFaxLines"],[327,"CleanFaxData"],[328,"ConsecutiveBadFaxLines"],[330,"SubIFD"],[333,"InkNames"],[334,"NumberofInks"],[336,"DotRange"],[338,"ExtraSamples"],[339,"SampleFormat"],[340,"SMinSampleValue"],[341,"SMaxSampleValue"],[342,"TransferRange"],[343,"ClipPath"],[344,"XClipPathUnits"],[345,"YClipPathUnits"],[346,"Indexed"],[347,"JPEGTables"],[351,"OPIProxy"],[400,"GlobalParametersIFD"],[401,"ProfileType"],[402,"FaxProfile"],[403,"CodingMethods"],[404,"VersionYear"],[405,"ModeNumber"],[433,"Decode"],[434,"DefaultImageColor"],[435,"T82Options"],[437,"JPEGTables"],[512,"JPEGProc"],[515,"JPEGRestartInterval"],[517,"JPEGLosslessPredictors"],[518,"JPEGPointTransforms"],[519,"JPEGQTables"],[520,"JPEGDCTables"],[521,"JPEGACTables"],[559,"StripRowCounts"],[999,"USPTOMiscellaneous"],[18247,"XP_DIP_XML"],[18248,"StitchInfo"],[28672,"SonyRawFileType"],[28688,"SonyToneCurve"],[28721,"VignettingCorrection"],[28722,"VignettingCorrParams"],[28724,"ChromaticAberrationCorrection"],[28725,"ChromaticAberrationCorrParams"],[28726,"DistortionCorrection"],[28727,"DistortionCorrParams"],[29895,"SonyCropTopLeft"],[29896,"SonyCropSize"],[32781,"ImageID"],[32931,"WangTag1"],[32932,"WangAnnotation"],[32933,"WangTag3"],[32934,"WangTag4"],[32953,"ImageReferencePoints"],[32954,"RegionXformTackPoint"],[32955,"WarpQuadrilateral"],[32956,"AffineTransformMat"],[32995,"Matteing"],[32996,"DataType"],[32997,"ImageDepth"],[32998,"TileDepth"],[33300,"ImageFullWidth"],[33301,"ImageFullHeight"],[33302,"TextureFormat"],[33303,"WrapModes"],[33304,"FovCot"],[33305,"MatrixWorldToScreen"],[33306,"MatrixWorldToCamera"],[33405,"Model2"],[33421,"CFARepeatPatternDim"],[33422,"CFAPattern2"],[33423,"BatteryLevel"],[33424,"KodakIFD"],[33445,"MDFileTag"],[33446,"MDScalePixel"],[33447,"MDColorTable"],[33448,"MDLabName"],[33449,"MDSampleInfo"],[33450,"MDPrepDate"],[33451,"MDPrepTime"],[33452,"MDFileUnits"],[33589,"AdventScale"],[33590,"AdventRevision"],[33628,"UIC1Tag"],[33629,"UIC2Tag"],[33630,"UIC3Tag"],[33631,"UIC4Tag"],[33918,"IntergraphPacketData"],[33919,"IntergraphFlagRegisters"],[33921,"INGRReserved"],[34016,"Site"],[34017,"ColorSequence"],[34018,"IT8Header"],[34019,"RasterPadding"],[34020,"BitsPerRunLength"],[34021,"BitsPerExtendedRunLength"],[34022,"ColorTable"],[34023,"ImageColorIndicator"],[34024,"BackgroundColorIndicator"],[34025,"ImageColorValue"],[34026,"BackgroundColorValue"],[34027,"PixelIntensityRange"],[34028,"TransparencyIndicator"],[34029,"ColorCharacterization"],[34030,"HCUsage"],[34031,"TrapIndicator"],[34032,"CMYKEquivalent"],[34152,"AFCP_IPTC"],[34232,"PixelMagicJBIGOptions"],[34263,"JPLCartoIFD"],[34306,"WB_GRGBLevels"],[34310,"LeafData"],[34687,"TIFF_FXExtensions"],[34688,"MultiProfiles"],[34689,"SharedData"],[34690,"T88Options"],[34732,"ImageLayer"],[34750,"JBIGOptions"],[34856,"Opto-ElectricConvFactor"],[34857,"Interlace"],[34908,"FaxRecvParams"],[34909,"FaxSubAddress"],[34910,"FaxRecvTime"],[34929,"FedexEDR"],[34954,"LeafSubIFD"],[37387,"FlashEnergy"],[37388,"SpatialFrequencyResponse"],[37389,"Noise"],[37390,"FocalPlaneXResolution"],[37391,"FocalPlaneYResolution"],[37392,"FocalPlaneResolutionUnit"],[37397,"ExposureIndex"],[37398,"TIFF-EPStandardID"],[37399,"SensingMethod"],[37434,"CIP3DataFile"],[37435,"CIP3Sheet"],[37436,"CIP3Side"],[37439,"StoNits"],[37679,"MSDocumentText"],[37680,"MSPropertySetStorage"],[37681,"MSDocumentTextPosition"],[37724,"ImageSourceData"],[40965,"InteropIFD"],[40976,"SamsungRawPointersOffset"],[40977,"SamsungRawPointersLength"],[41217,"SamsungRawByteOrder"],[41218,"SamsungRawUnknown"],[41484,"SpatialFrequencyResponse"],[41485,"Noise"],[41489,"ImageNumber"],[41490,"SecurityClassification"],[41491,"ImageHistory"],[41494,"TIFF-EPStandardID"],[41995,"DeviceSettingDescription"],[42112,"GDALMetadata"],[42113,"GDALNoData"],[44992,"ExpandSoftware"],[44993,"ExpandLens"],[44994,"ExpandFilm"],[44995,"ExpandFilterLens"],[44996,"ExpandScanner"],[44997,"ExpandFlashLamp"],[46275,"HasselbladRawImage"],[48129,"PixelFormat"],[48130,"Transformation"],[48131,"Uncompressed"],[48132,"ImageType"],[48256,"ImageWidth"],[48257,"ImageHeight"],[48258,"WidthResolution"],[48259,"HeightResolution"],[48320,"ImageOffset"],[48321,"ImageByteCount"],[48322,"AlphaOffset"],[48323,"AlphaByteCount"],[48324,"ImageDataDiscard"],[48325,"AlphaDataDiscard"],[50215,"OceScanjobDesc"],[50216,"OceApplicationSelector"],[50217,"OceIDNumber"],[50218,"OceImageLogic"],[50255,"Annotations"],[50459,"HasselbladExif"],[50547,"OriginalFileName"],[50560,"USPTOOriginalContentType"],[50656,"CR2CFAPattern"],[50710,"CFAPlaneColor"],[50711,"CFALayout"],[50712,"LinearizationTable"],[50713,"BlackLevelRepeatDim"],[50714,"BlackLevel"],[50715,"BlackLevelDeltaH"],[50716,"BlackLevelDeltaV"],[50717,"WhiteLevel"],[50718,"DefaultScale"],[50719,"DefaultCropOrigin"],[50720,"DefaultCropSize"],[50733,"BayerGreenSplit"],[50737,"ChromaBlurRadius"],[50738,"AntiAliasStrength"],[50752,"RawImageSegmentation"],[50780,"BestQualityScale"],[50784,"AliasLayerMetadata"],[50829,"ActiveArea"],[50830,"MaskedAreas"],[50935,"NoiseReductionApplied"],[50974,"SubTileBlockSize"],[50975,"RowInterleaveFactor"],[51008,"OpcodeList1"],[51009,"OpcodeList2"],[51022,"OpcodeList3"],[51041,"NoiseProfile"],[51114,"CacheVersion"],[51125,"DefaultUserCrop"],[51157,"NikonNEFInfo"],[65024,"KdcIFD"]];dc(ma,"ifd0",eS),dc(ma,"exif",eS),Gn(wo,"gps",[[23,{M:"Magnetic North",T:"True North"}],[25,{K:"Kilometers",M:"Miles",N:"Nautical Miles"}]]);class Ty extends po{static canHandle(t,r){return t.getUint8(r+1)===224&&t.getUint32(r+4)===1246120262&&t.getUint8(r+8)===0}parse(){return this.parseTags(),this.translate(),this.output}parseTags(){this.raw=new Map([[0,this.chunk.getUint16(0)],[2,this.chunk.getUint8(2)],[3,this.chunk.getUint16(3)],[5,this.chunk.getUint16(5)],[7,this.chunk.getUint8(7)],[8,this.chunk.getUint8(8)]])}}Ft(Ty,"type","jfif"),Ft(Ty,"headerLength",9),Hn.set("jfif",Ty),Gn(ma,"jfif",[[0,"JFIFVersion"],[2,"ResolutionUnit"],[3,"XResolution"],[5,"YResolution"],[7,"ThumbnailWidth"],[8,"ThumbnailHeight"]]);class tS extends po{parse(){return this.parseTags(),this.translate(),this.output}parseTags(){this.raw=new Map([[0,this.chunk.getUint32(0)],[4,this.chunk.getUint32(4)],[8,this.chunk.getUint8(8)],[9,this.chunk.getUint8(9)],[10,this.chunk.getUint8(10)],[11,this.chunk.getUint8(11)],[12,this.chunk.getUint8(12)],...Array.from(this.raw)])}}Ft(tS,"type","ihdr"),Hn.set("ihdr",tS),Gn(ma,"ihdr",[[0,"ImageWidth"],[4,"ImageHeight"],[8,"BitDepth"],[9,"ColorType"],[10,"Compression"],[11,"Filter"],[12,"Interlace"]]),Gn(wo,"ihdr",[[9,{0:"Grayscale",2:"RGB",3:"Palette",4:"Grayscale with Alpha",6:"RGB with Alpha",DEFAULT:"Unknown"}],[10,{0:"Deflate/Inflate",DEFAULT:"Unknown"}],[11,{0:"Adaptive",DEFAULT:"Unknown"}],[12,{0:"Noninterlaced",1:"Adam7 Interlace",DEFAULT:"Unknown"}]]);class Zh extends po{static canHandle(t,r){return t.getUint8(r+1)===226&&t.getUint32(r+4)===1229144927}static findPosition(t,r){let n=super.findPosition(t,r);return n.chunkNumber=t.getUint8(r+16),n.chunkCount=t.getUint8(r+17),n.multiSegment=n.chunkCount>1,n}static handleMultiSegments(t){return function(r){let n=function(a){let i=a[0].constructor,o=0;for(let u of a)o+=u.length;let s=new i(o),l=0;for(let u of a)s.set(u,l),l+=u.length;return s}(r.map(a=>a.chunk.toUint8()));return new li(n)}(t)}parse(){return this.raw=new Map,this.parseHeader(),this.parseTags(),this.translate(),this.output}parseHeader(){let{raw:t}=this;this.chunk.byteLength<84&&Yn("ICC header is too short");for(let[r,n]of Object.entries(IT)){r=parseInt(r,10);let a=n(this.chunk,r);a!=="\0\0\0\0"&&t.set(r,a)}}parseTags(){let t,r,n,a,i,{raw:o}=this,s=this.chunk.getUint32(128),l=132,u=this.chunk.byteLength;for(;s--;){if(t=this.chunk.getString(l,4),r=this.chunk.getUint32(l+4),n=this.chunk.getUint32(l+8),a=this.chunk.getString(r,4),r+n>u)return void console.warn("reached the end of the first ICC chunk. Enable options.tiff.multiSegment to read all ICC segments.");i=this.parseTag(a,r,n),i!==void 0&&i!=="\0\0\0\0"&&o.set(t,i),l+=12}}parseTag(t,r,n){switch(t){case"desc":return this.parseDesc(r);case"mluc":return this.parseMluc(r);case"text":return this.parseText(r,n);case"sig ":return this.parseSig(r)}if(!(r+n>this.chunk.byteLength))return this.chunk.getUint8Array(r,n)}parseDesc(t){let r=this.chunk.getUint32(t+8)-1;return Fl(this.chunk.getString(t+12,r))}parseText(t,r){return Fl(this.chunk.getString(t+8,r-8))}parseSig(t){return Fl(this.chunk.getString(t+8,4))}parseMluc(t){let{chunk:r}=this,n=r.getUint32(t+8),a=r.getUint32(t+12),i=t+16,o=[];for(let s=0;s<n;s++){let l=r.getString(i+0,2),u=r.getString(i+2,2),d=r.getUint32(i+4),f=r.getUint32(i+8)+t,h=Fl(r.getUnicodeString(f,d));o.push({lang:l,country:u,text:h}),i+=a}return n===1?o[0].text:o}translateValue(t,r){return typeof t=="string"?r[t]||r[t.toLowerCase()]||t:r[t]||t}}Ft(Zh,"type","icc"),Ft(Zh,"multiSegment",!0),Ft(Zh,"headerLength",18);const IT={4:Yo,8:function(e,t){return[e.getUint8(t),e.getUint8(t+1)>>4,e.getUint8(t+1)%16].map(r=>r.toString(10)).join(".")},12:Yo,16:Yo,20:Yo,24:function(e,t){const r=e.getUint16(t),n=e.getUint16(t+2)-1,a=e.getUint16(t+4),i=e.getUint16(t+6),o=e.getUint16(t+8),s=e.getUint16(t+10);return new Date(Date.UTC(r,n,a,i,o,s))},36:Yo,40:Yo,48:Yo,52:Yo,64:(e,t)=>e.getUint32(t),80:Yo};function Yo(e,t){return Fl(e.getString(t,4))}Hn.set("icc",Zh),Gn(ma,"icc",[[4,"ProfileCMMType"],[8,"ProfileVersion"],[12,"ProfileClass"],[16,"ColorSpaceData"],[20,"ProfileConnectionSpace"],[24,"ProfileDateTime"],[36,"ProfileFileSignature"],[40,"PrimaryPlatform"],[44,"CMMFlags"],[48,"DeviceManufacturer"],[52,"DeviceModel"],[56,"DeviceAttributes"],[64,"RenderingIntent"],[68,"ConnectionSpaceIlluminant"],[80,"ProfileCreator"],[84,"ProfileID"],["Header","ProfileHeader"],["MS00","WCSProfiles"],["bTRC","BlueTRC"],["bXYZ","BlueMatrixColumn"],["bfd","UCRBG"],["bkpt","MediaBlackPoint"],["calt","CalibrationDateTime"],["chad","ChromaticAdaptation"],["chrm","Chromaticity"],["ciis","ColorimetricIntentImageState"],["clot","ColorantTableOut"],["clro","ColorantOrder"],["clrt","ColorantTable"],["cprt","ProfileCopyright"],["crdi","CRDInfo"],["desc","ProfileDescription"],["devs","DeviceSettings"],["dmdd","DeviceModelDesc"],["dmnd","DeviceMfgDesc"],["dscm","ProfileDescriptionML"],["fpce","FocalPlaneColorimetryEstimates"],["gTRC","GreenTRC"],["gXYZ","GreenMatrixColumn"],["gamt","Gamut"],["kTRC","GrayTRC"],["lumi","Luminance"],["meas","Measurement"],["meta","Metadata"],["mmod","MakeAndModel"],["ncl2","NamedColor2"],["ncol","NamedColor"],["ndin","NativeDisplayInfo"],["pre0","Preview0"],["pre1","Preview1"],["pre2","Preview2"],["ps2i","PS2RenderingIntent"],["ps2s","PostScript2CSA"],["psd0","PostScript2CRD0"],["psd1","PostScript2CRD1"],["psd2","PostScript2CRD2"],["psd3","PostScript2CRD3"],["pseq","ProfileSequenceDesc"],["psid","ProfileSequenceIdentifier"],["psvm","PS2CRDVMSize"],["rTRC","RedTRC"],["rXYZ","RedMatrixColumn"],["resp","OutputResponse"],["rhoc","ReflectionHardcopyOrigColorimetry"],["rig0","PerceptualRenderingIntentGamut"],["rig2","SaturationRenderingIntentGamut"],["rpoc","ReflectionPrintOutputColorimetry"],["sape","SceneAppearanceEstimates"],["scoe","SceneColorimetryEstimates"],["scrd","ScreeningDesc"],["scrn","Screening"],["targ","CharTarget"],["tech","Technology"],["vcgt","VideoCardGamma"],["view","ViewingConditions"],["vued","ViewingCondDesc"],["wtpt","MediaWhitePoint"]]);const mh={"4d2p":"Erdt Systems",AAMA:"Aamazing Technologies",ACER:"Acer",ACLT:"Acolyte Color Research",ACTI:"Actix Sytems",ADAR:"Adara Technology",ADBE:"Adobe",ADI:"ADI Systems",AGFA:"Agfa Graphics",ALMD:"Alps Electric",ALPS:"Alps Electric",ALWN:"Alwan Color Expertise",AMTI:"Amiable Technologies",AOC:"AOC International",APAG:"Apago",APPL:"Apple Computer",AST:"AST","AT&T":"AT&T",BAEL:"BARBIERI electronic",BRCO:"Barco NV",BRKP:"Breakpoint",BROT:"Brother",BULL:"Bull",BUS:"Bus Computer Systems","C-IT":"C-Itoh",CAMR:"Intel",CANO:"Canon",CARR:"Carroll Touch",CASI:"Casio",CBUS:"Colorbus PL",CEL:"Crossfield",CELx:"Crossfield",CGS:"CGS Publishing Technologies International",CHM:"Rochester Robotics",CIGL:"Colour Imaging Group, London",CITI:"Citizen",CL00:"Candela",CLIQ:"Color IQ",CMCO:"Chromaco",CMiX:"CHROMiX",COLO:"Colorgraphic Communications",COMP:"Compaq",COMp:"Compeq/Focus Technology",CONR:"Conrac Display Products",CORD:"Cordata Technologies",CPQ:"Compaq",CPRO:"ColorPro",CRN:"Cornerstone",CTX:"CTX International",CVIS:"ColorVision",CWC:"Fujitsu Laboratories",DARI:"Darius Technology",DATA:"Dataproducts",DCP:"Dry Creek Photo",DCRC:"Digital Contents Resource Center, Chung-Ang University",DELL:"Dell Computer",DIC:"Dainippon Ink and Chemicals",DICO:"Diconix",DIGI:"Digital","DL&C":"Digital Light & Color",DPLG:"Doppelganger",DS:"Dainippon Screen",DSOL:"DOOSOL",DUPN:"DuPont",EPSO:"Epson",ESKO:"Esko-Graphics",ETRI:"Electronics and Telecommunications Research Institute",EVER:"Everex Systems",EXAC:"ExactCODE",Eizo:"Eizo",FALC:"Falco Data Products",FF:"Fuji Photo Film",FFEI:"FujiFilm Electronic Imaging",FNRD:"Fnord Software",FORA:"Fora",FORE:"Forefront Technology",FP:"Fujitsu",FPA:"WayTech Development",FUJI:"Fujitsu",FX:"Fuji Xerox",GCC:"GCC Technologies",GGSL:"Global Graphics Software",GMB:"Gretagmacbeth",GMG:"GMG",GOLD:"GoldStar Technology",GOOG:"Google",GPRT:"Giantprint",GTMB:"Gretagmacbeth",GVC:"WayTech Development",GW2K:"Sony",HCI:"HCI",HDM:"Heidelberger Druckmaschinen",HERM:"Hermes",HITA:"Hitachi America",HP:"Hewlett-Packard",HTC:"Hitachi",HiTi:"HiTi Digital",IBM:"IBM",IDNT:"Scitex",IEC:"Hewlett-Packard",IIYA:"Iiyama North America",IKEG:"Ikegami Electronics",IMAG:"Image Systems",IMI:"Ingram Micro",INTC:"Intel",INTL:"N/A (INTL)",INTR:"Intra Electronics",IOCO:"Iocomm International Technology",IPS:"InfoPrint Solutions Company",IRIS:"Scitex",ISL:"Ichikawa Soft Laboratory",ITNL:"N/A (ITNL)",IVM:"IVM",IWAT:"Iwatsu Electric",Idnt:"Scitex",Inca:"Inca Digital Printers",Iris:"Scitex",JPEG:"Joint Photographic Experts Group",JSFT:"Jetsoft Development",JVC:"JVC Information Products",KART:"Scitex",KFC:"KFC Computek Components",KLH:"KLH Computers",KMHD:"Konica Minolta",KNCA:"Konica",KODA:"Kodak",KYOC:"Kyocera",Kart:"Scitex",LCAG:"Leica",LCCD:"Leeds Colour",LDAK:"Left Dakota",LEAD:"Leading Technology",LEXM:"Lexmark International",LINK:"Link Computer",LINO:"Linotronic",LITE:"Lite-On",Leaf:"Leaf",Lino:"Linotronic",MAGC:"Mag Computronic",MAGI:"MAG Innovision",MANN:"Mannesmann",MICN:"Micron Technology",MICR:"Microtek",MICV:"Microvitec",MINO:"Minolta",MITS:"Mitsubishi Electronics America",MITs:"Mitsuba",MNLT:"Minolta",MODG:"Modgraph",MONI:"Monitronix",MONS:"Monaco Systems",MORS:"Morse Technology",MOTI:"Motive Systems",MSFT:"Microsoft",MUTO:"MUTOH INDUSTRIES",Mits:"Mitsubishi Electric",NANA:"NANAO",NEC:"NEC",NEXP:"NexPress Solutions",NISS:"Nissei Sangyo America",NKON:"Nikon",NONE:"none",OCE:"Oce Technologies",OCEC:"OceColor",OKI:"Oki",OKID:"Okidata",OKIP:"Okidata",OLIV:"Olivetti",OLYM:"Olympus",ONYX:"Onyx Graphics",OPTI:"Optiquest",PACK:"Packard Bell",PANA:"Matsushita Electric Industrial",PANT:"Pantone",PBN:"Packard Bell",PFU:"PFU",PHIL:"Philips Consumer Electronics",PNTX:"HOYA",POne:"Phase One A/S",PREM:"Premier Computer Innovations",PRIN:"Princeton Graphic Systems",PRIP:"Princeton Publishing Labs",QLUX:"Hong Kong",QMS:"QMS",QPCD:"QPcard AB",QUAD:"QuadLaser",QUME:"Qume",RADI:"Radius",RDDx:"Integrated Color Solutions",RDG:"Roland DG",REDM:"REDMS Group",RELI:"Relisys",RGMS:"Rolf Gierling Multitools",RICO:"Ricoh",RNLD:"Edmund Ronald",ROYA:"Royal",RPC:"Ricoh Printing Systems",RTL:"Royal Information Electronics",SAMP:"Sampo",SAMS:"Samsung",SANT:"Jaime Santana Pomares",SCIT:"Scitex",SCRN:"Dainippon Screen",SDP:"Scitex",SEC:"Samsung",SEIK:"Seiko Instruments",SEIk:"Seikosha",SGUY:"ScanGuy.com",SHAR:"Sharp Laboratories",SICC:"International Color Consortium",SONY:"Sony",SPCL:"SpectraCal",STAR:"Star",STC:"Sampo Technology",Scit:"Scitex",Sdp:"Scitex",Sony:"Sony",TALO:"Talon Technology",TAND:"Tandy",TATU:"Tatung",TAXA:"TAXAN America",TDS:"Tokyo Denshi Sekei",TECO:"TECO Information Systems",TEGR:"Tegra",TEKT:"Tektronix",TI:"Texas Instruments",TMKR:"TypeMaker",TOSB:"Toshiba",TOSH:"Toshiba",TOTK:"TOTOKU ELECTRIC",TRIU:"Triumph",TSBT:"Toshiba",TTX:"TTX Computer Products",TVM:"TVM Professional Monitor",TW:"TW Casper",ULSX:"Ulead Systems",UNIS:"Unisys",UTZF:"Utz Fehlau & Sohn",VARI:"Varityper",VIEW:"Viewsonic",VISL:"Visual communication",VIVO:"Vivo Mobile Communication",WANG:"Wang",WLBR:"Wilbur Imaging",WTG2:"Ware To Go",WYSE:"WYSE Technology",XERX:"Xerox",XRIT:"X-Rite",ZRAN:"Zoran",Zebr:"Zebra Technologies",appl:"Apple Computer",bICC:"basICColor",berg:"bergdesign",ceyd:"Integrated Color Solutions",clsp:"MacDermid ColorSpan",ds:"Dainippon Screen",dupn:"DuPont",ffei:"FujiFilm Electronic Imaging",flux:"FluxData",iris:"Scitex",kart:"Scitex",lcms:"Little CMS",lino:"Linotronic",none:"none",ob4d:"Erdt Systems",obic:"Medigraph",quby:"Qubyx Sarl",scit:"Scitex",scrn:"Dainippon Screen",sdp:"Scitex",siwi:"SIWI GRAFIKA",yxym:"YxyMaster"},rS={scnr:"Scanner",mntr:"Monitor",prtr:"Printer",link:"Device Link",abst:"Abstract",spac:"Color Space Conversion Profile",nmcl:"Named Color",cenc:"ColorEncodingSpace profile",mid:"MultiplexIdentification profile",mlnk:"MultiplexLink profile",mvis:"MultiplexVisualization profile",nkpf:"Nikon Input Device Profile (NON-STANDARD!)"};Gn(wo,"icc",[[4,mh],[12,rS],[40,Object.assign({},mh,rS)],[48,mh],[80,mh],[64,{0:"Perceptual",1:"Relative Colorimetric",2:"Saturation",3:"Absolute Colorimetric"}],["tech",{amd:"Active Matrix Display",crt:"Cathode Ray Tube Display",kpcd:"Photo CD",pmd:"Passive Matrix Display",dcam:"Digital Camera",dcpj:"Digital Cinema Projector",dmpc:"Digital Motion Picture Camera",dsub:"Dye Sublimation Printer",epho:"Electrophotographic Printer",esta:"Electrostatic Printer",flex:"Flexography",fprn:"Film Writer",fscn:"Film Scanner",grav:"Gravure",ijet:"Ink Jet Printer",imgs:"Photo Image Setter",mpfr:"Motion Picture Film Recorder",mpfs:"Motion Picture Film Scanner",offs:"Offset Lithography",pjtv:"Projection Television",rpho:"Photographic Paper Printer",rscn:"Reflective Scanner",silk:"Silkscreen",twax:"Thermal Wax Printer",vidc:"Video Camera",vidm:"Video Monitor"}]]);class yh extends po{static canHandle(t,r,n){return t.getUint8(r+1)===237&&t.getString(r+4,9)==="Photoshop"&&this.containsIptc8bim(t,r,n)!==void 0}static headerLength(t,r,n){let a,i=this.containsIptc8bim(t,r,n);if(i!==void 0)return a=t.getUint8(r+i+7),a%2!=0&&(a+=1),a===0&&(a=4),i+8+a}static containsIptc8bim(t,r,n){for(let a=0;a<n;a++)if(this.isIptcSegmentHead(t,r+a))return a}static isIptcSegmentHead(t,r){return t.getUint8(r)===56&&t.getUint32(r)===943868237&&t.getUint16(r+4)===1028}parse(){let{raw:t}=this,r=this.chunk.byteLength-1,n=!1;for(let a=0;a<r;a++)if(this.chunk.getUint8(a)===28&&this.chunk.getUint8(a+1)===2){n=!0;let i=this.chunk.getUint16(a+3),o=this.chunk.getUint8(a+2),s=this.chunk.getLatin1String(a+5,i);t.set(o,this.pluralizeValue(t.get(o),s)),a+=4+i}else if(n)break;return this.translate(),this.output}pluralizeValue(t,r){return t!==void 0?t instanceof Array?(t.push(r),t):[t,r]:r}}Ft(yh,"type","iptc"),Ft(yh,"translateValues",!1),Ft(yh,"reviveValues",!1),Hn.set("iptc",yh),Gn(ma,"iptc",[[0,"ApplicationRecordVersion"],[3,"ObjectTypeReference"],[4,"ObjectAttributeReference"],[5,"ObjectName"],[7,"EditStatus"],[8,"EditorialUpdate"],[10,"Urgency"],[12,"SubjectReference"],[15,"Category"],[20,"SupplementalCategories"],[22,"FixtureIdentifier"],[25,"Keywords"],[26,"ContentLocationCode"],[27,"ContentLocationName"],[30,"ReleaseDate"],[35,"ReleaseTime"],[37,"ExpirationDate"],[38,"ExpirationTime"],[40,"SpecialInstructions"],[42,"ActionAdvised"],[45,"ReferenceService"],[47,"ReferenceDate"],[50,"ReferenceNumber"],[55,"DateCreated"],[60,"TimeCreated"],[62,"DigitalCreationDate"],[63,"DigitalCreationTime"],[65,"OriginatingProgram"],[70,"ProgramVersion"],[75,"ObjectCycle"],[80,"Byline"],[85,"BylineTitle"],[90,"City"],[92,"Sublocation"],[95,"State"],[100,"CountryCode"],[101,"Country"],[103,"OriginalTransmissionReference"],[105,"Headline"],[110,"Credit"],[115,"Source"],[116,"CopyrightNotice"],[118,"Contact"],[120,"Caption"],[121,"LocalCaption"],[122,"Writer"],[125,"RasterizedCaption"],[130,"ImageType"],[131,"ImageOrientation"],[135,"LanguageIdentifier"],[150,"AudioType"],[151,"AudioSamplingRate"],[152,"AudioSamplingResolution"],[153,"AudioDuration"],[154,"AudioOutcue"],[184,"JobID"],[185,"MasterDocumentID"],[186,"ShortDocumentID"],[187,"UniqueDocumentID"],[188,"OwnerID"],[200,"ObjectPreviewFileFormat"],[201,"ObjectPreviewFileVersion"],[202,"ObjectPreviewData"],[221,"Prefs"],[225,"ClassifyState"],[228,"SimilarityIndex"],[230,"DocumentNotes"],[231,"DocumentHistory"],[232,"ExifCameraInfo"],[255,"CatalogSets"]]),Gn(wo,"iptc",[[10,{0:"0 (reserved)",1:"1 (most urgent)",2:"2",3:"3",4:"4",5:"5 (normal urgency)",6:"6",7:"7",8:"8 (least urgent)",9:"9 (user-defined priority)"}],[75,{a:"Morning",b:"Both Morning and Evening",p:"Evening"}],[131,{L:"Landscape",P:"Portrait",S:"Square"}]]);let Iy=null;async function bl(){if(!Iy)try{const n=(await St(()=>Promise.resolve().then(()=>doe),[])).default;if(typeof n!="function")throw new Error("JoRaw WASM import failed");const a=new URL("/assets/joraw-DraTMNgX.wasm",import.meta.url).href;Iy=n({locateFile:(i,o)=>i.endsWith("joraw.wasm")?a:o+i})}catch(r){throw console.error("Failed to load joraw.js:",r),r}const e=await Iy,t=e.LibRaw||e.JoRaw;if(!t)throw new Error("JoRaw class not found");return t}const a2=[[3.2404542,-1.5371385,-.4985314],[-.969266,1.8760108,.041556],[.0556434,-.2040259,1.0572252]],Ro=e=>e<=.0031308?12.92*e:1.055*Math.pow(e,1/2.4)-.055;async function xh(e,t=0,r=0){const n=await bl(),a=new n;try{await a.open(new Uint8Array(e));const i=a.getRawImage(),o=new Uint16Array(i.data),s=i.width,l=i.height,u=Math.floor((s-t)/6)*2,d=Math.floor((l-r)/6)*2;if(u<=0||d<=0)throw new Error("Image too small for X-Trans subsampling with current phase.");const f=new Uint16Array(u*d);for(let g=0;g<d/2;g++){const v=g*6+r;if(v+3>=l)break;const w=v*s,b=(v+3)*s,x=g*2,y=x*u,_=(x+1)*u;for(let j=0;j<u/2;j++){const S=j*6+t;if(S+1>=s)break;const k=j*2;f[y+k]=o[w+S+1],f[y+k+1]=o[w+S+0],f[_+k]=o[b+S+0],f[_+k+1]=o[b+S+1]}}return{dngBuffer:qh(u,d,f),width:u,height:d}}finally{a.delete?a.delete():a.close()}}function RT(e,t,r){const n=r.type===1?1:r.type===3?2:r.type===4?4:0;if(n===0)throw new Error(`Unsupported TIFF field type: ${r.type}`);const i=r.count*n<=4?r.valueFieldOffset:e.getUint32(r.valueFieldOffset,t),o=[];for(let s=0;s<r.count;s++){const l=i+s*n;if(l<0||l+n>e.byteLength)throw new Error("Invalid TIFF field offset");r.type===1?o.push(e.getUint8(l)):r.type===3?o.push(e.getUint16(l,t)):o.push(e.getUint32(l,t))}return o}function DT(e){const t=new DataView(e);if(t.byteLength<8)throw new Error("TIFF file too small");const r=t.getUint16(0,!1),n=r===18761;if(!n&&r!==19789)throw new Error("Invalid TIFF byte order");if(t.getUint16(2,n)!==42)throw new Error("Not a TIFF file");const i=t.getUint32(4,n);if(i<=0||i+2>t.byteLength)throw new Error("Invalid TIFF IFD offset");const o=t.getUint16(i,n),s=new Map;for(let U=0;U<o;U++){const X=i+2+U*12;if(X+12>t.byteLength)throw new Error("Corrupt TIFF IFD");const V=t.getUint16(X,n),z=t.getUint16(X+2,n),q=t.getUint32(X+4,n);s.set(V,{type:z,count:q,valueFieldOffset:X+8})}const l=(U,X=!1)=>{const V=s.get(U);if(!V){if(X)return[];throw new Error(`Missing TIFF tag ${U}`)}return RT(t,n,V)},u=l(256)[0]||0,d=l(257)[0]||0;if(u<=0||d<=0)throw new Error("Invalid TIFF dimensions");const f=l(258),h=l(277,!0)[0]||f.length||1,g=l(259,!0)[0]||1,v=l(262,!0)[0]||(h===1?1:2),w=l(273),b=l(279),x=l(278,!0)[0]||d,y=l(284,!0)[0]||1;if(g!==1)throw new Error(`Unsupported TIFF compression: ${g}`);if(y!==1)throw new Error("Only chunky TIFF (PlanarConfiguration=1) is supported");if(w.length!==b.length)throw new Error("Invalid TIFF strip metadata");const _=f.length===1?new Array(h).fill(f[0]):f;if(_.length<h)throw new Error("Invalid BitsPerSample count");const j=_[0];if(j!==8&&j!==16||_.some(U=>U!==j))throw new Error("Only 8-bit or 16-bit uniform TIFF samples are supported");const S=j/8,k=h*S,M=u*d*k;let N=new Uint8Array(M),T=0;for(let U=0;U<w.length;U++){const X=w[U],V=b[U];if(X<0||V<0||X+V>t.byteLength)throw new Error("Invalid TIFF strip bounds");const z=U*x;if(z>=d)break;const te=Math.min(x,d-z)*u*k,ie=Math.min(V,te,M-T);if(N.set(new Uint8Array(e,X,ie),T),T+=ie,T>=M)break}if(T<M)throw new Error("TIFF pixel data is incomplete");const A=U=>S===1?N[U]:n?N[U]|N[U+1]<<8:N[U]<<8|N[U+1],D=U=>j===8?U&255:U>>>8&255,$=U=>j===8?U&255:U&65535,B=new Uint8ClampedArray(u*d*4),J=new Uint16Array(u*d*3);let W=0;const I=v===0;for(let U=0;U<d;U++)for(let X=0;X<u;X++){const V=U*u+X,z=V*4;let q=A(W),te=h>=2?A(W+S):q,ie=h>=3?A(W+S*2):q;W+=k,I&&(j===8?(q=255-q,te=255-te,ie=255-ie):(q=65535-q,te=65535-te,ie=65535-ie)),B[z]=D(q),B[z+1]=D(te),B[z+2]=D(ie),B[z+3]=255;const he=V*3;J[he]=$(q),J[he+1]=$(te),J[he+2]=$(ie)}return{width:u,height:d,rgba:B,rgbData:J,whiteLevel:j===8?255:65535}}async function $T(e){const t=e.name.toLowerCase(),r=/\.tiff?$/i.test(t)||e.type==="image/tiff"||e.type==="image/x-tiff"||e.type==="image/tif"||e.type==="application/tiff";let n=0,a=0,i=new Uint16Array(0),o=255;const s=document.createElement("canvas"),l=s.getContext("2d");if(!l)throw new Error("Failed to create canvas context");try{const f=await createImageBitmap(e);n=f.width,a=f.height,s.width=n,s.height=a,l.drawImage(f,0,0),f.close&&f.close();const g=l.getImageData(0,0,n,a).data,v=n*a;i=new Uint16Array(v*3);for(let w=0;w<a;w++)for(let b=0;b<n;b++){const x=(w*n+b)*4,y=(w*n+b)*3;i[y]=g[x],i[y+1]=g[x+1],i[y+2]=g[x+2]}}catch(f){if(!r)throw f;const h=DT(await e.arrayBuffer());n=h.width,a=h.height,i=new Uint16Array(h.rgbData),o=h.whiteLevel,s.width=n,s.height=a;const g=new ImageData(new Uint8ClampedArray(h.rgba),n,a);l.putImageData(g,0,0)}const u=await new Promise(f=>s.toBlob(f,"image/png"));let d={description:"Standard image (non-RAW)"};try{const f=await QP.parse(e);f&&(d={...d,...f})}catch(f){console.warn("EXIF parsing failed for standard image",f)}return{previewBlob:u||e,analysisData:{data:i,width:n,height:a,bayerPattern:"RGGB",blackLevels:[0,0,0,0],whiteLevel:o,metadata:d,isThreePlane:!0}}}const LT=async e=>{const t=await bl(),r=new t;try{await r.open(e,{useCameraWb:!0,outputBps:8,noAutoBright:!0,userQual:3,outputColor:1});const n=await r.imageData();return new Promise((a,i)=>{const o=document.createElement("canvas");o.width=n.width,o.height=n.height;const s=o.getContext("2d");if(!s){i(new Error("Could not create canvas context"));return}const l=s.createImageData(n.width,n.height),u=n.data,d=n.width*n.height;for(let f=0;f<d;f++){const h=f*3,g=f*4;l.data[g]=u[h],l.data[g+1]=u[h+1],l.data[g+2]=u[h+2],l.data[g+3]=255}s.putImageData(l,0,0),o.toBlob(f=>{f?a(f):i(new Error("Canvas to Blob failed"))},"image/jpeg",.85)})}finally{r.delete?r.delete():r.close()}},Mp=async e=>{var n,a,i,o,s,l,u,d,f;const t=await bl(),r=new t;try{if(await r.open(e,{}),typeof r.getRawImage!="function")throw new Error("WASM mismatch");const h=r.getRawImage();let g=new Uint16Array(h.data);const v=await r.metadata(!0);let w={...v};try{const k=await QP.parse(e.buffer);k&&(w={...w,...k})}catch(k){console.warn("exifr parsing failed for RAW buffer",k)}const b=((n=v.idata)==null?void 0:n.filters)||0,x=((a=v.idata)==null?void 0:a.colors)||0,y=b===0&&x===3,_=b===9;let j=[0,0,0,0],S=!1;if(r.getBlackLevels)try{const k=r.getBlackLevels();k.dng_cblack&&k.dng_cblack.length===4&&Array.from(k.dng_cblack).some(M=>M>0)?(j=Array.from(k.dng_cblack).map(Number),S=!0):k.cblack&&k.cblack.length===4&&Array.from(k.cblack).some(M=>M>0)?(j=Array.from(k.cblack).map(Number),S=!0):typeof k.black=="number"&&k.black>0&&(j=[k.black,k.black,k.black,k.black],S=!0)}catch(k){console.warn("getBlackLevels binding failed",k)}if(!S){let k=[];if((i=v.color_data)!=null&&i.cblack_rawpy_style)k=v.color_data.cblack_rawpy_style;else if((s=(o=v.color_data)==null?void 0:o.dng_levels)!=null&&s.dng_cblack)k=v.color_data.dng_levels.dng_cblack;else if(((l=v.black_level_per_channel)==null?void 0:l.length)>=4)k=v.black_level_per_channel;else if(((u=v.cblack)==null?void 0:u.length)>=4)k=v.cblack;else if(((f=(d=v.color)==null?void 0:d.cblack)==null?void 0:f.length)>=4)k=v.color.cblack;else{const M=v.black_level||v.color_data&&v.color_data.black||0;k=[M,M,M,M]}j=[Number(k[0])||0,Number(k[1])||0,Number(k[2])||0,Number(k[3])||0]}return{data:g,width:h.width,height:h.height,bayerPattern:v.color_desc||"RGGB",blackLevels:j,whiteLevel:v.white_level||16383,metadata:w,isThreePlane:y,isXTrans:_}}finally{r.delete?r.delete():r.close()}};async function Bc(e){const t=new Uint8Array(e.slice(0)),r=new Uint8Array(e.slice(0)),[n,a]=await Promise.all([LT(t),Mp(r)]);return{previewBlob:n,analysisData:a}}async function Pu(e){const t=new Uint8Array(e);return Mp(t)}const nS=e=>(e--,e|=e>>1,e|=e>>2,e|=e>>4,e|=e>>8,e|=e>>16,e++,e);async function Ry(e,t,r,n=!0){const a=await Mp(new Uint8Array(e)),i=await Mp(new Uint8Array(t));if(a.width!==i.width||a.height!==i.height)throw new Error("Dimension Mismatch");const o=a.width,s=a.height,l=r?nS(o):o,u=r?nS(s):s,d=l*u,f=new Uint16Array(d),h=32768,g=1.41421356;for(let v=0;v<s;v++){const w=v*o,b=v*l;for(let x=0;x<o;x++){const y=a.data[w+x],_=i.data[w+x];let j=y-_;n&&(j/=g);let S=j+h;S=Math.max(0,Math.min(65535,S)),f[b+x]=Math.round(S)}}return{rawData:f,width:l,height:u,metadata:a.metadata}}function Ol(e,t,r,n,a,i,o){const s=Math.max(0,Math.floor(n)),l=Math.max(0,Math.floor(a)),u=Math.min(t,Math.ceil(n+i)),d=Math.min(r,Math.ceil(a+o)),f=[0,0,0,0],h=[0,0,0,0],g=[0,0,0,0];for(let b=l;b<d;b++){const x=b*t,y=b%2;for(let _=s;_<u;_++){const j=_%2,S=e[x+_],k=y*2+j;f[k]+=S,h[k]+=S*S,g[k]++}}const v=[0,0,0,0],w=[0,0,0,0];for(let b=0;b<4;b++)if(g[b]>0){const x=f[b]/g[b];v[b]=x;const _=h[b]/g[b]-x*x;w[b]=Math.sqrt(Math.max(0,_))}return{x:s,y:l,width:u-s,height:d-l,means:v,stdDevs:w,pixelCount:g.reduce((b,x)=>b+x,0)}}function BT(e,t,r,n,a,i=!1){const o=Math.floor(Math.max(0,r.x)),s=Math.floor(Math.max(0,r.y)),l=Math.ceil(Math.min(t,r.x+r.w)),u=e.length/t,d=Math.ceil(Math.min(u,r.y+r.h)),f=[0,0,0,0],h=[0,0,0,0];for(let W=s;W<d;W++){const I=W*t,G=W%2;for(let U=o;U<l;U++){const X=U%2,V=G*2+X,z=e[I+U],q=n[V]||0;f[V]+=Math.max(0,z-q),h[V]++}}let g=0,v=3;i&&(g=3,v=0);const w=h[g]>0?f[g]/h[g]:1,b=(f[1]+f[2])/(h[1]+h[2]||1),x=h[v]>0?f[v]/h[v]:1;if(w<1||b<1||x<1)return[1,1];const y=[[a[0],a[1],a[2]],[a[3],a[4],a[5]],[a[6],a[7],a[8]]],_=oc(y);if(!_)return console.warn("Color Matrix is not invertible, falling back to standard WB"),[b/w,b/x];const j=Hf(a2,_),S=oc(j);let k=1,M=1,N=1;if(S)k=S[0][0]+S[0][1]+S[0][2],M=S[1][0]+S[1][1]+S[1][2],N=S[2][0]+S[2][1]+S[2][2],Math.abs(M)<1e-6&&(M=1);else return console.warn("Final Matrix is not invertible"),[b/w,b/x];const T=b/w,A=b/x,D=k/M,$=N/M,B=T*D,J=A*$;return[Math.max(0,B),Math.max(0,J)]}function aS(e,t,r,n,a,i,o=0,s=0,l=!1){const u=Math.max(0,Math.floor(n.x)),d=Math.max(0,Math.floor(n.y)),f=Math.min(t,Math.ceil(n.x+n.w)),h=Math.min(r,Math.ceil(n.y+n.h));if(l&&e.length>=t*r*3){if(a<0||a>2||i<0||i>2)return{sumCov:0,sumVar1:0,sumVar2:0,n:0};const A=(X,V,z)=>e[(X*t+V)*3+z];let D=0,$=0,B=0;for(let X=d;X<h;X++)for(let V=u;V<f;V++){const z=X+o,q=V+s;z<d||z>=h||q<u||q>=f||(D+=A(X,V,a),$+=A(z,q,i),B++)}if(B<2)return{sumCov:0,sumVar1:0,sumVar2:0,n:0};const J=D/B,W=$/B;let I=0,G=0,U=0;for(let X=d;X<h;X++)for(let V=u;V<f;V++){const z=X+o,q=V+s;if(z<d||z>=h||q<u||q>=f)continue;const te=A(X,V,a),ie=A(z,q,i),he=te-J,ee=ie-W;I+=he*ee,G+=he*he,U+=ee*ee}return{sumCov:I,sumVar1:G,sumVar2:U,n:B}}const v=a>>1,w=a&1,b=(i>>1)+o,x=(i&1)+s;let y=0,_=0,j=0;for(let A=d;A<h-2;A+=2)for(let D=u;D<f-2;D+=2){const $=(A+v)*t+(D+w),B=(A+b)*t+(D+x);A+b>=r||D+x>=t||(y+=e[$],_+=e[B],j++)}if(j<2)return{sumCov:0,sumVar1:0,sumVar2:0,n:0};const S=y/j,k=_/j;let M=0,N=0,T=0;for(let A=d;A<h-2;A+=2)for(let D=u;D<f-2;D+=2){const $=(A+v)*t+(D+w),B=(A+b)*t+(D+x);if(A+b>=r||D+x>=t)continue;const J=e[$],W=e[B],I=J-S,G=W-k;M+=I*G,N+=I*I,T+=G*G}return{sumCov:M,sumVar1:N,sumVar2:T,n:j}}function FT(e){if(e.n<2)return 0;const t=Math.sqrt(e.sumVar1*e.sumVar2);return t===0?0:e.sumCov/t}function UT(e,t,r,n,a,i,o,s,l,u,d,f=!1){if(u<=l)return[];const h=Math.max(0,Math.floor(n)),g=Math.max(0,Math.floor(a)),v=Math.min(t,Math.ceil(n+i)),w=Math.min(r,Math.ceil(a+o)),b=u-l,x=d?Math.floor(b)+1:s,y=b/x,_=[new Uint32Array(x),new Uint32Array(x),new Uint32Array(x),new Uint32Array(x)];if(f&&e.length>=t*r*3)for(let k=g;k<w;k++){const M=k*t;for(let N=h;N<v;N++){const T=(M+N)*3;for(let A=0;A<3;A++){const D=e[T+A];if(D<l||D>u)continue;let $;d?$=Math.floor(D-l):$=Math.floor((D-l)/y),$<0&&($=0),$>=x&&($=x-1),_[A][$]++}}}else for(let k=g;k<w;k++){const M=k*t,N=k%2;for(let T=h;T<v;T++){const A=T%2,D=e[M+T];if(D<l||D>u)continue;const $=N*2+A;let B;d?B=Math.floor(D-l):B=Math.floor((D-l)/y),B<0&&(B=0),B>=x&&(B=x-1),_[$][B]++}}const S=[];for(let k=0;k<x;k++){const M=l+(d?k:k*y);S.push({binStart:M,c0:_[0][k],c1:_[1][k],c2:_[2][k],c3:_[3][k]})}return S}function GT(e,t,r,n,a,i=!1,o=!1,s={rows:!1,rowGroup:0,cols:!1,colGroup:0},l=!0,u=1,d=!1){const f=Math.max(0,Math.floor(n.x)),h=Math.max(0,Math.floor(n.y)),g=Math.min(t,Math.ceil(n.x+n.w)),v=Math.min(r,Math.ceil(n.y+n.h)),w=g-f,b=v-h;if(w<=1||b<=1)return null;const x=d&&e.length>=t*r*3;if(x){if(a<0||a>2)return null}else if(a<0||a>3)return null;let y=0,_=0;if(x)y=g-f,_=v-h;else{for(let B=f;B<g;B++)B%2===(a&1)&&y++;for(let B=h;B<v;B++)B%2===a>>1&&_++}if(y<4||_<4)return null;const j=Math.max(1,u),S=Math.floor(2*y/(j+1)),k=Math.floor(2*_/(j+1));if(S<4||k<4)return null;const M=new sc(S),N=new sc(k),T=new Float32Array(Math.floor(S/2)+1),A=new Float32Array(Math.floor(k/2)+1);let D=0,$=0;for(let B=h;B<v;B++){const J=B%2;if(!x&&a>>1!==J||s.rows&&(x?B&1:B>>1&1)!==s.rowGroup)continue;const W=B*t,I=new Float32Array(y);let G=0;for(let U=f;U<g;U++){if(!x&&U%2!==(a&1)||G>=y)continue;const X=x?e[(W+U)*3+a]:e[W+U],V=Number.isFinite(X)?X:0;I[G++]=V}for(let U=0;U<j;U++){const X=Math.floor(U*S/2);if(X+S>y)break;const V=I.slice(X,X+S);M.calculateSpectrum(V,T,o),D++}if(!l)break}for(let B=f;B<g;B++){const J=B%2;if(!x&&(a&1)!==J||s.cols&&(x?B&1:B>>1&1)!==s.colGroup)continue;const W=new Float32Array(_);let I=0;for(let G=h;G<v;G++){if(!x&&G%2!==a>>1||I>=_)continue;const U=x?e[(G*t+B)*3+a]:e[G*t+B],X=Number.isFinite(U)?U:0;W[I++]=X}for(let G=0;G<j;G++){const U=Math.floor(G*k/2);if(U+k>_)break;const X=W.slice(U,U+k);N.calculateSpectrum(X,A,o),$++}if(!l)break}if(D>0)for(let B=0;B<T.length;B++)T[B]/=D;if($>0)for(let B=0;B<A.length;B++)A[B]/=$;return{avgHoriz:Array.from(T),avgVert:Array.from(A),sampleCount:{h:D,v:$}}}function zT(e,t,r,n,a,i=!1,o=!1){const s=Math.max(0,Math.floor(n.x)),l=Math.max(0,Math.floor(n.y)),u=Math.min(t,Math.ceil(n.x+n.w)),d=Math.min(r,Math.ceil(n.y+n.h));if(o&&e.length>=t*r*3){if(a<0||a>2)return null;const j=u-s,S=d-l;if(j<=0||S<=0)return null;const k=new Float32Array(j*S);let M=0;for(let A=l;A<d;A++)for(let D=s;D<u;D++)k[M++]=e[(A*t+D)*3+a];const N=Ek(k,j,S,i),T=Tk(N,j,S);return{width:j,height:S,data:T}}let h=-1;for(let j=l;j<d;j++)if(j%2===a>>1){h=j;break}if(h===-1)return null;let g=-1;for(let j=s;j<u;j++)if(j%2===(a&1)){g=j;break}if(g===-1)return null;const v=[];for(let j=h;j<d;j+=2){const S=j*t,k=[];for(let M=g;M<u;M+=2)k.push(e[S+M]);v.push(k)}const w=v.length;if(w===0)return null;const b=v[0].length;if(b===0)return null;const x=new Float32Array(b*w);for(let j=0;j<w;j++){const S=v[j];for(let k=0;k<b;k++)x[j*b+k]=S[k]}const y=Ek(x,b,w,i),_=Tk(y,b,w);return{width:b,height:w,data:_}}function WT(e,t,r,n,a,i,o,s=!1){const{x:l,y:u,w:d,h:f}=n,h=[],g=Math.max(0,Math.floor(l)),v=Math.max(0,Math.floor(u)),w=Math.min(t,Math.ceil(l+d)),b=Math.min(r,Math.ceil(u+f));if(s&&e.length>=t*r*3){if(a<0||a>2)return null;for(let k=v;k<b;k++){const M=k*t;for(let N=g;N<w;N++){const T=e[(M+N)*3+a];T>=i&&T<=o&&h.push(T-i)}}}else{if(a<0||a>3)return null;const k=a>>1,M=a&1;for(let N=v;N<b;N++){if(N%2!==k)continue;const T=N*t;for(let A=g;A<w;A++){if(A%2!==M)continue;const D=e[T+A];D>=i&&D<=o&&h.push(D-i)}}}if(h.length===0)return null;h.sort((k,M)=>k-M);const y=[h[0]];for(let k=1;k<h.length;k++)h[k]!==h[k-1]&&y.push(h[k]);const _=[],j=[],S={};for(let k=0;k<y.length-1;k++){const M=y[k],T=y[k+1]-M;_.push(T),j.push({x:M,y:T}),S[T]=(S[T]||0)+1}return{uniqueCount:y.length,diffCount:_.length,stepCounts:S,plotData:j}}function i2(e,t,r){if(!r.advancedZeroDep)throw new Error("Unmixing settings not found in DisplaySettings.");const{bl:n,bg:a,fg:i}=r.advancedZeroDep,{data:o,width:s,whiteLevel:l}=e,u=a.map((_,j)=>Math.max(0,_-n[j])),d=i.map((_,j)=>Math.max(0,_-n[j])),f=(u[1]+u[3])/2,h=(d[1]+d[3])/2,g=Math.floor(t.x),v=Math.floor(t.y),w=Math.floor(t.w),b=Math.floor(t.h),x=Math.pow(2,r.exposure),y=new Uint16Array(w*b);for(let _=0;_<b;_++){const j=v+_;if(j<0||j>=e.height)continue;const S=j%2,k=j*s,M=_*w;for(let N=0;N<w;N++){const T=g+N;if(T<0||T>=s)continue;const A=T%2;let D=0;!S&&!A?D=0:!S&&A?D=1:S&&!A?D=3:D=2;const $=o[k+T],B=n[D],J=u[D],W=d[D],I=Math.max($-B,0),G=W-J||1e-9,U=(I-J)/G;let X;U<0?X=I*(f/Math.max(J,1e-9)):U>1?X=I*(h/Math.max(W,1e-9)):X=(1-U)*f+U*h,X*=x,y[M+N]=Math.max(0,Math.min(65535,Math.round(X)))}}return{data:y,width:w,height:b}}async function VT(e,t){const r=await bl(),n=new r;try{const a=new Uint8Array(e.slice(0));let i=!1,o=[];if(t.customMatrix&&t.customMatrix.length===9){const h=[[t.customMatrix[0],t.customMatrix[1],t.customMatrix[2]],[t.customMatrix[3],t.customMatrix[4],t.customMatrix[5]],[t.customMatrix[6],t.customMatrix[7],t.customMatrix[8]]],g=oc(h);if(g){const v=t.wbGains?t.wbGains[0]:1,w=t.wbGains?t.wbGains[1]:1,x=Hf(g,[[v,0,0],[0,1,0],[0,0,w]]),y=Hf(a2,x);o=[y[0][0],y[0][1],y[0][2],y[1][0],y[1][1],y[1][2],y[2][0],y[2][1],y[2][2]],i=!0}else throw new Error("Custom Matrix is not invertible.")}const s={outputBps:16,noAutoBright:!0,bright:i?1:Math.pow(2,t.exposure)};t.blackLevel&&t.blackLevel.length===4&&(s.userBlack=0,s.userCblack=t.blackLevel.map(h=>{const g=Math.round(h);return g===0?1:g})),t.demosaicMethod===-1?s.noInterpolation=!0:s.userQual=t.demosaicMethod,i?(s.outputColor=0,s.gamma=[1,1],s.userMul=[1,1,1,1],s.useCameraWb=!1):(s.outputColor=1,s.useCameraWb=!0),await n.open(a,s);const l=await n.imageData(),u=new ImageData(l.width,l.height),d=u.data,f=new Uint16Array(l.data.buffer,l.data.byteOffset,l.data.byteLength/2);if(i&&o.length===9){const h=o,v=Math.pow(2,t.exposure)*.25;for(let w=0;w<f.length;w+=3){const b=f[w]/65535,x=f[w+1]/65535,y=f[w+2]/65535;let _=h[0]*b+h[1]*x+h[2]*y,j=h[3]*b+h[4]*x+h[5]*y,S=h[6]*b+h[7]*x+h[8]*y;_*=v,j*=v,S*=v,_=Math.max(0,Math.min(1,_)),j=Math.max(0,Math.min(1,j)),S=Math.max(0,Math.min(1,S)),_=Ro(_),j=Ro(j),S=Ro(S);const k=w/3*4;d[k]=Math.round(_*255),d[k+1]=Math.round(j*255),d[k+2]=Math.round(S*255),d[k+3]=255}}else for(let h=0;h<f.length;h+=3){const g=h/3*4;d[g]=f[h]>>8,d[g+1]=f[h+1]>>8,d[g+2]=f[h+2]>>8,d[g+3]=255}return u}finally{n.delete?n.delete():n.close()}}async function Dy(e,t){const r=await bl(),n=new r;try{await n.open(new Uint8Array(e));let a=16383;try{const w=await n.metadata(!0);w&&w.white_level&&(a=w.white_level)}catch(w){console.warn("Metadata error",w)}const i=n.getRawImage(),o=i.width,s=i.height,l=i.data,u=new ImageData(o,s),d=u.data,f=t.blackLevel||[0,0,0,0],h=a,g=t.wbGains?t.wbGains[0]:1,v=t.wbGains?t.wbGains[1]:1;for(let w=0;w<s;w++){const b=w%2;for(let x=0;x<o;x++){const y=x%2,_=b*2+y,j=l[w*o+x],S=f[_];let k=(j-S)/(h-S);k=Math.max(0,Math.min(1,k)),t.exposure!==0&&(k*=Math.pow(2,t.exposure),k=Math.min(1,k)),_===0?k*=g:_===3&&(k*=v);const M=Math.round(Ro(Math.min(1,k))*255),N=(w*o+x)*4;d[N]=M,d[N+1]=M,d[N+2]=M,d[N+3]=255}}return u}finally{n.delete?n.delete():n.close()}}async function HT(e,t){const r=await bl(),n=new r;try{await n.open(new Uint8Array(e));let a=16383;try{const W=await n.metadata(!0);W&&W.white_level&&(a=W.white_level)}catch{}const i=n.getRawImage(),{width:o,height:s,data:l}=i,u=new ImageData(o,s),d=u.data,f=t.blackLevel||[0,0,0,0],h=a,g=t.wbGains?t.wbGains[0]:1,v=t.wbGains?t.wbGains[1]:1,w=Math.pow(2,t.exposure),b=!!t.isBGGR,x=t.zeroDepColorDemosaic==="edge-aware"?"edge-aware":"bilinear";let y=[[1,0,0],[0,1,0],[0,0,1]];if(t.customMatrix&&t.customMatrix.length===9){const W=[[t.customMatrix[0],t.customMatrix[1],t.customMatrix[2]],[t.customMatrix[3],t.customMatrix[4],t.customMatrix[5]],[t.customMatrix[6],t.customMatrix[7],t.customMatrix[8]]],I=oc(W);I&&(y=Hf(a2,I))}const _=y[0][0],j=y[0][1],S=y[0][2],k=y[1][0],M=y[1][1],N=y[1][2],T=y[2][0],A=y[2][1],D=y[2][2],$=new Float32Array(o*s);for(let W=0;W<o*s;W++){const I=Math.floor(W/o),G=W%o,U=I%2,X=G%2,V=U*2+X,z=l[W],q=f[V];let te=(z-q)/(h-q);te=Math.max(0,te),b?V===0?te*=v:V===3&&(te*=g):V===0?te*=g:V===3&&(te*=v),$[W]=te}const B=W=>{const I=$[W-1],G=$[W+1],U=$[W-o],X=$[W+o],V=Math.abs(I-G),z=Math.abs(U-X);return V+1e-6<z?(I+G)*.5:z+1e-6<V?(U+X)*.5:(I+G+U+X)*.25},J=W=>{const I=$[W-o-1],G=$[W+o+1],U=$[W-o+1],X=$[W+o-1],V=Math.abs(I-G),z=Math.abs(U-X);return V+1e-6<z?(I+G)*.5:z+1e-6<V?(U+X)*.5:(I+G+U+X)*.25};for(let W=1;W<s-1;W++){const I=W%2,G=W*o;for(let U=1;U<o-1;U++){const X=U%2,V=G+U;let z=0,q=0,te=0,ie=!1,he=!1,ee=!1;if(!I&&!X?b?he=!0:ie=!0:I&&X?b?ie=!0:he=!0:ee=!0,ie)z=$[V],x==="edge-aware"?(q=B(V),te=J(V)):(q=($[V-1]+$[V+1]+$[V-o]+$[V+o])*.25,te=($[V-o-1]+$[V-o+1]+$[V+o-1]+$[V+o+1])*.25);else if(he)te=$[V],x==="edge-aware"?(q=B(V),z=J(V)):(q=($[V-1]+$[V+1]+$[V-o]+$[V+o])*.25,z=($[V-o-1]+$[V-o+1]+$[V+o-1]+$[V+o+1])*.25);else{q=$[V];const Ne=($[V-1]+$[V+1])*.5,pe=($[V-o]+$[V+o])*.5;let ke=!1;!I&&X?b?ke=!1:ke=!0:b?ke=!0:ke=!1,ke?(z=Ne,te=pe):(te=Ne,z=pe)}let Le=_*z+j*q+S*te,fe=k*z+M*q+N*te,ce=T*z+A*q+D*te;Le*=w,fe*=w,ce*=w,Le=Math.max(0,Math.min(1,Le)),fe=Math.max(0,Math.min(1,fe)),ce=Math.max(0,Math.min(1,ce)),Le=Ro(Le),fe=Ro(fe),ce=Ro(ce);const de=V*4;d[de]=Math.round(Le*255),d[de+1]=Math.round(fe*255),d[de+2]=Math.round(ce*255),d[de+3]=255}}return u}finally{n.delete?n.delete():n.close()}}async function XT(e,t){const r=await bl(),n=new r;try{await n.open(new Uint8Array(e));let a=16383;try{const y=await n.metadata(!0);y&&y.white_level&&(a=y.white_level)}catch(y){console.warn("Metadata error",y)}const i=n.getRawImage(),{width:o,height:s,data:l}=i,u=new ImageData(o,s),d=u.data;if(!t.advancedZeroDep)throw new Error("Missing advanced settings");const{bl:f,bg:h,fg:g}=t.advancedZeroDep,v=h.map((y,_)=>Math.max(0,y-f[_])),w=g.map((y,_)=>Math.max(0,y-f[_])),b=(v[1]+v[3])/2,x=(w[1]+w[3])/2;for(let y=0;y<s;y++){const _=y%2;for(let j=0;j<o;j++){const S=j%2;let k=0;!_&&!S?k=0:!_&&S?k=1:_&&!S?k=3:k=2;const M=l[y*o+j],N=f[k],T=v[k],A=w[k],D=Math.max(M-N,0),$=A-T||1e-9,B=(D-T)/$;let J;B<0?J=D*(b/Math.max(T,1e-9)):B>1?J=D*(x/Math.max(A,1e-9)):J=(1-B)*b+B*x;let W=J/65535;W=Math.max(0,Math.min(1,W));const I=Math.round(Ro(W)*255),G=(y*o+j)*4;d[G]=I,d[G+1]=I,d[G+2]=I,d[G+3]=255}}return u}finally{n.delete?n.delete():n.close()}}async function eC(e,t,r=!1,n=!1){const a=await bl(),i=new a;try{if(t.renderMode==="zero-dependency"||t.renderMode==="advanced-zero-dep"){await i.open(new Uint8Array(e));const o=await i.metadata(!0),s=(o==null?void 0:o.white_level)||16383,l=i.getRawImage(),{width:u,height:d,data:f}=l,h=new Uint16Array(u*d),g=Math.pow(2,t.exposure);if(t.renderMode==="advanced-zero-dep"&&t.advancedZeroDep){const{bl:v,bg:w,fg:b}=t.advancedZeroDep,x=w.map((S,k)=>Math.max(0,S-v[k])),y=b.map((S,k)=>Math.max(0,S-v[k])),_=(x[1]+x[3])/2,j=(y[1]+y[3])/2;for(let S=0;S<d;S++){const k=S%2;for(let M=0;M<u;M++){const N=M%2;let T=0;!k&&!N?T=0:!k&&N?T=1:k&&!N?T=3:T=2;const A=f[S*u+M],D=v[T],$=x[T],B=y[T],J=Math.max(A-D,0),W=B-$||1e-9,I=(J-$)/W;let G;I<0?G=J*(_/Math.max($,1e-9)):I>1?G=J*(j/Math.max(B,1e-9)):G=(1-I)*_+I*j,G*=g;let U;if(n){const X=Math.max(0,Math.min(1,G/65535));U=Ro(X)*65535}else U=G;h[S*u+M]=Math.round(Math.max(0,Math.min(65535,U)))}}}else{const v=t.blackLevel||[0,0,0,0],w=t.wbGains?t.wbGains[0]:1,b=t.wbGains?t.wbGains[1]:1;for(let x=0;x<d;x++){const y=x%2;for(let _=0;_<u;_++){const j=_%2,S=y*2+j,k=f[x*u+_],M=v[S];let N=k-M;S===0?N*=w:S===3&&(N*=b),N*=g;const T=Math.max(0,Math.min(1,N/(r?s-M:s))),A=n?Ro(T):T;h[x*u+_]=Math.round(A*65535)}}}return{data:h,width:u,height:d,channels:1}}else{const o=new Uint8Array(e.slice(0)),s={outputBps:16,noAutoBright:!r,bright:1,outputColor:n?1:0,useCameraWb:!0};t.blackLevel&&t.blackLevel.length===4&&(s.userBlack=0,s.userCblack=t.blackLevel.map(f=>Math.max(1,Math.round(f)))),t.demosaicMethod===-1?s.noInterpolation=!0:s.userQual=t.demosaicMethod,await i.open(o,s);const l=await i.imageData(),u=new Uint16Array(l.data.buffer,l.data.byteOffset,l.data.byteLength/2),d=Math.pow(2,t.exposure);if(d!==1)for(let f=0;f<u.length;f++)u[f]=Math.max(0,Math.min(65535,Math.round(u[f]*d)));return{data:u,width:l.width,height:l.height,channels:3}}}finally{i.delete?i.delete():i.close()}}async function KT(e,t){const r={...t,renderMode:"standard",demosaicMethod:t.demosaicMethod===-1?3:t.demosaicMethod},n=await eC(e,r,!1,!1),a=n.width*n.height,i=new Float32Array(a*3);if(n.channels===3)for(let o=0;o<n.data.length;o++)i[o]=n.data[o]/65535;else for(let o=0;o<a;o++){const s=n.data[o]/65535,l=o*3;i[l]=s,i[l+1]=s,i[l+2]=s}return{data:i,width:n.width,height:n.height}}const YT=Object.assign({"../lensfun/6x6.xml":()=>St(()=>import("./6x6-Dud9lWUd.js"),[]).then(e=>e.default),"../lensfun/actioncams.xml":()=>St(()=>import("./actioncams-Cg5HQ60A.js"),[]).then(e=>e.default),"../lensfun/compact-canon.xml":()=>St(()=>import("./compact-canon-BDgHCadq.js"),[]).then(e=>e.default),"../lensfun/compact-casio.xml":()=>St(()=>import("./compact-casio-CDzufeyu.js"),[]).then(e=>e.default),"../lensfun/compact-fujifilm.xml":()=>St(()=>import("./compact-fujifilm-BuFyPBlo.js"),[]).then(e=>e.default),"../lensfun/compact-kodak.xml":()=>St(()=>import("./compact-kodak-DICTBwTD.js"),[]).then(e=>e.default),"../lensfun/compact-konica-minolta.xml":()=>St(()=>import("./compact-konica-minolta-BKI4omr1.js"),[]).then(e=>e.default),"../lensfun/compact-leica.xml":()=>St(()=>import("./compact-leica-B1Fqeeu3.js"),[]).then(e=>e.default),"../lensfun/compact-nikon.xml":()=>St(()=>import("./compact-nikon-Q231DWRs.js"),[]).then(e=>e.default),"../lensfun/compact-olympus.xml":()=>St(()=>import("./compact-olympus-BmAKd-oF.js"),[]).then(e=>e.default),"../lensfun/compact-panasonic.xml":()=>St(()=>import("./compact-panasonic-DJuEnLOf.js"),[]).then(e=>e.default),"../lensfun/compact-pentax.xml":()=>St(()=>import("./compact-pentax-CK-wShH4.js"),[]).then(e=>e.default),"../lensfun/compact-ricoh.xml":()=>St(()=>import("./compact-ricoh-DbsLlRAS.js"),[]).then(e=>e.default),"../lensfun/compact-samsung.xml":()=>St(()=>import("./compact-samsung-CBNQmwIs.js"),[]).then(e=>e.default),"../lensfun/compact-sigma.xml":()=>St(()=>import("./compact-sigma-Ce4mbNmr.js"),[]).then(e=>e.default),"../lensfun/compact-sony.xml":()=>St(()=>import("./compact-sony-aE387uCd.js"),[]).then(e=>e.default),"../lensfun/contax.xml":()=>St(()=>import("./contax-lfgVw8XE.js"),[]).then(e=>e.default),"../lensfun/generic.xml":()=>St(()=>import("./generic-CnlCoerb.js"),[]).then(e=>e.default),"../lensfun/mil-canon.xml":()=>St(()=>import("./mil-canon-CsP2d6LD.js"),[]).then(e=>e.default),"../lensfun/mil-fujifilm.xml":()=>St(()=>import("./mil-fujifilm-F3oKEIYZ.js"),[]).then(e=>e.default),"../lensfun/mil-hasselblad.xml":()=>St(()=>import("./mil-hasselblad-DeXxLlTg.js"),[]).then(e=>e.default),"../lensfun/mil-leica.xml":()=>St(()=>import("./mil-leica-Czic2o9o.js"),[]).then(e=>e.default),"../lensfun/mil-nikon.xml":()=>St(()=>import("./mil-nikon-DkZbaqBH.js"),[]).then(e=>e.default),"../lensfun/mil-olympus.xml":()=>St(()=>import("./mil-olympus-DWRA_NNZ.js"),[]).then(e=>e.default),"../lensfun/mil-panasonic.xml":()=>St(()=>import("./mil-panasonic-CsQ7Qk1h.js"),[]).then(e=>e.default),"../lensfun/mil-pentax.xml":()=>St(()=>import("./mil-pentax-ClXRigoa.js"),[]).then(e=>e.default),"../lensfun/mil-samsung.xml":()=>St(()=>import("./mil-samsung-BbQ5TjXi.js"),[]).then(e=>e.default),"../lensfun/mil-samyang.xml":()=>St(()=>import("./mil-samyang-CyxQtljS.js"),[]).then(e=>e.default),"../lensfun/mil-sigma.xml":()=>St(()=>import("./mil-sigma-C4H9prlz.js"),[]).then(e=>e.default),"../lensfun/mil-sony.xml":()=>St(()=>import("./mil-sony-D2U1LHts.js"),[]).then(e=>e.default),"../lensfun/mil-tamron.xml":()=>St(()=>import("./mil-tamron-B5g4hRYO.js"),[]).then(e=>e.default),"../lensfun/mil-tokina.xml":()=>St(()=>import("./mil-tokina-Cs1l9ZTO.js"),[]).then(e=>e.default),"../lensfun/mil-zeiss.xml":()=>St(()=>import("./mil-zeiss-avF4V-6T.js"),[]).then(e=>e.default),"../lensfun/misc.xml":()=>St(()=>import("./misc-DDds1gXl.js"),[]).then(e=>e.default),"../lensfun/om-system.xml":()=>St(()=>import("./om-system-DiAB48fM.js"),[]).then(e=>e.default),"../lensfun/rf-leica.xml":()=>St(()=>import("./rf-leica-B--SzUq2.js"),[]).then(e=>e.default),"../lensfun/slr-canon.xml":()=>St(()=>import("./slr-canon-CgVCqXGM.js"),[]).then(e=>e.default),"../lensfun/slr-hasselblad.xml":()=>St(()=>import("./slr-hasselblad-C1loeXzI.js"),[]).then(e=>e.default),"../lensfun/slr-konica-minolta.xml":()=>St(()=>import("./slr-konica-minolta-D38k_LOC.js"),[]).then(e=>e.default),"../lensfun/slr-leica.xml":()=>St(()=>import("./slr-leica-c2xbyark.js"),[]).then(e=>e.default),"../lensfun/slr-nikon.xml":()=>St(()=>import("./slr-nikon-CRCAIYTn.js"),[]).then(e=>e.default),"../lensfun/slr-olympus.xml":()=>St(()=>import("./slr-olympus-dFRFPB-U.js"),[]).then(e=>e.default),"../lensfun/slr-panasonic.xml":()=>St(()=>import("./slr-panasonic-JG8UEfod.js"),[]).then(e=>e.default),"../lensfun/slr-pentax.xml":()=>St(()=>import("./slr-pentax-CFNePcmx.js"),[]).then(e=>e.default),"../lensfun/slr-ricoh.xml":()=>St(()=>import("./slr-ricoh-9U2ATHkn.js"),[]).then(e=>e.default),"../lensfun/slr-samsung.xml":()=>St(()=>import("./slr-samsung-C2vmR_UF.js"),[]).then(e=>e.default),"../lensfun/slr-samyang.xml":()=>St(()=>import("./slr-samyang-DNuAvYvk.js"),[]).then(e=>e.default),"../lensfun/slr-schneider.xml":()=>St(()=>import("./slr-schneider-BFavwTAS.js"),[]).then(e=>e.default),"../lensfun/slr-sigma.xml":()=>St(()=>import("./slr-sigma-CkwWa641.js"),[]).then(e=>e.default),"../lensfun/slr-soligor.xml":()=>St(()=>import("./slr-soligor-CoIp1oZj.js"),[]).then(e=>e.default),"../lensfun/slr-sony.xml":()=>St(()=>import("./slr-sony-BgsLb2KN.js"),[]).then(e=>e.default),"../lensfun/slr-tamron.xml":()=>St(()=>import("./slr-tamron-DqtWr6vk.js"),[]).then(e=>e.default),"../lensfun/slr-tokina.xml":()=>St(()=>import("./slr-tokina-DQ0zZu9T.js"),[]).then(e=>e.default),"../lensfun/slr-ussr.xml":()=>St(()=>import("./slr-ussr-Bfn2DNi9.js"),[]).then(e=>e.default),"../lensfun/slr-vivitar.xml":()=>St(()=>import("./slr-vivitar-CIhiFdqq.js"),[]).then(e=>e.default),"../lensfun/slr-zeiss.xml":()=>St(()=>import("./slr-zeiss-DzcVUeAm.js"),[]).then(e=>e.default)}),Rs=({title:e,children:t})=>c.jsxs("div",{className:"border-b border-gray-200 dark:border-slate-700 transition-colors duration-300",children:[c.jsx("div",{className:"p-4 font-semibold text-gray-800 dark:text-slate-200 bg-gray-50 dark:bg-slate-800/30 border-b border-gray-200 dark:border-slate-800 select-none cursor-default transition-colors duration-300",children:c.jsx("span",{children:e})}),c.jsx("div",{className:"p-4 bg-white dark:bg-slate-900/50 transition-colors duration-300",children:t})]}),qT=[{value:-1,label:"Raw Bayer (Grayscale)"},{value:0,label:"Linear interpolation"},{value:1,label:"VNG (Variable Number of Gradients)"},{value:2,label:"PPG (Patterned Pixel Grouping)"},{value:3,label:"AHD (Adaptive Homogeneity-Directed)"},{value:4,label:"DCB (Demosaicing with Color Back-refinement)"},{value:11,label:"DHT (Modified AHD)"},{value:12,label:"AAHD (Adaptive AHD)"}],vh=({checked:e,onChange:t,label:r})=>c.jsxs("div",{className:"flex items-center justify-between py-2 cursor-pointer group",onClick:()=>t(!e),children:[c.jsx("span",{className:"text-sm font-medium text-gray-600 dark:text-slate-300 select-none group-hover:text-gray-900 dark:group-hover:text-slate-200 transition-colors",children:r}),c.jsx("div",{className:`relative w-11 h-6 rounded-full transition-colors duration-200 ease-in-out ${e?"bg-cyan-500 dark:bg-cyan-600":"bg-gray-300 dark:bg-slate-600 group-hover:bg-gray-400 dark:group-hover:bg-slate-500"}`,children:c.jsx("div",{className:`absolute left-1 top-1 bg-white w-4 h-4 rounded-full shadow-md transform transition-transform duration-200 ease-in-out ${e?"translate-x-5":"translate-x-0"}`})})]}),$y=(e,t)=>{if(!e)return null;if(t){const r=e.bayerPattern.toUpperCase(),n=l=>{const u=[];for(let d=0;d<4;d++)r[d]===l&&u.push(d);return u},a=t.BlackLevelRed,i=t.BlackLevelGreen,o=t.BlackLevelBlue;if(a!==void 0&&i!==void 0&&o!==void 0){const l=parseFloat(a),u=parseFloat(i),d=parseFloat(o);if(!isNaN(l)&&!isNaN(u)&&!isNaN(d)){const f=[0,0,0,0];return f.fill(u),n("R").forEach(h=>f[h]=l),n("G").forEach(h=>f[h]=u),f}}let s=t.BlackLevel;if(s===void 0&&(s=t.BlackLevel2),s!==void 0){let l=[];if(Array.isArray(s)?l=s.map(Number):typeof s=="string"?l=s.trim().split(/\s+/).map(Number):typeof s=="number"&&(l=[s,s,s,s]),l.length===1&&!isNaN(l[0])&&(l=[l[0],l[0],l[0],l[0]]),l.length>=4&&!l.slice(0,4).some(isNaN))return[l[0],l[1],l[2],l[3]]}}return e.blackLevels&&e.blackLevels.length===4?[e.blackLevels[0],e.blackLevels[1],e.blackLevels[2],e.blackLevels[3]]:null},Ly=e=>{if(typeof e=="number"&&Number.isFinite(e))return e;if(typeof e!="string")return null;const t=e.match(/-?\d+(\.\d+)?/);if(!t)return null;const r=Number(t[0]);return Number.isFinite(r)?r:null},iS=(e,t)=>{var o,s,l,u;const n=new DOMParser().parseFromString(e,"application/xml");if(n.getElementsByTagName("parsererror").length>0)throw new Error(`Invalid XML in ${t}`);const a=Array.from(n.getElementsByTagName("lens")),i=[];for(const d of a){const f=((s=(o=d.getElementsByTagName("maker")[0])==null?void 0:o.textContent)==null?void 0:s.trim())||"",h=((u=(l=d.getElementsByTagName("model")[0])==null?void 0:l.textContent)==null?void 0:u.trim())||"",g=[],v=Array.from(d.getElementsByTagName("distortion"));for(const x of v){const y=(x.getAttribute("model")||"").toLowerCase(),_=Number(x.getAttribute("focal"));if(!Number.isFinite(_)||y!=="poly3"&&y!=="poly5"&&y!=="ptlens")continue;const j={model:y,focal:_,k1:Number(x.getAttribute("k1"))||0,k2:Number(x.getAttribute("k2"))||0,a:Number(x.getAttribute("a"))||0,b:Number(x.getAttribute("b"))||0,c:Number(x.getAttribute("c"))||0};g.push(j)}if(g.length===0)continue;g.sort((x,y)=>x.focal-y.focal);const b=([f,h].filter(Boolean).join(" ")||"Unnamed Lens").trim();i.push({id:`${t}:${b}:${i.length}`,label:b,distortions:g})}return i},oS=(e,t)=>{const r=new Map;for(const n of e)r.set(n.id,n);for(const n of t)r.set(n.id,n);return Array.from(r.values()).sort((n,a)=>n.label.localeCompare(a.label))},ZT=(e,t,r)=>{if(e.model!==t.model||Math.abs(t.focal-e.focal)<1e-8)return{...e,focal:r};const n=Math.max(0,Math.min(1,(r-e.focal)/(t.focal-e.focal))),a=(i,o)=>(i||0)*(1-n)+(o||0)*n;return{model:e.model,focal:r,k1:a(e.k1,t.k1),k2:a(e.k2,t.k2),a:a(e.a,t.a),b:a(e.b,t.b),c:a(e.c,t.c)}},JT=(e,t)=>{if(!e.length||!Number.isFinite(t))return null;if(e.length===1)return{...e[0],focal:t};let r=e[0],n=e[e.length-1];for(let a=0;a<e.length;a++){const i=e[a];if(i.focal<=t&&(r=i),i.focal>=t){n=i;break}}return r.focal===n.focal?{...r,focal:t}:r.model!==n.model?{...Math.abs(r.focal-t)<=Math.abs(n.focal-t)?r:n,focal:t}:ZT(r,n,t)},QT=e=>{var Ac,Ec,Tc;const{rawImageData:t,displaySettings:r,onApplyDisplaySettings:n,onSetSelection:a,exifData:i,isBridgeConnected:o,isDrLabOpen:s,drMarkingStep:l,onStartMarking:u,onGenerateTestPic:d,drRoiSize:f,onDrRoiSizeChange:h,drGridRows:g,onDrGridRowsChange:v,drGridCols:w,onDrGridColsChange:b,onBatchDrLab:x,hasDrMarkers:y,isFftLabOpen:_,onProcessPair:j,onProcessBatchDiff:S,onProcessStackFft:k,onOpenCrossCalc:M,isThreePlane:N,onToggleXTrans:T,xtransPhase:A,onXTransPhaseChange:D,isXTransConverted:$,onCommand:B,isColorLabOpen:J,colorLabMarkingStep:W,onStartColorLabMarking:I,isSfrLabOpen:G,roiStats:U,isBGGR:X,onOpenDngExport:V,sfrRectCount:z,isBatchMarkingMode:q,onToggleBatchMarking:te,onClearBatchMarks:ie,onBatchCompute:he,stdChartStep:ee,onStartStandardCalibration:Le,onSaveBatchTemplate:fe,onImportBatchTemplate:ce,onBatchTransform:de,onOpenStackingTool:Ne,isPsModeOpen:pe,psDocument:ke,psBrushEnabled:me,psBrushSize:Be,psBrushOpacity:Se,psBrushFeather:we,psEllipseFeather:Re,psBrushMode:it,onPsAddMask:Qe,onPsAddEllipseMask:se,onPsCancelEllipseTool:Xe,onPsFlipHorizontal:ht,onPsFlipVertical:Zt,onPsCropToRoi:Jt,onPsRotateCanvas:Ut,onPsApplyUpright:Lt,onPsApplyLensDistortion:pr,onPsSelectLayer:ir,onPsSelectMask:zt,onPsBindLayerMask:Tr,onPsSetLayerBlendMode:lt,onPsSetLayerOpacity:Nt,onPsSetLayerBasic:wr,onPsSetLayerMixer:kr,onPsPreviewLayerBasic:_r,onPsPreviewLayerMixer:zr,onPsSetLayerCurves:Or,onPsSelectMaskItem:or,onPsUpdateEllipseItem:Br,onPsSetMaskOverlayVisible:Xt,onPsAddGuide:Te,onPsSelectGuide:Q,onPsSetGuideEndpoints:Ce,psGuidePickTarget:ye,onPsStartGuidePointPick:ze,onPsCancelGuidePointPick:ot,onPsDeleteGuide:ct,onPsUndo:Ct,onPsJumpHistoryIndex:tt,onPsExportWorkflowCsv:Hr,onPsImportWorkflowCsv:gr,onPsExportPng:Qt,onPsExportJpeg:jt,onPsBrushEnabledChange:mr,onPsBrushSizeChange:R,onPsBrushOpacityChange:sr,onPsBrushFeatherChange:Fr,onPsEllipseFeatherChange:Me,onPsBrushModeChange:ut}=e,gt=!!t,yr=!!(t!=null&&t.isXTrans),lr=!!T,et=P.useMemo(()=>!ke||!ke.selectedGuideId?null:ke.guides.find(Y=>Y.id===ke.selectedGuideId)||null,[ke]),tr=P.useMemo(()=>{var Y;return(Y=ke==null?void 0:ke.history)!=null&&Y.length?ke.history.map((Pe,yt)=>({entry:Pe,index:yt})).reverse():[]},[ke]),[rr,Dt]=P.useState("0"),Et=P.useCallback(()=>{const Y=Number(rr);Number.isFinite(Y)&&(Ut==null||Ut(Y))},[rr,Ut]),_e=P.useRef(!1),fr=P.useRef(null),F=()=>{_e.current=!0},Oe=()=>{_e.current=!1},[Ie,Tt]=P.useState(r.exposure.toString()),[Ve,pt]=P.useState(""),[Ye,Wt]=P.useState("0 0 0 0"),[Ir,Qr]=P.useState("1.0"),[Kt,Pn]=P.useState("1.0"),[qr,Xr]=P.useState(r.demosaicMethod),[cr,nr]=P.useState(!!r.showKadc),[Ar,qe]=P.useState(!!r.subtractBlackLevelFromStats),[hr,fn]=P.useState(!!r.highlightRecovery),[Ln,Zn]=P.useState(((Ac=t==null?void 0:t.whiteLevel)==null?void 0:Ac.toString())||((Ec=r.customWhiteLevel)==null?void 0:Ec.toString())||"16383"),[Tn,Oi]=P.useState("64"),[ue,ve]=P.useState(!1),[be,ae]=P.useState(""),[$e,mt]=P.useState(""),[bt,Ot]=P.useState(""),[Bt,At]=P.useState(!1),[Kr,jr]=P.useState(!1),[Er,Rr]=P.useState(!1),[De,Mt]=P.useState("bilinear"),[wt,Wr]=P.useState(!1),[xr,Jn]=P.useState(!1),[Cr,en]=P.useState("single"),[yn,mi]=P.useState(!1),[qi,bs]=P.useState(!0),[xa,Zi]=P.useState(!0),[yi,In]=P.useState(!1),[Qa,So]=P.useState(10),[ei,ti]=P.useState(1.05),La=P.useMemo(()=>Object.keys(ju).sort(),[]),tn=P.useRef(null),Ca=P.useRef(null),ws=P.useRef(null),Ma=P.useRef(null),[rt,Yt]=P.useState(null),[Vt,Gt]=P.useState(null),[Qn,cn]=P.useState(!1),[ua,ri]=P.useState(!0),Bn=P.useRef(null),Na=P.useRef(null),an=P.useRef(null),Vo=P.useRef(null),_t=P.useRef(null),[Ji,It]=P.useState([]),[Qi,_o]=P.useState(""),[ni,ks]=P.useState(""),[Ss,vd]=P.useState(!1),[Ml,zn]=P.useState("Built-in Lensfun database will load when PS Mode opens."),_s=P.useRef(!1);P.useEffect(()=>{if(!pe||_s.current)return;_s.current=!0;let Y=!1;return(async()=>{zn("Loading built-in Lensfun database...");const yt=Object.entries(YT);if(yt.length===0){Y||zn("No built-in Lensfun XML found in /lensfun. You can still load XML manually.");return}const ur=[];let Zr=0;for(const[Mr,hn]of yt){const Ai=Mr.split("/").pop()||Mr;try{const Ua=await hn();ur.push(...iS(Ua,Ai))}catch{Zr++}}if(Y)return;if(ur.length===0){zn("Built-in Lensfun XML loaded, but no supported distortion profiles were found.");return}It(Mr=>oS(Mr,ur)),_o(Mr=>Mr||ur[0].id);const on=Zr>0?` (${Zr} file(s) skipped)`:"";zn(`Built-in Lensfun ready: ${ur.length} profile(s) from ${yt.length} XML file(s)${on}.`)})(),()=>{Y=!0}},[pe]),P.useEffect(()=>{if(ni.trim())return;const Y=Ly(i==null?void 0:i.FocalLength)??Ly(i==null?void 0:i.FocalLength35efl)??Ly(i==null?void 0:i.FocalLengthIn35mmFormat);Y&&Y>0&&ks(Y.toFixed(1))},[i,ni]),P.useEffect(()=>{const Y=t!==fr.current;if(Y&&(fr.current=t,Oe()),Tt(r.exposure.toString()),r.customMatrix?pt(r.customMatrix.join(" ")):pt(""),r.blackLevel&&r.blackLevel.length===4)Wt(r.blackLevel.join(" "));else{const Pe=$y(t,i);Pe&&Pe.some(yt=>yt!==0)?Wt(Pe.join(" ")):Wt("")}Qr(r.wbGains?r.wbGains[0].toString():"1.0"),Pn(r.wbGains?r.wbGains[1].toString():"1.0"),Xr(r.demosaicMethod),nr(!!r.showKadc),qe(!!r.subtractBlackLevelFromStats),Y?(fn(!1),t!=null&&t.whiteLevel?Zn(t.whiteLevel.toString()):r.customWhiteLevel&&Zn(r.customWhiteLevel.toString())):(fn(!!r.highlightRecovery),r.customWhiteLevel?Zn(r.customWhiteLevel.toString()):t!=null&&t.whiteLevel&&Zn(t.whiteLevel.toString())),r.advancedZeroDep&&(ae(r.advancedZeroDep.bl.join(" ")),mt(r.advancedZeroDep.bg.join(" ")),Ot(r.advancedZeroDep.fg.join(" ")),Y&&ve(!0))},[r,t,i]);const js=P.useRef(!1),Cc=P.useRef(null);P.useEffect(()=>{t!==Cc.current&&(js.current=!1,Cc.current=t)},[t]),P.useEffect(()=>{if(o&&t&&!js.current){js.current=!0;const Y=$y(t,i),Pe=Y&&Y.some(yt=>yt>0);if(Y&&Pe){console.log("[AutoApply] Detected Black Levels via Bridge:",Y);const yt={...r,blackLevel:Y,showKadc:!1,subtractBlackLevelFromStats:!1,exposure:r.exposure,wbGains:r.wbGains||[1,1],demosaicMethod:-1,renderMode:"zero-dependency"};n(yt)}}},[o,t,i,r,n]);const Ps=Y=>{F(),Tt(Y)},Mc=Y=>{F(),Qr(Y)},xi=Y=>{F(),Pn(Y)},Ba=Y=>{F(),Xr(parseInt(Y.target.value,10))},Fa=Y=>{F(),pt(Y.target.value)},Cs=()=>{Oe(),Tt("0"),Xr(3),Qr("1.0"),Pn("1.0"),nr(!0),qe(!0),pt(""),fn(!1),Zn((t==null?void 0:t.whiteLevel.toString())||"16383"),ve(!1);const Y=$y(t,i);Wt(Y&&Y.some(Pe=>Pe!==0)?Y.join(" "):"")},bd=()=>{!t||!a||(a({x:0,y:0,w:t.width,h:t.height}),B==null||B("sel full"))},wd=()=>{if(!t||!a)return;const Y=parseInt(Tn,10);if(isNaN(Y)||Y<=0)return;const Pe=Math.min(Y,t.width),yt=Math.min(Y,t.height),ur=Math.floor((t.width-Pe)/2),Zr=Math.floor((t.height-yt)/2);a({x:ur,y:Zr,w:Pe,h:yt}),B==null||B(`sel center ${Y}`)},Nc=()=>{if(!t||!U){alert("Please select a region on the image first.");return}const Y=Ho()||[0,0,0,0],Pe=Ve.trim().replace(/[\s,\n]+/g," "),yt=Pe?Pe.split(" ").map(Number):[1,0,0,0,1,0,0,0,1];if(yt.length!==9){alert("Matrix must be 3x3 (9 values).");return}const[ur,Zr]=BT(t.data,t.width,{x:U.x,y:U.y,w:U.width,h:U.height},Y,yt,X);F(),Qr(ur.toFixed(4)),Pn(Zr.toFixed(4)),B==null||B(`wb ${ur.toFixed(4)} ${Zr.toFixed(4)} (Spot)`)},Ho=()=>{const Pe=Ye.split(/[\s,]+/).filter(yt=>yt.trim()!=="").map(Number);if(Pe.length===1&&!isNaN(Pe[0]))return[Pe[0],Pe[0],Pe[0],Pe[0]];if(Pe.length>=4&&!Pe.slice(0,4).some(isNaN))return[Pe[0],Pe[1],Pe[2],Pe[3]]},jo=Y=>{const Pe=Y.trim().split(/[\s,]+/).map(Number);return Pe.length===4&&!Pe.some(isNaN)?Pe:Pe.length===1&&!isNaN(Pe[0])?[Pe[0],Pe[0],Pe[0],Pe[0]]:null},Ms=()=>{Oe(),B&&(Ie!=="0"&&B(`ev ${Ie}`),(Ir!=="1.0"||Kt!=="1.0")&&B(`wb ${Ir} ${Kt}`),Ye!=="0 0 0 0"&&Ye!==""&&B(`bl ${Ye}`),qr!==3&&B(`demo ${qr}`),Ve.trim().length>0&&B(`matrix ${Ve.replace(/\s+/g," ")}`),B("render"));const Y={...r},Pe=parseFloat(Ie);isNaN(Pe)||(Y.exposure=Pe);const yt=parseFloat(Ir),ur=parseFloat(Kt);!isNaN(yt)&&!isNaN(ur)&&(Y.wbGains=[yt,ur]),Y.demosaicMethod=qr,Y.renderMode="standard";const Zr=Ho();Zr?Y.blackLevel=Zr:delete Y.blackLevel;const on=Ve.trim().replace(/[\s,\n]+/g," ");if(on){const Mr=on.split(" ").map(Number);Mr.length===9&&!Mr.some(isNaN)?Y.customMatrix=Mr:alert("Invalid matrix format. Please ensure exactly 9 numeric values (3x3).")}else delete Y.customMatrix;if(Y.showKadc=cr,Y.subtractBlackLevelFromStats=Ar,Y.highlightRecovery=hr,hr){const Mr=parseFloat(Ln);!isNaN(Mr)&&Mr>0&&(Y.customWhiteLevel=Mr)}else delete Y.customWhiteLevel;n(Y)},kd=()=>{Rr(X||!1),Mt("bilinear"),jr(!0)},vt=Y=>{Oe(),B&&(Ie!=="0"&&B(`ev ${Ie}`),(Ir!=="1.0"||Kt!=="1.0")&&B(`wb ${Ir} ${Kt}`),Ye!=="0 0 0 0"&&Ye!==""&&B(`bl ${Ye}`),B(Y==="color"?"render zero color":"render zero"));const Pe={...r},yt=Ho();yt&&(Pe.blackLevel=yt);const ur=parseFloat(Ir),Zr=parseFloat(Kt);!isNaN(ur)&&!isNaN(Zr)&&(Pe.wbGains=[ur,Zr]);const on=parseFloat(Ie);if(isNaN(on)||(Pe.exposure=on),Y==="color"){const Mr=Ve.trim().replace(/[\s,\n]+/g," ");if(Mr){const hn=Mr.split(" ").map(Number);hn.length===9&&!hn.some(isNaN)&&(Pe.customMatrix=hn)}Pe.isBGGR=Er,Pe.zeroDepColorDemosaic=De}if(Pe.renderMode=Y==="mosaic"?"zero-dependency":"zero-dep-color",Pe.showKadc=cr,Pe.subtractBlackLevelFromStats=Ar,Pe.highlightRecovery=hr,hr){const Mr=parseFloat(Ln);!isNaN(Mr)&&Mr>0&&(Pe.customWhiteLevel=Mr)}else delete Pe.customWhiteLevel;jr(!1),n(Pe)},Oc=()=>{Oe();const Y=jo(be),Pe=jo($e),yt=jo(bt);if(!Y||!Pe||!yt){alert("Please enter valid 4-channel numbers for BL, BG, and FG.");return}B&&(Ie!=="0"&&B(`ev ${Ie}`),B(`render unmix ${Y.join(" ")} ${Pe.join(" ")} ${yt.join(" ")}`));const ur={...r,renderMode:"advanced-zero-dep",advancedZeroDep:{bl:Y,bg:Pe,fg:yt}};if(ur.showKadc=cr,ur.subtractBlackLevelFromStats=Ar,ur.highlightRecovery=hr,hr){const Zr=parseFloat(Ln);!isNaN(Zr)&&Zr>0&&(ur.customWhiteLevel=Zr)}n(ur)},Sd=()=>{if(U){const Y=U.means,Pe=[Y[0],Y[1],Y[3],Y[2]].map(yt=>yt.toFixed(1));F(),mt(Pe.join(" "))}else alert("Please select an ROI on the image first.")},Po=()=>{if(U){const Y=U.means,Pe=[Y[0],Y[1],Y[3],Y[2]].map(yt=>yt.toFixed(1));F(),Ot(Pe.join(" "))}else alert("Please select an ROI on the image first.")},Ns=Y=>{Y.target.files&&Y.target.files.length>0&&x&&(x(Y.target.files,Cr),B==null||B(`drlab batch ${Cr}`)),Y.target.value="",Jn(!1)},Os=async Y=>{var yt;const Pe=(yt=Y.target.files)==null?void 0:yt[0];if(!(!Pe||!ce)){try{const Zr=(await Pe.text()).split(`
`),on=[];for(let Mr of Zr){if(Mr=Mr.trim(),!Mr||Mr.toLowerCase().startsWith("index"))continue;const hn=Mr.split(",").map(Number);if(hn.length>=5){const Ai=hn[1],Ua=hn[2],vi=hn[3],Ei=hn[4],va=hn[5];!isNaN(Ai)&&!isNaN(Ua)&&!isNaN(vi)&&!isNaN(Ei)&&on.push({x:Ai,y:Ua,w:vi,h:Ei,ori:isNaN(va)?void 0:va})}}ce(on),alert(`Imported ${on.length} ROIs successfully.`)}catch(ur){console.error("Import failed",ur),alert("Failed to import CSV: "+ur.message)}Y.target.value=""}},_d=async Y=>{var yt;const Pe=(yt=Y.target.files)==null?void 0:yt[0];if(Pe){try{const Zr=(await Pe.text()).split(`
`),on=[];on.push("#BlackLevel: 0,0,0,0"),on.push("#ImageHeight: 0"),on.push("Row,Col,R_Mean,G1_Mean,G2_Mean,B_Mean,R_Std,G1_Std,G2_Std,B_Std");let Mr=1;for(let vi=0;vi<Zr.length;vi++){const Ei=Zr[vi].trim();if(!Ei||Ei.includes("R_mean")||Ei.includes("R_std"))continue;const va=Ei.split(/\s+/).map(Number);if(va.length<8||va.some(isNaN))continue;const Id=[Mr,1,va[0],va[2],va[6],va[4],va[1],va[3],va[7],va[5]].join(",");on.push(Id),Mr++}const hn=new Blob([on.join(`
`)],{type:"text/csv"}),Ai=URL.createObjectURL(hn),Ua=document.createElement("a");Ua.href=Ai,Ua.download=Pe.name.replace(/\.[^/.]+$/,"")+"_converted.csv",document.body.appendChild(Ua),Ua.click(),document.body.removeChild(Ua),URL.revokeObjectURL(Ai)}catch(ur){console.error("Conversion failed",ur),alert("Failed to convert file.")}Y.target.value=""}},jd=Y=>{Y.target.files&&Y.target.files[0]&&(Yt(Y.target.files[0]),B==null||B("fft load a"))},Pd=Y=>{Y.target.files&&Y.target.files[0]&&(Gt(Y.target.files[0]),B==null||B("fft load b"))},Cd=()=>{rt&&Vt&&j&&(j(rt,Vt,Qn,ua),B==null||B("fft run"))},Nl=Y=>{Y.target.files&&Y.target.files.length>0&&S&&(S(Y.target.files),B==null||B("fft batch")),Y.target.value=""},Md=Y=>{Y.target.files&&Y.target.files.length>0&&k&&(k(Y.target.files),B==null||B("fft stack")),Y.target.value=""},Xo=()=>{he&&(he({useNR:qi,useDeshading:xa,greenOnly:yi}),B==null||B("batch compute"))},eo=(Y,Pe,yt)=>{de&&de(Y,Pe,yt)},Nd=Y=>{var yt;const Pe=(yt=Y.target.files)==null?void 0:yt[0];Pe&&gr&&gr(Pe),Y.target.value=""},Od=async Y=>{const Pe=Y.target.files;if(!(!Pe||Pe.length===0))try{const yt=[];for(const ur of Array.from(Pe)){const Zr=await ur.text();yt.push(...iS(Zr,ur.name))}if(yt.length===0){zn("No supported distortion profiles found in selected XML.");return}It(ur=>oS(ur,yt)),_o(ur=>ur||yt[0].id),zn(`Added ${yt.length} lens profile(s) from ${Pe.length} file(s).`)}catch(yt){zn(`Lensfun load failed: ${(yt==null?void 0:yt.message)||yt}`)}finally{Y.target.value=""}},Ad=()=>{if(!Ss||!pr)return;const Y=Number(ni);if(!Number.isFinite(Y)||Y<=0){zn("Set a valid focal length (mm) before applying correction.");return}const Pe=Ji.find(ur=>ur.id===Qi);if(!Pe){zn("Select a lens profile first.");return}const yt=JT(Pe.distortions,Y);if(!yt){zn("No usable distortion coefficients for this lens.");return}pr({...yt,focal:Y,lensLabel:Pe.label}),zn(`Applied ${Pe.label} correction at ${Y.toFixed(1)}mm (${yt.model}).`)},Ed=be.trim()!==""&&$e.trim()!==""&&bt.trim()!=="",Td=r.renderMode==="advanced-zero-dep";return c.jsxs("div",{className:"flex flex-col h-full bg-white dark:bg-black",children:[c.jsxs("div",{className:"flex-grow overflow-y-auto",children:[N&&c.jsxs("div",{className:"bg-red-50 dark:bg-red-900/20 p-3 border-b border-red-100 dark:border-red-800 text-center animate-pulse",children:[c.jsx("p",{className:"text-xs font-bold text-red-600 dark:text-red-400 uppercase tracking-wide",children:"[!] 3-Plane / Full Color"}),c.jsx("p",{className:"text-[10px] text-red-500/80 dark:text-red-300/70 mt-1",children:"Demosaic disabled. Stats analysis treated as pseudo-Bayer."})]}),yr&&!$&&c.jsxs("div",{className:"bg-amber-50 dark:bg-amber-900/20 p-3 border-b border-amber-100 dark:border-amber-800 text-center",children:[c.jsx("p",{className:"text-xs font-bold text-amber-600 dark:text-amber-400 uppercase tracking-wide",children:"[!] X-Trans Native (Unsupported)"}),c.jsx("p",{className:"text-[10px] text-amber-600/80 dark:text-amber-300/70 mt-1 text-left leading-tight px-1",children:"Currently reading raw 6x6 pattern as Bayer. Stats will be incorrect. Please enable Pseudo-Bayer conversion below."})]}),$&&c.jsxs("div",{className:"bg-emerald-50 dark:bg-emerald-900/20 p-3 border-b border-emerald-100 dark:border-emerald-800 text-center",children:[c.jsx("p",{className:"text-xs font-bold text-emerald-600 dark:text-emerald-400 uppercase tracking-wide",children:"[OK] X-Trans Pseudo-Bayer"}),c.jsx("p",{className:"text-[10px] text-emerald-600/80 dark:text-emerald-300/70 mt-1 text-left leading-tight px-1",children:"Converted 6x6  2x2 RGGB (Subsampled). Demosaic & Analysis fully supported."})]}),pe&&c.jsxs(c.Fragment,{children:[c.jsx("div",{className:"p-4 border-b border-gray-200 dark:border-slate-700 bg-gray-50 dark:bg-slate-800/30",children:c.jsxs("div",{className:"space-y-2",children:[c.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[c.jsx("button",{onClick:()=>Ct==null?void 0:Ct(),disabled:!ke||(ke.historyIndex??0)<=0,className:"px-2 py-1 bg-amber-600 disabled:bg-gray-400 text-white font-bold border border-black text-xs",children:"Undo"}),c.jsx("button",{onClick:()=>Hr==null?void 0:Hr(),disabled:!ke,className:"px-2 py-1 bg-slate-800 disabled:bg-gray-400 text-white font-bold border border-black text-xs",children:"Export Flow JSON"})]}),c.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[c.jsx("button",{onClick:()=>{var Y;return(Y=Vo.current)==null?void 0:Y.click()},disabled:!ke,className:"px-2 py-1 bg-slate-700 disabled:bg-gray-400 text-white font-bold border border-black text-xs",children:"Import Flow File"}),c.jsx("button",{onClick:()=>Qt==null?void 0:Qt(),className:"px-2 py-1 bg-emerald-700 text-white font-bold border border-black text-xs",children:"Export PNG"})]}),c.jsx("button",{onClick:()=>jt==null?void 0:jt(),className:"w-full px-2 py-1 bg-emerald-800 text-white font-bold border border-black text-xs",children:"Export JPEG"}),c.jsx("input",{ref:Vo,type:"file",accept:".json,.csv,application/json,text/csv",className:"hidden",onChange:Nd}),c.jsx("div",{className:"max-h-36 overflow-y-auto border border-gray-300 dark:border-slate-700 bg-white dark:bg-slate-900",children:tr.length>0?tr.map(({entry:Y,index:Pe})=>c.jsxs("button",{onClick:()=>tt==null?void 0:tt(Pe),className:`w-full text-left px-2 py-1 border-b border-gray-200 dark:border-slate-700 text-xs ${(ke==null?void 0:ke.historyIndex)===Pe?"bg-cyan-100 dark:bg-cyan-900/40":"bg-white dark:bg-slate-900"}`,children:[c.jsx("div",{className:"font-semibold truncate",children:Y.label}),c.jsx("div",{className:"text-[10px] text-gray-500",children:new Date(Y.timestamp).toLocaleTimeString()})]},Y.id)):c.jsx("div",{className:"px-2 py-2 text-[11px] text-gray-500",children:"No history entries."})})]})}),c.jsx(Rs,{title:"PS Masks",children:c.jsx(uT,{inline:!0,doc:ke||null,brushEnabled:!!me,brushSize:Be||32,brushOpacity:Se||.35,brushFeather:we??.6,ellipseFeather:Re??24,brushMode:it||"add",onAddMask:()=>Qe==null?void 0:Qe(),onAddEllipseMask:()=>se==null?void 0:se(),onCancelEllipseTool:()=>Xe==null?void 0:Xe(),onSelectLayer:Y=>ir==null?void 0:ir(Y),onSelectMask:Y=>zt==null?void 0:zt(Y),onBindLayerMask:(Y,Pe)=>Tr==null?void 0:Tr(Y,Pe),onSetLayerBlendMode:(Y,Pe)=>lt==null?void 0:lt(Y,Pe),onSetLayerOpacity:(Y,Pe)=>Nt==null?void 0:Nt(Y,Pe),onSetLayerBasic:(Y,Pe)=>wr==null?void 0:wr(Y,Pe),onSetLayerMixer:(Y,Pe)=>kr==null?void 0:kr(Y,Pe),onPreviewLayerBasic:(Y,Pe)=>_r==null?void 0:_r(Y,Pe),onPreviewLayerMixer:(Y,Pe)=>zr==null?void 0:zr(Y,Pe),onSetLayerCurves:(Y,Pe)=>Or==null?void 0:Or(Y,Pe),onSelectMaskItem:Y=>or==null?void 0:or(Y),onUpdateEllipseItem:(Y,Pe)=>Br==null?void 0:Br(Y,Pe),onSetMaskOverlayVisible:(Y,Pe)=>Xt==null?void 0:Xt(Y,Pe),onBrushEnabledChange:Y=>mr==null?void 0:mr(Y),onBrushSizeChange:Y=>R==null?void 0:R(Y),onBrushOpacityChange:Y=>sr==null?void 0:sr(Y),onBrushFeatherChange:Y=>Fr==null?void 0:Fr(Y),onEllipseFeatherChange:Y=>Me==null?void 0:Me(Y),onBrushModeChange:Y=>ut==null?void 0:ut(Y)})}),c.jsxs(Rs,{title:"PS Upright / Crop",children:[c.jsxs("div",{className:"grid grid-cols-2 gap-2 mb-2",children:[c.jsx("button",{onClick:()=>ht==null?void 0:ht(),className:"px-2 py-1 bg-slate-700 text-white font-bold border border-black",children:"Flip Left-Right"}),c.jsx("button",{onClick:()=>Zt==null?void 0:Zt(),className:"px-2 py-1 bg-slate-700 text-white font-bold border border-black",children:"Flip Up-Down"})]}),c.jsxs("div",{className:"grid grid-cols-2 gap-2 mb-2",children:[c.jsx("button",{onClick:()=>Ut==null?void 0:Ut(90),className:"px-2 py-1 bg-slate-700 text-white font-bold border border-black",children:"Rotate +90"}),c.jsx("button",{onClick:()=>Ut==null?void 0:Ut(-90),className:"px-2 py-1 bg-slate-700 text-white font-bold border border-black",children:"Rotate -90"})]}),c.jsxs("div",{className:"grid grid-cols-[1fr_auto] gap-2 mb-3",children:[c.jsx("input",{type:"number",step:.1,value:rr,onChange:Y=>Dt(Y.target.value),className:"border border-gray-400 dark:border-slate-600 bg-white dark:bg-slate-900 p-1",placeholder:"Angle deg"}),c.jsx("button",{onClick:Et,className:"px-2 py-1 bg-slate-800 text-white font-bold border border-black",children:"Rotate"})]}),c.jsx("button",{onClick:()=>Jt==null?void 0:Jt(),disabled:!U,className:"mb-3 w-full px-2 py-1 bg-amber-600 disabled:bg-gray-400 text-white font-bold border border-black",children:"Crop To ROI"}),c.jsxs("div",{className:"grid grid-cols-2 gap-2 mb-2",children:[c.jsx("button",{onClick:()=>Te==null?void 0:Te("horizontal"),className:"px-2 py-1 bg-sky-700 text-white font-bold border border-black",children:"+ H Guide"}),c.jsx("button",{onClick:()=>Te==null?void 0:Te("vertical"),className:"px-2 py-1 bg-sky-800 text-white font-bold border border-black",children:"+ V Guide"})]}),c.jsxs("div",{className:"space-y-1 max-h-24 overflow-auto border border-gray-300 dark:border-slate-700 p-1 mb-2",children:[((ke==null?void 0:ke.guides)||[]).map(Y=>c.jsxs("button",{onClick:()=>Q==null?void 0:Q(Y.id),className:`w-full text-left px-2 py-1 border ${(ke==null?void 0:ke.selectedGuideId)===Y.id?"bg-sky-100 dark:bg-sky-900/40 border-sky-500":"bg-white dark:bg-slate-900 border-gray-300 dark:border-slate-700"}`,children:[Y.orientation==="horizontal"?"H":"V"," (",Math.round(Y.p1.x),",",Math.round(Y.p1.y),")-(",Math.round(Y.p2.x),",",Math.round(Y.p2.y),")"]},Y.id)),(((Tc=ke==null?void 0:ke.guides)==null?void 0:Tc.length)||0)===0&&c.jsx("div",{className:"px-2 py-2 text-[11px] text-gray-500",children:"No guides."})]}),et&&c.jsxs("div",{children:[c.jsxs("div",{className:"text-[11px] mb-1 text-gray-500",children:["Selected: ",et.orientation==="horizontal"?"Horizontal":"Vertical"]}),c.jsxs("div",{className:"grid grid-cols-2 gap-2 mb-2",children:[c.jsxs("label",{className:"text-[10px]",children:[c.jsx("span",{className:"block mb-0.5",children:"x1"}),c.jsx("input",{type:"number",min:0,max:Math.max(0,((ke==null?void 0:ke.width)||1)-1),step:1,value:Math.round(et.p1.x),onChange:Y=>Ce==null?void 0:Ce(et.id,{...et.p1,x:Number(Y.target.value)},et.p2),className:"w-full border border-gray-400 dark:border-slate-600 bg-white dark:bg-slate-900 p-1"})]}),c.jsxs("label",{className:"text-[10px]",children:[c.jsx("span",{className:"block mb-0.5",children:"y1"}),c.jsx("input",{type:"number",min:0,max:Math.max(0,((ke==null?void 0:ke.height)||1)-1),step:1,value:Math.round(et.p1.y),onChange:Y=>Ce==null?void 0:Ce(et.id,{...et.p1,y:Number(Y.target.value)},et.p2),className:"w-full border border-gray-400 dark:border-slate-600 bg-white dark:bg-slate-900 p-1"})]}),c.jsxs("label",{className:"text-[10px]",children:[c.jsx("span",{className:"block mb-0.5",children:"x2"}),c.jsx("input",{type:"number",min:0,max:Math.max(0,((ke==null?void 0:ke.width)||1)-1),step:1,value:Math.round(et.p2.x),onChange:Y=>Ce==null?void 0:Ce(et.id,et.p1,{...et.p2,x:Number(Y.target.value)}),className:"w-full border border-gray-400 dark:border-slate-600 bg-white dark:bg-slate-900 p-1"})]}),c.jsxs("label",{className:"text-[10px]",children:[c.jsx("span",{className:"block mb-0.5",children:"y2"}),c.jsx("input",{type:"number",min:0,max:Math.max(0,((ke==null?void 0:ke.height)||1)-1),step:1,value:Math.round(et.p2.y),onChange:Y=>Ce==null?void 0:Ce(et.id,et.p1,{...et.p2,y:Number(Y.target.value)}),className:"w-full border border-gray-400 dark:border-slate-600 bg-white dark:bg-slate-900 p-1"})]})]}),c.jsx("button",{onClick:()=>ct==null?void 0:ct(et.id),className:"w-full px-2 py-1 bg-rose-700 text-white font-bold border border-black",children:"Delete Selected Guide"}),c.jsxs("div",{className:"grid grid-cols-2 gap-2 mt-2",children:[c.jsx("button",{onClick:()=>ze==null?void 0:ze("p1"),className:`px-2 py-1 font-bold border border-black ${ye==="p1"?"bg-amber-600 text-white":"bg-gray-200 dark:bg-slate-800 text-black dark:text-white"}`,children:"Pick P1"}),c.jsx("button",{onClick:()=>ze==null?void 0:ze("p2"),className:`px-2 py-1 font-bold border border-black ${ye==="p2"?"bg-amber-600 text-white":"bg-gray-200 dark:bg-slate-800 text-black dark:text-white"}`,children:"Pick P2"})]}),ye&&c.jsx("button",{onClick:()=>ot==null?void 0:ot(),className:"mt-2 w-full px-2 py-1 bg-gray-600 text-white font-bold border border-black",children:"Cancel Pick"})]}),c.jsx("button",{onClick:()=>Lt==null?void 0:Lt(),className:"mt-2 w-full px-2 py-1 bg-teal-700 text-white font-bold border border-black",children:"Apply Upright (4 Guides)"}),c.jsx("div",{className:"mt-2 text-[10px] text-gray-500",children:"Upright: set 4 guides for two horizontal and two vertical references."}),ye&&c.jsxs("div",{className:"mt-1 text-[10px] text-amber-600 dark:text-amber-400",children:["Click once on canvas to set ",ye.toUpperCase(),"."]}),c.jsxs("div",{className:"mt-3 border-t border-gray-300 dark:border-slate-700 pt-3",children:[c.jsx("div",{className:"text-xs font-bold text-gray-700 dark:text-slate-200 mb-2",children:"Lens Distortion Correction (Lensfun XML)"}),c.jsxs("label",{className:"flex items-center gap-2 text-[11px] mb-2 cursor-pointer",children:[c.jsx("input",{type:"checkbox",checked:Ss,onChange:Y=>vd(Y.target.checked)}),"Enable lens correction"]}),c.jsx("input",{ref:_t,type:"file",className:"hidden",accept:".xml,text/xml,application/xml",multiple:!0,onChange:Od}),c.jsx("button",{onClick:()=>{var Y;return(Y=_t.current)==null?void 0:Y.click()},className:"w-full px-2 py-1 bg-slate-700 text-white font-bold border border-black text-xs",children:"Load Extra Lensfun XML"}),c.jsx("div",{className:"mt-2 text-[10px] text-gray-500 dark:text-slate-400 break-words",children:Ml}),c.jsx("label",{className:"block text-[10px] mt-2 mb-1 text-gray-500 dark:text-slate-400",children:"Lens Profile"}),c.jsxs("select",{value:Qi,onChange:Y=>_o(Y.target.value),className:"w-full border border-gray-400 dark:border-slate-600 bg-white dark:bg-slate-900 p-1 text-xs",children:[Ji.length===0&&c.jsx("option",{value:"",children:"No profile loaded"}),Ji.map(Y=>c.jsx("option",{value:Y.id,children:Y.label},Y.id))]}),c.jsx("label",{className:"block text-[10px] mt-2 mb-1 text-gray-500 dark:text-slate-400",children:"Focal Length (mm)"}),c.jsx("input",{type:"number",min:.1,step:.1,value:ni,onChange:Y=>ks(Y.target.value),className:"w-full border border-gray-400 dark:border-slate-600 bg-white dark:bg-slate-900 p-1 text-xs",placeholder:"e.g. 35.0"}),c.jsx("button",{onClick:Ad,disabled:!Ss||!Qi||!pr,className:"mt-2 w-full px-2 py-1 bg-emerald-700 disabled:bg-gray-400 text-white font-bold border border-black text-xs",children:"Apply Lens Correction"})]})]})]}),G&&c.jsx(Rs,{title:"SFR Lab Tools (Scalar Unmixing)",children:c.jsxs("div",{className:"space-y-4",children:[c.jsxs("div",{className:"bg-orange-50 dark:bg-orange-900/20 p-3 rounded border border-orange-200 dark:border-orange-800",children:[c.jsx("h4",{className:"text-[10px] font-bold text-orange-600 dark:text-orange-400 uppercase mb-2",children:"Analyze ROI"}),c.jsx("p",{className:"text-[10px] text-gray-500 dark:text-slate-400 mb-2",children:"Select an edge on the main canvas and click analyze. Use the pop-up modal to view ESF/LSF/MTF."}),c.jsx("div",{className:"text-center text-xs font-bold text-orange-500",children:"(ROI Analysis Window is Active)"})]}),Td&&c.jsxs("div",{className:"border-t border-orange-200 dark:border-orange-800 pt-3",children:[c.jsxs("div",{className:"flex justify-between items-center cursor-pointer",onClick:()=>mi(!yn),children:[c.jsx("h4",{className:"text-[10px] font-bold text-orange-600 dark:text-orange-400 uppercase",children:" (Batch Ops)"}),c.jsx("svg",{className:`w-4 h-4 text-orange-500 transition-transform ${yn?"rotate-180":""}`,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),yn&&c.jsxs("div",{className:"mt-3 space-y-3 bg-white/50 dark:bg-black/20 p-2 rounded animate-in slide-in-from-top-1",children:[c.jsxs("div",{className:"flex flex-col gap-2",children:[c.jsx("span",{className:"text-[9px] font-bold text-gray-600 dark:text-gray-300",children:" (Standard Chart)"}),c.jsx("button",{onClick:Le,disabled:!!ee&&ee>0,className:`w-full py-2 border font-bold text-xs rounded transition-all ${ee&&ee>0?"bg-emerald-600 text-white border-emerald-500 animate-pulse":"bg-white dark:bg-slate-800 border-gray-300 dark:border-slate-600 text-gray-700 dark:text-gray-300 hover:bg-gray-100"}`,children:ee&&ee>0?`Click ${ee===1?"TL":ee===2?"TR":ee===3?"BL":"BR"}`:"Start Calibration (4-Pts)"}),!!ee&&ee>0&&c.jsx("p",{className:"text-[9px] text-emerald-600 dark:text-emerald-400 font-bold text-center",children:"Click corners: TopLeft  TopRight  BottomLeft  BottomRight"})]}),c.jsx("div",{className:"h-px bg-gray-300 dark:bg-slate-600 w-full"}),c.jsxs("div",{className:"flex flex-col gap-2",children:[c.jsxs("div",{className:"flex justify-between items-center",children:[c.jsx("span",{className:"text-[9px] font-bold text-gray-600 dark:text-gray-300",children:" (Manual Mark)"}),z!==void 0&&z>0&&c.jsxs("span",{className:"text-[9px] text-orange-500 font-bold",children:[z," Selected"]})]}),c.jsx("button",{onClick:te,className:`w-full py-2 font-bold text-xs rounded shadow transition-all ${q?"bg-orange-600 hover:bg-orange-500 text-white ring-2 ring-orange-300":"bg-white dark:bg-slate-800 border border-gray-300 dark:border-slate-600 text-gray-700 dark:text-gray-300 hover:bg-gray-100"}`,children:q?"Stop Marking (Active)":"Start Batch Marking"}),c.jsxs("div",{className:"flex gap-2",children:[c.jsxs("button",{onClick:fe,disabled:!z,className:"flex-1 py-1.5 border border-indigo-300 dark:border-indigo-700 text-indigo-700 dark:text-indigo-400 font-bold text-[10px] rounded hover:bg-indigo-50 dark:hover:bg-indigo-900/30 transition-colors disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-1",children:[c.jsx("svg",{className:"w-3 h-3",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7H5a2 2 0 00-2 2v9a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2h-3m-1 4l-3 3m0 0l-3-3m3 3V4"})})," (Save)"]}),c.jsx("input",{type:"file",ref:an,className:"hidden",accept:".csv",onChange:Os}),c.jsxs("button",{onClick:()=>{var Y;return(Y=an.current)==null?void 0:Y.click()},className:"flex-1 py-1.5 border border-emerald-300 dark:border-emerald-700 text-emerald-700 dark:text-emerald-400 font-bold text-[10px] rounded hover:bg-emerald-50 dark:hover:bg-emerald-900/30 transition-colors flex items-center justify-center gap-1",children:[c.jsx("svg",{className:"w-3 h-3",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-8l-4-4m0 0L8 8m4-4v12"})})," (Import)"]})]}),z!==void 0&&z>0&&c.jsxs("div",{className:"bg-gray-100 dark:bg-slate-800/50 p-2 rounded border border-gray-200 dark:border-slate-700 mt-1",children:[c.jsx("div",{className:"text-[9px] font-bold text-gray-500 text-center mb-1",children:"UNIFIED TRANSFORM"}),c.jsxs("div",{className:"flex gap-2 mb-2 justify-center",children:[c.jsxs("div",{className:"flex flex-col items-center",children:[c.jsx("span",{className:"text-[8px] text-gray-400",children:"Step (px)"}),c.jsx("input",{type:"number",min:"1",value:Qa,onChange:Y=>So(Number(Y.target.value)),className:"w-10 text-center text-[10px] bg-white dark:bg-slate-900 border rounded"})]}),c.jsxs("div",{className:"flex flex-col items-center",children:[c.jsx("span",{className:"text-[8px] text-gray-400",children:"Scale"}),c.jsx("input",{type:"number",step:"0.01",value:ei,onChange:Y=>ti(Number(Y.target.value)),className:"w-10 text-center text-[10px] bg-white dark:bg-slate-900 border rounded"})]})]}),c.jsxs("div",{className:"grid grid-cols-3 gap-1",children:[c.jsx("button",{onClick:()=>eo("scale",1/ei,1/ei),className:"bg-white dark:bg-slate-700 hover:bg-gray-200 rounded text-[10px] border dark:border-slate-600 font-bold",title:"Zoom Out (Shrink)",children:"-"}),c.jsx("button",{onClick:()=>eo("move",0,-Qa),className:"bg-white dark:bg-slate-700 hover:bg-gray-200 rounded text-[10px] border dark:border-slate-600",children:"^"}),c.jsx("button",{onClick:()=>eo("scale",ei,ei),className:"bg-white dark:bg-slate-700 hover:bg-gray-200 rounded text-[10px] border dark:border-slate-600 font-bold",title:"Zoom In (Expand)",children:"+"}),c.jsx("button",{onClick:()=>eo("move",-Qa,0),className:"bg-white dark:bg-slate-700 hover:bg-gray-200 rounded text-[10px] border dark:border-slate-600",children:""}),c.jsx("div",{className:"text-center text-[8px] text-gray-400 flex items-center justify-center",children:"Move"}),c.jsx("button",{onClick:()=>eo("move",Qa,0),className:"bg-white dark:bg-slate-700 hover:bg-gray-200 rounded text-[10px] border dark:border-slate-600",children:">"}),c.jsx("div",{}),c.jsx("button",{onClick:()=>eo("move",0,Qa),className:"bg-white dark:bg-slate-700 hover:bg-gray-200 rounded text-[10px] border dark:border-slate-600",children:"v"}),c.jsx("div",{})]})]}),q&&c.jsx("p",{className:"text-[9px] text-gray-400 italic text-center mt-1",children:"Hold Shift + Drag on canvas to add multiple ROIs."}),c.jsxs("div",{className:"flex flex-col gap-1 text-[10px] mt-2 bg-gray-100 dark:bg-slate-800/50 p-2 rounded",children:[c.jsxs("div",{className:"flex justify-between items-center",children:[c.jsxs("label",{className:"flex items-center gap-1 cursor-pointer",children:[c.jsx("input",{type:"checkbox",checked:qi,onChange:Y=>bs(Y.target.checked),className:"rounded text-orange-500"}),"Jiang Official NR"]}),c.jsxs("label",{className:"flex items-center gap-1 cursor-pointer",children:[c.jsx("input",{type:"checkbox",checked:xa,onChange:Y=>Zi(Y.target.checked),className:"rounded text-purple-500"}),"Deshading"]})]}),c.jsx("div",{className:"h-px bg-gray-200 dark:bg-slate-700 my-1"}),c.jsxs("label",{className:"flex items-center gap-1 cursor-pointer",title:"Only use Green channel points for projection (reduces color moire issues)",children:[c.jsx("input",{type:"checkbox",checked:yi,onChange:Y=>In(Y.target.checked),className:"rounded text-emerald-500"}),c.jsx("span",{className:"font-bold text-emerald-600 dark:text-emerald-400",children:"Green Channel Only (G Only)"})]})]}),c.jsxs("button",{onClick:Xo,disabled:!z,className:"w-full py-2 bg-indigo-600 hover:bg-indigo-500 disabled:bg-gray-300 disabled:text-gray-500 text-white font-bold text-xs rounded shadow transition-transform active:scale-95",children:["Calculate & Copy (",z||0,")"]}),c.jsx("button",{onClick:ie,disabled:!z,className:"w-full py-1.5 bg-gray-200 dark:bg-slate-700 hover:bg-red-100 hover:text-red-600 text-[10px] font-bold rounded transition-colors disabled:opacity-50",children:"Clear All Marks"})]})]})]}),c.jsx("div",{className:"h-px bg-gray-200 dark:bg-slate-700 w-full"}),c.jsx(vh,{checked:ue,onChange:ve,label:" (Scalar Unmixing)"}),ue&&c.jsxs("div",{className:"space-y-4 pl-2 border-l-2 border-indigo-200 dark:border-indigo-900 animate-in slide-in-from-top-2 duration-200",children:[c.jsxs("div",{className:"grid grid-cols-5 gap-1 items-center text-[9px] uppercase font-bold text-gray-400 mb-[-8px]",children:[c.jsx("div",{className:"col-span-1",children:"Param"}),c.jsx("div",{className:"text-center",children:"Ch0(R)"}),c.jsx("div",{className:"text-center",children:"Ch1(G1)"}),c.jsx("div",{className:"text-center",children:"Ch2(B)"}),c.jsx("div",{className:"text-center",children:"Ch3(G2)"})]}),c.jsxs("div",{className:"grid grid-cols-5 gap-2 items-center",children:[c.jsx("span",{className:"text-[10px] font-bold text-red-500",children:"BL:"}),c.jsx("input",{type:"text",value:be,onChange:Y=>{F(),ae(Y.target.value)},placeholder:"0 0 0 0",className:"col-span-4 px-2 py-1 bg-white dark:bg-slate-800 border border-gray-300 dark:border-slate-600 rounded text-xs font-mono text-gray-900 dark:text-slate-100"})]}),c.jsxs("div",{className:"grid grid-cols-5 gap-2 items-center",children:[c.jsx("span",{className:"text-[10px] font-bold text-indigo-500",children:"B ():"}),c.jsxs("div",{className:"col-span-4 flex gap-1",children:[c.jsx("input",{type:"text",value:$e,onChange:Y=>{F(),mt(Y.target.value)},className:"flex-1 px-2 py-1 bg-white dark:bg-slate-800 border border-gray-300 dark:border-slate-600 rounded text-xs font-mono text-gray-900 dark:text-slate-100"}),c.jsx("button",{onClick:Sd,className:"px-2 bg-gray-200 dark:bg-slate-700 hover:bg-gray-300 dark:hover:bg-slate-600 text-[9px] rounded font-bold transition-colors",title:"Fill with current ROI mean stats (Raw DN)",children:"Pick"})]})]}),c.jsxs("div",{className:"grid grid-cols-5 gap-2 items-center",children:[c.jsx("span",{className:"text-[10px] font-bold text-emerald-500",children:"F ():"}),c.jsxs("div",{className:"col-span-4 flex gap-1",children:[c.jsx("input",{type:"text",value:bt,onChange:Y=>{F(),Ot(Y.target.value)},className:"flex-1 px-2 py-1 bg-white dark:bg-slate-800 border border-gray-300 dark:border-slate-600 rounded text-xs font-mono text-gray-900 dark:text-slate-100"}),c.jsx("button",{onClick:Po,className:"px-2 bg-gray-200 dark:bg-slate-700 hover:bg-gray-300 dark:hover:bg-slate-600 text-[9px] rounded font-bold transition-colors",title:"Fill with current ROI mean stats (Raw DN)",children:"Pick"})]})]}),c.jsx("button",{onClick:Oc,disabled:!gt||!Ed,className:"w-full bg-indigo-600 hover:bg-indigo-500 text-white font-bold py-2 rounded text-[10px] shadow transition-transform active:scale-95 disabled:bg-gray-300 dark:disabled:bg-slate-800 disabled:text-gray-500 disabled:cursor-not-allowed",children:"RUN UNMIXING (ADV ZERO-DEP)"}),c.jsx("p",{className:"text-[9px] text-gray-400 italic text-center",children:"Basic render + sRGB gamma are applied."})]})]})}),_&&c.jsx(Rs,{title:"FFT Lab (Noise Profile)",children:c.jsxs("div",{className:"space-y-6",children:[c.jsxs("div",{className:"space-y-3 bg-gray-50 dark:bg-slate-800/40 p-3 rounded-xl border border-gray-100 dark:border-slate-800",children:[c.jsxs("h4",{className:"text-[10px] font-bold text-fuchsia-600 dark:text-fuchsia-400 uppercase tracking-widest flex items-center gap-2",children:[c.jsx("span",{className:"w-1.5 h-1.5 rounded-full bg-fuchsia-500"})," 1. Pair Difference (Sub)"]}),c.jsxs("div",{className:"flex flex-col gap-2",children:[c.jsx("input",{type:"file",ref:tn,className:"hidden",onChange:jd,accept:".arw,.cr2,.cr3,.dng,.nef,.orf,.raf,.rw2,.pef,.srw,.sr2,.srf,.x3f,.erf,.mef,.mos,.mrw,.kdc,.dcr,.iiq,.3fr,.fff,.rwl,.nrw,.raw,.tif,.tiff"}),c.jsx("button",{onClick:()=>{var Y;return(Y=tn.current)==null?void 0:Y.click()},className:`w-full py-2 px-3 rounded-lg border text-[10px] font-bold text-left truncate transition-colors ${rt?"bg-fuchsia-55 dark:bg-fuchsia-900/20 border-fuchsia-300 dark:border-fuchsia-800 text-fuchsia-700 dark:text-fuchsia-300":"bg-white dark:bg-slate-800 border-gray-300 dark:border-slate-600 text-gray-500 hover:bg-gray-50 dark:hover:bg-slate-700"}`,children:rt?`A: ${rt.name}`:"Load Image A"}),c.jsx("input",{type:"file",ref:Ca,className:"hidden",onChange:Pd,accept:".arw,.cr2,.cr3,.dng,.nef,.orf,.raf,.rw2,.pef,.srw,.sr2,.srf,.x3f,.erf,.mef,.mos,.mrw,.kdc,.dcr,.iiq,.3fr,.fff,.rwl,.nrw,.raw,.tif,.tiff"}),c.jsx("button",{onClick:()=>{var Y;return(Y=Ca.current)==null?void 0:Y.click()},className:`w-full py-2 px-3 rounded-lg border text-[10px] font-bold text-left truncate transition-colors ${Vt?"bg-fuchsia-55 dark:bg-fuchsia-900/20 border-fuchsia-300 dark:border-fuchsia-800 text-fuchsia-700 dark:text-fuchsia-300":"bg-white dark:bg-slate-800 border-gray-300 dark:border-slate-600 text-gray-500 hover:bg-gray-50 dark:hover:bg-slate-700"}`,children:Vt?`B: ${Vt.name}`:"Load Image B"})]}),c.jsx("div",{className:"flex flex-col gap-1.5 pt-1",children:c.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[c.jsx("input",{type:"checkbox",checked:ua,onChange:Y=>ri(Y.target.checked),className:"w-3 h-3 text-fuchsia-600 border-gray-300 rounded focus:ring-0"}),c.jsx("span",{className:"text-[10px] text-gray-600 dark:text-slate-300",children:"Normalize (?)"})]})}),c.jsxs("div",{className:"grid grid-cols-1 gap-2",children:[c.jsx("button",{onClick:Cd,disabled:!rt||!Vt,className:"w-full bg-fuchsia-600 hover:bg-fuchsia-500 disabled:opacity-30 text-white font-bold py-2 rounded shadow transition-all active:scale-95 text-[10px]",children:"Generate Diff & Load"}),c.jsx("input",{type:"file",ref:ws,className:"hidden",multiple:!0,accept:".arw,.cr2,.cr3,.dng,.nef,.orf,.raf,.rw2,.pef,.srw,.sr2,.srf,.x3f,.erf,.mef,.mos,.mrw,.kdc,.dcr,.iiq,.3fr,.fff,.rwl,.nrw,.raw,.tif,.tiff",onChange:Nl}),c.jsx("button",{onClick:()=>{var Y;return(Y=ws.current)==null?void 0:Y.click()},className:"w-full bg-slate-700 hover:bg-slate-600 text-white font-bold py-2 rounded shadow transition-all active:scale-95 text-[10px] flex items-center justify-center gap-1",children:"Batch Diffs (Auto Download)"})]})]}),c.jsxs("div",{className:"space-y-3 bg-gray-50 dark:bg-slate-800/40 p-3 rounded-xl border border-gray-100 dark:border-slate-800",children:[c.jsxs("h4",{className:"text-[10px] font-bold text-cyan-600 dark:text-cyan-400 uppercase tracking-widest flex items-center gap-2",children:[c.jsx("span",{className:"w-1.5 h-1.5 rounded-full bg-cyan-500"})," 2. Stack FFT (Avg PSD)"]}),c.jsxs("div",{className:"flex flex-col gap-2",children:[c.jsx("input",{type:"file",ref:Ma,className:"hidden",multiple:!0,onChange:Md,accept:".arw,.cr2,.cr3,.dng,.nef,.orf,.raf,.rw2,.pef,.srw,.sr2,.srf,.x3f,.erf,.mef,.mos,.mrw,.kdc,.dcr,.iiq,.3fr,.fff,.rwl,.nrw,.raw,.tif,.tiff"}),c.jsx("button",{onClick:()=>{var Y;return(Y=Ma.current)==null?void 0:Y.click()},className:"w-full py-3 bg-cyan-600 hover:bg-cyan-500 text-white font-bold rounded-lg shadow-md transition-all active:scale-95 text-[10px] flex items-center justify-center gap-2",children:"Select Sequence Files"})]})]}),c.jsxs("div",{className:"flex flex-col gap-2 pt-2 border-t border-gray-100 dark:border-slate-800",children:[c.jsx("button",{onClick:()=>{M==null||M(),B==null||B("crosscalc")},className:"w-full bg-indigo-600 hover:bg-indigo-500 text-white font-bold py-2 px-4 rounded-lg shadow-md transition-all active:scale-95 text-[10px] flex items-center justify-center gap-2",children:"Cross-Compensation Calc"}),c.jsx("button",{onClick:()=>{Ne==null||Ne(),B==null||B("stack tool")},className:"w-full bg-emerald-600 hover:bg-emerald-500 text-white font-bold py-2 px-4 rounded-lg shadow-md transition-all active:scale-95 text-[10px] flex items-center justify-center gap-2",children:"?(General Stack)"})]})]})}),s&&c.jsx(Rs,{title:"DR Lab Tools",children:c.jsxs("div",{className:"space-y-4",children:[c.jsx("button",{onClick:()=>{d==null||d(),B==null||B("gen test")},className:"w-full bg-amber-500 hover:bg-amber-600 text-white font-bold py-2 px-4 rounded-lg shadow-md transition-colors text-sm",children:"Generate Test Pic"}),c.jsxs("div",{className:"border-t border-gray-200 dark:border-slate-700 pt-3",children:[c.jsx("h4",{className:"text-xs font-bold text-gray-500 dark:text-slate-400 uppercase tracking-wide mb-2",children:"Grid Analysis"}),h&&f!==void 0&&c.jsx("div",{className:"flex items-center justify-between mb-3",children:c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx("span",{className:"text-sm text-gray-600 dark:text-slate-300",children:"Box Size:"}),c.jsx("input",{type:"number",min:"8",max:"512",step:"2",value:f,onChange:Y=>h(parseInt(Y.target.value)||64),className:"w-12 px-1 py-1 bg-white dark:bg-slate-800 border border-gray-300 dark:border-slate-600 rounded-md focus:ring-2 focus:ring-cyan-500 outline-none text-sm text-gray-900 dark:text-slate-100 text-center"}),c.jsx("span",{className:"text-xs text-gray-400",children:"px"})]})}),v&&b&&g!==void 0&&w!==void 0&&c.jsxs("div",{className:"flex items-center justify-between mb-3",children:[c.jsx("span",{className:"text-sm text-gray-600 dark:text-slate-400",children:"Layout:"}),c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx("input",{type:"number",min:"1",max:"50",value:g,onChange:Y=>v(Math.max(1,parseInt(Y.target.value)||1)),className:"w-10 px-1 py-1 bg-white dark:bg-slate-800 border border-gray-300 dark:border-slate-600 rounded-md outline-none text-sm text-center",title:"Rows"}),c.jsx("span",{className:"text-xs text-gray-400",children:"x"}),c.jsx("input",{type:"number",min:"1",max:"50",value:w,onChange:Y=>b(Math.max(1,parseInt(Y.target.value)||1)),className:"w-10 px-1 py-1 bg-white dark:bg-slate-800 border border-gray-300 dark:border-slate-600 rounded-md outline-none text-sm text-center",title:"Columns"})]})]}),c.jsxs("div",{className:"flex flex-col gap-2",children:[c.jsx("button",{onClick:()=>{u==null||u(),B==null||B("mark")},disabled:!gt||l!==void 0&&l>0,className:`w-full font-bold py-2 px-4 rounded-lg shadow-md transition-all text-sm ${gt?l&&l>0?"bg-indigo-100 dark:bg-indigo-900 text-indigo-700 dark:text-indigo-300 border-2 border-indigo-500":"bg-indigo-600 hover:bg-indigo-700 text-white":"bg-gray-300 text-gray-500 cursor-not-allowed"}`,children:l&&l>0?"Marking Active...":"Mark Corners"}),x&&c.jsxs(c.Fragment,{children:[c.jsx("input",{type:"file",ref:Bn,className:"hidden",multiple:!0,accept:".arw,.cr2,.cr3,.dng,.nef,.orf,.raf,.rw2,.pef,.srw,.sr2,.srf,.x3f,.erf,.mef,.mos,.mrw,.kdc,.dcr,.iiq,.3fr,.fff,.rwl,.nrw,.raw,.tif,.tiff",onChange:Ns}),c.jsxs("div",{className:"relative",children:[c.jsx("button",{onClick:()=>Jn(!xr),disabled:!y,className:"w-full font-bold py-2 px-4 rounded-lg shadow-md transition-all text-sm bg-emerald-600 hover:bg-emerald-700 disabled:bg-gray-300 disabled:text-gray-500 disabled:cursor-not-allowed text-white flex items-center justify-center gap-2",children:"Reuse Last & Batch"}),xr&&c.jsxs("div",{className:"absolute bottom-full left-0 w-full mb-1 bg-white dark:bg-slate-800 rounded-lg shadow-xl border border-gray-200 dark:border-slate-700 overflow-hidden z-20 flex flex-col animate-in fade-in zoom-in-95 duration-100",children:[c.jsx("button",{className:"px-4 py-2 text-left text-xs hover:bg-gray-100 dark:hover:bg-slate-700 text-gray-700 dark:text-slate-200 border-b border-gray-100 dark:border-slate-700",onClick:()=>{var Y;en("single"),(Y=Bn.current)==null||Y.click()},children:"1. Independent Frames"}),c.jsx("button",{className:"px-4 py-2 text-left text-xs hover:bg-gray-100 dark:hover:bg-slate-700 text-indigo-600 dark:text-indigo-400 font-bold",onClick:()=>{var Y;en("pair"),(Y=Bn.current)==null||Y.click()},children:"2. Pair Difference (A-B)"})]})]})]}),c.jsxs("div",{className:"pt-2 mt-2 border-t border-gray-100 dark:border-slate-800",children:[c.jsx("input",{type:"file",ref:Na,className:"hidden",accept:".txt",onChange:_d}),c.jsx("button",{onClick:()=>{var Y;return(Y=Na.current)==null?void 0:Y.click()},className:"w-full font-bold py-2 px-4 rounded-lg shadow-sm transition-all text-xs bg-slate-100 hover:bg-slate-200 dark:bg-slate-800 dark:hover:bg-slate-700 text-gray-600 dark:text-slate-300 flex items-center justify-center gap-2 border border-gray-300 dark:border-slate-600",children:"Convert Format (.txt  .csv)"})]})]}),l!==void 0&&l>0&&c.jsx("div",{className:"mt-2 text-center",children:c.jsxs("p",{className:"text-xs text-indigo-600 dark:text-indigo-400 font-bold animate-pulse",children:[l===1&&"Click Top-Left Center",l===2&&"Click Top-Right Center",l===3&&"Click Bottom-Left Center",l===4&&"Click Bottom-Right Center"]})})]})]})}),J&&c.jsx(Rs,{title:"Color Lab Tools",children:c.jsxs("div",{className:"space-y-4",children:[c.jsx("div",{className:"text-sm text-gray-600 dark:text-slate-300 mb-2",children:"Calibrate colors using a standard ColorChecker 24 chart."}),c.jsx("button",{onClick:()=>{I==null||I(),B==null||B("cl mark")},disabled:!gt||W!==void 0&&W>0,className:`w-full font-bold py-2 px-4 rounded-lg shadow-md transition-all text-sm ${gt?W&&W>0?"bg-yellow-100 dark:bg-yellow-900 text-yellow-700 dark:text-yellow-300 border-2 border-yellow-500":"bg-yellow-600 hover:bg-yellow-700 text-white":"bg-gray-300 text-gray-500 cursor-not-allowed"}`,children:W&&W>0?"Marking Active...":"Mark 24-Patch Chart"}),W!==void 0&&W>0&&c.jsx("div",{className:"mt-2 text-center",children:c.jsxs("p",{className:"text-xs text-yellow-600 dark:text-yellow-400 font-bold animate-pulse",children:[W===1&&"Click Top-Left (Brown)",W===2&&"Click Top-Right (Cyanish)",W===3&&"Click Bottom-Left (White)",W===4&&"Click Bottom-Right (Black)"]})})]})}),!pe&&c.jsx(Rs,{title:"Selection Tools",children:c.jsx("div",{className:"space-y-3",children:c.jsxs("div",{children:[c.jsx("label",{className:"text-xs font-bold text-gray-500 dark:text-slate-400 uppercase tracking-wide block mb-2",children:"Quick Select (or Shift+drag)"}),c.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[c.jsx("span",{className:"text-sm text-gray-600 dark:text-slate-300",children:"Size (px):"}),c.jsx("input",{type:"number",min:"1",value:Tn,onChange:Y=>Oi(Y.target.value),disabled:!gt,className:"flex-1 px-2 py-1 bg-white dark:bg-slate-800 border border-gray-300 dark:border-slate-600 rounded-md focus:ring-2 focus:ring-cyan-500 outline-none text-sm text-gray-900 dark:text-slate-100 transition-colors"})]}),c.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[c.jsx("button",{onClick:wd,disabled:!gt,className:"px-3 py-1.5 bg-gray-200 hover:bg-gray-300 dark:bg-slate-700 dark:hover:bg-slate-600 text-gray-800 dark:text-slate-200 text-xs font-semibold rounded transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:"Center Rect"}),c.jsx("button",{onClick:bd,disabled:!gt,className:"px-3 py-1.5 bg-gray-200 hover:bg-gray-300 dark:bg-slate-700 dark:hover:bg-slate-600 text-gray-800 dark:text-slate-200 text-xs font-semibold rounded transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:"Full Image"})]})]})})}),!pe&&c.jsx(Rs,{title:"Display Controls",children:c.jsxs("div",{className:"space-y-5",children:[c.jsxs("p",{className:"text-gray-500 dark:text-slate-400 text-center text-sm",children:["Adjust parameters and click ",c.jsx("b",{children:"Apply"}),"."]}),c.jsxs("div",{children:[c.jsx("label",{htmlFor:"exposure",className:"text-xs font-bold text-gray-500 dark:text-slate-400 uppercase tracking-wide block mb-2",children:"Exposure (EV)"}),c.jsx("div",{className:"flex items-center gap-2 mb-2",children:c.jsx("input",{type:"range",min:"-5",max:"5",step:"0.1",disabled:!gt,value:parseFloat(Ie)||0,onChange:Y=>Ps(Y.target.value),className:"w-full h-2 bg-gray-300 dark:bg-slate-700 rounded-lg appearance-none cursor-pointer accent-cyan-500 disabled:opacity-50"})}),c.jsx("div",{className:"flex items-center gap-2",children:c.jsx("input",{id:"exposure",type:"number",step:"0.1",value:Ie,onChange:Y=>Ps(Y.target.value),disabled:!gt,className:"w-full px-2 py-1 bg-white dark:bg-slate-800 border border-gray-300 dark:border-slate-600 rounded-md focus:ring-2 focus:ring-cyan-500 outline-none text-sm text-gray-900 dark:text-slate-100 transition-colors duration-300"})})]}),c.jsxs("div",{children:[c.jsx(vh,{checked:hr,onChange:Y=>{F(),fn(Y)},label:"Highlight Recovery"}),hr&&c.jsxs("div",{className:"mt-2 pl-2 border-l-2 border-orange-200 dark:border-orange-900 animate-in slide-in-from-top-1",children:[c.jsx("label",{className:"text-[10px] font-bold text-gray-500 dark:text-slate-400 uppercase block mb-1",children:"White Level (Clip Point)"}),c.jsx("input",{type:"number",value:Ln,onChange:Y=>{F(),Zn(Y.target.value)},className:"w-full px-2 py-1 bg-white dark:bg-slate-800 border border-gray-300 dark:border-slate-600 rounded-md focus:ring-2 focus:ring-orange-500 outline-none text-sm text-gray-900 dark:text-slate-100 transition-colors"})]})]}),lr&&c.jsxs("div",{className:"border-t border-gray-100 dark:border-slate-800 pt-2",children:[c.jsx(vh,{checked:!!$,onChange:Y=>{F(),T&&T(Y),B==null||B(`xtrans ${Y?"on":"off"}`)},label:"Force X-Trans (6x6 -> 2x2)"}),$&&A&&D&&c.jsxs("div",{className:"mt-2 pl-2 border-l-2 border-emerald-500/50 bg-emerald-50/20 dark:bg-emerald-900/10 p-2 rounded",children:[c.jsx("label",{className:"text-[9px] font-bold text-gray-500 dark:text-slate-400 uppercase block mb-1",children:"Phase Offset (Fine Tune)"}),c.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[c.jsxs("div",{className:"flex flex-col",children:[c.jsx("span",{className:"text-[9px] text-gray-400",children:"X (0-5)"}),c.jsx("input",{type:"number",min:"0",max:"5",value:A.x,onChange:Y=>{F();const Pe=Math.min(5,Math.max(0,parseInt(Y.target.value)||0));D({x:Pe}),B==null||B(`xtrans phase ${Pe} ${A.y}`)},className:"w-full text-xs px-1 py-0.5 bg-white dark:bg-slate-800 border border-gray-300 dark:border-slate-600 rounded text-center outline-none focus:border-cyan-500"})]}),c.jsxs("div",{className:"flex flex-col",children:[c.jsx("span",{className:"text-[9px] text-gray-400",children:"Y (0-5)"}),c.jsx("input",{type:"number",min:"0",max:"5",value:A.y,onChange:Y=>{F();const Pe=Math.min(5,Math.max(0,parseInt(Y.target.value)||0));D({y:Pe}),B==null||B(`xtrans phase ${A.x} ${Pe}`)},className:"w-full text-xs px-1 py-0.5 bg-white dark:bg-slate-800 border border-gray-300 dark:border-slate-600 rounded text-center outline-none focus:border-cyan-500"})]})]})]})]}),c.jsxs("div",{className:"space-y-5 pt-2 animate-in slide-in-from-top-2 duration-200 border-t border-gray-200 dark:border-slate-700",children:[c.jsxs("div",{children:[c.jsx(vh,{checked:cr,onChange:Y=>{F(),nr(Y)},label:"Show k"}),c.jsx("p",{className:"text-[10px] text-gray-400 dark:text-slate-500 mt-1"})]}),c.jsxs("div",{children:[c.jsxs("button",{onClick:Nc,disabled:!gt||!U,className:"w-full mb-3 px-3 py-1.5 bg-cyan-600 hover:bg-cyan-500 text-white text-xs font-bold rounded shadow-sm transition-all active:scale-95 disabled:bg-gray-300 dark:disabled:bg-slate-700 disabled:text-gray-500 dark:disabled:text-gray-500 disabled:cursor-not-allowed disabled:shadow-none flex items-center justify-center gap-2",title:"Calculate Gains to make the selected area neutral gray, accounting for Color Matrix",children:[c.jsx("svg",{className:"w-3.5 h-3.5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 10V3L4 14h7v7l9-11h-7z"})}),"Spot WB (Matrix-Aware)"]}),c.jsx("label",{className:"text-xs font-bold text-gray-500 dark:text-slate-400 uppercase tracking-wide block mb-2",children:"White Balance Gains"}),c.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[c.jsxs("div",{children:[c.jsx("span",{className:"text-xs text-red-500 dark:text-red-400 block mb-1",children:"Red"}),c.jsx("input",{type:"number",step:"0.01",value:Ir,onChange:Y=>Mc(Y.target.value),disabled:!gt,className:"w-full px-2 py-1 bg-white dark:bg-slate-800 border border-gray-300 dark:border-slate-600 rounded-md focus:ring-2 focus:ring-red-500 outline-none text-sm text-gray-900 dark:text-slate-100 transition-colors duration-300"})]}),c.jsxs("div",{children:[c.jsx("span",{className:"text-xs text-blue-500 dark:text-blue-400 block mb-1",children:"Blue"}),c.jsx("input",{type:"number",step:"0.01",value:Kt,onChange:Y=>xi(Y.target.value),disabled:!gt,className:"w-full px-2 py-1 bg-white dark:bg-slate-800 border border-gray-300 dark:border-slate-600 rounded-md focus:ring-2 focus:ring-blue-500 outline-none text-sm text-gray-900 dark:text-slate-100 transition-colors duration-300"})]})]})]}),c.jsxs("div",{children:[c.jsxs("div",{className:"flex justify-between items-end mb-2",children:[c.jsxs("label",{className:"text-xs font-bold text-gray-500 dark:text-slate-400 uppercase tracking-wide block mb-0 flex items-center",children:["Black Level (4-Ch)",c.jsx("span",{className:"ml-1 text-[10px] text-gray-400 dark:text-slate-500 font-normal normal-case",children:"Native"}),c.jsx("button",{onClick:()=>At(!0),className:"ml-2 text-[10px] text-cyan-600 dark:text-cyan-400 hover:text-cyan-700 dark:hover:text-cyan-300 hover:underline cursor-pointer transition-colors",title:"About Black Level Settings",children:"[about]"})]}),c.jsxs("div",{className:"flex items-center gap-1.5",title:"Subtract Black Level from ROI Mean stats (for display)",children:[c.jsx("span",{className:"text-[9px] font-mono text-gray-400 dark:text-slate-500 uppercase tracking-wide",children:"Sub. BL"}),c.jsx("div",{className:`relative w-8 h-4 rounded-full cursor-pointer transition-colors duration-200 ease-in-out ${Ar?"bg-cyan-500":"bg-gray-300 dark:bg-slate-700"}`,onClick:()=>{F(),qe(!Ar)},children:c.jsx("div",{className:`absolute top-0.5 left-0.5 bg-white w-3 h-3 rounded-full shadow-sm transform transition-transform duration-200 ${Ar?"translate-x-4":"translate-x-0"}`})})]})]}),c.jsx("input",{type:"text",value:Ye,onChange:Y=>{F(),Wt(Y.target.value)},disabled:!gt,placeholder:"0 0 0 0",className:"w-full px-2 py-1 bg-white dark:bg-slate-800 border border-gray-300 dark:border-slate-600 rounded-md focus:ring-2 focus:ring-cyan-500 outline-none text-xs font-mono text-gray-900 dark:text-slate-100 transition-colors duration-300",title:"Enter 4 values separated by space or comma"}),c.jsx("p",{className:"text-[10px] text-gray-400 dark:text-slate-500 mt-1",children:"Order: (0,0) (0,1) (1,0) (1,1). Spatial: TL, TR, BL, BR."})]}),c.jsxs("div",{children:[c.jsxs("div",{className:"flex justify-between items-end mb-2",children:[c.jsxs("label",{htmlFor:"customMatrix",className:"text-xs font-bold text-gray-500 dark:text-slate-400 uppercase tracking-wide block flex flex-col gap-1",children:[c.jsx("span",{children:"Custom Color Matrix"}),c.jsx("span",{className:"text-[9px] text-gray-400 dark:text-slate-500 font-normal normal-case",children:"XYZ to Camera RGB (3x3, 9 nums)"})]}),c.jsxs("select",{className:"text-[10px] bg-gray-100 dark:bg-gray-800 border border-black dark:border-gray-500 rounded-none px-1 py-0.5 max-w-[120px] cursor-pointer outline-none text-gray-700 dark:text-gray-300",onChange:Y=>{F();const Pe=ju[Y.target.value];Pe&&pt(Pe),Y.target.value=""},defaultValue:"",children:[c.jsx("option",{value:"",disabled:!0,children:"Select Camera..."}),La.map(Y=>c.jsx("option",{value:Y,children:Y},Y))]})]}),c.jsx("textarea",{id:"customMatrix",value:Ve,onChange:Fa,disabled:!gt,placeholder:"0.66 -0.19 -0.04  -0.46 1.23 0.25  -0.06 0.13 0.65",className:"w-full h-24 px-2 py-2 bg-white dark:bg-slate-800 border border-gray-300 dark:border-slate-600 rounded-md focus:ring-2 focus:ring-cyan-500 outline-none transition-colors disabled:bg-gray-100 dark:disabled:bg-slate-800/50 disabled:cursor-not-allowed text-xs font-mono leading-relaxed text-gray-900 dark:text-slate-100"})]})]}),c.jsxs("div",{className:"pt-4 flex flex-col gap-2",children:[c.jsx("button",{onClick:kd,disabled:!gt,className:"w-full text-sm font-bold bg-slate-700 hover:bg-slate-600 text-white disabled:bg-gray-300 dark:disabled:bg-slate-800 disabled:text-gray-500 transition-all py-4 rounded-xl flex items-center justify-center border-2 border-slate-500 shadow-lg",title:"Diagnostic Mode. Direct RAW-to-Grayscale mapping using manual Black Level & WB Gains (R/B calibration).",children:c.jsxs("span",{className:"text-center leading-tight",children:["Apply Settings / Render",c.jsx("br",{}),c.jsx("span",{className:"text-xs font-normal opacity-90",children:"Float-safe render path, avoids ROI drift and CM color artifacts"})]})}),c.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[c.jsxs("button",{onClick:()=>Wr(!0),disabled:!gt,className:"w-full text-xs font-bold bg-black text-gray-400 hover:bg-gray-800 hover:text-gray-300 dark:bg-black dark:text-gray-400 dark:hover:bg-gray-800 dark:hover:text-gray-300 disabled:bg-gray-300 dark:disabled:bg-slate-800 disabled:text-gray-500 disabled:cursor-not-allowed py-3 px-2 rounded-lg transition-all active:scale-95 border border-gray-700",children:["Try Official Render",c.jsx("br",{}),c.jsx("span",{className:"text-[10px] font-normal opacity-75",children:"(Not for analysis)"})]}),c.jsx("button",{onClick:()=>V==null?void 0:V(),disabled:!gt,className:"w-full text-xs font-bold bg-black text-gray-400 hover:bg-gray-800 hover:text-gray-300 dark:bg-black dark:text-gray-400 dark:hover:bg-gray-800 dark:hover:text-gray-300 disabled:bg-gray-300 dark:disabled:bg-slate-800 disabled:text-gray-500 disabled:cursor-not-allowed transition-all py-3 rounded-lg flex items-center justify-center border border-gray-700 active:scale-95",title:"Manual Lab Workstation: 16-bit Bit Shift and Manual DNG Container Packaging",children:"Generate 16bit DNG"})]}),c.jsx("div",{className:"text-center pt-1",children:c.jsx("button",{onClick:Cs,disabled:!gt,className:"text-xs text-gray-400 hover:text-gray-600 dark:text-slate-400 dark:hover:text-slate-200 disabled:text-gray-300 dark:disabled:text-slate-600 transition-colors underline decoration-gray-300 hover:decoration-gray-600 underline-offset-2",children:"Reset Defaults (Local)"})})]})]})})]}),c.jsx(dl,{isOpen:Bt,onClose:()=>At(!1),onConfirm:()=>{window.open("https://y-g-jiang.github.io/CBLD.html","_blank"),At(!1)},title:"Black Level Info / ",confirmText:"Visit Database (CBLD)",cancelText:"Close",message:c.jsxs("div",{className:"flex flex-col gap-4 text-left text-sm text-gray-600 dark:text-slate-300",children:[c.jsx("p",{className:"leading-relaxed",children:"JiangBridge  CBLD "}),c.jsx("div",{className:"h-px bg-gray-200 dark:bg-slate-700 w-full"}),c.jsx("p",{className:"leading-relaxed",children:"For best accuracy, capture a dark frame with the same ISO/shutter and measure the center ROI in this app."})]})}),c.jsx(dl,{isOpen:Kr,onClose:()=>jr(!1),onConfirm:()=>{},title:"Select Zero-Dependency Mode",confirmText:"",cancelText:"",message:c.jsxs("div",{className:"flex flex-col gap-4",children:[c.jsx("div",{className:"text-gray-600 dark:text-slate-300 text-left text-sm leading-relaxed mb-2",children:"Select how you want to visualize the raw data without full JOraw processing."}),c.jsxs("div",{className:"flex justify-between items-center mb-2 px-1",children:[c.jsx("span",{className:"text-xs font-bold text-gray-500 dark:text-slate-400 uppercase",children:"Bayer Pattern"}),c.jsxs("div",{className:"flex bg-gray-100 dark:bg-slate-800 p-1 rounded-lg border border-gray-200 dark:border-slate-700",children:[c.jsx("button",{onClick:()=>Rr(!1),className:`px-3 py-1 text-[10px] font-bold rounded transition-all ${Er?"text-gray-500 dark:text-slate-400":"bg-white dark:bg-slate-600 text-cyan-600 dark:text-cyan-400 shadow-sm"}`,children:"RGGB"}),c.jsx("button",{onClick:()=>Rr(!0),className:`px-3 py-1 text-[10px] font-bold rounded transition-all ${Er?"bg-white dark:bg-slate-600 text-cyan-600 dark:text-cyan-400 shadow-sm":"text-gray-500 dark:text-slate-400"}`,children:"BGGR"})]})]}),c.jsxs("div",{className:"flex justify-between items-center mb-2 px-1",children:[c.jsx("span",{className:"text-xs font-bold text-gray-500 dark:text-slate-400 uppercase",children:"Color Demosaic"}),c.jsxs("div",{className:"flex bg-gray-100 dark:bg-slate-800 p-1 rounded-lg border border-gray-200 dark:border-slate-700",children:[c.jsx("button",{onClick:()=>Mt("bilinear"),className:`px-3 py-1 text-[10px] font-bold rounded transition-all ${De==="bilinear"?"bg-white dark:bg-slate-600 text-cyan-600 dark:text-cyan-400 shadow-sm":"text-gray-500 dark:text-slate-400"}`,children:"Bilinear (Default)"}),c.jsx("button",{onClick:()=>Mt("edge-aware"),className:`px-3 py-1 text-[10px] font-bold rounded transition-all ${De==="edge-aware"?"bg-white dark:bg-slate-600 text-cyan-600 dark:text-cyan-400 shadow-sm":"text-gray-500 dark:text-slate-400"}`,children:"Edge-Aware"})]})]}),c.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[c.jsxs("button",{onClick:()=>vt("mosaic"),className:"flex flex-col items-center justify-center p-4 bg-gray-100 hover:bg-gray-200 dark:bg-slate-800 dark:hover:bg-slate-700 border-2 border-transparent hover:border-gray-400 dark:hover:border-slate-500 rounded-xl transition-all group",children:[c.jsx("div",{className:"w-12 h-12 bg-gray-300 dark:bg-slate-600 rounded-full flex items-center justify-center mb-3 group-hover:scale-110 transition-transform",children:c.jsx("svg",{className:"w-6 h-6 text-gray-600 dark:text-slate-300",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2H6a2 2 0 01-2-2V6zM14 6a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2V6zM4 16a2 2 0 012-2h2a2 2 0 01-2 2H6a2 2 0 01-2-2v-2zM14 16a2 2 0 012-2h2a2 2 0 01-2 2h-2a2 2 0 01-2-2v-2z"})})}),c.jsx("span",{className:"font-bold text-gray-800 dark:text-slate-200",children:"Raw Mosaic"}),c.jsx("span",{className:"text-xs text-gray-500 dark:text-slate-400 mt-1",children:"Grayscale checkerboard"})]}),c.jsxs("button",{onClick:()=>vt("color"),className:"flex flex-col items-center justify-center p-4 bg-gray-100 hover:bg-gray-200 dark:bg-slate-800 dark:hover:bg-slate-700 border-2 border-transparent hover:border-cyan-400 dark:hover:border-cyan-500 rounded-xl transition-all group",children:[c.jsx("div",{className:"w-12 h-12 bg-cyan-100 dark:bg-cyan-900/30 rounded-full flex items-center justify-center mb-3 group-hover:scale-110 transition-transform",children:c.jsx("svg",{className:"w-6 h-6 text-cyan-600 dark:text-cyan-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M7 21a4 4 0 01-4-4V5a2 2 0 012-2h4a2 2 0 012 2v12a4 4 0 01-4 4zm0 0h12a2 2 0 002-2v-4a2 2 0 00-2-2h-2.343M11 7.343l1.657-1.657a2 2 0 012.828 0l2.829 2.829a2 2 0 010 2.828l-8.486 8.485M7 17h.01"})})}),c.jsx("span",{className:"font-bold text-cyan-700 dark:text-cyan-400",children:"Basic Color"}),c.jsx("span",{className:"text-xs text-gray-500 dark:text-slate-400 mt-1",children:De==="edge-aware"?"Edge-Aware Demosaic + WB + Matrix":"Bilinear Demosaic + WB + Matrix"})]})]})]})}),c.jsx(dl,{isOpen:wt,onClose:()=>Wr(!1),onConfirm:()=>{Ms(),Wr(!1)},title:"Official Render Options",confirmText:"Render",message:c.jsxs("div",{className:"flex flex-col gap-4 text-left",children:[c.jsx("p",{className:"text-sm text-gray-600 dark:text-slate-300",children:"Select a demosaicing algorithm for the standard render pipeline."}),c.jsxs("div",{children:[c.jsx("label",{htmlFor:"demosaic-modal",className:"text-xs font-bold text-gray-500 dark:text-slate-400 uppercase tracking-wide block mb-2",children:"Demosaic Method"}),c.jsx("select",{id:"demosaic-modal",value:qr,onChange:Ba,disabled:!gt||N||(t==null?void 0:t.isXTrans),className:"w-full px-2 py-2 bg-white dark:bg-slate-800 border border-gray-300 dark:border-slate-600 rounded-md focus:ring-2 focus:ring-cyan-500 outline-none transition-colors disabled:bg-gray-100 dark:disabled:bg-slate-800/50 disabled:cursor-not-allowed text-sm text-gray-900 dark:text-slate-100",children:qT.map(Y=>c.jsx("option",{value:Y.value,children:Y.label},Y.value))}),N&&c.jsx("p",{className:"text-[9px] text-gray-400 mt-1",children:"Full color data detected. Demosaicing skipped."}),(t==null?void 0:t.isXTrans)&&c.jsx("p",{className:"text-[9px] text-amber-500 mt-1",children:"X-Trans detected. Please enable Pseudo-Bayer conversion first."})]})]})})]})},e8=P.forwardRef((e,t)=>{const{rawImageData:r,displaySettings:n,onApplyDisplaySettings:a,onSetSelection:i,onStartMarking:o,onGenerateTestPic:s,onBatchDrLab:l,onProcessPair:u,onProcessBatchDiff:d,onProcessStackFft:f,onOpenCrossCalc:h,onToggleXTrans:g,onXTransPhaseChange:v}=e,[w,b]=P.useState([{id:"init",type:"info",text:'Jiangtherapee CLI v1.0. Type "help" for commands.'}]),[x,y]=P.useState(""),[_,j]=P.useState([]),[S,k]=P.useState(-1),M=P.useRef(null),N=P.useRef(null),T=P.useRef(null),A=P.useRef(null),D=P.useRef(null),$=P.useRef(null),B=P.useRef(null),J=P.useRef(null);P.useRef(null);const W=P.useRef({...n});P.useEffect(()=>{W.current={...n}},[n.exposure,n.demosaicMethod]);const I=P.useRef({fileA:null,fileB:null});P.useLayoutEffect(()=>{M.current&&(M.current.scrollTop=M.current.scrollHeight)},[w]);const G=(te,ie="out")=>{b(he=>[...he,{id:Date.now().toString()+Math.random(),type:ie,text:te}])};P.useImperativeHandle(t,()=>({log:(te,ie="in")=>{const he=ie;let ee=te;ie==="in"&&!te.startsWith(">")&&(ee=`> ${te}`),G(ee,he)}}));const U=P.useRef(null);P.useEffect(()=>{if(e.roiStats&&e.roiStats!==U.current){const te=e.roiStats,ie=Math.round(te.x),he=Math.round(te.y),ee=Math.round(te.width),Le=Math.round(te.height);G(`> sel ${ie} ${he} ${ee} ${Le}`,"in");const fe=e.isBGGR?[{name:"B",idx:0},{name:"G1",idx:1},{name:"G2",idx:2},{name:"R",idx:3}]:[{name:"R",idx:0},{name:"G1",idx:1},{name:"G2",idx:2},{name:"B",idx:3}],ce=c.jsxs("div",{className:"font-mono text-xs mt-1 mb-2",children:[c.jsxs("div",{className:"text-gray-400 mb-1",children:["Region Stats [",ie,", ",he,", ",ee,"x",Le,"]:"]}),c.jsxs("div",{className:"grid grid-cols-[30px_1fr_1fr] gap-x-2 border-b border-gray-700 pb-1 mb-1 text-gray-500 font-bold",children:[c.jsx("div",{children:"Ch"}),c.jsx("div",{className:"text-right",children:"Mean"}),c.jsx("div",{className:"text-right",children:"StdDev"})]}),fe.map(de=>c.jsxs("div",{className:"grid grid-cols-[30px_1fr_1fr] gap-x-2 hover:bg-gray-900",children:[c.jsx("div",{className:de.name==="R"?"text-red-500":de.name==="B"?"text-blue-500":"text-green-500",children:de.name}),c.jsx("div",{className:"text-right text-gray-300",children:te.means[de.idx].toFixed(2)}),c.jsx("div",{className:"text-right text-gray-400",children:te.stdDevs[de.idx].toFixed(2)})]},de.name))]});G(ce,"out"),U.current=te}},[e.roiStats,e.isBGGR]);const X=te=>{var Le,fe,ce,de,Ne,pe,ke;const ie=te.trim().split(/\s+/),he=ie[0].toLowerCase(),ee=ie.slice(1);switch(he){case"help":G("Available Commands:","info"),G("  ev <val>          Set Exposure (e.g. ev 1.5)","info"),G("  wb <r> <b>        Set WB Gains","info"),G("  bl <r> <g>...     Set Black Level (1 or 4 vals)","info"),G("  demo <id>         Demosaic (0=Lin, 3=AHD, -1=Raw)","info"),G("  matrix <n1..n9>   Set Custom Color Matrix","info"),G("  xtrans <on|off>   Force X-Trans Mode","info"),G("  xtrans phase <x> <y>  Set X-Trans Phase","info"),G("  render            Apply settings & Render","info"),G("  render zero       Zero-Dependency Render","info"),G("  render unmix      Advanced Unmixing Render","info"),G("  sel <full|center> Select ROI","info"),G("  sel <x> <y> <w> <h> Select ROI manually","info"),G("  mark              Start DR Lab Corner Marking","info"),G("  gen test          Generate Test Pattern","info"),G("  fft load <a>      Load FFT Pair Image A","info"),G("  fft load <b>      Load FFT Pair Image B","info"),G("  fft run           Run FFT Pair Diff","info"),G("  cls               Clear Screen","info");break;case"cls":case"clear":b([]);break;case"ev":case"exposure":if(ee.length<1){G(`Current EV: ${W.current.exposure}`,"info");return}const me=parseFloat(ee[0]);if(isNaN(me)){G("Invalid EV value","err");return}W.current.exposure=me,G(`EV set to ${me} (run 'render' to apply)`);break;case"wb":if(ee.length<2){G("Usage: wb <red_gain> <blue_gain>","err");return}const Be=parseFloat(ee[0]),Se=parseFloat(ee[1]);if(isNaN(Be)||isNaN(Se)){G("Invalid gains","err");return}W.current.wbGains=[Be,Se],G(`WB set to R:${Be} B:${Se}`);break;case"bl":case"black":if(ee.length===0){G(`Current BL: ${((Le=W.current.blackLevel)==null?void 0:Le.join(" "))||"Auto"}`,"info");return}let we=ee.map(Number);if(we.some(isNaN)){G("Invalid numbers","err");return}if(we.length===1&&(we=[we[0],we[0],we[0],we[0]]),we.length<4){G("Need 1 or 4 values","err");return}W.current.blackLevel=[we[0],we[1],we[2],we[3]],W.current.subtractBlackLevelFromStats=!0,W.current.showKadc=!0,G(`Black Level set: ${we.slice(0,4).join(" ")}`);break;case"demo":case"demosaic":if(ee.length===0){G("Usage: demo <id> (0=Lin, 1=VNG, 2=PPG, 3=AHD, 4=DCB, 11=DHT, 12=AAHD, -1=Raw)","info");return}const Re=parseInt(ee[0]);if(isNaN(Re)){G("Invalid method ID","err");return}W.current.demosaicMethod=Re,G(`Demosaic set to ID ${Re}`);break;case"matrix":if(ee.length!==9){G("Usage: matrix m1 m2 m3 m4 m5 m6 m7 m8 m9 (3x3)","err");return}const it=ee.map(Number);if(it.some(isNaN)){G("Invalid matrix values","err");return}W.current.customMatrix=it,G("Custom Color Matrix set.");break;case"xtrans":if(ee[0]==="on"||ee[0]==="true")g?(g(!0),G("X-Trans conversion ON")):G("Feature not available","err");else if(ee[0]==="off"||ee[0]==="false")g?(g(!1),G("X-Trans conversion OFF")):G("Feature not available","err");else if(ee[0]==="phase"){if(ee.length<3){G("Usage: xtrans phase <x> <y>","err");return}const Qe=parseInt(ee[1]),se=parseInt(ee[2]);v&&(v({x:Qe,y:se}),G(`X-Trans Phase set to (${Qe}, ${se})`))}else G("Usage: xtrans <on|off> OR xtrans phase <x> <y>","err");break;case"render":case"apply":if(ee[0]==="zero"){const Qe=ee[1]==="color"?"zero-dep-color":"zero-dependency";W.current.renderMode=Qe,G(`Rendering Zero-Dependency (${Qe})...`)}else if(ee[0]==="unmix"){if(ee.length<13){G("Usage: render unmix <4xBL> <4xBG> <4xFG>","err");return}const Qe=ee.slice(1).map(Number);if(Qe.some(isNaN)){G("Invalid params","err");return}W.current.renderMode="advanced-zero-dep",W.current.advancedZeroDep={bl:[Qe[0],Qe[1],Qe[2],Qe[3]],bg:[Qe[4],Qe[5],Qe[6],Qe[7]],fg:[Qe[8],Qe[9],Qe[10],Qe[11]]},G("Rendering Advanced Unmix...")}else W.current.renderMode="standard",G("Rendering Standard Pipeline...");a({...W.current});break;case"sel":case"select":if(!r||!i){G("No image loaded","err");return}if(ee[0]==="full")i({x:0,y:0,w:r.width,h:r.height});else if(ee[0]==="center"){const Qe=parseInt(ee[1])||64,se=Math.floor((r.width-Qe)/2),Xe=Math.floor((r.height-Qe)/2);i({x:se,y:Xe,w:Qe,h:Qe})}else if(ee.length===4){const[Qe,se,Xe,ht]=ee.map(Number);if([Qe,se,Xe,ht].some(isNaN)){G("Invalid coordinates","err");return}i({x:Qe,y:se,w:Xe,h:ht})}else G("Usage: sel full | sel center <size> | sel <x> <y> <w> <h>","err");break;case"mark":o&&(o(),G("Interactive marking started. Click 4 corners on canvas."));break;case"gen":(ee[0]==="test"||ee[0]==="pattern")&&s&&(s(),G("Generated Test Pattern"));break;case"drlab":if(ee[0]==="config"){const[Qe,se,Xe]=ee.slice(1).map(Number);e.onDrRoiSizeChange&&e.onDrRoiSizeChange(Qe||64),e.onDrGridRowsChange&&e.onDrGridRowsChange(se||10),e.onDrGridColsChange&&e.onDrGridColsChange(Xe||10),G(`DR Grid Configured: Size=${Qe}, Grid=${se}x${Xe}`)}else ee[0]==="batch"&&(ee[1]==="pair"?(G("Select file pairs for DR Lab..."),(fe=A.current)==null||fe.click()):(G("Select single files for DR Lab..."),(ce=T.current)==null||ce.click()));break;case"fft":ee[0]==="load"?ee[1]==="a"?(de=D.current)==null||de.click():ee[1]==="b"?(Ne=$.current)==null||Ne.click():G("Usage: fft load <a|b>","err"):ee[0]==="run"?I.current.fileA&&I.current.fileB&&u?(G(`Processing Pair: ${I.current.fileA.name} - ${I.current.fileB.name}`),u(I.current.fileA,I.current.fileB,!1,!0)):G("Load both A and B first","err"):ee[0]==="stack"?(G("Select files for Stack FFT..."),(pe=B.current)==null||pe.click()):ee[0]==="batch"&&(G("Select files for Batch Diff...","info"),(ke=J.current)==null||ke.click());break;case"crosscalc":h&&(h(),G("Opened Cross-Calculator"));break;default:G(`Unknown command: ${he}`,"err")}},V=te=>{if(te.key==="Enter"){const ie=x.trim();if(!ie)return;G(`> ${ie}`,"in"),ie.split(";").forEach(ee=>{ee.trim()&&X(ee.trim())}),j(ee=>[...ee,ie]),k(-1),y("")}else if(te.key==="ArrowUp"){if(te.preventDefault(),_.length>0){const ie=S===-1?_.length-1:Math.max(0,S-1);k(ie),y(_[ie])}}else if(te.key==="ArrowDown")if(te.preventDefault(),S!==-1){const ie=Math.min(_.length-1,S+1);k(ie),y(_[ie])}else y("")},z=(te,ie)=>{te.target.files&&te.target.files.length>0&&l&&(G(`Batch processing ${te.target.files.length} files in ${ie} mode...`),l(te.target.files,ie)),te.target.value=""},q=(te,ie)=>{var ee;const he=(ee=te.target.files)==null?void 0:ee[0];he&&(ie==="A"?I.current.fileA=he:I.current.fileB=he,G(`Loaded ${ie}: ${he.name}`)),te.target.value=""};return c.jsxs("div",{className:"flex flex-col h-full bg-black text-green-500 font-mono text-sm border-l-4 border-gray-700 p-2 shadow-2xl",children:[c.jsxs("div",{className:"border-b border-green-800 pb-2 mb-2 flex justify-between items-end select-none",children:[c.jsx("h2",{className:"text-xl font-bold tracking-widest",children:"TERMINAL"}),c.jsx("div",{className:"text-[10px] text-green-700",children:"JIANGTHERAPEE_CLI_V1"})]}),c.jsx("div",{ref:M,className:"flex-grow overflow-y-auto overflow-x-hidden break-words mb-2 pr-1 scrollbar-thin scrollbar-thumb-green-900 scrollbar-track-black",children:w.map(te=>c.jsxs("div",{className:`mb-1 ${te.type==="in"?"opacity-50":""} ${te.type==="err"?"text-red-500":""} ${te.type==="info"?"text-cyan-400":""}`,children:[te.type!=="in"&&typeof te.text=="string"&&!te.text.startsWith(">")&&c.jsx("span",{className:"mr-2 opacity-50",children:">"}),te.text]},te.id))}),c.jsxs("div",{className:"relative flex items-center border-t border-green-800 pt-2",children:[c.jsx("span",{className:"text-green-500 mr-2 animate-pulse font-bold",children:">"}),c.jsx("input",{ref:N,type:"text",value:x,onChange:te=>y(te.target.value),onKeyDown:V,autoFocus:!0,className:"w-full bg-transparent border-none outline-none text-green-400 placeholder-green-900",placeholder:"Enter command (e.g. 'help')",spellCheck:!1,autoComplete:"off"})]}),c.jsx("input",{type:"file",ref:T,className:"hidden",multiple:!0,onChange:te=>z(te,"single")}),c.jsx("input",{type:"file",ref:A,className:"hidden",multiple:!0,onChange:te=>z(te,"pair")}),c.jsx("input",{type:"file",ref:D,className:"hidden",onChange:te=>q(te,"A")}),c.jsx("input",{type:"file",ref:$,className:"hidden",onChange:te=>q(te,"B")}),c.jsx("input",{type:"file",ref:B,className:"hidden",multiple:!0,onChange:te=>{e.onProcessStackFft&&te.target.files&&(G(`Loading ${te.target.files.length} frames for Stack FFT...`),e.onProcessStackFft(te.target.files)),te.target.value=""}}),c.jsx("input",{type:"file",ref:J,className:"hidden",multiple:!0,onChange:te=>{e.onProcessBatchDiff&&te.target.files&&(G("Starting Batch Diff..."),e.onProcessBatchDiff(te.target.files)),te.target.value=""}})]})}),t8=(e,t)=>{if(!e)return null;if(t){const r=e.bayerPattern.toUpperCase(),n=l=>{const u=[];for(let d=0;d<4;d++)r[d]===l&&u.push(d);return u},a=t.BlackLevelRed,i=t.BlackLevelGreen,o=t.BlackLevelBlue;if(a!==void 0&&i!==void 0&&o!==void 0){const l=parseFloat(a),u=parseFloat(i),d=parseFloat(o);if(!isNaN(l)&&!isNaN(u)&&!isNaN(d)){const f=[0,0,0,0];if(f.fill(u),n("R").forEach(h=>f[h]=l),n("G").forEach(h=>f[h]=u),n("B").forEach(h=>f[h]=d),f.some(h=>h>0))return f}}let s=t.BlackLevel;if(s===void 0&&(s=t.BlackLevel2),s!==void 0){let l=[];if(Array.isArray(s)?l=s.map(Number):typeof s=="string"?l=s.trim().split(/\s+/).map(Number):typeof s=="number"&&(l=[s,s,s,s]),l.length===1&&!isNaN(l[0])&&(l=[l[0],l[0],l[0],l[0]]),l.length>=4&&!l.slice(0,4).some(isNaN)&&l.some(u=>u>0))return[l[0],l[1],l[2],l[3]]}}return e.blackLevels&&e.blackLevels.length===4?[e.blackLevels[0],e.blackLevels[1],e.blackLevels[2],e.blackLevels[3]]:null},r8=e=>{const[t,r]=P.useState("gui"),{rawImageData:n,exifData:a,isBridgeConnected:i,displaySettings:o,onApplyDisplaySettings:s}=e,l=P.useRef(null),u=P.useRef(o);P.useEffect(()=>{u.current=o},[o]);const d=P.useRef(!1),f=P.useRef(null);P.useEffect(()=>{n!==f.current&&(d.current=!1,f.current=n)},[n]),P.useEffect(()=>{var _;if(!i||!n||d.current)return;const g=t8(n,a);if(!(!!g&&g.some(j=>j>0))||!g)return;const w=u.current,b=w.blackLevel;if(!!b&&b.some(j=>j>0)){d.current=!0;return}d.current=!0,console.log("[AutoApply] Detected Black Levels via Bridge:",g),(_=l.current)==null||_.log(`Auto-detected BL: ${g.join(" ")}`,"info");const y={...w,blackLevel:g};s(y)},[i,n,a,s]);const h=P.useCallback(g=>{var v;(v=l.current)==null||v.log(g,"in")},[]);return c.jsxs("div",{className:"flex flex-col h-full",children:[c.jsxs("div",{className:"flex bg-gray-200 dark:bg-gray-800 p-1 border-b border-gray-300 dark:border-gray-700 flex-shrink-0",children:[c.jsx("button",{onClick:()=>r("gui"),className:`flex-1 py-1 text-xs font-bold uppercase tracking-wider transition-colors border-r border-gray-300 dark:border-gray-700 ${t==="gui"?"bg-white dark:bg-black shadow-inner text-cyan-600 dark:text-cyan-400":"bg-gray-200 dark:bg-gray-900 text-gray-500 hover:text-gray-700 dark:hover:text-gray-300"}`,children:"GUI"}),c.jsx("button",{onClick:()=>r("terminal"),className:`flex-1 py-1 text-xs font-bold uppercase tracking-wider transition-colors ${t==="terminal"?"bg-black text-green-500 shadow-inner":"bg-gray-200 dark:bg-gray-900 text-gray-500 hover:text-gray-700 dark:hover:text-gray-300"}`,children:"Terminal"})]}),c.jsxs("div",{className:"flex-grow overflow-hidden relative",children:[c.jsx("div",{className:`h-full w-full ${t==="gui"?"block":"hidden"}`,children:c.jsx(QT,{...e,onCommand:h})}),c.jsx("div",{className:`h-full w-full ${t==="terminal"?"block":"hidden"}`,children:c.jsx(e8,{...e,ref:l})})]})]})},n8=()=>c.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M20 12H4"})}),a8=()=>c.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 4v16m8-8H4"})}),i8=()=>c.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M4 4v5h5M4 12a8 8 0 0114.24-5.12M20 20v-5h-5M20 12a8 8 0 01-14.24 5.12"})}),o8=()=>c.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M7 11.5V14m0-2.5v-6a1.5 1.5 0 113 0m-3 6a1.5 1.5 0 00-3 0v2a7.5 7.5 0 0015 0v-5a1.5 1.5 0 00-3 0m-6-3V11m0-5.5v-1a1.5 1.5 0 013 0v1m0 0V11m0-5.5a1.5 1.5 0 013 0v3m0 0V11"})}),s8=()=>c.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M4 8V4m0 0h4M4 4l5 5m11-1V4m0 0h-4m4 4l-5 5M4 16v4m0 0h4m-4 0l5-5m11 5l-5-5m5 5v-4m0 4h-4"})}),vv=.1,bv=16,l8=Math.log(vv),c8=Math.log(bv),u8=({zoom:e,onZoomChange:t,onResetView:r,touchAction:n,onToggleTouchAction:a})=>{const i=u=>{const d=parseFloat(u.target.value),f=Math.exp(d);t(Math.max(vv,Math.min(bv,f)))},o=()=>{t(Math.min(bv,e*1.25))},s=()=>{t(Math.max(vv,e/1.25))},l=Math.log(e);return c.jsxs("div",{className:"absolute top-4 right-4 flex gap-2",onClick:u=>u.stopPropagation(),children:[c.jsx("div",{className:"bg-white/90 dark:bg-slate-800/70 backdrop-blur-sm p-2 rounded-lg border border-gray-200 dark:border-slate-700 flex items-center shadow-lg transition-colors duration-300",children:c.jsx("button",{onClick:a,className:`p-1.5 rounded-md transition-colors flex items-center justify-center ${n==="select"?"bg-cyan-100 text-cyan-600 dark:bg-cyan-900/50 dark:text-cyan-400 ring-2 ring-cyan-500/50":"text-gray-500 dark:text-slate-400 hover:bg-gray-100 dark:hover:bg-slate-700"}`,title:n==="select"?"Mode: Selection (Drag to Select)":"Mode: Pan (Drag to Move)",children:n==="select"?c.jsx(s8,{}):c.jsx(o8,{})})}),c.jsxs("div",{className:"bg-white/90 dark:bg-slate-800/70 backdrop-blur-sm p-2 rounded-lg border border-gray-200 dark:border-slate-700 flex items-center gap-2 text-gray-700 dark:text-slate-300 shadow-lg transition-colors duration-300",children:[c.jsx("button",{onClick:s,className:"p-1 rounded-md hover:bg-gray-100 dark:hover:bg-slate-700 transition-colors",title:"Zoom Out","aria-label":"Zoom Out",children:c.jsx(n8,{})}),c.jsx("input",{type:"range",min:l8,max:c8,step:"0.01",value:l,onChange:i,className:"w-24 sm:w-32 h-2 bg-gray-300 dark:bg-slate-700 rounded-lg appearance-none cursor-pointer accent-cyan-500","aria-label":"Zoom slider"}),c.jsx("button",{onClick:o,className:"p-1 rounded-md hover:bg-gray-100 dark:hover:bg-slate-700 transition-colors",title:"Zoom In","aria-label":"Zoom In",children:c.jsx(a8,{})}),c.jsxs("span",{className:"w-16 text-center font-mono text-sm","aria-live":"polite",children:[(e*100).toFixed(0),"%"]}),c.jsx("button",{onClick:r,className:"p-1 rounded-md hover:bg-gray-100 dark:hover:bg-slate-700 transition-colors",title:"Reset View","aria-label":"Reset View",children:c.jsx(i8,{})})]})]})},d8=({theme:e,setTheme:t})=>{const r=()=>{t(e==="light"?"dark":"light")};return c.jsx("button",{onClick:r,className:"fixed bottom-6 right-6 z-50 p-3 rounded-full bg-white dark:bg-slate-800 border border-gray-200 dark:border-slate-700 shadow-lg text-gray-800 dark:text-yellow-400 hover:bg-gray-100 dark:hover:bg-slate-700 transition-all duration-300",title:`Switch to ${e==="light"?"dark":"light"} mode`,children:e==="light"?c.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6 text-slate-700",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003 0 0012 21a9.003 9.003 0 008.354-5.646z"})}):c.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z"})})})};function tC(e){var t,r,n="";if(typeof e=="string"||typeof e=="number")n+=e;else if(typeof e=="object")if(Array.isArray(e)){var a=e.length;for(t=0;t<a;t++)e[t]&&(r=tC(e[t]))&&(n&&(n+=" "),n+=r)}else for(r in e)e[r]&&(n&&(n+=" "),n+=r);return n}function Nr(){for(var e,t,r=0,n="",a=arguments.length;r<a;r++)(e=arguments[r])&&(t=tC(e))&&(n&&(n+=" "),n+=t);return n}var f8=Array.isArray,gi=f8,h8=typeof K0=="object"&&K0&&K0.Object===Object&&K0,rC=h8,p8=rC,g8=typeof self=="object"&&self&&self.Object===Object&&self,m8=p8||g8||Function("return this")(),Wo=m8,y8=Wo,x8=y8.Symbol,R0=x8,sS=R0,nC=Object.prototype,v8=nC.hasOwnProperty,b8=nC.toString,Kd=sS?sS.toStringTag:void 0;function w8(e){var t=v8.call(e,Kd),r=e[Kd];try{e[Kd]=void 0;var n=!0}catch{}var a=b8.call(e);return n&&(t?e[Kd]=r:delete e[Kd]),a}var k8=w8,S8=Object.prototype,_8=S8.toString;function j8(e){return _8.call(e)}var P8=j8,lS=R0,C8=k8,M8=P8,N8="[object Null]",O8="[object Undefined]",cS=lS?lS.toStringTag:void 0;function A8(e){return e==null?e===void 0?O8:N8:cS&&cS in Object(e)?C8(e):M8(e)}var ys=A8;function E8(e){return e!=null&&typeof e=="object"}var xs=E8,T8=ys,I8=xs,R8="[object Symbol]";function D8(e){return typeof e=="symbol"||I8(e)&&T8(e)==R8}var id=D8,$8=gi,L8=id,B8=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,F8=/^\w*$/;function U8(e,t){if($8(e))return!1;var r=typeof e;return r=="number"||r=="symbol"||r=="boolean"||e==null||L8(e)?!0:F8.test(e)||!B8.test(e)||t!=null&&e in Object(t)}var o2=U8;function G8(e){var t=typeof e;return e!=null&&(t=="object"||t=="function")}var wl=G8;const od=dn(wl);var z8=ys,W8=wl,V8="[object AsyncFunction]",H8="[object Function]",X8="[object GeneratorFunction]",K8="[object Proxy]";function Y8(e){if(!W8(e))return!1;var t=z8(e);return t==H8||t==X8||t==V8||t==K8}var s2=Y8;const ar=dn(s2);var q8=Wo,Z8=q8["__core-js_shared__"],J8=Z8,By=J8,uS=function(){var e=/[^.]+$/.exec(By&&By.keys&&By.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}();function Q8(e){return!!uS&&uS in e}var eI=Q8,tI=Function.prototype,rI=tI.toString;function nI(e){if(e!=null){try{return rI.call(e)}catch{}try{return e+""}catch{}}return""}var aC=nI,aI=s2,iI=eI,oI=wl,sI=aC,lI=/[\\^$.*+?()[\]{}|]/g,cI=/^\[object .+?Constructor\]$/,uI=Function.prototype,dI=Object.prototype,fI=uI.toString,hI=dI.hasOwnProperty,pI=RegExp("^"+fI.call(hI).replace(lI,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function gI(e){if(!oI(e)||iI(e))return!1;var t=aI(e)?pI:cI;return t.test(sI(e))}var mI=gI;function yI(e,t){return e==null?void 0:e[t]}var xI=yI,vI=mI,bI=xI;function wI(e,t){var r=bI(e,t);return vI(r)?r:void 0}var kc=wI,kI=kc,SI=kI(Object,"create"),rm=SI,dS=rm;function _I(){this.__data__=dS?dS(null):{},this.size=0}var jI=_I;function PI(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t}var CI=PI,MI=rm,NI="__lodash_hash_undefined__",OI=Object.prototype,AI=OI.hasOwnProperty;function EI(e){var t=this.__data__;if(MI){var r=t[e];return r===NI?void 0:r}return AI.call(t,e)?t[e]:void 0}var TI=EI,II=rm,RI=Object.prototype,DI=RI.hasOwnProperty;function $I(e){var t=this.__data__;return II?t[e]!==void 0:DI.call(t,e)}var LI=$I,BI=rm,FI="__lodash_hash_undefined__";function UI(e,t){var r=this.__data__;return this.size+=this.has(e)?0:1,r[e]=BI&&t===void 0?FI:t,this}var GI=UI,zI=jI,WI=CI,VI=TI,HI=LI,XI=GI;function sd(e){var t=-1,r=e==null?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}sd.prototype.clear=zI;sd.prototype.delete=WI;sd.prototype.get=VI;sd.prototype.has=HI;sd.prototype.set=XI;var KI=sd;function YI(){this.__data__=[],this.size=0}var qI=YI;function ZI(e,t){return e===t||e!==e&&t!==t}var l2=ZI,JI=l2;function QI(e,t){for(var r=e.length;r--;)if(JI(e[r][0],t))return r;return-1}var nm=QI,eR=nm,tR=Array.prototype,rR=tR.splice;function nR(e){var t=this.__data__,r=eR(t,e);if(r<0)return!1;var n=t.length-1;return r==n?t.pop():rR.call(t,r,1),--this.size,!0}var aR=nR,iR=nm;function oR(e){var t=this.__data__,r=iR(t,e);return r<0?void 0:t[r][1]}var sR=oR,lR=nm;function cR(e){return lR(this.__data__,e)>-1}var uR=cR,dR=nm;function fR(e,t){var r=this.__data__,n=dR(r,e);return n<0?(++this.size,r.push([e,t])):r[n][1]=t,this}var hR=fR,pR=qI,gR=aR,mR=sR,yR=uR,xR=hR;function ld(e){var t=-1,r=e==null?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}ld.prototype.clear=pR;ld.prototype.delete=gR;ld.prototype.get=mR;ld.prototype.has=yR;ld.prototype.set=xR;var am=ld,vR=kc,bR=Wo,wR=vR(bR,"Map"),c2=wR,fS=KI,kR=am,SR=c2;function _R(){this.size=0,this.__data__={hash:new fS,map:new(SR||kR),string:new fS}}var jR=_R;function PR(e){var t=typeof e;return t=="string"||t=="number"||t=="symbol"||t=="boolean"?e!=="__proto__":e===null}var CR=PR,MR=CR;function NR(e,t){var r=e.__data__;return MR(t)?r[typeof t=="string"?"string":"hash"]:r.map}var im=NR,OR=im;function AR(e){var t=OR(this,e).delete(e);return this.size-=t?1:0,t}var ER=AR,TR=im;function IR(e){return TR(this,e).get(e)}var RR=IR,DR=im;function $R(e){return DR(this,e).has(e)}var LR=$R,BR=im;function FR(e,t){var r=BR(this,e),n=r.size;return r.set(e,t),this.size+=r.size==n?0:1,this}var UR=FR,GR=jR,zR=ER,WR=RR,VR=LR,HR=UR;function cd(e){var t=-1,r=e==null?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}cd.prototype.clear=GR;cd.prototype.delete=zR;cd.prototype.get=WR;cd.prototype.has=VR;cd.prototype.set=HR;var u2=cd,iC=u2,XR="Expected a function";function d2(e,t){if(typeof e!="function"||t!=null&&typeof t!="function")throw new TypeError(XR);var r=function(){var n=arguments,a=t?t.apply(this,n):n[0],i=r.cache;if(i.has(a))return i.get(a);var o=e.apply(this,n);return r.cache=i.set(a,o)||i,o};return r.cache=new(d2.Cache||iC),r}d2.Cache=iC;var oC=d2;const KR=dn(oC);var YR=oC,qR=500;function ZR(e){var t=YR(e,function(n){return r.size===qR&&r.clear(),n}),r=t.cache;return t}var JR=ZR,QR=JR,eD=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,tD=/\\(\\)?/g,rD=QR(function(e){var t=[];return e.charCodeAt(0)===46&&t.push(""),e.replace(eD,function(r,n,a,i){t.push(a?i.replace(tD,"$1"):n||r)}),t}),nD=rD;function aD(e,t){for(var r=-1,n=e==null?0:e.length,a=Array(n);++r<n;)a[r]=t(e[r],r,e);return a}var f2=aD,hS=R0,iD=f2,oD=gi,sD=id,pS=hS?hS.prototype:void 0,gS=pS?pS.toString:void 0;function sC(e){if(typeof e=="string")return e;if(oD(e))return iD(e,sC)+"";if(sD(e))return gS?gS.call(e):"";var t=e+"";return t=="0"&&1/e==-1/0?"-0":t}var lD=sC,cD=lD;function uD(e){return e==null?"":cD(e)}var lC=uD,dD=gi,fD=o2,hD=nD,pD=lC;function gD(e,t){return dD(e)?e:fD(e,t)?[e]:hD(pD(e))}var cC=gD,mD=id;function yD(e){if(typeof e=="string"||mD(e))return e;var t=e+"";return t=="0"&&1/e==-1/0?"-0":t}var om=yD,xD=cC,vD=om;function bD(e,t){t=xD(t,e);for(var r=0,n=t.length;e!=null&&r<n;)e=e[vD(t[r++])];return r&&r==n?e:void 0}var h2=bD,wD=h2;function kD(e,t,r){var n=e==null?void 0:wD(e,t);return n===void 0?r:n}var uC=kD;const Wi=dn(uC);function SD(e){return e==null}var _D=SD;const qt=dn(_D);var jD=ys,PD=gi,CD=xs,MD="[object String]";function ND(e){return typeof e=="string"||!PD(e)&&CD(e)&&jD(e)==MD}var OD=ND;const hc=dn(OD);var dC={exports:{}},nn={};/**
 * @license React
 * react-is.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var p2=Symbol.for("react.element"),g2=Symbol.for("react.portal"),sm=Symbol.for("react.fragment"),lm=Symbol.for("react.strict_mode"),cm=Symbol.for("react.profiler"),um=Symbol.for("react.provider"),dm=Symbol.for("react.context"),AD=Symbol.for("react.server_context"),fm=Symbol.for("react.forward_ref"),hm=Symbol.for("react.suspense"),pm=Symbol.for("react.suspense_list"),gm=Symbol.for("react.memo"),mm=Symbol.for("react.lazy"),ED=Symbol.for("react.offscreen"),fC;fC=Symbol.for("react.module.reference");function Ki(e){if(typeof e=="object"&&e!==null){var t=e.$$typeof;switch(t){case p2:switch(e=e.type,e){case sm:case cm:case lm:case hm:case pm:return e;default:switch(e=e&&e.$$typeof,e){case AD:case dm:case fm:case mm:case gm:case um:return e;default:return t}}case g2:return t}}}nn.ContextConsumer=dm;nn.ContextProvider=um;nn.Element=p2;nn.ForwardRef=fm;nn.Fragment=sm;nn.Lazy=mm;nn.Memo=gm;nn.Portal=g2;nn.Profiler=cm;nn.StrictMode=lm;nn.Suspense=hm;nn.SuspenseList=pm;nn.isAsyncMode=function(){return!1};nn.isConcurrentMode=function(){return!1};nn.isContextConsumer=function(e){return Ki(e)===dm};nn.isContextProvider=function(e){return Ki(e)===um};nn.isElement=function(e){return typeof e=="object"&&e!==null&&e.$$typeof===p2};nn.isForwardRef=function(e){return Ki(e)===fm};nn.isFragment=function(e){return Ki(e)===sm};nn.isLazy=function(e){return Ki(e)===mm};nn.isMemo=function(e){return Ki(e)===gm};nn.isPortal=function(e){return Ki(e)===g2};nn.isProfiler=function(e){return Ki(e)===cm};nn.isStrictMode=function(e){return Ki(e)===lm};nn.isSuspense=function(e){return Ki(e)===hm};nn.isSuspenseList=function(e){return Ki(e)===pm};nn.isValidElementType=function(e){return typeof e=="string"||typeof e=="function"||e===sm||e===cm||e===lm||e===hm||e===pm||e===ED||typeof e=="object"&&e!==null&&(e.$$typeof===mm||e.$$typeof===gm||e.$$typeof===um||e.$$typeof===dm||e.$$typeof===fm||e.$$typeof===fC||e.getModuleId!==void 0)};nn.typeOf=Ki;dC.exports=nn;var TD=dC.exports,ID=ys,RD=xs,DD="[object Number]";function $D(e){return typeof e=="number"||RD(e)&&ID(e)==DD}var hC=$D;const LD=dn(hC);var BD=hC;function FD(e){return BD(e)&&e!=+e}var UD=FD;const ud=dn(UD);var go=function(t){return t===0?0:t>0?1:-1},zl=function(t){return hc(t)&&t.indexOf("%")===t.length-1},We=function(t){return LD(t)&&!ud(t)},GD=function(t){return qt(t)},sa=function(t){return We(t)||hc(t)},zD=0,Sc=function(t){var r=++zD;return"".concat(t||"").concat(r)},pc=function(t,r){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(!We(t)&&!hc(t))return n;var i;if(zl(t)){var o=t.indexOf("%");i=r*parseFloat(t.slice(0,o))/100}else i=+t;return ud(i)&&(i=n),a&&i>r&&(i=r),i},Vs=function(t){if(!t)return null;var r=Object.keys(t);return r&&r.length?t[r[0]]:null},WD=function(t){if(!Array.isArray(t))return!1;for(var r=t.length,n={},a=0;a<r;a++)if(!n[t[a]])n[t[a]]=!0;else return!0;return!1},Un=function(t,r){return We(t)&&We(r)?function(n){return t+n*(r-t)}:function(){return r}};function Np(e,t,r){return!e||!e.length?null:e.find(function(n){return n&&(typeof t=="function"?t(n):Wi(n,t))===r})}var VD=function(t){if(!t||!t.length)return null;for(var r=t.length,n=0,a=0,i=0,o=0,s=1/0,l=-1/0,u=0,d=0,f=0;f<r;f++)u=t[f].cx||0,d=t[f].cy||0,n+=u,a+=d,i+=u*d,o+=u*u,s=Math.min(s,u),l=Math.max(l,u);var h=r*o!==n*n?(r*i-n*a)/(r*o-n*n):0;return{xmin:s,xmax:l,a:h,b:(a-h*n)/r}},HD=function(t,r){return We(t)&&We(r)?t-r:hc(t)&&hc(r)?t.localeCompare(r):t instanceof Date&&r instanceof Date?t.getTime()-r.getTime():String(t).localeCompare(String(r))};function hu(e,t){for(var r in e)if({}.hasOwnProperty.call(e,r)&&(!{}.hasOwnProperty.call(t,r)||e[r]!==t[r]))return!1;for(var n in t)if({}.hasOwnProperty.call(t,n)&&!{}.hasOwnProperty.call(e,n))return!1;return!0}function wv(e){"@babel/helpers - typeof";return wv=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},wv(e)}var XD=["viewBox","children"],KD=["aria-activedescendant","aria-atomic","aria-autocomplete","aria-busy","aria-checked","aria-colcount","aria-colindex","aria-colspan","aria-controls","aria-current","aria-describedby","aria-details","aria-disabled","aria-errormessage","aria-expanded","aria-flowto","aria-haspopup","aria-hidden","aria-invalid","aria-keyshortcuts","aria-label","aria-labelledby","aria-level","aria-live","aria-modal","aria-multiline","aria-multiselectable","aria-orientation","aria-owns","aria-placeholder","aria-posinset","aria-pressed","aria-readonly","aria-relevant","aria-required","aria-roledescription","aria-rowcount","aria-rowindex","aria-rowspan","aria-selected","aria-setsize","aria-sort","aria-valuemax","aria-valuemin","aria-valuenow","aria-valuetext","className","color","height","id","lang","max","media","method","min","name","style","target","width","role","tabIndex","accentHeight","accumulate","additive","alignmentBaseline","allowReorder","alphabetic","amplitude","arabicForm","ascent","attributeName","attributeType","autoReverse","azimuth","baseFrequency","baselineShift","baseProfile","bbox","begin","bias","by","calcMode","capHeight","clip","clipPath","clipPathUnits","clipRule","colorInterpolation","colorInterpolationFilters","colorProfile","colorRendering","contentScriptType","contentStyleType","cursor","cx","cy","d","decelerate","descent","diffuseConstant","direction","display","divisor","dominantBaseline","dur","dx","dy","edgeMode","elevation","enableBackground","end","exponent","externalResourcesRequired","fill","fillOpacity","fillRule","filter","filterRes","filterUnits","floodColor","floodOpacity","focusable","fontFamily","fontSize","fontSizeAdjust","fontStretch","fontStyle","fontVariant","fontWeight","format","from","fx","fy","g1","g2","glyphName","glyphOrientationHorizontal","glyphOrientationVertical","glyphRef","gradientTransform","gradientUnits","hanging","horizAdvX","horizOriginX","href","ideographic","imageRendering","in2","in","intercept","k1","k2","k3","k4","k","kernelMatrix","kernelUnitLength","kerning","keyPoints","keySplines","keyTimes","lengthAdjust","letterSpacing","lightingColor","limitingConeAngle","local","markerEnd","markerHeight","markerMid","markerStart","markerUnits","markerWidth","mask","maskContentUnits","maskUnits","mathematical","mode","numOctaves","offset","opacity","operator","order","orient","orientation","origin","overflow","overlinePosition","overlineThickness","paintOrder","panose1","pathLength","patternContentUnits","patternTransform","patternUnits","pointerEvents","pointsAtX","pointsAtY","pointsAtZ","preserveAlpha","preserveAspectRatio","primitiveUnits","r","radius","refX","refY","renderingIntent","repeatCount","repeatDur","requiredExtensions","requiredFeatures","restart","result","rotate","rx","ry","seed","shapeRendering","slope","spacing","specularConstant","specularExponent","speed","spreadMethod","startOffset","stdDeviation","stemh","stemv","stitchTiles","stopColor","stopOpacity","strikethroughPosition","strikethroughThickness","string","stroke","strokeDasharray","strokeDashoffset","strokeLinecap","strokeLinejoin","strokeMiterlimit","strokeOpacity","strokeWidth","surfaceScale","systemLanguage","tableValues","targetX","targetY","textAnchor","textDecoration","textLength","textRendering","to","transform","u1","u2","underlinePosition","underlineThickness","unicode","unicodeBidi","unicodeRange","unitsPerEm","vAlphabetic","values","vectorEffect","version","vertAdvY","vertOriginX","vertOriginY","vHanging","vIdeographic","viewTarget","visibility","vMathematical","widths","wordSpacing","writingMode","x1","x2","x","xChannelSelector","xHeight","xlinkActuate","xlinkArcrole","xlinkHref","xlinkRole","xlinkShow","xlinkTitle","xlinkType","xmlBase","xmlLang","xmlns","xmlnsXlink","xmlSpace","y1","y2","y","yChannelSelector","z","zoomAndPan","ref","key","angle"],mS=["points","pathLength"],Fy={svg:XD,polygon:mS,polyline:mS},m2=["dangerouslySetInnerHTML","onCopy","onCopyCapture","onCut","onCutCapture","onPaste","onPasteCapture","onCompositionEnd","onCompositionEndCapture","onCompositionStart","onCompositionStartCapture","onCompositionUpdate","onCompositionUpdateCapture","onFocus","onFocusCapture","onBlur","onBlurCapture","onChange","onChangeCapture","onBeforeInput","onBeforeInputCapture","onInput","onInputCapture","onReset","onResetCapture","onSubmit","onSubmitCapture","onInvalid","onInvalidCapture","onLoad","onLoadCapture","onError","onErrorCapture","onKeyDown","onKeyDownCapture","onKeyPress","onKeyPressCapture","onKeyUp","onKeyUpCapture","onAbort","onAbortCapture","onCanPlay","onCanPlayCapture","onCanPlayThrough","onCanPlayThroughCapture","onDurationChange","onDurationChangeCapture","onEmptied","onEmptiedCapture","onEncrypted","onEncryptedCapture","onEnded","onEndedCapture","onLoadedData","onLoadedDataCapture","onLoadedMetadata","onLoadedMetadataCapture","onLoadStart","onLoadStartCapture","onPause","onPauseCapture","onPlay","onPlayCapture","onPlaying","onPlayingCapture","onProgress","onProgressCapture","onRateChange","onRateChangeCapture","onSeeked","onSeekedCapture","onSeeking","onSeekingCapture","onStalled","onStalledCapture","onSuspend","onSuspendCapture","onTimeUpdate","onTimeUpdateCapture","onVolumeChange","onVolumeChangeCapture","onWaiting","onWaitingCapture","onAuxClick","onAuxClickCapture","onClick","onClickCapture","onContextMenu","onContextMenuCapture","onDoubleClick","onDoubleClickCapture","onDrag","onDragCapture","onDragEnd","onDragEndCapture","onDragEnter","onDragEnterCapture","onDragExit","onDragExitCapture","onDragLeave","onDragLeaveCapture","onDragOver","onDragOverCapture","onDragStart","onDragStartCapture","onDrop","onDropCapture","onMouseDown","onMouseDownCapture","onMouseEnter","onMouseLeave","onMouseMove","onMouseMoveCapture","onMouseOut","onMouseOutCapture","onMouseOver","onMouseOverCapture","onMouseUp","onMouseUpCapture","onSelect","onSelectCapture","onTouchCancel","onTouchCancelCapture","onTouchEnd","onTouchEndCapture","onTouchMove","onTouchMoveCapture","onTouchStart","onTouchStartCapture","onPointerDown","onPointerDownCapture","onPointerMove","onPointerMoveCapture","onPointerUp","onPointerUpCapture","onPointerCancel","onPointerCancelCapture","onPointerEnter","onPointerEnterCapture","onPointerLeave","onPointerLeaveCapture","onPointerOver","onPointerOverCapture","onPointerOut","onPointerOutCapture","onGotPointerCapture","onGotPointerCaptureCapture","onLostPointerCapture","onLostPointerCaptureCapture","onScroll","onScrollCapture","onWheel","onWheelCapture","onAnimationStart","onAnimationStartCapture","onAnimationEnd","onAnimationEndCapture","onAnimationIteration","onAnimationIterationCapture","onTransitionEnd","onTransitionEndCapture"],Op=function(t,r){if(!t||typeof t=="function"||typeof t=="boolean")return null;var n=t;if(P.isValidElement(t)&&(n=t.props),!od(n))return null;var a={};return Object.keys(n).forEach(function(i){m2.includes(i)&&(a[i]=r||function(o){return n[i](n,o)})}),a},YD=function(t,r,n){return function(a){return t(r,n,a),null}},Kf=function(t,r,n){if(!od(t)||wv(t)!=="object")return null;var a=null;return Object.keys(t).forEach(function(i){var o=t[i];m2.includes(i)&&typeof o=="function"&&(a||(a={}),a[i]=YD(o,r,n))}),a},qD=["children"],ZD=["children"];function yS(e,t){if(e==null)return{};var r=JD(e,t),n,a;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function JD(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function kv(e){"@babel/helpers - typeof";return kv=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},kv(e)}var xS={click:"onClick",mousedown:"onMouseDown",mouseup:"onMouseUp",mouseover:"onMouseOver",mousemove:"onMouseMove",mouseout:"onMouseOut",mouseenter:"onMouseEnter",mouseleave:"onMouseLeave",touchcancel:"onTouchCancel",touchend:"onTouchEnd",touchmove:"onTouchMove",touchstart:"onTouchStart",contextmenu:"onContextMenu",dblclick:"onDoubleClick"},os=function(t){return typeof t=="string"?t:t?t.displayName||t.name||"Component":""},vS=null,Uy=null,y2=function e(t){if(t===vS&&Array.isArray(Uy))return Uy;var r=[];return P.Children.forEach(t,function(n){qt(n)||(TD.isFragment(n)?r=r.concat(e(n.props.children)):r.push(n))}),Uy=r,vS=t,r};function pi(e,t){var r=[],n=[];return Array.isArray(t)?n=t.map(function(a){return os(a)}):n=[os(t)],y2(e).forEach(function(a){var i=Wi(a,"type.displayName")||Wi(a,"type.name");n.indexOf(i)!==-1&&r.push(a)}),r}function Si(e,t){var r=pi(e,t);return r&&r[0]}var bS=function(t){if(!t||!t.props)return!1;var r=t.props,n=r.width,a=r.height;return!(!We(n)||n<=0||!We(a)||a<=0)},QD=["a","altGlyph","altGlyphDef","altGlyphItem","animate","animateColor","animateMotion","animateTransform","circle","clipPath","color-profile","cursor","defs","desc","ellipse","feBlend","feColormatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence","filter","font","font-face","font-face-format","font-face-name","font-face-url","foreignObject","g","glyph","glyphRef","hkern","image","line","lineGradient","marker","mask","metadata","missing-glyph","mpath","path","pattern","polygon","polyline","radialGradient","rect","script","set","stop","style","svg","switch","symbol","text","textPath","title","tref","tspan","use","view","vkern"],e$=function(t){return t&&t.type&&hc(t.type)&&QD.indexOf(t.type)>=0},pC=function(t){return t&&kv(t)==="object"&&"clipDot"in t},t$=function(t,r,n,a){var i,o=(i=Fy==null?void 0:Fy[a])!==null&&i!==void 0?i:[];return r.startsWith("data-")||!ar(t)&&(a&&o.includes(r)||KD.includes(r))||n&&m2.includes(r)},er=function(t,r,n){if(!t||typeof t=="function"||typeof t=="boolean")return null;var a=t;if(P.isValidElement(t)&&(a=t.props),!od(a))return null;var i={};return Object.keys(a).forEach(function(o){var s;t$((s=a)===null||s===void 0?void 0:s[o],o,r,n)&&(i[o]=a[o])}),i},Sv=function e(t,r){if(t===r)return!0;var n=P.Children.count(t);if(n!==P.Children.count(r))return!1;if(n===0)return!0;if(n===1)return wS(Array.isArray(t)?t[0]:t,Array.isArray(r)?r[0]:r);for(var a=0;a<n;a++){var i=t[a],o=r[a];if(Array.isArray(i)||Array.isArray(o)){if(!e(i,o))return!1}else if(!wS(i,o))return!1}return!0},wS=function(t,r){if(qt(t)&&qt(r))return!0;if(!qt(t)&&!qt(r)){var n=t.props||{},a=n.children,i=yS(n,qD),o=r.props||{},s=o.children,l=yS(o,ZD);return a&&s?hu(i,l)&&Sv(a,s):!a&&!s?hu(i,l):!1}return!1},kS=function(t,r){var n=[],a={};return y2(t).forEach(function(i,o){if(e$(i))n.push(i);else if(i){var s=os(i.type),l=r[s]||{},u=l.handler,d=l.once;if(u&&(!d||!a[s])){var f=u(i,s,o);n.push(f),a[s]=!0}}}),n},r$=function(t){var r=t&&t.type;return r&&xS[r]?xS[r]:null},n$=function(t,r){return y2(r).indexOf(t)},a$=["children","width","height","viewBox","className","style","title","desc"];function _v(){return _v=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},_v.apply(this,arguments)}function i$(e,t){if(e==null)return{};var r=o$(e,t),n,a;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function o$(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function jv(e){var t=e.children,r=e.width,n=e.height,a=e.viewBox,i=e.className,o=e.style,s=e.title,l=e.desc,u=i$(e,a$),d=a||{width:r,height:n,x:0,y:0},f=Nr("recharts-surface",i);return oe.createElement("svg",_v({},er(u,!0,"svg"),{className:f,width:r,height:n,style:o,viewBox:"".concat(d.x," ").concat(d.y," ").concat(d.width," ").concat(d.height)}),oe.createElement("title",null,s),oe.createElement("desc",null,l),t)}var s$=["children","className"];function Pv(){return Pv=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Pv.apply(this,arguments)}function l$(e,t){if(e==null)return{};var r=c$(e,t),n,a;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function c$(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}var Yr=oe.forwardRef(function(e,t){var r=e.children,n=e.className,a=l$(e,s$),i=Nr("recharts-layer",n);return oe.createElement("g",Pv({className:i},er(a,!0),{ref:t}),r)}),ss=function(t,r){for(var n=arguments.length,a=new Array(n>2?n-2:0),i=2;i<n;i++)a[i-2]=arguments[i]};function u$(e,t,r){var n=-1,a=e.length;t<0&&(t=-t>a?0:a+t),r=r>a?a:r,r<0&&(r+=a),a=t>r?0:r-t>>>0,t>>>=0;for(var i=Array(a);++n<a;)i[n]=e[n+t];return i}var d$=u$,f$=d$;function h$(e,t,r){var n=e.length;return r=r===void 0?n:r,!t&&r>=n?e:f$(e,t,r)}var p$=h$,g$="\\ud800-\\udfff",m$="\\u0300-\\u036f",y$="\\ufe20-\\ufe2f",x$="\\u20d0-\\u20ff",v$=m$+y$+x$,b$="\\ufe0e\\ufe0f",w$="\\u200d",k$=RegExp("["+w$+g$+v$+b$+"]");function S$(e){return k$.test(e)}var gC=S$;function _$(e){return e.split("")}var j$=_$,mC="\\ud800-\\udfff",P$="\\u0300-\\u036f",C$="\\ufe20-\\ufe2f",M$="\\u20d0-\\u20ff",N$=P$+C$+M$,O$="\\ufe0e\\ufe0f",A$="["+mC+"]",Cv="["+N$+"]",Mv="\\ud83c[\\udffb-\\udfff]",E$="(?:"+Cv+"|"+Mv+")",yC="[^"+mC+"]",xC="(?:\\ud83c[\\udde6-\\uddff]){2}",vC="[\\ud800-\\udbff][\\udc00-\\udfff]",T$="\\u200d",bC=E$+"?",wC="["+O$+"]?",I$="(?:"+T$+"(?:"+[yC,xC,vC].join("|")+")"+wC+bC+")*",R$=wC+bC+I$,D$="(?:"+[yC+Cv+"?",Cv,xC,vC,A$].join("|")+")",$$=RegExp(Mv+"(?="+Mv+")|"+D$+R$,"g");function L$(e){return e.match($$)||[]}var B$=L$,F$=j$,U$=gC,G$=B$;function z$(e){return U$(e)?G$(e):F$(e)}var W$=z$,V$=p$,H$=gC,X$=W$,K$=lC;function Y$(e){return function(t){t=K$(t);var r=H$(t)?X$(t):void 0,n=r?r[0]:t.charAt(0),a=r?V$(r,1).join(""):t.slice(1);return n[e]()+a}}var q$=Y$,Z$=q$,J$=Z$("toUpperCase"),Q$=J$;const ym=dn(Q$);function gn(e){return function(){return e}}const kC=Math.cos,Ap=Math.sin,ko=Math.sqrt,Ep=Math.PI,xm=2*Ep,Nv=Math.PI,Ov=2*Nv,Il=1e-6,e7=Ov-Il;function SC(e){this._+=e[0];for(let t=1,r=e.length;t<r;++t)this._+=arguments[t]+e[t]}function t7(e){let t=Math.floor(e);if(!(t>=0))throw new Error(`invalid digits: ${e}`);if(t>15)return SC;const r=10**t;return function(n){this._+=n[0];for(let a=1,i=n.length;a<i;++a)this._+=Math.round(arguments[a]*r)/r+n[a]}}class r7{constructor(t){this._x0=this._y0=this._x1=this._y1=null,this._="",this._append=t==null?SC:t7(t)}moveTo(t,r){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+r}`}closePath(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._append`Z`)}lineTo(t,r){this._append`L${this._x1=+t},${this._y1=+r}`}quadraticCurveTo(t,r,n,a){this._append`Q${+t},${+r},${this._x1=+n},${this._y1=+a}`}bezierCurveTo(t,r,n,a,i,o){this._append`C${+t},${+r},${+n},${+a},${this._x1=+i},${this._y1=+o}`}arcTo(t,r,n,a,i){if(t=+t,r=+r,n=+n,a=+a,i=+i,i<0)throw new Error(`negative radius: ${i}`);let o=this._x1,s=this._y1,l=n-t,u=a-r,d=o-t,f=s-r,h=d*d+f*f;if(this._x1===null)this._append`M${this._x1=t},${this._y1=r}`;else if(h>Il)if(!(Math.abs(f*l-u*d)>Il)||!i)this._append`L${this._x1=t},${this._y1=r}`;else{let g=n-o,v=a-s,w=l*l+u*u,b=g*g+v*v,x=Math.sqrt(w),y=Math.sqrt(h),_=i*Math.tan((Nv-Math.acos((w+h-b)/(2*x*y)))/2),j=_/y,S=_/x;Math.abs(j-1)>Il&&this._append`L${t+j*d},${r+j*f}`,this._append`A${i},${i},0,0,${+(f*g>d*v)},${this._x1=t+S*l},${this._y1=r+S*u}`}}arc(t,r,n,a,i,o){if(t=+t,r=+r,n=+n,o=!!o,n<0)throw new Error(`negative radius: ${n}`);let s=n*Math.cos(a),l=n*Math.sin(a),u=t+s,d=r+l,f=1^o,h=o?a-i:i-a;this._x1===null?this._append`M${u},${d}`:(Math.abs(this._x1-u)>Il||Math.abs(this._y1-d)>Il)&&this._append`L${u},${d}`,n&&(h<0&&(h=h%Ov+Ov),h>e7?this._append`A${n},${n},0,1,${f},${t-s},${r-l}A${n},${n},0,1,${f},${this._x1=u},${this._y1=d}`:h>Il&&this._append`A${n},${n},0,${+(h>=Nv)},${f},${this._x1=t+n*Math.cos(i)},${this._y1=r+n*Math.sin(i)}`)}rect(t,r,n,a){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+r}h${n=+n}v${+a}h${-n}Z`}toString(){return this._}}function x2(e){let t=3;return e.digits=function(r){if(!arguments.length)return t;if(r==null)t=null;else{const n=Math.floor(r);if(!(n>=0))throw new RangeError(`invalid digits: ${r}`);t=n}return e},()=>new r7(t)}function v2(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function _C(e){this._context=e}_C.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:this._context.lineTo(e,t);break}}};function vm(e){return new _C(e)}function jC(e){return e[0]}function PC(e){return e[1]}function CC(e,t){var r=gn(!0),n=null,a=vm,i=null,o=x2(s);e=typeof e=="function"?e:e===void 0?jC:gn(e),t=typeof t=="function"?t:t===void 0?PC:gn(t);function s(l){var u,d=(l=v2(l)).length,f,h=!1,g;for(n==null&&(i=a(g=o())),u=0;u<=d;++u)!(u<d&&r(f=l[u],u,l))===h&&((h=!h)?i.lineStart():i.lineEnd()),h&&i.point(+e(f,u,l),+t(f,u,l));if(g)return i=null,g+""||null}return s.x=function(l){return arguments.length?(e=typeof l=="function"?l:gn(+l),s):e},s.y=function(l){return arguments.length?(t=typeof l=="function"?l:gn(+l),s):t},s.defined=function(l){return arguments.length?(r=typeof l=="function"?l:gn(!!l),s):r},s.curve=function(l){return arguments.length?(a=l,n!=null&&(i=a(n)),s):a},s.context=function(l){return arguments.length?(l==null?n=i=null:i=a(n=l),s):n},s}function bh(e,t,r){var n=null,a=gn(!0),i=null,o=vm,s=null,l=x2(u);e=typeof e=="function"?e:e===void 0?jC:gn(+e),t=typeof t=="function"?t:gn(t===void 0?0:+t),r=typeof r=="function"?r:r===void 0?PC:gn(+r);function u(f){var h,g,v,w=(f=v2(f)).length,b,x=!1,y,_=new Array(w),j=new Array(w);for(i==null&&(s=o(y=l())),h=0;h<=w;++h){if(!(h<w&&a(b=f[h],h,f))===x)if(x=!x)g=h,s.areaStart(),s.lineStart();else{for(s.lineEnd(),s.lineStart(),v=h-1;v>=g;--v)s.point(_[v],j[v]);s.lineEnd(),s.areaEnd()}x&&(_[h]=+e(b,h,f),j[h]=+t(b,h,f),s.point(n?+n(b,h,f):_[h],r?+r(b,h,f):j[h]))}if(y)return s=null,y+""||null}function d(){return CC().defined(a).curve(o).context(i)}return u.x=function(f){return arguments.length?(e=typeof f=="function"?f:gn(+f),n=null,u):e},u.x0=function(f){return arguments.length?(e=typeof f=="function"?f:gn(+f),u):e},u.x1=function(f){return arguments.length?(n=f==null?null:typeof f=="function"?f:gn(+f),u):n},u.y=function(f){return arguments.length?(t=typeof f=="function"?f:gn(+f),r=null,u):t},u.y0=function(f){return arguments.length?(t=typeof f=="function"?f:gn(+f),u):t},u.y1=function(f){return arguments.length?(r=f==null?null:typeof f=="function"?f:gn(+f),u):r},u.lineX0=u.lineY0=function(){return d().x(e).y(t)},u.lineY1=function(){return d().x(e).y(r)},u.lineX1=function(){return d().x(n).y(t)},u.defined=function(f){return arguments.length?(a=typeof f=="function"?f:gn(!!f),u):a},u.curve=function(f){return arguments.length?(o=f,i!=null&&(s=o(i)),u):o},u.context=function(f){return arguments.length?(f==null?i=s=null:s=o(i=f),u):i},u}class MC{constructor(t,r){this._context=t,this._x=r}areaStart(){this._line=0}areaEnd(){this._line=NaN}lineStart(){this._point=0}lineEnd(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line}point(t,r){switch(t=+t,r=+r,this._point){case 0:{this._point=1,this._line?this._context.lineTo(t,r):this._context.moveTo(t,r);break}case 1:this._point=2;default:{this._x?this._context.bezierCurveTo(this._x0=(this._x0+t)/2,this._y0,this._x0,r,t,r):this._context.bezierCurveTo(this._x0,this._y0=(this._y0+r)/2,t,this._y0,t,r);break}}this._x0=t,this._y0=r}}function n7(e){return new MC(e,!0)}function a7(e){return new MC(e,!1)}const b2={draw(e,t){const r=ko(t/Ep);e.moveTo(r,0),e.arc(0,0,r,0,xm)}},i7={draw(e,t){const r=ko(t/5)/2;e.moveTo(-3*r,-r),e.lineTo(-r,-r),e.lineTo(-r,-3*r),e.lineTo(r,-3*r),e.lineTo(r,-r),e.lineTo(3*r,-r),e.lineTo(3*r,r),e.lineTo(r,r),e.lineTo(r,3*r),e.lineTo(-r,3*r),e.lineTo(-r,r),e.lineTo(-3*r,r),e.closePath()}},NC=ko(1/3),o7=NC*2,s7={draw(e,t){const r=ko(t/o7),n=r*NC;e.moveTo(0,-r),e.lineTo(n,0),e.lineTo(0,r),e.lineTo(-n,0),e.closePath()}},l7={draw(e,t){const r=ko(t),n=-r/2;e.rect(n,n,r,r)}},c7=.8908130915292852,OC=Ap(Ep/10)/Ap(7*Ep/10),u7=Ap(xm/10)*OC,d7=-kC(xm/10)*OC,f7={draw(e,t){const r=ko(t*c7),n=u7*r,a=d7*r;e.moveTo(0,-r),e.lineTo(n,a);for(let i=1;i<5;++i){const o=xm*i/5,s=kC(o),l=Ap(o);e.lineTo(l*r,-s*r),e.lineTo(s*n-l*a,l*n+s*a)}e.closePath()}},Gy=ko(3),h7={draw(e,t){const r=-ko(t/(Gy*3));e.moveTo(0,r*2),e.lineTo(-Gy*r,-r),e.lineTo(Gy*r,-r),e.closePath()}},Ii=-.5,Ri=ko(3)/2,Av=1/ko(12),p7=(Av/2+1)*3,g7={draw(e,t){const r=ko(t/p7),n=r/2,a=r*Av,i=n,o=r*Av+r,s=-i,l=o;e.moveTo(n,a),e.lineTo(i,o),e.lineTo(s,l),e.lineTo(Ii*n-Ri*a,Ri*n+Ii*a),e.lineTo(Ii*i-Ri*o,Ri*i+Ii*o),e.lineTo(Ii*s-Ri*l,Ri*s+Ii*l),e.lineTo(Ii*n+Ri*a,Ii*a-Ri*n),e.lineTo(Ii*i+Ri*o,Ii*o-Ri*i),e.lineTo(Ii*s+Ri*l,Ii*l-Ri*s),e.closePath()}};function m7(e,t){let r=null,n=x2(a);e=typeof e=="function"?e:gn(e||b2),t=typeof t=="function"?t:gn(t===void 0?64:+t);function a(){let i;if(r||(r=i=n()),e.apply(this,arguments).draw(r,+t.apply(this,arguments)),i)return r=null,i+""||null}return a.type=function(i){return arguments.length?(e=typeof i=="function"?i:gn(i),a):e},a.size=function(i){return arguments.length?(t=typeof i=="function"?i:gn(+i),a):t},a.context=function(i){return arguments.length?(r=i??null,a):r},a}function Tp(){}function Ip(e,t,r){e._context.bezierCurveTo((2*e._x0+e._x1)/3,(2*e._y0+e._y1)/3,(e._x0+2*e._x1)/3,(e._y0+2*e._y1)/3,(e._x0+4*e._x1+t)/6,(e._y0+4*e._y1+r)/6)}function AC(e){this._context=e}AC.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){switch(this._point){case 3:Ip(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:Ip(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function y7(e){return new AC(e)}function EC(e){this._context=e}EC.prototype={areaStart:Tp,areaEnd:Tp,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._y0=this._y1=this._y2=this._y3=this._y4=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x2,this._y2),this._context.closePath();break}case 2:{this._context.moveTo((this._x2+2*this._x3)/3,(this._y2+2*this._y3)/3),this._context.lineTo((this._x3+2*this._x2)/3,(this._y3+2*this._y2)/3),this._context.closePath();break}case 3:{this.point(this._x2,this._y2),this.point(this._x3,this._y3),this.point(this._x4,this._y4);break}}},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._x2=e,this._y2=t;break;case 1:this._point=2,this._x3=e,this._y3=t;break;case 2:this._point=3,this._x4=e,this._y4=t,this._context.moveTo((this._x0+4*this._x1+e)/6,(this._y0+4*this._y1+t)/6);break;default:Ip(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function x7(e){return new EC(e)}function TC(e){this._context=e}TC.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3;var r=(this._x0+4*this._x1+e)/6,n=(this._y0+4*this._y1+t)/6;this._line?this._context.lineTo(r,n):this._context.moveTo(r,n);break;case 3:this._point=4;default:Ip(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function v7(e){return new TC(e)}function IC(e){this._context=e}IC.prototype={areaStart:Tp,areaEnd:Tp,lineStart:function(){this._point=0},lineEnd:function(){this._point&&this._context.closePath()},point:function(e,t){e=+e,t=+t,this._point?this._context.lineTo(e,t):(this._point=1,this._context.moveTo(e,t))}};function b7(e){return new IC(e)}function SS(e){return e<0?-1:1}function _S(e,t,r){var n=e._x1-e._x0,a=t-e._x1,i=(e._y1-e._y0)/(n||a<0&&-0),o=(r-e._y1)/(a||n<0&&-0),s=(i*a+o*n)/(n+a);return(SS(i)+SS(o))*Math.min(Math.abs(i),Math.abs(o),.5*Math.abs(s))||0}function jS(e,t){var r=e._x1-e._x0;return r?(3*(e._y1-e._y0)/r-t)/2:t}function zy(e,t,r){var n=e._x0,a=e._y0,i=e._x1,o=e._y1,s=(i-n)/3;e._context.bezierCurveTo(n+s,a+s*t,i-s,o-s*r,i,o)}function Rp(e){this._context=e}Rp.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:zy(this,this._t0,jS(this,this._t0));break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){var r=NaN;if(e=+e,t=+t,!(e===this._x1&&t===this._y1)){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,zy(this,jS(this,r=_S(this,e,t)),r);break;default:zy(this,this._t0,r=_S(this,e,t));break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t,this._t0=r}}};function RC(e){this._context=new DC(e)}(RC.prototype=Object.create(Rp.prototype)).point=function(e,t){Rp.prototype.point.call(this,t,e)};function DC(e){this._context=e}DC.prototype={moveTo:function(e,t){this._context.moveTo(t,e)},closePath:function(){this._context.closePath()},lineTo:function(e,t){this._context.lineTo(t,e)},bezierCurveTo:function(e,t,r,n,a,i){this._context.bezierCurveTo(t,e,n,r,i,a)}};function w7(e){return new Rp(e)}function k7(e){return new RC(e)}function $C(e){this._context=e}$C.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=[],this._y=[]},lineEnd:function(){var e=this._x,t=this._y,r=e.length;if(r)if(this._line?this._context.lineTo(e[0],t[0]):this._context.moveTo(e[0],t[0]),r===2)this._context.lineTo(e[1],t[1]);else for(var n=PS(e),a=PS(t),i=0,o=1;o<r;++i,++o)this._context.bezierCurveTo(n[0][i],a[0][i],n[1][i],a[1][i],e[o],t[o]);(this._line||this._line!==0&&r===1)&&this._context.closePath(),this._line=1-this._line,this._x=this._y=null},point:function(e,t){this._x.push(+e),this._y.push(+t)}};function PS(e){var t,r=e.length-1,n,a=new Array(r),i=new Array(r),o=new Array(r);for(a[0]=0,i[0]=2,o[0]=e[0]+2*e[1],t=1;t<r-1;++t)a[t]=1,i[t]=4,o[t]=4*e[t]+2*e[t+1];for(a[r-1]=2,i[r-1]=7,o[r-1]=8*e[r-1]+e[r],t=1;t<r;++t)n=a[t]/i[t-1],i[t]-=n,o[t]-=n*o[t-1];for(a[r-1]=o[r-1]/i[r-1],t=r-2;t>=0;--t)a[t]=(o[t]-a[t+1])/i[t];for(i[r-1]=(e[r]+a[r-1])/2,t=0;t<r-1;++t)i[t]=2*e[t+1]-a[t+1];return[a,i]}function S7(e){return new $C(e)}function bm(e,t){this._context=e,this._t=t}bm.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=this._y=NaN,this._point=0},lineEnd:function(){0<this._t&&this._t<1&&this._point===2&&this._context.lineTo(this._x,this._y),(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line>=0&&(this._t=1-this._t,this._line=1-this._line)},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:{if(this._t<=0)this._context.lineTo(this._x,t),this._context.lineTo(e,t);else{var r=this._x*(1-this._t)+e*this._t;this._context.lineTo(r,this._y),this._context.lineTo(r,t)}break}}this._x=e,this._y=t}};function _7(e){return new bm(e,.5)}function j7(e){return new bm(e,0)}function P7(e){return new bm(e,1)}function Cu(e,t){if((o=e.length)>1)for(var r=1,n,a,i=e[t[0]],o,s=i.length;r<o;++r)for(a=i,i=e[t[r]],n=0;n<s;++n)i[n][1]+=i[n][0]=isNaN(a[n][1])?a[n][0]:a[n][1]}function Ev(e){for(var t=e.length,r=new Array(t);--t>=0;)r[t]=t;return r}function C7(e,t){return e[t]}function M7(e){const t=[];return t.key=e,t}function N7(){var e=gn([]),t=Ev,r=Cu,n=C7;function a(i){var o=Array.from(e.apply(this,arguments),M7),s,l=o.length,u=-1,d;for(const f of i)for(s=0,++u;s<l;++s)(o[s][u]=[0,+n(f,o[s].key,u,i)]).data=f;for(s=0,d=v2(t(o));s<l;++s)o[d[s]].index=s;return r(o,d),o}return a.keys=function(i){return arguments.length?(e=typeof i=="function"?i:gn(Array.from(i)),a):e},a.value=function(i){return arguments.length?(n=typeof i=="function"?i:gn(+i),a):n},a.order=function(i){return arguments.length?(t=i==null?Ev:typeof i=="function"?i:gn(Array.from(i)),a):t},a.offset=function(i){return arguments.length?(r=i??Cu,a):r},a}function O7(e,t){if((n=e.length)>0){for(var r,n,a=0,i=e[0].length,o;a<i;++a){for(o=r=0;r<n;++r)o+=e[r][a][1]||0;if(o)for(r=0;r<n;++r)e[r][a][1]/=o}Cu(e,t)}}function A7(e,t){if((a=e.length)>0){for(var r=0,n=e[t[0]],a,i=n.length;r<i;++r){for(var o=0,s=0;o<a;++o)s+=e[o][r][1]||0;n[r][1]+=n[r][0]=-s/2}Cu(e,t)}}function E7(e,t){if(!(!((o=e.length)>0)||!((i=(a=e[t[0]]).length)>0))){for(var r=0,n=1,a,i,o;n<i;++n){for(var s=0,l=0,u=0;s<o;++s){for(var d=e[t[s]],f=d[n][1]||0,h=d[n-1][1]||0,g=(f-h)/2,v=0;v<s;++v){var w=e[t[v]],b=w[n][1]||0,x=w[n-1][1]||0;g+=b-x}l+=f,u+=g*f}a[n-1][1]+=a[n-1][0]=r,l&&(r-=u/l)}a[n-1][1]+=a[n-1][0]=r,Cu(e,t)}}function Yf(e){"@babel/helpers - typeof";return Yf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Yf(e)}var T7=["type","size","sizeType"];function Tv(){return Tv=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Tv.apply(this,arguments)}function CS(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function MS(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?CS(Object(r),!0).forEach(function(n){I7(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):CS(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function I7(e,t,r){return t=R7(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function R7(e){var t=D7(e,"string");return Yf(t)=="symbol"?t:t+""}function D7(e,t){if(Yf(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(Yf(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function $7(e,t){if(e==null)return{};var r=L7(e,t),n,a;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function L7(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}var LC={symbolCircle:b2,symbolCross:i7,symbolDiamond:s7,symbolSquare:l7,symbolStar:f7,symbolTriangle:h7,symbolWye:g7},B7=Math.PI/180,F7=function(t){var r="symbol".concat(ym(t));return LC[r]||b2},U7=function(t,r,n){if(r==="area")return t;switch(n){case"cross":return 5*t*t/9;case"diamond":return .5*t*t/Math.sqrt(3);case"square":return t*t;case"star":{var a=18*B7;return 1.25*t*t*(Math.tan(a)-Math.tan(a*2)*Math.pow(Math.tan(a),2))}case"triangle":return Math.sqrt(3)*t*t/4;case"wye":return(21-10*Math.sqrt(3))*t*t/8;default:return Math.PI*t*t/4}},G7=function(t,r){LC["symbol".concat(ym(t))]=r},wm=function(t){var r=t.type,n=r===void 0?"circle":r,a=t.size,i=a===void 0?64:a,o=t.sizeType,s=o===void 0?"area":o,l=$7(t,T7),u=MS(MS({},l),{},{type:n,size:i,sizeType:s}),d=function(){var b=F7(n),x=m7().type(b).size(U7(i,s,n));return x()},f=u.className,h=u.cx,g=u.cy,v=er(u,!0);return h===+h&&g===+g&&i===+i?oe.createElement("path",Tv({},v,{className:Nr("recharts-symbols",f),transform:"translate(".concat(h,", ").concat(g,")"),d:d()})):null};wm.registerSymbol=G7;function Mu(e){"@babel/helpers - typeof";return Mu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Mu(e)}function Iv(){return Iv=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Iv.apply(this,arguments)}function NS(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function z7(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?NS(Object(r),!0).forEach(function(n){qf(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):NS(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function W7(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function V7(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,FC(n.key),n)}}function H7(e,t,r){return t&&V7(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function X7(e,t,r){return t=Dp(t),K7(e,BC()?Reflect.construct(t,r||[],Dp(e).constructor):t.apply(e,r))}function K7(e,t){if(t&&(Mu(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Y7(e)}function Y7(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function BC(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(BC=function(){return!!e})()}function Dp(e){return Dp=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Dp(e)}function q7(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Rv(e,t)}function Rv(e,t){return Rv=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},Rv(e,t)}function qf(e,t,r){return t=FC(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function FC(e){var t=Z7(e,"string");return Mu(t)=="symbol"?t:t+""}function Z7(e,t){if(Mu(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(Mu(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var Di=32,w2=function(e){function t(){return W7(this,t),X7(this,t,arguments)}return q7(t,e),H7(t,[{key:"renderIcon",value:function(n){var a=this.props.inactiveColor,i=Di/2,o=Di/6,s=Di/3,l=n.inactive?a:n.color;if(n.type==="plainline")return oe.createElement("line",{strokeWidth:4,fill:"none",stroke:l,strokeDasharray:n.payload.strokeDasharray,x1:0,y1:i,x2:Di,y2:i,className:"recharts-legend-icon"});if(n.type==="line")return oe.createElement("path",{strokeWidth:4,fill:"none",stroke:l,d:"M0,".concat(i,"h").concat(s,`
            A`).concat(o,",").concat(o,",0,1,1,").concat(2*s,",").concat(i,`
            H`).concat(Di,"M").concat(2*s,",").concat(i,`
            A`).concat(o,",").concat(o,",0,1,1,").concat(s,",").concat(i),className:"recharts-legend-icon"});if(n.type==="rect")return oe.createElement("path",{stroke:"none",fill:l,d:"M0,".concat(Di/8,"h").concat(Di,"v").concat(Di*3/4,"h").concat(-Di,"z"),className:"recharts-legend-icon"});if(oe.isValidElement(n.legendIcon)){var u=z7({},n);return delete u.legendIcon,oe.cloneElement(n.legendIcon,u)}return oe.createElement(wm,{fill:l,cx:i,cy:i,size:Di,sizeType:"diameter",type:n.type})}},{key:"renderItems",value:function(){var n=this,a=this.props,i=a.payload,o=a.iconSize,s=a.layout,l=a.formatter,u=a.inactiveColor,d={x:0,y:0,width:Di,height:Di},f={display:s==="horizontal"?"inline-block":"block",marginRight:10},h={display:"inline-block",verticalAlign:"middle",marginRight:4};return i.map(function(g,v){var w=g.formatter||l,b=Nr(qf(qf({"recharts-legend-item":!0},"legend-item-".concat(v),!0),"inactive",g.inactive));if(g.type==="none")return null;var x=ar(g.value)?null:g.value;ss(!ar(g.value),`The name property is also required when using a function for the dataKey of a chart's cartesian components. Ex: <Bar name="Name of my Data"/>`);var y=g.inactive?u:g.color;return oe.createElement("li",Iv({className:b,style:f,key:"legend-item-".concat(v)},Kf(n.props,g,v)),oe.createElement(jv,{width:o,height:o,viewBox:d,style:h},n.renderIcon(g)),oe.createElement("span",{className:"recharts-legend-item-text",style:{color:y}},w?w(x,g,v):x))})}},{key:"render",value:function(){var n=this.props,a=n.payload,i=n.layout,o=n.align;if(!a||!a.length)return null;var s={padding:0,margin:0,textAlign:i==="horizontal"?o:"left"};return oe.createElement("ul",{className:"recharts-default-legend",style:s},this.renderItems())}}])}(P.PureComponent);qf(w2,"displayName","Legend");qf(w2,"defaultProps",{iconSize:14,layout:"horizontal",align:"center",verticalAlign:"middle",inactiveColor:"#ccc"});var J7=am;function Q7(){this.__data__=new J7,this.size=0}var e9=Q7;function t9(e){var t=this.__data__,r=t.delete(e);return this.size=t.size,r}var r9=t9;function n9(e){return this.__data__.get(e)}var a9=n9;function i9(e){return this.__data__.has(e)}var o9=i9,s9=am,l9=c2,c9=u2,u9=200;function d9(e,t){var r=this.__data__;if(r instanceof s9){var n=r.__data__;if(!l9||n.length<u9-1)return n.push([e,t]),this.size=++r.size,this;r=this.__data__=new c9(n)}return r.set(e,t),this.size=r.size,this}var f9=d9,h9=am,p9=e9,g9=r9,m9=a9,y9=o9,x9=f9;function dd(e){var t=this.__data__=new h9(e);this.size=t.size}dd.prototype.clear=p9;dd.prototype.delete=g9;dd.prototype.get=m9;dd.prototype.has=y9;dd.prototype.set=x9;var UC=dd,v9="__lodash_hash_undefined__";function b9(e){return this.__data__.set(e,v9),this}var w9=b9;function k9(e){return this.__data__.has(e)}var S9=k9,_9=u2,j9=w9,P9=S9;function $p(e){var t=-1,r=e==null?0:e.length;for(this.__data__=new _9;++t<r;)this.add(e[t])}$p.prototype.add=$p.prototype.push=j9;$p.prototype.has=P9;var GC=$p;function C9(e,t){for(var r=-1,n=e==null?0:e.length;++r<n;)if(t(e[r],r,e))return!0;return!1}var zC=C9;function M9(e,t){return e.has(t)}var WC=M9,N9=GC,O9=zC,A9=WC,E9=1,T9=2;function I9(e,t,r,n,a,i){var o=r&E9,s=e.length,l=t.length;if(s!=l&&!(o&&l>s))return!1;var u=i.get(e),d=i.get(t);if(u&&d)return u==t&&d==e;var f=-1,h=!0,g=r&T9?new N9:void 0;for(i.set(e,t),i.set(t,e);++f<s;){var v=e[f],w=t[f];if(n)var b=o?n(w,v,f,t,e,i):n(v,w,f,e,t,i);if(b!==void 0){if(b)continue;h=!1;break}if(g){if(!O9(t,function(x,y){if(!A9(g,y)&&(v===x||a(v,x,r,n,i)))return g.push(y)})){h=!1;break}}else if(!(v===w||a(v,w,r,n,i))){h=!1;break}}return i.delete(e),i.delete(t),h}var VC=I9,R9=Wo,D9=R9.Uint8Array,$9=D9;function L9(e){var t=-1,r=Array(e.size);return e.forEach(function(n,a){r[++t]=[a,n]}),r}var B9=L9;function F9(e){var t=-1,r=Array(e.size);return e.forEach(function(n){r[++t]=n}),r}var k2=F9,OS=R0,AS=$9,U9=l2,G9=VC,z9=B9,W9=k2,V9=1,H9=2,X9="[object Boolean]",K9="[object Date]",Y9="[object Error]",q9="[object Map]",Z9="[object Number]",J9="[object RegExp]",Q9="[object Set]",eL="[object String]",tL="[object Symbol]",rL="[object ArrayBuffer]",nL="[object DataView]",ES=OS?OS.prototype:void 0,Wy=ES?ES.valueOf:void 0;function aL(e,t,r,n,a,i,o){switch(r){case nL:if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case rL:return!(e.byteLength!=t.byteLength||!i(new AS(e),new AS(t)));case X9:case K9:case Z9:return U9(+e,+t);case Y9:return e.name==t.name&&e.message==t.message;case J9:case eL:return e==t+"";case q9:var s=z9;case Q9:var l=n&V9;if(s||(s=W9),e.size!=t.size&&!l)return!1;var u=o.get(e);if(u)return u==t;n|=H9,o.set(e,t);var d=G9(s(e),s(t),n,a,i,o);return o.delete(e),d;case tL:if(Wy)return Wy.call(e)==Wy.call(t)}return!1}var iL=aL;function oL(e,t){for(var r=-1,n=t.length,a=e.length;++r<n;)e[a+r]=t[r];return e}var HC=oL,sL=HC,lL=gi;function cL(e,t,r){var n=t(e);return lL(e)?n:sL(n,r(e))}var uL=cL;function dL(e,t){for(var r=-1,n=e==null?0:e.length,a=0,i=[];++r<n;){var o=e[r];t(o,r,e)&&(i[a++]=o)}return i}var fL=dL;function hL(){return[]}var pL=hL,gL=fL,mL=pL,yL=Object.prototype,xL=yL.propertyIsEnumerable,TS=Object.getOwnPropertySymbols,vL=TS?function(e){return e==null?[]:(e=Object(e),gL(TS(e),function(t){return xL.call(e,t)}))}:mL,bL=vL;function wL(e,t){for(var r=-1,n=Array(e);++r<e;)n[r]=t(r);return n}var kL=wL,SL=ys,_L=xs,jL="[object Arguments]";function PL(e){return _L(e)&&SL(e)==jL}var CL=PL,IS=CL,ML=xs,XC=Object.prototype,NL=XC.hasOwnProperty,OL=XC.propertyIsEnumerable,AL=IS(function(){return arguments}())?IS:function(e){return ML(e)&&NL.call(e,"callee")&&!OL.call(e,"callee")},S2=AL,Lp={exports:{}};function EL(){return!1}var TL=EL;Lp.exports;(function(e,t){var r=Wo,n=TL,a=t&&!t.nodeType&&t,i=a&&!0&&e&&!e.nodeType&&e,o=i&&i.exports===a,s=o?r.Buffer:void 0,l=s?s.isBuffer:void 0,u=l||n;e.exports=u})(Lp,Lp.exports);var KC=Lp.exports,IL=9007199254740991,RL=/^(?:0|[1-9]\d*)$/;function DL(e,t){var r=typeof e;return t=t??IL,!!t&&(r=="number"||r!="symbol"&&RL.test(e))&&e>-1&&e%1==0&&e<t}var _2=DL,$L=9007199254740991;function LL(e){return typeof e=="number"&&e>-1&&e%1==0&&e<=$L}var j2=LL,BL=ys,FL=j2,UL=xs,GL="[object Arguments]",zL="[object Array]",WL="[object Boolean]",VL="[object Date]",HL="[object Error]",XL="[object Function]",KL="[object Map]",YL="[object Number]",qL="[object Object]",ZL="[object RegExp]",JL="[object Set]",QL="[object String]",eB="[object WeakMap]",tB="[object ArrayBuffer]",rB="[object DataView]",nB="[object Float32Array]",aB="[object Float64Array]",iB="[object Int8Array]",oB="[object Int16Array]",sB="[object Int32Array]",lB="[object Uint8Array]",cB="[object Uint8ClampedArray]",uB="[object Uint16Array]",dB="[object Uint32Array]",bn={};bn[nB]=bn[aB]=bn[iB]=bn[oB]=bn[sB]=bn[lB]=bn[cB]=bn[uB]=bn[dB]=!0;bn[GL]=bn[zL]=bn[tB]=bn[WL]=bn[rB]=bn[VL]=bn[HL]=bn[XL]=bn[KL]=bn[YL]=bn[qL]=bn[ZL]=bn[JL]=bn[QL]=bn[eB]=!1;function fB(e){return UL(e)&&FL(e.length)&&!!bn[BL(e)]}var hB=fB;function pB(e){return function(t){return e(t)}}var YC=pB,Bp={exports:{}};Bp.exports;(function(e,t){var r=rC,n=t&&!t.nodeType&&t,a=n&&!0&&e&&!e.nodeType&&e,i=a&&a.exports===n,o=i&&r.process,s=function(){try{var l=a&&a.require&&a.require("util").types;return l||o&&o.binding&&o.binding("util")}catch{}}();e.exports=s})(Bp,Bp.exports);var gB=Bp.exports,mB=hB,yB=YC,RS=gB,DS=RS&&RS.isTypedArray,xB=DS?yB(DS):mB,qC=xB,vB=kL,bB=S2,wB=gi,kB=KC,SB=_2,_B=qC,jB=Object.prototype,PB=jB.hasOwnProperty;function CB(e,t){var r=wB(e),n=!r&&bB(e),a=!r&&!n&&kB(e),i=!r&&!n&&!a&&_B(e),o=r||n||a||i,s=o?vB(e.length,String):[],l=s.length;for(var u in e)(t||PB.call(e,u))&&!(o&&(u=="length"||a&&(u=="offset"||u=="parent")||i&&(u=="buffer"||u=="byteLength"||u=="byteOffset")||SB(u,l)))&&s.push(u);return s}var MB=CB,NB=Object.prototype;function OB(e){var t=e&&e.constructor,r=typeof t=="function"&&t.prototype||NB;return e===r}var AB=OB;function EB(e,t){return function(r){return e(t(r))}}var ZC=EB,TB=ZC,IB=TB(Object.keys,Object),RB=IB,DB=AB,$B=RB,LB=Object.prototype,BB=LB.hasOwnProperty;function FB(e){if(!DB(e))return $B(e);var t=[];for(var r in Object(e))BB.call(e,r)&&r!="constructor"&&t.push(r);return t}var UB=FB,GB=s2,zB=j2;function WB(e){return e!=null&&zB(e.length)&&!GB(e)}var D0=WB,VB=MB,HB=UB,XB=D0;function KB(e){return XB(e)?VB(e):HB(e)}var km=KB,YB=uL,qB=bL,ZB=km;function JB(e){return YB(e,ZB,qB)}var QB=JB,$S=QB,eF=1,tF=Object.prototype,rF=tF.hasOwnProperty;function nF(e,t,r,n,a,i){var o=r&eF,s=$S(e),l=s.length,u=$S(t),d=u.length;if(l!=d&&!o)return!1;for(var f=l;f--;){var h=s[f];if(!(o?h in t:rF.call(t,h)))return!1}var g=i.get(e),v=i.get(t);if(g&&v)return g==t&&v==e;var w=!0;i.set(e,t),i.set(t,e);for(var b=o;++f<l;){h=s[f];var x=e[h],y=t[h];if(n)var _=o?n(y,x,h,t,e,i):n(x,y,h,e,t,i);if(!(_===void 0?x===y||a(x,y,r,n,i):_)){w=!1;break}b||(b=h=="constructor")}if(w&&!b){var j=e.constructor,S=t.constructor;j!=S&&"constructor"in e&&"constructor"in t&&!(typeof j=="function"&&j instanceof j&&typeof S=="function"&&S instanceof S)&&(w=!1)}return i.delete(e),i.delete(t),w}var aF=nF,iF=kc,oF=Wo,sF=iF(oF,"DataView"),lF=sF,cF=kc,uF=Wo,dF=cF(uF,"Promise"),fF=dF,hF=kc,pF=Wo,gF=hF(pF,"Set"),JC=gF,mF=kc,yF=Wo,xF=mF(yF,"WeakMap"),vF=xF,Dv=lF,$v=c2,Lv=fF,Bv=JC,Fv=vF,QC=ys,fd=aC,LS="[object Map]",bF="[object Object]",BS="[object Promise]",FS="[object Set]",US="[object WeakMap]",GS="[object DataView]",wF=fd(Dv),kF=fd($v),SF=fd(Lv),_F=fd(Bv),jF=fd(Fv),Rl=QC;(Dv&&Rl(new Dv(new ArrayBuffer(1)))!=GS||$v&&Rl(new $v)!=LS||Lv&&Rl(Lv.resolve())!=BS||Bv&&Rl(new Bv)!=FS||Fv&&Rl(new Fv)!=US)&&(Rl=function(e){var t=QC(e),r=t==bF?e.constructor:void 0,n=r?fd(r):"";if(n)switch(n){case wF:return GS;case kF:return LS;case SF:return BS;case _F:return FS;case jF:return US}return t});var PF=Rl,Vy=UC,CF=VC,MF=iL,NF=aF,zS=PF,WS=gi,VS=KC,OF=qC,AF=1,HS="[object Arguments]",XS="[object Array]",wh="[object Object]",EF=Object.prototype,KS=EF.hasOwnProperty;function TF(e,t,r,n,a,i){var o=WS(e),s=WS(t),l=o?XS:zS(e),u=s?XS:zS(t);l=l==HS?wh:l,u=u==HS?wh:u;var d=l==wh,f=u==wh,h=l==u;if(h&&VS(e)){if(!VS(t))return!1;o=!0,d=!1}if(h&&!d)return i||(i=new Vy),o||OF(e)?CF(e,t,r,n,a,i):MF(e,t,l,r,n,a,i);if(!(r&AF)){var g=d&&KS.call(e,"__wrapped__"),v=f&&KS.call(t,"__wrapped__");if(g||v){var w=g?e.value():e,b=v?t.value():t;return i||(i=new Vy),a(w,b,r,n,i)}}return h?(i||(i=new Vy),NF(e,t,r,n,a,i)):!1}var IF=TF,RF=IF,YS=xs;function eM(e,t,r,n,a){return e===t?!0:e==null||t==null||!YS(e)&&!YS(t)?e!==e&&t!==t:RF(e,t,r,n,eM,a)}var P2=eM,DF=UC,$F=P2,LF=1,BF=2;function FF(e,t,r,n){var a=r.length,i=a,o=!n;if(e==null)return!i;for(e=Object(e);a--;){var s=r[a];if(o&&s[2]?s[1]!==e[s[0]]:!(s[0]in e))return!1}for(;++a<i;){s=r[a];var l=s[0],u=e[l],d=s[1];if(o&&s[2]){if(u===void 0&&!(l in e))return!1}else{var f=new DF;if(n)var h=n(u,d,l,e,t,f);if(!(h===void 0?$F(d,u,LF|BF,n,f):h))return!1}}return!0}var UF=FF,GF=wl;function zF(e){return e===e&&!GF(e)}var tM=zF,WF=tM,VF=km;function HF(e){for(var t=VF(e),r=t.length;r--;){var n=t[r],a=e[n];t[r]=[n,a,WF(a)]}return t}var XF=HF;function KF(e,t){return function(r){return r==null?!1:r[e]===t&&(t!==void 0||e in Object(r))}}var rM=KF,YF=UF,qF=XF,ZF=rM;function JF(e){var t=qF(e);return t.length==1&&t[0][2]?ZF(t[0][0],t[0][1]):function(r){return r===e||YF(r,e,t)}}var QF=JF;function eU(e,t){return e!=null&&t in Object(e)}var tU=eU,rU=cC,nU=S2,aU=gi,iU=_2,oU=j2,sU=om;function lU(e,t,r){t=rU(t,e);for(var n=-1,a=t.length,i=!1;++n<a;){var o=sU(t[n]);if(!(i=e!=null&&r(e,o)))break;e=e[o]}return i||++n!=a?i:(a=e==null?0:e.length,!!a&&oU(a)&&iU(o,a)&&(aU(e)||nU(e)))}var cU=lU,uU=tU,dU=cU;function fU(e,t){return e!=null&&dU(e,t,uU)}var hU=fU,pU=P2,gU=uC,mU=hU,yU=o2,xU=tM,vU=rM,bU=om,wU=1,kU=2;function SU(e,t){return yU(e)&&xU(t)?vU(bU(e),t):function(r){var n=gU(r,e);return n===void 0&&n===t?mU(r,e):pU(t,n,wU|kU)}}var _U=SU;function jU(e){return e}var hd=jU;function PU(e){return function(t){return t==null?void 0:t[e]}}var CU=PU,MU=h2;function NU(e){return function(t){return MU(t,e)}}var OU=NU,AU=CU,EU=OU,TU=o2,IU=om;function RU(e){return TU(e)?AU(IU(e)):EU(e)}var DU=RU,$U=QF,LU=_U,BU=hd,FU=gi,UU=DU;function GU(e){return typeof e=="function"?e:e==null?BU:typeof e=="object"?FU(e)?LU(e[0],e[1]):$U(e):UU(e)}var kl=GU;function zU(e,t,r,n){for(var a=e.length,i=r+(n?1:-1);n?i--:++i<a;)if(t(e[i],i,e))return i;return-1}var nM=zU;function WU(e){return e!==e}var VU=WU;function HU(e,t,r){for(var n=r-1,a=e.length;++n<a;)if(e[n]===t)return n;return-1}var XU=HU,KU=nM,YU=VU,qU=XU;function ZU(e,t,r){return t===t?qU(e,t,r):KU(e,YU,r)}var JU=ZU,QU=JU;function eG(e,t){var r=e==null?0:e.length;return!!r&&QU(e,t,0)>-1}var tG=eG;function rG(e,t,r){for(var n=-1,a=e==null?0:e.length;++n<a;)if(r(t,e[n]))return!0;return!1}var nG=rG;function aG(){}var iG=aG,Hy=JC,oG=iG,sG=k2,lG=1/0,cG=Hy&&1/sG(new Hy([,-0]))[1]==lG?function(e){return new Hy(e)}:oG,uG=cG,dG=GC,fG=tG,hG=nG,pG=WC,gG=uG,mG=k2,yG=200;function xG(e,t,r){var n=-1,a=fG,i=e.length,o=!0,s=[],l=s;if(r)o=!1,a=hG;else if(i>=yG){var u=t?null:gG(e);if(u)return mG(u);o=!1,a=pG,l=new dG}else l=t?[]:s;e:for(;++n<i;){var d=e[n],f=t?t(d):d;if(d=r||d!==0?d:0,o&&f===f){for(var h=l.length;h--;)if(l[h]===f)continue e;t&&l.push(f),s.push(d)}else a(l,f,r)||(l!==s&&l.push(f),s.push(d))}return s}var vG=xG,bG=kl,wG=vG;function kG(e,t){return e&&e.length?wG(e,bG(t)):[]}var SG=kG;const qS=dn(SG);function aM(e,t,r){return t===!0?qS(e,r):ar(t)?qS(e,t):e}function Nu(e){"@babel/helpers - typeof";return Nu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Nu(e)}var _G=["ref"];function ZS(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function qo(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?ZS(Object(r),!0).forEach(function(n){Sm(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ZS(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function jG(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function JS(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,oM(n.key),n)}}function PG(e,t,r){return t&&JS(e.prototype,t),r&&JS(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function CG(e,t,r){return t=Fp(t),MG(e,iM()?Reflect.construct(t,r||[],Fp(e).constructor):t.apply(e,r))}function MG(e,t){if(t&&(Nu(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return NG(e)}function NG(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function iM(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(iM=function(){return!!e})()}function Fp(e){return Fp=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Fp(e)}function OG(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Uv(e,t)}function Uv(e,t){return Uv=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},Uv(e,t)}function Sm(e,t,r){return t=oM(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function oM(e){var t=AG(e,"string");return Nu(t)=="symbol"?t:t+""}function AG(e,t){if(Nu(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(Nu(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}function EG(e,t){if(e==null)return{};var r=TG(e,t),n,a;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function TG(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function IG(e){return e.value}function RG(e,t){if(oe.isValidElement(e))return oe.cloneElement(e,t);if(typeof e=="function")return oe.createElement(e,t);t.ref;var r=EG(t,_G);return oe.createElement(w2,r)}var QS=1,Do=function(e){function t(){var r;jG(this,t);for(var n=arguments.length,a=new Array(n),i=0;i<n;i++)a[i]=arguments[i];return r=CG(this,t,[].concat(a)),Sm(r,"lastBoundingBox",{width:-1,height:-1}),r}return OG(t,e),PG(t,[{key:"componentDidMount",value:function(){this.updateBBox()}},{key:"componentDidUpdate",value:function(){this.updateBBox()}},{key:"getBBox",value:function(){if(this.wrapperNode&&this.wrapperNode.getBoundingClientRect){var n=this.wrapperNode.getBoundingClientRect();return n.height=this.wrapperNode.offsetHeight,n.width=this.wrapperNode.offsetWidth,n}return null}},{key:"updateBBox",value:function(){var n=this.props.onBBoxUpdate,a=this.getBBox();a?(Math.abs(a.width-this.lastBoundingBox.width)>QS||Math.abs(a.height-this.lastBoundingBox.height)>QS)&&(this.lastBoundingBox.width=a.width,this.lastBoundingBox.height=a.height,n&&n(a)):(this.lastBoundingBox.width!==-1||this.lastBoundingBox.height!==-1)&&(this.lastBoundingBox.width=-1,this.lastBoundingBox.height=-1,n&&n(null))}},{key:"getBBoxSnapshot",value:function(){return this.lastBoundingBox.width>=0&&this.lastBoundingBox.height>=0?qo({},this.lastBoundingBox):{width:0,height:0}}},{key:"getDefaultPosition",value:function(n){var a=this.props,i=a.layout,o=a.align,s=a.verticalAlign,l=a.margin,u=a.chartWidth,d=a.chartHeight,f,h;if(!n||(n.left===void 0||n.left===null)&&(n.right===void 0||n.right===null))if(o==="center"&&i==="vertical"){var g=this.getBBoxSnapshot();f={left:((u||0)-g.width)/2}}else f=o==="right"?{right:l&&l.right||0}:{left:l&&l.left||0};if(!n||(n.top===void 0||n.top===null)&&(n.bottom===void 0||n.bottom===null))if(s==="middle"){var v=this.getBBoxSnapshot();h={top:((d||0)-v.height)/2}}else h=s==="bottom"?{bottom:l&&l.bottom||0}:{top:l&&l.top||0};return qo(qo({},f),h)}},{key:"render",value:function(){var n=this,a=this.props,i=a.content,o=a.width,s=a.height,l=a.wrapperStyle,u=a.payloadUniqBy,d=a.payload,f=qo(qo({position:"absolute",width:o||"auto",height:s||"auto"},this.getDefaultPosition(l)),l);return oe.createElement("div",{className:"recharts-legend-wrapper",style:f,ref:function(g){n.wrapperNode=g}},RG(i,qo(qo({},this.props),{},{payload:aM(d,u,IG)})))}}],[{key:"getWithHeight",value:function(n,a){var i=qo(qo({},this.defaultProps),n.props),o=i.layout;return o==="vertical"&&We(n.props.height)?{height:n.props.height}:o==="horizontal"?{width:n.props.width||a}:null}}])}(P.PureComponent);Sm(Do,"displayName","Legend");Sm(Do,"defaultProps",{iconSize:14,layout:"horizontal",align:"center",verticalAlign:"bottom"});var e3=R0,DG=S2,$G=gi,t3=e3?e3.isConcatSpreadable:void 0;function LG(e){return $G(e)||DG(e)||!!(t3&&e&&e[t3])}var BG=LG,FG=HC,UG=BG;function sM(e,t,r,n,a){var i=-1,o=e.length;for(r||(r=UG),a||(a=[]);++i<o;){var s=e[i];t>0&&r(s)?t>1?sM(s,t-1,r,n,a):FG(a,s):n||(a[a.length]=s)}return a}var lM=sM;function GG(e){return function(t,r,n){for(var a=-1,i=Object(t),o=n(t),s=o.length;s--;){var l=o[e?s:++a];if(r(i[l],l,i)===!1)break}return t}}var zG=GG,WG=zG,VG=WG(),HG=VG,XG=HG,KG=km;function YG(e,t){return e&&XG(e,t,KG)}var cM=YG,qG=D0;function ZG(e,t){return function(r,n){if(r==null)return r;if(!qG(r))return e(r,n);for(var a=r.length,i=t?a:-1,o=Object(r);(t?i--:++i<a)&&n(o[i],i,o)!==!1;);return r}}var JG=ZG,QG=cM,ez=JG,tz=ez(QG),C2=tz,rz=C2,nz=D0;function az(e,t){var r=-1,n=nz(e)?Array(e.length):[];return rz(e,function(a,i,o){n[++r]=t(a,i,o)}),n}var uM=az;function iz(e,t){var r=e.length;for(e.sort(t);r--;)e[r]=e[r].value;return e}var oz=iz,r3=id;function sz(e,t){if(e!==t){var r=e!==void 0,n=e===null,a=e===e,i=r3(e),o=t!==void 0,s=t===null,l=t===t,u=r3(t);if(!s&&!u&&!i&&e>t||i&&o&&l&&!s&&!u||n&&o&&l||!r&&l||!a)return 1;if(!n&&!i&&!u&&e<t||u&&r&&a&&!n&&!i||s&&r&&a||!o&&a||!l)return-1}return 0}var lz=sz,cz=lz;function uz(e,t,r){for(var n=-1,a=e.criteria,i=t.criteria,o=a.length,s=r.length;++n<o;){var l=cz(a[n],i[n]);if(l){if(n>=s)return l;var u=r[n];return l*(u=="desc"?-1:1)}}return e.index-t.index}var dz=uz,Xy=f2,fz=h2,hz=kl,pz=uM,gz=oz,mz=YC,yz=dz,xz=hd,vz=gi;function bz(e,t,r){t.length?t=Xy(t,function(i){return vz(i)?function(o){return fz(o,i.length===1?i[0]:i)}:i}):t=[xz];var n=-1;t=Xy(t,mz(hz));var a=pz(e,function(i,o,s){var l=Xy(t,function(u){return u(i)});return{criteria:l,index:++n,value:i}});return gz(a,function(i,o){return yz(i,o,r)})}var wz=bz;function kz(e,t,r){switch(r.length){case 0:return e.call(t);case 1:return e.call(t,r[0]);case 2:return e.call(t,r[0],r[1]);case 3:return e.call(t,r[0],r[1],r[2])}return e.apply(t,r)}var Sz=kz,_z=Sz,n3=Math.max;function jz(e,t,r){return t=n3(t===void 0?e.length-1:t,0),function(){for(var n=arguments,a=-1,i=n3(n.length-t,0),o=Array(i);++a<i;)o[a]=n[t+a];a=-1;for(var s=Array(t+1);++a<t;)s[a]=n[a];return s[t]=r(o),_z(e,this,s)}}var Pz=jz;function Cz(e){return function(){return e}}var Mz=Cz,Nz=kc,Oz=function(){try{var e=Nz(Object,"defineProperty");return e({},"",{}),e}catch{}}(),dM=Oz,Az=Mz,a3=dM,Ez=hd,Tz=a3?function(e,t){return a3(e,"toString",{configurable:!0,enumerable:!1,value:Az(t),writable:!0})}:Ez,Iz=Tz,Rz=800,Dz=16,$z=Date.now;function Lz(e){var t=0,r=0;return function(){var n=$z(),a=Dz-(n-r);if(r=n,a>0){if(++t>=Rz)return arguments[0]}else t=0;return e.apply(void 0,arguments)}}var Bz=Lz,Fz=Iz,Uz=Bz,Gz=Uz(Fz),zz=Gz,Wz=hd,Vz=Pz,Hz=zz;function Xz(e,t){return Hz(Vz(e,t,Wz),e+"")}var Kz=Xz,Yz=l2,qz=D0,Zz=_2,Jz=wl;function Qz(e,t,r){if(!Jz(r))return!1;var n=typeof t;return(n=="number"?qz(r)&&Zz(t,r.length):n=="string"&&t in r)?Yz(r[t],e):!1}var _m=Qz,eW=lM,tW=wz,rW=Kz,i3=_m,nW=rW(function(e,t){if(e==null)return[];var r=t.length;return r>1&&i3(e,t[0],t[1])?t=[]:r>2&&i3(t[0],t[1],t[2])&&(t=[t[0]]),tW(e,eW(t,1),[])}),aW=nW;const M2=dn(aW);function Zf(e){"@babel/helpers - typeof";return Zf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Zf(e)}function Gv(){return Gv=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Gv.apply(this,arguments)}function iW(e,t){return cW(e)||lW(e,t)||sW(e,t)||oW()}function oW(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function sW(e,t){if(e){if(typeof e=="string")return o3(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return o3(e,t)}}function o3(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function lW(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,a,i,o,s=[],l=!0,u=!1;try{if(i=(r=r.call(e)).next,t!==0)for(;!(l=(n=i.call(r)).done)&&(s.push(n.value),s.length!==t);l=!0);}catch(d){u=!0,a=d}finally{try{if(!l&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(u)throw a}}return s}}function cW(e){if(Array.isArray(e))return e}function s3(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Ky(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?s3(Object(r),!0).forEach(function(n){uW(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):s3(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function uW(e,t,r){return t=dW(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function dW(e){var t=fW(e,"string");return Zf(t)=="symbol"?t:t+""}function fW(e,t){if(Zf(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(Zf(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function hW(e){return Array.isArray(e)&&sa(e[0])&&sa(e[1])?e.join(" ~ "):e}var pW=function(t){var r=t.separator,n=r===void 0?" : ":r,a=t.contentStyle,i=a===void 0?{}:a,o=t.itemStyle,s=o===void 0?{}:o,l=t.labelStyle,u=l===void 0?{}:l,d=t.payload,f=t.formatter,h=t.itemSorter,g=t.wrapperClassName,v=t.labelClassName,w=t.label,b=t.labelFormatter,x=t.accessibilityLayer,y=x===void 0?!1:x,_=function(){if(d&&d.length){var $={padding:0,margin:0},B=(h?M2(d,h):d).map(function(J,W){if(J.type==="none")return null;var I=Ky({display:"block",paddingTop:4,paddingBottom:4,color:J.color||"#000"},s),G=J.formatter||f||hW,U=J.value,X=J.name,V=U,z=X;if(G&&V!=null&&z!=null){var q=G(U,X,J,W,d);if(Array.isArray(q)){var te=iW(q,2);V=te[0],z=te[1]}else V=q}return oe.createElement("li",{className:"recharts-tooltip-item",key:"tooltip-item-".concat(W),style:I},sa(z)?oe.createElement("span",{className:"recharts-tooltip-item-name"},z):null,sa(z)?oe.createElement("span",{className:"recharts-tooltip-item-separator"},n):null,oe.createElement("span",{className:"recharts-tooltip-item-value"},V),oe.createElement("span",{className:"recharts-tooltip-item-unit"},J.unit||""))});return oe.createElement("ul",{className:"recharts-tooltip-item-list",style:$},B)}return null},j=Ky({margin:0,padding:10,backgroundColor:"#fff",border:"1px solid #ccc",whiteSpace:"nowrap"},i),S=Ky({margin:0},u),k=!qt(w),M=k?w:"",N=Nr("recharts-default-tooltip",g),T=Nr("recharts-tooltip-label",v);k&&b&&d!==void 0&&d!==null&&(M=b(w,d));var A=y?{role:"status","aria-live":"assertive"}:{};return oe.createElement("div",Gv({className:N,style:j},A),oe.createElement("p",{className:T,style:S},oe.isValidElement(M)?M:"".concat(M)),_())};function Jf(e){"@babel/helpers - typeof";return Jf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Jf(e)}function kh(e,t,r){return t=gW(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function gW(e){var t=mW(e,"string");return Jf(t)=="symbol"?t:t+""}function mW(e,t){if(Jf(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(Jf(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Yd="recharts-tooltip-wrapper",yW={visibility:"hidden"};function xW(e){var t=e.coordinate,r=e.translateX,n=e.translateY;return Nr(Yd,kh(kh(kh(kh({},"".concat(Yd,"-right"),We(r)&&t&&We(t.x)&&r>=t.x),"".concat(Yd,"-left"),We(r)&&t&&We(t.x)&&r<t.x),"".concat(Yd,"-bottom"),We(n)&&t&&We(t.y)&&n>=t.y),"".concat(Yd,"-top"),We(n)&&t&&We(t.y)&&n<t.y))}function l3(e){var t=e.allowEscapeViewBox,r=e.coordinate,n=e.key,a=e.offsetTopLeft,i=e.position,o=e.reverseDirection,s=e.tooltipDimension,l=e.viewBox,u=e.viewBoxDimension;if(i&&We(i[n]))return i[n];var d=r[n]-s-a,f=r[n]+a;if(t[n])return o[n]?d:f;if(o[n]){var h=d,g=l[n];return h<g?Math.max(f,l[n]):Math.max(d,l[n])}var v=f+s,w=l[n]+u;return v>w?Math.max(d,l[n]):Math.max(f,l[n])}function vW(e){var t=e.translateX,r=e.translateY,n=e.useTranslate3d;return{transform:n?"translate3d(".concat(t,"px, ").concat(r,"px, 0)"):"translate(".concat(t,"px, ").concat(r,"px)")}}function bW(e){var t=e.allowEscapeViewBox,r=e.coordinate,n=e.offsetTopLeft,a=e.position,i=e.reverseDirection,o=e.tooltipBox,s=e.useTranslate3d,l=e.viewBox,u,d,f;return o.height>0&&o.width>0&&r?(d=l3({allowEscapeViewBox:t,coordinate:r,key:"x",offsetTopLeft:n,position:a,reverseDirection:i,tooltipDimension:o.width,viewBox:l,viewBoxDimension:l.width}),f=l3({allowEscapeViewBox:t,coordinate:r,key:"y",offsetTopLeft:n,position:a,reverseDirection:i,tooltipDimension:o.height,viewBox:l,viewBoxDimension:l.height}),u=vW({translateX:d,translateY:f,useTranslate3d:s})):u=yW,{cssProperties:u,cssClasses:xW({translateX:d,translateY:f,coordinate:r})}}function Ou(e){"@babel/helpers - typeof";return Ou=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ou(e)}function c3(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function u3(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?c3(Object(r),!0).forEach(function(n){Wv(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):c3(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function wW(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function kW(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,hM(n.key),n)}}function SW(e,t,r){return t&&kW(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function _W(e,t,r){return t=Up(t),jW(e,fM()?Reflect.construct(t,r||[],Up(e).constructor):t.apply(e,r))}function jW(e,t){if(t&&(Ou(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return PW(e)}function PW(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function fM(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(fM=function(){return!!e})()}function Up(e){return Up=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Up(e)}function CW(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&zv(e,t)}function zv(e,t){return zv=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},zv(e,t)}function Wv(e,t,r){return t=hM(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function hM(e){var t=MW(e,"string");return Ou(t)=="symbol"?t:t+""}function MW(e,t){if(Ou(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(Ou(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var d3=1,NW=function(e){function t(){var r;wW(this,t);for(var n=arguments.length,a=new Array(n),i=0;i<n;i++)a[i]=arguments[i];return r=_W(this,t,[].concat(a)),Wv(r,"state",{dismissed:!1,dismissedAtCoordinate:{x:0,y:0},lastBoundingBox:{width:-1,height:-1}}),Wv(r,"handleKeyDown",function(o){if(o.key==="Escape"){var s,l,u,d;r.setState({dismissed:!0,dismissedAtCoordinate:{x:(s=(l=r.props.coordinate)===null||l===void 0?void 0:l.x)!==null&&s!==void 0?s:0,y:(u=(d=r.props.coordinate)===null||d===void 0?void 0:d.y)!==null&&u!==void 0?u:0}})}}),r}return CW(t,e),SW(t,[{key:"updateBBox",value:function(){if(this.wrapperNode&&this.wrapperNode.getBoundingClientRect){var n=this.wrapperNode.getBoundingClientRect();(Math.abs(n.width-this.state.lastBoundingBox.width)>d3||Math.abs(n.height-this.state.lastBoundingBox.height)>d3)&&this.setState({lastBoundingBox:{width:n.width,height:n.height}})}else(this.state.lastBoundingBox.width!==-1||this.state.lastBoundingBox.height!==-1)&&this.setState({lastBoundingBox:{width:-1,height:-1}})}},{key:"componentDidMount",value:function(){document.addEventListener("keydown",this.handleKeyDown),this.updateBBox()}},{key:"componentWillUnmount",value:function(){document.removeEventListener("keydown",this.handleKeyDown)}},{key:"componentDidUpdate",value:function(){var n,a;this.props.active&&this.updateBBox(),this.state.dismissed&&(((n=this.props.coordinate)===null||n===void 0?void 0:n.x)!==this.state.dismissedAtCoordinate.x||((a=this.props.coordinate)===null||a===void 0?void 0:a.y)!==this.state.dismissedAtCoordinate.y)&&(this.state.dismissed=!1)}},{key:"render",value:function(){var n=this,a=this.props,i=a.active,o=a.allowEscapeViewBox,s=a.animationDuration,l=a.animationEasing,u=a.children,d=a.coordinate,f=a.hasPayload,h=a.isAnimationActive,g=a.offset,v=a.position,w=a.reverseDirection,b=a.useTranslate3d,x=a.viewBox,y=a.wrapperStyle,_=bW({allowEscapeViewBox:o,coordinate:d,offsetTopLeft:g,position:v,reverseDirection:w,tooltipBox:this.state.lastBoundingBox,useTranslate3d:b,viewBox:x}),j=_.cssClasses,S=_.cssProperties,k=u3(u3({transition:h&&i?"transform ".concat(s,"ms ").concat(l):void 0},S),{},{pointerEvents:"none",visibility:!this.state.dismissed&&i&&f?"visible":"hidden",position:"absolute",top:0,left:0},y);return oe.createElement("div",{tabIndex:-1,className:j,style:k,ref:function(N){n.wrapperNode=N}},u)}}])}(P.PureComponent),OW=function(){return!(typeof window<"u"&&window.document&&window.document.createElement&&window.setTimeout)},Sl={isSsr:OW()};function Au(e){"@babel/helpers - typeof";return Au=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Au(e)}function f3(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function h3(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?f3(Object(r),!0).forEach(function(n){N2(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):f3(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function AW(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function EW(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,gM(n.key),n)}}function TW(e,t,r){return t&&EW(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function IW(e,t,r){return t=Gp(t),RW(e,pM()?Reflect.construct(t,r||[],Gp(e).constructor):t.apply(e,r))}function RW(e,t){if(t&&(Au(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return DW(e)}function DW(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function pM(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(pM=function(){return!!e})()}function Gp(e){return Gp=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Gp(e)}function $W(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Vv(e,t)}function Vv(e,t){return Vv=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},Vv(e,t)}function N2(e,t,r){return t=gM(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function gM(e){var t=LW(e,"string");return Au(t)=="symbol"?t:t+""}function LW(e,t){if(Au(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(Au(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}function BW(e){return e.dataKey}function FW(e,t){return oe.isValidElement(e)?oe.cloneElement(e,t):typeof e=="function"?oe.createElement(e,t):oe.createElement(pW,t)}var aa=function(e){function t(){return AW(this,t),IW(this,t,arguments)}return $W(t,e),TW(t,[{key:"render",value:function(){var n=this,a=this.props,i=a.active,o=a.allowEscapeViewBox,s=a.animationDuration,l=a.animationEasing,u=a.content,d=a.coordinate,f=a.filterNull,h=a.isAnimationActive,g=a.offset,v=a.payload,w=a.payloadUniqBy,b=a.position,x=a.reverseDirection,y=a.useTranslate3d,_=a.viewBox,j=a.wrapperStyle,S=v??[];f&&S.length&&(S=aM(v.filter(function(M){return M.value!=null&&(M.hide!==!0||n.props.includeHidden)}),w,BW));var k=S.length>0;return oe.createElement(NW,{allowEscapeViewBox:o,animationDuration:s,animationEasing:l,isAnimationActive:h,active:i,coordinate:d,hasPayload:k,offset:g,position:b,reverseDirection:x,useTranslate3d:y,viewBox:_,wrapperStyle:j},FW(u,h3(h3({},this.props),{},{payload:S})))}}])}(P.PureComponent);N2(aa,"displayName","Tooltip");N2(aa,"defaultProps",{accessibilityLayer:!1,allowEscapeViewBox:{x:!1,y:!1},animationDuration:400,animationEasing:"ease",contentStyle:{},coordinate:{x:0,y:0},cursor:!0,cursorStyle:{},filterNull:!0,isAnimationActive:!Sl.isSsr,itemStyle:{},labelStyle:{},offset:10,reverseDirection:{x:!1,y:!1},separator:" : ",trigger:"hover",useTranslate3d:!1,viewBox:{x:0,y:0,height:0,width:0},wrapperStyle:{}});var UW=Wo,GW=function(){return UW.Date.now()},zW=GW,WW=/\s/;function VW(e){for(var t=e.length;t--&&WW.test(e.charAt(t)););return t}var HW=VW,XW=HW,KW=/^\s+/;function YW(e){return e&&e.slice(0,XW(e)+1).replace(KW,"")}var qW=YW,ZW=qW,p3=wl,JW=id,g3=NaN,QW=/^[-+]0x[0-9a-f]+$/i,eV=/^0b[01]+$/i,tV=/^0o[0-7]+$/i,rV=parseInt;function nV(e){if(typeof e=="number")return e;if(JW(e))return g3;if(p3(e)){var t=typeof e.valueOf=="function"?e.valueOf():e;e=p3(t)?t+"":t}if(typeof e!="string")return e===0?e:+e;e=ZW(e);var r=eV.test(e);return r||tV.test(e)?rV(e.slice(2),r?2:8):QW.test(e)?g3:+e}var mM=nV,aV=wl,Yy=zW,m3=mM,iV="Expected a function",oV=Math.max,sV=Math.min;function lV(e,t,r){var n,a,i,o,s,l,u=0,d=!1,f=!1,h=!0;if(typeof e!="function")throw new TypeError(iV);t=m3(t)||0,aV(r)&&(d=!!r.leading,f="maxWait"in r,i=f?oV(m3(r.maxWait)||0,t):i,h="trailing"in r?!!r.trailing:h);function g(k){var M=n,N=a;return n=a=void 0,u=k,o=e.apply(N,M),o}function v(k){return u=k,s=setTimeout(x,t),d?g(k):o}function w(k){var M=k-l,N=k-u,T=t-M;return f?sV(T,i-N):T}function b(k){var M=k-l,N=k-u;return l===void 0||M>=t||M<0||f&&N>=i}function x(){var k=Yy();if(b(k))return y(k);s=setTimeout(x,w(k))}function y(k){return s=void 0,h&&n?g(k):(n=a=void 0,o)}function _(){s!==void 0&&clearTimeout(s),u=0,n=l=a=s=void 0}function j(){return s===void 0?o:y(Yy())}function S(){var k=Yy(),M=b(k);if(n=arguments,a=this,l=k,M){if(s===void 0)return v(l);if(f)return clearTimeout(s),s=setTimeout(x,t),g(l)}return s===void 0&&(s=setTimeout(x,t)),o}return S.cancel=_,S.flush=j,S}var cV=lV,uV=cV,dV=wl,fV="Expected a function";function hV(e,t,r){var n=!0,a=!0;if(typeof e!="function")throw new TypeError(fV);return dV(r)&&(n="leading"in r?!!r.leading:n,a="trailing"in r?!!r.trailing:a),uV(e,t,{leading:n,maxWait:t,trailing:a})}var pV=hV;const yM=dn(pV);function Qf(e){"@babel/helpers - typeof";return Qf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Qf(e)}function y3(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Sh(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?y3(Object(r),!0).forEach(function(n){gV(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):y3(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function gV(e,t,r){return t=mV(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function mV(e){var t=yV(e,"string");return Qf(t)=="symbol"?t:t+""}function yV(e,t){if(Qf(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(Qf(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function xV(e,t){return kV(e)||wV(e,t)||bV(e,t)||vV()}function vV(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function bV(e,t){if(e){if(typeof e=="string")return x3(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return x3(e,t)}}function x3(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function wV(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,a,i,o,s=[],l=!0,u=!1;try{if(i=(r=r.call(e)).next,t!==0)for(;!(l=(n=i.call(r)).done)&&(s.push(n.value),s.length!==t);l=!0);}catch(d){u=!0,a=d}finally{try{if(!l&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(u)throw a}}return s}}function kV(e){if(Array.isArray(e))return e}var Oo=P.forwardRef(function(e,t){var r=e.aspect,n=e.initialDimension,a=n===void 0?{width:-1,height:-1}:n,i=e.width,o=i===void 0?"100%":i,s=e.height,l=s===void 0?"100%":s,u=e.minWidth,d=u===void 0?0:u,f=e.minHeight,h=e.maxHeight,g=e.children,v=e.debounce,w=v===void 0?0:v,b=e.id,x=e.className,y=e.onResize,_=e.style,j=_===void 0?{}:_,S=P.useRef(null),k=P.useRef();k.current=y,P.useImperativeHandle(t,function(){return Object.defineProperty(S.current,"current",{get:function(){return console.warn("The usage of ref.current.current is deprecated and will no longer be supported."),S.current},configurable:!0})});var M=P.useState({containerWidth:a.width,containerHeight:a.height}),N=xV(M,2),T=N[0],A=N[1],D=P.useCallback(function(B,J){A(function(W){var I=Math.round(B),G=Math.round(J);return W.containerWidth===I&&W.containerHeight===G?W:{containerWidth:I,containerHeight:G}})},[]);P.useEffect(function(){var B=function(X){var V,z=X[0].contentRect,q=z.width,te=z.height;D(q,te),(V=k.current)===null||V===void 0||V.call(k,q,te)};w>0&&(B=yM(B,w,{trailing:!0,leading:!1}));var J=new ResizeObserver(B),W=S.current.getBoundingClientRect(),I=W.width,G=W.height;return D(I,G),J.observe(S.current),function(){J.disconnect()}},[D,w]);var $=P.useMemo(function(){var B=T.containerWidth,J=T.containerHeight;if(B<0||J<0)return null;ss(zl(o)||zl(l),`The width(%s) and height(%s) are both fixed numbers,
       maybe you don't need to use a ResponsiveContainer.`,o,l),ss(!r||r>0,"The aspect(%s) must be greater than zero.",r);var W=zl(o)?B:o,I=zl(l)?J:l;r&&r>0&&(W?I=W/r:I&&(W=I*r),h&&I>h&&(I=h)),ss(W>0||I>0,`The width(%s) and height(%s) of chart should be greater than 0,
       please check the style of container, or the props width(%s) and height(%s),
       or add a minWidth(%s) or minHeight(%s) or use aspect(%s) to control the
       height and width.`,W,I,o,l,d,f,r);var G=!Array.isArray(g)&&os(g.type).endsWith("Chart");return oe.Children.map(g,function(U){return oe.isValidElement(U)?P.cloneElement(U,Sh({width:W,height:I},G?{style:Sh({height:"100%",width:"100%",maxHeight:I,maxWidth:W},U.props.style)}:{})):U})},[r,g,l,h,f,d,T,o]);return oe.createElement("div",{id:b?"".concat(b):void 0,className:Nr("recharts-responsive-container",x),style:Sh(Sh({},j),{},{width:o,height:l,minWidth:d,minHeight:f,maxHeight:h}),ref:S},$)}),O2=function(t){return null};O2.displayName="Cell";function e0(e){"@babel/helpers - typeof";return e0=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},e0(e)}function v3(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Hv(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?v3(Object(r),!0).forEach(function(n){SV(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):v3(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function SV(e,t,r){return t=_V(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _V(e){var t=jV(e,"string");return e0(t)=="symbol"?t:t+""}function jV(e,t){if(e0(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(e0(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Fc={widthCache:{},cacheCount:0},PV=2e3,CV={position:"absolute",top:"-20000px",left:0,padding:0,margin:0,border:"none",whiteSpace:"pre"},b3="recharts_measurement_span";function MV(e){var t=Hv({},e);return Object.keys(t).forEach(function(r){t[r]||delete t[r]}),t}var kf=function(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(t==null||Sl.isSsr)return{width:0,height:0};var n=MV(r),a=JSON.stringify({text:t,copyStyle:n});if(Fc.widthCache[a])return Fc.widthCache[a];try{var i=document.getElementById(b3);i||(i=document.createElement("span"),i.setAttribute("id",b3),i.setAttribute("aria-hidden","true"),document.body.appendChild(i));var o=Hv(Hv({},CV),n);Object.assign(i.style,o),i.textContent="".concat(t);var s=i.getBoundingClientRect(),l={width:s.width,height:s.height};return Fc.widthCache[a]=l,++Fc.cacheCount>PV&&(Fc.cacheCount=0,Fc.widthCache={}),l}catch{return{width:0,height:0}}},NV=function(t){return{top:t.top+window.scrollY-document.documentElement.clientTop,left:t.left+window.scrollX-document.documentElement.clientLeft}};function t0(e){"@babel/helpers - typeof";return t0=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},t0(e)}function zp(e,t){return TV(e)||EV(e,t)||AV(e,t)||OV()}function OV(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function AV(e,t){if(e){if(typeof e=="string")return w3(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return w3(e,t)}}function w3(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function EV(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,a,i,o,s=[],l=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=i.call(r)).done)&&(s.push(n.value),s.length!==t);l=!0);}catch(d){u=!0,a=d}finally{try{if(!l&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(u)throw a}}return s}}function TV(e){if(Array.isArray(e))return e}function IV(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function k3(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,DV(n.key),n)}}function RV(e,t,r){return t&&k3(e.prototype,t),r&&k3(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function DV(e){var t=$V(e,"string");return t0(t)=="symbol"?t:t+""}function $V(e,t){if(t0(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(t0(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var S3=/(-?\d+(?:\.\d+)?[a-zA-Z%]*)([*/])(-?\d+(?:\.\d+)?[a-zA-Z%]*)/,_3=/(-?\d+(?:\.\d+)?[a-zA-Z%]*)([+-])(-?\d+(?:\.\d+)?[a-zA-Z%]*)/,LV=/^px|cm|vh|vw|em|rem|%|mm|in|pt|pc|ex|ch|vmin|vmax|Q$/,BV=/(-?\d+(?:\.\d+)?)([a-zA-Z%]+)?/,xM={cm:96/2.54,mm:96/25.4,pt:96/72,pc:96/6,in:96,Q:96/(2.54*40),px:1},FV=Object.keys(xM),ru="NaN";function UV(e,t){return e*xM[t]}var _h=function(){function e(t,r){IV(this,e),this.num=t,this.unit=r,this.num=t,this.unit=r,Number.isNaN(t)&&(this.unit=""),r!==""&&!LV.test(r)&&(this.num=NaN,this.unit=""),FV.includes(r)&&(this.num=UV(t,r),this.unit="px")}return RV(e,[{key:"add",value:function(r){return this.unit!==r.unit?new e(NaN,""):new e(this.num+r.num,this.unit)}},{key:"subtract",value:function(r){return this.unit!==r.unit?new e(NaN,""):new e(this.num-r.num,this.unit)}},{key:"multiply",value:function(r){return this.unit!==""&&r.unit!==""&&this.unit!==r.unit?new e(NaN,""):new e(this.num*r.num,this.unit||r.unit)}},{key:"divide",value:function(r){return this.unit!==""&&r.unit!==""&&this.unit!==r.unit?new e(NaN,""):new e(this.num/r.num,this.unit||r.unit)}},{key:"toString",value:function(){return"".concat(this.num).concat(this.unit)}},{key:"isNaN",value:function(){return Number.isNaN(this.num)}}],[{key:"parse",value:function(r){var n,a=(n=BV.exec(r))!==null&&n!==void 0?n:[],i=zp(a,3),o=i[1],s=i[2];return new e(parseFloat(o),s??"")}}])}();function vM(e){if(e.includes(ru))return ru;for(var t=e;t.includes("*")||t.includes("/");){var r,n=(r=S3.exec(t))!==null&&r!==void 0?r:[],a=zp(n,4),i=a[1],o=a[2],s=a[3],l=_h.parse(i??""),u=_h.parse(s??""),d=o==="*"?l.multiply(u):l.divide(u);if(d.isNaN())return ru;t=t.replace(S3,d.toString())}for(;t.includes("+")||/.-\d+(?:\.\d+)?/.test(t);){var f,h=(f=_3.exec(t))!==null&&f!==void 0?f:[],g=zp(h,4),v=g[1],w=g[2],b=g[3],x=_h.parse(v??""),y=_h.parse(b??""),_=w==="+"?x.add(y):x.subtract(y);if(_.isNaN())return ru;t=t.replace(_3,_.toString())}return t}var j3=/\(([^()]*)\)/;function GV(e){for(var t=e;t.includes("(");){var r=j3.exec(t),n=zp(r,2),a=n[1];t=t.replace(j3,vM(a))}return t}function zV(e){var t=e.replace(/\s+/g,"");return t=GV(t),t=vM(t),t}function WV(e){try{return zV(e)}catch{return ru}}function qy(e){var t=WV(e.slice(5,-1));return t===ru?"":t}var VV=["x","y","lineHeight","capHeight","scaleToFit","textAnchor","verticalAnchor","fill"],HV=["dx","dy","angle","className","breakAll"];function Xv(){return Xv=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Xv.apply(this,arguments)}function P3(e,t){if(e==null)return{};var r=XV(e,t),n,a;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function XV(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function C3(e,t){return ZV(e)||qV(e,t)||YV(e,t)||KV()}function KV(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function YV(e,t){if(e){if(typeof e=="string")return M3(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return M3(e,t)}}function M3(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function qV(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,a,i,o,s=[],l=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=i.call(r)).done)&&(s.push(n.value),s.length!==t);l=!0);}catch(d){u=!0,a=d}finally{try{if(!l&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(u)throw a}}return s}}function ZV(e){if(Array.isArray(e))return e}var bM=/[ \f\n\r\t\v\u2028\u2029]+/,wM=function(t){var r=t.children,n=t.breakAll,a=t.style;try{var i=[];qt(r)||(n?i=r.toString().split(""):i=r.toString().split(bM));var o=i.map(function(l){return{word:l,width:kf(l,a).width}}),s=n?0:kf("",a).width;return{wordsWithComputedWidth:o,spaceWidth:s}}catch{return null}},JV=function(t,r,n,a,i){var o=t.maxLines,s=t.children,l=t.style,u=t.breakAll,d=We(o),f=s,h=function(){var W=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return W.reduce(function(I,G){var U=G.word,X=G.width,V=I[I.length-1];if(V&&(a==null||i||V.width+X+n<Number(a)))V.words.push(U),V.width+=X+n;else{var z={words:[U],width:X};I.push(z)}return I},[])},g=h(r),v=function(W){return W.reduce(function(I,G){return I.width>G.width?I:G})};if(!d)return g;for(var w="",b=function(W){var I=f.slice(0,W),G=wM({breakAll:u,style:l,children:I+w}).wordsWithComputedWidth,U=h(G),X=U.length>o||v(U).width>Number(a);return[X,U]},x=0,y=f.length-1,_=0,j;x<=y&&_<=f.length-1;){var S=Math.floor((x+y)/2),k=S-1,M=b(k),N=C3(M,2),T=N[0],A=N[1],D=b(S),$=C3(D,1),B=$[0];if(!T&&!B&&(x=S+1),T&&B&&(y=S-1),!T&&B){j=A;break}_++}return j||g},N3=function(t){var r=qt(t)?[]:t.toString().split(bM);return[{words:r}]},QV=function(t){var r=t.width,n=t.scaleToFit,a=t.children,i=t.style,o=t.breakAll,s=t.maxLines;if((r||n)&&!Sl.isSsr){var l,u,d=wM({breakAll:o,children:a,style:i});if(d){var f=d.wordsWithComputedWidth,h=d.spaceWidth;l=f,u=h}else return N3(a);return JV({breakAll:o,children:a,maxLines:s,style:i},l,u,r,n)}return N3(a)},O3="#808080",Wp=function(t){var r=t.x,n=r===void 0?0:r,a=t.y,i=a===void 0?0:a,o=t.lineHeight,s=o===void 0?"1em":o,l=t.capHeight,u=l===void 0?"0.71em":l,d=t.scaleToFit,f=d===void 0?!1:d,h=t.textAnchor,g=h===void 0?"start":h,v=t.verticalAnchor,w=v===void 0?"end":v,b=t.fill,x=b===void 0?O3:b,y=P3(t,VV),_=P.useMemo(function(){return QV({breakAll:y.breakAll,children:y.children,maxLines:y.maxLines,scaleToFit:f,style:y.style,width:y.width})},[y.breakAll,y.children,y.maxLines,f,y.style,y.width]),j=y.dx,S=y.dy,k=y.angle,M=y.className,N=y.breakAll,T=P3(y,HV);if(!sa(n)||!sa(i))return null;var A=n+(We(j)?j:0),D=i+(We(S)?S:0),$;switch(w){case"start":$=qy("calc(".concat(u,")"));break;case"middle":$=qy("calc(".concat((_.length-1)/2," * -").concat(s," + (").concat(u," / 2))"));break;default:$=qy("calc(".concat(_.length-1," * -").concat(s,")"));break}var B=[];if(f){var J=_[0].width,W=y.width;B.push("scale(".concat((We(W)?W/J:1)/J,")"))}return k&&B.push("rotate(".concat(k,", ").concat(A,", ").concat(D,")")),B.length&&(T.transform=B.join(" ")),oe.createElement("text",Xv({},er(T,!0),{x:A,y:D,className:Nr("recharts-text",M),textAnchor:g,fill:x.includes("url")?O3:x}),_.map(function(I,G){var U=I.words.join(N?"":" ");return oe.createElement("tspan",{x:A,dy:G===0?$:s,key:"".concat(U,"-").concat(G)},U)}))};function hl(e,t){return e==null||t==null?NaN:e<t?-1:e>t?1:e>=t?0:NaN}function eH(e,t){return e==null||t==null?NaN:t<e?-1:t>e?1:t>=e?0:NaN}function A2(e){let t,r,n;e.length!==2?(t=hl,r=(s,l)=>hl(e(s),l),n=(s,l)=>e(s)-l):(t=e===hl||e===eH?e:tH,r=e,n=e);function a(s,l,u=0,d=s.length){if(u<d){if(t(l,l)!==0)return d;do{const f=u+d>>>1;r(s[f],l)<0?u=f+1:d=f}while(u<d)}return u}function i(s,l,u=0,d=s.length){if(u<d){if(t(l,l)!==0)return d;do{const f=u+d>>>1;r(s[f],l)<=0?u=f+1:d=f}while(u<d)}return u}function o(s,l,u=0,d=s.length){const f=a(s,l,u,d-1);return f>u&&n(s[f-1],l)>-n(s[f],l)?f-1:f}return{left:a,center:o,right:i}}function tH(){return 0}function kM(e){return e===null?NaN:+e}function*rH(e,t){for(let r of e)r!=null&&(r=+r)>=r&&(yield r)}const nH=A2(hl),$0=nH.right;A2(kM).center;class A3 extends Map{constructor(t,r=oH){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:r}}),t!=null)for(const[n,a]of t)this.set(n,a)}get(t){return super.get(E3(this,t))}has(t){return super.has(E3(this,t))}set(t,r){return super.set(aH(this,t),r)}delete(t){return super.delete(iH(this,t))}}function E3({_intern:e,_key:t},r){const n=t(r);return e.has(n)?e.get(n):r}function aH({_intern:e,_key:t},r){const n=t(r);return e.has(n)?e.get(n):(e.set(n,r),r)}function iH({_intern:e,_key:t},r){const n=t(r);return e.has(n)&&(r=e.get(n),e.delete(n)),r}function oH(e){return e!==null&&typeof e=="object"?e.valueOf():e}function sH(e=hl){if(e===hl)return SM;if(typeof e!="function")throw new TypeError("compare is not a function");return(t,r)=>{const n=e(t,r);return n||n===0?n:(e(r,r)===0)-(e(t,t)===0)}}function SM(e,t){return(e==null||!(e>=e))-(t==null||!(t>=t))||(e<t?-1:e>t?1:0)}const lH=Math.sqrt(50),cH=Math.sqrt(10),uH=Math.sqrt(2);function Vp(e,t,r){const n=(t-e)/Math.max(0,r),a=Math.floor(Math.log10(n)),i=n/Math.pow(10,a),o=i>=lH?10:i>=cH?5:i>=uH?2:1;let s,l,u;return a<0?(u=Math.pow(10,-a)/o,s=Math.round(e*u),l=Math.round(t*u),s/u<e&&++s,l/u>t&&--l,u=-u):(u=Math.pow(10,a)*o,s=Math.round(e/u),l=Math.round(t/u),s*u<e&&++s,l*u>t&&--l),l<s&&.5<=r&&r<2?Vp(e,t,r*2):[s,l,u]}function Kv(e,t,r){if(t=+t,e=+e,r=+r,!(r>0))return[];if(e===t)return[e];const n=t<e,[a,i,o]=n?Vp(t,e,r):Vp(e,t,r);if(!(i>=a))return[];const s=i-a+1,l=new Array(s);if(n)if(o<0)for(let u=0;u<s;++u)l[u]=(i-u)/-o;else for(let u=0;u<s;++u)l[u]=(i-u)*o;else if(o<0)for(let u=0;u<s;++u)l[u]=(a+u)/-o;else for(let u=0;u<s;++u)l[u]=(a+u)*o;return l}function Yv(e,t,r){return t=+t,e=+e,r=+r,Vp(e,t,r)[2]}function qv(e,t,r){t=+t,e=+e,r=+r;const n=t<e,a=n?Yv(t,e,r):Yv(e,t,r);return(n?-1:1)*(a<0?1/-a:a)}function T3(e,t){let r;for(const n of e)n!=null&&(r<n||r===void 0&&n>=n)&&(r=n);return r}function I3(e,t){let r;for(const n of e)n!=null&&(r>n||r===void 0&&n>=n)&&(r=n);return r}function _M(e,t,r=0,n=1/0,a){if(t=Math.floor(t),r=Math.floor(Math.max(0,r)),n=Math.floor(Math.min(e.length-1,n)),!(r<=t&&t<=n))return e;for(a=a===void 0?SM:sH(a);n>r;){if(n-r>600){const l=n-r+1,u=t-r+1,d=Math.log(l),f=.5*Math.exp(2*d/3),h=.5*Math.sqrt(d*f*(l-f)/l)*(u-l/2<0?-1:1),g=Math.max(r,Math.floor(t-u*f/l+h)),v=Math.min(n,Math.floor(t+(l-u)*f/l+h));_M(e,t,g,v,a)}const i=e[t];let o=r,s=n;for(qd(e,r,t),a(e[n],i)>0&&qd(e,r,n);o<s;){for(qd(e,o,s),++o,--s;a(e[o],i)<0;)++o;for(;a(e[s],i)>0;)--s}a(e[r],i)===0?qd(e,r,s):(++s,qd(e,s,n)),s<=t&&(r=s+1),t<=s&&(n=s-1)}return e}function qd(e,t,r){const n=e[t];e[t]=e[r],e[r]=n}function dH(e,t,r){if(e=Float64Array.from(rH(e)),!(!(n=e.length)||isNaN(t=+t))){if(t<=0||n<2)return I3(e);if(t>=1)return T3(e);var n,a=(n-1)*t,i=Math.floor(a),o=T3(_M(e,i).subarray(0,i+1)),s=I3(e.subarray(i+1));return o+(s-o)*(a-i)}}function fH(e,t,r=kM){if(!(!(n=e.length)||isNaN(t=+t))){if(t<=0||n<2)return+r(e[0],0,e);if(t>=1)return+r(e[n-1],n-1,e);var n,a=(n-1)*t,i=Math.floor(a),o=+r(e[i],i,e),s=+r(e[i+1],i+1,e);return o+(s-o)*(a-i)}}function hH(e,t,r){e=+e,t=+t,r=(a=arguments.length)<2?(t=e,e=0,1):a<3?1:+r;for(var n=-1,a=Math.max(0,Math.ceil((t-e)/r))|0,i=new Array(a);++n<a;)i[n]=e+n*r;return i}function Yi(e,t){switch(arguments.length){case 0:break;case 1:this.range(e);break;default:this.range(t).domain(e);break}return this}function vs(e,t){switch(arguments.length){case 0:break;case 1:{typeof e=="function"?this.interpolator(e):this.range(e);break}default:{this.domain(e),typeof t=="function"?this.interpolator(t):this.range(t);break}}return this}const Zv=Symbol("implicit");function E2(){var e=new A3,t=[],r=[],n=Zv;function a(i){let o=e.get(i);if(o===void 0){if(n!==Zv)return n;e.set(i,o=t.push(i)-1)}return r[o%r.length]}return a.domain=function(i){if(!arguments.length)return t.slice();t=[],e=new A3;for(const o of i)e.has(o)||e.set(o,t.push(o)-1);return a},a.range=function(i){return arguments.length?(r=Array.from(i),a):r.slice()},a.unknown=function(i){return arguments.length?(n=i,a):n},a.copy=function(){return E2(t,r).unknown(n)},Yi.apply(a,arguments),a}function r0(){var e=E2().unknown(void 0),t=e.domain,r=e.range,n=0,a=1,i,o,s=!1,l=0,u=0,d=.5;delete e.unknown;function f(){var h=t().length,g=a<n,v=g?a:n,w=g?n:a;i=(w-v)/Math.max(1,h-l+u*2),s&&(i=Math.floor(i)),v+=(w-v-i*(h-l))*d,o=i*(1-l),s&&(v=Math.round(v),o=Math.round(o));var b=hH(h).map(function(x){return v+i*x});return r(g?b.reverse():b)}return e.domain=function(h){return arguments.length?(t(h),f()):t()},e.range=function(h){return arguments.length?([n,a]=h,n=+n,a=+a,f()):[n,a]},e.rangeRound=function(h){return[n,a]=h,n=+n,a=+a,s=!0,f()},e.bandwidth=function(){return o},e.step=function(){return i},e.round=function(h){return arguments.length?(s=!!h,f()):s},e.padding=function(h){return arguments.length?(l=Math.min(1,u=+h),f()):l},e.paddingInner=function(h){return arguments.length?(l=Math.min(1,h),f()):l},e.paddingOuter=function(h){return arguments.length?(u=+h,f()):u},e.align=function(h){return arguments.length?(d=Math.max(0,Math.min(1,h)),f()):d},e.copy=function(){return r0(t(),[n,a]).round(s).paddingInner(l).paddingOuter(u).align(d)},Yi.apply(f(),arguments)}function jM(e){var t=e.copy;return e.padding=e.paddingOuter,delete e.paddingInner,delete e.paddingOuter,e.copy=function(){return jM(t())},e}function Sf(){return jM(r0.apply(null,arguments).paddingInner(1))}function T2(e,t,r){e.prototype=t.prototype=r,r.constructor=e}function PM(e,t){var r=Object.create(e.prototype);for(var n in t)r[n]=t[n];return r}function L0(){}var n0=.7,Hp=1/n0,pu="\\s*([+-]?\\d+)\\s*",a0="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",$o="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",pH=/^#([0-9a-f]{3,8})$/,gH=new RegExp(`^rgb\\(${pu},${pu},${pu}\\)$`),mH=new RegExp(`^rgb\\(${$o},${$o},${$o}\\)$`),yH=new RegExp(`^rgba\\(${pu},${pu},${pu},${a0}\\)$`),xH=new RegExp(`^rgba\\(${$o},${$o},${$o},${a0}\\)$`),vH=new RegExp(`^hsl\\(${a0},${$o},${$o}\\)$`),bH=new RegExp(`^hsla\\(${a0},${$o},${$o},${a0}\\)$`),R3={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};T2(L0,i0,{copy(e){return Object.assign(new this.constructor,this,e)},displayable(){return this.rgb().displayable()},hex:D3,formatHex:D3,formatHex8:wH,formatHsl:kH,formatRgb:$3,toString:$3});function D3(){return this.rgb().formatHex()}function wH(){return this.rgb().formatHex8()}function kH(){return CM(this).formatHsl()}function $3(){return this.rgb().formatRgb()}function i0(e){var t,r;return e=(e+"").trim().toLowerCase(),(t=pH.exec(e))?(r=t[1].length,t=parseInt(t[1],16),r===6?L3(t):r===3?new ui(t>>8&15|t>>4&240,t>>4&15|t&240,(t&15)<<4|t&15,1):r===8?jh(t>>24&255,t>>16&255,t>>8&255,(t&255)/255):r===4?jh(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|t&240,((t&15)<<4|t&15)/255):null):(t=gH.exec(e))?new ui(t[1],t[2],t[3],1):(t=mH.exec(e))?new ui(t[1]*255/100,t[2]*255/100,t[3]*255/100,1):(t=yH.exec(e))?jh(t[1],t[2],t[3],t[4]):(t=xH.exec(e))?jh(t[1]*255/100,t[2]*255/100,t[3]*255/100,t[4]):(t=vH.exec(e))?U3(t[1],t[2]/100,t[3]/100,1):(t=bH.exec(e))?U3(t[1],t[2]/100,t[3]/100,t[4]):R3.hasOwnProperty(e)?L3(R3[e]):e==="transparent"?new ui(NaN,NaN,NaN,0):null}function L3(e){return new ui(e>>16&255,e>>8&255,e&255,1)}function jh(e,t,r,n){return n<=0&&(e=t=r=NaN),new ui(e,t,r,n)}function SH(e){return e instanceof L0||(e=i0(e)),e?(e=e.rgb(),new ui(e.r,e.g,e.b,e.opacity)):new ui}function Jv(e,t,r,n){return arguments.length===1?SH(e):new ui(e,t,r,n??1)}function ui(e,t,r,n){this.r=+e,this.g=+t,this.b=+r,this.opacity=+n}T2(ui,Jv,PM(L0,{brighter(e){return e=e==null?Hp:Math.pow(Hp,e),new ui(this.r*e,this.g*e,this.b*e,this.opacity)},darker(e){return e=e==null?n0:Math.pow(n0,e),new ui(this.r*e,this.g*e,this.b*e,this.opacity)},rgb(){return this},clamp(){return new ui(Zl(this.r),Zl(this.g),Zl(this.b),Xp(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:B3,formatHex:B3,formatHex8:_H,formatRgb:F3,toString:F3}));function B3(){return`#${Wl(this.r)}${Wl(this.g)}${Wl(this.b)}`}function _H(){return`#${Wl(this.r)}${Wl(this.g)}${Wl(this.b)}${Wl((isNaN(this.opacity)?1:this.opacity)*255)}`}function F3(){const e=Xp(this.opacity);return`${e===1?"rgb(":"rgba("}${Zl(this.r)}, ${Zl(this.g)}, ${Zl(this.b)}${e===1?")":`, ${e})`}`}function Xp(e){return isNaN(e)?1:Math.max(0,Math.min(1,e))}function Zl(e){return Math.max(0,Math.min(255,Math.round(e)||0))}function Wl(e){return e=Zl(e),(e<16?"0":"")+e.toString(16)}function U3(e,t,r,n){return n<=0?e=t=r=NaN:r<=0||r>=1?e=t=NaN:t<=0&&(e=NaN),new ho(e,t,r,n)}function CM(e){if(e instanceof ho)return new ho(e.h,e.s,e.l,e.opacity);if(e instanceof L0||(e=i0(e)),!e)return new ho;if(e instanceof ho)return e;e=e.rgb();var t=e.r/255,r=e.g/255,n=e.b/255,a=Math.min(t,r,n),i=Math.max(t,r,n),o=NaN,s=i-a,l=(i+a)/2;return s?(t===i?o=(r-n)/s+(r<n)*6:r===i?o=(n-t)/s+2:o=(t-r)/s+4,s/=l<.5?i+a:2-i-a,o*=60):s=l>0&&l<1?0:o,new ho(o,s,l,e.opacity)}function jH(e,t,r,n){return arguments.length===1?CM(e):new ho(e,t,r,n??1)}function ho(e,t,r,n){this.h=+e,this.s=+t,this.l=+r,this.opacity=+n}T2(ho,jH,PM(L0,{brighter(e){return e=e==null?Hp:Math.pow(Hp,e),new ho(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=e==null?n0:Math.pow(n0,e),new ho(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=this.h%360+(this.h<0)*360,t=isNaN(e)||isNaN(this.s)?0:this.s,r=this.l,n=r+(r<.5?r:1-r)*t,a=2*r-n;return new ui(Zy(e>=240?e-240:e+120,a,n),Zy(e,a,n),Zy(e<120?e+240:e-120,a,n),this.opacity)},clamp(){return new ho(G3(this.h),Ph(this.s),Ph(this.l),Xp(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const e=Xp(this.opacity);return`${e===1?"hsl(":"hsla("}${G3(this.h)}, ${Ph(this.s)*100}%, ${Ph(this.l)*100}%${e===1?")":`, ${e})`}`}}));function G3(e){return e=(e||0)%360,e<0?e+360:e}function Ph(e){return Math.max(0,Math.min(1,e||0))}function Zy(e,t,r){return(e<60?t+(r-t)*e/60:e<180?r:e<240?t+(r-t)*(240-e)/60:t)*255}const I2=e=>()=>e;function PH(e,t){return function(r){return e+r*t}}function CH(e,t,r){return e=Math.pow(e,r),t=Math.pow(t,r)-e,r=1/r,function(n){return Math.pow(e+n*t,r)}}function MH(e){return(e=+e)==1?MM:function(t,r){return r-t?CH(t,r,e):I2(isNaN(t)?r:t)}}function MM(e,t){var r=t-e;return r?PH(e,r):I2(isNaN(e)?t:e)}const z3=function e(t){var r=MH(t);function n(a,i){var o=r((a=Jv(a)).r,(i=Jv(i)).r),s=r(a.g,i.g),l=r(a.b,i.b),u=MM(a.opacity,i.opacity);return function(d){return a.r=o(d),a.g=s(d),a.b=l(d),a.opacity=u(d),a+""}}return n.gamma=e,n}(1);function NH(e,t){t||(t=[]);var r=e?Math.min(t.length,e.length):0,n=t.slice(),a;return function(i){for(a=0;a<r;++a)n[a]=e[a]*(1-i)+t[a]*i;return n}}function OH(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}function AH(e,t){var r=t?t.length:0,n=e?Math.min(r,e.length):0,a=new Array(n),i=new Array(r),o;for(o=0;o<n;++o)a[o]=pd(e[o],t[o]);for(;o<r;++o)i[o]=t[o];return function(s){for(o=0;o<n;++o)i[o]=a[o](s);return i}}function EH(e,t){var r=new Date;return e=+e,t=+t,function(n){return r.setTime(e*(1-n)+t*n),r}}function Kp(e,t){return e=+e,t=+t,function(r){return e*(1-r)+t*r}}function TH(e,t){var r={},n={},a;(e===null||typeof e!="object")&&(e={}),(t===null||typeof t!="object")&&(t={});for(a in t)a in e?r[a]=pd(e[a],t[a]):n[a]=t[a];return function(i){for(a in r)n[a]=r[a](i);return n}}var Qv=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,Jy=new RegExp(Qv.source,"g");function IH(e){return function(){return e}}function RH(e){return function(t){return e(t)+""}}function DH(e,t){var r=Qv.lastIndex=Jy.lastIndex=0,n,a,i,o=-1,s=[],l=[];for(e=e+"",t=t+"";(n=Qv.exec(e))&&(a=Jy.exec(t));)(i=a.index)>r&&(i=t.slice(r,i),s[o]?s[o]+=i:s[++o]=i),(n=n[0])===(a=a[0])?s[o]?s[o]+=a:s[++o]=a:(s[++o]=null,l.push({i:o,x:Kp(n,a)})),r=Jy.lastIndex;return r<t.length&&(i=t.slice(r),s[o]?s[o]+=i:s[++o]=i),s.length<2?l[0]?RH(l[0].x):IH(t):(t=l.length,function(u){for(var d=0,f;d<t;++d)s[(f=l[d]).i]=f.x(u);return s.join("")})}function pd(e,t){var r=typeof t,n;return t==null||r==="boolean"?I2(t):(r==="number"?Kp:r==="string"?(n=i0(t))?(t=n,z3):DH:t instanceof i0?z3:t instanceof Date?EH:OH(t)?NH:Array.isArray(t)?AH:typeof t.valueOf!="function"&&typeof t.toString!="function"||isNaN(t)?TH:Kp)(e,t)}function R2(e,t){return e=+e,t=+t,function(r){return Math.round(e*(1-r)+t*r)}}function $H(e,t){t===void 0&&(t=e,e=pd);for(var r=0,n=t.length-1,a=t[0],i=new Array(n<0?0:n);r<n;)i[r]=e(a,a=t[++r]);return function(o){var s=Math.max(0,Math.min(n-1,Math.floor(o*=n)));return i[s](o-s)}}function LH(e){return function(){return e}}function Yp(e){return+e}var W3=[0,1];function Xa(e){return e}function e1(e,t){return(t-=e=+e)?function(r){return(r-e)/t}:LH(isNaN(t)?NaN:.5)}function BH(e,t){var r;return e>t&&(r=e,e=t,t=r),function(n){return Math.max(e,Math.min(t,n))}}function FH(e,t,r){var n=e[0],a=e[1],i=t[0],o=t[1];return a<n?(n=e1(a,n),i=r(o,i)):(n=e1(n,a),i=r(i,o)),function(s){return i(n(s))}}function UH(e,t,r){var n=Math.min(e.length,t.length)-1,a=new Array(n),i=new Array(n),o=-1;for(e[n]<e[0]&&(e=e.slice().reverse(),t=t.slice().reverse());++o<n;)a[o]=e1(e[o],e[o+1]),i[o]=r(t[o],t[o+1]);return function(s){var l=$0(e,s,1,n)-1;return i[l](a[l](s))}}function B0(e,t){return t.domain(e.domain()).range(e.range()).interpolate(e.interpolate()).clamp(e.clamp()).unknown(e.unknown())}function jm(){var e=W3,t=W3,r=pd,n,a,i,o=Xa,s,l,u;function d(){var h=Math.min(e.length,t.length);return o!==Xa&&(o=BH(e[0],e[h-1])),s=h>2?UH:FH,l=u=null,f}function f(h){return h==null||isNaN(h=+h)?i:(l||(l=s(e.map(n),t,r)))(n(o(h)))}return f.invert=function(h){return o(a((u||(u=s(t,e.map(n),Kp)))(h)))},f.domain=function(h){return arguments.length?(e=Array.from(h,Yp),d()):e.slice()},f.range=function(h){return arguments.length?(t=Array.from(h),d()):t.slice()},f.rangeRound=function(h){return t=Array.from(h),r=R2,d()},f.clamp=function(h){return arguments.length?(o=h?!0:Xa,d()):o!==Xa},f.interpolate=function(h){return arguments.length?(r=h,d()):r},f.unknown=function(h){return arguments.length?(i=h,f):i},function(h,g){return n=h,a=g,d()}}function D2(){return jm()(Xa,Xa)}function GH(e){return Math.abs(e=Math.round(e))>=1e21?e.toLocaleString("en").replace(/,/g,""):e.toString(10)}function qp(e,t){if(!isFinite(e)||e===0)return null;var r=(e=t?e.toExponential(t-1):e.toExponential()).indexOf("e"),n=e.slice(0,r);return[n.length>1?n[0]+n.slice(2):n,+e.slice(r+1)]}function Eu(e){return e=qp(Math.abs(e)),e?e[1]:NaN}function zH(e,t){return function(r,n){for(var a=r.length,i=[],o=0,s=e[0],l=0;a>0&&s>0&&(l+s+1>n&&(s=Math.max(1,n-l)),i.push(r.substring(a-=s,a+s)),!((l+=s+1)>n));)s=e[o=(o+1)%e.length];return i.reverse().join(t)}}function WH(e){return function(t){return t.replace(/[0-9]/g,function(r){return e[+r]})}}var VH=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function o0(e){if(!(t=VH.exec(e)))throw new Error("invalid format: "+e);var t;return new $2({fill:t[1],align:t[2],sign:t[3],symbol:t[4],zero:t[5],width:t[6],comma:t[7],precision:t[8]&&t[8].slice(1),trim:t[9],type:t[10]})}o0.prototype=$2.prototype;function $2(e){this.fill=e.fill===void 0?" ":e.fill+"",this.align=e.align===void 0?">":e.align+"",this.sign=e.sign===void 0?"-":e.sign+"",this.symbol=e.symbol===void 0?"":e.symbol+"",this.zero=!!e.zero,this.width=e.width===void 0?void 0:+e.width,this.comma=!!e.comma,this.precision=e.precision===void 0?void 0:+e.precision,this.trim=!!e.trim,this.type=e.type===void 0?"":e.type+""}$2.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function HH(e){e:for(var t=e.length,r=1,n=-1,a;r<t;++r)switch(e[r]){case".":n=a=r;break;case"0":n===0&&(n=r),a=r;break;default:if(!+e[r])break e;n>0&&(n=0);break}return n>0?e.slice(0,n)+e.slice(a+1):e}var Zp;function XH(e,t){var r=qp(e,t);if(!r)return Zp=void 0,e.toPrecision(t);var n=r[0],a=r[1],i=a-(Zp=Math.max(-8,Math.min(8,Math.floor(a/3)))*3)+1,o=n.length;return i===o?n:i>o?n+new Array(i-o+1).join("0"):i>0?n.slice(0,i)+"."+n.slice(i):"0."+new Array(1-i).join("0")+qp(e,Math.max(0,t+i-1))[0]}function V3(e,t){var r=qp(e,t);if(!r)return e+"";var n=r[0],a=r[1];return a<0?"0."+new Array(-a).join("0")+n:n.length>a+1?n.slice(0,a+1)+"."+n.slice(a+1):n+new Array(a-n.length+2).join("0")}const H3={"%":(e,t)=>(e*100).toFixed(t),b:e=>Math.round(e).toString(2),c:e=>e+"",d:GH,e:(e,t)=>e.toExponential(t),f:(e,t)=>e.toFixed(t),g:(e,t)=>e.toPrecision(t),o:e=>Math.round(e).toString(8),p:(e,t)=>V3(e*100,t),r:V3,s:XH,X:e=>Math.round(e).toString(16).toUpperCase(),x:e=>Math.round(e).toString(16)};function X3(e){return e}var K3=Array.prototype.map,Y3=["y","z","a","f","p","n","","m","","k","M","G","T","P","E","Z","Y"];function KH(e){var t=e.grouping===void 0||e.thousands===void 0?X3:zH(K3.call(e.grouping,Number),e.thousands+""),r=e.currency===void 0?"":e.currency[0]+"",n=e.currency===void 0?"":e.currency[1]+"",a=e.decimal===void 0?".":e.decimal+"",i=e.numerals===void 0?X3:WH(K3.call(e.numerals,String)),o=e.percent===void 0?"%":e.percent+"",s=e.minus===void 0?"":e.minus+"",l=e.nan===void 0?"NaN":e.nan+"";function u(f,h){f=o0(f);var g=f.fill,v=f.align,w=f.sign,b=f.symbol,x=f.zero,y=f.width,_=f.comma,j=f.precision,S=f.trim,k=f.type;k==="n"?(_=!0,k="g"):H3[k]||(j===void 0&&(j=12),S=!0,k="g"),(x||g==="0"&&v==="=")&&(x=!0,g="0",v="=");var M=(h&&h.prefix!==void 0?h.prefix:"")+(b==="$"?r:b==="#"&&/[boxX]/.test(k)?"0"+k.toLowerCase():""),N=(b==="$"?n:/[%p]/.test(k)?o:"")+(h&&h.suffix!==void 0?h.suffix:""),T=H3[k],A=/[defgprs%]/.test(k);j=j===void 0?6:/[gprs]/.test(k)?Math.max(1,Math.min(21,j)):Math.max(0,Math.min(20,j));function D($){var B=M,J=N,W,I,G;if(k==="c")J=T($)+J,$="";else{$=+$;var U=$<0||1/$<0;if($=isNaN($)?l:T(Math.abs($),j),S&&($=HH($)),U&&+$==0&&w!=="+"&&(U=!1),B=(U?w==="("?w:s:w==="-"||w==="("?"":w)+B,J=(k==="s"&&!isNaN($)&&Zp!==void 0?Y3[8+Zp/3]:"")+J+(U&&w==="("?")":""),A){for(W=-1,I=$.length;++W<I;)if(G=$.charCodeAt(W),48>G||G>57){J=(G===46?a+$.slice(W+1):$.slice(W))+J,$=$.slice(0,W);break}}}_&&!x&&($=t($,1/0));var X=B.length+$.length+J.length,V=X<y?new Array(y-X+1).join(g):"";switch(_&&x&&($=t(V+$,V.length?y-J.length:1/0),V=""),v){case"<":$=B+$+J+V;break;case"=":$=B+V+$+J;break;case"^":$=V.slice(0,X=V.length>>1)+B+$+J+V.slice(X);break;default:$=V+B+$+J;break}return i($)}return D.toString=function(){return f+""},D}function d(f,h){var g=Math.max(-8,Math.min(8,Math.floor(Eu(h)/3)))*3,v=Math.pow(10,-g),w=u((f=o0(f),f.type="f",f),{suffix:Y3[8+g/3]});return function(b){return w(v*b)}}return{format:u,formatPrefix:d}}var Ch,L2,NM;YH({thousands:",",grouping:[3],currency:["$",""]});function YH(e){return Ch=KH(e),L2=Ch.format,NM=Ch.formatPrefix,Ch}function qH(e){return Math.max(0,-Eu(Math.abs(e)))}function ZH(e,t){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(Eu(t)/3)))*3-Eu(Math.abs(e)))}function JH(e,t){return e=Math.abs(e),t=Math.abs(t)-e,Math.max(0,Eu(t)-Eu(e))+1}function OM(e,t,r,n){var a=qv(e,t,r),i;switch(n=o0(n??",f"),n.type){case"s":{var o=Math.max(Math.abs(e),Math.abs(t));return n.precision==null&&!isNaN(i=ZH(a,o))&&(n.precision=i),NM(n,o)}case"":case"e":case"g":case"p":case"r":{n.precision==null&&!isNaN(i=JH(a,Math.max(Math.abs(e),Math.abs(t))))&&(n.precision=i-(n.type==="e"));break}case"f":case"%":{n.precision==null&&!isNaN(i=qH(a))&&(n.precision=i-(n.type==="%")*2);break}}return L2(n)}function _l(e){var t=e.domain;return e.ticks=function(r){var n=t();return Kv(n[0],n[n.length-1],r??10)},e.tickFormat=function(r,n){var a=t();return OM(a[0],a[a.length-1],r??10,n)},e.nice=function(r){r==null&&(r=10);var n=t(),a=0,i=n.length-1,o=n[a],s=n[i],l,u,d=10;for(s<o&&(u=o,o=s,s=u,u=a,a=i,i=u);d-- >0;){if(u=Yv(o,s,r),u===l)return n[a]=o,n[i]=s,t(n);if(u>0)o=Math.floor(o/u)*u,s=Math.ceil(s/u)*u;else if(u<0)o=Math.ceil(o*u)/u,s=Math.floor(s*u)/u;else break;l=u}return e},e}function Jp(){var e=D2();return e.copy=function(){return B0(e,Jp())},Yi.apply(e,arguments),_l(e)}function AM(e){var t;function r(n){return n==null||isNaN(n=+n)?t:n}return r.invert=r,r.domain=r.range=function(n){return arguments.length?(e=Array.from(n,Yp),r):e.slice()},r.unknown=function(n){return arguments.length?(t=n,r):t},r.copy=function(){return AM(e).unknown(t)},e=arguments.length?Array.from(e,Yp):[0,1],_l(r)}function EM(e,t){e=e.slice();var r=0,n=e.length-1,a=e[r],i=e[n],o;return i<a&&(o=r,r=n,n=o,o=a,a=i,i=o),e[r]=t.floor(a),e[n]=t.ceil(i),e}function q3(e){return Math.log(e)}function Z3(e){return Math.exp(e)}function QH(e){return-Math.log(-e)}function eX(e){return-Math.exp(-e)}function tX(e){return isFinite(e)?+("1e"+e):e<0?0:e}function rX(e){return e===10?tX:e===Math.E?Math.exp:t=>Math.pow(e,t)}function nX(e){return e===Math.E?Math.log:e===10&&Math.log10||e===2&&Math.log2||(e=Math.log(e),t=>Math.log(t)/e)}function J3(e){return(t,r)=>-e(-t,r)}function B2(e){const t=e(q3,Z3),r=t.domain;let n=10,a,i;function o(){return a=nX(n),i=rX(n),r()[0]<0?(a=J3(a),i=J3(i),e(QH,eX)):e(q3,Z3),t}return t.base=function(s){return arguments.length?(n=+s,o()):n},t.domain=function(s){return arguments.length?(r(s),o()):r()},t.ticks=s=>{const l=r();let u=l[0],d=l[l.length-1];const f=d<u;f&&([u,d]=[d,u]);let h=a(u),g=a(d),v,w;const b=s==null?10:+s;let x=[];if(!(n%1)&&g-h<b){if(h=Math.floor(h),g=Math.ceil(g),u>0){for(;h<=g;++h)for(v=1;v<n;++v)if(w=h<0?v/i(-h):v*i(h),!(w<u)){if(w>d)break;x.push(w)}}else for(;h<=g;++h)for(v=n-1;v>=1;--v)if(w=h>0?v/i(-h):v*i(h),!(w<u)){if(w>d)break;x.push(w)}x.length*2<b&&(x=Kv(u,d,b))}else x=Kv(h,g,Math.min(g-h,b)).map(i);return f?x.reverse():x},t.tickFormat=(s,l)=>{if(s==null&&(s=10),l==null&&(l=n===10?"s":","),typeof l!="function"&&(!(n%1)&&(l=o0(l)).precision==null&&(l.trim=!0),l=L2(l)),s===1/0)return l;const u=Math.max(1,n*s/t.ticks().length);return d=>{let f=d/i(Math.round(a(d)));return f*n<n-.5&&(f*=n),f<=u?l(d):""}},t.nice=()=>r(EM(r(),{floor:s=>i(Math.floor(a(s))),ceil:s=>i(Math.ceil(a(s)))})),t}function TM(){const e=B2(jm()).domain([1,10]);return e.copy=()=>B0(e,TM()).base(e.base()),Yi.apply(e,arguments),e}function Q3(e){return function(t){return Math.sign(t)*Math.log1p(Math.abs(t/e))}}function e5(e){return function(t){return Math.sign(t)*Math.expm1(Math.abs(t))*e}}function F2(e){var t=1,r=e(Q3(t),e5(t));return r.constant=function(n){return arguments.length?e(Q3(t=+n),e5(t)):t},_l(r)}function IM(){var e=F2(jm());return e.copy=function(){return B0(e,IM()).constant(e.constant())},Yi.apply(e,arguments)}function t5(e){return function(t){return t<0?-Math.pow(-t,e):Math.pow(t,e)}}function aX(e){return e<0?-Math.sqrt(-e):Math.sqrt(e)}function iX(e){return e<0?-e*e:e*e}function U2(e){var t=e(Xa,Xa),r=1;function n(){return r===1?e(Xa,Xa):r===.5?e(aX,iX):e(t5(r),t5(1/r))}return t.exponent=function(a){return arguments.length?(r=+a,n()):r},_l(t)}function G2(){var e=U2(jm());return e.copy=function(){return B0(e,G2()).exponent(e.exponent())},Yi.apply(e,arguments),e}function oX(){return G2.apply(null,arguments).exponent(.5)}function r5(e){return Math.sign(e)*e*e}function sX(e){return Math.sign(e)*Math.sqrt(Math.abs(e))}function RM(){var e=D2(),t=[0,1],r=!1,n;function a(i){var o=sX(e(i));return isNaN(o)?n:r?Math.round(o):o}return a.invert=function(i){return e.invert(r5(i))},a.domain=function(i){return arguments.length?(e.domain(i),a):e.domain()},a.range=function(i){return arguments.length?(e.range((t=Array.from(i,Yp)).map(r5)),a):t.slice()},a.rangeRound=function(i){return a.range(i).round(!0)},a.round=function(i){return arguments.length?(r=!!i,a):r},a.clamp=function(i){return arguments.length?(e.clamp(i),a):e.clamp()},a.unknown=function(i){return arguments.length?(n=i,a):n},a.copy=function(){return RM(e.domain(),t).round(r).clamp(e.clamp()).unknown(n)},Yi.apply(a,arguments),_l(a)}function DM(){var e=[],t=[],r=[],n;function a(){var o=0,s=Math.max(1,t.length);for(r=new Array(s-1);++o<s;)r[o-1]=fH(e,o/s);return i}function i(o){return o==null||isNaN(o=+o)?n:t[$0(r,o)]}return i.invertExtent=function(o){var s=t.indexOf(o);return s<0?[NaN,NaN]:[s>0?r[s-1]:e[0],s<r.length?r[s]:e[e.length-1]]},i.domain=function(o){if(!arguments.length)return e.slice();e=[];for(let s of o)s!=null&&!isNaN(s=+s)&&e.push(s);return e.sort(hl),a()},i.range=function(o){return arguments.length?(t=Array.from(o),a()):t.slice()},i.unknown=function(o){return arguments.length?(n=o,i):n},i.quantiles=function(){return r.slice()},i.copy=function(){return DM().domain(e).range(t).unknown(n)},Yi.apply(i,arguments)}function $M(){var e=0,t=1,r=1,n=[.5],a=[0,1],i;function o(l){return l!=null&&l<=l?a[$0(n,l,0,r)]:i}function s(){var l=-1;for(n=new Array(r);++l<r;)n[l]=((l+1)*t-(l-r)*e)/(r+1);return o}return o.domain=function(l){return arguments.length?([e,t]=l,e=+e,t=+t,s()):[e,t]},o.range=function(l){return arguments.length?(r=(a=Array.from(l)).length-1,s()):a.slice()},o.invertExtent=function(l){var u=a.indexOf(l);return u<0?[NaN,NaN]:u<1?[e,n[0]]:u>=r?[n[r-1],t]:[n[u-1],n[u]]},o.unknown=function(l){return arguments.length&&(i=l),o},o.thresholds=function(){return n.slice()},o.copy=function(){return $M().domain([e,t]).range(a).unknown(i)},Yi.apply(_l(o),arguments)}function LM(){var e=[.5],t=[0,1],r,n=1;function a(i){return i!=null&&i<=i?t[$0(e,i,0,n)]:r}return a.domain=function(i){return arguments.length?(e=Array.from(i),n=Math.min(e.length,t.length-1),a):e.slice()},a.range=function(i){return arguments.length?(t=Array.from(i),n=Math.min(e.length,t.length-1),a):t.slice()},a.invertExtent=function(i){var o=t.indexOf(i);return[e[o-1],e[o]]},a.unknown=function(i){return arguments.length?(r=i,a):r},a.copy=function(){return LM().domain(e).range(t).unknown(r)},Yi.apply(a,arguments)}const Qy=new Date,ex=new Date;function ca(e,t,r,n){function a(i){return e(i=arguments.length===0?new Date:new Date(+i)),i}return a.floor=i=>(e(i=new Date(+i)),i),a.ceil=i=>(e(i=new Date(i-1)),t(i,1),e(i),i),a.round=i=>{const o=a(i),s=a.ceil(i);return i-o<s-i?o:s},a.offset=(i,o)=>(t(i=new Date(+i),o==null?1:Math.floor(o)),i),a.range=(i,o,s)=>{const l=[];if(i=a.ceil(i),s=s==null?1:Math.floor(s),!(i<o)||!(s>0))return l;let u;do l.push(u=new Date(+i)),t(i,s),e(i);while(u<i&&i<o);return l},a.filter=i=>ca(o=>{if(o>=o)for(;e(o),!i(o);)o.setTime(o-1)},(o,s)=>{if(o>=o)if(s<0)for(;++s<=0;)for(;t(o,-1),!i(o););else for(;--s>=0;)for(;t(o,1),!i(o););}),r&&(a.count=(i,o)=>(Qy.setTime(+i),ex.setTime(+o),e(Qy),e(ex),Math.floor(r(Qy,ex))),a.every=i=>(i=Math.floor(i),!isFinite(i)||!(i>0)?null:i>1?a.filter(n?o=>n(o)%i===0:o=>a.count(0,o)%i===0):a)),a}const Qp=ca(()=>{},(e,t)=>{e.setTime(+e+t)},(e,t)=>t-e);Qp.every=e=>(e=Math.floor(e),!isFinite(e)||!(e>0)?null:e>1?ca(t=>{t.setTime(Math.floor(t/e)*e)},(t,r)=>{t.setTime(+t+r*e)},(t,r)=>(r-t)/e):Qp);Qp.range;const rs=1e3,Ui=rs*60,ns=Ui*60,hs=ns*24,z2=hs*7,n5=hs*30,tx=hs*365,Vl=ca(e=>{e.setTime(e-e.getMilliseconds())},(e,t)=>{e.setTime(+e+t*rs)},(e,t)=>(t-e)/rs,e=>e.getUTCSeconds());Vl.range;const W2=ca(e=>{e.setTime(e-e.getMilliseconds()-e.getSeconds()*rs)},(e,t)=>{e.setTime(+e+t*Ui)},(e,t)=>(t-e)/Ui,e=>e.getMinutes());W2.range;const V2=ca(e=>{e.setUTCSeconds(0,0)},(e,t)=>{e.setTime(+e+t*Ui)},(e,t)=>(t-e)/Ui,e=>e.getUTCMinutes());V2.range;const H2=ca(e=>{e.setTime(e-e.getMilliseconds()-e.getSeconds()*rs-e.getMinutes()*Ui)},(e,t)=>{e.setTime(+e+t*ns)},(e,t)=>(t-e)/ns,e=>e.getHours());H2.range;const X2=ca(e=>{e.setUTCMinutes(0,0,0)},(e,t)=>{e.setTime(+e+t*ns)},(e,t)=>(t-e)/ns,e=>e.getUTCHours());X2.range;const F0=ca(e=>e.setHours(0,0,0,0),(e,t)=>e.setDate(e.getDate()+t),(e,t)=>(t-e-(t.getTimezoneOffset()-e.getTimezoneOffset())*Ui)/hs,e=>e.getDate()-1);F0.range;const Pm=ca(e=>{e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCDate(e.getUTCDate()+t)},(e,t)=>(t-e)/hs,e=>e.getUTCDate()-1);Pm.range;const BM=ca(e=>{e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCDate(e.getUTCDate()+t)},(e,t)=>(t-e)/hs,e=>Math.floor(e/hs));BM.range;function _c(e){return ca(t=>{t.setDate(t.getDate()-(t.getDay()+7-e)%7),t.setHours(0,0,0,0)},(t,r)=>{t.setDate(t.getDate()+r*7)},(t,r)=>(r-t-(r.getTimezoneOffset()-t.getTimezoneOffset())*Ui)/z2)}const Cm=_c(0),eg=_c(1),lX=_c(2),cX=_c(3),Tu=_c(4),uX=_c(5),dX=_c(6);Cm.range;eg.range;lX.range;cX.range;Tu.range;uX.range;dX.range;function jc(e){return ca(t=>{t.setUTCDate(t.getUTCDate()-(t.getUTCDay()+7-e)%7),t.setUTCHours(0,0,0,0)},(t,r)=>{t.setUTCDate(t.getUTCDate()+r*7)},(t,r)=>(r-t)/z2)}const Mm=jc(0),tg=jc(1),fX=jc(2),hX=jc(3),Iu=jc(4),pX=jc(5),gX=jc(6);Mm.range;tg.range;fX.range;hX.range;Iu.range;pX.range;gX.range;const K2=ca(e=>{e.setDate(1),e.setHours(0,0,0,0)},(e,t)=>{e.setMonth(e.getMonth()+t)},(e,t)=>t.getMonth()-e.getMonth()+(t.getFullYear()-e.getFullYear())*12,e=>e.getMonth());K2.range;const Y2=ca(e=>{e.setUTCDate(1),e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCMonth(e.getUTCMonth()+t)},(e,t)=>t.getUTCMonth()-e.getUTCMonth()+(t.getUTCFullYear()-e.getUTCFullYear())*12,e=>e.getUTCMonth());Y2.range;const ps=ca(e=>{e.setMonth(0,1),e.setHours(0,0,0,0)},(e,t)=>{e.setFullYear(e.getFullYear()+t)},(e,t)=>t.getFullYear()-e.getFullYear(),e=>e.getFullYear());ps.every=e=>!isFinite(e=Math.floor(e))||!(e>0)?null:ca(t=>{t.setFullYear(Math.floor(t.getFullYear()/e)*e),t.setMonth(0,1),t.setHours(0,0,0,0)},(t,r)=>{t.setFullYear(t.getFullYear()+r*e)});ps.range;const gs=ca(e=>{e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCFullYear(e.getUTCFullYear()+t)},(e,t)=>t.getUTCFullYear()-e.getUTCFullYear(),e=>e.getUTCFullYear());gs.every=e=>!isFinite(e=Math.floor(e))||!(e>0)?null:ca(t=>{t.setUTCFullYear(Math.floor(t.getUTCFullYear()/e)*e),t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)},(t,r)=>{t.setUTCFullYear(t.getUTCFullYear()+r*e)});gs.range;function FM(e,t,r,n,a,i){const o=[[Vl,1,rs],[Vl,5,5*rs],[Vl,15,15*rs],[Vl,30,30*rs],[i,1,Ui],[i,5,5*Ui],[i,15,15*Ui],[i,30,30*Ui],[a,1,ns],[a,3,3*ns],[a,6,6*ns],[a,12,12*ns],[n,1,hs],[n,2,2*hs],[r,1,z2],[t,1,n5],[t,3,3*n5],[e,1,tx]];function s(u,d,f){const h=d<u;h&&([u,d]=[d,u]);const g=f&&typeof f.range=="function"?f:l(u,d,f),v=g?g.range(u,+d+1):[];return h?v.reverse():v}function l(u,d,f){const h=Math.abs(d-u)/f,g=A2(([,,b])=>b).right(o,h);if(g===o.length)return e.every(qv(u/tx,d/tx,f));if(g===0)return Qp.every(Math.max(qv(u,d,f),1));const[v,w]=o[h/o[g-1][2]<o[g][2]/h?g-1:g];return v.every(w)}return[s,l]}const[mX,yX]=FM(gs,Y2,Mm,BM,X2,V2),[xX,vX]=FM(ps,K2,Cm,F0,H2,W2);function rx(e){if(0<=e.y&&e.y<100){var t=new Date(-1,e.m,e.d,e.H,e.M,e.S,e.L);return t.setFullYear(e.y),t}return new Date(e.y,e.m,e.d,e.H,e.M,e.S,e.L)}function nx(e){if(0<=e.y&&e.y<100){var t=new Date(Date.UTC(-1,e.m,e.d,e.H,e.M,e.S,e.L));return t.setUTCFullYear(e.y),t}return new Date(Date.UTC(e.y,e.m,e.d,e.H,e.M,e.S,e.L))}function Zd(e,t,r){return{y:e,m:t,d:r,H:0,M:0,S:0,L:0}}function bX(e){var t=e.dateTime,r=e.date,n=e.time,a=e.periods,i=e.days,o=e.shortDays,s=e.months,l=e.shortMonths,u=Jd(a),d=Qd(a),f=Jd(i),h=Qd(i),g=Jd(o),v=Qd(o),w=Jd(s),b=Qd(s),x=Jd(l),y=Qd(l),_={a:G,A:U,b:X,B:V,c:null,d:c5,e:c5,f:zX,g:QX,G:tK,H:FX,I:UX,j:GX,L:UM,m:WX,M:VX,p:z,q,Q:f5,s:h5,S:HX,u:XX,U:KX,V:YX,w:qX,W:ZX,x:null,X:null,y:JX,Y:eK,Z:rK,"%":d5},j={a:te,A:ie,b:he,B:ee,c:null,d:u5,e:u5,f:oK,g:mK,G:xK,H:nK,I:aK,j:iK,L:zM,m:sK,M:lK,p:Le,q:fe,Q:f5,s:h5,S:cK,u:uK,U:dK,V:fK,w:hK,W:pK,x:null,X:null,y:gK,Y:yK,Z:vK,"%":d5},S={a:A,A:D,b:$,B,c:J,d:s5,e:s5,f:DX,g:o5,G:i5,H:l5,I:l5,j:EX,L:RX,m:AX,M:TX,p:T,q:OX,Q:LX,s:BX,S:IX,u:jX,U:PX,V:CX,w:_X,W:MX,x:W,X:I,y:o5,Y:i5,Z:NX,"%":$X};_.x=k(r,_),_.X=k(n,_),_.c=k(t,_),j.x=k(r,j),j.X=k(n,j),j.c=k(t,j);function k(ce,de){return function(Ne){var pe=[],ke=-1,me=0,Be=ce.length,Se,we,Re;for(Ne instanceof Date||(Ne=new Date(+Ne));++ke<Be;)ce.charCodeAt(ke)===37&&(pe.push(ce.slice(me,ke)),(we=a5[Se=ce.charAt(++ke)])!=null?Se=ce.charAt(++ke):we=Se==="e"?" ":"0",(Re=de[Se])&&(Se=Re(Ne,we)),pe.push(Se),me=ke+1);return pe.push(ce.slice(me,ke)),pe.join("")}}function M(ce,de){return function(Ne){var pe=Zd(1900,void 0,1),ke=N(pe,ce,Ne+="",0),me,Be;if(ke!=Ne.length)return null;if("Q"in pe)return new Date(pe.Q);if("s"in pe)return new Date(pe.s*1e3+("L"in pe?pe.L:0));if(de&&!("Z"in pe)&&(pe.Z=0),"p"in pe&&(pe.H=pe.H%12+pe.p*12),pe.m===void 0&&(pe.m="q"in pe?pe.q:0),"V"in pe){if(pe.V<1||pe.V>53)return null;"w"in pe||(pe.w=1),"Z"in pe?(me=nx(Zd(pe.y,0,1)),Be=me.getUTCDay(),me=Be>4||Be===0?tg.ceil(me):tg(me),me=Pm.offset(me,(pe.V-1)*7),pe.y=me.getUTCFullYear(),pe.m=me.getUTCMonth(),pe.d=me.getUTCDate()+(pe.w+6)%7):(me=rx(Zd(pe.y,0,1)),Be=me.getDay(),me=Be>4||Be===0?eg.ceil(me):eg(me),me=F0.offset(me,(pe.V-1)*7),pe.y=me.getFullYear(),pe.m=me.getMonth(),pe.d=me.getDate()+(pe.w+6)%7)}else("W"in pe||"U"in pe)&&("w"in pe||(pe.w="u"in pe?pe.u%7:"W"in pe?1:0),Be="Z"in pe?nx(Zd(pe.y,0,1)).getUTCDay():rx(Zd(pe.y,0,1)).getDay(),pe.m=0,pe.d="W"in pe?(pe.w+6)%7+pe.W*7-(Be+5)%7:pe.w+pe.U*7-(Be+6)%7);return"Z"in pe?(pe.H+=pe.Z/100|0,pe.M+=pe.Z%100,nx(pe)):rx(pe)}}function N(ce,de,Ne,pe){for(var ke=0,me=de.length,Be=Ne.length,Se,we;ke<me;){if(pe>=Be)return-1;if(Se=de.charCodeAt(ke++),Se===37){if(Se=de.charAt(ke++),we=S[Se in a5?de.charAt(ke++):Se],!we||(pe=we(ce,Ne,pe))<0)return-1}else if(Se!=Ne.charCodeAt(pe++))return-1}return pe}function T(ce,de,Ne){var pe=u.exec(de.slice(Ne));return pe?(ce.p=d.get(pe[0].toLowerCase()),Ne+pe[0].length):-1}function A(ce,de,Ne){var pe=g.exec(de.slice(Ne));return pe?(ce.w=v.get(pe[0].toLowerCase()),Ne+pe[0].length):-1}function D(ce,de,Ne){var pe=f.exec(de.slice(Ne));return pe?(ce.w=h.get(pe[0].toLowerCase()),Ne+pe[0].length):-1}function $(ce,de,Ne){var pe=x.exec(de.slice(Ne));return pe?(ce.m=y.get(pe[0].toLowerCase()),Ne+pe[0].length):-1}function B(ce,de,Ne){var pe=w.exec(de.slice(Ne));return pe?(ce.m=b.get(pe[0].toLowerCase()),Ne+pe[0].length):-1}function J(ce,de,Ne){return N(ce,t,de,Ne)}function W(ce,de,Ne){return N(ce,r,de,Ne)}function I(ce,de,Ne){return N(ce,n,de,Ne)}function G(ce){return o[ce.getDay()]}function U(ce){return i[ce.getDay()]}function X(ce){return l[ce.getMonth()]}function V(ce){return s[ce.getMonth()]}function z(ce){return a[+(ce.getHours()>=12)]}function q(ce){return 1+~~(ce.getMonth()/3)}function te(ce){return o[ce.getUTCDay()]}function ie(ce){return i[ce.getUTCDay()]}function he(ce){return l[ce.getUTCMonth()]}function ee(ce){return s[ce.getUTCMonth()]}function Le(ce){return a[+(ce.getUTCHours()>=12)]}function fe(ce){return 1+~~(ce.getUTCMonth()/3)}return{format:function(ce){var de=k(ce+="",_);return de.toString=function(){return ce},de},parse:function(ce){var de=M(ce+="",!1);return de.toString=function(){return ce},de},utcFormat:function(ce){var de=k(ce+="",j);return de.toString=function(){return ce},de},utcParse:function(ce){var de=M(ce+="",!0);return de.toString=function(){return ce},de}}}var a5={"-":"",_:" ",0:"0"},ya=/^\s*\d+/,wX=/^%/,kX=/[\\^$*+?|[\]().{}]/g;function Vr(e,t,r){var n=e<0?"-":"",a=(n?-e:e)+"",i=a.length;return n+(i<r?new Array(r-i+1).join(t)+a:a)}function SX(e){return e.replace(kX,"\\$&")}function Jd(e){return new RegExp("^(?:"+e.map(SX).join("|")+")","i")}function Qd(e){return new Map(e.map((t,r)=>[t.toLowerCase(),r]))}function _X(e,t,r){var n=ya.exec(t.slice(r,r+1));return n?(e.w=+n[0],r+n[0].length):-1}function jX(e,t,r){var n=ya.exec(t.slice(r,r+1));return n?(e.u=+n[0],r+n[0].length):-1}function PX(e,t,r){var n=ya.exec(t.slice(r,r+2));return n?(e.U=+n[0],r+n[0].length):-1}function CX(e,t,r){var n=ya.exec(t.slice(r,r+2));return n?(e.V=+n[0],r+n[0].length):-1}function MX(e,t,r){var n=ya.exec(t.slice(r,r+2));return n?(e.W=+n[0],r+n[0].length):-1}function i5(e,t,r){var n=ya.exec(t.slice(r,r+4));return n?(e.y=+n[0],r+n[0].length):-1}function o5(e,t,r){var n=ya.exec(t.slice(r,r+2));return n?(e.y=+n[0]+(+n[0]>68?1900:2e3),r+n[0].length):-1}function NX(e,t,r){var n=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(t.slice(r,r+6));return n?(e.Z=n[1]?0:-(n[2]+(n[3]||"00")),r+n[0].length):-1}function OX(e,t,r){var n=ya.exec(t.slice(r,r+1));return n?(e.q=n[0]*3-3,r+n[0].length):-1}function AX(e,t,r){var n=ya.exec(t.slice(r,r+2));return n?(e.m=n[0]-1,r+n[0].length):-1}function s5(e,t,r){var n=ya.exec(t.slice(r,r+2));return n?(e.d=+n[0],r+n[0].length):-1}function EX(e,t,r){var n=ya.exec(t.slice(r,r+3));return n?(e.m=0,e.d=+n[0],r+n[0].length):-1}function l5(e,t,r){var n=ya.exec(t.slice(r,r+2));return n?(e.H=+n[0],r+n[0].length):-1}function TX(e,t,r){var n=ya.exec(t.slice(r,r+2));return n?(e.M=+n[0],r+n[0].length):-1}function IX(e,t,r){var n=ya.exec(t.slice(r,r+2));return n?(e.S=+n[0],r+n[0].length):-1}function RX(e,t,r){var n=ya.exec(t.slice(r,r+3));return n?(e.L=+n[0],r+n[0].length):-1}function DX(e,t,r){var n=ya.exec(t.slice(r,r+6));return n?(e.L=Math.floor(n[0]/1e3),r+n[0].length):-1}function $X(e,t,r){var n=wX.exec(t.slice(r,r+1));return n?r+n[0].length:-1}function LX(e,t,r){var n=ya.exec(t.slice(r));return n?(e.Q=+n[0],r+n[0].length):-1}function BX(e,t,r){var n=ya.exec(t.slice(r));return n?(e.s=+n[0],r+n[0].length):-1}function c5(e,t){return Vr(e.getDate(),t,2)}function FX(e,t){return Vr(e.getHours(),t,2)}function UX(e,t){return Vr(e.getHours()%12||12,t,2)}function GX(e,t){return Vr(1+F0.count(ps(e),e),t,3)}function UM(e,t){return Vr(e.getMilliseconds(),t,3)}function zX(e,t){return UM(e,t)+"000"}function WX(e,t){return Vr(e.getMonth()+1,t,2)}function VX(e,t){return Vr(e.getMinutes(),t,2)}function HX(e,t){return Vr(e.getSeconds(),t,2)}function XX(e){var t=e.getDay();return t===0?7:t}function KX(e,t){return Vr(Cm.count(ps(e)-1,e),t,2)}function GM(e){var t=e.getDay();return t>=4||t===0?Tu(e):Tu.ceil(e)}function YX(e,t){return e=GM(e),Vr(Tu.count(ps(e),e)+(ps(e).getDay()===4),t,2)}function qX(e){return e.getDay()}function ZX(e,t){return Vr(eg.count(ps(e)-1,e),t,2)}function JX(e,t){return Vr(e.getFullYear()%100,t,2)}function QX(e,t){return e=GM(e),Vr(e.getFullYear()%100,t,2)}function eK(e,t){return Vr(e.getFullYear()%1e4,t,4)}function tK(e,t){var r=e.getDay();return e=r>=4||r===0?Tu(e):Tu.ceil(e),Vr(e.getFullYear()%1e4,t,4)}function rK(e){var t=e.getTimezoneOffset();return(t>0?"-":(t*=-1,"+"))+Vr(t/60|0,"0",2)+Vr(t%60,"0",2)}function u5(e,t){return Vr(e.getUTCDate(),t,2)}function nK(e,t){return Vr(e.getUTCHours(),t,2)}function aK(e,t){return Vr(e.getUTCHours()%12||12,t,2)}function iK(e,t){return Vr(1+Pm.count(gs(e),e),t,3)}function zM(e,t){return Vr(e.getUTCMilliseconds(),t,3)}function oK(e,t){return zM(e,t)+"000"}function sK(e,t){return Vr(e.getUTCMonth()+1,t,2)}function lK(e,t){return Vr(e.getUTCMinutes(),t,2)}function cK(e,t){return Vr(e.getUTCSeconds(),t,2)}function uK(e){var t=e.getUTCDay();return t===0?7:t}function dK(e,t){return Vr(Mm.count(gs(e)-1,e),t,2)}function WM(e){var t=e.getUTCDay();return t>=4||t===0?Iu(e):Iu.ceil(e)}function fK(e,t){return e=WM(e),Vr(Iu.count(gs(e),e)+(gs(e).getUTCDay()===4),t,2)}function hK(e){return e.getUTCDay()}function pK(e,t){return Vr(tg.count(gs(e)-1,e),t,2)}function gK(e,t){return Vr(e.getUTCFullYear()%100,t,2)}function mK(e,t){return e=WM(e),Vr(e.getUTCFullYear()%100,t,2)}function yK(e,t){return Vr(e.getUTCFullYear()%1e4,t,4)}function xK(e,t){var r=e.getUTCDay();return e=r>=4||r===0?Iu(e):Iu.ceil(e),Vr(e.getUTCFullYear()%1e4,t,4)}function vK(){return"+0000"}function d5(){return"%"}function f5(e){return+e}function h5(e){return Math.floor(+e/1e3)}var Uc,VM,HM;bK({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});function bK(e){return Uc=bX(e),VM=Uc.format,Uc.parse,HM=Uc.utcFormat,Uc.utcParse,Uc}function wK(e){return new Date(e)}function kK(e){return e instanceof Date?+e:+new Date(+e)}function q2(e,t,r,n,a,i,o,s,l,u){var d=D2(),f=d.invert,h=d.domain,g=u(".%L"),v=u(":%S"),w=u("%I:%M"),b=u("%I %p"),x=u("%a %d"),y=u("%b %d"),_=u("%B"),j=u("%Y");function S(k){return(l(k)<k?g:s(k)<k?v:o(k)<k?w:i(k)<k?b:n(k)<k?a(k)<k?x:y:r(k)<k?_:j)(k)}return d.invert=function(k){return new Date(f(k))},d.domain=function(k){return arguments.length?h(Array.from(k,kK)):h().map(wK)},d.ticks=function(k){var M=h();return e(M[0],M[M.length-1],k??10)},d.tickFormat=function(k,M){return M==null?S:u(M)},d.nice=function(k){var M=h();return(!k||typeof k.range!="function")&&(k=t(M[0],M[M.length-1],k??10)),k?h(EM(M,k)):d},d.copy=function(){return B0(d,q2(e,t,r,n,a,i,o,s,l,u))},d}function SK(){return Yi.apply(q2(xX,vX,ps,K2,Cm,F0,H2,W2,Vl,VM).domain([new Date(2e3,0,1),new Date(2e3,0,2)]),arguments)}function _K(){return Yi.apply(q2(mX,yX,gs,Y2,Mm,Pm,X2,V2,Vl,HM).domain([Date.UTC(2e3,0,1),Date.UTC(2e3,0,2)]),arguments)}function Nm(){var e=0,t=1,r,n,a,i,o=Xa,s=!1,l;function u(f){return f==null||isNaN(f=+f)?l:o(a===0?.5:(f=(i(f)-r)*a,s?Math.max(0,Math.min(1,f)):f))}u.domain=function(f){return arguments.length?([e,t]=f,r=i(e=+e),n=i(t=+t),a=r===n?0:1/(n-r),u):[e,t]},u.clamp=function(f){return arguments.length?(s=!!f,u):s},u.interpolator=function(f){return arguments.length?(o=f,u):o};function d(f){return function(h){var g,v;return arguments.length?([g,v]=h,o=f(g,v),u):[o(0),o(1)]}}return u.range=d(pd),u.rangeRound=d(R2),u.unknown=function(f){return arguments.length?(l=f,u):l},function(f){return i=f,r=f(e),n=f(t),a=r===n?0:1/(n-r),u}}function jl(e,t){return t.domain(e.domain()).interpolator(e.interpolator()).clamp(e.clamp()).unknown(e.unknown())}function XM(){var e=_l(Nm()(Xa));return e.copy=function(){return jl(e,XM())},vs.apply(e,arguments)}function KM(){var e=B2(Nm()).domain([1,10]);return e.copy=function(){return jl(e,KM()).base(e.base())},vs.apply(e,arguments)}function YM(){var e=F2(Nm());return e.copy=function(){return jl(e,YM()).constant(e.constant())},vs.apply(e,arguments)}function Z2(){var e=U2(Nm());return e.copy=function(){return jl(e,Z2()).exponent(e.exponent())},vs.apply(e,arguments)}function jK(){return Z2.apply(null,arguments).exponent(.5)}function qM(){var e=[],t=Xa;function r(n){if(n!=null&&!isNaN(n=+n))return t(($0(e,n,1)-1)/(e.length-1))}return r.domain=function(n){if(!arguments.length)return e.slice();e=[];for(let a of n)a!=null&&!isNaN(a=+a)&&e.push(a);return e.sort(hl),r},r.interpolator=function(n){return arguments.length?(t=n,r):t},r.range=function(){return e.map((n,a)=>t(a/(e.length-1)))},r.quantiles=function(n){return Array.from({length:n+1},(a,i)=>dH(e,i/n))},r.copy=function(){return qM(t).domain(e)},vs.apply(r,arguments)}function Om(){var e=0,t=.5,r=1,n=1,a,i,o,s,l,u=Xa,d,f=!1,h;function g(w){return isNaN(w=+w)?h:(w=.5+((w=+d(w))-i)*(n*w<n*i?s:l),u(f?Math.max(0,Math.min(1,w)):w))}g.domain=function(w){return arguments.length?([e,t,r]=w,a=d(e=+e),i=d(t=+t),o=d(r=+r),s=a===i?0:.5/(i-a),l=i===o?0:.5/(o-i),n=i<a?-1:1,g):[e,t,r]},g.clamp=function(w){return arguments.length?(f=!!w,g):f},g.interpolator=function(w){return arguments.length?(u=w,g):u};function v(w){return function(b){var x,y,_;return arguments.length?([x,y,_]=b,u=$H(w,[x,y,_]),g):[u(0),u(.5),u(1)]}}return g.range=v(pd),g.rangeRound=v(R2),g.unknown=function(w){return arguments.length?(h=w,g):h},function(w){return d=w,a=w(e),i=w(t),o=w(r),s=a===i?0:.5/(i-a),l=i===o?0:.5/(o-i),n=i<a?-1:1,g}}function ZM(){var e=_l(Om()(Xa));return e.copy=function(){return jl(e,ZM())},vs.apply(e,arguments)}function JM(){var e=B2(Om()).domain([.1,1,10]);return e.copy=function(){return jl(e,JM()).base(e.base())},vs.apply(e,arguments)}function QM(){var e=F2(Om());return e.copy=function(){return jl(e,QM()).constant(e.constant())},vs.apply(e,arguments)}function J2(){var e=U2(Om());return e.copy=function(){return jl(e,J2()).exponent(e.exponent())},vs.apply(e,arguments)}function PK(){return J2.apply(null,arguments).exponent(.5)}const p5=Object.freeze(Object.defineProperty({__proto__:null,scaleBand:r0,scaleDiverging:ZM,scaleDivergingLog:JM,scaleDivergingPow:J2,scaleDivergingSqrt:PK,scaleDivergingSymlog:QM,scaleIdentity:AM,scaleImplicit:Zv,scaleLinear:Jp,scaleLog:TM,scaleOrdinal:E2,scalePoint:Sf,scalePow:G2,scaleQuantile:DM,scaleQuantize:$M,scaleRadial:RM,scaleSequential:XM,scaleSequentialLog:KM,scaleSequentialPow:Z2,scaleSequentialQuantile:qM,scaleSequentialSqrt:jK,scaleSequentialSymlog:YM,scaleSqrt:oX,scaleSymlog:IM,scaleThreshold:LM,scaleTime:SK,scaleUtc:_K,tickFormat:OM},Symbol.toStringTag,{value:"Module"}));var CK=id;function MK(e,t,r){for(var n=-1,a=e.length;++n<a;){var i=e[n],o=t(i);if(o!=null&&(s===void 0?o===o&&!CK(o):r(o,s)))var s=o,l=i}return l}var eN=MK;function NK(e,t){return e>t}var OK=NK,AK=eN,EK=OK,TK=hd;function IK(e){return e&&e.length?AK(e,TK,EK):void 0}var RK=IK;const Qs=dn(RK);function DK(e,t){return e<t}var $K=DK,LK=eN,BK=$K,FK=hd;function UK(e){return e&&e.length?LK(e,FK,BK):void 0}var GK=UK;const Am=dn(GK);var zK=f2,WK=kl,VK=uM,HK=gi;function XK(e,t){var r=HK(e)?zK:VK;return r(e,WK(t))}var KK=XK,YK=lM,qK=KK;function ZK(e,t){return YK(qK(e,t),1)}var JK=ZK;const QK=dn(JK);var eY=P2;function tY(e,t){return eY(e,t)}var rY=tY;const gc=dn(rY);var gd=1e9,nY={precision:20,rounding:4,toExpNeg:-7,toExpPos:21,LN10:"2.302585092994045684017991454684364207601101488628772976033327900967572609677352480235997205089598298341967784042286"},ew,jn=!0,Xi="[DecimalError] ",Jl=Xi+"Invalid argument: ",Q2=Xi+"Exponent out of range: ",md=Math.floor,Dl=Math.pow,aY=/^(\d+(\.\d*)?|\.\d+)(e[+-]?\d+)?$/i,_i,ha=1e7,wn=7,tN=9007199254740991,rg=md(tN/wn),ft={};ft.absoluteValue=ft.abs=function(){var e=new this.constructor(this);return e.s&&(e.s=1),e};ft.comparedTo=ft.cmp=function(e){var t,r,n,a,i=this;if(e=new i.constructor(e),i.s!==e.s)return i.s||-e.s;if(i.e!==e.e)return i.e>e.e^i.s<0?1:-1;for(n=i.d.length,a=e.d.length,t=0,r=n<a?n:a;t<r;++t)if(i.d[t]!==e.d[t])return i.d[t]>e.d[t]^i.s<0?1:-1;return n===a?0:n>a^i.s<0?1:-1};ft.decimalPlaces=ft.dp=function(){var e=this,t=e.d.length-1,r=(t-e.e)*wn;if(t=e.d[t],t)for(;t%10==0;t/=10)r--;return r<0?0:r};ft.dividedBy=ft.div=function(e){return ls(this,new this.constructor(e))};ft.dividedToIntegerBy=ft.idiv=function(e){var t=this,r=t.constructor;return un(ls(t,new r(e),0,1),r.precision)};ft.equals=ft.eq=function(e){return!this.cmp(e)};ft.exponent=function(){return qn(this)};ft.greaterThan=ft.gt=function(e){return this.cmp(e)>0};ft.greaterThanOrEqualTo=ft.gte=function(e){return this.cmp(e)>=0};ft.isInteger=ft.isint=function(){return this.e>this.d.length-2};ft.isNegative=ft.isneg=function(){return this.s<0};ft.isPositive=ft.ispos=function(){return this.s>0};ft.isZero=function(){return this.s===0};ft.lessThan=ft.lt=function(e){return this.cmp(e)<0};ft.lessThanOrEqualTo=ft.lte=function(e){return this.cmp(e)<1};ft.logarithm=ft.log=function(e){var t,r=this,n=r.constructor,a=n.precision,i=a+5;if(e===void 0)e=new n(10);else if(e=new n(e),e.s<1||e.eq(_i))throw Error(Xi+"NaN");if(r.s<1)throw Error(Xi+(r.s?"NaN":"-Infinity"));return r.eq(_i)?new n(0):(jn=!1,t=ls(s0(r,i),s0(e,i),i),jn=!0,un(t,a))};ft.minus=ft.sub=function(e){var t=this;return e=new t.constructor(e),t.s==e.s?aN(t,e):rN(t,(e.s=-e.s,e))};ft.modulo=ft.mod=function(e){var t,r=this,n=r.constructor,a=n.precision;if(e=new n(e),!e.s)throw Error(Xi+"NaN");return r.s?(jn=!1,t=ls(r,e,0,1).times(e),jn=!0,r.minus(t)):un(new n(r),a)};ft.naturalExponential=ft.exp=function(){return nN(this)};ft.naturalLogarithm=ft.ln=function(){return s0(this)};ft.negated=ft.neg=function(){var e=new this.constructor(this);return e.s=-e.s||0,e};ft.plus=ft.add=function(e){var t=this;return e=new t.constructor(e),t.s==e.s?rN(t,e):aN(t,(e.s=-e.s,e))};ft.precision=ft.sd=function(e){var t,r,n,a=this;if(e!==void 0&&e!==!!e&&e!==1&&e!==0)throw Error(Jl+e);if(t=qn(a)+1,n=a.d.length-1,r=n*wn+1,n=a.d[n],n){for(;n%10==0;n/=10)r--;for(n=a.d[0];n>=10;n/=10)r++}return e&&t>r?t:r};ft.squareRoot=ft.sqrt=function(){var e,t,r,n,a,i,o,s=this,l=s.constructor;if(s.s<1){if(!s.s)return new l(0);throw Error(Xi+"NaN")}for(e=qn(s),jn=!1,a=Math.sqrt(+s),a==0||a==1/0?(t=Ao(s.d),(t.length+e)%2==0&&(t+="0"),a=Math.sqrt(t),e=md((e+1)/2)-(e<0||e%2),a==1/0?t="5e"+e:(t=a.toExponential(),t=t.slice(0,t.indexOf("e")+1)+e),n=new l(t)):n=new l(a.toString()),r=l.precision,a=o=r+3;;)if(i=n,n=i.plus(ls(s,i,o+2)).times(.5),Ao(i.d).slice(0,o)===(t=Ao(n.d)).slice(0,o)){if(t=t.slice(o-3,o+1),a==o&&t=="4999"){if(un(i,r+1,0),i.times(i).eq(s)){n=i;break}}else if(t!="9999")break;o+=4}return jn=!0,un(n,r)};ft.times=ft.mul=function(e){var t,r,n,a,i,o,s,l,u,d=this,f=d.constructor,h=d.d,g=(e=new f(e)).d;if(!d.s||!e.s)return new f(0);for(e.s*=d.s,r=d.e+e.e,l=h.length,u=g.length,l<u&&(i=h,h=g,g=i,o=l,l=u,u=o),i=[],o=l+u,n=o;n--;)i.push(0);for(n=u;--n>=0;){for(t=0,a=l+n;a>n;)s=i[a]+g[n]*h[a-n-1]+t,i[a--]=s%ha|0,t=s/ha|0;i[a]=(i[a]+t)%ha|0}for(;!i[--o];)i.pop();return t?++r:i.shift(),e.d=i,e.e=r,jn?un(e,f.precision):e};ft.toDecimalPlaces=ft.todp=function(e,t){var r=this,n=r.constructor;return r=new n(r),e===void 0?r:(Uo(e,0,gd),t===void 0?t=n.rounding:Uo(t,0,8),un(r,e+qn(r)+1,t))};ft.toExponential=function(e,t){var r,n=this,a=n.constructor;return e===void 0?r=mc(n,!0):(Uo(e,0,gd),t===void 0?t=a.rounding:Uo(t,0,8),n=un(new a(n),e+1,t),r=mc(n,!0,e+1)),r};ft.toFixed=function(e,t){var r,n,a=this,i=a.constructor;return e===void 0?mc(a):(Uo(e,0,gd),t===void 0?t=i.rounding:Uo(t,0,8),n=un(new i(a),e+qn(a)+1,t),r=mc(n.abs(),!1,e+qn(n)+1),a.isneg()&&!a.isZero()?"-"+r:r)};ft.toInteger=ft.toint=function(){var e=this,t=e.constructor;return un(new t(e),qn(e)+1,t.rounding)};ft.toNumber=function(){return+this};ft.toPower=ft.pow=function(e){var t,r,n,a,i,o,s=this,l=s.constructor,u=12,d=+(e=new l(e));if(!e.s)return new l(_i);if(s=new l(s),!s.s){if(e.s<1)throw Error(Xi+"Infinity");return s}if(s.eq(_i))return s;if(n=l.precision,e.eq(_i))return un(s,n);if(t=e.e,r=e.d.length-1,o=t>=r,i=s.s,o){if((r=d<0?-d:d)<=tN){for(a=new l(_i),t=Math.ceil(n/wn+4),jn=!1;r%2&&(a=a.times(s),m5(a.d,t)),r=md(r/2),r!==0;)s=s.times(s),m5(s.d,t);return jn=!0,e.s<0?new l(_i).div(a):un(a,n)}}else if(i<0)throw Error(Xi+"NaN");return i=i<0&&e.d[Math.max(t,r)]&1?-1:1,s.s=1,jn=!1,a=e.times(s0(s,n+u)),jn=!0,a=nN(a),a.s=i,a};ft.toPrecision=function(e,t){var r,n,a=this,i=a.constructor;return e===void 0?(r=qn(a),n=mc(a,r<=i.toExpNeg||r>=i.toExpPos)):(Uo(e,1,gd),t===void 0?t=i.rounding:Uo(t,0,8),a=un(new i(a),e,t),r=qn(a),n=mc(a,e<=r||r<=i.toExpNeg,e)),n};ft.toSignificantDigits=ft.tosd=function(e,t){var r=this,n=r.constructor;return e===void 0?(e=n.precision,t=n.rounding):(Uo(e,1,gd),t===void 0?t=n.rounding:Uo(t,0,8)),un(new n(r),e,t)};ft.toString=ft.valueOf=ft.val=ft.toJSON=ft[Symbol.for("nodejs.util.inspect.custom")]=function(){var e=this,t=qn(e),r=e.constructor;return mc(e,t<=r.toExpNeg||t>=r.toExpPos)};function rN(e,t){var r,n,a,i,o,s,l,u,d=e.constructor,f=d.precision;if(!e.s||!t.s)return t.s||(t=new d(e)),jn?un(t,f):t;if(l=e.d,u=t.d,o=e.e,a=t.e,l=l.slice(),i=o-a,i){for(i<0?(n=l,i=-i,s=u.length):(n=u,a=o,s=l.length),o=Math.ceil(f/wn),s=o>s?o+1:s+1,i>s&&(i=s,n.length=1),n.reverse();i--;)n.push(0);n.reverse()}for(s=l.length,i=u.length,s-i<0&&(i=s,n=u,u=l,l=n),r=0;i;)r=(l[--i]=l[i]+u[i]+r)/ha|0,l[i]%=ha;for(r&&(l.unshift(r),++a),s=l.length;l[--s]==0;)l.pop();return t.d=l,t.e=a,jn?un(t,f):t}function Uo(e,t,r){if(e!==~~e||e<t||e>r)throw Error(Jl+e)}function Ao(e){var t,r,n,a=e.length-1,i="",o=e[0];if(a>0){for(i+=o,t=1;t<a;t++)n=e[t]+"",r=wn-n.length,r&&(i+=Us(r)),i+=n;o=e[t],n=o+"",r=wn-n.length,r&&(i+=Us(r))}else if(o===0)return"0";for(;o%10===0;)o/=10;return i+o}var ls=function(){function e(n,a){var i,o=0,s=n.length;for(n=n.slice();s--;)i=n[s]*a+o,n[s]=i%ha|0,o=i/ha|0;return o&&n.unshift(o),n}function t(n,a,i,o){var s,l;if(i!=o)l=i>o?1:-1;else for(s=l=0;s<i;s++)if(n[s]!=a[s]){l=n[s]>a[s]?1:-1;break}return l}function r(n,a,i){for(var o=0;i--;)n[i]-=o,o=n[i]<a[i]?1:0,n[i]=o*ha+n[i]-a[i];for(;!n[0]&&n.length>1;)n.shift()}return function(n,a,i,o){var s,l,u,d,f,h,g,v,w,b,x,y,_,j,S,k,M,N,T=n.constructor,A=n.s==a.s?1:-1,D=n.d,$=a.d;if(!n.s)return new T(n);if(!a.s)throw Error(Xi+"Division by zero");for(l=n.e-a.e,M=$.length,S=D.length,g=new T(A),v=g.d=[],u=0;$[u]==(D[u]||0);)++u;if($[u]>(D[u]||0)&&--l,i==null?y=i=T.precision:o?y=i+(qn(n)-qn(a))+1:y=i,y<0)return new T(0);if(y=y/wn+2|0,u=0,M==1)for(d=0,$=$[0],y++;(u<S||d)&&y--;u++)_=d*ha+(D[u]||0),v[u]=_/$|0,d=_%$|0;else{for(d=ha/($[0]+1)|0,d>1&&($=e($,d),D=e(D,d),M=$.length,S=D.length),j=M,w=D.slice(0,M),b=w.length;b<M;)w[b++]=0;N=$.slice(),N.unshift(0),k=$[0],$[1]>=ha/2&&++k;do d=0,s=t($,w,M,b),s<0?(x=w[0],M!=b&&(x=x*ha+(w[1]||0)),d=x/k|0,d>1?(d>=ha&&(d=ha-1),f=e($,d),h=f.length,b=w.length,s=t(f,w,h,b),s==1&&(d--,r(f,M<h?N:$,h))):(d==0&&(s=d=1),f=$.slice()),h=f.length,h<b&&f.unshift(0),r(w,f,b),s==-1&&(b=w.length,s=t($,w,M,b),s<1&&(d++,r(w,M<b?N:$,b))),b=w.length):s===0&&(d++,w=[0]),v[u++]=d,s&&w[0]?w[b++]=D[j]||0:(w=[D[j]],b=1);while((j++<S||w[0]!==void 0)&&y--)}return v[0]||v.shift(),g.e=l,un(g,o?i+qn(g)+1:i)}}();function nN(e,t){var r,n,a,i,o,s,l=0,u=0,d=e.constructor,f=d.precision;if(qn(e)>16)throw Error(Q2+qn(e));if(!e.s)return new d(_i);for(jn=!1,s=f,o=new d(.03125);e.abs().gte(.1);)e=e.times(o),u+=5;for(n=Math.log(Dl(2,u))/Math.LN10*2+5|0,s+=n,r=a=i=new d(_i),d.precision=s;;){if(a=un(a.times(e),s),r=r.times(++l),o=i.plus(ls(a,r,s)),Ao(o.d).slice(0,s)===Ao(i.d).slice(0,s)){for(;u--;)i=un(i.times(i),s);return d.precision=f,t==null?(jn=!0,un(i,f)):i}i=o}}function qn(e){for(var t=e.e*wn,r=e.d[0];r>=10;r/=10)t++;return t}function ax(e,t,r){if(t>e.LN10.sd())throw jn=!0,r&&(e.precision=r),Error(Xi+"LN10 precision limit exceeded");return un(new e(e.LN10),t)}function Us(e){for(var t="";e--;)t+="0";return t}function s0(e,t){var r,n,a,i,o,s,l,u,d,f=1,h=10,g=e,v=g.d,w=g.constructor,b=w.precision;if(g.s<1)throw Error(Xi+(g.s?"NaN":"-Infinity"));if(g.eq(_i))return new w(0);if(t==null?(jn=!1,u=b):u=t,g.eq(10))return t==null&&(jn=!0),ax(w,u);if(u+=h,w.precision=u,r=Ao(v),n=r.charAt(0),i=qn(g),Math.abs(i)<15e14){for(;n<7&&n!=1||n==1&&r.charAt(1)>3;)g=g.times(e),r=Ao(g.d),n=r.charAt(0),f++;i=qn(g),n>1?(g=new w("0."+r),i++):g=new w(n+"."+r.slice(1))}else return l=ax(w,u+2,b).times(i+""),g=s0(new w(n+"."+r.slice(1)),u-h).plus(l),w.precision=b,t==null?(jn=!0,un(g,b)):g;for(s=o=g=ls(g.minus(_i),g.plus(_i),u),d=un(g.times(g),u),a=3;;){if(o=un(o.times(d),u),l=s.plus(ls(o,new w(a),u)),Ao(l.d).slice(0,u)===Ao(s.d).slice(0,u))return s=s.times(2),i!==0&&(s=s.plus(ax(w,u+2,b).times(i+""))),s=ls(s,new w(f),u),w.precision=b,t==null?(jn=!0,un(s,b)):s;s=l,a+=2}}function g5(e,t){var r,n,a;for((r=t.indexOf("."))>-1&&(t=t.replace(".","")),(n=t.search(/e/i))>0?(r<0&&(r=n),r+=+t.slice(n+1),t=t.substring(0,n)):r<0&&(r=t.length),n=0;t.charCodeAt(n)===48;)++n;for(a=t.length;t.charCodeAt(a-1)===48;)--a;if(t=t.slice(n,a),t){if(a-=n,r=r-n-1,e.e=md(r/wn),e.d=[],n=(r+1)%wn,r<0&&(n+=wn),n<a){for(n&&e.d.push(+t.slice(0,n)),a-=wn;n<a;)e.d.push(+t.slice(n,n+=wn));t=t.slice(n),n=wn-t.length}else n-=a;for(;n--;)t+="0";if(e.d.push(+t),jn&&(e.e>rg||e.e<-rg))throw Error(Q2+r)}else e.s=0,e.e=0,e.d=[0];return e}function un(e,t,r){var n,a,i,o,s,l,u,d,f=e.d;for(o=1,i=f[0];i>=10;i/=10)o++;if(n=t-o,n<0)n+=wn,a=t,u=f[d=0];else{if(d=Math.ceil((n+1)/wn),i=f.length,d>=i)return e;for(u=i=f[d],o=1;i>=10;i/=10)o++;n%=wn,a=n-wn+o}if(r!==void 0&&(i=Dl(10,o-a-1),s=u/i%10|0,l=t<0||f[d+1]!==void 0||u%i,l=r<4?(s||l)&&(r==0||r==(e.s<0?3:2)):s>5||s==5&&(r==4||l||r==6&&(n>0?a>0?u/Dl(10,o-a):0:f[d-1])%10&1||r==(e.s<0?8:7))),t<1||!f[0])return l?(i=qn(e),f.length=1,t=t-i-1,f[0]=Dl(10,(wn-t%wn)%wn),e.e=md(-t/wn)||0):(f.length=1,f[0]=e.e=e.s=0),e;if(n==0?(f.length=d,i=1,d--):(f.length=d+1,i=Dl(10,wn-n),f[d]=a>0?(u/Dl(10,o-a)%Dl(10,a)|0)*i:0),l)for(;;)if(d==0){(f[0]+=i)==ha&&(f[0]=1,++e.e);break}else{if(f[d]+=i,f[d]!=ha)break;f[d--]=0,i=1}for(n=f.length;f[--n]===0;)f.pop();if(jn&&(e.e>rg||e.e<-rg))throw Error(Q2+qn(e));return e}function aN(e,t){var r,n,a,i,o,s,l,u,d,f,h=e.constructor,g=h.precision;if(!e.s||!t.s)return t.s?t.s=-t.s:t=new h(e),jn?un(t,g):t;if(l=e.d,f=t.d,n=t.e,u=e.e,l=l.slice(),o=u-n,o){for(d=o<0,d?(r=l,o=-o,s=f.length):(r=f,n=u,s=l.length),a=Math.max(Math.ceil(g/wn),s)+2,o>a&&(o=a,r.length=1),r.reverse(),a=o;a--;)r.push(0);r.reverse()}else{for(a=l.length,s=f.length,d=a<s,d&&(s=a),a=0;a<s;a++)if(l[a]!=f[a]){d=l[a]<f[a];break}o=0}for(d&&(r=l,l=f,f=r,t.s=-t.s),s=l.length,a=f.length-s;a>0;--a)l[s++]=0;for(a=f.length;a>o;){if(l[--a]<f[a]){for(i=a;i&&l[--i]===0;)l[i]=ha-1;--l[i],l[a]+=ha}l[a]-=f[a]}for(;l[--s]===0;)l.pop();for(;l[0]===0;l.shift())--n;return l[0]?(t.d=l,t.e=n,jn?un(t,g):t):new h(0)}function mc(e,t,r){var n,a=qn(e),i=Ao(e.d),o=i.length;return t?(r&&(n=r-o)>0?i=i.charAt(0)+"."+i.slice(1)+Us(n):o>1&&(i=i.charAt(0)+"."+i.slice(1)),i=i+(a<0?"e":"e+")+a):a<0?(i="0."+Us(-a-1)+i,r&&(n=r-o)>0&&(i+=Us(n))):a>=o?(i+=Us(a+1-o),r&&(n=r-a-1)>0&&(i=i+"."+Us(n))):((n=a+1)<o&&(i=i.slice(0,n)+"."+i.slice(n)),r&&(n=r-o)>0&&(a+1===o&&(i+="."),i+=Us(n))),e.s<0?"-"+i:i}function m5(e,t){if(e.length>t)return e.length=t,!0}function iN(e){var t,r,n;function a(i){var o=this;if(!(o instanceof a))return new a(i);if(o.constructor=a,i instanceof a){o.s=i.s,o.e=i.e,o.d=(i=i.d)?i.slice():i;return}if(typeof i=="number"){if(i*0!==0)throw Error(Jl+i);if(i>0)o.s=1;else if(i<0)i=-i,o.s=-1;else{o.s=0,o.e=0,o.d=[0];return}if(i===~~i&&i<1e7){o.e=0,o.d=[i];return}return g5(o,i.toString())}else if(typeof i!="string")throw Error(Jl+i);if(i.charCodeAt(0)===45?(i=i.slice(1),o.s=-1):o.s=1,aY.test(i))g5(o,i);else throw Error(Jl+i)}if(a.prototype=ft,a.ROUND_UP=0,a.ROUND_DOWN=1,a.ROUND_CEIL=2,a.ROUND_FLOOR=3,a.ROUND_HALF_UP=4,a.ROUND_HALF_DOWN=5,a.ROUND_HALF_EVEN=6,a.ROUND_HALF_CEIL=7,a.ROUND_HALF_FLOOR=8,a.clone=iN,a.config=a.set=iY,e===void 0&&(e={}),e)for(n=["precision","rounding","toExpNeg","toExpPos","LN10"],t=0;t<n.length;)e.hasOwnProperty(r=n[t++])||(e[r]=this[r]);return a.config(e),a}function iY(e){if(!e||typeof e!="object")throw Error(Xi+"Object expected");var t,r,n,a=["precision",1,gd,"rounding",0,8,"toExpNeg",-1/0,0,"toExpPos",0,1/0];for(t=0;t<a.length;t+=3)if((n=e[r=a[t]])!==void 0)if(md(n)===n&&n>=a[t+1]&&n<=a[t+2])this[r]=n;else throw Error(Jl+r+": "+n);if((n=e[r="LN10"])!==void 0)if(n==Math.LN10)this[r]=new this(n);else throw Error(Jl+r+": "+n);return this}var ew=iN(nY);_i=new ew(1);const ln=ew;function oY(e){return uY(e)||cY(e)||lY(e)||sY()}function sY(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function lY(e,t){if(e){if(typeof e=="string")return t1(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return t1(e,t)}}function cY(e){if(typeof Symbol<"u"&&Symbol.iterator in Object(e))return Array.from(e)}function uY(e){if(Array.isArray(e))return t1(e)}function t1(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var dY=function(t){return t},oN={},sN=function(t){return t===oN},y5=function(t){return function r(){return arguments.length===0||arguments.length===1&&sN(arguments.length<=0?void 0:arguments[0])?r:t.apply(void 0,arguments)}},fY=function e(t,r){return t===1?r:y5(function(){for(var n=arguments.length,a=new Array(n),i=0;i<n;i++)a[i]=arguments[i];var o=a.filter(function(s){return s!==oN}).length;return o>=t?r.apply(void 0,a):e(t-o,y5(function(){for(var s=arguments.length,l=new Array(s),u=0;u<s;u++)l[u]=arguments[u];var d=a.map(function(f){return sN(f)?l.shift():f});return r.apply(void 0,oY(d).concat(l))}))})},Em=function(t){return fY(t.length,t)},r1=function(t,r){for(var n=[],a=t;a<r;++a)n[a-t]=a;return n},hY=Em(function(e,t){return Array.isArray(t)?t.map(e):Object.keys(t).map(function(r){return t[r]}).map(e)}),pY=function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];if(!r.length)return dY;var a=r.reverse(),i=a[0],o=a.slice(1);return function(){return o.reduce(function(s,l){return l(s)},i.apply(void 0,arguments))}},n1=function(t){return Array.isArray(t)?t.reverse():t.split("").reverse.join("")},lN=function(t){var r=null,n=null;return function(){for(var a=arguments.length,i=new Array(a),o=0;o<a;o++)i[o]=arguments[o];return r&&i.every(function(s,l){return s===r[l]})||(r=i,n=t.apply(void 0,i)),n}};function gY(e){var t;return e===0?t=1:t=Math.floor(new ln(e).abs().log(10).toNumber())+1,t}function mY(e,t,r){for(var n=new ln(e),a=0,i=[];n.lt(t)&&a<1e5;)i.push(n.toNumber()),n=n.add(r),a++;return i}var yY=Em(function(e,t,r){var n=+e,a=+t;return n+r*(a-n)}),xY=Em(function(e,t,r){var n=t-+e;return n=n||1/0,(r-e)/n}),vY=Em(function(e,t,r){var n=t-+e;return n=n||1/0,Math.max(0,Math.min(1,(r-e)/n))});const Tm={rangeStep:mY,getDigitCount:gY,interpolateNumber:yY,uninterpolateNumber:xY,uninterpolateTruncation:vY};function a1(e){return kY(e)||wY(e)||cN(e)||bY()}function bY(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function wY(e){if(typeof Symbol<"u"&&Symbol.iterator in Object(e))return Array.from(e)}function kY(e){if(Array.isArray(e))return i1(e)}function l0(e,t){return jY(e)||_Y(e,t)||cN(e,t)||SY()}function SY(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function cN(e,t){if(e){if(typeof e=="string")return i1(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return i1(e,t)}}function i1(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function _Y(e,t){if(!(typeof Symbol>"u"||!(Symbol.iterator in Object(e)))){var r=[],n=!0,a=!1,i=void 0;try{for(var o=e[Symbol.iterator](),s;!(n=(s=o.next()).done)&&(r.push(s.value),!(t&&r.length===t));n=!0);}catch(l){a=!0,i=l}finally{try{!n&&o.return!=null&&o.return()}finally{if(a)throw i}}return r}}function jY(e){if(Array.isArray(e))return e}function uN(e){var t=l0(e,2),r=t[0],n=t[1],a=r,i=n;return r>n&&(a=n,i=r),[a,i]}function dN(e,t,r){if(e.lte(0))return new ln(0);var n=Tm.getDigitCount(e.toNumber()),a=new ln(10).pow(n),i=e.div(a),o=n!==1?.05:.1,s=new ln(Math.ceil(i.div(o).toNumber())).add(r).mul(o),l=s.mul(a);return t?l:new ln(Math.ceil(l))}function PY(e,t,r){var n=1,a=new ln(e);if(!a.isint()&&r){var i=Math.abs(e);i<1?(n=new ln(10).pow(Tm.getDigitCount(e)-1),a=new ln(Math.floor(a.div(n).toNumber())).mul(n)):i>1&&(a=new ln(Math.floor(e)))}else e===0?a=new ln(Math.floor((t-1)/2)):r||(a=new ln(Math.floor(e)));var o=Math.floor((t-1)/2),s=pY(hY(function(l){return a.add(new ln(l-o).mul(n)).toNumber()}),r1);return s(0,t)}function fN(e,t,r,n){var a=arguments.length>4&&arguments[4]!==void 0?arguments[4]:0;if(!Number.isFinite((t-e)/(r-1)))return{step:new ln(0),tickMin:new ln(0),tickMax:new ln(0)};var i=dN(new ln(t).sub(e).div(r-1),n,a),o;e<=0&&t>=0?o=new ln(0):(o=new ln(e).add(t).div(2),o=o.sub(new ln(o).mod(i)));var s=Math.ceil(o.sub(e).div(i).toNumber()),l=Math.ceil(new ln(t).sub(o).div(i).toNumber()),u=s+l+1;return u>r?fN(e,t,r,n,a+1):(u<r&&(l=t>0?l+(r-u):l,s=t>0?s:s+(r-u)),{step:i,tickMin:o.sub(new ln(s).mul(i)),tickMax:o.add(new ln(l).mul(i))})}function CY(e){var t=l0(e,2),r=t[0],n=t[1],a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:6,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,o=Math.max(a,2),s=uN([r,n]),l=l0(s,2),u=l[0],d=l[1];if(u===-1/0||d===1/0){var f=d===1/0?[u].concat(a1(r1(0,a-1).map(function(){return 1/0}))):[].concat(a1(r1(0,a-1).map(function(){return-1/0})),[d]);return r>n?n1(f):f}if(u===d)return PY(u,a,i);var h=fN(u,d,o,i),g=h.step,v=h.tickMin,w=h.tickMax,b=Tm.rangeStep(v,w.add(new ln(.1).mul(g)),g);return r>n?n1(b):b}function MY(e,t){var r=l0(e,2),n=r[0],a=r[1],i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,o=uN([n,a]),s=l0(o,2),l=s[0],u=s[1];if(l===-1/0||u===1/0)return[n,a];if(l===u)return[l];var d=Math.max(t,2),f=dN(new ln(u).sub(l).div(d-1),i,0),h=[].concat(a1(Tm.rangeStep(new ln(l),new ln(u).sub(new ln(.99).mul(f)),f)),[u]);return n>a?n1(h):h}var NY=lN(CY),OY=lN(MY),AY="Invariant failed";function yc(e,t){throw new Error(AY)}var EY=["offset","layout","width","dataKey","data","dataPointFormatter","xAxis","yAxis"];function Ru(e){"@babel/helpers - typeof";return Ru=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ru(e)}function ng(){return ng=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},ng.apply(this,arguments)}function TY(e,t){return $Y(e)||DY(e,t)||RY(e,t)||IY()}function IY(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function RY(e,t){if(e){if(typeof e=="string")return x5(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return x5(e,t)}}function x5(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function DY(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,a,i,o,s=[],l=!0,u=!1;try{if(i=(r=r.call(e)).next,t!==0)for(;!(l=(n=i.call(r)).done)&&(s.push(n.value),s.length!==t);l=!0);}catch(d){u=!0,a=d}finally{try{if(!l&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(u)throw a}}return s}}function $Y(e){if(Array.isArray(e))return e}function LY(e,t){if(e==null)return{};var r=BY(e,t),n,a;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function BY(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function FY(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function UY(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,gN(n.key),n)}}function GY(e,t,r){return t&&UY(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function zY(e,t,r){return t=ag(t),WY(e,hN()?Reflect.construct(t,r||[],ag(e).constructor):t.apply(e,r))}function WY(e,t){if(t&&(Ru(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return VY(e)}function VY(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function hN(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(hN=function(){return!!e})()}function ag(e){return ag=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},ag(e)}function HY(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&o1(e,t)}function o1(e,t){return o1=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},o1(e,t)}function pN(e,t,r){return t=gN(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function gN(e){var t=XY(e,"string");return Ru(t)=="symbol"?t:t+""}function XY(e,t){if(Ru(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(Ru(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var yd=function(e){function t(){return FY(this,t),zY(this,t,arguments)}return HY(t,e),GY(t,[{key:"render",value:function(){var n=this.props,a=n.offset,i=n.layout,o=n.width,s=n.dataKey,l=n.data,u=n.dataPointFormatter,d=n.xAxis,f=n.yAxis,h=LY(n,EY),g=er(h,!1);this.props.direction==="x"&&d.type!=="number"&&yc();var v=l.map(function(w){var b=u(w,s),x=b.x,y=b.y,_=b.value,j=b.errorVal;if(!j)return null;var S=[],k,M;if(Array.isArray(j)){var N=TY(j,2);k=N[0],M=N[1]}else k=M=j;if(i==="vertical"){var T=d.scale,A=y+a,D=A+o,$=A-o,B=T(_-k),J=T(_+M);S.push({x1:J,y1:D,x2:J,y2:$}),S.push({x1:B,y1:A,x2:J,y2:A}),S.push({x1:B,y1:D,x2:B,y2:$})}else if(i==="horizontal"){var W=f.scale,I=x+a,G=I-o,U=I+o,X=W(_-k),V=W(_+M);S.push({x1:G,y1:V,x2:U,y2:V}),S.push({x1:I,y1:X,x2:I,y2:V}),S.push({x1:G,y1:X,x2:U,y2:X})}return oe.createElement(Yr,ng({className:"recharts-errorBar",key:"bar-".concat(S.map(function(z){return"".concat(z.x1,"-").concat(z.x2,"-").concat(z.y1,"-").concat(z.y2)}))},g),S.map(function(z){return oe.createElement("line",ng({},z,{key:"line-".concat(z.x1,"-").concat(z.x2,"-").concat(z.y1,"-").concat(z.y2)}))}))});return oe.createElement(Yr,{className:"recharts-errorBars"},v)}}])}(oe.Component);pN(yd,"defaultProps",{stroke:"black",strokeWidth:1.5,width:5,offset:0,layout:"horizontal"});pN(yd,"displayName","ErrorBar");function c0(e){"@babel/helpers - typeof";return c0=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},c0(e)}function v5(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Al(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?v5(Object(r),!0).forEach(function(n){KY(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):v5(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function KY(e,t,r){return t=YY(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function YY(e){var t=qY(e,"string");return c0(t)=="symbol"?t:t+""}function qY(e,t){if(c0(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(c0(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var mN=function(t){var r=t.children,n=t.formattedGraphicalItems,a=t.legendWidth,i=t.legendContent,o=Si(r,Do);if(!o)return null;var s=Do.defaultProps,l=s!==void 0?Al(Al({},s),o.props):{},u;return o.props&&o.props.payload?u=o.props&&o.props.payload:i==="children"?u=(n||[]).reduce(function(d,f){var h=f.item,g=f.props,v=g.sectors||g.data||[];return d.concat(v.map(function(w){return{type:o.props.iconType||h.props.legendType,value:w.name,color:w.fill,payload:w}}))},[]):u=(n||[]).map(function(d){var f=d.item,h=f.type.defaultProps,g=h!==void 0?Al(Al({},h),f.props):{},v=g.dataKey,w=g.name,b=g.legendType,x=g.hide;return{inactive:x,dataKey:v,type:l.iconType||b||"square",color:tw(f),value:w||v,payload:g}}),Al(Al(Al({},l),Do.getWithHeight(o,a)),{},{payload:u,item:o})};function u0(e){"@babel/helpers - typeof";return u0=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},u0(e)}function b5(e){return eq(e)||QY(e)||JY(e)||ZY()}function ZY(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function JY(e,t){if(e){if(typeof e=="string")return s1(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return s1(e,t)}}function QY(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function eq(e){if(Array.isArray(e))return s1(e)}function s1(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function w5(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function $n(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?w5(Object(r),!0).forEach(function(n){gu(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):w5(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function gu(e,t,r){return t=tq(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function tq(e){var t=rq(e,"string");return u0(t)=="symbol"?t:t+""}function rq(e,t){if(u0(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(u0(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function la(e,t,r){return qt(e)||qt(t)?r:sa(t)?Wi(e,t,r):ar(t)?t(e):r}function _f(e,t,r,n){var a=QK(e,function(s){return la(s,t)});if(r==="number"){var i=a.filter(function(s){return We(s)||parseFloat(s)});return i.length?[Am(i),Qs(i)]:[1/0,-1/0]}var o=n?a.filter(function(s){return!qt(s)}):a;return o.map(function(s){return sa(s)||s instanceof Date?s:""})}var nq=function(t){var r,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],a=arguments.length>2?arguments[2]:void 0,i=arguments.length>3?arguments[3]:void 0,o=-1,s=(r=n==null?void 0:n.length)!==null&&r!==void 0?r:0;if(s<=1)return 0;if(i&&i.axisType==="angleAxis"&&Math.abs(Math.abs(i.range[1]-i.range[0])-360)<=1e-6)for(var l=i.range,u=0;u<s;u++){var d=u>0?a[u-1].coordinate:a[s-1].coordinate,f=a[u].coordinate,h=u>=s-1?a[0].coordinate:a[u+1].coordinate,g=void 0;if(go(f-d)!==go(h-f)){var v=[];if(go(h-f)===go(l[1]-l[0])){g=h;var w=f+l[1]-l[0];v[0]=Math.min(w,(w+d)/2),v[1]=Math.max(w,(w+d)/2)}else{g=d;var b=h+l[1]-l[0];v[0]=Math.min(f,(b+f)/2),v[1]=Math.max(f,(b+f)/2)}var x=[Math.min(f,(g+f)/2),Math.max(f,(g+f)/2)];if(t>x[0]&&t<=x[1]||t>=v[0]&&t<=v[1]){o=a[u].index;break}}else{var y=Math.min(d,h),_=Math.max(d,h);if(t>(y+f)/2&&t<=(_+f)/2){o=a[u].index;break}}}else for(var j=0;j<s;j++)if(j===0&&t<=(n[j].coordinate+n[j+1].coordinate)/2||j>0&&j<s-1&&t>(n[j].coordinate+n[j-1].coordinate)/2&&t<=(n[j].coordinate+n[j+1].coordinate)/2||j===s-1&&t>(n[j].coordinate+n[j-1].coordinate)/2){o=n[j].index;break}return o},tw=function(t){var r,n=t,a=n.type.displayName,i=(r=t.type)!==null&&r!==void 0&&r.defaultProps?$n($n({},t.type.defaultProps),t.props):t.props,o=i.stroke,s=i.fill,l;switch(a){case"Line":l=o;break;case"Area":case"Radar":l=o&&o!=="none"?o:s;break;default:l=s;break}return l},aq=function(t){var r=t.barSize,n=t.totalSize,a=t.stackGroups,i=a===void 0?{}:a;if(!i)return{};for(var o={},s=Object.keys(i),l=0,u=s.length;l<u;l++)for(var d=i[s[l]].stackGroups,f=Object.keys(d),h=0,g=f.length;h<g;h++){var v=d[f[h]],w=v.items,b=v.cateAxisId,x=w.filter(function(M){return os(M.type).indexOf("Bar")>=0});if(x&&x.length){var y=x[0].type.defaultProps,_=y!==void 0?$n($n({},y),x[0].props):x[0].props,j=_.barSize,S=_[b];o[S]||(o[S]=[]);var k=qt(j)?r:j;o[S].push({item:x[0],stackList:x.slice(1),barSize:qt(k)?void 0:pc(k,n,0)})}}return o},iq=function(t){var r=t.barGap,n=t.barCategoryGap,a=t.bandSize,i=t.sizeList,o=i===void 0?[]:i,s=t.maxBarSize,l=o.length;if(l<1)return null;var u=pc(r,a,0,!0),d,f=[];if(o[0].barSize===+o[0].barSize){var h=!1,g=a/l,v=o.reduce(function(j,S){return j+S.barSize||0},0);v+=(l-1)*u,v>=a&&(v-=(l-1)*u,u=0),v>=a&&g>0&&(h=!0,g*=.9,v=l*g);var w=(a-v)/2>>0,b={offset:w-u,size:0};d=o.reduce(function(j,S){var k={item:S.item,position:{offset:b.offset+b.size+u,size:h?g:S.barSize}},M=[].concat(b5(j),[k]);return b=M[M.length-1].position,S.stackList&&S.stackList.length&&S.stackList.forEach(function(N){M.push({item:N,position:b})}),M},f)}else{var x=pc(n,a,0,!0);a-2*x-(l-1)*u<=0&&(u=0);var y=(a-2*x-(l-1)*u)/l;y>1&&(y>>=0);var _=s===+s?Math.min(y,s):y;d=o.reduce(function(j,S,k){var M=[].concat(b5(j),[{item:S.item,position:{offset:x+(y+u)*k+(y-_)/2,size:_}}]);return S.stackList&&S.stackList.length&&S.stackList.forEach(function(N){M.push({item:N,position:M[M.length-1].position})}),M},f)}return d},oq=function(t,r,n,a){var i=n.children,o=n.width,s=n.margin,l=o-(s.left||0)-(s.right||0),u=mN({children:i,legendWidth:l});if(u){var d=a||{},f=d.width,h=d.height,g=u.align,v=u.verticalAlign,w=u.layout;if((w==="vertical"||w==="horizontal"&&v==="middle")&&g!=="center"&&We(t[g]))return $n($n({},t),{},gu({},g,t[g]+(f||0)));if((w==="horizontal"||w==="vertical"&&g==="center")&&v!=="middle"&&We(t[v]))return $n($n({},t),{},gu({},v,t[v]+(h||0)))}return t},sq=function(t,r,n){return qt(r)?!0:t==="horizontal"?r==="yAxis":t==="vertical"||n==="x"?r==="xAxis":n==="y"?r==="yAxis":!0},yN=function(t,r,n,a,i){var o=r.props.children,s=pi(o,yd).filter(function(u){return sq(a,i,u.props.direction)});if(s&&s.length){var l=s.map(function(u){return u.props.dataKey});return t.reduce(function(u,d){var f=la(d,n);if(qt(f))return u;var h=Array.isArray(f)?[Am(f),Qs(f)]:[f,f],g=l.reduce(function(v,w){var b=la(d,w,0),x=h[0]-Math.abs(Array.isArray(b)?b[0]:b),y=h[1]+Math.abs(Array.isArray(b)?b[1]:b);return[Math.min(x,v[0]),Math.max(y,v[1])]},[1/0,-1/0]);return[Math.min(g[0],u[0]),Math.max(g[1],u[1])]},[1/0,-1/0])}return null},lq=function(t,r,n,a,i){var o=r.map(function(s){return yN(t,s,n,i,a)}).filter(function(s){return!qt(s)});return o&&o.length?o.reduce(function(s,l){return[Math.min(s[0],l[0]),Math.max(s[1],l[1])]},[1/0,-1/0]):null},xN=function(t,r,n,a,i){var o=r.map(function(l){var u=l.props.dataKey;return n==="number"&&u&&yN(t,l,u,a)||_f(t,u,n,i)});if(n==="number")return o.reduce(function(l,u){return[Math.min(l[0],u[0]),Math.max(l[1],u[1])]},[1/0,-1/0]);var s={};return o.reduce(function(l,u){for(var d=0,f=u.length;d<f;d++)s[u[d]]||(s[u[d]]=!0,l.push(u[d]));return l},[])},vN=function(t,r){return t==="horizontal"&&r==="xAxis"||t==="vertical"&&r==="yAxis"||t==="centric"&&r==="angleAxis"||t==="radial"&&r==="radiusAxis"},bN=function(t,r,n,a){if(a)return t.map(function(l){return l.coordinate});var i,o,s=t.map(function(l){return l.coordinate===r&&(i=!0),l.coordinate===n&&(o=!0),l.coordinate});return i||s.push(r),o||s.push(n),s},as=function(t,r,n){if(!t)return null;var a=t.scale,i=t.duplicateDomain,o=t.type,s=t.range,l=t.realScaleType==="scaleBand"?a.bandwidth()/2:2,u=(r||n)&&o==="category"&&a.bandwidth?a.bandwidth()/l:0;if(u=t.axisType==="angleAxis"&&(s==null?void 0:s.length)>=2?go(s[0]-s[1])*2*u:u,r&&(t.ticks||t.niceTicks)){var d=(t.ticks||t.niceTicks).map(function(f){var h=i?i.indexOf(f):f;return{coordinate:a(h)+u,value:f,offset:u}});return d.filter(function(f){return!ud(f.coordinate)})}return t.isCategorical&&t.categoricalDomain?t.categoricalDomain.map(function(f,h){return{coordinate:a(f)+u,value:f,index:h,offset:u}}):a.ticks&&!n?a.ticks(t.tickCount).map(function(f){return{coordinate:a(f)+u,value:f,offset:u}}):a.domain().map(function(f,h){return{coordinate:a(f)+u,value:i?i[f]:f,index:h,offset:u}})},ix=new WeakMap,Mh=function(t,r){if(typeof r!="function")return t;ix.has(t)||ix.set(t,new WeakMap);var n=ix.get(t);if(n.has(r))return n.get(r);var a=function(){t.apply(void 0,arguments),r.apply(void 0,arguments)};return n.set(r,a),a},cq=function(t,r,n){var a=t.scale,i=t.type,o=t.layout,s=t.axisType;if(a==="auto")return o==="radial"&&s==="radiusAxis"?{scale:r0(),realScaleType:"band"}:o==="radial"&&s==="angleAxis"?{scale:Jp(),realScaleType:"linear"}:i==="category"&&r&&(r.indexOf("LineChart")>=0||r.indexOf("AreaChart")>=0||r.indexOf("ComposedChart")>=0&&!n)?{scale:Sf(),realScaleType:"point"}:i==="category"?{scale:r0(),realScaleType:"band"}:{scale:Jp(),realScaleType:"linear"};if(hc(a)){var l="scale".concat(ym(a));return{scale:(p5[l]||Sf)(),realScaleType:p5[l]?l:"point"}}return ar(a)?{scale:a}:{scale:Sf(),realScaleType:"point"}},k5=1e-4,uq=function(t){var r=t.domain();if(!(!r||r.length<=2)){var n=r.length,a=t.range(),i=Math.min(a[0],a[1])-k5,o=Math.max(a[0],a[1])+k5,s=t(r[0]),l=t(r[n-1]);(s<i||s>o||l<i||l>o)&&t.domain([r[0],r[n-1]])}},dq=function(t,r){if(!t)return null;for(var n=0,a=t.length;n<a;n++)if(t[n].item===r)return t[n].position;return null},fq=function(t,r){if(!r||r.length!==2||!We(r[0])||!We(r[1]))return t;var n=Math.min(r[0],r[1]),a=Math.max(r[0],r[1]),i=[t[0],t[1]];return(!We(t[0])||t[0]<n)&&(i[0]=n),(!We(t[1])||t[1]>a)&&(i[1]=a),i[0]>a&&(i[0]=a),i[1]<n&&(i[1]=n),i},hq=function(t){var r=t.length;if(!(r<=0))for(var n=0,a=t[0].length;n<a;++n)for(var i=0,o=0,s=0;s<r;++s){var l=ud(t[s][n][1])?t[s][n][0]:t[s][n][1];l>=0?(t[s][n][0]=i,t[s][n][1]=i+l,i=t[s][n][1]):(t[s][n][0]=o,t[s][n][1]=o+l,o=t[s][n][1])}},pq=function(t){var r=t.length;if(!(r<=0))for(var n=0,a=t[0].length;n<a;++n)for(var i=0,o=0;o<r;++o){var s=ud(t[o][n][1])?t[o][n][0]:t[o][n][1];s>=0?(t[o][n][0]=i,t[o][n][1]=i+s,i=t[o][n][1]):(t[o][n][0]=0,t[o][n][1]=0)}},gq={sign:hq,expand:O7,none:Cu,silhouette:A7,wiggle:E7,positive:pq},mq=function(t,r,n){var a=r.map(function(s){return s.props.dataKey}),i=gq[n],o=N7().keys(a).value(function(s,l){return+la(s,l,0)}).order(Ev).offset(i);return o(t)},yq=function(t,r,n,a,i,o){if(!t)return null;var s=o?r.reverse():r,l={},u=s.reduce(function(f,h){var g,v=(g=h.type)!==null&&g!==void 0&&g.defaultProps?$n($n({},h.type.defaultProps),h.props):h.props,w=v.stackId,b=v.hide;if(b)return f;var x=v[n],y=f[x]||{hasStack:!1,stackGroups:{}};if(sa(w)){var _=y.stackGroups[w]||{numericAxisId:n,cateAxisId:a,items:[]};_.items.push(h),y.hasStack=!0,y.stackGroups[w]=_}else y.stackGroups[Sc("_stackId_")]={numericAxisId:n,cateAxisId:a,items:[h]};return $n($n({},f),{},gu({},x,y))},l),d={};return Object.keys(u).reduce(function(f,h){var g=u[h];if(g.hasStack){var v={};g.stackGroups=Object.keys(g.stackGroups).reduce(function(w,b){var x=g.stackGroups[b];return $n($n({},w),{},gu({},b,{numericAxisId:n,cateAxisId:a,items:x.items,stackedData:mq(t,x.items,i)}))},v)}return $n($n({},f),{},gu({},h,g))},d)},xq=function(t,r){var n=r.realScaleType,a=r.type,i=r.tickCount,o=r.originalDomain,s=r.allowDecimals,l=n||r.scale;if(l!=="auto"&&l!=="linear")return null;if(i&&a==="number"&&o&&(o[0]==="auto"||o[1]==="auto")){var u=t.domain();if(!u.length)return null;var d=NY(u,i,s);return t.domain([Am(d),Qs(d)]),{niceTicks:d}}if(i&&a==="number"){var f=t.domain(),h=OY(f,i,s);return{niceTicks:h}}return null};function Du(e){var t=e.axis,r=e.ticks,n=e.bandSize,a=e.entry,i=e.index,o=e.dataKey;if(t.type==="category"){if(!t.allowDuplicatedCategory&&t.dataKey&&!qt(a[t.dataKey])){var s=Np(r,"value",a[t.dataKey]);if(s)return s.coordinate+n/2}return r[i]?r[i].coordinate+n/2:null}var l=la(a,qt(o)?t.dataKey:o);return qt(l)?null:t.scale(l)}var S5=function(t){var r=t.axis,n=t.ticks,a=t.offset,i=t.bandSize,o=t.entry,s=t.index;if(r.type==="category")return n[s]?n[s].coordinate+a:null;var l=la(o,r.dataKey,r.domain[s]);return qt(l)?null:r.scale(l)-i/2+a},vq=function(t){var r=t.numericAxis,n=r.scale.domain();if(r.type==="number"){var a=Math.min(n[0],n[1]),i=Math.max(n[0],n[1]);return a<=0&&i>=0?0:i<0?i:a}return n[0]},bq=function(t,r){var n,a=(n=t.type)!==null&&n!==void 0&&n.defaultProps?$n($n({},t.type.defaultProps),t.props):t.props,i=a.stackId;if(sa(i)){var o=r[i];if(o){var s=o.items.indexOf(t);return s>=0?o.stackedData[s]:null}}return null},wq=function(t){return t.reduce(function(r,n){return[Am(n.concat([r[0]]).filter(We)),Qs(n.concat([r[1]]).filter(We))]},[1/0,-1/0])},wN=function(t,r,n){return Object.keys(t).reduce(function(a,i){var o=t[i],s=o.stackedData,l=s.reduce(function(u,d){var f=wq(d.slice(r,n+1));return[Math.min(u[0],f[0]),Math.max(u[1],f[1])]},[1/0,-1/0]);return[Math.min(l[0],a[0]),Math.max(l[1],a[1])]},[1/0,-1/0]).map(function(a){return a===1/0||a===-1/0?0:a})},_5=/^dataMin[\s]*-[\s]*([0-9]+([.]{1}[0-9]+){0,1})$/,j5=/^dataMax[\s]*\+[\s]*([0-9]+([.]{1}[0-9]+){0,1})$/,l1=function(t,r,n){if(ar(t))return t(r,n);if(!Array.isArray(t))return r;var a=[];if(We(t[0]))a[0]=n?t[0]:Math.min(t[0],r[0]);else if(_5.test(t[0])){var i=+_5.exec(t[0])[1];a[0]=r[0]-i}else ar(t[0])?a[0]=t[0](r[0]):a[0]=r[0];if(We(t[1]))a[1]=n?t[1]:Math.max(t[1],r[1]);else if(j5.test(t[1])){var o=+j5.exec(t[1])[1];a[1]=r[1]+o}else ar(t[1])?a[1]=t[1](r[1]):a[1]=r[1];return a},ig=function(t,r,n){if(t&&t.scale&&t.scale.bandwidth){var a=t.scale.bandwidth();if(!n||a>0)return a}if(t&&r&&r.length>=2){for(var i=M2(r,function(f){return f.coordinate}),o=1/0,s=1,l=i.length;s<l;s++){var u=i[s],d=i[s-1];o=Math.min((u.coordinate||0)-(d.coordinate||0),o)}return o===1/0?0:o}return n?void 0:0},P5=function(t,r,n){return!t||!t.length||gc(t,Wi(n,"type.defaultProps.domain"))?r:t},kN=function(t,r){var n=t.type.defaultProps?$n($n({},t.type.defaultProps),t.props):t.props,a=n.dataKey,i=n.name,o=n.unit,s=n.formatter,l=n.tooltipType,u=n.chartType,d=n.hide;return $n($n({},er(t,!1)),{},{dataKey:a,unit:o,formatter:s,name:i||a,color:tw(t),value:la(r,a),type:l,payload:r,chartType:u,hide:d})};function d0(e){"@babel/helpers - typeof";return d0=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},d0(e)}function C5(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function M5(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?C5(Object(r),!0).forEach(function(n){kq(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):C5(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function kq(e,t,r){return t=Sq(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Sq(e){var t=_q(e,"string");return d0(t)=="symbol"?t:t+""}function _q(e,t){if(d0(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(d0(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var og=Math.PI/180,jq=function(t){return t*180/Math.PI},_a=function(t,r,n,a){return{x:t+Math.cos(-og*a)*n,y:r+Math.sin(-og*a)*n}},Pq=function(t,r){var n=t.x,a=t.y,i=r.x,o=r.y;return Math.sqrt(Math.pow(n-i,2)+Math.pow(a-o,2))},Cq=function(t,r){var n=t.x,a=t.y,i=r.cx,o=r.cy,s=Pq({x:n,y:a},{x:i,y:o});if(s<=0)return{radius:s};var l=(n-i)/s,u=Math.acos(l);return a>o&&(u=2*Math.PI-u),{radius:s,angle:jq(u),angleInRadian:u}},Mq=function(t){var r=t.startAngle,n=t.endAngle,a=Math.floor(r/360),i=Math.floor(n/360),o=Math.min(a,i);return{startAngle:r-o*360,endAngle:n-o*360}},Nq=function(t,r){var n=r.startAngle,a=r.endAngle,i=Math.floor(n/360),o=Math.floor(a/360),s=Math.min(i,o);return t+s*360},N5=function(t,r){var n=t.x,a=t.y,i=Cq({x:n,y:a},r),o=i.radius,s=i.angle,l=r.innerRadius,u=r.outerRadius;if(o<l||o>u)return!1;if(o===0)return!0;var d=Mq(r),f=d.startAngle,h=d.endAngle,g=s,v;if(f<=h){for(;g>h;)g-=360;for(;g<f;)g+=360;v=g>=f&&g<=h}else{for(;g>f;)g-=360;for(;g<h;)g+=360;v=g>=h&&g<=f}return v?M5(M5({},r),{},{radius:o,angle:Nq(g,r)}):null};function f0(e){"@babel/helpers - typeof";return f0=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},f0(e)}var Oq=["offset"];function Aq(e){return Rq(e)||Iq(e)||Tq(e)||Eq()}function Eq(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Tq(e,t){if(e){if(typeof e=="string")return c1(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return c1(e,t)}}function Iq(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function Rq(e){if(Array.isArray(e))return c1(e)}function c1(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Dq(e,t){if(e==null)return{};var r=$q(e,t),n,a;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function $q(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function O5(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function ra(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?O5(Object(r),!0).forEach(function(n){Lq(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):O5(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Lq(e,t,r){return t=Bq(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Bq(e){var t=Fq(e,"string");return f0(t)=="symbol"?t:t+""}function Fq(e,t){if(f0(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(f0(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function h0(){return h0=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},h0.apply(this,arguments)}var Uq=function(t){var r=t.value,n=t.formatter,a=qt(t.children)?r:t.children;return ar(n)?n(a):a},Gq=function(t,r){var n=go(r-t),a=Math.min(Math.abs(r-t),360);return n*a},zq=function(t,r,n){var a=t.position,i=t.viewBox,o=t.offset,s=t.className,l=i,u=l.cx,d=l.cy,f=l.innerRadius,h=l.outerRadius,g=l.startAngle,v=l.endAngle,w=l.clockWise,b=(f+h)/2,x=Gq(g,v),y=x>=0?1:-1,_,j;a==="insideStart"?(_=g+y*o,j=w):a==="insideEnd"?(_=v-y*o,j=!w):a==="end"&&(_=v+y*o,j=w),j=x<=0?j:!j;var S=_a(u,d,b,_),k=_a(u,d,b,_+(j?1:-1)*359),M="M".concat(S.x,",").concat(S.y,`
    A`).concat(b,",").concat(b,",0,1,").concat(j?0:1,`,
    `).concat(k.x,",").concat(k.y),N=qt(t.id)?Sc("recharts-radial-line-"):t.id;return oe.createElement("text",h0({},n,{dominantBaseline:"central",className:Nr("recharts-radial-bar-label",s)}),oe.createElement("defs",null,oe.createElement("path",{id:N,d:M})),oe.createElement("textPath",{xlinkHref:"#".concat(N)},r))},Wq=function(t){var r=t.viewBox,n=t.offset,a=t.position,i=r,o=i.cx,s=i.cy,l=i.innerRadius,u=i.outerRadius,d=i.startAngle,f=i.endAngle,h=(d+f)/2;if(a==="outside"){var g=_a(o,s,u+n,h),v=g.x,w=g.y;return{x:v,y:w,textAnchor:v>=o?"start":"end",verticalAnchor:"middle"}}if(a==="center")return{x:o,y:s,textAnchor:"middle",verticalAnchor:"middle"};if(a==="centerTop")return{x:o,y:s,textAnchor:"middle",verticalAnchor:"start"};if(a==="centerBottom")return{x:o,y:s,textAnchor:"middle",verticalAnchor:"end"};var b=(l+u)/2,x=_a(o,s,b,h),y=x.x,_=x.y;return{x:y,y:_,textAnchor:"middle",verticalAnchor:"middle"}},Vq=function(t){var r=t.viewBox,n=t.parentViewBox,a=t.offset,i=t.position,o=r,s=o.x,l=o.y,u=o.width,d=o.height,f=d>=0?1:-1,h=f*a,g=f>0?"end":"start",v=f>0?"start":"end",w=u>=0?1:-1,b=w*a,x=w>0?"end":"start",y=w>0?"start":"end";if(i==="top"){var _={x:s+u/2,y:l-f*a,textAnchor:"middle",verticalAnchor:g};return ra(ra({},_),n?{height:Math.max(l-n.y,0),width:u}:{})}if(i==="bottom"){var j={x:s+u/2,y:l+d+h,textAnchor:"middle",verticalAnchor:v};return ra(ra({},j),n?{height:Math.max(n.y+n.height-(l+d),0),width:u}:{})}if(i==="left"){var S={x:s-b,y:l+d/2,textAnchor:x,verticalAnchor:"middle"};return ra(ra({},S),n?{width:Math.max(S.x-n.x,0),height:d}:{})}if(i==="right"){var k={x:s+u+b,y:l+d/2,textAnchor:y,verticalAnchor:"middle"};return ra(ra({},k),n?{width:Math.max(n.x+n.width-k.x,0),height:d}:{})}var M=n?{width:u,height:d}:{};return i==="insideLeft"?ra({x:s+b,y:l+d/2,textAnchor:y,verticalAnchor:"middle"},M):i==="insideRight"?ra({x:s+u-b,y:l+d/2,textAnchor:x,verticalAnchor:"middle"},M):i==="insideTop"?ra({x:s+u/2,y:l+h,textAnchor:"middle",verticalAnchor:v},M):i==="insideBottom"?ra({x:s+u/2,y:l+d-h,textAnchor:"middle",verticalAnchor:g},M):i==="insideTopLeft"?ra({x:s+b,y:l+h,textAnchor:y,verticalAnchor:v},M):i==="insideTopRight"?ra({x:s+u-b,y:l+h,textAnchor:x,verticalAnchor:v},M):i==="insideBottomLeft"?ra({x:s+b,y:l+d-h,textAnchor:y,verticalAnchor:g},M):i==="insideBottomRight"?ra({x:s+u-b,y:l+d-h,textAnchor:x,verticalAnchor:g},M):od(i)&&(We(i.x)||zl(i.x))&&(We(i.y)||zl(i.y))?ra({x:s+pc(i.x,u),y:l+pc(i.y,d),textAnchor:"end",verticalAnchor:"end"},M):ra({x:s+u/2,y:l+d/2,textAnchor:"middle",verticalAnchor:"middle"},M)},Hq=function(t){return"cx"in t&&We(t.cx)};function Sa(e){var t=e.offset,r=t===void 0?5:t,n=Dq(e,Oq),a=ra({offset:r},n),i=a.viewBox,o=a.position,s=a.value,l=a.children,u=a.content,d=a.className,f=d===void 0?"":d,h=a.textBreakAll;if(!i||qt(s)&&qt(l)&&!P.isValidElement(u)&&!ar(u))return null;if(P.isValidElement(u))return P.cloneElement(u,a);var g;if(ar(u)){if(g=P.createElement(u,a),P.isValidElement(g))return g}else g=Uq(a);var v=Hq(i),w=er(a,!0);if(v&&(o==="insideStart"||o==="insideEnd"||o==="end"))return zq(a,g,w);var b=v?Wq(a):Vq(a);return oe.createElement(Wp,h0({className:Nr("recharts-label",f)},w,b,{breakAll:h}),g)}Sa.displayName="Label";var SN=function(t){var r=t.cx,n=t.cy,a=t.angle,i=t.startAngle,o=t.endAngle,s=t.r,l=t.radius,u=t.innerRadius,d=t.outerRadius,f=t.x,h=t.y,g=t.top,v=t.left,w=t.width,b=t.height,x=t.clockWise,y=t.labelViewBox;if(y)return y;if(We(w)&&We(b)){if(We(f)&&We(h))return{x:f,y:h,width:w,height:b};if(We(g)&&We(v))return{x:g,y:v,width:w,height:b}}return We(f)&&We(h)?{x:f,y:h,width:0,height:0}:We(r)&&We(n)?{cx:r,cy:n,startAngle:i||a||0,endAngle:o||a||0,innerRadius:u||0,outerRadius:d||l||s||0,clockWise:x}:t.viewBox?t.viewBox:{}},Xq=function(t,r){return t?t===!0?oe.createElement(Sa,{key:"label-implicit",viewBox:r}):sa(t)?oe.createElement(Sa,{key:"label-implicit",viewBox:r,value:t}):P.isValidElement(t)?t.type===Sa?P.cloneElement(t,{key:"label-implicit",viewBox:r}):oe.createElement(Sa,{key:"label-implicit",content:t,viewBox:r}):ar(t)?oe.createElement(Sa,{key:"label-implicit",content:t,viewBox:r}):od(t)?oe.createElement(Sa,h0({viewBox:r},t,{key:"label-implicit"})):null:null},Kq=function(t,r){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;if(!t||!t.children&&n&&!t.label)return null;var a=t.children,i=SN(t),o=pi(a,Sa).map(function(l,u){return P.cloneElement(l,{viewBox:r||i,key:"label-".concat(u)})});if(!n)return o;var s=Xq(t.label,r||i);return[s].concat(Aq(o))};Sa.parseViewBox=SN;Sa.renderCallByParent=Kq;function Yq(e){var t=e==null?0:e.length;return t?e[t-1]:void 0}var qq=Yq;const Zq=dn(qq);function p0(e){"@babel/helpers - typeof";return p0=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},p0(e)}var Jq=["valueAccessor"],Qq=["data","dataKey","clockWise","id","textBreakAll"];function eZ(e){return aZ(e)||nZ(e)||rZ(e)||tZ()}function tZ(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function rZ(e,t){if(e){if(typeof e=="string")return u1(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return u1(e,t)}}function nZ(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function aZ(e){if(Array.isArray(e))return u1(e)}function u1(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function sg(){return sg=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},sg.apply(this,arguments)}function A5(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function E5(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?A5(Object(r),!0).forEach(function(n){iZ(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):A5(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function iZ(e,t,r){return t=oZ(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function oZ(e){var t=sZ(e,"string");return p0(t)=="symbol"?t:t+""}function sZ(e,t){if(p0(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(p0(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function T5(e,t){if(e==null)return{};var r=lZ(e,t),n,a;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function lZ(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}var cZ=function(t){return Array.isArray(t.value)?Zq(t.value):t.value};function Lo(e){var t=e.valueAccessor,r=t===void 0?cZ:t,n=T5(e,Jq),a=n.data,i=n.dataKey,o=n.clockWise,s=n.id,l=n.textBreakAll,u=T5(n,Qq);return!a||!a.length?null:oe.createElement(Yr,{className:"recharts-label-list"},a.map(function(d,f){var h=qt(i)?r(d,f):la(d&&d.payload,i),g=qt(s)?{}:{id:"".concat(s,"-").concat(f)};return oe.createElement(Sa,sg({},er(d,!0),u,g,{parentViewBox:d.parentViewBox,value:h,textBreakAll:l,viewBox:Sa.parseViewBox(qt(o)?d:E5(E5({},d),{},{clockWise:o})),key:"label-".concat(f),index:f}))}))}Lo.displayName="LabelList";function uZ(e,t){return e?e===!0?oe.createElement(Lo,{key:"labelList-implicit",data:t}):oe.isValidElement(e)||ar(e)?oe.createElement(Lo,{key:"labelList-implicit",data:t,content:e}):od(e)?oe.createElement(Lo,sg({data:t},e,{key:"labelList-implicit"})):null:null}function dZ(e,t){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;if(!e||!e.children&&r&&!e.label)return null;var n=e.children,a=pi(n,Lo).map(function(o,s){return P.cloneElement(o,{data:t,key:"labelList-".concat(s)})});if(!r)return a;var i=uZ(e.label,t);return[i].concat(eZ(a))}Lo.renderCallByParent=dZ;function g0(e){"@babel/helpers - typeof";return g0=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},g0(e)}function d1(){return d1=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},d1.apply(this,arguments)}function I5(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function R5(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?I5(Object(r),!0).forEach(function(n){fZ(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):I5(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function fZ(e,t,r){return t=hZ(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function hZ(e){var t=pZ(e,"string");return g0(t)=="symbol"?t:t+""}function pZ(e,t){if(g0(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(g0(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var gZ=function(t,r){var n=go(r-t),a=Math.min(Math.abs(r-t),359.999);return n*a},Nh=function(t){var r=t.cx,n=t.cy,a=t.radius,i=t.angle,o=t.sign,s=t.isExternal,l=t.cornerRadius,u=t.cornerIsExternal,d=l*(s?1:-1)+a,f=Math.asin(l/d)/og,h=u?i:i+o*f,g=_a(r,n,d,h),v=_a(r,n,a,h),w=u?i-o*f:i,b=_a(r,n,d*Math.cos(f*og),w);return{center:g,circleTangency:v,lineTangency:b,theta:f}},_N=function(t){var r=t.cx,n=t.cy,a=t.innerRadius,i=t.outerRadius,o=t.startAngle,s=t.endAngle,l=gZ(o,s),u=o+l,d=_a(r,n,i,o),f=_a(r,n,i,u),h="M ".concat(d.x,",").concat(d.y,`
    A `).concat(i,",").concat(i,`,0,
    `).concat(+(Math.abs(l)>180),",").concat(+(o>u),`,
    `).concat(f.x,",").concat(f.y,`
  `);if(a>0){var g=_a(r,n,a,o),v=_a(r,n,a,u);h+="L ".concat(v.x,",").concat(v.y,`
            A `).concat(a,",").concat(a,`,0,
            `).concat(+(Math.abs(l)>180),",").concat(+(o<=u),`,
            `).concat(g.x,",").concat(g.y," Z")}else h+="L ".concat(r,",").concat(n," Z");return h},mZ=function(t){var r=t.cx,n=t.cy,a=t.innerRadius,i=t.outerRadius,o=t.cornerRadius,s=t.forceCornerRadius,l=t.cornerIsExternal,u=t.startAngle,d=t.endAngle,f=go(d-u),h=Nh({cx:r,cy:n,radius:i,angle:u,sign:f,cornerRadius:o,cornerIsExternal:l}),g=h.circleTangency,v=h.lineTangency,w=h.theta,b=Nh({cx:r,cy:n,radius:i,angle:d,sign:-f,cornerRadius:o,cornerIsExternal:l}),x=b.circleTangency,y=b.lineTangency,_=b.theta,j=l?Math.abs(u-d):Math.abs(u-d)-w-_;if(j<0)return s?"M ".concat(v.x,",").concat(v.y,`
        a`).concat(o,",").concat(o,",0,0,1,").concat(o*2,`,0
        a`).concat(o,",").concat(o,",0,0,1,").concat(-o*2,`,0
      `):_N({cx:r,cy:n,innerRadius:a,outerRadius:i,startAngle:u,endAngle:d});var S="M ".concat(v.x,",").concat(v.y,`
    A`).concat(o,",").concat(o,",0,0,").concat(+(f<0),",").concat(g.x,",").concat(g.y,`
    A`).concat(i,",").concat(i,",0,").concat(+(j>180),",").concat(+(f<0),",").concat(x.x,",").concat(x.y,`
    A`).concat(o,",").concat(o,",0,0,").concat(+(f<0),",").concat(y.x,",").concat(y.y,`
  `);if(a>0){var k=Nh({cx:r,cy:n,radius:a,angle:u,sign:f,isExternal:!0,cornerRadius:o,cornerIsExternal:l}),M=k.circleTangency,N=k.lineTangency,T=k.theta,A=Nh({cx:r,cy:n,radius:a,angle:d,sign:-f,isExternal:!0,cornerRadius:o,cornerIsExternal:l}),D=A.circleTangency,$=A.lineTangency,B=A.theta,J=l?Math.abs(u-d):Math.abs(u-d)-T-B;if(J<0&&o===0)return"".concat(S,"L").concat(r,",").concat(n,"Z");S+="L".concat($.x,",").concat($.y,`
      A`).concat(o,",").concat(o,",0,0,").concat(+(f<0),",").concat(D.x,",").concat(D.y,`
      A`).concat(a,",").concat(a,",0,").concat(+(J>180),",").concat(+(f>0),",").concat(M.x,",").concat(M.y,`
      A`).concat(o,",").concat(o,",0,0,").concat(+(f<0),",").concat(N.x,",").concat(N.y,"Z")}else S+="L".concat(r,",").concat(n,"Z");return S},yZ={cx:0,cy:0,innerRadius:0,outerRadius:0,startAngle:0,endAngle:0,cornerRadius:0,forceCornerRadius:!1,cornerIsExternal:!1},jN=function(t){var r=R5(R5({},yZ),t),n=r.cx,a=r.cy,i=r.innerRadius,o=r.outerRadius,s=r.cornerRadius,l=r.forceCornerRadius,u=r.cornerIsExternal,d=r.startAngle,f=r.endAngle,h=r.className;if(o<i||d===f)return null;var g=Nr("recharts-sector",h),v=o-i,w=pc(s,v,0,!0),b;return w>0&&Math.abs(d-f)<360?b=mZ({cx:n,cy:a,innerRadius:i,outerRadius:o,cornerRadius:Math.min(w,v/2),forceCornerRadius:l,cornerIsExternal:u,startAngle:d,endAngle:f}):b=_N({cx:n,cy:a,innerRadius:i,outerRadius:o,startAngle:d,endAngle:f}),oe.createElement("path",d1({},er(r,!0),{className:g,d:b,role:"img"}))};function m0(e){"@babel/helpers - typeof";return m0=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},m0(e)}function f1(){return f1=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},f1.apply(this,arguments)}function D5(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function $5(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?D5(Object(r),!0).forEach(function(n){xZ(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):D5(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function xZ(e,t,r){return t=vZ(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function vZ(e){var t=bZ(e,"string");return m0(t)=="symbol"?t:t+""}function bZ(e,t){if(m0(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(m0(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var L5={curveBasisClosed:x7,curveBasisOpen:v7,curveBasis:y7,curveBumpX:n7,curveBumpY:a7,curveLinearClosed:b7,curveLinear:vm,curveMonotoneX:w7,curveMonotoneY:k7,curveNatural:S7,curveStep:_7,curveStepAfter:P7,curveStepBefore:j7},Oh=function(t){return t.x===+t.x&&t.y===+t.y},ef=function(t){return t.x},tf=function(t){return t.y},wZ=function(t,r){if(ar(t))return t;var n="curve".concat(ym(t));return(n==="curveMonotone"||n==="curveBump")&&r?L5["".concat(n).concat(r==="vertical"?"Y":"X")]:L5[n]||vm},kZ=function(t){var r=t.type,n=r===void 0?"linear":r,a=t.points,i=a===void 0?[]:a,o=t.baseLine,s=t.layout,l=t.connectNulls,u=l===void 0?!1:l,d=wZ(n,s),f=u?i.filter(function(w){return Oh(w)}):i,h;if(Array.isArray(o)){var g=u?o.filter(function(w){return Oh(w)}):o,v=f.map(function(w,b){return $5($5({},w),{},{base:g[b]})});return s==="vertical"?h=bh().y(tf).x1(ef).x0(function(w){return w.base.x}):h=bh().x(ef).y1(tf).y0(function(w){return w.base.y}),h.defined(Oh).curve(d),h(v)}return s==="vertical"&&We(o)?h=bh().y(tf).x1(ef).x0(o):We(o)?h=bh().x(ef).y1(tf).y0(o):h=CC().x(ef).y(tf),h.defined(Oh).curve(d),h(f)},Ql=function(t){var r=t.className,n=t.points,a=t.path,i=t.pathRef;if((!n||!n.length)&&!a)return null;var o=n&&n.length?kZ(t):a;return P.createElement("path",f1({},er(t,!1),Op(t),{className:Nr("recharts-curve",r),d:o,ref:i}))},PN={exports:{}},SZ="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED",_Z=SZ,jZ=_Z;function CN(){}function MN(){}MN.resetWarningCache=CN;var PZ=function(){function e(n,a,i,o,s,l){if(l!==jZ){var u=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw u.name="Invariant Violation",u}}e.isRequired=e;function t(){return e}var r={array:e,bigint:e,bool:e,func:e,number:e,object:e,string:e,symbol:e,any:e,arrayOf:t,element:e,elementType:e,instanceOf:t,node:e,objectOf:t,oneOf:t,oneOfType:t,shape:t,exact:t,checkPropTypes:MN,resetWarningCache:CN};return r.PropTypes=r,r};PN.exports=PZ();var CZ=PN.exports;const Jr=dn(CZ),{getOwnPropertyNames:MZ,getOwnPropertySymbols:NZ}=Object,{hasOwnProperty:OZ}=Object.prototype;function ox(e,t){return function(n,a,i){return e(n,a,i)&&t(n,a,i)}}function Ah(e){return function(r,n,a){if(!r||!n||typeof r!="object"||typeof n!="object")return e(r,n,a);const{cache:i}=a,o=i.get(r),s=i.get(n);if(o&&s)return o===n&&s===r;i.set(r,n),i.set(n,r);const l=e(r,n,a);return i.delete(r),i.delete(n),l}}function AZ(e){return e!=null?e[Symbol.toStringTag]:void 0}function B5(e){return MZ(e).concat(NZ(e))}const EZ=Object.hasOwn||((e,t)=>OZ.call(e,t));function Pc(e,t){return e===t||!e&&!t&&e!==e&&t!==t}const TZ="__v",IZ="__o",RZ="_owner",{getOwnPropertyDescriptor:F5,keys:U5}=Object;function DZ(e,t){return e.byteLength===t.byteLength&&lg(new Uint8Array(e),new Uint8Array(t))}function $Z(e,t,r){let n=e.length;if(t.length!==n)return!1;for(;n-- >0;)if(!r.equals(e[n],t[n],n,n,e,t,r))return!1;return!0}function LZ(e,t){return e.byteLength===t.byteLength&&lg(new Uint8Array(e.buffer,e.byteOffset,e.byteLength),new Uint8Array(t.buffer,t.byteOffset,t.byteLength))}function BZ(e,t){return Pc(e.getTime(),t.getTime())}function FZ(e,t){return e.name===t.name&&e.message===t.message&&e.cause===t.cause&&e.stack===t.stack}function UZ(e,t){return e===t}function G5(e,t,r){const n=e.size;if(n!==t.size)return!1;if(!n)return!0;const a=new Array(n),i=e.entries();let o,s,l=0;for(;(o=i.next())&&!o.done;){const u=t.entries();let d=!1,f=0;for(;(s=u.next())&&!s.done;){if(a[f]){f++;continue}const h=o.value,g=s.value;if(r.equals(h[0],g[0],l,f,e,t,r)&&r.equals(h[1],g[1],h[0],g[0],e,t,r)){d=a[f]=!0;break}f++}if(!d)return!1;l++}return!0}const GZ=Pc;function zZ(e,t,r){const n=U5(e);let a=n.length;if(U5(t).length!==a)return!1;for(;a-- >0;)if(!NN(e,t,r,n[a]))return!1;return!0}function rf(e,t,r){const n=B5(e);let a=n.length;if(B5(t).length!==a)return!1;let i,o,s;for(;a-- >0;)if(i=n[a],!NN(e,t,r,i)||(o=F5(e,i),s=F5(t,i),(o||s)&&(!o||!s||o.configurable!==s.configurable||o.enumerable!==s.enumerable||o.writable!==s.writable)))return!1;return!0}function WZ(e,t){return Pc(e.valueOf(),t.valueOf())}function VZ(e,t){return e.source===t.source&&e.flags===t.flags}function z5(e,t,r){const n=e.size;if(n!==t.size)return!1;if(!n)return!0;const a=new Array(n),i=e.values();let o,s;for(;(o=i.next())&&!o.done;){const l=t.values();let u=!1,d=0;for(;(s=l.next())&&!s.done;){if(!a[d]&&r.equals(o.value,s.value,o.value,s.value,e,t,r)){u=a[d]=!0;break}d++}if(!u)return!1}return!0}function lg(e,t){let r=e.byteLength;if(t.byteLength!==r||e.byteOffset!==t.byteOffset)return!1;for(;r-- >0;)if(e[r]!==t[r])return!1;return!0}function HZ(e,t){return e.hostname===t.hostname&&e.pathname===t.pathname&&e.protocol===t.protocol&&e.port===t.port&&e.hash===t.hash&&e.username===t.username&&e.password===t.password}function NN(e,t,r,n){return(n===RZ||n===IZ||n===TZ)&&(e.$$typeof||t.$$typeof)?!0:EZ(t,n)&&r.equals(e[n],t[n],n,n,e,t,r)}const XZ="[object ArrayBuffer]",KZ="[object Arguments]",YZ="[object Boolean]",qZ="[object DataView]",ZZ="[object Date]",JZ="[object Error]",QZ="[object Map]",eJ="[object Number]",tJ="[object Object]",rJ="[object RegExp]",nJ="[object Set]",aJ="[object String]",iJ={"[object Int8Array]":!0,"[object Uint8Array]":!0,"[object Uint8ClampedArray]":!0,"[object Int16Array]":!0,"[object Uint16Array]":!0,"[object Int32Array]":!0,"[object Uint32Array]":!0,"[object Float16Array]":!0,"[object Float32Array]":!0,"[object Float64Array]":!0,"[object BigInt64Array]":!0,"[object BigUint64Array]":!0},oJ="[object URL]",sJ=Object.prototype.toString;function lJ({areArrayBuffersEqual:e,areArraysEqual:t,areDataViewsEqual:r,areDatesEqual:n,areErrorsEqual:a,areFunctionsEqual:i,areMapsEqual:o,areNumbersEqual:s,areObjectsEqual:l,arePrimitiveWrappersEqual:u,areRegExpsEqual:d,areSetsEqual:f,areTypedArraysEqual:h,areUrlsEqual:g,unknownTagComparators:v}){return function(b,x,y){if(b===x)return!0;if(b==null||x==null)return!1;const _=typeof b;if(_!==typeof x)return!1;if(_!=="object")return _==="number"?s(b,x,y):_==="function"?i(b,x,y):!1;const j=b.constructor;if(j!==x.constructor)return!1;if(j===Object)return l(b,x,y);if(Array.isArray(b))return t(b,x,y);if(j===Date)return n(b,x,y);if(j===RegExp)return d(b,x,y);if(j===Map)return o(b,x,y);if(j===Set)return f(b,x,y);const S=sJ.call(b);if(S===ZZ)return n(b,x,y);if(S===rJ)return d(b,x,y);if(S===QZ)return o(b,x,y);if(S===nJ)return f(b,x,y);if(S===tJ)return typeof b.then!="function"&&typeof x.then!="function"&&l(b,x,y);if(S===oJ)return g(b,x,y);if(S===JZ)return a(b,x,y);if(S===KZ)return l(b,x,y);if(iJ[S])return h(b,x,y);if(S===XZ)return e(b,x,y);if(S===qZ)return r(b,x,y);if(S===YZ||S===eJ||S===aJ)return u(b,x,y);if(v){let k=v[S];if(!k){const M=AZ(b);M&&(k=v[M])}if(k)return k(b,x,y)}return!1}}function cJ({circular:e,createCustomConfig:t,strict:r}){let n={areArrayBuffersEqual:DZ,areArraysEqual:r?rf:$Z,areDataViewsEqual:LZ,areDatesEqual:BZ,areErrorsEqual:FZ,areFunctionsEqual:UZ,areMapsEqual:r?ox(G5,rf):G5,areNumbersEqual:GZ,areObjectsEqual:r?rf:zZ,arePrimitiveWrappersEqual:WZ,areRegExpsEqual:VZ,areSetsEqual:r?ox(z5,rf):z5,areTypedArraysEqual:r?ox(lg,rf):lg,areUrlsEqual:HZ,unknownTagComparators:void 0};if(t&&(n=Object.assign({},n,t(n))),e){const a=Ah(n.areArraysEqual),i=Ah(n.areMapsEqual),o=Ah(n.areObjectsEqual),s=Ah(n.areSetsEqual);n=Object.assign({},n,{areArraysEqual:a,areMapsEqual:i,areObjectsEqual:o,areSetsEqual:s})}return n}function uJ(e){return function(t,r,n,a,i,o,s){return e(t,r,s)}}function dJ({circular:e,comparator:t,createState:r,equals:n,strict:a}){if(r)return function(s,l){const{cache:u=e?new WeakMap:void 0,meta:d}=r();return t(s,l,{cache:u,equals:n,meta:d,strict:a})};if(e)return function(s,l){return t(s,l,{cache:new WeakMap,equals:n,meta:void 0,strict:a})};const i={cache:void 0,equals:n,meta:void 0,strict:a};return function(s,l){return t(s,l,i)}}const fJ=Pl();Pl({strict:!0});Pl({circular:!0});Pl({circular:!0,strict:!0});Pl({createInternalComparator:()=>Pc});Pl({strict:!0,createInternalComparator:()=>Pc});Pl({circular:!0,createInternalComparator:()=>Pc});Pl({circular:!0,createInternalComparator:()=>Pc,strict:!0});function Pl(e={}){const{circular:t=!1,createInternalComparator:r,createState:n,strict:a=!1}=e,i=cJ(e),o=lJ(i),s=r?r(o):uJ(o);return dJ({circular:t,comparator:o,createState:n,equals:s,strict:a})}function hJ(e){typeof requestAnimationFrame<"u"&&requestAnimationFrame(e)}function W5(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,r=-1,n=function a(i){r<0&&(r=i),i-r>t?(e(i),r=-1):hJ(a)};requestAnimationFrame(n)}function h1(e){"@babel/helpers - typeof";return h1=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},h1(e)}function pJ(e){return xJ(e)||yJ(e)||mJ(e)||gJ()}function gJ(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function mJ(e,t){if(e){if(typeof e=="string")return V5(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return V5(e,t)}}function V5(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function yJ(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function xJ(e){if(Array.isArray(e))return e}function vJ(){var e={},t=function(){return null},r=!1,n=function a(i){if(!r){if(Array.isArray(i)){if(!i.length)return;var o=i,s=pJ(o),l=s[0],u=s.slice(1);if(typeof l=="number"){W5(a.bind(null,u),l);return}a(l),W5(a.bind(null,u));return}h1(i)==="object"&&(e=i,t(e)),typeof i=="function"&&i()}};return{stop:function(){r=!0},start:function(i){r=!1,n(i)},subscribe:function(i){return t=i,function(){t=function(){return null}}}}}function y0(e){"@babel/helpers - typeof";return y0=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},y0(e)}function H5(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function X5(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?H5(Object(r),!0).forEach(function(n){ON(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):H5(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function ON(e,t,r){return t=bJ(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function bJ(e){var t=wJ(e,"string");return y0(t)==="symbol"?t:String(t)}function wJ(e,t){if(y0(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(y0(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var kJ=function(t,r){return[Object.keys(t),Object.keys(r)].reduce(function(n,a){return n.filter(function(i){return a.includes(i)})})},SJ=function(t){return t},_J=function(t){return t.replace(/([A-Z])/g,function(r){return"-".concat(r.toLowerCase())})},jf=function(t,r){return Object.keys(r).reduce(function(n,a){return X5(X5({},n),{},ON({},a,t(a,r[a])))},{})},K5=function(t,r,n){return t.map(function(a){return"".concat(_J(a)," ").concat(r,"ms ").concat(n)}).join(",")};function jJ(e,t){return MJ(e)||CJ(e,t)||AN(e,t)||PJ()}function PJ(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function CJ(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,a,i,o,s=[],l=!0,u=!1;try{if(i=(r=r.call(e)).next,t!==0)for(;!(l=(n=i.call(r)).done)&&(s.push(n.value),s.length!==t);l=!0);}catch(d){u=!0,a=d}finally{try{if(!l&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(u)throw a}}return s}}function MJ(e){if(Array.isArray(e))return e}function NJ(e){return EJ(e)||AJ(e)||AN(e)||OJ()}function OJ(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function AN(e,t){if(e){if(typeof e=="string")return p1(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return p1(e,t)}}function AJ(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function EJ(e){if(Array.isArray(e))return p1(e)}function p1(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var cg=1e-4,EN=function(t,r){return[0,3*t,3*r-6*t,3*t-3*r+1]},TN=function(t,r){return t.map(function(n,a){return n*Math.pow(r,a)}).reduce(function(n,a){return n+a})},Y5=function(t,r){return function(n){var a=EN(t,r);return TN(a,n)}},TJ=function(t,r){return function(n){var a=EN(t,r),i=[].concat(NJ(a.map(function(o,s){return o*s}).slice(1)),[0]);return TN(i,n)}},q5=function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];var a=r[0],i=r[1],o=r[2],s=r[3];if(r.length===1)switch(r[0]){case"linear":a=0,i=0,o=1,s=1;break;case"ease":a=.25,i=.1,o=.25,s=1;break;case"ease-in":a=.42,i=0,o=1,s=1;break;case"ease-out":a=.42,i=0,o=.58,s=1;break;case"ease-in-out":a=0,i=0,o=.58,s=1;break;default:{var l=r[0].split("(");if(l[0]==="cubic-bezier"&&l[1].split(")")[0].split(",").length===4){var u=l[1].split(")")[0].split(",").map(function(b){return parseFloat(b)}),d=jJ(u,4);a=d[0],i=d[1],o=d[2],s=d[3]}}}var f=Y5(a,o),h=Y5(i,s),g=TJ(a,o),v=function(x){return x>1?1:x<0?0:x},w=function(x){for(var y=x>1?1:x,_=y,j=0;j<8;++j){var S=f(_)-y,k=g(_);if(Math.abs(S-y)<cg||k<cg)return h(_);_=v(_-S/k)}return h(_)};return w.isStepper=!1,w},IJ=function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},r=t.stiff,n=r===void 0?100:r,a=t.damping,i=a===void 0?8:a,o=t.dt,s=o===void 0?17:o,l=function(d,f,h){var g=-(d-f)*n,v=h*i,w=h+(g-v)*s/1e3,b=h*s/1e3+d;return Math.abs(b-f)<cg&&Math.abs(w)<cg?[f,0]:[b,w]};return l.isStepper=!0,l.dt=s,l},RJ=function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];var a=r[0];if(typeof a=="string")switch(a){case"ease":case"ease-in-out":case"ease-out":case"ease-in":case"linear":return q5(a);case"spring":return IJ();default:if(a.split("(")[0]==="cubic-bezier")return q5(a)}return typeof a=="function"?a:null};function x0(e){"@babel/helpers - typeof";return x0=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},x0(e)}function Z5(e){return LJ(e)||$J(e)||IN(e)||DJ()}function DJ(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function $J(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function LJ(e){if(Array.isArray(e))return m1(e)}function J5(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function wa(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?J5(Object(r),!0).forEach(function(n){g1(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):J5(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function g1(e,t,r){return t=BJ(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function BJ(e){var t=FJ(e,"string");return x0(t)==="symbol"?t:String(t)}function FJ(e,t){if(x0(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(x0(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function UJ(e,t){return WJ(e)||zJ(e,t)||IN(e,t)||GJ()}function GJ(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function IN(e,t){if(e){if(typeof e=="string")return m1(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return m1(e,t)}}function m1(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function zJ(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,a,i,o,s=[],l=!0,u=!1;try{if(i=(r=r.call(e)).next,t!==0)for(;!(l=(n=i.call(r)).done)&&(s.push(n.value),s.length!==t);l=!0);}catch(d){u=!0,a=d}finally{try{if(!l&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(u)throw a}}return s}}function WJ(e){if(Array.isArray(e))return e}var ug=function(t,r,n){return t+(r-t)*n},y1=function(t){var r=t.from,n=t.to;return r!==n},VJ=function e(t,r,n){var a=jf(function(i,o){if(y1(o)){var s=t(o.from,o.to,o.velocity),l=UJ(s,2),u=l[0],d=l[1];return wa(wa({},o),{},{from:u,velocity:d})}return o},r);return n<1?jf(function(i,o){return y1(o)?wa(wa({},o),{},{velocity:ug(o.velocity,a[i].velocity,n),from:ug(o.from,a[i].from,n)}):o},r):e(t,a,n-1)};const HJ=function(e,t,r,n,a){var i=kJ(e,t),o=i.reduce(function(b,x){return wa(wa({},b),{},g1({},x,[e[x],t[x]]))},{}),s=i.reduce(function(b,x){return wa(wa({},b),{},g1({},x,{from:e[x],velocity:0,to:t[x]}))},{}),l=-1,u,d,f=function(){return null},h=function(){return jf(function(x,y){return y.from},s)},g=function(){return!Object.values(s).filter(y1).length},v=function(x){u||(u=x);var y=x-u,_=y/r.dt;s=VJ(r,s,_),a(wa(wa(wa({},e),t),h())),u=x,g()||(l=requestAnimationFrame(f))},w=function(x){d||(d=x);var y=(x-d)/n,_=jf(function(S,k){return ug.apply(void 0,Z5(k).concat([r(y)]))},o);if(a(wa(wa(wa({},e),t),_)),y<1)l=requestAnimationFrame(f);else{var j=jf(function(S,k){return ug.apply(void 0,Z5(k).concat([r(1)]))},o);a(wa(wa(wa({},e),t),j))}};return f=r.isStepper?v:w,function(){return requestAnimationFrame(f),function(){cancelAnimationFrame(l)}}};function $u(e){"@babel/helpers - typeof";return $u=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},$u(e)}var XJ=["children","begin","duration","attributeName","easing","isActive","steps","from","to","canBegin","onAnimationEnd","shouldReAnimate","onAnimationReStart"];function KJ(e,t){if(e==null)return{};var r=YJ(e,t),n,a;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function YJ(e,t){if(e==null)return{};var r={},n=Object.keys(e),a,i;for(i=0;i<n.length;i++)a=n[i],!(t.indexOf(a)>=0)&&(r[a]=e[a]);return r}function sx(e){return QJ(e)||JJ(e)||ZJ(e)||qJ()}function qJ(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function ZJ(e,t){if(e){if(typeof e=="string")return x1(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return x1(e,t)}}function JJ(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function QJ(e){if(Array.isArray(e))return x1(e)}function x1(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Q5(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function io(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Q5(Object(r),!0).forEach(function(n){uf(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Q5(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function uf(e,t,r){return t=RN(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function eQ(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function tQ(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,RN(n.key),n)}}function rQ(e,t,r){return t&&tQ(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function RN(e){var t=nQ(e,"string");return $u(t)==="symbol"?t:String(t)}function nQ(e,t){if($u(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if($u(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function aQ(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&v1(e,t)}function v1(e,t){return v1=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},v1(e,t)}function iQ(e){var t=oQ();return function(){var n=dg(e),a;if(t){var i=dg(this).constructor;a=Reflect.construct(n,arguments,i)}else a=n.apply(this,arguments);return b1(this,a)}}function b1(e,t){if(t&&($u(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return w1(e)}function w1(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function oQ(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function dg(e){return dg=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},dg(e)}var bo=function(e){aQ(r,e);var t=iQ(r);function r(n,a){var i;eQ(this,r),i=t.call(this,n,a);var o=i.props,s=o.isActive,l=o.attributeName,u=o.from,d=o.to,f=o.steps,h=o.children,g=o.duration;if(i.handleStyleChange=i.handleStyleChange.bind(w1(i)),i.changeStyle=i.changeStyle.bind(w1(i)),!s||g<=0)return i.state={style:{}},typeof h=="function"&&(i.state={style:d}),b1(i);if(f&&f.length)i.state={style:f[0].style};else if(u){if(typeof h=="function")return i.state={style:u},b1(i);i.state={style:l?uf({},l,u):u}}else i.state={style:{}};return i}return rQ(r,[{key:"componentDidMount",value:function(){var a=this.props,i=a.isActive,o=a.canBegin;this.mounted=!0,!(!i||!o)&&this.runAnimation(this.props)}},{key:"componentDidUpdate",value:function(a){var i=this.props,o=i.isActive,s=i.canBegin,l=i.attributeName,u=i.shouldReAnimate,d=i.to,f=i.from,h=this.state.style;if(s){if(!o){var g={style:l?uf({},l,d):d};this.state&&h&&(l&&h[l]!==d||!l&&h!==d)&&this.setState(g);return}if(!(fJ(a.to,d)&&a.canBegin&&a.isActive)){var v=!a.canBegin||!a.isActive;this.manager&&this.manager.stop(),this.stopJSAnimation&&this.stopJSAnimation();var w=v||u?f:a.to;if(this.state&&h){var b={style:l?uf({},l,w):w};(l&&h[l]!==w||!l&&h!==w)&&this.setState(b)}this.runAnimation(io(io({},this.props),{},{from:w,begin:0}))}}}},{key:"componentWillUnmount",value:function(){this.mounted=!1;var a=this.props.onAnimationEnd;this.unSubscribe&&this.unSubscribe(),this.manager&&(this.manager.stop(),this.manager=null),this.stopJSAnimation&&this.stopJSAnimation(),a&&a()}},{key:"handleStyleChange",value:function(a){this.changeStyle(a)}},{key:"changeStyle",value:function(a){this.mounted&&this.setState({style:a})}},{key:"runJSAnimation",value:function(a){var i=this,o=a.from,s=a.to,l=a.duration,u=a.easing,d=a.begin,f=a.onAnimationEnd,h=a.onAnimationStart,g=HJ(o,s,RJ(u),l,this.changeStyle),v=function(){i.stopJSAnimation=g()};this.manager.start([h,d,v,l,f])}},{key:"runStepAnimation",value:function(a){var i=this,o=a.steps,s=a.begin,l=a.onAnimationStart,u=o[0],d=u.style,f=u.duration,h=f===void 0?0:f,g=function(w,b,x){if(x===0)return w;var y=b.duration,_=b.easing,j=_===void 0?"ease":_,S=b.style,k=b.properties,M=b.onAnimationEnd,N=x>0?o[x-1]:b,T=k||Object.keys(S);if(typeof j=="function"||j==="spring")return[].concat(sx(w),[i.runJSAnimation.bind(i,{from:N.style,to:S,duration:y,easing:j}),y]);var A=K5(T,y,j),D=io(io(io({},N.style),S),{},{transition:A});return[].concat(sx(w),[D,y,M]).filter(SJ)};return this.manager.start([l].concat(sx(o.reduce(g,[d,Math.max(h,s)])),[a.onAnimationEnd]))}},{key:"runAnimation",value:function(a){this.manager||(this.manager=vJ());var i=a.begin,o=a.duration,s=a.attributeName,l=a.to,u=a.easing,d=a.onAnimationStart,f=a.onAnimationEnd,h=a.steps,g=a.children,v=this.manager;if(this.unSubscribe=v.subscribe(this.handleStyleChange),typeof u=="function"||typeof g=="function"||u==="spring"){this.runJSAnimation(a);return}if(h.length>1){this.runStepAnimation(a);return}var w=s?uf({},s,l):l,b=K5(Object.keys(w),o,u);v.start([d,i,io(io({},w),{},{transition:b}),o,f])}},{key:"render",value:function(){var a=this.props,i=a.children;a.begin;var o=a.duration;a.attributeName,a.easing;var s=a.isActive;a.steps,a.from,a.to,a.canBegin,a.onAnimationEnd,a.shouldReAnimate,a.onAnimationReStart;var l=KJ(a,XJ),u=P.Children.count(i),d=this.state.style;if(typeof i=="function")return i(d);if(!s||u===0||o<=0)return i;var f=function(g){var v=g.props,w=v.style,b=w===void 0?{}:w,x=v.className,y=P.cloneElement(g,io(io({},l),{},{style:io(io({},b),d),className:x}));return y};return u===1?f(P.Children.only(i)):oe.createElement("div",null,P.Children.map(i,function(h){return f(h)}))}}]),r}(P.PureComponent);bo.displayName="Animate";bo.defaultProps={begin:0,duration:1e3,from:"",to:"",attributeName:"",easing:"ease",isActive:!0,canBegin:!0,steps:[],onAnimationEnd:function(){},onAnimationStart:function(){}};bo.propTypes={from:Jr.oneOfType([Jr.object,Jr.string]),to:Jr.oneOfType([Jr.object,Jr.string]),attributeName:Jr.string,duration:Jr.number,begin:Jr.number,easing:Jr.oneOfType([Jr.string,Jr.func]),steps:Jr.arrayOf(Jr.shape({duration:Jr.number.isRequired,style:Jr.object.isRequired,easing:Jr.oneOfType([Jr.oneOf(["ease","ease-in","ease-out","ease-in-out","linear"]),Jr.func]),properties:Jr.arrayOf("string"),onAnimationEnd:Jr.func})),children:Jr.oneOfType([Jr.node,Jr.func]),isActive:Jr.bool,canBegin:Jr.bool,onAnimationEnd:Jr.func,shouldReAnimate:Jr.bool,onAnimationStart:Jr.func,onAnimationReStart:Jr.func};function v0(e){"@babel/helpers - typeof";return v0=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},v0(e)}function fg(){return fg=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},fg.apply(this,arguments)}function sQ(e,t){return dQ(e)||uQ(e,t)||cQ(e,t)||lQ()}function lQ(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function cQ(e,t){if(e){if(typeof e=="string")return e4(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return e4(e,t)}}function e4(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function uQ(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,a,i,o,s=[],l=!0,u=!1;try{if(i=(r=r.call(e)).next,t!==0)for(;!(l=(n=i.call(r)).done)&&(s.push(n.value),s.length!==t);l=!0);}catch(d){u=!0,a=d}finally{try{if(!l&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(u)throw a}}return s}}function dQ(e){if(Array.isArray(e))return e}function t4(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function r4(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?t4(Object(r),!0).forEach(function(n){fQ(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):t4(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function fQ(e,t,r){return t=hQ(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function hQ(e){var t=pQ(e,"string");return v0(t)=="symbol"?t:t+""}function pQ(e,t){if(v0(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(v0(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var n4=function(t,r,n,a,i){var o=Math.min(Math.abs(n)/2,Math.abs(a)/2),s=a>=0?1:-1,l=n>=0?1:-1,u=a>=0&&n>=0||a<0&&n<0?1:0,d;if(o>0&&i instanceof Array){for(var f=[0,0,0,0],h=0,g=4;h<g;h++)f[h]=i[h]>o?o:i[h];d="M".concat(t,",").concat(r+s*f[0]),f[0]>0&&(d+="A ".concat(f[0],",").concat(f[0],",0,0,").concat(u,",").concat(t+l*f[0],",").concat(r)),d+="L ".concat(t+n-l*f[1],",").concat(r),f[1]>0&&(d+="A ".concat(f[1],",").concat(f[1],",0,0,").concat(u,`,
        `).concat(t+n,",").concat(r+s*f[1])),d+="L ".concat(t+n,",").concat(r+a-s*f[2]),f[2]>0&&(d+="A ".concat(f[2],",").concat(f[2],",0,0,").concat(u,`,
        `).concat(t+n-l*f[2],",").concat(r+a)),d+="L ".concat(t+l*f[3],",").concat(r+a),f[3]>0&&(d+="A ".concat(f[3],",").concat(f[3],",0,0,").concat(u,`,
        `).concat(t,",").concat(r+a-s*f[3])),d+="Z"}else if(o>0&&i===+i&&i>0){var v=Math.min(o,i);d="M ".concat(t,",").concat(r+s*v,`
            A `).concat(v,",").concat(v,",0,0,").concat(u,",").concat(t+l*v,",").concat(r,`
            L `).concat(t+n-l*v,",").concat(r,`
            A `).concat(v,",").concat(v,",0,0,").concat(u,",").concat(t+n,",").concat(r+s*v,`
            L `).concat(t+n,",").concat(r+a-s*v,`
            A `).concat(v,",").concat(v,",0,0,").concat(u,",").concat(t+n-l*v,",").concat(r+a,`
            L `).concat(t+l*v,",").concat(r+a,`
            A `).concat(v,",").concat(v,",0,0,").concat(u,",").concat(t,",").concat(r+a-s*v," Z")}else d="M ".concat(t,",").concat(r," h ").concat(n," v ").concat(a," h ").concat(-n," Z");return d},gQ=function(t,r){if(!t||!r)return!1;var n=t.x,a=t.y,i=r.x,o=r.y,s=r.width,l=r.height;if(Math.abs(s)>0&&Math.abs(l)>0){var u=Math.min(i,i+s),d=Math.max(i,i+s),f=Math.min(o,o+l),h=Math.max(o,o+l);return n>=u&&n<=d&&a>=f&&a<=h}return!1},mQ={x:0,y:0,width:0,height:0,radius:0,isAnimationActive:!1,isUpdateAnimationActive:!1,animationBegin:0,animationDuration:1500,animationEasing:"ease"},rw=function(t){var r=r4(r4({},mQ),t),n=P.useRef(),a=P.useState(-1),i=sQ(a,2),o=i[0],s=i[1];P.useEffect(function(){if(n.current&&n.current.getTotalLength)try{var j=n.current.getTotalLength();j&&s(j)}catch{}},[]);var l=r.x,u=r.y,d=r.width,f=r.height,h=r.radius,g=r.className,v=r.animationEasing,w=r.animationDuration,b=r.animationBegin,x=r.isAnimationActive,y=r.isUpdateAnimationActive;if(l!==+l||u!==+u||d!==+d||f!==+f||d===0||f===0)return null;var _=Nr("recharts-rectangle",g);return y?oe.createElement(bo,{canBegin:o>0,from:{width:d,height:f,x:l,y:u},to:{width:d,height:f,x:l,y:u},duration:w,animationEasing:v,isActive:y},function(j){var S=j.width,k=j.height,M=j.x,N=j.y;return oe.createElement(bo,{canBegin:o>0,from:"0px ".concat(o===-1?1:o,"px"),to:"".concat(o,"px 0px"),attributeName:"strokeDasharray",begin:b,duration:w,isActive:x,easing:v},oe.createElement("path",fg({},er(r,!0),{className:_,d:n4(M,N,S,k,h),ref:n})))}):oe.createElement("path",fg({},er(r,!0),{className:_,d:n4(l,u,d,f,h)}))};function k1(){return k1=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},k1.apply(this,arguments)}var Im=function(t){var r=t.cx,n=t.cy,a=t.r,i=t.className,o=Nr("recharts-dot",i);return r===+r&&n===+n&&a===+a?P.createElement("circle",k1({},er(t,!1),Op(t),{className:o,cx:r,cy:n,r:a})):null};function b0(e){"@babel/helpers - typeof";return b0=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},b0(e)}var yQ=["x","y","top","left","width","height","className"];function S1(){return S1=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},S1.apply(this,arguments)}function a4(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function xQ(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?a4(Object(r),!0).forEach(function(n){vQ(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):a4(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function vQ(e,t,r){return t=bQ(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function bQ(e){var t=wQ(e,"string");return b0(t)=="symbol"?t:t+""}function wQ(e,t){if(b0(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(b0(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function kQ(e,t){if(e==null)return{};var r=SQ(e,t),n,a;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function SQ(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}var _Q=function(t,r,n,a,i,o){return"M".concat(t,",").concat(i,"v").concat(a,"M").concat(o,",").concat(r,"h").concat(n)},jQ=function(t){var r=t.x,n=r===void 0?0:r,a=t.y,i=a===void 0?0:a,o=t.top,s=o===void 0?0:o,l=t.left,u=l===void 0?0:l,d=t.width,f=d===void 0?0:d,h=t.height,g=h===void 0?0:h,v=t.className,w=kQ(t,yQ),b=xQ({x:n,y:i,top:s,left:u,width:f,height:g},w);return!We(n)||!We(i)||!We(f)||!We(g)||!We(s)||!We(u)?null:oe.createElement("path",S1({},er(b,!0),{className:Nr("recharts-cross",v),d:_Q(n,i,f,g,s,u)}))},PQ=ZC,CQ=PQ(Object.getPrototypeOf,Object),MQ=CQ,NQ=ys,OQ=MQ,AQ=xs,EQ="[object Object]",TQ=Function.prototype,IQ=Object.prototype,DN=TQ.toString,RQ=IQ.hasOwnProperty,DQ=DN.call(Object);function $Q(e){if(!AQ(e)||NQ(e)!=EQ)return!1;var t=OQ(e);if(t===null)return!0;var r=RQ.call(t,"constructor")&&t.constructor;return typeof r=="function"&&r instanceof r&&DN.call(r)==DQ}var LQ=$Q;const BQ=dn(LQ);var FQ=ys,UQ=xs,GQ="[object Boolean]";function zQ(e){return e===!0||e===!1||UQ(e)&&FQ(e)==GQ}var WQ=zQ;const VQ=dn(WQ);function w0(e){"@babel/helpers - typeof";return w0=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},w0(e)}function hg(){return hg=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},hg.apply(this,arguments)}function HQ(e,t){return qQ(e)||YQ(e,t)||KQ(e,t)||XQ()}function XQ(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function KQ(e,t){if(e){if(typeof e=="string")return i4(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return i4(e,t)}}function i4(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function YQ(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,a,i,o,s=[],l=!0,u=!1;try{if(i=(r=r.call(e)).next,t!==0)for(;!(l=(n=i.call(r)).done)&&(s.push(n.value),s.length!==t);l=!0);}catch(d){u=!0,a=d}finally{try{if(!l&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(u)throw a}}return s}}function qQ(e){if(Array.isArray(e))return e}function o4(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function s4(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?o4(Object(r),!0).forEach(function(n){ZQ(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):o4(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function ZQ(e,t,r){return t=JQ(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function JQ(e){var t=QQ(e,"string");return w0(t)=="symbol"?t:t+""}function QQ(e,t){if(w0(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(w0(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var l4=function(t,r,n,a,i){var o=n-a,s;return s="M ".concat(t,",").concat(r),s+="L ".concat(t+n,",").concat(r),s+="L ".concat(t+n-o/2,",").concat(r+i),s+="L ".concat(t+n-o/2-a,",").concat(r+i),s+="L ".concat(t,",").concat(r," Z"),s},eee={x:0,y:0,upperWidth:0,lowerWidth:0,height:0,isUpdateAnimationActive:!1,animationBegin:0,animationDuration:1500,animationEasing:"ease"},tee=function(t){var r=s4(s4({},eee),t),n=P.useRef(),a=P.useState(-1),i=HQ(a,2),o=i[0],s=i[1];P.useEffect(function(){if(n.current&&n.current.getTotalLength)try{var _=n.current.getTotalLength();_&&s(_)}catch{}},[]);var l=r.x,u=r.y,d=r.upperWidth,f=r.lowerWidth,h=r.height,g=r.className,v=r.animationEasing,w=r.animationDuration,b=r.animationBegin,x=r.isUpdateAnimationActive;if(l!==+l||u!==+u||d!==+d||f!==+f||h!==+h||d===0&&f===0||h===0)return null;var y=Nr("recharts-trapezoid",g);return x?oe.createElement(bo,{canBegin:o>0,from:{upperWidth:0,lowerWidth:0,height:h,x:l,y:u},to:{upperWidth:d,lowerWidth:f,height:h,x:l,y:u},duration:w,animationEasing:v,isActive:x},function(_){var j=_.upperWidth,S=_.lowerWidth,k=_.height,M=_.x,N=_.y;return oe.createElement(bo,{canBegin:o>0,from:"0px ".concat(o===-1?1:o,"px"),to:"".concat(o,"px 0px"),attributeName:"strokeDasharray",begin:b,duration:w,easing:v},oe.createElement("path",hg({},er(r,!0),{className:y,d:l4(M,N,j,S,k),ref:n})))}):oe.createElement("g",null,oe.createElement("path",hg({},er(r,!0),{className:y,d:l4(l,u,d,f,h)})))},ree=["option","shapeType","propTransformer","activeClassName","isActive"];function k0(e){"@babel/helpers - typeof";return k0=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},k0(e)}function nee(e,t){if(e==null)return{};var r=aee(e,t),n,a;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function aee(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function c4(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function pg(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?c4(Object(r),!0).forEach(function(n){iee(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):c4(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function iee(e,t,r){return t=oee(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function oee(e){var t=see(e,"string");return k0(t)=="symbol"?t:t+""}function see(e,t){if(k0(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(k0(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function lee(e,t){return pg(pg({},t),e)}function cee(e,t){return e==="symbols"}function u4(e){var t=e.shapeType,r=e.elementProps;switch(t){case"rectangle":return oe.createElement(rw,r);case"trapezoid":return oe.createElement(tee,r);case"sector":return oe.createElement(jN,r);case"symbols":if(cee(t))return oe.createElement(wm,r);break;default:return null}}function uee(e){return P.isValidElement(e)?e.props:e}function _1(e){var t=e.option,r=e.shapeType,n=e.propTransformer,a=n===void 0?lee:n,i=e.activeClassName,o=i===void 0?"recharts-active-shape":i,s=e.isActive,l=nee(e,ree),u;if(P.isValidElement(t))u=P.cloneElement(t,pg(pg({},l),uee(t)));else if(ar(t))u=t(l);else if(BQ(t)&&!VQ(t)){var d=a(t,l);u=oe.createElement(u4,{shapeType:r,elementProps:d})}else{var f=l;u=oe.createElement(u4,{shapeType:r,elementProps:f})}return s?oe.createElement(Yr,{className:o},u):u}function Rm(e,t){return t!=null&&"trapezoids"in e.props}function Dm(e,t){return t!=null&&"sectors"in e.props}function S0(e,t){return t!=null&&"points"in e.props}function dee(e,t){var r,n,a=e.x===(t==null||(r=t.labelViewBox)===null||r===void 0?void 0:r.x)||e.x===t.x,i=e.y===(t==null||(n=t.labelViewBox)===null||n===void 0?void 0:n.y)||e.y===t.y;return a&&i}function fee(e,t){var r=e.endAngle===t.endAngle,n=e.startAngle===t.startAngle;return r&&n}function hee(e,t){var r=e.x===t.x,n=e.y===t.y,a=e.z===t.z;return r&&n&&a}function pee(e,t){var r;return Rm(e,t)?r=dee:Dm(e,t)?r=fee:S0(e,t)&&(r=hee),r}function gee(e,t){var r;return Rm(e,t)?r="trapezoids":Dm(e,t)?r="sectors":S0(e,t)&&(r="points"),r}function mee(e,t){if(Rm(e,t)){var r;return(r=t.tooltipPayload)===null||r===void 0||(r=r[0])===null||r===void 0||(r=r.payload)===null||r===void 0?void 0:r.payload}if(Dm(e,t)){var n;return(n=t.tooltipPayload)===null||n===void 0||(n=n[0])===null||n===void 0||(n=n.payload)===null||n===void 0?void 0:n.payload}return S0(e,t)?t.payload:{}}function yee(e){var t=e.activeTooltipItem,r=e.graphicalItem,n=e.itemData,a=gee(r,t),i=mee(r,t),o=n.filter(function(l,u){var d=gc(i,l),f=r.props[a].filter(function(v){var w=pee(r,t);return w(v,t)}),h=r.props[a].indexOf(f[f.length-1]),g=u===h;return d&&g}),s=n.indexOf(o[o.length-1]);return s}var xee=Math.ceil,vee=Math.max;function bee(e,t,r,n){for(var a=-1,i=vee(xee((t-e)/(r||1)),0),o=Array(i);i--;)o[n?i:++a]=e,e+=r;return o}var wee=bee,kee=mM,d4=1/0,See=17976931348623157e292;function _ee(e){if(!e)return e===0?e:0;if(e=kee(e),e===d4||e===-d4){var t=e<0?-1:1;return t*See}return e===e?e:0}var $N=_ee,jee=wee,Pee=_m,lx=$N;function Cee(e){return function(t,r,n){return n&&typeof n!="number"&&Pee(t,r,n)&&(r=n=void 0),t=lx(t),r===void 0?(r=t,t=0):r=lx(r),n=n===void 0?t<r?1:-1:lx(n),jee(t,r,n,e)}}var Mee=Cee,Nee=Mee,Oee=Nee(),Aee=Oee;const gg=dn(Aee);function _0(e){"@babel/helpers - typeof";return _0=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_0(e)}function f4(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function h4(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?f4(Object(r),!0).forEach(function(n){LN(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):f4(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function LN(e,t,r){return t=Eee(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Eee(e){var t=Tee(e,"string");return _0(t)=="symbol"?t:t+""}function Tee(e,t){if(_0(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(_0(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Iee=["Webkit","Moz","O","ms"],Ree=function(t,r){var n=t.replace(/(\w)/,function(i){return i.toUpperCase()}),a=Iee.reduce(function(i,o){return h4(h4({},i),{},LN({},o+n,r))},{});return a[t]=r,a};function Lu(e){"@babel/helpers - typeof";return Lu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Lu(e)}function mg(){return mg=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},mg.apply(this,arguments)}function p4(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function cx(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?p4(Object(r),!0).forEach(function(n){wi(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):p4(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Dee(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function g4(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,FN(n.key),n)}}function $ee(e,t,r){return t&&g4(e.prototype,t),r&&g4(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Lee(e,t,r){return t=yg(t),Bee(e,BN()?Reflect.construct(t,r||[],yg(e).constructor):t.apply(e,r))}function Bee(e,t){if(t&&(Lu(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Fee(e)}function Fee(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function BN(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(BN=function(){return!!e})()}function yg(e){return yg=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},yg(e)}function Uee(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&j1(e,t)}function j1(e,t){return j1=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},j1(e,t)}function wi(e,t,r){return t=FN(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function FN(e){var t=Gee(e,"string");return Lu(t)=="symbol"?t:t+""}function Gee(e,t){if(Lu(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(Lu(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var zee=function(t){var r=t.data,n=t.startIndex,a=t.endIndex,i=t.x,o=t.width,s=t.travellerWidth;if(!r||!r.length)return{};var l=r.length,u=Sf().domain(gg(0,l)).range([i,i+o-s]),d=u.domain().map(function(f){return u(f)});return{isTextActive:!1,isSlideMoving:!1,isTravellerMoving:!1,isTravellerFocused:!1,startX:u(n),endX:u(a),scale:u,scaleValues:d}},m4=function(t){return t.changedTouches&&!!t.changedTouches.length},Bu=function(e){function t(r){var n;return Dee(this,t),n=Lee(this,t,[r]),wi(n,"handleDrag",function(a){n.leaveTimer&&(clearTimeout(n.leaveTimer),n.leaveTimer=null),n.state.isTravellerMoving?n.handleTravellerMove(a):n.state.isSlideMoving&&n.handleSlideDrag(a)}),wi(n,"handleTouchMove",function(a){a.changedTouches!=null&&a.changedTouches.length>0&&n.handleDrag(a.changedTouches[0])}),wi(n,"handleDragEnd",function(){n.setState({isTravellerMoving:!1,isSlideMoving:!1},function(){var a=n.props,i=a.endIndex,o=a.onDragEnd,s=a.startIndex;o==null||o({endIndex:i,startIndex:s})}),n.detachDragEndListener()}),wi(n,"handleLeaveWrapper",function(){(n.state.isTravellerMoving||n.state.isSlideMoving)&&(n.leaveTimer=window.setTimeout(n.handleDragEnd,n.props.leaveTimeOut))}),wi(n,"handleEnterSlideOrTraveller",function(){n.setState({isTextActive:!0})}),wi(n,"handleLeaveSlideOrTraveller",function(){n.setState({isTextActive:!1})}),wi(n,"handleSlideDragStart",function(a){var i=m4(a)?a.changedTouches[0]:a;n.setState({isTravellerMoving:!1,isSlideMoving:!0,slideMoveStartX:i.pageX}),n.attachDragEndListener()}),n.travellerDragStartHandlers={startX:n.handleTravellerDragStart.bind(n,"startX"),endX:n.handleTravellerDragStart.bind(n,"endX")},n.state={},n}return Uee(t,e),$ee(t,[{key:"componentWillUnmount",value:function(){this.leaveTimer&&(clearTimeout(this.leaveTimer),this.leaveTimer=null),this.detachDragEndListener()}},{key:"getIndex",value:function(n){var a=n.startX,i=n.endX,o=this.state.scaleValues,s=this.props,l=s.gap,u=s.data,d=u.length-1,f=Math.min(a,i),h=Math.max(a,i),g=t.getIndexInRange(o,f),v=t.getIndexInRange(o,h);return{startIndex:g-g%l,endIndex:v===d?d:v-v%l}}},{key:"getTextOfTick",value:function(n){var a=this.props,i=a.data,o=a.tickFormatter,s=a.dataKey,l=la(i[n],s,n);return ar(o)?o(l,n):l}},{key:"attachDragEndListener",value:function(){window.addEventListener("mouseup",this.handleDragEnd,!0),window.addEventListener("touchend",this.handleDragEnd,!0),window.addEventListener("mousemove",this.handleDrag,!0)}},{key:"detachDragEndListener",value:function(){window.removeEventListener("mouseup",this.handleDragEnd,!0),window.removeEventListener("touchend",this.handleDragEnd,!0),window.removeEventListener("mousemove",this.handleDrag,!0)}},{key:"handleSlideDrag",value:function(n){var a=this.state,i=a.slideMoveStartX,o=a.startX,s=a.endX,l=this.props,u=l.x,d=l.width,f=l.travellerWidth,h=l.startIndex,g=l.endIndex,v=l.onChange,w=n.pageX-i;w>0?w=Math.min(w,u+d-f-s,u+d-f-o):w<0&&(w=Math.max(w,u-o,u-s));var b=this.getIndex({startX:o+w,endX:s+w});(b.startIndex!==h||b.endIndex!==g)&&v&&v(b),this.setState({startX:o+w,endX:s+w,slideMoveStartX:n.pageX})}},{key:"handleTravellerDragStart",value:function(n,a){var i=m4(a)?a.changedTouches[0]:a;this.setState({isSlideMoving:!1,isTravellerMoving:!0,movingTravellerId:n,brushMoveStartX:i.pageX}),this.attachDragEndListener()}},{key:"handleTravellerMove",value:function(n){var a=this.state,i=a.brushMoveStartX,o=a.movingTravellerId,s=a.endX,l=a.startX,u=this.state[o],d=this.props,f=d.x,h=d.width,g=d.travellerWidth,v=d.onChange,w=d.gap,b=d.data,x={startX:this.state.startX,endX:this.state.endX},y=n.pageX-i;y>0?y=Math.min(y,f+h-g-u):y<0&&(y=Math.max(y,f-u)),x[o]=u+y;var _=this.getIndex(x),j=_.startIndex,S=_.endIndex,k=function(){var N=b.length-1;return o==="startX"&&(s>l?j%w===0:S%w===0)||s<l&&S===N||o==="endX"&&(s>l?S%w===0:j%w===0)||s>l&&S===N};this.setState(wi(wi({},o,u+y),"brushMoveStartX",n.pageX),function(){v&&k()&&v(_)})}},{key:"handleTravellerMoveKeyboard",value:function(n,a){var i=this,o=this.state,s=o.scaleValues,l=o.startX,u=o.endX,d=this.state[a],f=s.indexOf(d);if(f!==-1){var h=f+n;if(!(h===-1||h>=s.length)){var g=s[h];a==="startX"&&g>=u||a==="endX"&&g<=l||this.setState(wi({},a,g),function(){i.props.onChange(i.getIndex({startX:i.state.startX,endX:i.state.endX}))})}}}},{key:"renderBackground",value:function(){var n=this.props,a=n.x,i=n.y,o=n.width,s=n.height,l=n.fill,u=n.stroke;return oe.createElement("rect",{stroke:u,fill:l,x:a,y:i,width:o,height:s})}},{key:"renderPanorama",value:function(){var n=this.props,a=n.x,i=n.y,o=n.width,s=n.height,l=n.data,u=n.children,d=n.padding,f=P.Children.only(u);return f?oe.cloneElement(f,{x:a,y:i,width:o,height:s,margin:d,compact:!0,data:l}):null}},{key:"renderTravellerLayer",value:function(n,a){var i,o,s=this,l=this.props,u=l.y,d=l.travellerWidth,f=l.height,h=l.traveller,g=l.ariaLabel,v=l.data,w=l.startIndex,b=l.endIndex,x=Math.max(n,this.props.x),y=cx(cx({},er(this.props,!1)),{},{x,y:u,width:d,height:f}),_=g||"Min value: ".concat((i=v[w])===null||i===void 0?void 0:i.name,", Max value: ").concat((o=v[b])===null||o===void 0?void 0:o.name);return oe.createElement(Yr,{tabIndex:0,role:"slider","aria-label":_,"aria-valuenow":n,className:"recharts-brush-traveller",onMouseEnter:this.handleEnterSlideOrTraveller,onMouseLeave:this.handleLeaveSlideOrTraveller,onMouseDown:this.travellerDragStartHandlers[a],onTouchStart:this.travellerDragStartHandlers[a],onKeyDown:function(S){["ArrowLeft","ArrowRight"].includes(S.key)&&(S.preventDefault(),S.stopPropagation(),s.handleTravellerMoveKeyboard(S.key==="ArrowRight"?1:-1,a))},onFocus:function(){s.setState({isTravellerFocused:!0})},onBlur:function(){s.setState({isTravellerFocused:!1})},style:{cursor:"col-resize"}},t.renderTraveller(h,y))}},{key:"renderSlide",value:function(n,a){var i=this.props,o=i.y,s=i.height,l=i.stroke,u=i.travellerWidth,d=Math.min(n,a)+u,f=Math.max(Math.abs(a-n)-u,0);return oe.createElement("rect",{className:"recharts-brush-slide",onMouseEnter:this.handleEnterSlideOrTraveller,onMouseLeave:this.handleLeaveSlideOrTraveller,onMouseDown:this.handleSlideDragStart,onTouchStart:this.handleSlideDragStart,style:{cursor:"move"},stroke:"none",fill:l,fillOpacity:.2,x:d,y:o,width:f,height:s})}},{key:"renderText",value:function(){var n=this.props,a=n.startIndex,i=n.endIndex,o=n.y,s=n.height,l=n.travellerWidth,u=n.stroke,d=this.state,f=d.startX,h=d.endX,g=5,v={pointerEvents:"none",fill:u};return oe.createElement(Yr,{className:"recharts-brush-texts"},oe.createElement(Wp,mg({textAnchor:"end",verticalAnchor:"middle",x:Math.min(f,h)-g,y:o+s/2},v),this.getTextOfTick(a)),oe.createElement(Wp,mg({textAnchor:"start",verticalAnchor:"middle",x:Math.max(f,h)+l+g,y:o+s/2},v),this.getTextOfTick(i)))}},{key:"render",value:function(){var n=this.props,a=n.data,i=n.className,o=n.children,s=n.x,l=n.y,u=n.width,d=n.height,f=n.alwaysShowText,h=this.state,g=h.startX,v=h.endX,w=h.isTextActive,b=h.isSlideMoving,x=h.isTravellerMoving,y=h.isTravellerFocused;if(!a||!a.length||!We(s)||!We(l)||!We(u)||!We(d)||u<=0||d<=0)return null;var _=Nr("recharts-brush",i),j=oe.Children.count(o)===1,S=Ree("userSelect","none");return oe.createElement(Yr,{className:_,onMouseLeave:this.handleLeaveWrapper,onTouchMove:this.handleTouchMove,style:S},this.renderBackground(),j&&this.renderPanorama(),this.renderSlide(g,v),this.renderTravellerLayer(g,"startX"),this.renderTravellerLayer(v,"endX"),(w||b||x||y||f)&&this.renderText())}}],[{key:"renderDefaultTraveller",value:function(n){var a=n.x,i=n.y,o=n.width,s=n.height,l=n.stroke,u=Math.floor(i+s/2)-1;return oe.createElement(oe.Fragment,null,oe.createElement("rect",{x:a,y:i,width:o,height:s,fill:l,stroke:"none"}),oe.createElement("line",{x1:a+1,y1:u,x2:a+o-1,y2:u,fill:"none",stroke:"#fff"}),oe.createElement("line",{x1:a+1,y1:u+2,x2:a+o-1,y2:u+2,fill:"none",stroke:"#fff"}))}},{key:"renderTraveller",value:function(n,a){var i;return oe.isValidElement(n)?i=oe.cloneElement(n,a):ar(n)?i=n(a):i=t.renderDefaultTraveller(a),i}},{key:"getDerivedStateFromProps",value:function(n,a){var i=n.data,o=n.width,s=n.x,l=n.travellerWidth,u=n.updateId,d=n.startIndex,f=n.endIndex;if(i!==a.prevData||u!==a.prevUpdateId)return cx({prevData:i,prevTravellerWidth:l,prevUpdateId:u,prevX:s,prevWidth:o},i&&i.length?zee({data:i,width:o,x:s,travellerWidth:l,startIndex:d,endIndex:f}):{scale:null,scaleValues:null});if(a.scale&&(o!==a.prevWidth||s!==a.prevX||l!==a.prevTravellerWidth)){a.scale.range([s,s+o-l]);var h=a.scale.domain().map(function(g){return a.scale(g)});return{prevData:i,prevTravellerWidth:l,prevUpdateId:u,prevX:s,prevWidth:o,startX:a.scale(n.startIndex),endX:a.scale(n.endIndex),scaleValues:h}}return null}},{key:"getIndexInRange",value:function(n,a){for(var i=n.length,o=0,s=i-1;s-o>1;){var l=Math.floor((o+s)/2);n[l]>a?s=l:o=l}return a>=n[s]?s:o}}])}(P.PureComponent);wi(Bu,"displayName","Brush");wi(Bu,"defaultProps",{height:40,travellerWidth:5,gap:1,fill:"#fff",stroke:"#666",padding:{top:1,right:1,bottom:1,left:1},leaveTimeOut:1e3,alwaysShowText:!1});var Wee=C2;function Vee(e,t){var r;return Wee(e,function(n,a,i){return r=t(n,a,i),!r}),!!r}var Hee=Vee,Xee=zC,Kee=kl,Yee=Hee,qee=gi,Zee=_m;function Jee(e,t,r){var n=qee(e)?Xee:Yee;return r&&Zee(e,t,r)&&(t=void 0),n(e,Kee(t))}var Qee=Jee;const ete=dn(Qee);var Bo=function(t,r){var n=t.alwaysShow,a=t.ifOverflow;return n&&(a="extendDomain"),a===r},y4=dM;function tte(e,t,r){t=="__proto__"&&y4?y4(e,t,{configurable:!0,enumerable:!0,value:r,writable:!0}):e[t]=r}var rte=tte,nte=rte,ate=cM,ite=kl;function ote(e,t){var r={};return t=ite(t),ate(e,function(n,a,i){nte(r,a,t(n,a,i))}),r}var ste=ote;const lte=dn(ste);function cte(e,t){for(var r=-1,n=e==null?0:e.length;++r<n;)if(!t(e[r],r,e))return!1;return!0}var ute=cte,dte=C2;function fte(e,t){var r=!0;return dte(e,function(n,a,i){return r=!!t(n,a,i),r}),r}var hte=fte,pte=ute,gte=hte,mte=kl,yte=gi,xte=_m;function vte(e,t,r){var n=yte(e)?pte:gte;return r&&xte(e,t,r)&&(t=void 0),n(e,mte(t))}var bte=vte;const UN=dn(bte);var wte=["x","y"];function j0(e){"@babel/helpers - typeof";return j0=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},j0(e)}function P1(){return P1=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},P1.apply(this,arguments)}function x4(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function nf(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?x4(Object(r),!0).forEach(function(n){kte(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):x4(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function kte(e,t,r){return t=Ste(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Ste(e){var t=_te(e,"string");return j0(t)=="symbol"?t:t+""}function _te(e,t){if(j0(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(j0(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function jte(e,t){if(e==null)return{};var r=Pte(e,t),n,a;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function Pte(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function Cte(e,t){var r=e.x,n=e.y,a=jte(e,wte),i="".concat(r),o=parseInt(i,10),s="".concat(n),l=parseInt(s,10),u="".concat(t.height||a.height),d=parseInt(u,10),f="".concat(t.width||a.width),h=parseInt(f,10);return nf(nf(nf(nf(nf({},t),a),o?{x:o}:{}),l?{y:l}:{}),{},{height:d,width:h,name:t.name,radius:t.radius})}function v4(e){return oe.createElement(_1,P1({shapeType:"rectangle",propTransformer:Cte,activeClassName:"recharts-active-bar"},e))}var Mte=function(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return function(n,a){if(typeof t=="number")return t;var i=We(n)||GD(n);return i?t(n,a):(i||yc(),r)}},Nte=["value","background"],GN;function Fu(e){"@babel/helpers - typeof";return Fu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Fu(e)}function Ote(e,t){if(e==null)return{};var r=Ate(e,t),n,a;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function Ate(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function xg(){return xg=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},xg.apply(this,arguments)}function b4(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Vn(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?b4(Object(r),!0).forEach(function(n){el(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):b4(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Ete(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function w4(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,WN(n.key),n)}}function Tte(e,t,r){return t&&w4(e.prototype,t),r&&w4(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Ite(e,t,r){return t=vg(t),Rte(e,zN()?Reflect.construct(t,r||[],vg(e).constructor):t.apply(e,r))}function Rte(e,t){if(t&&(Fu(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Dte(e)}function Dte(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function zN(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(zN=function(){return!!e})()}function vg(e){return vg=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},vg(e)}function $te(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&C1(e,t)}function C1(e,t){return C1=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},C1(e,t)}function el(e,t,r){return t=WN(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function WN(e){var t=Lte(e,"string");return Fu(t)=="symbol"?t:t+""}function Lte(e,t){if(Fu(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(Fu(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var U0=function(e){function t(){var r;Ete(this,t);for(var n=arguments.length,a=new Array(n),i=0;i<n;i++)a[i]=arguments[i];return r=Ite(this,t,[].concat(a)),el(r,"state",{isAnimationFinished:!1}),el(r,"id",Sc("recharts-bar-")),el(r,"handleAnimationEnd",function(){var o=r.props.onAnimationEnd;r.setState({isAnimationFinished:!0}),o&&o()}),el(r,"handleAnimationStart",function(){var o=r.props.onAnimationStart;r.setState({isAnimationFinished:!1}),o&&o()}),r}return $te(t,e),Tte(t,[{key:"renderRectanglesStatically",value:function(n){var a=this,i=this.props,o=i.shape,s=i.dataKey,l=i.activeIndex,u=i.activeBar,d=er(this.props,!1);return n&&n.map(function(f,h){var g=h===l,v=g?u:o,w=Vn(Vn(Vn({},d),f),{},{isActive:g,option:v,index:h,dataKey:s,onAnimationStart:a.handleAnimationStart,onAnimationEnd:a.handleAnimationEnd});return oe.createElement(Yr,xg({className:"recharts-bar-rectangle"},Kf(a.props,f,h),{key:"rectangle-".concat(f==null?void 0:f.x,"-").concat(f==null?void 0:f.y,"-").concat(f==null?void 0:f.value,"-").concat(h)}),oe.createElement(v4,w))})}},{key:"renderRectanglesWithAnimation",value:function(){var n=this,a=this.props,i=a.data,o=a.layout,s=a.isAnimationActive,l=a.animationBegin,u=a.animationDuration,d=a.animationEasing,f=a.animationId,h=this.state.prevData;return oe.createElement(bo,{begin:l,duration:u,isActive:s,easing:d,from:{t:0},to:{t:1},key:"bar-".concat(f),onAnimationEnd:this.handleAnimationEnd,onAnimationStart:this.handleAnimationStart},function(g){var v=g.t,w=i.map(function(b,x){var y=h&&h[x];if(y){var _=Un(y.x,b.x),j=Un(y.y,b.y),S=Un(y.width,b.width),k=Un(y.height,b.height);return Vn(Vn({},b),{},{x:_(v),y:j(v),width:S(v),height:k(v)})}if(o==="horizontal"){var M=Un(0,b.height),N=M(v);return Vn(Vn({},b),{},{y:b.y+b.height-N,height:N})}var T=Un(0,b.width),A=T(v);return Vn(Vn({},b),{},{width:A})});return oe.createElement(Yr,null,n.renderRectanglesStatically(w))})}},{key:"renderRectangles",value:function(){var n=this.props,a=n.data,i=n.isAnimationActive,o=this.state.prevData;return i&&a&&a.length&&(!o||!gc(o,a))?this.renderRectanglesWithAnimation():this.renderRectanglesStatically(a)}},{key:"renderBackground",value:function(){var n=this,a=this.props,i=a.data,o=a.dataKey,s=a.activeIndex,l=er(this.props.background,!1);return i.map(function(u,d){u.value;var f=u.background,h=Ote(u,Nte);if(!f)return null;var g=Vn(Vn(Vn(Vn(Vn({},h),{},{fill:"#eee"},f),l),Kf(n.props,u,d)),{},{onAnimationStart:n.handleAnimationStart,onAnimationEnd:n.handleAnimationEnd,dataKey:o,index:d,className:"recharts-bar-background-rectangle"});return oe.createElement(v4,xg({key:"background-bar-".concat(d),option:n.props.background,isActive:d===s},g))})}},{key:"renderErrorBar",value:function(n,a){if(this.props.isAnimationActive&&!this.state.isAnimationFinished)return null;var i=this.props,o=i.data,s=i.xAxis,l=i.yAxis,u=i.layout,d=i.children,f=pi(d,yd);if(!f)return null;var h=u==="vertical"?o[0].height/2:o[0].width/2,g=function(b,x){var y=Array.isArray(b.value)?b.value[1]:b.value;return{x:b.x,y:b.y,value:y,errorVal:la(b,x)}},v={clipPath:n?"url(#clipPath-".concat(a,")"):null};return oe.createElement(Yr,v,f.map(function(w){return oe.cloneElement(w,{key:"error-bar-".concat(a,"-").concat(w.props.dataKey),data:o,xAxis:s,yAxis:l,layout:u,offset:h,dataPointFormatter:g})}))}},{key:"render",value:function(){var n=this.props,a=n.hide,i=n.data,o=n.className,s=n.xAxis,l=n.yAxis,u=n.left,d=n.top,f=n.width,h=n.height,g=n.isAnimationActive,v=n.background,w=n.id;if(a||!i||!i.length)return null;var b=this.state.isAnimationFinished,x=Nr("recharts-bar",o),y=s&&s.allowDataOverflow,_=l&&l.allowDataOverflow,j=y||_,S=qt(w)?this.id:w;return oe.createElement(Yr,{className:x},y||_?oe.createElement("defs",null,oe.createElement("clipPath",{id:"clipPath-".concat(S)},oe.createElement("rect",{x:y?u:u-f/2,y:_?d:d-h/2,width:y?f:f*2,height:_?h:h*2}))):null,oe.createElement(Yr,{className:"recharts-bar-rectangles",clipPath:j?"url(#clipPath-".concat(S,")"):null},v?this.renderBackground():null,this.renderRectangles()),this.renderErrorBar(j,S),(!g||b)&&Lo.renderCallByParent(this.props,i))}}],[{key:"getDerivedStateFromProps",value:function(n,a){return n.animationId!==a.prevAnimationId?{prevAnimationId:n.animationId,curData:n.data,prevData:a.curData}:n.data!==a.curData?{curData:n.data}:null}}])}(P.PureComponent);GN=U0;el(U0,"displayName","Bar");el(U0,"defaultProps",{xAxisId:0,yAxisId:0,legendType:"rect",minPointSize:0,hide:!1,data:[],layout:"vertical",activeBar:!1,isAnimationActive:!Sl.isSsr,animationBegin:0,animationDuration:400,animationEasing:"ease"});el(U0,"getComposedData",function(e){var t=e.props,r=e.item,n=e.barPosition,a=e.bandSize,i=e.xAxis,o=e.yAxis,s=e.xAxisTicks,l=e.yAxisTicks,u=e.stackedData,d=e.dataStartIndex,f=e.displayedData,h=e.offset,g=dq(n,r);if(!g)return null;var v=t.layout,w=r.type.defaultProps,b=w!==void 0?Vn(Vn({},w),r.props):r.props,x=b.dataKey,y=b.children,_=b.minPointSize,j=v==="horizontal"?o:i,S=u?j.scale.domain():null,k=vq({numericAxis:j}),M=pi(y,O2),N=f.map(function(T,A){var D,$,B,J,W,I;u?D=fq(u[d+A],S):(D=la(T,x),Array.isArray(D)||(D=[k,D]));var G=Mte(_,GN.defaultProps.minPointSize)(D[1],A);if(v==="horizontal"){var U,X=[o.scale(D[0]),o.scale(D[1])],V=X[0],z=X[1];$=S5({axis:i,ticks:s,bandSize:a,offset:g.offset,entry:T,index:A}),B=(U=z??V)!==null&&U!==void 0?U:void 0,J=g.size;var q=V-z;if(W=Number.isNaN(q)?0:q,I={x:$,y:o.y,width:J,height:o.height},Math.abs(G)>0&&Math.abs(W)<Math.abs(G)){var te=go(W||G)*(Math.abs(G)-Math.abs(W));B-=te,W+=te}}else{var ie=[i.scale(D[0]),i.scale(D[1])],he=ie[0],ee=ie[1];if($=he,B=S5({axis:o,ticks:l,bandSize:a,offset:g.offset,entry:T,index:A}),J=ee-he,W=g.size,I={x:i.x,y:B,width:i.width,height:W},Math.abs(G)>0&&Math.abs(J)<Math.abs(G)){var Le=go(J||G)*(Math.abs(G)-Math.abs(J));J+=Le}}return Vn(Vn(Vn({},T),{},{x:$,y:B,width:J,height:W,value:u?D:D[1],payload:T,background:I},M&&M[A]&&M[A].props),{},{tooltipPayload:[kN(r,T)],tooltipPosition:{x:$+J/2,y:B+W/2}})});return Vn({data:N,layout:v},h)});function P0(e){"@babel/helpers - typeof";return P0=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},P0(e)}function Bte(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function k4(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,VN(n.key),n)}}function Fte(e,t,r){return t&&k4(e.prototype,t),r&&k4(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function S4(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function co(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?S4(Object(r),!0).forEach(function(n){$m(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):S4(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function $m(e,t,r){return t=VN(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function VN(e){var t=Ute(e,"string");return P0(t)=="symbol"?t:t+""}function Ute(e,t){if(P0(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(P0(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var nw=function(t,r,n,a,i){var o=t.width,s=t.height,l=t.layout,u=t.children,d=Object.keys(r),f={left:n.left,leftMirror:n.left,right:o-n.right,rightMirror:o-n.right,top:n.top,topMirror:n.top,bottom:s-n.bottom,bottomMirror:s-n.bottom},h=!!Si(u,U0);return d.reduce(function(g,v){var w=r[v],b=w.orientation,x=w.domain,y=w.padding,_=y===void 0?{}:y,j=w.mirror,S=w.reversed,k="".concat(b).concat(j?"Mirror":""),M,N,T,A,D;if(w.type==="number"&&(w.padding==="gap"||w.padding==="no-gap")){var $=x[1]-x[0],B=1/0,J=w.categoricalDomain.sort(HD);if(J.forEach(function(ie,he){he>0&&(B=Math.min((ie||0)-(J[he-1]||0),B))}),Number.isFinite(B)){var W=B/$,I=w.layout==="vertical"?n.height:n.width;if(w.padding==="gap"&&(M=W*I/2),w.padding==="no-gap"){var G=pc(t.barCategoryGap,W*I),U=W*I/2;M=U-G-(U-G)/I*G}}}a==="xAxis"?N=[n.left+(_.left||0)+(M||0),n.left+n.width-(_.right||0)-(M||0)]:a==="yAxis"?N=l==="horizontal"?[n.top+n.height-(_.bottom||0),n.top+(_.top||0)]:[n.top+(_.top||0)+(M||0),n.top+n.height-(_.bottom||0)-(M||0)]:N=w.range,S&&(N=[N[1],N[0]]);var X=cq(w,i,h),V=X.scale,z=X.realScaleType;V.domain(x).range(N),uq(V);var q=xq(V,co(co({},w),{},{realScaleType:z}));a==="xAxis"?(D=b==="top"&&!j||b==="bottom"&&j,T=n.left,A=f[k]-D*w.height):a==="yAxis"&&(D=b==="left"&&!j||b==="right"&&j,T=f[k]-D*w.width,A=n.top);var te=co(co(co({},w),q),{},{realScaleType:z,x:T,y:A,scale:V,width:a==="xAxis"?n.width:w.width,height:a==="yAxis"?n.height:w.height});return te.bandSize=ig(te,q),!w.hide&&a==="xAxis"?f[k]+=(D?-1:1)*te.height:w.hide||(f[k]+=(D?-1:1)*te.width),co(co({},g),{},$m({},v,te))},{})},HN=function(t,r){var n=t.x,a=t.y,i=r.x,o=r.y;return{x:Math.min(n,i),y:Math.min(a,o),width:Math.abs(i-n),height:Math.abs(o-a)}},Gte=function(t){var r=t.x1,n=t.y1,a=t.x2,i=t.y2;return HN({x:r,y:n},{x:a,y:i})},XN=function(){function e(t){Bte(this,e),this.scale=t}return Fte(e,[{key:"domain",get:function(){return this.scale.domain}},{key:"range",get:function(){return this.scale.range}},{key:"rangeMin",get:function(){return this.range()[0]}},{key:"rangeMax",get:function(){return this.range()[1]}},{key:"bandwidth",get:function(){return this.scale.bandwidth}},{key:"apply",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},a=n.bandAware,i=n.position;if(r!==void 0){if(i)switch(i){case"start":return this.scale(r);case"middle":{var o=this.bandwidth?this.bandwidth()/2:0;return this.scale(r)+o}case"end":{var s=this.bandwidth?this.bandwidth():0;return this.scale(r)+s}default:return this.scale(r)}if(a){var l=this.bandwidth?this.bandwidth()/2:0;return this.scale(r)+l}return this.scale(r)}}},{key:"isInRange",value:function(r){var n=this.range(),a=n[0],i=n[n.length-1];return a<=i?r>=a&&r<=i:r>=i&&r<=a}}],[{key:"create",value:function(r){return new e(r)}}])}();$m(XN,"EPS",1e-4);var aw=function(t){var r=Object.keys(t).reduce(function(n,a){return co(co({},n),{},$m({},a,XN.create(t[a])))},{});return co(co({},r),{},{apply:function(a){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},o=i.bandAware,s=i.position;return lte(a,function(l,u){return r[u].apply(l,{bandAware:o,position:s})})},isInRange:function(a){return UN(a,function(i,o){return r[o].isInRange(i)})}})};function zte(e){return(e%180+180)%180}var Wte=function(t){var r=t.width,n=t.height,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,i=zte(a),o=i*Math.PI/180,s=Math.atan(n/r),l=o>s&&o<Math.PI-s?n/Math.sin(o):r/Math.cos(o);return Math.abs(l)},Vte=kl,Hte=D0,Xte=km;function Kte(e){return function(t,r,n){var a=Object(t);if(!Hte(t)){var i=Vte(r);t=Xte(t),r=function(s){return i(a[s],s,a)}}var o=e(t,r,n);return o>-1?a[i?t[o]:o]:void 0}}var Yte=Kte,qte=$N;function Zte(e){var t=qte(e),r=t%1;return t===t?r?t-r:t:0}var Jte=Zte,Qte=nM,ere=kl,tre=Jte,rre=Math.max;function nre(e,t,r){var n=e==null?0:e.length;if(!n)return-1;var a=r==null?0:tre(r);return a<0&&(a=rre(n+a,0)),Qte(e,ere(t),a)}var are=nre,ire=Yte,ore=are,sre=ire(ore),lre=sre;const cre=dn(lre);var ure=KR(function(e){return{x:e.left,y:e.top,width:e.width,height:e.height}},function(e){return["l",e.left,"t",e.top,"w",e.width,"h",e.height].join("")}),iw=P.createContext(void 0),ow=P.createContext(void 0),KN=P.createContext(void 0),YN=P.createContext({}),qN=P.createContext(void 0),ZN=P.createContext(0),JN=P.createContext(0),_4=function(t){var r=t.state,n=r.xAxisMap,a=r.yAxisMap,i=r.offset,o=t.clipPathId,s=t.children,l=t.width,u=t.height,d=ure(i);return oe.createElement(iw.Provider,{value:n},oe.createElement(ow.Provider,{value:a},oe.createElement(YN.Provider,{value:i},oe.createElement(KN.Provider,{value:d},oe.createElement(qN.Provider,{value:o},oe.createElement(ZN.Provider,{value:u},oe.createElement(JN.Provider,{value:l},s)))))))},dre=function(){return P.useContext(qN)},QN=function(t){var r=P.useContext(iw);r==null&&yc();var n=r[t];return n==null&&yc(),n},fre=function(){var t=P.useContext(iw);return Vs(t)},hre=function(){var t=P.useContext(ow),r=cre(t,function(n){return UN(n.domain,Number.isFinite)});return r||Vs(t)},eO=function(t){var r=P.useContext(ow);r==null&&yc();var n=r[t];return n==null&&yc(),n},pre=function(){var t=P.useContext(KN);return t},gre=function(){return P.useContext(YN)},sw=function(){return P.useContext(JN)},lw=function(){return P.useContext(ZN)};function Uu(e){"@babel/helpers - typeof";return Uu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Uu(e)}function mre(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function yre(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,rO(n.key),n)}}function xre(e,t,r){return t&&yre(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function vre(e,t,r){return t=bg(t),bre(e,tO()?Reflect.construct(t,r||[],bg(e).constructor):t.apply(e,r))}function bre(e,t){if(t&&(Uu(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return wre(e)}function wre(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function tO(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(tO=function(){return!!e})()}function bg(e){return bg=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},bg(e)}function kre(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&M1(e,t)}function M1(e,t){return M1=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},M1(e,t)}function j4(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function P4(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?j4(Object(r),!0).forEach(function(n){cw(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):j4(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function cw(e,t,r){return t=rO(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function rO(e){var t=Sre(e,"string");return Uu(t)=="symbol"?t:t+""}function Sre(e,t){if(Uu(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(Uu(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}function _re(e,t){return Mre(e)||Cre(e,t)||Pre(e,t)||jre()}function jre(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Pre(e,t){if(e){if(typeof e=="string")return C4(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return C4(e,t)}}function C4(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Cre(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,a,i,o,s=[],l=!0,u=!1;try{if(i=(r=r.call(e)).next,t!==0)for(;!(l=(n=i.call(r)).done)&&(s.push(n.value),s.length!==t);l=!0);}catch(d){u=!0,a=d}finally{try{if(!l&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(u)throw a}}return s}}function Mre(e){if(Array.isArray(e))return e}function N1(){return N1=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},N1.apply(this,arguments)}var Nre=function(t,r){var n;return oe.isValidElement(t)?n=oe.cloneElement(t,r):ar(t)?n=t(r):n=oe.createElement("line",N1({},r,{className:"recharts-reference-line-line"})),n},Ore=function(t,r,n,a,i,o,s,l,u){var d=i.x,f=i.y,h=i.width,g=i.height;if(n){var v=u.y,w=t.y.apply(v,{position:o});if(Bo(u,"discard")&&!t.y.isInRange(w))return null;var b=[{x:d+h,y:w},{x:d,y:w}];return l==="left"?b.reverse():b}if(r){var x=u.x,y=t.x.apply(x,{position:o});if(Bo(u,"discard")&&!t.x.isInRange(y))return null;var _=[{x:y,y:f+g},{x:y,y:f}];return s==="top"?_.reverse():_}if(a){var j=u.segment,S=j.map(function(k){return t.apply(k,{position:o})});return Bo(u,"discard")&&ete(S,function(k){return!t.isInRange(k)})?null:S}return null};function Are(e){var t=e.x,r=e.y,n=e.segment,a=e.xAxisId,i=e.yAxisId,o=e.shape,s=e.className,l=e.alwaysShow,u=dre(),d=QN(a),f=eO(i),h=pre();if(!u||!h)return null;ss(l===void 0,'The alwaysShow prop is deprecated. Please use ifOverflow="extendDomain" instead.');var g=aw({x:d.scale,y:f.scale}),v=sa(t),w=sa(r),b=n&&n.length===2,x=Ore(g,v,w,b,h,e.position,d.orientation,f.orientation,e);if(!x)return null;var y=_re(x,2),_=y[0],j=_.x,S=_.y,k=y[1],M=k.x,N=k.y,T=Bo(e,"hidden")?"url(#".concat(u,")"):void 0,A=P4(P4({clipPath:T},er(e,!0)),{},{x1:j,y1:S,x2:M,y2:N});return oe.createElement(Yr,{className:Nr("recharts-reference-line",s)},Nre(o,A),Sa.renderCallByParent(e,Gte({x1:j,y1:S,x2:M,y2:N})))}var tl=function(e){function t(){return mre(this,t),vre(this,t,arguments)}return kre(t,e),xre(t,[{key:"render",value:function(){return oe.createElement(Are,this.props)}}])}(oe.Component);cw(tl,"displayName","ReferenceLine");cw(tl,"defaultProps",{isFront:!1,ifOverflow:"discard",xAxisId:0,yAxisId:0,fill:"none",stroke:"#ccc",fillOpacity:1,strokeWidth:1,position:"middle"});function O1(){return O1=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},O1.apply(this,arguments)}function Gu(e){"@babel/helpers - typeof";return Gu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Gu(e)}function M4(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function N4(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?M4(Object(r),!0).forEach(function(n){Lm(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):M4(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Ere(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Tre(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,aO(n.key),n)}}function Ire(e,t,r){return t&&Tre(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function Rre(e,t,r){return t=wg(t),Dre(e,nO()?Reflect.construct(t,r||[],wg(e).constructor):t.apply(e,r))}function Dre(e,t){if(t&&(Gu(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return $re(e)}function $re(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function nO(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(nO=function(){return!!e})()}function wg(e){return wg=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},wg(e)}function Lre(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&A1(e,t)}function A1(e,t){return A1=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},A1(e,t)}function Lm(e,t,r){return t=aO(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function aO(e){var t=Bre(e,"string");return Gu(t)=="symbol"?t:t+""}function Bre(e,t){if(Gu(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(Gu(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var Fre=function(t){var r=t.x,n=t.y,a=t.xAxis,i=t.yAxis,o=aw({x:a.scale,y:i.scale}),s=o.apply({x:r,y:n},{bandAware:!0});return Bo(t,"discard")&&!o.isInRange(s)?null:s},G0=function(e){function t(){return Ere(this,t),Rre(this,t,arguments)}return Lre(t,e),Ire(t,[{key:"render",value:function(){var n=this.props,a=n.x,i=n.y,o=n.r,s=n.alwaysShow,l=n.clipPathId,u=sa(a),d=sa(i);if(ss(s===void 0,'The alwaysShow prop is deprecated. Please use ifOverflow="extendDomain" instead.'),!u||!d)return null;var f=Fre(this.props);if(!f)return null;var h=f.x,g=f.y,v=this.props,w=v.shape,b=v.className,x=Bo(this.props,"hidden")?"url(#".concat(l,")"):void 0,y=N4(N4({clipPath:x},er(this.props,!0)),{},{cx:h,cy:g});return oe.createElement(Yr,{className:Nr("recharts-reference-dot",b)},t.renderDot(w,y),Sa.renderCallByParent(this.props,{x:h-o,y:g-o,width:2*o,height:2*o}))}}])}(oe.Component);Lm(G0,"displayName","ReferenceDot");Lm(G0,"defaultProps",{isFront:!1,ifOverflow:"discard",xAxisId:0,yAxisId:0,r:10,fill:"#fff",stroke:"#ccc",fillOpacity:1,strokeWidth:1});Lm(G0,"renderDot",function(e,t){var r;return oe.isValidElement(e)?r=oe.cloneElement(e,t):ar(e)?r=e(t):r=oe.createElement(Im,O1({},t,{cx:t.cx,cy:t.cy,className:"recharts-reference-dot-dot"})),r});function E1(){return E1=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},E1.apply(this,arguments)}function zu(e){"@babel/helpers - typeof";return zu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},zu(e)}function O4(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function A4(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?O4(Object(r),!0).forEach(function(n){Bm(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):O4(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Ure(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Gre(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,oO(n.key),n)}}function zre(e,t,r){return t&&Gre(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function Wre(e,t,r){return t=kg(t),Vre(e,iO()?Reflect.construct(t,r||[],kg(e).constructor):t.apply(e,r))}function Vre(e,t){if(t&&(zu(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Hre(e)}function Hre(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function iO(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(iO=function(){return!!e})()}function kg(e){return kg=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},kg(e)}function Xre(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&T1(e,t)}function T1(e,t){return T1=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},T1(e,t)}function Bm(e,t,r){return t=oO(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function oO(e){var t=Kre(e,"string");return zu(t)=="symbol"?t:t+""}function Kre(e,t){if(zu(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(zu(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var Yre=function(t,r,n,a,i){var o=i.x1,s=i.x2,l=i.y1,u=i.y2,d=i.xAxis,f=i.yAxis;if(!d||!f)return null;var h=aw({x:d.scale,y:f.scale}),g={x:t?h.x.apply(o,{position:"start"}):h.x.rangeMin,y:n?h.y.apply(l,{position:"start"}):h.y.rangeMin},v={x:r?h.x.apply(s,{position:"end"}):h.x.rangeMax,y:a?h.y.apply(u,{position:"end"}):h.y.rangeMax};return Bo(i,"discard")&&(!h.isInRange(g)||!h.isInRange(v))?null:HN(g,v)},z0=function(e){function t(){return Ure(this,t),Wre(this,t,arguments)}return Xre(t,e),zre(t,[{key:"render",value:function(){var n=this.props,a=n.x1,i=n.x2,o=n.y1,s=n.y2,l=n.className,u=n.alwaysShow,d=n.clipPathId;ss(u===void 0,'The alwaysShow prop is deprecated. Please use ifOverflow="extendDomain" instead.');var f=sa(a),h=sa(i),g=sa(o),v=sa(s),w=this.props.shape;if(!f&&!h&&!g&&!v&&!w)return null;var b=Yre(f,h,g,v,this.props);if(!b&&!w)return null;var x=Bo(this.props,"hidden")?"url(#".concat(d,")"):void 0;return oe.createElement(Yr,{className:Nr("recharts-reference-area",l)},t.renderRect(w,A4(A4({clipPath:x},er(this.props,!0)),b)),Sa.renderCallByParent(this.props,b))}}])}(oe.Component);Bm(z0,"displayName","ReferenceArea");Bm(z0,"defaultProps",{isFront:!1,ifOverflow:"discard",xAxisId:0,yAxisId:0,r:10,fill:"#ccc",fillOpacity:.5,stroke:"none",strokeWidth:1});Bm(z0,"renderRect",function(e,t){var r;return oe.isValidElement(e)?r=oe.cloneElement(e,t):ar(e)?r=e(t):r=oe.createElement(rw,E1({},t,{className:"recharts-reference-area-rect"})),r});function sO(e,t,r){if(t<1)return[];if(t===1&&r===void 0)return e;for(var n=[],a=0;a<e.length;a+=t)n.push(e[a]);return n}function qre(e,t,r){var n={width:e.width+t.width,height:e.height+t.height};return Wte(n,r)}function Zre(e,t,r){var n=r==="width",a=e.x,i=e.y,o=e.width,s=e.height;return t===1?{start:n?a:i,end:n?a+o:i+s}:{start:n?a+o:i+s,end:n?a:i}}function Sg(e,t,r,n,a){if(e*t<e*n||e*t>e*a)return!1;var i=r();return e*(t-e*i/2-n)>=0&&e*(t+e*i/2-a)<=0}function Jre(e,t){return sO(e,t+1)}function Qre(e,t,r,n,a){for(var i=(n||[]).slice(),o=t.start,s=t.end,l=0,u=1,d=o,f=function(){var v=n==null?void 0:n[l];if(v===void 0)return{v:sO(n,u)};var w=l,b,x=function(){return b===void 0&&(b=r(v,w)),b},y=v.coordinate,_=l===0||Sg(e,y,x,d,s);_||(l=0,d=o,u+=1),_&&(d=y+e*(x()/2+a),l+=u)},h;u<=i.length;)if(h=f(),h)return h.v;return[]}function C0(e){"@babel/helpers - typeof";return C0=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},C0(e)}function E4(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Ta(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?E4(Object(r),!0).forEach(function(n){ene(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):E4(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function ene(e,t,r){return t=tne(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function tne(e){var t=rne(e,"string");return C0(t)=="symbol"?t:t+""}function rne(e,t){if(C0(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(C0(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function nne(e,t,r,n,a){for(var i=(n||[]).slice(),o=i.length,s=t.start,l=t.end,u=function(h){var g=i[h],v,w=function(){return v===void 0&&(v=r(g,h)),v};if(h===o-1){var b=e*(g.coordinate+e*w()/2-l);i[h]=g=Ta(Ta({},g),{},{tickCoord:b>0?g.coordinate-b*e:g.coordinate})}else i[h]=g=Ta(Ta({},g),{},{tickCoord:g.coordinate});var x=Sg(e,g.tickCoord,w,s,l);x&&(l=g.tickCoord-e*(w()/2+a),i[h]=Ta(Ta({},g),{},{isShow:!0}))},d=o-1;d>=0;d--)u(d);return i}function ane(e,t,r,n,a,i){var o=(n||[]).slice(),s=o.length,l=t.start,u=t.end;if(i){var d=n[s-1],f=r(d,s-1),h=e*(d.coordinate+e*f/2-u);o[s-1]=d=Ta(Ta({},d),{},{tickCoord:h>0?d.coordinate-h*e:d.coordinate});var g=Sg(e,d.tickCoord,function(){return f},l,u);g&&(u=d.tickCoord-e*(f/2+a),o[s-1]=Ta(Ta({},d),{},{isShow:!0}))}for(var v=i?s-1:s,w=function(y){var _=o[y],j,S=function(){return j===void 0&&(j=r(_,y)),j};if(y===0){var k=e*(_.coordinate-e*S()/2-l);o[y]=_=Ta(Ta({},_),{},{tickCoord:k<0?_.coordinate-k*e:_.coordinate})}else o[y]=_=Ta(Ta({},_),{},{tickCoord:_.coordinate});var M=Sg(e,_.tickCoord,S,l,u);M&&(l=_.tickCoord+e*(S()/2+a),o[y]=Ta(Ta({},_),{},{isShow:!0}))},b=0;b<v;b++)w(b);return o}function uw(e,t,r){var n=e.tick,a=e.ticks,i=e.viewBox,o=e.minTickGap,s=e.orientation,l=e.interval,u=e.tickFormatter,d=e.unit,f=e.angle;if(!a||!a.length||!n)return[];if(We(l)||Sl.isSsr)return Jre(a,typeof l=="number"&&We(l)?l:0);var h=[],g=s==="top"||s==="bottom"?"width":"height",v=d&&g==="width"?kf(d,{fontSize:t,letterSpacing:r}):{width:0,height:0},w=function(_,j){var S=ar(u)?u(_.value,j):_.value;return g==="width"?qre(kf(S,{fontSize:t,letterSpacing:r}),v,f):kf(S,{fontSize:t,letterSpacing:r})[g]},b=a.length>=2?go(a[1].coordinate-a[0].coordinate):1,x=Zre(i,b,g);return l==="equidistantPreserveStart"?Qre(b,x,w,a,o):(l==="preserveStart"||l==="preserveStartEnd"?h=ane(b,x,w,a,o,l==="preserveStartEnd"):h=nne(b,x,w,a,o),h.filter(function(y){return y.isShow}))}var ine=["viewBox"],one=["viewBox"],sne=["ticks"];function Wu(e){"@babel/helpers - typeof";return Wu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Wu(e)}function nu(){return nu=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},nu.apply(this,arguments)}function T4(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function ta(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?T4(Object(r),!0).forEach(function(n){dw(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):T4(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function ux(e,t){if(e==null)return{};var r=lne(e,t),n,a;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function lne(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function cne(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function I4(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,cO(n.key),n)}}function une(e,t,r){return t&&I4(e.prototype,t),r&&I4(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function dne(e,t,r){return t=_g(t),fne(e,lO()?Reflect.construct(t,r||[],_g(e).constructor):t.apply(e,r))}function fne(e,t){if(t&&(Wu(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return hne(e)}function hne(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function lO(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(lO=function(){return!!e})()}function _g(e){return _g=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},_g(e)}function pne(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&I1(e,t)}function I1(e,t){return I1=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},I1(e,t)}function dw(e,t,r){return t=cO(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function cO(e){var t=gne(e,"string");return Wu(t)=="symbol"?t:t+""}function gne(e,t){if(Wu(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(Wu(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var xd=function(e){function t(r){var n;return cne(this,t),n=dne(this,t,[r]),n.state={fontSize:"",letterSpacing:""},n}return pne(t,e),une(t,[{key:"shouldComponentUpdate",value:function(n,a){var i=n.viewBox,o=ux(n,ine),s=this.props,l=s.viewBox,u=ux(s,one);return!hu(i,l)||!hu(o,u)||!hu(a,this.state)}},{key:"componentDidMount",value:function(){var n=this.layerReference;if(n){var a=n.getElementsByClassName("recharts-cartesian-axis-tick-value")[0];a&&this.setState({fontSize:window.getComputedStyle(a).fontSize,letterSpacing:window.getComputedStyle(a).letterSpacing})}}},{key:"getTickLineCoord",value:function(n){var a=this.props,i=a.x,o=a.y,s=a.width,l=a.height,u=a.orientation,d=a.tickSize,f=a.mirror,h=a.tickMargin,g,v,w,b,x,y,_=f?-1:1,j=n.tickSize||d,S=We(n.tickCoord)?n.tickCoord:n.coordinate;switch(u){case"top":g=v=n.coordinate,b=o+ +!f*l,w=b-_*j,y=w-_*h,x=S;break;case"left":w=b=n.coordinate,v=i+ +!f*s,g=v-_*j,x=g-_*h,y=S;break;case"right":w=b=n.coordinate,v=i+ +f*s,g=v+_*j,x=g+_*h,y=S;break;default:g=v=n.coordinate,b=o+ +f*l,w=b+_*j,y=w+_*h,x=S;break}return{line:{x1:g,y1:w,x2:v,y2:b},tick:{x,y}}}},{key:"getTickTextAnchor",value:function(){var n=this.props,a=n.orientation,i=n.mirror,o;switch(a){case"left":o=i?"start":"end";break;case"right":o=i?"end":"start";break;default:o="middle";break}return o}},{key:"getTickVerticalAnchor",value:function(){var n=this.props,a=n.orientation,i=n.mirror,o="end";switch(a){case"left":case"right":o="middle";break;case"top":o=i?"start":"end";break;default:o=i?"end":"start";break}return o}},{key:"renderAxisLine",value:function(){var n=this.props,a=n.x,i=n.y,o=n.width,s=n.height,l=n.orientation,u=n.mirror,d=n.axisLine,f=ta(ta(ta({},er(this.props,!1)),er(d,!1)),{},{fill:"none"});if(l==="top"||l==="bottom"){var h=+(l==="top"&&!u||l==="bottom"&&u);f=ta(ta({},f),{},{x1:a,y1:i+h*s,x2:a+o,y2:i+h*s})}else{var g=+(l==="left"&&!u||l==="right"&&u);f=ta(ta({},f),{},{x1:a+g*o,y1:i,x2:a+g*o,y2:i+s})}return oe.createElement("line",nu({},f,{className:Nr("recharts-cartesian-axis-line",Wi(d,"className"))}))}},{key:"renderTicks",value:function(n,a,i){var o=this,s=this.props,l=s.tickLine,u=s.stroke,d=s.tick,f=s.tickFormatter,h=s.unit,g=uw(ta(ta({},this.props),{},{ticks:n}),a,i),v=this.getTickTextAnchor(),w=this.getTickVerticalAnchor(),b=er(this.props,!1),x=er(d,!1),y=ta(ta({},b),{},{fill:"none"},er(l,!1)),_=g.map(function(j,S){var k=o.getTickLineCoord(j),M=k.line,N=k.tick,T=ta(ta(ta(ta({textAnchor:v,verticalAnchor:w},b),{},{stroke:"none",fill:u},x),N),{},{index:S,payload:j,visibleTicksCount:g.length,tickFormatter:f});return oe.createElement(Yr,nu({className:"recharts-cartesian-axis-tick",key:"tick-".concat(j.value,"-").concat(j.coordinate,"-").concat(j.tickCoord)},Kf(o.props,j,S)),l&&oe.createElement("line",nu({},y,M,{className:Nr("recharts-cartesian-axis-tick-line",Wi(l,"className"))})),d&&t.renderTickItem(d,T,"".concat(ar(f)?f(j.value,S):j.value).concat(h||"")))});return oe.createElement("g",{className:"recharts-cartesian-axis-ticks"},_)}},{key:"render",value:function(){var n=this,a=this.props,i=a.axisLine,o=a.width,s=a.height,l=a.ticksGenerator,u=a.className,d=a.hide;if(d)return null;var f=this.props,h=f.ticks,g=ux(f,sne),v=h;return ar(l)&&(v=h&&h.length>0?l(this.props):l(g)),o<=0||s<=0||!v||!v.length?null:oe.createElement(Yr,{className:Nr("recharts-cartesian-axis",u),ref:function(b){n.layerReference=b}},i&&this.renderAxisLine(),this.renderTicks(v,this.state.fontSize,this.state.letterSpacing),Sa.renderCallByParent(this.props))}}],[{key:"renderTickItem",value:function(n,a,i){var o,s=Nr(a.className,"recharts-cartesian-axis-tick-value");return oe.isValidElement(n)?o=oe.cloneElement(n,ta(ta({},a),{},{className:s})):ar(n)?o=n(ta(ta({},a),{},{className:s})):o=oe.createElement(Wp,nu({},a,{className:"recharts-cartesian-axis-tick-value"}),i),o}}])}(P.Component);dw(xd,"displayName","CartesianAxis");dw(xd,"defaultProps",{x:0,y:0,width:0,height:0,viewBox:{x:0,y:0,width:0,height:0},orientation:"bottom",ticks:[],stroke:"#666",tickLine:!0,axisLine:!0,tick:!0,mirror:!1,minTickGap:5,tickSize:6,tickMargin:2,interval:"preserveEnd"});var mne=["x1","y1","x2","y2","key"],yne=["offset"];function xc(e){"@babel/helpers - typeof";return xc=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},xc(e)}function R4(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Ra(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?R4(Object(r),!0).forEach(function(n){xne(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):R4(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function xne(e,t,r){return t=vne(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function vne(e){var t=bne(e,"string");return xc(t)=="symbol"?t:t+""}function bne(e,t){if(xc(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(xc(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Hl(){return Hl=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Hl.apply(this,arguments)}function D4(e,t){if(e==null)return{};var r=wne(e,t),n,a;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function wne(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}var kne=function(t){var r=t.fill;if(!r||r==="none")return null;var n=t.fillOpacity,a=t.x,i=t.y,o=t.width,s=t.height,l=t.ry;return oe.createElement("rect",{x:a,y:i,ry:l,width:o,height:s,stroke:"none",fill:r,fillOpacity:n,className:"recharts-cartesian-grid-bg"})};function uO(e,t){var r;if(oe.isValidElement(e))r=oe.cloneElement(e,t);else if(ar(e))r=e(t);else{var n=t.x1,a=t.y1,i=t.x2,o=t.y2,s=t.key,l=D4(t,mne),u=er(l,!1);u.offset;var d=D4(u,yne);r=oe.createElement("line",Hl({},d,{x1:n,y1:a,x2:i,y2:o,fill:"none",key:s}))}return r}function Sne(e){var t=e.x,r=e.width,n=e.horizontal,a=n===void 0?!0:n,i=e.horizontalPoints;if(!a||!i||!i.length)return null;var o=i.map(function(s,l){var u=Ra(Ra({},e),{},{x1:t,y1:s,x2:t+r,y2:s,key:"line-".concat(l),index:l});return uO(a,u)});return oe.createElement("g",{className:"recharts-cartesian-grid-horizontal"},o)}function _ne(e){var t=e.y,r=e.height,n=e.vertical,a=n===void 0?!0:n,i=e.verticalPoints;if(!a||!i||!i.length)return null;var o=i.map(function(s,l){var u=Ra(Ra({},e),{},{x1:s,y1:t,x2:s,y2:t+r,key:"line-".concat(l),index:l});return uO(a,u)});return oe.createElement("g",{className:"recharts-cartesian-grid-vertical"},o)}function jne(e){var t=e.horizontalFill,r=e.fillOpacity,n=e.x,a=e.y,i=e.width,o=e.height,s=e.horizontalPoints,l=e.horizontal,u=l===void 0?!0:l;if(!u||!t||!t.length)return null;var d=s.map(function(h){return Math.round(h+a-a)}).sort(function(h,g){return h-g});a!==d[0]&&d.unshift(0);var f=d.map(function(h,g){var v=!d[g+1],w=v?a+o-h:d[g+1]-h;if(w<=0)return null;var b=g%t.length;return oe.createElement("rect",{key:"react-".concat(g),y:h,x:n,height:w,width:i,stroke:"none",fill:t[b],fillOpacity:r,className:"recharts-cartesian-grid-bg"})});return oe.createElement("g",{className:"recharts-cartesian-gridstripes-horizontal"},f)}function Pne(e){var t=e.vertical,r=t===void 0?!0:t,n=e.verticalFill,a=e.fillOpacity,i=e.x,o=e.y,s=e.width,l=e.height,u=e.verticalPoints;if(!r||!n||!n.length)return null;var d=u.map(function(h){return Math.round(h+i-i)}).sort(function(h,g){return h-g});i!==d[0]&&d.unshift(0);var f=d.map(function(h,g){var v=!d[g+1],w=v?i+s-h:d[g+1]-h;if(w<=0)return null;var b=g%n.length;return oe.createElement("rect",{key:"react-".concat(g),x:h,y:o,width:w,height:l,stroke:"none",fill:n[b],fillOpacity:a,className:"recharts-cartesian-grid-bg"})});return oe.createElement("g",{className:"recharts-cartesian-gridstripes-vertical"},f)}var Cne=function(t,r){var n=t.xAxis,a=t.width,i=t.height,o=t.offset;return bN(uw(Ra(Ra(Ra({},xd.defaultProps),n),{},{ticks:as(n,!0),viewBox:{x:0,y:0,width:a,height:i}})),o.left,o.left+o.width,r)},Mne=function(t,r){var n=t.yAxis,a=t.width,i=t.height,o=t.offset;return bN(uw(Ra(Ra(Ra({},xd.defaultProps),n),{},{ticks:as(n,!0),viewBox:{x:0,y:0,width:a,height:i}})),o.top,o.top+o.height,r)},Gc={horizontal:!0,vertical:!0,stroke:"#ccc",fill:"none",verticalFill:[],horizontalFill:[]};function mo(e){var t,r,n,a,i,o,s=sw(),l=lw(),u=gre(),d=Ra(Ra({},e),{},{stroke:(t=e.stroke)!==null&&t!==void 0?t:Gc.stroke,fill:(r=e.fill)!==null&&r!==void 0?r:Gc.fill,horizontal:(n=e.horizontal)!==null&&n!==void 0?n:Gc.horizontal,horizontalFill:(a=e.horizontalFill)!==null&&a!==void 0?a:Gc.horizontalFill,vertical:(i=e.vertical)!==null&&i!==void 0?i:Gc.vertical,verticalFill:(o=e.verticalFill)!==null&&o!==void 0?o:Gc.verticalFill,x:We(e.x)?e.x:u.left,y:We(e.y)?e.y:u.top,width:We(e.width)?e.width:u.width,height:We(e.height)?e.height:u.height}),f=d.x,h=d.y,g=d.width,v=d.height,w=d.syncWithTicks,b=d.horizontalValues,x=d.verticalValues,y=fre(),_=hre();if(!We(g)||g<=0||!We(v)||v<=0||!We(f)||f!==+f||!We(h)||h!==+h)return null;var j=d.verticalCoordinatesGenerator||Cne,S=d.horizontalCoordinatesGenerator||Mne,k=d.horizontalPoints,M=d.verticalPoints;if((!k||!k.length)&&ar(S)){var N=b&&b.length,T=S({yAxis:_?Ra(Ra({},_),{},{ticks:N?b:_.ticks}):void 0,width:s,height:l,offset:u},N?!0:w);ss(Array.isArray(T),"horizontalCoordinatesGenerator should return Array but instead it returned [".concat(xc(T),"]")),Array.isArray(T)&&(k=T)}if((!M||!M.length)&&ar(j)){var A=x&&x.length,D=j({xAxis:y?Ra(Ra({},y),{},{ticks:A?x:y.ticks}):void 0,width:s,height:l,offset:u},A?!0:w);ss(Array.isArray(D),"verticalCoordinatesGenerator should return Array but instead it returned [".concat(xc(D),"]")),Array.isArray(D)&&(M=D)}return oe.createElement("g",{className:"recharts-cartesian-grid"},oe.createElement(kne,{fill:d.fill,fillOpacity:d.fillOpacity,x:d.x,y:d.y,width:d.width,height:d.height,ry:d.ry}),oe.createElement(Sne,Hl({},d,{offset:u,horizontalPoints:k,xAxis:y,yAxis:_})),oe.createElement(_ne,Hl({},d,{offset:u,verticalPoints:M,xAxis:y,yAxis:_})),oe.createElement(jne,Hl({},d,{horizontalPoints:k})),oe.createElement(Pne,Hl({},d,{verticalPoints:M})))}mo.displayName="CartesianGrid";var Nne=["type","layout","connectNulls","ref"],One=["key"];function Vu(e){"@babel/helpers - typeof";return Vu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Vu(e)}function $4(e,t){if(e==null)return{};var r=Ane(e,t),n,a;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function Ane(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function Pf(){return Pf=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Pf.apply(this,arguments)}function L4(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function bi(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?L4(Object(r),!0).forEach(function(n){uo(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):L4(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function zc(e){return Rne(e)||Ine(e)||Tne(e)||Ene()}function Ene(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Tne(e,t){if(e){if(typeof e=="string")return R1(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return R1(e,t)}}function Ine(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function Rne(e){if(Array.isArray(e))return R1(e)}function R1(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Dne(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function B4(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,fO(n.key),n)}}function $ne(e,t,r){return t&&B4(e.prototype,t),r&&B4(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Lne(e,t,r){return t=jg(t),Bne(e,dO()?Reflect.construct(t,r||[],jg(e).constructor):t.apply(e,r))}function Bne(e,t){if(t&&(Vu(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Fne(e)}function Fne(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function dO(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(dO=function(){return!!e})()}function jg(e){return jg=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},jg(e)}function Une(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&D1(e,t)}function D1(e,t){return D1=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},D1(e,t)}function uo(e,t,r){return t=fO(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function fO(e){var t=Gne(e,"string");return Vu(t)=="symbol"?t:t+""}function Gne(e,t){if(Vu(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(Vu(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var ia=function(e){function t(){var r;Dne(this,t);for(var n=arguments.length,a=new Array(n),i=0;i<n;i++)a[i]=arguments[i];return r=Lne(this,t,[].concat(a)),uo(r,"state",{isAnimationFinished:!0,totalLength:0}),uo(r,"generateSimpleStrokeDasharray",function(o,s){return"".concat(s,"px ").concat(o-s,"px")}),uo(r,"getStrokeDasharray",function(o,s,l){var u=l.reduce(function(x,y){return x+y});if(!u)return r.generateSimpleStrokeDasharray(s,o);for(var d=Math.floor(o/u),f=o%u,h=s-o,g=[],v=0,w=0;v<l.length;w+=l[v],++v)if(w+l[v]>f){g=[].concat(zc(l.slice(0,v)),[f-w]);break}var b=g.length%2===0?[0,h]:[h];return[].concat(zc(t.repeat(l,d)),zc(g),b).map(function(x){return"".concat(x,"px")}).join(", ")}),uo(r,"id",Sc("recharts-line-")),uo(r,"pathRef",function(o){r.mainCurve=o}),uo(r,"handleAnimationEnd",function(){r.setState({isAnimationFinished:!0}),r.props.onAnimationEnd&&r.props.onAnimationEnd()}),uo(r,"handleAnimationStart",function(){r.setState({isAnimationFinished:!1}),r.props.onAnimationStart&&r.props.onAnimationStart()}),r}return Une(t,e),$ne(t,[{key:"componentDidMount",value:function(){if(this.props.isAnimationActive){var n=this.getTotalLength();this.setState({totalLength:n})}}},{key:"componentDidUpdate",value:function(){if(this.props.isAnimationActive){var n=this.getTotalLength();n!==this.state.totalLength&&this.setState({totalLength:n})}}},{key:"getTotalLength",value:function(){var n=this.mainCurve;try{return n&&n.getTotalLength&&n.getTotalLength()||0}catch{return 0}}},{key:"renderErrorBar",value:function(n,a){if(this.props.isAnimationActive&&!this.state.isAnimationFinished)return null;var i=this.props,o=i.points,s=i.xAxis,l=i.yAxis,u=i.layout,d=i.children,f=pi(d,yd);if(!f)return null;var h=function(w,b){return{x:w.x,y:w.y,value:w.value,errorVal:la(w.payload,b)}},g={clipPath:n?"url(#clipPath-".concat(a,")"):null};return oe.createElement(Yr,g,f.map(function(v){return oe.cloneElement(v,{key:"bar-".concat(v.props.dataKey),data:o,xAxis:s,yAxis:l,layout:u,dataPointFormatter:h})}))}},{key:"renderDots",value:function(n,a,i){var o=this.props.isAnimationActive;if(o&&!this.state.isAnimationFinished)return null;var s=this.props,l=s.dot,u=s.points,d=s.dataKey,f=er(this.props,!1),h=er(l,!0),g=u.map(function(w,b){var x=bi(bi(bi({key:"dot-".concat(b),r:3},f),h),{},{index:b,cx:w.x,cy:w.y,value:w.value,dataKey:d,payload:w.payload,points:u});return t.renderDotItem(l,x)}),v={clipPath:n?"url(#clipPath-".concat(a?"":"dots-").concat(i,")"):null};return oe.createElement(Yr,Pf({className:"recharts-line-dots",key:"dots"},v),g)}},{key:"renderCurveStatically",value:function(n,a,i,o){var s=this.props,l=s.type,u=s.layout,d=s.connectNulls;s.ref;var f=$4(s,Nne),h=bi(bi(bi({},er(f,!0)),{},{fill:"none",className:"recharts-line-curve",clipPath:a?"url(#clipPath-".concat(i,")"):null,points:n},o),{},{type:l,layout:u,connectNulls:d});return oe.createElement(Ql,Pf({},h,{pathRef:this.pathRef}))}},{key:"renderCurveWithAnimation",value:function(n,a){var i=this,o=this.props,s=o.points,l=o.strokeDasharray,u=o.isAnimationActive,d=o.animationBegin,f=o.animationDuration,h=o.animationEasing,g=o.animationId,v=o.animateNewValues,w=o.width,b=o.height,x=this.state,y=x.prevPoints,_=x.totalLength;return oe.createElement(bo,{begin:d,duration:f,isActive:u,easing:h,from:{t:0},to:{t:1},key:"line-".concat(g),onAnimationEnd:this.handleAnimationEnd,onAnimationStart:this.handleAnimationStart},function(j){var S=j.t;if(y){var k=y.length/s.length,M=s.map(function($,B){var J=Math.floor(B*k);if(y[J]){var W=y[J],I=Un(W.x,$.x),G=Un(W.y,$.y);return bi(bi({},$),{},{x:I(S),y:G(S)})}if(v){var U=Un(w*2,$.x),X=Un(b/2,$.y);return bi(bi({},$),{},{x:U(S),y:X(S)})}return bi(bi({},$),{},{x:$.x,y:$.y})});return i.renderCurveStatically(M,n,a)}var N=Un(0,_),T=N(S),A;if(l){var D="".concat(l).split(/[,\s]+/gim).map(function($){return parseFloat($)});A=i.getStrokeDasharray(T,_,D)}else A=i.generateSimpleStrokeDasharray(_,T);return i.renderCurveStatically(s,n,a,{strokeDasharray:A})})}},{key:"renderCurve",value:function(n,a){var i=this.props,o=i.points,s=i.isAnimationActive,l=this.state,u=l.prevPoints,d=l.totalLength;return s&&o&&o.length&&(!u&&d>0||!gc(u,o))?this.renderCurveWithAnimation(n,a):this.renderCurveStatically(o,n,a)}},{key:"render",value:function(){var n,a=this.props,i=a.hide,o=a.dot,s=a.points,l=a.className,u=a.xAxis,d=a.yAxis,f=a.top,h=a.left,g=a.width,v=a.height,w=a.isAnimationActive,b=a.id;if(i||!s||!s.length)return null;var x=this.state.isAnimationFinished,y=s.length===1,_=Nr("recharts-line",l),j=u&&u.allowDataOverflow,S=d&&d.allowDataOverflow,k=j||S,M=qt(b)?this.id:b,N=(n=er(o,!1))!==null&&n!==void 0?n:{r:3,strokeWidth:2},T=N.r,A=T===void 0?3:T,D=N.strokeWidth,$=D===void 0?2:D,B=pC(o)?o:{},J=B.clipDot,W=J===void 0?!0:J,I=A*2+$;return oe.createElement(Yr,{className:_},j||S?oe.createElement("defs",null,oe.createElement("clipPath",{id:"clipPath-".concat(M)},oe.createElement("rect",{x:j?h:h-g/2,y:S?f:f-v/2,width:j?g:g*2,height:S?v:v*2})),!W&&oe.createElement("clipPath",{id:"clipPath-dots-".concat(M)},oe.createElement("rect",{x:h-I/2,y:f-I/2,width:g+I,height:v+I}))):null,!y&&this.renderCurve(k,M),this.renderErrorBar(k,M),(y||o)&&this.renderDots(k,W,M),(!w||x)&&Lo.renderCallByParent(this.props,s))}}],[{key:"getDerivedStateFromProps",value:function(n,a){return n.animationId!==a.prevAnimationId?{prevAnimationId:n.animationId,curPoints:n.points,prevPoints:a.curPoints}:n.points!==a.curPoints?{curPoints:n.points}:null}},{key:"repeat",value:function(n,a){for(var i=n.length%2!==0?[].concat(zc(n),[0]):n,o=[],s=0;s<a;++s)o=[].concat(zc(o),zc(i));return o}},{key:"renderDotItem",value:function(n,a){var i;if(oe.isValidElement(n))i=oe.cloneElement(n,a);else if(ar(n))i=n(a);else{var o=a.key,s=$4(a,One),l=Nr("recharts-line-dot",typeof n!="boolean"?n.className:"");i=oe.createElement(Im,Pf({key:o},s,{className:l}))}return i}}])}(P.PureComponent);uo(ia,"displayName","Line");uo(ia,"defaultProps",{xAxisId:0,yAxisId:0,connectNulls:!1,activeDot:!0,dot:!0,legendType:"line",stroke:"#3182bd",strokeWidth:1,fill:"#fff",points:[],isAnimationActive:!Sl.isSsr,animateNewValues:!0,animationBegin:0,animationDuration:1500,animationEasing:"ease",hide:!1,label:!1});uo(ia,"getComposedData",function(e){var t=e.props,r=e.xAxis,n=e.yAxis,a=e.xAxisTicks,i=e.yAxisTicks,o=e.dataKey,s=e.bandSize,l=e.displayedData,u=e.offset,d=t.layout,f=l.map(function(h,g){var v=la(h,o);return d==="horizontal"?{x:Du({axis:r,ticks:a,bandSize:s,entry:h,index:g}),y:qt(v)?null:n.scale(v),value:v,payload:h}:{x:qt(v)?null:r.scale(v),y:Du({axis:n,ticks:i,bandSize:s,entry:h,index:g}),value:v,payload:h}});return bi({points:f,layout:d},u)});var zne=["layout","type","stroke","connectNulls","isRange","ref"],Wne=["key"],hO;function Hu(e){"@babel/helpers - typeof";return Hu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Hu(e)}function pO(e,t){if(e==null)return{};var r=Vne(e,t),n,a;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function Vne(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function Xl(){return Xl=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Xl.apply(this,arguments)}function F4(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Ls(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?F4(Object(r),!0).forEach(function(n){Eo(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):F4(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Hne(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function U4(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,mO(n.key),n)}}function Xne(e,t,r){return t&&U4(e.prototype,t),r&&U4(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Kne(e,t,r){return t=Pg(t),Yne(e,gO()?Reflect.construct(t,r||[],Pg(e).constructor):t.apply(e,r))}function Yne(e,t){if(t&&(Hu(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return qne(e)}function qne(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function gO(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(gO=function(){return!!e})()}function Pg(e){return Pg=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Pg(e)}function Zne(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&$1(e,t)}function $1(e,t){return $1=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},$1(e,t)}function Eo(e,t,r){return t=mO(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function mO(e){var t=Jne(e,"string");return Hu(t)=="symbol"?t:t+""}function Jne(e,t){if(Hu(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(Hu(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var Gi=function(e){function t(){var r;Hne(this,t);for(var n=arguments.length,a=new Array(n),i=0;i<n;i++)a[i]=arguments[i];return r=Kne(this,t,[].concat(a)),Eo(r,"state",{isAnimationFinished:!0}),Eo(r,"id",Sc("recharts-area-")),Eo(r,"handleAnimationEnd",function(){var o=r.props.onAnimationEnd;r.setState({isAnimationFinished:!0}),ar(o)&&o()}),Eo(r,"handleAnimationStart",function(){var o=r.props.onAnimationStart;r.setState({isAnimationFinished:!1}),ar(o)&&o()}),r}return Zne(t,e),Xne(t,[{key:"renderDots",value:function(n,a,i){var o=this.props.isAnimationActive,s=this.state.isAnimationFinished;if(o&&!s)return null;var l=this.props,u=l.dot,d=l.points,f=l.dataKey,h=er(this.props,!1),g=er(u,!0),v=d.map(function(b,x){var y=Ls(Ls(Ls({key:"dot-".concat(x),r:3},h),g),{},{index:x,cx:b.x,cy:b.y,dataKey:f,value:b.value,payload:b.payload,points:d});return t.renderDotItem(u,y)}),w={clipPath:n?"url(#clipPath-".concat(a?"":"dots-").concat(i,")"):null};return oe.createElement(Yr,Xl({className:"recharts-area-dots"},w),v)}},{key:"renderHorizontalRect",value:function(n){var a=this.props,i=a.baseLine,o=a.points,s=a.strokeWidth,l=o[0].x,u=o[o.length-1].x,d=n*Math.abs(l-u),f=Qs(o.map(function(h){return h.y||0}));return We(i)&&typeof i=="number"?f=Math.max(i,f):i&&Array.isArray(i)&&i.length&&(f=Math.max(Qs(i.map(function(h){return h.y||0})),f)),We(f)?oe.createElement("rect",{x:l<u?l:l-d,y:0,width:d,height:Math.floor(f+(s?parseInt("".concat(s),10):1))}):null}},{key:"renderVerticalRect",value:function(n){var a=this.props,i=a.baseLine,o=a.points,s=a.strokeWidth,l=o[0].y,u=o[o.length-1].y,d=n*Math.abs(l-u),f=Qs(o.map(function(h){return h.x||0}));return We(i)&&typeof i=="number"?f=Math.max(i,f):i&&Array.isArray(i)&&i.length&&(f=Math.max(Qs(i.map(function(h){return h.x||0})),f)),We(f)?oe.createElement("rect",{x:0,y:l<u?l:l-d,width:f+(s?parseInt("".concat(s),10):1),height:Math.floor(d)}):null}},{key:"renderClipRect",value:function(n){var a=this.props.layout;return a==="vertical"?this.renderVerticalRect(n):this.renderHorizontalRect(n)}},{key:"renderAreaStatically",value:function(n,a,i,o){var s=this.props,l=s.layout,u=s.type,d=s.stroke,f=s.connectNulls,h=s.isRange;s.ref;var g=pO(s,zne);return oe.createElement(Yr,{clipPath:i?"url(#clipPath-".concat(o,")"):null},oe.createElement(Ql,Xl({},er(g,!0),{points:n,connectNulls:f,type:u,baseLine:a,layout:l,stroke:"none",className:"recharts-area-area"})),d!=="none"&&oe.createElement(Ql,Xl({},er(this.props,!1),{className:"recharts-area-curve",layout:l,type:u,connectNulls:f,fill:"none",points:n})),d!=="none"&&h&&oe.createElement(Ql,Xl({},er(this.props,!1),{className:"recharts-area-curve",layout:l,type:u,connectNulls:f,fill:"none",points:a})))}},{key:"renderAreaWithAnimation",value:function(n,a){var i=this,o=this.props,s=o.points,l=o.baseLine,u=o.isAnimationActive,d=o.animationBegin,f=o.animationDuration,h=o.animationEasing,g=o.animationId,v=this.state,w=v.prevPoints,b=v.prevBaseLine;return oe.createElement(bo,{begin:d,duration:f,isActive:u,easing:h,from:{t:0},to:{t:1},key:"area-".concat(g),onAnimationEnd:this.handleAnimationEnd,onAnimationStart:this.handleAnimationStart},function(x){var y=x.t;if(w){var _=w.length/s.length,j=s.map(function(N,T){var A=Math.floor(T*_);if(w[A]){var D=w[A],$=Un(D.x,N.x),B=Un(D.y,N.y);return Ls(Ls({},N),{},{x:$(y),y:B(y)})}return N}),S;if(We(l)&&typeof l=="number"){var k=Un(b,l);S=k(y)}else if(qt(l)||ud(l)){var M=Un(b,0);S=M(y)}else S=l.map(function(N,T){var A=Math.floor(T*_);if(b[A]){var D=b[A],$=Un(D.x,N.x),B=Un(D.y,N.y);return Ls(Ls({},N),{},{x:$(y),y:B(y)})}return N});return i.renderAreaStatically(j,S,n,a)}return oe.createElement(Yr,null,oe.createElement("defs",null,oe.createElement("clipPath",{id:"animationClipPath-".concat(a)},i.renderClipRect(y))),oe.createElement(Yr,{clipPath:"url(#animationClipPath-".concat(a,")")},i.renderAreaStatically(s,l,n,a)))})}},{key:"renderArea",value:function(n,a){var i=this.props,o=i.points,s=i.baseLine,l=i.isAnimationActive,u=this.state,d=u.prevPoints,f=u.prevBaseLine,h=u.totalLength;return l&&o&&o.length&&(!d&&h>0||!gc(d,o)||!gc(f,s))?this.renderAreaWithAnimation(n,a):this.renderAreaStatically(o,s,n,a)}},{key:"render",value:function(){var n,a=this.props,i=a.hide,o=a.dot,s=a.points,l=a.className,u=a.top,d=a.left,f=a.xAxis,h=a.yAxis,g=a.width,v=a.height,w=a.isAnimationActive,b=a.id;if(i||!s||!s.length)return null;var x=this.state.isAnimationFinished,y=s.length===1,_=Nr("recharts-area",l),j=f&&f.allowDataOverflow,S=h&&h.allowDataOverflow,k=j||S,M=qt(b)?this.id:b,N=(n=er(o,!1))!==null&&n!==void 0?n:{r:3,strokeWidth:2},T=N.r,A=T===void 0?3:T,D=N.strokeWidth,$=D===void 0?2:D,B=pC(o)?o:{},J=B.clipDot,W=J===void 0?!0:J,I=A*2+$;return oe.createElement(Yr,{className:_},j||S?oe.createElement("defs",null,oe.createElement("clipPath",{id:"clipPath-".concat(M)},oe.createElement("rect",{x:j?d:d-g/2,y:S?u:u-v/2,width:j?g:g*2,height:S?v:v*2})),!W&&oe.createElement("clipPath",{id:"clipPath-dots-".concat(M)},oe.createElement("rect",{x:d-I/2,y:u-I/2,width:g+I,height:v+I}))):null,y?null:this.renderArea(k,M),(o||y)&&this.renderDots(k,W,M),(!w||x)&&Lo.renderCallByParent(this.props,s))}}],[{key:"getDerivedStateFromProps",value:function(n,a){return n.animationId!==a.prevAnimationId?{prevAnimationId:n.animationId,curPoints:n.points,curBaseLine:n.baseLine,prevPoints:a.curPoints,prevBaseLine:a.curBaseLine}:n.points!==a.curPoints||n.baseLine!==a.curBaseLine?{curPoints:n.points,curBaseLine:n.baseLine}:null}}])}(P.PureComponent);hO=Gi;Eo(Gi,"displayName","Area");Eo(Gi,"defaultProps",{stroke:"#3182bd",fill:"#3182bd",fillOpacity:.6,xAxisId:0,yAxisId:0,legendType:"line",connectNulls:!1,points:[],dot:!1,activeDot:!0,hide:!1,isAnimationActive:!Sl.isSsr,animationBegin:0,animationDuration:1500,animationEasing:"ease"});Eo(Gi,"getBaseValue",function(e,t,r,n){var a=e.layout,i=e.baseValue,o=t.props.baseValue,s=o??i;if(We(s)&&typeof s=="number")return s;var l=a==="horizontal"?n:r,u=l.scale.domain();if(l.type==="number"){var d=Math.max(u[0],u[1]),f=Math.min(u[0],u[1]);return s==="dataMin"?f:s==="dataMax"||d<0?d:Math.max(Math.min(u[0],u[1]),0)}return s==="dataMin"?u[0]:s==="dataMax"?u[1]:u[0]});Eo(Gi,"getComposedData",function(e){var t=e.props,r=e.item,n=e.xAxis,a=e.yAxis,i=e.xAxisTicks,o=e.yAxisTicks,s=e.bandSize,l=e.dataKey,u=e.stackedData,d=e.dataStartIndex,f=e.displayedData,h=e.offset,g=t.layout,v=u&&u.length,w=hO.getBaseValue(t,r,n,a),b=g==="horizontal",x=!1,y=f.map(function(j,S){var k;v?k=u[d+S]:(k=la(j,l),Array.isArray(k)?x=!0:k=[w,k]);var M=k[1]==null||v&&la(j,l)==null;return b?{x:Du({axis:n,ticks:i,bandSize:s,entry:j,index:S}),y:M?null:a.scale(k[1]),value:k,payload:j}:{x:M?null:n.scale(k[1]),y:Du({axis:a,ticks:o,bandSize:s,entry:j,index:S}),value:k,payload:j}}),_;return v||x?_=y.map(function(j){var S=Array.isArray(j.value)?j.value[0]:null;return b?{x:j.x,y:S!=null&&j.y!=null?a.scale(S):null}:{x:S!=null?n.scale(S):null,y:j.y}}):_=b?a.scale(w):n.scale(w),Ls({points:y,baseLine:_,layout:g,isRange:x},h)});Eo(Gi,"renderDotItem",function(e,t){var r;if(oe.isValidElement(e))r=oe.cloneElement(e,t);else if(ar(e))r=e(t);else{var n=Nr("recharts-area-dot",typeof e!="boolean"?e.className:""),a=t.key,i=pO(t,Wne);r=oe.createElement(Im,Xl({},i,{key:a,className:n}))}return r});function Xu(e){"@babel/helpers - typeof";return Xu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Xu(e)}function Qne(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function eae(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,vO(n.key),n)}}function tae(e,t,r){return t&&eae(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function rae(e,t,r){return t=Cg(t),nae(e,yO()?Reflect.construct(t,r||[],Cg(e).constructor):t.apply(e,r))}function nae(e,t){if(t&&(Xu(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return aae(e)}function aae(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function yO(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(yO=function(){return!!e})()}function Cg(e){return Cg=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Cg(e)}function iae(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&L1(e,t)}function L1(e,t){return L1=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},L1(e,t)}function xO(e,t,r){return t=vO(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function vO(e){var t=oae(e,"string");return Xu(t)=="symbol"?t:t+""}function oae(e,t){if(Xu(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(Xu(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var Fm=function(e){function t(){return Qne(this,t),rae(this,t,arguments)}return iae(t,e),tae(t,[{key:"render",value:function(){return null}}])}(P.Component);xO(Fm,"displayName","ZAxis");xO(Fm,"defaultProps",{zAxisId:0,range:[64,64],scale:"auto",type:"number"});var sae=["option","isActive"];function Cf(){return Cf=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Cf.apply(this,arguments)}function lae(e,t){if(e==null)return{};var r=cae(e,t),n,a;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function cae(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function uae(e){var t=e.option,r=e.isActive,n=lae(e,sae);return typeof t=="string"?P.createElement(_1,Cf({option:P.createElement(wm,Cf({type:t},n)),isActive:r,shapeType:"symbols"},n)):P.createElement(_1,Cf({option:t,isActive:r,shapeType:"symbols"},n))}function Ku(e){"@babel/helpers - typeof";return Ku=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ku(e)}function Mf(){return Mf=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Mf.apply(this,arguments)}function G4(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function $i(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?G4(Object(r),!0).forEach(function(n){rl(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):G4(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function dae(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function z4(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,wO(n.key),n)}}function fae(e,t,r){return t&&z4(e.prototype,t),r&&z4(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function hae(e,t,r){return t=Mg(t),pae(e,bO()?Reflect.construct(t,r||[],Mg(e).constructor):t.apply(e,r))}function pae(e,t){if(t&&(Ku(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return gae(e)}function gae(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function bO(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(bO=function(){return!!e})()}function Mg(e){return Mg=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Mg(e)}function mae(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&B1(e,t)}function B1(e,t){return B1=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},B1(e,t)}function rl(e,t,r){return t=wO(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function wO(e){var t=yae(e,"string");return Ku(t)=="symbol"?t:t+""}function yae(e,t){if(Ku(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(Ku(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var Wa=function(e){function t(){var r;dae(this,t);for(var n=arguments.length,a=new Array(n),i=0;i<n;i++)a[i]=arguments[i];return r=hae(this,t,[].concat(a)),rl(r,"state",{isAnimationFinished:!1}),rl(r,"handleAnimationEnd",function(){r.setState({isAnimationFinished:!0})}),rl(r,"handleAnimationStart",function(){r.setState({isAnimationFinished:!1})}),rl(r,"id",Sc("recharts-scatter-")),r}return mae(t,e),fae(t,[{key:"renderSymbolsStatically",value:function(n){var a=this,i=this.props,o=i.shape,s=i.activeShape,l=i.activeIndex,u=er(this.props,!1);return n.map(function(d,f){var h=l===f,g=h?s:o,v=$i($i({},u),d);return oe.createElement(Yr,Mf({className:"recharts-scatter-symbol",key:"symbol-".concat(d==null?void 0:d.cx,"-").concat(d==null?void 0:d.cy,"-").concat(d==null?void 0:d.size,"-").concat(f)},Kf(a.props,d,f),{role:"img"}),oe.createElement(uae,Mf({option:g,isActive:h,key:"symbol-".concat(f)},v)))})}},{key:"renderSymbolsWithAnimation",value:function(){var n=this,a=this.props,i=a.points,o=a.isAnimationActive,s=a.animationBegin,l=a.animationDuration,u=a.animationEasing,d=a.animationId,f=this.state.prevPoints;return oe.createElement(bo,{begin:s,duration:l,isActive:o,easing:u,from:{t:0},to:{t:1},key:"pie-".concat(d),onAnimationEnd:this.handleAnimationEnd,onAnimationStart:this.handleAnimationStart},function(h){var g=h.t,v=i.map(function(w,b){var x=f&&f[b];if(x){var y=Un(x.cx,w.cx),_=Un(x.cy,w.cy),j=Un(x.size,w.size);return $i($i({},w),{},{cx:y(g),cy:_(g),size:j(g)})}var S=Un(0,w.size);return $i($i({},w),{},{size:S(g)})});return oe.createElement(Yr,null,n.renderSymbolsStatically(v))})}},{key:"renderSymbols",value:function(){var n=this.props,a=n.points,i=n.isAnimationActive,o=this.state.prevPoints;return i&&a&&a.length&&(!o||!gc(o,a))?this.renderSymbolsWithAnimation():this.renderSymbolsStatically(a)}},{key:"renderErrorBar",value:function(){var n=this.props.isAnimationActive;if(n&&!this.state.isAnimationFinished)return null;var a=this.props,i=a.points,o=a.xAxis,s=a.yAxis,l=a.children,u=pi(l,yd);return u?u.map(function(d,f){var h=d.props,g=h.direction,v=h.dataKey;return oe.cloneElement(d,{key:"".concat(g,"-").concat(v,"-").concat(i[f]),data:i,xAxis:o,yAxis:s,layout:g==="x"?"vertical":"horizontal",dataPointFormatter:function(b,x){return{x:b.cx,y:b.cy,value:g==="x"?+b.node.x:+b.node.y,errorVal:la(b,x)}}})}):null}},{key:"renderLine",value:function(){var n=this.props,a=n.points,i=n.line,o=n.lineType,s=n.lineJointType,l=er(this.props,!1),u=er(i,!1),d,f;if(o==="joint")d=a.map(function(_){return{x:_.cx,y:_.cy}});else if(o==="fitting"){var h=VD(a),g=h.xmin,v=h.xmax,w=h.a,b=h.b,x=function(j){return w*j+b};d=[{x:g,y:x(g)},{x:v,y:x(v)}]}var y=$i($i($i({},l),{},{fill:"none",stroke:l&&l.fill},u),{},{points:d});return oe.isValidElement(i)?f=oe.cloneElement(i,y):ar(i)?f=i(y):f=oe.createElement(Ql,Mf({},y,{type:s})),oe.createElement(Yr,{className:"recharts-scatter-line",key:"recharts-scatter-line"},f)}},{key:"render",value:function(){var n=this.props,a=n.hide,i=n.points,o=n.line,s=n.className,l=n.xAxis,u=n.yAxis,d=n.left,f=n.top,h=n.width,g=n.height,v=n.id,w=n.isAnimationActive;if(a||!i||!i.length)return null;var b=this.state.isAnimationFinished,x=Nr("recharts-scatter",s),y=l&&l.allowDataOverflow,_=u&&u.allowDataOverflow,j=y||_,S=qt(v)?this.id:v;return oe.createElement(Yr,{className:x,clipPath:j?"url(#clipPath-".concat(S,")"):null},y||_?oe.createElement("defs",null,oe.createElement("clipPath",{id:"clipPath-".concat(S)},oe.createElement("rect",{x:y?d:d-h/2,y:_?f:f-g/2,width:y?h:h*2,height:_?g:g*2}))):null,o&&this.renderLine(),this.renderErrorBar(),oe.createElement(Yr,{key:"recharts-scatter-symbols"},this.renderSymbols()),(!w||b)&&Lo.renderCallByParent(this.props,i))}}],[{key:"getDerivedStateFromProps",value:function(n,a){return n.animationId!==a.prevAnimationId?{prevAnimationId:n.animationId,curPoints:n.points,prevPoints:a.curPoints}:n.points!==a.curPoints?{curPoints:n.points}:null}}])}(P.PureComponent);rl(Wa,"displayName","Scatter");rl(Wa,"defaultProps",{xAxisId:0,yAxisId:0,zAxisId:0,legendType:"circle",lineType:"joint",lineJointType:"linear",data:[],shape:"circle",hide:!1,isAnimationActive:!Sl.isSsr,animationBegin:0,animationDuration:400,animationEasing:"linear"});rl(Wa,"getComposedData",function(e){var t=e.xAxis,r=e.yAxis,n=e.zAxis,a=e.item,i=e.displayedData,o=e.xAxisTicks,s=e.yAxisTicks,l=e.offset,u=a.props.tooltipType,d=pi(a.props.children,O2),f=qt(t.dataKey)?a.props.dataKey:t.dataKey,h=qt(r.dataKey)?a.props.dataKey:r.dataKey,g=n&&n.dataKey,v=n?n.range:Fm.defaultProps.range,w=v&&v[0],b=t.scale.bandwidth?t.scale.bandwidth():0,x=r.scale.bandwidth?r.scale.bandwidth():0,y=i.map(function(_,j){var S=la(_,f),k=la(_,h),M=!qt(g)&&la(_,g)||"-",N=[{name:qt(t.dataKey)?a.props.name:t.name||t.dataKey,unit:t.unit||"",value:S,payload:_,dataKey:f,type:u},{name:qt(r.dataKey)?a.props.name:r.name||r.dataKey,unit:r.unit||"",value:k,payload:_,dataKey:h,type:u}];M!=="-"&&N.push({name:n.name||n.dataKey,unit:n.unit||"",value:M,payload:_,dataKey:g,type:u});var T=Du({axis:t,ticks:o,bandSize:b,entry:_,index:j,dataKey:f}),A=Du({axis:r,ticks:s,bandSize:x,entry:_,index:j,dataKey:h}),D=M!=="-"?n.scale(M):w,$=Math.sqrt(Math.max(D,0)/Math.PI);return $i($i({},_),{},{cx:T,cy:A,x:T-$,y:A-$,xAxis:t,yAxis:r,zAxis:n,width:2*$,height:2*$,size:D,node:{x:S,y:k,z:M},tooltipPayload:N,tooltipPosition:{x:T,y:A},payload:_},d&&d[j]&&d[j].props)});return $i({points:y},l)});function Yu(e){"@babel/helpers - typeof";return Yu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Yu(e)}function xae(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function vae(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_O(n.key),n)}}function bae(e,t,r){return t&&vae(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function wae(e,t,r){return t=Ng(t),kae(e,kO()?Reflect.construct(t,r||[],Ng(e).constructor):t.apply(e,r))}function kae(e,t){if(t&&(Yu(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Sae(e)}function Sae(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function kO(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(kO=function(){return!!e})()}function Ng(e){return Ng=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Ng(e)}function _ae(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&F1(e,t)}function F1(e,t){return F1=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},F1(e,t)}function SO(e,t,r){return t=_O(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _O(e){var t=jae(e,"string");return Yu(t)=="symbol"?t:t+""}function jae(e,t){if(Yu(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(Yu(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}function U1(){return U1=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},U1.apply(this,arguments)}function Pae(e){var t=e.xAxisId,r=sw(),n=lw(),a=QN(t);return a==null?null:P.createElement(xd,U1({},a,{className:Nr("recharts-".concat(a.axisType," ").concat(a.axisType),a.className),viewBox:{x:0,y:0,width:r,height:n},ticksGenerator:function(o){return as(o,!0)}}))}var Ka=function(e){function t(){return xae(this,t),wae(this,t,arguments)}return _ae(t,e),bae(t,[{key:"render",value:function(){return P.createElement(Pae,this.props)}}])}(P.Component);SO(Ka,"displayName","XAxis");SO(Ka,"defaultProps",{allowDecimals:!0,hide:!1,orientation:"bottom",width:0,height:30,mirror:!1,xAxisId:0,tickCount:5,type:"category",padding:{left:0,right:0},allowDataOverflow:!1,scale:"auto",reversed:!1,allowDuplicatedCategory:!0});function qu(e){"@babel/helpers - typeof";return qu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},qu(e)}function Cae(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Mae(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,CO(n.key),n)}}function Nae(e,t,r){return t&&Mae(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function Oae(e,t,r){return t=Og(t),Aae(e,jO()?Reflect.construct(t,r||[],Og(e).constructor):t.apply(e,r))}function Aae(e,t){if(t&&(qu(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Eae(e)}function Eae(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function jO(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(jO=function(){return!!e})()}function Og(e){return Og=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Og(e)}function Tae(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&G1(e,t)}function G1(e,t){return G1=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},G1(e,t)}function PO(e,t,r){return t=CO(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function CO(e){var t=Iae(e,"string");return qu(t)=="symbol"?t:t+""}function Iae(e,t){if(qu(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(qu(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}function z1(){return z1=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},z1.apply(this,arguments)}var Rae=function(t){var r=t.yAxisId,n=sw(),a=lw(),i=eO(r);return i==null?null:P.createElement(xd,z1({},i,{className:Nr("recharts-".concat(i.axisType," ").concat(i.axisType),i.className),viewBox:{x:0,y:0,width:n,height:a},ticksGenerator:function(s){return as(s,!0)}}))},Ya=function(e){function t(){return Cae(this,t),Oae(this,t,arguments)}return Tae(t,e),Nae(t,[{key:"render",value:function(){return P.createElement(Rae,this.props)}}])}(P.Component);PO(Ya,"displayName","YAxis");PO(Ya,"defaultProps",{allowDuplicatedCategory:!0,allowDecimals:!0,hide:!1,orientation:"left",width:60,height:0,mirror:!1,yAxisId:0,tickCount:5,type:"number",padding:{top:0,bottom:0},allowDataOverflow:!1,scale:"auto",reversed:!1});function W4(e){return Bae(e)||Lae(e)||$ae(e)||Dae()}function Dae(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function $ae(e,t){if(e){if(typeof e=="string")return W1(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return W1(e,t)}}function Lae(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function Bae(e){if(Array.isArray(e))return W1(e)}function W1(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var V1=function(t,r,n,a,i){var o=pi(t,tl),s=pi(t,G0),l=[].concat(W4(o),W4(s)),u=pi(t,z0),d="".concat(a,"Id"),f=a[0],h=r;if(l.length&&(h=l.reduce(function(w,b){if(b.props[d]===n&&Bo(b.props,"extendDomain")&&We(b.props[f])){var x=b.props[f];return[Math.min(w[0],x),Math.max(w[1],x)]}return w},h)),u.length){var g="".concat(f,"1"),v="".concat(f,"2");h=u.reduce(function(w,b){if(b.props[d]===n&&Bo(b.props,"extendDomain")&&We(b.props[g])&&We(b.props[v])){var x=b.props[g],y=b.props[v];return[Math.min(w[0],x,y),Math.max(w[1],x,y)]}return w},h)}return i&&i.length&&(h=i.reduce(function(w,b){return We(b)?[Math.min(w[0],b),Math.max(w[1],b)]:w},h)),h},MO={exports:{}};(function(e){var t=Object.prototype.hasOwnProperty,r="~";function n(){}Object.create&&(n.prototype=Object.create(null),new n().__proto__||(r=!1));function a(l,u,d){this.fn=l,this.context=u,this.once=d||!1}function i(l,u,d,f,h){if(typeof d!="function")throw new TypeError("The listener must be a function");var g=new a(d,f||l,h),v=r?r+u:u;return l._events[v]?l._events[v].fn?l._events[v]=[l._events[v],g]:l._events[v].push(g):(l._events[v]=g,l._eventsCount++),l}function o(l,u){--l._eventsCount===0?l._events=new n:delete l._events[u]}function s(){this._events=new n,this._eventsCount=0}s.prototype.eventNames=function(){var u=[],d,f;if(this._eventsCount===0)return u;for(f in d=this._events)t.call(d,f)&&u.push(r?f.slice(1):f);return Object.getOwnPropertySymbols?u.concat(Object.getOwnPropertySymbols(d)):u},s.prototype.listeners=function(u){var d=r?r+u:u,f=this._events[d];if(!f)return[];if(f.fn)return[f.fn];for(var h=0,g=f.length,v=new Array(g);h<g;h++)v[h]=f[h].fn;return v},s.prototype.listenerCount=function(u){var d=r?r+u:u,f=this._events[d];return f?f.fn?1:f.length:0},s.prototype.emit=function(u,d,f,h,g,v){var w=r?r+u:u;if(!this._events[w])return!1;var b=this._events[w],x=arguments.length,y,_;if(b.fn){switch(b.once&&this.removeListener(u,b.fn,void 0,!0),x){case 1:return b.fn.call(b.context),!0;case 2:return b.fn.call(b.context,d),!0;case 3:return b.fn.call(b.context,d,f),!0;case 4:return b.fn.call(b.context,d,f,h),!0;case 5:return b.fn.call(b.context,d,f,h,g),!0;case 6:return b.fn.call(b.context,d,f,h,g,v),!0}for(_=1,y=new Array(x-1);_<x;_++)y[_-1]=arguments[_];b.fn.apply(b.context,y)}else{var j=b.length,S;for(_=0;_<j;_++)switch(b[_].once&&this.removeListener(u,b[_].fn,void 0,!0),x){case 1:b[_].fn.call(b[_].context);break;case 2:b[_].fn.call(b[_].context,d);break;case 3:b[_].fn.call(b[_].context,d,f);break;case 4:b[_].fn.call(b[_].context,d,f,h);break;default:if(!y)for(S=1,y=new Array(x-1);S<x;S++)y[S-1]=arguments[S];b[_].fn.apply(b[_].context,y)}}return!0},s.prototype.on=function(u,d,f){return i(this,u,d,f,!1)},s.prototype.once=function(u,d,f){return i(this,u,d,f,!0)},s.prototype.removeListener=function(u,d,f,h){var g=r?r+u:u;if(!this._events[g])return this;if(!d)return o(this,g),this;var v=this._events[g];if(v.fn)v.fn===d&&(!h||v.once)&&(!f||v.context===f)&&o(this,g);else{for(var w=0,b=[],x=v.length;w<x;w++)(v[w].fn!==d||h&&!v[w].once||f&&v[w].context!==f)&&b.push(v[w]);b.length?this._events[g]=b.length===1?b[0]:b:o(this,g)}return this},s.prototype.removeAllListeners=function(u){var d;return u?(d=r?r+u:u,this._events[d]&&o(this,d)):(this._events=new n,this._eventsCount=0),this},s.prototype.off=s.prototype.removeListener,s.prototype.addListener=s.prototype.on,s.prefixed=r,s.EventEmitter=s,e.exports=s})(MO);var Fae=MO.exports;const Uae=dn(Fae);var dx=new Uae,fx="recharts.syncMouseEvents";function M0(e){"@babel/helpers - typeof";return M0=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},M0(e)}function Gae(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function zae(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,NO(n.key),n)}}function Wae(e,t,r){return t&&zae(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function hx(e,t,r){return t=NO(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function NO(e){var t=Vae(e,"string");return M0(t)=="symbol"?t:t+""}function Vae(e,t){if(M0(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(M0(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var Hae=function(){function e(){Gae(this,e),hx(this,"activeIndex",0),hx(this,"coordinateList",[]),hx(this,"layout","horizontal")}return Wae(e,[{key:"setDetails",value:function(r){var n,a=r.coordinateList,i=a===void 0?null:a,o=r.container,s=o===void 0?null:o,l=r.layout,u=l===void 0?null:l,d=r.offset,f=d===void 0?null:d,h=r.mouseHandlerCallback,g=h===void 0?null:h;this.coordinateList=(n=i??this.coordinateList)!==null&&n!==void 0?n:[],this.container=s??this.container,this.layout=u??this.layout,this.offset=f??this.offset,this.mouseHandlerCallback=g??this.mouseHandlerCallback,this.activeIndex=Math.min(Math.max(this.activeIndex,0),this.coordinateList.length-1)}},{key:"focus",value:function(){this.spoofMouse()}},{key:"keyboardEvent",value:function(r){if(this.coordinateList.length!==0)switch(r.key){case"ArrowRight":{if(this.layout!=="horizontal")return;this.activeIndex=Math.min(this.activeIndex+1,this.coordinateList.length-1),this.spoofMouse();break}case"ArrowLeft":{if(this.layout!=="horizontal")return;this.activeIndex=Math.max(this.activeIndex-1,0),this.spoofMouse();break}}}},{key:"setIndex",value:function(r){this.activeIndex=r}},{key:"spoofMouse",value:function(){var r,n;if(this.layout==="horizontal"&&this.coordinateList.length!==0){var a=this.container.getBoundingClientRect(),i=a.x,o=a.y,s=a.height,l=this.coordinateList[this.activeIndex].coordinate,u=((r=window)===null||r===void 0?void 0:r.scrollX)||0,d=((n=window)===null||n===void 0?void 0:n.scrollY)||0,f=i+l+u,h=o+this.offset.top+s/2+d;this.mouseHandlerCallback({pageX:f,pageY:h})}}}])}();function Xae(e,t,r){if(r==="number"&&t===!0&&Array.isArray(e)){var n=e==null?void 0:e[0],a=e==null?void 0:e[1];if(n&&a&&We(n)&&We(a))return!0}return!1}function Kae(e,t,r,n){var a=n/2;return{stroke:"none",fill:"#ccc",x:e==="horizontal"?t.x-a:r.left+.5,y:e==="horizontal"?r.top+.5:t.y-a,width:e==="horizontal"?n:r.width-1,height:e==="horizontal"?r.height-1:n}}function OO(e){var t=e.cx,r=e.cy,n=e.radius,a=e.startAngle,i=e.endAngle,o=_a(t,r,n,a),s=_a(t,r,n,i);return{points:[o,s],cx:t,cy:r,radius:n,startAngle:a,endAngle:i}}function Yae(e,t,r){var n,a,i,o;if(e==="horizontal")n=t.x,i=n,a=r.top,o=r.top+r.height;else if(e==="vertical")a=t.y,o=a,n=r.left,i=r.left+r.width;else if(t.cx!=null&&t.cy!=null)if(e==="centric"){var s=t.cx,l=t.cy,u=t.innerRadius,d=t.outerRadius,f=t.angle,h=_a(s,l,u,f),g=_a(s,l,d,f);n=h.x,a=h.y,i=g.x,o=g.y}else return OO(t);return[{x:n,y:a},{x:i,y:o}]}function N0(e){"@babel/helpers - typeof";return N0=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},N0(e)}function V4(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Eh(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?V4(Object(r),!0).forEach(function(n){qae(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):V4(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function qae(e,t,r){return t=Zae(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Zae(e){var t=Jae(e,"string");return N0(t)=="symbol"?t:t+""}function Jae(e,t){if(N0(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(N0(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Qae(e){var t,r,n=e.element,a=e.tooltipEventType,i=e.isActive,o=e.activeCoordinate,s=e.activePayload,l=e.offset,u=e.activeTooltipIndex,d=e.tooltipAxisBandSize,f=e.layout,h=e.chartName,g=(t=n.props.cursor)!==null&&t!==void 0?t:(r=n.type.defaultProps)===null||r===void 0?void 0:r.cursor;if(!n||!g||!i||!o||h!=="ScatterChart"&&a!=="axis")return null;var v,w=Ql;if(h==="ScatterChart")v=o,w=jQ;else if(h==="BarChart")v=Kae(f,o,l,d),w=rw;else if(f==="radial"){var b=OO(o),x=b.cx,y=b.cy,_=b.radius,j=b.startAngle,S=b.endAngle;v={cx:x,cy:y,startAngle:j,endAngle:S,innerRadius:_,outerRadius:_},w=jN}else v={points:Yae(f,o,l)},w=Ql;var k=Eh(Eh(Eh(Eh({stroke:"#ccc",pointerEvents:"none"},l),v),er(g,!1)),{},{payload:s,payloadIndex:u,className:Nr("recharts-tooltip-cursor",g.className)});return P.isValidElement(g)?P.cloneElement(g,k):P.createElement(w,k)}var eie=["item"],tie=["children","className","width","height","style","compact","title","desc"];function Zu(e){"@babel/helpers - typeof";return Zu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Zu(e)}function au(){return au=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},au.apply(this,arguments)}function H4(e,t){return aie(e)||nie(e,t)||EO(e,t)||rie()}function rie(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function nie(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,a,i,o,s=[],l=!0,u=!1;try{if(i=(r=r.call(e)).next,t!==0)for(;!(l=(n=i.call(r)).done)&&(s.push(n.value),s.length!==t);l=!0);}catch(d){u=!0,a=d}finally{try{if(!l&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(u)throw a}}return s}}function aie(e){if(Array.isArray(e))return e}function X4(e,t){if(e==null)return{};var r=iie(e,t),n,a;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function iie(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function oie(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function sie(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,TO(n.key),n)}}function lie(e,t,r){return t&&sie(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function cie(e,t,r){return t=Ag(t),uie(e,AO()?Reflect.construct(t,r||[],Ag(e).constructor):t.apply(e,r))}function uie(e,t){if(t&&(Zu(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return die(e)}function die(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function AO(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(AO=function(){return!!e})()}function Ag(e){return Ag=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Ag(e)}function fie(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&H1(e,t)}function H1(e,t){return H1=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},H1(e,t)}function Ju(e){return gie(e)||pie(e)||EO(e)||hie()}function hie(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function EO(e,t){if(e){if(typeof e=="string")return X1(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return X1(e,t)}}function pie(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function gie(e){if(Array.isArray(e))return X1(e)}function X1(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function K4(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function je(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?K4(Object(r),!0).forEach(function(n){Rt(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):K4(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Rt(e,t,r){return t=TO(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function TO(e){var t=mie(e,"string");return Zu(t)=="symbol"?t:t+""}function mie(e,t){if(Zu(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(Zu(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var yie={xAxis:["bottom","top"],yAxis:["left","right"]},xie={width:"100%",height:"100%"},IO={x:0,y:0};function Th(e){return e}var vie=function(t,r){return r==="horizontal"?t.x:r==="vertical"?t.y:r==="centric"?t.angle:t.radius},bie=function(t,r,n,a){var i=r.find(function(d){return d&&d.index===n});if(i){if(t==="horizontal")return{x:i.coordinate,y:a.y};if(t==="vertical")return{x:a.x,y:i.coordinate};if(t==="centric"){var o=i.coordinate,s=a.radius;return je(je(je({},a),_a(a.cx,a.cy,s,o)),{},{angle:o,radius:s})}var l=i.coordinate,u=a.angle;return je(je(je({},a),_a(a.cx,a.cy,l,u)),{},{angle:u,radius:l})}return IO},Um=function(t,r){var n=r.graphicalItems,a=r.dataStartIndex,i=r.dataEndIndex,o=(n??[]).reduce(function(s,l){var u=l.props.data;return u&&u.length?[].concat(Ju(s),Ju(u)):s},[]);return o.length>0?o:t&&t.length&&We(a)&&We(i)?t.slice(a,i+1):[]};function RO(e){return e==="number"?[0,"auto"]:void 0}var K1=function(t,r,n,a){var i=t.graphicalItems,o=t.tooltipAxis,s=Um(r,t);return n<0||!i||!i.length||n>=s.length?null:i.reduce(function(l,u){var d,f=(d=u.props.data)!==null&&d!==void 0?d:r;f&&t.dataStartIndex+t.dataEndIndex!==0&&t.dataEndIndex-t.dataStartIndex>=n&&(f=f.slice(t.dataStartIndex,t.dataEndIndex+1));var h;if(o.dataKey&&!o.allowDuplicatedCategory){var g=f===void 0?s:f;h=Np(g,o.dataKey,a)}else h=f&&f[n]||s[n];return h?[].concat(Ju(l),[kN(u,h)]):l},[])},Y4=function(t,r,n,a){var i=a||{x:t.chartX,y:t.chartY},o=vie(i,n),s=t.orderedTooltipTicks,l=t.tooltipAxis,u=t.tooltipTicks,d=nq(o,s,u,l);if(d>=0&&u){var f=u[d]&&u[d].value,h=K1(t,r,d,f),g=bie(n,s,d,i);return{activeTooltipIndex:d,activeLabel:f,activePayload:h,activeCoordinate:g}}return null},wie=function(t,r){var n=r.axes,a=r.graphicalItems,i=r.axisType,o=r.axisIdKey,s=r.stackGroups,l=r.dataStartIndex,u=r.dataEndIndex,d=t.layout,f=t.children,h=t.stackOffset,g=vN(d,i);return n.reduce(function(v,w){var b,x=w.type.defaultProps!==void 0?je(je({},w.type.defaultProps),w.props):w.props,y=x.type,_=x.dataKey,j=x.allowDataOverflow,S=x.allowDuplicatedCategory,k=x.scale,M=x.ticks,N=x.includeHidden,T=x[o];if(v[T])return v;var A=Um(t.data,{graphicalItems:a.filter(function(q){var te,ie=o in q.props?q.props[o]:(te=q.type.defaultProps)===null||te===void 0?void 0:te[o];return ie===T}),dataStartIndex:l,dataEndIndex:u}),D=A.length,$,B,J;Xae(x.domain,j,y)&&($=l1(x.domain,null,j),g&&(y==="number"||k!=="auto")&&(J=_f(A,_,"category")));var W=RO(y);if(!$||$.length===0){var I,G=(I=x.domain)!==null&&I!==void 0?I:W;if(_){if($=_f(A,_,y),y==="category"&&g){var U=WD($);S&&U?(B=$,$=gg(0,D)):S||($=P5(G,$,w).reduce(function(q,te){return q.indexOf(te)>=0?q:[].concat(Ju(q),[te])},[]))}else if(y==="category")S?$=$.filter(function(q){return q!==""&&!qt(q)}):$=P5(G,$,w).reduce(function(q,te){return q.indexOf(te)>=0||te===""||qt(te)?q:[].concat(Ju(q),[te])},[]);else if(y==="number"){var X=lq(A,a.filter(function(q){var te,ie,he=o in q.props?q.props[o]:(te=q.type.defaultProps)===null||te===void 0?void 0:te[o],ee="hide"in q.props?q.props.hide:(ie=q.type.defaultProps)===null||ie===void 0?void 0:ie.hide;return he===T&&(N||!ee)}),_,i,d);X&&($=X)}g&&(y==="number"||k!=="auto")&&(J=_f(A,_,"category"))}else g?$=gg(0,D):s&&s[T]&&s[T].hasStack&&y==="number"?$=h==="expand"?[0,1]:wN(s[T].stackGroups,l,u):$=xN(A,a.filter(function(q){var te=o in q.props?q.props[o]:q.type.defaultProps[o],ie="hide"in q.props?q.props.hide:q.type.defaultProps.hide;return te===T&&(N||!ie)}),y,d,!0);if(y==="number")$=V1(f,$,T,i,M),G&&($=l1(G,$,j));else if(y==="category"&&G){var V=G,z=$.every(function(q){return V.indexOf(q)>=0});z&&($=V)}}return je(je({},v),{},Rt({},T,je(je({},x),{},{axisType:i,domain:$,categoricalDomain:J,duplicateDomain:B,originalDomain:(b=x.domain)!==null&&b!==void 0?b:W,isCategorical:g,layout:d})))},{})},kie=function(t,r){var n=r.graphicalItems,a=r.Axis,i=r.axisType,o=r.axisIdKey,s=r.stackGroups,l=r.dataStartIndex,u=r.dataEndIndex,d=t.layout,f=t.children,h=Um(t.data,{graphicalItems:n,dataStartIndex:l,dataEndIndex:u}),g=h.length,v=vN(d,i),w=-1;return n.reduce(function(b,x){var y=x.type.defaultProps!==void 0?je(je({},x.type.defaultProps),x.props):x.props,_=y[o],j=RO("number");if(!b[_]){w++;var S;return v?S=gg(0,g):s&&s[_]&&s[_].hasStack?(S=wN(s[_].stackGroups,l,u),S=V1(f,S,_,i)):(S=l1(j,xN(h,n.filter(function(k){var M,N,T=o in k.props?k.props[o]:(M=k.type.defaultProps)===null||M===void 0?void 0:M[o],A="hide"in k.props?k.props.hide:(N=k.type.defaultProps)===null||N===void 0?void 0:N.hide;return T===_&&!A}),"number",d),a.defaultProps.allowDataOverflow),S=V1(f,S,_,i)),je(je({},b),{},Rt({},_,je(je({axisType:i},a.defaultProps),{},{hide:!0,orientation:Wi(yie,"".concat(i,".").concat(w%2),null),domain:S,originalDomain:j,isCategorical:v,layout:d})))}return b},{})},Sie=function(t,r){var n=r.axisType,a=n===void 0?"xAxis":n,i=r.AxisComp,o=r.graphicalItems,s=r.stackGroups,l=r.dataStartIndex,u=r.dataEndIndex,d=t.children,f="".concat(a,"Id"),h=pi(d,i),g={};return h&&h.length?g=wie(t,{axes:h,graphicalItems:o,axisType:a,axisIdKey:f,stackGroups:s,dataStartIndex:l,dataEndIndex:u}):o&&o.length&&(g=kie(t,{Axis:i,graphicalItems:o,axisType:a,axisIdKey:f,stackGroups:s,dataStartIndex:l,dataEndIndex:u})),g},_ie=function(t){var r=Vs(t),n=as(r,!1,!0);return{tooltipTicks:n,orderedTooltipTicks:M2(n,function(a){return a.coordinate}),tooltipAxis:r,tooltipAxisBandSize:ig(r,n)}},q4=function(t){var r=t.children,n=t.defaultShowTooltip,a=Si(r,Bu),i=0,o=0;return t.data&&t.data.length!==0&&(o=t.data.length-1),a&&a.props&&(a.props.startIndex>=0&&(i=a.props.startIndex),a.props.endIndex>=0&&(o=a.props.endIndex)),{chartX:0,chartY:0,dataStartIndex:i,dataEndIndex:o,activeTooltipIndex:-1,isTooltipActive:!!n}},jie=function(t){return!t||!t.length?!1:t.some(function(r){var n=os(r&&r.type);return n&&n.indexOf("Bar")>=0})},Z4=function(t){return t==="horizontal"?{numericAxisName:"yAxis",cateAxisName:"xAxis"}:t==="vertical"?{numericAxisName:"xAxis",cateAxisName:"yAxis"}:t==="centric"?{numericAxisName:"radiusAxis",cateAxisName:"angleAxis"}:{numericAxisName:"angleAxis",cateAxisName:"radiusAxis"}},Pie=function(t,r){var n=t.props,a=t.graphicalItems,i=t.xAxisMap,o=i===void 0?{}:i,s=t.yAxisMap,l=s===void 0?{}:s,u=n.width,d=n.height,f=n.children,h=n.margin||{},g=Si(f,Bu),v=Si(f,Do),w=Object.keys(l).reduce(function(S,k){var M=l[k],N=M.orientation;return!M.mirror&&!M.hide?je(je({},S),{},Rt({},N,S[N]+M.width)):S},{left:h.left||0,right:h.right||0}),b=Object.keys(o).reduce(function(S,k){var M=o[k],N=M.orientation;return!M.mirror&&!M.hide?je(je({},S),{},Rt({},N,Wi(S,"".concat(N))+M.height)):S},{top:h.top||0,bottom:h.bottom||0}),x=je(je({},b),w),y=x.bottom;g&&(x.bottom+=g.props.height||Bu.defaultProps.height),v&&r&&(x=oq(x,a,n,r));var _=u-x.left-x.right,j=d-x.top-x.bottom;return je(je({brushBottom:y},x),{},{width:Math.max(_,0),height:Math.max(j,0)})},Cie=function(t,r){if(r==="xAxis")return t[r].width;if(r==="yAxis")return t[r].height},fw=function(t){var r=t.chartName,n=t.GraphicalChild,a=t.defaultTooltipEventType,i=a===void 0?"axis":a,o=t.validateTooltipEventTypes,s=o===void 0?["axis"]:o,l=t.axisComponents,u=t.legendContent,d=t.formatAxisMap,f=t.defaultProps,h=function(x,y){var _=y.graphicalItems,j=y.stackGroups,S=y.offset,k=y.updateId,M=y.dataStartIndex,N=y.dataEndIndex,T=x.barSize,A=x.layout,D=x.barGap,$=x.barCategoryGap,B=x.maxBarSize,J=Z4(A),W=J.numericAxisName,I=J.cateAxisName,G=jie(_),U=[];return _.forEach(function(X,V){var z=Um(x.data,{graphicalItems:[X],dataStartIndex:M,dataEndIndex:N}),q=X.type.defaultProps!==void 0?je(je({},X.type.defaultProps),X.props):X.props,te=q.dataKey,ie=q.maxBarSize,he=q["".concat(W,"Id")],ee=q["".concat(I,"Id")],Le={},fe=l.reduce(function(se,Xe){var ht=y["".concat(Xe.axisType,"Map")],Zt=q["".concat(Xe.axisType,"Id")];ht&&ht[Zt]||Xe.axisType==="zAxis"||yc();var Jt=ht[Zt];return je(je({},se),{},Rt(Rt({},Xe.axisType,Jt),"".concat(Xe.axisType,"Ticks"),as(Jt)))},Le),ce=fe[I],de=fe["".concat(I,"Ticks")],Ne=j&&j[he]&&j[he].hasStack&&bq(X,j[he].stackGroups),pe=os(X.type).indexOf("Bar")>=0,ke=ig(ce,de),me=[],Be=G&&aq({barSize:T,stackGroups:j,totalSize:Cie(fe,I)});if(pe){var Se,we,Re=qt(ie)?B:ie,it=(Se=(we=ig(ce,de,!0))!==null&&we!==void 0?we:Re)!==null&&Se!==void 0?Se:0;me=iq({barGap:D,barCategoryGap:$,bandSize:it!==ke?it:ke,sizeList:Be[ee],maxBarSize:Re}),it!==ke&&(me=me.map(function(se){return je(je({},se),{},{position:je(je({},se.position),{},{offset:se.position.offset-it/2})})}))}var Qe=X&&X.type&&X.type.getComposedData;Qe&&U.push({props:je(je({},Qe(je(je({},fe),{},{displayedData:z,props:x,dataKey:te,item:X,bandSize:ke,barPosition:me,offset:S,stackedData:Ne,layout:A,dataStartIndex:M,dataEndIndex:N}))),{},Rt(Rt(Rt({key:X.key||"item-".concat(V)},W,fe[W]),I,fe[I]),"animationId",k)),childIndex:n$(X,x.children),item:X})}),U},g=function(x,y){var _=x.props,j=x.dataStartIndex,S=x.dataEndIndex,k=x.updateId;if(!bS({props:_}))return null;var M=_.children,N=_.layout,T=_.stackOffset,A=_.data,D=_.reverseStackOrder,$=Z4(N),B=$.numericAxisName,J=$.cateAxisName,W=pi(M,n),I=yq(A,W,"".concat(B,"Id"),"".concat(J,"Id"),T,D),G=l.reduce(function(q,te){var ie="".concat(te.axisType,"Map");return je(je({},q),{},Rt({},ie,Sie(_,je(je({},te),{},{graphicalItems:W,stackGroups:te.axisType===B&&I,dataStartIndex:j,dataEndIndex:S}))))},{}),U=Pie(je(je({},G),{},{props:_,graphicalItems:W}),y==null?void 0:y.legendBBox);Object.keys(G).forEach(function(q){G[q]=d(_,G[q],U,q.replace("Map",""),r)});var X=G["".concat(J,"Map")],V=_ie(X),z=h(_,je(je({},G),{},{dataStartIndex:j,dataEndIndex:S,updateId:k,graphicalItems:W,stackGroups:I,offset:U}));return je(je({formattedGraphicalItems:z,graphicalItems:W,offset:U,stackGroups:I},V),G)},v=function(b){function x(y){var _,j,S;return oie(this,x),S=cie(this,x,[y]),Rt(S,"eventEmitterSymbol",Symbol("rechartsEventEmitter")),Rt(S,"accessibilityManager",new Hae),Rt(S,"handleLegendBBoxUpdate",function(k){if(k){var M=S.state,N=M.dataStartIndex,T=M.dataEndIndex,A=M.updateId;S.setState(je({legendBBox:k},g({props:S.props,dataStartIndex:N,dataEndIndex:T,updateId:A},je(je({},S.state),{},{legendBBox:k}))))}}),Rt(S,"handleReceiveSyncEvent",function(k,M,N){if(S.props.syncId===k){if(N===S.eventEmitterSymbol&&typeof S.props.syncMethod!="function")return;S.applySyncEvent(M)}}),Rt(S,"handleBrushChange",function(k){var M=k.startIndex,N=k.endIndex;if(M!==S.state.dataStartIndex||N!==S.state.dataEndIndex){var T=S.state.updateId;S.setState(function(){return je({dataStartIndex:M,dataEndIndex:N},g({props:S.props,dataStartIndex:M,dataEndIndex:N,updateId:T},S.state))}),S.triggerSyncEvent({dataStartIndex:M,dataEndIndex:N})}}),Rt(S,"handleMouseEnter",function(k){var M=S.getMouseInfo(k);if(M){var N=je(je({},M),{},{isTooltipActive:!0});S.setState(N),S.triggerSyncEvent(N);var T=S.props.onMouseEnter;ar(T)&&T(N,k)}}),Rt(S,"triggeredAfterMouseMove",function(k){var M=S.getMouseInfo(k),N=M?je(je({},M),{},{isTooltipActive:!0}):{isTooltipActive:!1};S.setState(N),S.triggerSyncEvent(N);var T=S.props.onMouseMove;ar(T)&&T(N,k)}),Rt(S,"handleItemMouseEnter",function(k){S.setState(function(){return{isTooltipActive:!0,activeItem:k,activePayload:k.tooltipPayload,activeCoordinate:k.tooltipPosition||{x:k.cx,y:k.cy}}})}),Rt(S,"handleItemMouseLeave",function(){S.setState(function(){return{isTooltipActive:!1}})}),Rt(S,"handleMouseMove",function(k){k.persist(),S.throttleTriggeredAfterMouseMove(k)}),Rt(S,"handleMouseLeave",function(k){S.throttleTriggeredAfterMouseMove.cancel();var M={isTooltipActive:!1};S.setState(M),S.triggerSyncEvent(M);var N=S.props.onMouseLeave;ar(N)&&N(M,k)}),Rt(S,"handleOuterEvent",function(k){var M=r$(k),N=Wi(S.props,"".concat(M));if(M&&ar(N)){var T,A;/.*touch.*/i.test(M)?A=S.getMouseInfo(k.changedTouches[0]):A=S.getMouseInfo(k),N((T=A)!==null&&T!==void 0?T:{},k)}}),Rt(S,"handleClick",function(k){var M=S.getMouseInfo(k);if(M){var N=je(je({},M),{},{isTooltipActive:!0});S.setState(N),S.triggerSyncEvent(N);var T=S.props.onClick;ar(T)&&T(N,k)}}),Rt(S,"handleMouseDown",function(k){var M=S.props.onMouseDown;if(ar(M)){var N=S.getMouseInfo(k);M(N,k)}}),Rt(S,"handleMouseUp",function(k){var M=S.props.onMouseUp;if(ar(M)){var N=S.getMouseInfo(k);M(N,k)}}),Rt(S,"handleTouchMove",function(k){k.changedTouches!=null&&k.changedTouches.length>0&&S.throttleTriggeredAfterMouseMove(k.changedTouches[0])}),Rt(S,"handleTouchStart",function(k){k.changedTouches!=null&&k.changedTouches.length>0&&S.handleMouseDown(k.changedTouches[0])}),Rt(S,"handleTouchEnd",function(k){k.changedTouches!=null&&k.changedTouches.length>0&&S.handleMouseUp(k.changedTouches[0])}),Rt(S,"handleDoubleClick",function(k){var M=S.props.onDoubleClick;if(ar(M)){var N=S.getMouseInfo(k);M(N,k)}}),Rt(S,"handleContextMenu",function(k){var M=S.props.onContextMenu;if(ar(M)){var N=S.getMouseInfo(k);M(N,k)}}),Rt(S,"triggerSyncEvent",function(k){S.props.syncId!==void 0&&dx.emit(fx,S.props.syncId,k,S.eventEmitterSymbol)}),Rt(S,"applySyncEvent",function(k){var M=S.props,N=M.layout,T=M.syncMethod,A=S.state.updateId,D=k.dataStartIndex,$=k.dataEndIndex;if(k.dataStartIndex!==void 0||k.dataEndIndex!==void 0)S.setState(je({dataStartIndex:D,dataEndIndex:$},g({props:S.props,dataStartIndex:D,dataEndIndex:$,updateId:A},S.state)));else if(k.activeTooltipIndex!==void 0){var B=k.chartX,J=k.chartY,W=k.activeTooltipIndex,I=S.state,G=I.offset,U=I.tooltipTicks;if(!G)return;if(typeof T=="function")W=T(U,k);else if(T==="value"){W=-1;for(var X=0;X<U.length;X++)if(U[X].value===k.activeLabel){W=X;break}}var V=je(je({},G),{},{x:G.left,y:G.top}),z=Math.min(B,V.x+V.width),q=Math.min(J,V.y+V.height),te=U[W]&&U[W].value,ie=K1(S.state,S.props.data,W),he=U[W]?{x:N==="horizontal"?U[W].coordinate:z,y:N==="horizontal"?q:U[W].coordinate}:IO;S.setState(je(je({},k),{},{activeLabel:te,activeCoordinate:he,activePayload:ie,activeTooltipIndex:W}))}else S.setState(k)}),Rt(S,"renderCursor",function(k){var M,N=S.state,T=N.isTooltipActive,A=N.activeCoordinate,D=N.activePayload,$=N.offset,B=N.activeTooltipIndex,J=N.tooltipAxisBandSize,W=S.getTooltipEventType(),I=(M=k.props.active)!==null&&M!==void 0?M:T,G=S.props.layout,U=k.key||"_recharts-cursor";return oe.createElement(Qae,{key:U,activeCoordinate:A,activePayload:D,activeTooltipIndex:B,chartName:r,element:k,isActive:I,layout:G,offset:$,tooltipAxisBandSize:J,tooltipEventType:W})}),Rt(S,"renderPolarAxis",function(k,M,N){var T=Wi(k,"type.axisType"),A=Wi(S.state,"".concat(T,"Map")),D=k.type.defaultProps,$=D!==void 0?je(je({},D),k.props):k.props,B=A&&A[$["".concat(T,"Id")]];return P.cloneElement(k,je(je({},B),{},{className:Nr(T,B.className),key:k.key||"".concat(M,"-").concat(N),ticks:as(B,!0)}))}),Rt(S,"renderPolarGrid",function(k){var M=k.props,N=M.radialLines,T=M.polarAngles,A=M.polarRadius,D=S.state,$=D.radiusAxisMap,B=D.angleAxisMap,J=Vs($),W=Vs(B),I=W.cx,G=W.cy,U=W.innerRadius,X=W.outerRadius;return P.cloneElement(k,{polarAngles:Array.isArray(T)?T:as(W,!0).map(function(V){return V.coordinate}),polarRadius:Array.isArray(A)?A:as(J,!0).map(function(V){return V.coordinate}),cx:I,cy:G,innerRadius:U,outerRadius:X,key:k.key||"polar-grid",radialLines:N})}),Rt(S,"renderLegend",function(){var k=S.state.formattedGraphicalItems,M=S.props,N=M.children,T=M.width,A=M.height,D=S.props.margin||{},$=T-(D.left||0)-(D.right||0),B=mN({children:N,formattedGraphicalItems:k,legendWidth:$,legendContent:u});if(!B)return null;var J=B.item,W=X4(B,eie);return P.cloneElement(J,je(je({},W),{},{chartWidth:T,chartHeight:A,margin:D,onBBoxUpdate:S.handleLegendBBoxUpdate}))}),Rt(S,"renderTooltip",function(){var k,M=S.props,N=M.children,T=M.accessibilityLayer,A=Si(N,aa);if(!A)return null;var D=S.state,$=D.isTooltipActive,B=D.activeCoordinate,J=D.activePayload,W=D.activeLabel,I=D.offset,G=(k=A.props.active)!==null&&k!==void 0?k:$;return P.cloneElement(A,{viewBox:je(je({},I),{},{x:I.left,y:I.top}),active:G,label:W,payload:G?J:[],coordinate:B,accessibilityLayer:T})}),Rt(S,"renderBrush",function(k){var M=S.props,N=M.margin,T=M.data,A=S.state,D=A.offset,$=A.dataStartIndex,B=A.dataEndIndex,J=A.updateId;return P.cloneElement(k,{key:k.key||"_recharts-brush",onChange:Mh(S.handleBrushChange,k.props.onChange),data:T,x:We(k.props.x)?k.props.x:D.left,y:We(k.props.y)?k.props.y:D.top+D.height+D.brushBottom-(N.bottom||0),width:We(k.props.width)?k.props.width:D.width,startIndex:$,endIndex:B,updateId:"brush-".concat(J)})}),Rt(S,"renderReferenceElement",function(k,M,N){if(!k)return null;var T=S,A=T.clipPathId,D=S.state,$=D.xAxisMap,B=D.yAxisMap,J=D.offset,W=k.type.defaultProps||{},I=k.props,G=I.xAxisId,U=G===void 0?W.xAxisId:G,X=I.yAxisId,V=X===void 0?W.yAxisId:X;return P.cloneElement(k,{key:k.key||"".concat(M,"-").concat(N),xAxis:$[U],yAxis:B[V],viewBox:{x:J.left,y:J.top,width:J.width,height:J.height},clipPathId:A})}),Rt(S,"renderActivePoints",function(k){var M=k.item,N=k.activePoint,T=k.basePoint,A=k.childIndex,D=k.isRange,$=[],B=M.props.key,J=M.item.type.defaultProps!==void 0?je(je({},M.item.type.defaultProps),M.item.props):M.item.props,W=J.activeDot,I=J.dataKey,G=je(je({index:A,dataKey:I,cx:N.x,cy:N.y,r:4,fill:tw(M.item),strokeWidth:2,stroke:"#fff",payload:N.payload,value:N.value},er(W,!1)),Op(W));return $.push(x.renderActiveDot(W,G,"".concat(B,"-activePoint-").concat(A))),T?$.push(x.renderActiveDot(W,je(je({},G),{},{cx:T.x,cy:T.y}),"".concat(B,"-basePoint-").concat(A))):D&&$.push(null),$}),Rt(S,"renderGraphicChild",function(k,M,N){var T=S.filterFormatItem(k,M,N);if(!T)return null;var A=S.getTooltipEventType(),D=S.state,$=D.isTooltipActive,B=D.tooltipAxis,J=D.activeTooltipIndex,W=D.activeLabel,I=S.props.children,G=Si(I,aa),U=T.props,X=U.points,V=U.isRange,z=U.baseLine,q=T.item.type.defaultProps!==void 0?je(je({},T.item.type.defaultProps),T.item.props):T.item.props,te=q.activeDot,ie=q.hide,he=q.activeBar,ee=q.activeShape,Le=!!(!ie&&$&&G&&(te||he||ee)),fe={};A!=="axis"&&G&&G.props.trigger==="click"?fe={onClick:Mh(S.handleItemMouseEnter,k.props.onClick)}:A!=="axis"&&(fe={onMouseLeave:Mh(S.handleItemMouseLeave,k.props.onMouseLeave),onMouseEnter:Mh(S.handleItemMouseEnter,k.props.onMouseEnter)});var ce=P.cloneElement(k,je(je({},T.props),fe));function de(Xe){return typeof B.dataKey=="function"?B.dataKey(Xe.payload):null}if(Le)if(J>=0){var Ne,pe;if(B.dataKey&&!B.allowDuplicatedCategory){var ke=typeof B.dataKey=="function"?de:"payload.".concat(B.dataKey.toString());Ne=Np(X,ke,W),pe=V&&z&&Np(z,ke,W)}else Ne=X==null?void 0:X[J],pe=V&&z&&z[J];if(ee||he){var me=k.props.activeIndex!==void 0?k.props.activeIndex:J;return[P.cloneElement(k,je(je(je({},T.props),fe),{},{activeIndex:me})),null,null]}if(!qt(Ne))return[ce].concat(Ju(S.renderActivePoints({item:T,activePoint:Ne,basePoint:pe,childIndex:J,isRange:V})))}else{var Be,Se=(Be=S.getItemByXY(S.state.activeCoordinate))!==null&&Be!==void 0?Be:{graphicalItem:ce},we=Se.graphicalItem,Re=we.item,it=Re===void 0?k:Re,Qe=we.childIndex,se=je(je(je({},T.props),fe),{},{activeIndex:Qe});return[P.cloneElement(it,se),null,null]}return V?[ce,null,null]:[ce,null]}),Rt(S,"renderCustomized",function(k,M,N){return P.cloneElement(k,je(je({key:"recharts-customized-".concat(N)},S.props),S.state))}),Rt(S,"renderMap",{CartesianGrid:{handler:Th,once:!0},ReferenceArea:{handler:S.renderReferenceElement},ReferenceLine:{handler:Th},ReferenceDot:{handler:S.renderReferenceElement},XAxis:{handler:Th},YAxis:{handler:Th},Brush:{handler:S.renderBrush,once:!0},Bar:{handler:S.renderGraphicChild},Line:{handler:S.renderGraphicChild},Area:{handler:S.renderGraphicChild},Radar:{handler:S.renderGraphicChild},RadialBar:{handler:S.renderGraphicChild},Scatter:{handler:S.renderGraphicChild},Pie:{handler:S.renderGraphicChild},Funnel:{handler:S.renderGraphicChild},Tooltip:{handler:S.renderCursor,once:!0},PolarGrid:{handler:S.renderPolarGrid,once:!0},PolarAngleAxis:{handler:S.renderPolarAxis},PolarRadiusAxis:{handler:S.renderPolarAxis},Customized:{handler:S.renderCustomized}}),S.clipPathId="".concat((_=y.id)!==null&&_!==void 0?_:Sc("recharts"),"-clip"),S.throttleTriggeredAfterMouseMove=yM(S.triggeredAfterMouseMove,(j=y.throttleDelay)!==null&&j!==void 0?j:1e3/60),S.state={},S}return fie(x,b),lie(x,[{key:"componentDidMount",value:function(){var _,j;this.addListener(),this.accessibilityManager.setDetails({container:this.container,offset:{left:(_=this.props.margin.left)!==null&&_!==void 0?_:0,top:(j=this.props.margin.top)!==null&&j!==void 0?j:0},coordinateList:this.state.tooltipTicks,mouseHandlerCallback:this.triggeredAfterMouseMove,layout:this.props.layout}),this.displayDefaultTooltip()}},{key:"displayDefaultTooltip",value:function(){var _=this.props,j=_.children,S=_.data,k=_.height,M=_.layout,N=Si(j,aa);if(N){var T=N.props.defaultIndex;if(!(typeof T!="number"||T<0||T>this.state.tooltipTicks.length-1)){var A=this.state.tooltipTicks[T]&&this.state.tooltipTicks[T].value,D=K1(this.state,S,T,A),$=this.state.tooltipTicks[T].coordinate,B=(this.state.offset.top+k)/2,J=M==="horizontal",W=J?{x:$,y:B}:{y:$,x:B},I=this.state.formattedGraphicalItems.find(function(U){var X=U.item;return X.type.name==="Scatter"});I&&(W=je(je({},W),I.props.points[T].tooltipPosition),D=I.props.points[T].tooltipPayload);var G={activeTooltipIndex:T,isTooltipActive:!0,activeLabel:A,activePayload:D,activeCoordinate:W};this.setState(G),this.renderCursor(N),this.accessibilityManager.setIndex(T)}}}},{key:"getSnapshotBeforeUpdate",value:function(_,j){if(!this.props.accessibilityLayer)return null;if(this.state.tooltipTicks!==j.tooltipTicks&&this.accessibilityManager.setDetails({coordinateList:this.state.tooltipTicks}),this.props.layout!==_.layout&&this.accessibilityManager.setDetails({layout:this.props.layout}),this.props.margin!==_.margin){var S,k;this.accessibilityManager.setDetails({offset:{left:(S=this.props.margin.left)!==null&&S!==void 0?S:0,top:(k=this.props.margin.top)!==null&&k!==void 0?k:0}})}return null}},{key:"componentDidUpdate",value:function(_){Sv([Si(_.children,aa)],[Si(this.props.children,aa)])||this.displayDefaultTooltip()}},{key:"componentWillUnmount",value:function(){this.removeListener(),this.throttleTriggeredAfterMouseMove.cancel()}},{key:"getTooltipEventType",value:function(){var _=Si(this.props.children,aa);if(_&&typeof _.props.shared=="boolean"){var j=_.props.shared?"axis":"item";return s.indexOf(j)>=0?j:i}return i}},{key:"getMouseInfo",value:function(_){if(!this.container)return null;var j=this.container,S=j.getBoundingClientRect(),k=NV(S),M={chartX:Math.round(_.pageX-k.left),chartY:Math.round(_.pageY-k.top)},N=S.width/j.offsetWidth||1,T=this.inRange(M.chartX,M.chartY,N);if(!T)return null;var A=this.state,D=A.xAxisMap,$=A.yAxisMap,B=this.getTooltipEventType(),J=Y4(this.state,this.props.data,this.props.layout,T);if(B!=="axis"&&D&&$){var W=Vs(D).scale,I=Vs($).scale,G=W&&W.invert?W.invert(M.chartX):null,U=I&&I.invert?I.invert(M.chartY):null;return je(je({},M),{},{xValue:G,yValue:U},J)}return J?je(je({},M),J):null}},{key:"inRange",value:function(_,j){var S=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1,k=this.props.layout,M=_/S,N=j/S;if(k==="horizontal"||k==="vertical"){var T=this.state.offset,A=M>=T.left&&M<=T.left+T.width&&N>=T.top&&N<=T.top+T.height;return A?{x:M,y:N}:null}var D=this.state,$=D.angleAxisMap,B=D.radiusAxisMap;if($&&B){var J=Vs($);return N5({x:M,y:N},J)}return null}},{key:"parseEventsOfWrapper",value:function(){var _=this.props.children,j=this.getTooltipEventType(),S=Si(_,aa),k={};S&&j==="axis"&&(S.props.trigger==="click"?k={onClick:this.handleClick}:k={onMouseEnter:this.handleMouseEnter,onDoubleClick:this.handleDoubleClick,onMouseMove:this.handleMouseMove,onMouseLeave:this.handleMouseLeave,onTouchMove:this.handleTouchMove,onTouchStart:this.handleTouchStart,onTouchEnd:this.handleTouchEnd,onContextMenu:this.handleContextMenu});var M=Op(this.props,this.handleOuterEvent);return je(je({},M),k)}},{key:"addListener",value:function(){dx.on(fx,this.handleReceiveSyncEvent)}},{key:"removeListener",value:function(){dx.removeListener(fx,this.handleReceiveSyncEvent)}},{key:"filterFormatItem",value:function(_,j,S){for(var k=this.state.formattedGraphicalItems,M=0,N=k.length;M<N;M++){var T=k[M];if(T.item===_||T.props.key===_.key||j===os(T.item.type)&&S===T.childIndex)return T}return null}},{key:"renderClipPath",value:function(){var _=this.clipPathId,j=this.state.offset,S=j.left,k=j.top,M=j.height,N=j.width;return oe.createElement("defs",null,oe.createElement("clipPath",{id:_},oe.createElement("rect",{x:S,y:k,height:M,width:N})))}},{key:"getXScales",value:function(){var _=this.state.xAxisMap;return _?Object.entries(_).reduce(function(j,S){var k=H4(S,2),M=k[0],N=k[1];return je(je({},j),{},Rt({},M,N.scale))},{}):null}},{key:"getYScales",value:function(){var _=this.state.yAxisMap;return _?Object.entries(_).reduce(function(j,S){var k=H4(S,2),M=k[0],N=k[1];return je(je({},j),{},Rt({},M,N.scale))},{}):null}},{key:"getXScaleByAxisId",value:function(_){var j;return(j=this.state.xAxisMap)===null||j===void 0||(j=j[_])===null||j===void 0?void 0:j.scale}},{key:"getYScaleByAxisId",value:function(_){var j;return(j=this.state.yAxisMap)===null||j===void 0||(j=j[_])===null||j===void 0?void 0:j.scale}},{key:"getItemByXY",value:function(_){var j=this.state,S=j.formattedGraphicalItems,k=j.activeItem;if(S&&S.length)for(var M=0,N=S.length;M<N;M++){var T=S[M],A=T.props,D=T.item,$=D.type.defaultProps!==void 0?je(je({},D.type.defaultProps),D.props):D.props,B=os(D.type);if(B==="Bar"){var J=(A.data||[]).find(function(U){return gQ(_,U)});if(J)return{graphicalItem:T,payload:J}}else if(B==="RadialBar"){var W=(A.data||[]).find(function(U){return N5(_,U)});if(W)return{graphicalItem:T,payload:W}}else if(Rm(T,k)||Dm(T,k)||S0(T,k)){var I=yee({graphicalItem:T,activeTooltipItem:k,itemData:$.data}),G=$.activeIndex===void 0?I:$.activeIndex;return{graphicalItem:je(je({},T),{},{childIndex:G}),payload:S0(T,k)?$.data[I]:T.props.data[I]}}}return null}},{key:"render",value:function(){var _=this;if(!bS(this))return null;var j=this.props,S=j.children,k=j.className,M=j.width,N=j.height,T=j.style,A=j.compact,D=j.title,$=j.desc,B=X4(j,tie),J=er(B,!1);if(A)return oe.createElement(_4,{state:this.state,width:this.props.width,height:this.props.height,clipPathId:this.clipPathId},oe.createElement(jv,au({},J,{width:M,height:N,title:D,desc:$}),this.renderClipPath(),kS(S,this.renderMap)));if(this.props.accessibilityLayer){var W,I;J.tabIndex=(W=this.props.tabIndex)!==null&&W!==void 0?W:0,J.role=(I=this.props.role)!==null&&I!==void 0?I:"application",J.onKeyDown=function(U){_.accessibilityManager.keyboardEvent(U)},J.onFocus=function(){_.accessibilityManager.focus()}}var G=this.parseEventsOfWrapper();return oe.createElement(_4,{state:this.state,width:this.props.width,height:this.props.height,clipPathId:this.clipPathId},oe.createElement("div",au({className:Nr("recharts-wrapper",k),style:je({position:"relative",cursor:"default",width:M,height:N},T)},G,{ref:function(X){_.container=X}}),oe.createElement(jv,au({},J,{width:M,height:N,title:D,desc:$,style:xie}),this.renderClipPath(),kS(S,this.renderMap)),this.renderLegend(),this.renderTooltip()))}}])}(P.Component);Rt(v,"displayName",r),Rt(v,"defaultProps",je({layout:"horizontal",stackOffset:"none",barCategoryGap:"10%",barGap:4,margin:{top:5,right:5,bottom:5,left:5},reverseStackOrder:!1,syncMethod:"index"},f)),Rt(v,"getDerivedStateFromProps",function(b,x){var y=b.dataKey,_=b.data,j=b.children,S=b.width,k=b.height,M=b.layout,N=b.stackOffset,T=b.margin,A=x.dataStartIndex,D=x.dataEndIndex;if(x.updateId===void 0){var $=q4(b);return je(je(je({},$),{},{updateId:0},g(je(je({props:b},$),{},{updateId:0}),x)),{},{prevDataKey:y,prevData:_,prevWidth:S,prevHeight:k,prevLayout:M,prevStackOffset:N,prevMargin:T,prevChildren:j})}if(y!==x.prevDataKey||_!==x.prevData||S!==x.prevWidth||k!==x.prevHeight||M!==x.prevLayout||N!==x.prevStackOffset||!hu(T,x.prevMargin)){var B=q4(b),J={chartX:x.chartX,chartY:x.chartY,isTooltipActive:x.isTooltipActive},W=je(je({},Y4(x,_,M)),{},{updateId:x.updateId+1}),I=je(je(je({},B),J),W);return je(je(je({},I),g(je({props:b},I),x)),{},{prevDataKey:y,prevData:_,prevWidth:S,prevHeight:k,prevLayout:M,prevStackOffset:N,prevMargin:T,prevChildren:j})}if(!Sv(j,x.prevChildren)){var G,U,X,V,z=Si(j,Bu),q=z&&(G=(U=z.props)===null||U===void 0?void 0:U.startIndex)!==null&&G!==void 0?G:A,te=z&&(X=(V=z.props)===null||V===void 0?void 0:V.endIndex)!==null&&X!==void 0?X:D,ie=q!==A||te!==D,he=!qt(_),ee=he&&!ie?x.updateId:x.updateId+1;return je(je({updateId:ee},g(je(je({props:b},x),{},{updateId:ee,dataStartIndex:q,dataEndIndex:te}),x)),{},{prevChildren:j,dataStartIndex:q,dataEndIndex:te})}return null}),Rt(v,"renderActiveDot",function(b,x,y){var _;return P.isValidElement(b)?_=P.cloneElement(b,x):ar(b)?_=b(x):_=oe.createElement(Im,x),oe.createElement(Yr,{className:"recharts-active-dot",key:y},_)});var w=P.forwardRef(function(x,y){return oe.createElement(v,au({},x,{ref:y}))});return w.displayName=v.displayName,w},Kl=fw({chartName:"LineChart",GraphicalChild:ia,axisComponents:[{axisType:"xAxis",AxisComp:Ka},{axisType:"yAxis",AxisComp:Ya}],formatAxisMap:nw}),Mie=fw({chartName:"ScatterChart",GraphicalChild:Wa,defaultTooltipEventType:"item",validateTooltipEventTypes:["item"],axisComponents:[{axisType:"xAxis",AxisComp:Ka},{axisType:"yAxis",AxisComp:Ya},{axisType:"zAxis",AxisComp:Fm}],formatAxisMap:nw}),DO=fw({chartName:"AreaChart",GraphicalChild:Gi,axisComponents:[{axisType:"xAxis",AxisComp:Ka},{axisType:"yAxis",AxisComp:Ya}],formatAxisMap:nw});const Nie={keys:["R","G","B"],keyToIndex:{R:0,G:1,B:2},availableIndices:[0,1,2],indexLabels:{0:"Red",1:"Green",2:"Blue",3:"Unused"},histogramLabels:{c0:"Red",c1:"Green",c2:"Blue",c3:"Unused"},colors:{c0:"#ef4444",c1:"#22c55e",c2:"#3b82f6",c3:"#64748b"},selfAdjacentStep:1,defaultPrimaryKey:"G",defaultSecondaryKey:"B"},Oie={keys:["R","G1","G2","B"],keyToIndex:{R:0,G1:1,G2:2,B:3},availableIndices:[0,1,2,3],indexLabels:{0:"Red",1:"Green 1",2:"Green 2",3:"Blue"},histogramLabels:{c0:"Red",c1:"Green 1",c2:"Green 2",c3:"Blue"},colors:{c0:"#ef4444",c1:"#22c55e",c2:"#4ade80",c3:"#3b82f6"},selfAdjacentStep:2,defaultPrimaryKey:"G1",defaultSecondaryKey:"B"},Aie={keys:["B","G1","G2","R"],keyToIndex:{B:0,G1:1,G2:2,R:3},availableIndices:[0,1,2,3],indexLabels:{0:"Blue",1:"Green 1",2:"Green 2",3:"Red"},histogramLabels:{c0:"Blue",c1:"Green 1",c2:"Green 2",c3:"Red"},colors:{c0:"#3b82f6",c1:"#22c55e",c2:"#4ade80",c3:"#ef4444"},selfAdjacentStep:2,defaultPrimaryKey:"G1",defaultSecondaryKey:"R"},Gm=(e,t)=>e?Nie:t?Aie:Oie,Zo=(e,t)=>{const r=localStorage.getItem(e);return r===null?t:typeof t=="boolean"?r==="true":typeof t=="number"?Number(r):r},Eie=({isOpen:e,onClose:t,onMinimize:r,rawImageData:n,roi:a,isBGGR:i,zIndex:o,onFocus:s,initialPosition:l,initialInternalState:u,onUpdateState:d,stackFiles:f})=>{const h=!!(n!=null&&n.isThreePlane),g=P.useMemo(()=>Gm(h,i),[h,i]),[v,w]=P.useState(()=>(u==null?void 0:u.channelMode)??Zo("hist_mode","All")),[b,x]=P.useState(()=>(u==null?void 0:u.minVal)??Zo("hist_min",0)),[y,_]=P.useState(()=>(u==null?void 0:u.maxVal)??Zo("hist_max",16383)),[j,S]=P.useState(()=>(u==null?void 0:u.binCount)??Zo("hist_bins",100)),[k,M]=P.useState(()=>(u==null?void 0:u.pointToPoint)??Zo("hist_ptp",!1)),[N,T]=P.useState(()=>(u==null?void 0:u.showTheo)??Zo("hist_show_theo",!1)),[A,D]=P.useState(()=>(u==null?void 0:u.theoMean)??Zo("hist_theo_mean","512")),[$,B]=P.useState(()=>(u==null?void 0:u.theoSigma)??Zo("hist_theo_sigma","10")),[J,W]=P.useState(()=>(u==null?void 0:u.theoAmp)??Zo("hist_theo_amp","1000")),[I,G]=P.useState(!1),[U,X]=P.useState(0),[V,z]=P.useState([]),[q,te]=P.useState(null),[ie,he]=P.useState(l||{x:100,y:100}),[ee,Le]=P.useState(!1),fe=P.useRef({x:0,y:0});P.useEffect(()=>{v!=="All"&&!g.availableIndices.includes(Number(v))&&w("All")},[v,g]),P.useEffect(()=>{localStorage.setItem("hist_mode",v),localStorage.setItem("hist_min",String(b)),localStorage.setItem("hist_max",String(y)),localStorage.setItem("hist_bins",String(j)),localStorage.setItem("hist_ptp",String(k)),localStorage.setItem("hist_show_theo",String(N)),localStorage.setItem("hist_theo_mean",A),localStorage.setItem("hist_theo_sigma",$),localStorage.setItem("hist_theo_amp",J),d&&d({channelMode:v,minVal:b,maxVal:y,binCount:j,pointToPoint:k,showTheo:N,theoMean:A,theoSigma:$,theoAmp:J})},[v,b,y,j,k,N,A,$,J]),P.useEffect(()=>{if(!e||!a||!n&&(!f||f.length===0))return;if(y<=b){te("Invalid range: Max must be greater than Min");return}te(null),G(!0),X(0);const we=new AbortController,Re=[],Qe=setTimeout(async()=>{try{let se=[];if(f&&f.length>1){const Xe=Math.min(f.length,navigator.hardwareConcurrency||4);for(let Lt=0;Lt<Xe;Lt++){const pr=new Worker(new URL("/assets/histogramWorker-dnUrfHr1.js",import.meta.url),{type:"module"});Re.push(pr)}let ht=0,Zt=0;const Jt=[],Ut=async Lt=>{for(;ht<f.length;){if(we.signal.aborted)return;const pr=ht++,ir=f[pr];try{const zt=await ir.arrayBuffer();await new Promise((Tr,lt)=>{Lt.onmessage=Nt=>{const{success:wr,hist:kr,error:_r}=Nt.data;wr?(Jt.push(kr),Zt++,X(Zt),Tr()):(console.error(`Error processing ${ir.name}:`,_r),Tr())},Lt.onerror=Nt=>{console.error("Worker Error",Nt),Tr()},Lt.postMessage({buffer:zt,roi:a,binCount:j,minVal:b,maxVal:y,pointToPoint:k},[zt])})}catch(zt){console.error("File Read Error",zt)}}};if(await Promise.all(Re.map(Lt=>Ut(Lt))),Re.forEach(Lt=>Lt.terminate()),Re.length=0,Jt.length>0){se=Jt[0];for(let Lt=1;Lt<Jt.length;Lt++){const pr=Jt[Lt];for(let ir=0;ir<pr.length;ir++)se[ir]&&(se[ir].c0+=pr[ir].c0,se[ir].c1+=pr[ir].c1,se[ir].c2+=pr[ir].c2,se[ir].c3+=pr[ir].c3)}}}else n&&(se=UT(n.data,n.width,n.height,a.x,a.y,a.w,a.h,j,b,y,k,!!n.isThreePlane));we.signal.aborted||z(se)}catch(se){console.error("Histogram calc error:",se),te("Error calculating histogram")}finally{we.signal.aborted||G(!1)}},50);return()=>{clearTimeout(Qe),we.abort(),Re.length>0&&(console.log(`Terminating ${Re.length} active histogram workers...`),Re.forEach(se=>se.terminate()))}},[e,n,a==null?void 0:a.x,a==null?void 0:a.y,a==null?void 0:a.w,a==null?void 0:a.h,j,b,y,k,f]);const ce=P.useMemo(()=>{if(!N)return V;const we=parseFloat(A),Re=parseFloat($),it=parseFloat(J);return isNaN(we)||isNaN(Re)||isNaN(it)||Re<=0?V:V.map(Qe=>{const se=Qe.binStart,Xe=-Math.pow(se-we,2)/(2*Math.pow(Re,2)),ht=it*Math.exp(Xe);return{...Qe,theory:ht}})},[V,N,A,$,J]),de=()=>{if(V.length===0)return;let we=0,Re=0;if(V.forEach(it=>{const Qe=g.availableIndices.reduce((se,Xe)=>{const ht=it[`c${Xe}`]||0;return Math.max(se,ht)},0);Qe>we&&(we=Qe,Re=it.binStart)}),D(Re.toFixed(2)),W(we.toString()),parseFloat($)===0||isNaN(parseFloat($))){const it=y-b;B((it/20).toFixed(2))}},Ne=(we,Re,it)=>{s&&s(),!(it.closest("button")||it.closest("input")||it.closest("select"))&&(Le(!0),fe.current={x:we-ie.x,y:Re-ie.y})},pe=we=>{Ne(we.clientX,we.clientY,we.target)},ke=we=>{const Re=we.touches[0];Ne(Re.clientX,Re.clientY,we.target)};if(P.useEffect(()=>{const we=it=>{if(ee){const Qe="touches"in it?it.touches[0].clientX:it.clientX,se="touches"in it?it.touches[0].clientY:it.clientY;he({x:Qe-fe.current.x,y:se-fe.current.y})}},Re=()=>Le(!1);return ee&&(window.addEventListener("mousemove",we),window.addEventListener("mouseup",Re),window.addEventListener("touchmove",we,{passive:!1}),window.addEventListener("touchend",Re)),()=>{window.removeEventListener("mousemove",we),window.removeEventListener("mouseup",Re),window.removeEventListener("touchmove",we),window.removeEventListener("touchend",Re)}},[ee]),!e)return null;const me=g.histogramLabels,Be=g.colors,Se="step";return c.jsxs("div",{className:"fixed flex flex-col bg-white dark:bg-slate-900 border border-gray-200 dark:border-slate-700 shadow-2xl rounded-xl resize-both overflow-hidden min-w-[500px] min-h-[400px] w-[900px] h-[650px]",style:{left:ie.x,top:ie.y,zIndex:o??100},onMouseDownCapture:s,children:[c.jsxs("div",{className:`flex justify-between items-center p-4 border-b border-gray-200 dark:border-slate-700 flex-shrink-0 bg-white dark:bg-slate-900 select-none touch-none ${ee?"cursor-grabbing":"cursor-grab"}`,onMouseDown:pe,onTouchStart:ke,children:[c.jsxs("h2",{className:"text-xl font-bold text-gray-900 dark:text-slate-100 pointer-events-none flex items-center gap-2",children:["ROI Histogram",f&&f.length>1&&c.jsxs("span",{className:"text-[10px] font-normal bg-purple-100 dark:bg-purple-900/30 text-purple-700 dark:text-purple-300 px-2 py-0.5 rounded border border-purple-200 dark:border-purple-800 shadow-sm",children:["Stack Count: ",f.length]})]}),c.jsxs("div",{className:"flex items-center gap-1",children:[r&&c.jsx("button",{onClick:r,className:"text-gray-400 hover:text-gray-600 dark:hover:text-slate-300 p-2 rounded-lg hover:bg-gray-100 dark:hover:bg-slate-800 transition-colors",children:c.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M20 12H4"})})}),c.jsx("button",{onClick:t,className:"text-gray-400 hover:text-red-500 dark:hover:text-red-400 p-2 rounded-lg hover:bg-gray-100 dark:hover:bg-slate-800 transition-colors",children:c.jsx("svg",{className:"w-6 h-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]})]}),c.jsxs("div",{className:"p-3 bg-gray-50 dark:bg-slate-800/50 flex flex-wrap gap-x-6 gap-y-3 items-center border-b border-gray-200 dark:border-slate-700 text-xs flex-shrink-0 relative z-10",children:[c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx("span",{className:"text-gray-500 dark:text-slate-400 font-bold uppercase tracking-tight",children:"Channel:"}),c.jsxs("select",{value:v,onChange:we=>w(we.target.value),className:"bg-white dark:bg-slate-700 border border-gray-300 dark:border-slate-600 rounded px-2 py-1 text-gray-900 dark:text-slate-100 outline-none focus:ring-1 focus:ring-cyan-500",children:[c.jsx("option",{value:"All",children:"All Colors"}),g.availableIndices.map(we=>{const Re=`c${we}`;return c.jsx("option",{value:String(we),children:me[Re]},we)})]})]}),c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx("span",{className:"text-gray-500 dark:text-slate-400 font-bold uppercase tracking-tight",children:"Range:"}),c.jsx("input",{type:"number",value:b,onChange:we=>x(Number(we.target.value)),className:"w-16 px-1.5 py-1 bg-white dark:bg-slate-700 border border-gray-300 dark:border-slate-600 rounded outline-none text-gray-900 dark:text-slate-100 text-right font-mono"}),c.jsx("span",{className:"text-gray-400",children:"-"}),c.jsx("input",{type:"number",value:y,onChange:we=>_(Number(we.target.value)),className:"w-16 px-1.5 py-1 bg-white dark:bg-slate-700 border border-gray-300 dark:border-slate-600 rounded outline-none text-gray-900 dark:text-slate-100 text-right font-mono"})]}),c.jsxs("div",{className:"flex items-center gap-4",children:[c.jsxs("label",{className:"flex items-center gap-1.5 cursor-pointer",children:[c.jsx("input",{type:"checkbox",checked:k,onChange:we=>M(we.target.checked),className:"w-3.5 h-3.5 text-cyan-600 rounded border-gray-300 focus:ring-cyan-500"}),c.jsx("span",{className:"text-gray-700 dark:text-slate-300 select-none font-semibold",children:"PTP"})]}),!k&&c.jsxs("div",{className:"flex items-center gap-1.5",children:[c.jsx("span",{className:"text-gray-500 dark:text-slate-400 font-bold",children:"Bins:"}),c.jsx("input",{type:"number",value:j,onChange:we=>S(Math.max(1,Number(we.target.value))),className:"w-12 px-1.5 py-1 bg-white dark:bg-slate-700 border border-gray-300 dark:border-slate-600 rounded outline-none text-gray-900 dark:text-slate-100 text-right font-mono"})]})]}),c.jsx("div",{className:"h-6 w-px bg-gray-200 dark:bg-slate-700"}),c.jsxs("div",{className:`flex items-center gap-3 p-1.5 rounded-lg border transition-all ${N?"bg-amber-50/30 dark:bg-amber-900/10 border-amber-200/50 dark:border-amber-800/50":"bg-transparent border-transparent"}`,children:[c.jsxs("label",{className:"flex items-center gap-1.5 cursor-pointer select-none",children:[c.jsx("input",{type:"checkbox",checked:N,onChange:we=>T(we.target.checked),className:"w-3.5 h-3.5 text-amber-500 rounded border-gray-300 focus:ring-amber-500 bg-white dark:bg-slate-700"}),c.jsx("span",{className:`font-bold uppercase tracking-tight ${N?"text-amber-600 dark:text-amber-400":"text-gray-400"}`,children:"Theoretical Bell"})]}),N&&c.jsxs("div",{className:"flex items-center gap-2 animate-in fade-in slide-in-from-left-2 duration-200",children:[c.jsxs("div",{className:"flex flex-col items-center",children:[c.jsx("span",{className:"text-[8px] text-gray-400 uppercase font-bold",children:"Mean()"}),c.jsx("input",{type:"text",value:A,onChange:we=>D(we.target.value),className:"w-14 bg-white dark:bg-slate-900 border border-gray-300 dark:border-slate-600 rounded text-center text-[10px] py-0.5 outline-none focus:border-amber-500"})]}),c.jsxs("div",{className:"flex flex-col items-center",children:[c.jsx("span",{className:"text-[8px] text-gray-400 uppercase font-bold",children:"Sigma()"}),c.jsx("input",{type:"text",value:$,onChange:we=>B(we.target.value),className:"w-12 bg-white dark:bg-slate-900 border border-gray-300 dark:border-slate-600 rounded text-center text-[10px] py-0.5 outline-none focus:border-amber-500"})]}),c.jsxs("div",{className:"flex flex-col items-center",children:[c.jsx("span",{className:"text-[8px] text-gray-400 uppercase font-bold",children:"Scale(A)"}),c.jsx("input",{type:"text",value:J,onChange:we=>W(we.target.value),className:"w-16 bg-white dark:bg-slate-900 border border-gray-300 dark:border-slate-600 rounded text-center text-[10px] py-0.5 outline-none focus:border-amber-500"})]}),c.jsx("button",{onClick:de,className:"mt-3 px-2 py-0.5 bg-amber-600 hover:bg-amber-500 text-white text-[9px] font-bold rounded shadow-sm active:scale-95 transition-all",title:"Set Mean and Amplitude based on current peak",children:"AUTO FIT"})]})]})]}),c.jsxs("div",{className:"flex-1 p-4 relative bg-white dark:bg-slate-900 overflow-hidden min-h-0",children:[c.jsx("div",{className:"absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 z-0 pointer-events-none select-none opacity-10 mix-blend-normal dark:mix-blend-plus-lighter",children:c.jsx("svg",{viewBox:"0 0 500 60",className:"w-96 h-auto",children:c.jsx("text",{x:"50%",y:"50%",dominantBaseline:"middle",textAnchor:"middle",className:"fill-gray-900 dark:fill-white",fontSize:"36",fontWeight:"bold",style:{fontFamily:"sans-serif",letterSpacing:"0.05em"},children:" y-g-jiang.github.io"})})}),I&&c.jsxs("div",{className:"absolute inset-0 flex flex-col items-center justify-center z-20 bg-white/50 dark:bg-slate-900/50 backdrop-blur-[1px]",children:[c.jsx("div",{className:"w-8 h-8 border-4 border-cyan-500 border-t-transparent rounded-full animate-spin mb-2"}),c.jsx("span",{className:"text-sm text-cyan-600 dark:text-cyan-400 font-semibold",children:f&&f.length>1?`Stacking Histogram... ${U}/${f.length}`:"Calculating Histogram..."})]}),q?c.jsx("div",{className:"flex items-center justify-center h-full text-red-500 relative z-10",children:q}):c.jsx("div",{className:"relative z-10 w-full h-full",children:c.jsx(Oo,{width:"100%",height:"100%",children:c.jsxs(Kl,{data:ce,children:[c.jsx(mo,{strokeDasharray:"3 3",stroke:"#374151",opacity:.3}),c.jsx(Ka,{dataKey:"binStart",type:"number",domain:[b,y],tickFormatter:we=>Math.floor(we).toString(),tick:{fill:"#9ca3af",fontSize:12},allowDataOverflow:!0,label:{value:"DN Value",position:"insideBottom",offset:-5,fill:"#9ca3af",fontSize:12}}),c.jsx(Ya,{tick:{fill:"#9ca3af",fontSize:12},label:{value:"Count",angle:-90,position:"insideLeft",fill:"#9ca3af",fontSize:12}}),c.jsx(aa,{contentStyle:{backgroundColor:"#1f2937",border:"1px solid #374151",borderRadius:"0.5rem",color:"#f3f4f6"},itemStyle:{fontSize:"12px"},labelFormatter:we=>`DN: ${Math.round(Number(we))}`,formatter:(we,Re)=>[Math.round(we),Re]}),c.jsx(Do,{wrapperStyle:{paddingTop:"10px"}}),N&&c.jsx(ia,{type:"monotone",dataKey:"theory",name:"Ideal Bell (Gaussian)",stroke:"#f59e0b",strokeWidth:2.5,strokeDasharray:"5 5",dot:!1,isAnimationActive:!1}),g.availableIndices.map(we=>{if(v!=="All"&&v!==String(we))return null;const Re=`c${we}`;return c.jsx(ia,{type:Se,dataKey:Re,name:me[Re],stroke:Be[Re],dot:!1,strokeWidth:1.5,activeDot:{r:4},isAnimationActive:!1},Re)})]})})})]})]})},Cl=({initialPosition:e={x:20,y:80},children:t,className:r="",onClose:n,zIndex:a,onFocus:i})=>{const[o,s]=P.useState(e),[l,u]=P.useState(!1),[d,f]=P.useState({x:0,y:0}),h=P.useRef(null),g=(b,x,y)=>{i&&i(),!(y.closest("button")||y.closest("input"))&&(u(!0),f({x:b-o.x,y:x-o.y}))},v=b=>{g(b.clientX,b.clientY,b.target)},w=b=>{const x=b.touches[0];g(x.clientX,x.clientY,b.target)};return P.useEffect(()=>{const b=y=>{var _,j;if(l){y.cancelable&&y.preventDefault();const S="touches"in y?y.touches[0].clientX:y.clientX,k="touches"in y?y.touches[0].clientY:y.clientY,M=S-d.x,N=k-d.y,T=window.innerWidth-(((_=h.current)==null?void 0:_.offsetWidth)||100),A=window.innerHeight-(((j=h.current)==null?void 0:j.offsetHeight)||100);s({x:Math.max(0,Math.min(M,T)),y:Math.max(0,Math.min(N,A))})}},x=()=>{u(!1)};return l&&(window.addEventListener("mousemove",b),window.addEventListener("mouseup",x),window.addEventListener("touchmove",b,{passive:!1}),window.addEventListener("touchend",x)),()=>{window.removeEventListener("mousemove",b),window.removeEventListener("mouseup",x),window.removeEventListener("touchmove",b),window.removeEventListener("touchend",x)}},[l,d]),c.jsxs("div",{ref:h,style:{left:o.x,top:o.y,zIndex:a??90},onMouseDownCapture:i,className:`fixed border-2 border-black dark:border-gray-500 bg-white dark:bg-black shadow-[8px_8px_0px_rgba(0,0,0,0.5)] dark:shadow-[8px_8px_0px_rgba(255,255,255,0.2)] transition-shadow duration-200 ${l?"cursor-grabbing shadow-[4px_4px_0px_rgba(0,0,0,0.5)]":""} ${r}`,children:[c.jsx("div",{onMouseDown:v,onTouchStart:w,className:"absolute inset-0 w-full h-8 cursor-grab active:cursor-grabbing z-0 touch-none bg-gray-200 dark:bg-gray-800 border-b-2 border-black dark:border-gray-500",title:"Drag to move"}),c.jsx("div",{className:"relative z-10 pointer-events-none",children:c.jsx("div",{className:"pointer-events-auto",children:t})})]})},Tie=({isOpen:e,onClose:t,rawImageData:r,roi:n,selectedChannel:a,channelName:i,zIndex:o,onFocus:s,initialPosition:l})=>{const u=P.useRef(null),[d,f]=P.useState(!1),[h,g]=P.useState(null),[v,w]=P.useState(null),[b,x]=P.useState(!0),[y,_]=P.useState(!0),[j,S]=P.useState("-1"),[k,M]=P.useState("8"),[N,T]=P.useState(64),[A,D]=P.useState(45),[$,B]=P.useState(60),J=P.useRef(!1),W=P.useRef({x:0,y:0});P.useEffect(()=>{!e||!r||!n||(f(!0),w(null),setTimeout(()=>{try{const X=zT(r.data,r.width,r.height,n,a,y,!!r.isThreePlane);X?g(X):w("Could not extract valid data from ROI.")}catch(X){console.error("2D FFT Error",X),w("Calculation Error: "+X.message)}finally{f(!1)}},50))},[e,r,n,a,y]),P.useEffect(()=>{if(!h||!u.current)return;const X=u.current,V=X.getContext("2d");if(!V)return;const z=X.width,q=X.height;V.clearRect(0,0,z,q),V.fillStyle="#0f172a",V.fillRect(0,0,z,q);const te=h.width,ie=h.height,he=h.data,ee=Math.pow(10,parseFloat(j)||-1),Le=Math.pow(10,parseFloat(k)||8);let fe=ee,ce=Le;b&&(fe=Math.log10(Math.max(1e-10,ee)),ce=Math.log10(Math.max(1e-10,Le)));const de=ce-fe||1,Ne=z/2,pe=q/2+50,ke=Math.min(z,q)*.4,me=.6,Be=A*Math.PI/180,Se=$*Math.PI/180,we=Math.cos(Be),Re=Math.sin(Be),it=Math.cos(Se),Qe=Math.sin(Se),se=(Nt,wr,kr)=>{const _r=Nt*we-wr*Re,zr=Nt*Re+wr*we,Or=zr*it-kr*Qe,or=zr*Qe+kr*it;return{x:Ne+_r*ke,y:pe-Or*ke,depth:or}},Xe=Math.max(16,N),ht=Math.max(1,Math.floor(te/Xe)),Zt=Math.max(1,Math.floor(ie/Xe)),Jt=(Nt,wr)=>{let kr=he[wr*te+Nt];return b&&(kr=Math.log10(Math.max(1e-10,kr))),kr=Math.max(fe,Math.min(ce,kr)),(kr-fe)/de},Ut=Nt=>`hsl(${(1-Nt)*240}, 80%, 50%)`,Lt=[];for(let Nt=0;Nt<ie-Zt;Nt+=Zt)for(let wr=0;wr<te-ht;wr+=ht){const kr=wr,_r=Nt,zr=wr+ht,Or=Nt,or=wr+ht,Br=Nt+Zt,Xt=wr,Te=Nt+Zt,Q=Jt(kr,_r),Ce=Jt(zr,Or),ye=Jt(or,Br),ze=Jt(Xt,Te),ot=(Q+Ce+ye+ze)/4,ct=se(kr/(te-1)-.5,_r/(ie-1)-.5,Q*me),Ct=se(zr/(te-1)-.5,Or/(ie-1)-.5,Ce*me),tt=se(or/(te-1)-.5,Br/(ie-1)-.5,ye*me),Hr=se(Xt/(te-1)-.5,Te/(ie-1)-.5,ze*me),gr=(ct.depth+Ct.depth+tt.depth+Hr.depth)/4;Lt.push({pts:[{x:ct.x,y:ct.y},{x:Ct.x,y:Ct.y},{x:tt.x,y:tt.y},{x:Hr.x,y:Hr.y}],avgDepth:gr,avgZ:ot})}Lt.sort((Nt,wr)=>Nt.avgDepth-wr.avgDepth),V.lineWidth=.5,Lt.forEach(Nt=>{V.fillStyle=Ut(Nt.avgZ),V.beginPath(),V.moveTo(Nt.pts[0].x,Nt.pts[0].y),V.lineTo(Nt.pts[1].x,Nt.pts[1].y),V.lineTo(Nt.pts[2].x,Nt.pts[2].y),V.lineTo(Nt.pts[3].x,Nt.pts[3].y),V.closePath(),V.fill()}),V.fillStyle="#aaa",V.font="10px monospace";const pr=se(-.5,-.5,0),ir=se(.5,-.5,0),zt=se(-.5,.5,0),Tr=se(.5,.5,0);V.strokeStyle="#666",V.beginPath(),V.moveTo(pr.x,pr.y),V.lineTo(ir.x,ir.y),V.lineTo(Tr.x,Tr.y),V.lineTo(zt.x,zt.y),V.closePath(),V.stroke(),V.fillText("0",pr.x-10,pr.y+10),V.fillText("Fx",ir.x+5,ir.y),V.fillText("Fy",zt.x-15,zt.y);const lt=se(-.5,-.5,me);V.strokeStyle="#fff",V.beginPath(),V.moveTo(pr.x,pr.y),V.lineTo(lt.x,lt.y),V.stroke(),V.fillText(`10^${k}`,lt.x-25,lt.y),V.fillText(`10^${j}`,pr.x-25,pr.y)},[h,b,A,$,j,k,N]);const I=X=>{J.current=!0,W.current={x:X.clientX,y:X.clientY}},G=X=>{if(!J.current)return;const V=X.clientX-W.current.x,z=X.clientY-W.current.y;D(q=>q-V*.5),B(q=>Math.max(0,Math.min(90,q+z*.5))),W.current={x:X.clientX,y:X.clientY}},U=()=>{J.current=!1};return e?c.jsxs(Cl,{initialPosition:l||{x:100,y:100},onClose:t,zIndex:o,onFocus:s,className:"w-[700px] h-[600px] bg-slate-900 border border-slate-700 flex flex-col overflow-hidden shadow-2xl",children:[c.jsxs("div",{className:"flex justify-between items-center px-4 py-2 border-b border-slate-700 bg-slate-800",children:[c.jsxs("h3",{className:"text-sm font-bold text-slate-200 flex items-center gap-2",children:["2D FFT Power Spectrum - ",i,h&&c.jsxs("span",{className:"text-[10px] font-normal text-slate-400 bg-slate-700 px-2 py-0.5 rounded",children:[h.width,"x",h.height," (Chirp-Z)"]})]}),c.jsx("div",{className:"flex items-center gap-2",children:c.jsx("button",{onClick:t,className:"text-slate-400 hover:text-red-400 transition-colors",children:c.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})})]}),c.jsxs("div",{className:"p-3 bg-slate-800/80 flex flex-wrap gap-4 text-xs items-center border-b border-slate-700",children:[c.jsxs("div",{className:"flex items-center gap-2 bg-slate-900 px-2 py-1 rounded border border-slate-600",children:[c.jsx("span",{className:"text-slate-400 font-bold",children:"Range (10^x):"}),c.jsx("input",{type:"number",value:j,onChange:X=>S(X.target.value),className:"w-10 bg-transparent text-slate-200 text-center border-b border-slate-600 focus:border-cyan-500 outline-none"}),c.jsx("span",{className:"text-slate-500",children:"to"}),c.jsx("input",{type:"number",value:k,onChange:X=>M(X.target.value),className:"w-10 bg-transparent text-slate-200 text-center border-b border-slate-600 focus:border-cyan-500 outline-none"})]}),c.jsxs("div",{className:"flex items-center gap-2 bg-slate-900 px-2 py-1 rounded border border-slate-600",children:[c.jsx("span",{className:"text-slate-400 font-bold",children:"Density:"}),c.jsx("input",{type:"range",min:"16",max:"128",step:"16",value:N,onChange:X=>T(Number(X.target.value)),className:"w-20 h-1.5 bg-slate-700 rounded-lg appearance-none cursor-pointer accent-cyan-500"}),c.jsx("span",{className:"text-slate-300 w-6 text-right",children:N})]}),c.jsxs("label",{className:"flex items-center gap-1 cursor-pointer select-none text-slate-300 hover:text-white",children:[c.jsx("input",{type:"checkbox",checked:b,onChange:X=>x(X.target.checked),className:"rounded bg-slate-700 border-slate-600 accent-cyan-500"}),"Log Z"]}),c.jsxs("label",{className:"flex items-center gap-1 cursor-pointer select-none text-slate-300 hover:text-white",children:[c.jsx("input",{type:"checkbox",checked:y,onChange:X=>_(X.target.checked),className:"rounded bg-slate-700 border-slate-600 accent-fuchsia-500"}),"Hanning"]})]}),c.jsxs("div",{className:"flex-1 relative bg-slate-900 cursor-move",children:[d&&c.jsx("div",{className:"absolute inset-0 flex items-center justify-center bg-slate-900/80 z-20 backdrop-blur-sm",children:c.jsxs("div",{className:"flex flex-col items-center gap-2",children:[c.jsx("div",{className:"w-8 h-8 border-4 border-cyan-500 border-t-transparent rounded-full animate-spin"}),c.jsx("span",{className:"text-cyan-400 font-bold animate-pulse text-sm",children:"Computing full-size 2D FFT..."})]})}),v&&c.jsx("div",{className:"absolute inset-0 flex items-center justify-center bg-slate-900/80 z-20 text-red-400 p-4 text-center",children:v}),c.jsx("canvas",{ref:u,width:700,height:500,className:"w-full h-full block",onMouseDown:I,onMouseMove:G,onMouseUp:U,onMouseLeave:U}),c.jsx("div",{className:"absolute bottom-2 right-2 text-[9px] text-slate-600 pointer-events-none",children:"Drag to Rotate"})]})]}):null},Iie=.5,Y1=1e-10,J4=(e,t)=>{const r=e.length-1;if(r<0)return Y1;const n=t/Iie*r,a=Math.round(n),i=e[Math.min(Math.max(0,a),r)]||0;return Math.max(i,Y1)},Rie=(e,t)=>{if(t<=0)return[1];const r=new Array(e);let n=0;for(let a=0;a<e;a++){const i=a-(e-1)/2,o=Math.exp(-(i*i)/(2*t*t));r[a]=o,n+=o}for(let a=0;a<e;a++)r[a]/=n;return r},Die=({isOpen:e,onClose:t,onMinimize:r,rawImageData:n,roi:a,isBGGR:i,onUpdateROI:o,zIndex:s,onFocus:l,initialPosition:u,initialInternalState:d,onUpdateState:f,stackFiles:h})=>{const[g,v]=P.useState((d==null?void 0:d.selectedChannel)??0),[w,b]=P.useState(()=>(d==null?void 0:d.yMinExp)||localStorage.getItem("fft_y_min")||"1.73"),[x,y]=P.useState(()=>(d==null?void 0:d.yMaxExp)||localStorage.getItem("fft_y_max")||"8.00"),[_,j]=P.useState((d==null?void 0:d.useHanning)??!0),[S,k]=P.useState((d==null?void 0:d.doAverage)??!0),[M,N]=P.useState((d==null?void 0:d.welchSegments)??1),[T,A]=P.useState((d==null?void 0:d.showH)??!0),[D,$]=P.useState((d==null?void 0:d.showV)??!0),[B,J]=P.useState((d==null?void 0:d.interlaceRows)??!1),[W,I]=P.useState((d==null?void 0:d.rowGroup)??0),[G,U]=P.useState((d==null?void 0:d.interlaceCols)??!1),[X,V]=P.useState((d==null?void 0:d.colGroup)??0),[z,q]=P.useState(()=>(d==null?void 0:d.theoSigma)||localStorage.getItem("fft_theo_sigma")||"0.00"),[te,ie]=P.useState(()=>(d==null?void 0:d.theoKernelSize)||localStorage.getItem("fft_theo_ksize")||"3"),[he,ee]=P.useState(()=>(d==null?void 0:d.theoNoiseStd)||localStorage.getItem("fft_theo_noise")||"7.5"),[Le,fe]=P.useState(()=>(d==null?void 0:d.theoScale)||localStorage.getItem("fft_theo_scale")||"1.0"),[ce,de]=P.useState((d==null?void 0:d.intStart)||"0"),[Ne,pe]=P.useState((d==null?void 0:d.intEnd)||"0.5"),[ke,me]=P.useState(!1),[Be,Se]=P.useState([]),[we,Re]=P.useState(!1),[it,Qe]=P.useState(0),[se,Xe]=P.useState(null),[ht,Zt]=P.useState(!1),[Jt,Ut]=P.useState(!1),[Lt,pr]=P.useState(null),[ir,zt]=P.useState(!1),[Tr,lt]=P.useState(null),[Nt,wr]=P.useState(u||{x:50,y:50}),[kr,_r]=P.useState(!1),[zr,Or]=P.useState(null),[or,Br]=P.useState({}),Xt=P.useRef({x:0,y:0}),Te=!!(n!=null&&n.isThreePlane),Q=P.useMemo(()=>Gm(Te,i),[Te,i]),Ce=Q.availableIndices,ye=Q.colors,ze=Q.indexLabels;P.useEffect(()=>{g!==-1&&!Ce.includes(g)&&v(Ce[0])},[g,Ce]),P.useEffect(()=>{localStorage.setItem("fft_y_min",w),localStorage.setItem("fft_y_max",x),localStorage.setItem("fft_theo_sigma",z),localStorage.setItem("fft_theo_ksize",te),localStorage.setItem("fft_theo_noise",he),localStorage.setItem("fft_theo_scale",Le)},[w,x,z,te,he,Le]),P.useEffect(()=>{if(!e||!n||!a)return;Re(!0),Xe(null),Qe(0);const Me=setTimeout(async()=>{try{const ut=g===-1?Ce:[g],gt=h&&h.length>1?h:[null],yr=gt.length,lr={};let et={h:0,v:0};for(let Dt=0;Dt<yr;Dt++){Qe(Dt+1);let Et;if(gt[Dt]){const _e=await gt[Dt].arrayBuffer();Et=await Pu(_e)}else Et=n;for(const _e of ut){const fr=GT(Et.data,Et.width,Et.height,a,_e,!1,_,{rows:B,rowGroup:W,cols:G,colGroup:X},S,M,!!Et.isThreePlane);fr&&(lr[_e]||(lr[_e]={h:new Array(fr.avgHoriz.length).fill(0),v:new Array(fr.avgVert.length).fill(0)}),fr.avgHoriz.forEach((F,Oe)=>lr[_e].h[Oe]+=F/yr),fr.avgVert.forEach((F,Oe)=>lr[_e].v[Oe]+=F/yr),et=fr.sampleCount)}}if(Object.keys(lr).length===0)throw new Error("ROI too small or no data found.");const tr=1024,rr=[];for(let Dt=0;Dt<tr;Dt++){const Et=Dt/(tr-1)*.5,_e={freq:parseFloat(Et.toFixed(6))};for(const fr of ut)lr[fr]&&(_e[`c${fr}_h`]=J4(lr[fr].h,Et),_e[`c${fr}_v`]=J4(lr[fr].v,Et));rr.push(_e)}Or(et),Se(rr)}catch(ut){console.error("FFT Loop Failed:",ut),Xe(ut.message||"Unknown error during FFT processing")}finally{Re(!1)}},100);return()=>clearTimeout(Me)},[e,n,a==null?void 0:a.x,a==null?void 0:a.y,a==null?void 0:a.w,a==null?void 0:a.h,g,_,S,M,B,W,G,X,h,Ce]);const ot=()=>{const Me=parseFloat(ce),ut=parseFloat(Ne);if(isNaN(Me)||isNaN(ut))return;const gt={},yr=g===-1?Ce:[g],lr=Be.filter(et=>et.freq>=Me&&et.freq<=ut);if(lr.length===0){Br({});return}yr.forEach(et=>{let tr=0,rr=0;lr.forEach(Dt=>{const Et=Dt[`c${et}_h`],_e=Dt[`c${et}_v`];typeof Et=="number"&&(tr+=Et),typeof _e=="number"&&(rr+=_e)}),gt[et]={h:tr/lr.length,v:rr/lr.length,count:lr.length}}),Br(gt)},ct=P.useMemo(()=>{const Me=parseFloat(z),ut=parseInt(te),gt=parseFloat(he),yr=parseFloat(Le);if(isNaN(Me)||isNaN(ut)||isNaN(gt)||isNaN(yr)||Be.length===0)return Be;const lr=Rie(ut,Me),et=lr.reduce((Dt,Et)=>Dt+Et*Et,0),tr=(ut-1)/2,rr=gt*gt*yr;return Be.map(Dt=>{const Et=Dt.freq,_e=2*Math.PI*Et;let fr=0,F=0;for(let Ie=0;Ie<ut;Ie++){const Tt=Ie-tr,Ve=lr[Ie],pt=-_e*Tt;fr+=Ve*Math.cos(pt),F+=Ve*Math.sin(pt)}const Oe=fr*fr+F*F;return{...Dt,theory:Math.max(Y1,rr*et*Oe)}})},[Be,z,te,he,Le]),Ct=Me=>{Me&&Me.activeLabel!==void 0&&(zt(!0),lt(Number(Me.activeLabel)),pr(null))},tt=Me=>{if(ir&&Tr!==null&&Me&&Me.activeLabel!==void 0){const ut=Number(Me.activeLabel);pr([Math.min(Tr,ut),Math.max(Tr,ut)])}},Hr=()=>zt(!1),gr=(Me,ut,gt)=>{l&&l(),!(gt.closest("button")||gt.closest("input"))&&(_r(!0),Xt.current={x:Me-Nt.x,y:ut-Nt.y})},Qt=Me=>{gr(Me.clientX,Me.clientY,Me.target)},jt=Me=>{const ut=Me.touches[0];gr(ut.clientX,ut.clientY,Me.target)};P.useEffect(()=>{const Me=gt=>{if(kr){const yr="touches"in gt?gt.touches[0].clientX:gt.clientX,lr="touches"in gt?gt.touches[0].clientY:gt.clientY;wr({x:yr-Xt.current.x,y:lr-Xt.current.y})}},ut=()=>_r(!1);return kr&&(window.addEventListener("mousemove",Me),window.addEventListener("mouseup",ut),window.addEventListener("touchmove",Me,{passive:!1}),window.addEventListener("touchend",ut)),()=>{window.removeEventListener("mousemove",Me),window.removeEventListener("mouseup",ut),window.removeEventListener("touchmove",Me),window.removeEventListener("touchend",ut)}},[kr]);const mr=P.useMemo(()=>{if(!Lt||Be.length===0)return null;const[Me,ut]=Lt,gt=Be.filter(et=>et.freq>=Me&&et.freq<=ut);if(gt.length===0)return null;const yr=g===-1?Ce:[g],lr={};return yr.forEach(et=>{["h","v"].forEach(tr=>{const rr=`c${et}_${tr}`;let Dt=0,Et=0;for(const _e of gt){const fr=_e[rr];typeof fr=="number"&&(Dt+=fr,Et++)}Et>0&&(lr[`${rr}_sigma`]=Math.sqrt(Dt/Et))})}),{count:gt.length,stats:lr}},[Lt,Be,g,Ce]),R=()=>{if(Be.length===0)return;let Me=1/0,ut=-1/0;if(Be.forEach(tr=>{tr.freq<.01||tr.freq>.49||Object.keys(tr).forEach(rr=>{if(rr==="freq"||rr==="theory")return;const Dt=tr[rr];typeof Dt=="number"&&Dt>0&&(Dt<Me&&(Me=Dt),Dt>ut&&(ut=Dt))})}),Me===1/0)return;const gt=Math.log10(Me),yr=Math.log10(ut),lr=yr-gt,et=(lr===0?1:lr)*.1;b((gt-et).toFixed(2)),y((yr+et).toFixed(2))},sr=(Me,ut)=>{a&&o&&o({...a,x:a.x+Me,y:a.y+ut})},Fr=(Me,ut)=>{a&&o&&o({...a,w:Math.max(2,a.w+Me),h:Math.max(2,a.h+ut)})};return e?c.jsxs("div",{className:"fixed flex flex-col bg-white dark:bg-slate-900 border border-gray-200 dark:border-slate-700 shadow-2xl rounded-xl overflow-hidden resize-both min-w-[750px] min-h-[500px]",style:{left:Nt.x,top:Nt.y,width:"1000px",height:"850px",zIndex:s??100},onMouseDownCapture:l,children:[c.jsxs("div",{className:`flex justify-between items-center p-3 border-b border-gray-200 dark:border-slate-700 flex-shrink-0 bg-gray-50 dark:bg-slate-800 z-50 relative select-none touch-none ${kr?"cursor-grabbing":"cursor-grab"}`,onMouseDown:Qt,onTouchStart:jt,children:[c.jsxs("h2",{className:"text-lg font-bold text-gray-900 dark:text-slate-100 flex items-center gap-2 pointer-events-none",children:["Power Spectrum Analysis",c.jsx("span",{className:"text-[10px] font-normal bg-white dark:bg-slate-700 px-2 py-1 rounded text-gray-500 border border-gray-200 dark:border-slate-600 shadow-sm",children:h&&h.length>1?`Stack Avg (${h.length} frames)`:"Single Mode"})]}),c.jsxs("div",{className:"flex items-center gap-1",children:[r&&c.jsx("button",{onClick:r,className:"text-gray-400 hover:text-gray-600 dark:hover:text-slate-300 p-2 rounded-lg hover:bg-gray-200 dark:hover:bg-slate-700 transition-colors",children:c.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M20 12H4"})})}),c.jsx("button",{onClick:t,className:"text-gray-400 hover:text-red-500 dark:hover:text-red-400 p-2 rounded-lg hover:bg-gray-200 dark:hover:bg-slate-700 transition-colors",children:c.jsx("svg",{className:"w-6 h-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]})]}),c.jsxs("div",{className:"flex flex-col bg-gray-50 dark:bg-slate-900/80 border-b border-gray-200 dark:border-slate-800 flex-shrink-0 z-40 relative px-4 py-3 gap-3 overflow-x-auto",children:[c.jsxs("div",{className:"flex items-center gap-6",children:[c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx("span",{className:"text-[10px] font-bold text-gray-500 dark:text-slate-400 uppercase tracking-widest",children:"Channel"}),c.jsxs("div",{className:"flex bg-gray-100 dark:bg-slate-800 rounded-lg p-0.5 border border-gray-200 dark:border-slate-700 shadow-inner",children:[c.jsx("button",{onClick:()=>v(-1),className:`px-3 py-1 rounded text-[10px] font-bold transition-all ${g===-1?"bg-slate-700 text-white shadow-md":"text-gray-500 dark:text-slate-500 hover:bg-white dark:hover:bg-slate-700"}`,children:"All"}),Ce.map(Me=>c.jsx("button",{onClick:()=>v(Me),className:`px-3 py-1 rounded text-[10px] font-bold transition-all ${g===Me?"bg-cyan-600 text-white shadow-md":"text-gray-500 dark:text-slate-500 hover:bg-white dark:hover:bg-slate-700"}`,children:ze[Me]},Me))]})]}),c.jsx("div",{className:"h-6 w-px bg-gray-200 dark:bg-slate-700 mx-2"}),c.jsxs("button",{onClick:()=>me(!0),className:"flex items-center gap-1.5 px-4 py-1.5 bg-indigo-600 hover:bg-indigo-500 text-white text-[10px] font-bold rounded-lg shadow-lg shadow-indigo-500/30 transition-all active:scale-95 group border border-indigo-400/30",children:[c.jsx("svg",{className:"w-3.5 h-3.5 group-hover:animate-pulse",fill:"currentColor",viewBox:"0 0 24 24",children:c.jsx("path",{d:"M13 10V3L4 14h7v7l9-11h-7z"})}),"2D Diagonal"]}),c.jsx("div",{className:"h-6 w-px bg-gray-200 dark:bg-slate-700 mx-2"}),c.jsxs("div",{className:"flex items-center gap-3",children:[c.jsx("span",{className:"text-[10px] font-bold text-indigo-500 dark:text-indigo-400 uppercase tracking-widest",children:"Model"}),c.jsx("div",{className:"flex gap-2",children:[{label:"KSize",val:te,set:ie,w:"w-10"},{label:"Sigma",val:z,set:q,w:"w-12"},{label:"Noise()",val:he,set:ee,w:"w-12"},{label:"Scale",val:Le,set:fe,w:"w-12"}].map(Me=>c.jsxs("div",{className:"flex flex-col items-center",children:[c.jsx("label",{className:"text-[8px] text-gray-400 dark:text-slate-500 uppercase font-bold mb-0.5",children:Me.label}),c.jsx("input",{type:"text",value:Me.val,onChange:ut=>Me.set(ut.target.value),className:`${Me.w} text-[11px] bg-white dark:bg-slate-800 border border-gray-200 dark:border-slate-700 rounded px-1.5 py-0.5 text-center text-gray-900 dark:text-slate-100 outline-none focus:border-indigo-500 shadow-sm`})]},Me.label))})]})]}),c.jsxs("div",{className:"flex items-center gap-4 flex-wrap",children:[c.jsxs("div",{className:"flex items-center gap-3 mr-2",children:[c.jsx("span",{className:"text-[10px] font-bold text-fuchsia-600 dark:text-fuchsia-500 uppercase tracking-widest",children:"Welch"}),c.jsx("input",{type:"range",min:"1",max:"16",step:"1",value:M,onChange:Me=>N(parseInt(Me.target.value)),className:"w-24 h-1.5 bg-gray-300 dark:bg-slate-700 rounded-lg appearance-none cursor-pointer accent-fuchsia-500"}),c.jsx("span",{className:"text-[10px] font-mono text-fuchsia-600 dark:text-fuchsia-400 w-4 font-bold",children:M})]}),c.jsx("div",{className:"h-6 w-px bg-gray-200 dark:bg-slate-700"}),c.jsxs("div",{className:"flex flex-col gap-1 px-2",children:[c.jsxs("label",{className:"flex items-center gap-1.5 cursor-pointer text-[10px] text-gray-500 dark:text-slate-400 hover:text-gray-900 dark:hover:text-slate-200 select-none",children:[c.jsx("input",{type:"checkbox",checked:B,onChange:Me=>J(Me.target.checked),className:"w-3 h-3 rounded text-cyan-600 border-gray-300 dark:border-slate-700 bg-white dark:bg-slate-800"})," Row Int."]}),c.jsxs("label",{className:"flex items-center gap-1.5 cursor-pointer text-[10px] text-gray-500 dark:text-slate-400 hover:text-gray-900 dark:hover:text-slate-200 select-none",children:[c.jsx("input",{type:"checkbox",checked:G,onChange:Me=>U(Me.target.checked),className:"w-3 h-3 rounded text-cyan-600 border-gray-300 dark:border-slate-700 bg-white dark:bg-slate-800"})," Col Int."]})]}),c.jsxs("div",{className:"flex flex-col gap-1.5 bg-gray-100 dark:bg-slate-800/60 p-1.5 rounded-lg border border-gray-200 dark:border-slate-700",children:[c.jsxs("label",{className:"flex items-center gap-2 cursor-pointer select-none",children:[c.jsx("div",{className:`w-3.5 h-3.5 rounded-md border flex items-center justify-center transition-colors ${_?"bg-fuchsia-600 border-fuchsia-600":"bg-white dark:bg-slate-900 border-gray-300 dark:border-slate-600"}`,children:_&&c.jsx("svg",{className:"w-2.5 h-2.5 text-white",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:4,children:c.jsx("path",{d:"M5 13l4 4L19 7"})})}),c.jsx("input",{type:"checkbox",checked:_,onChange:Me=>j(Me.target.checked),className:"hidden"}),c.jsx("span",{className:"text-[10px] font-bold text-gray-700 dark:text-slate-300",children:"Hanning"})]}),c.jsxs("label",{className:"flex items-center gap-2 cursor-pointer select-none",children:[c.jsx("div",{className:`w-3.5 h-3.5 rounded-md border flex items-center justify-center transition-colors ${S?"bg-cyan-600 border-cyan-600":"bg-white dark:bg-slate-900 border-gray-300 dark:border-slate-600"}`,children:S&&c.jsx("svg",{className:"w-2.5 h-2.5 text-white",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:4,children:c.jsx("path",{d:"M5 13l4 4L19 7"})})}),c.jsx("input",{type:"checkbox",checked:S,onChange:Me=>k(Me.target.checked),className:"hidden"}),c.jsx("span",{className:"text-[10px] font-bold text-gray-700 dark:text-slate-300",children:"Average"})]})]}),c.jsxs("div",{className:"flex gap-2 bg-gray-100 dark:bg-slate-800 p-1 rounded-lg border border-gray-200 dark:border-slate-700",children:[c.jsxs("button",{onClick:()=>A(!T),className:`px-2.5 py-1 rounded-md border text-[11px] font-bold transition-all flex items-center gap-1.5 ${T?"bg-cyan-900/40 text-cyan-400 border-cyan-500 shadow-[0_0_8px_rgba(6,182,212,0.3)]":"bg-white dark:bg-slate-900 text-gray-400 border-gray-300 dark:border-slate-700"}`,children:[c.jsx("div",{className:`w-2 h-2 rounded-full ${T?"bg-cyan-400":"bg-gray-400"}`})," H"]}),c.jsxs("button",{onClick:()=>$(!D),className:`px-2.5 py-1 rounded-md border text-[11px] font-bold transition-all flex items-center gap-1.5 ${D?"bg-cyan-900/40 text-cyan-400 border-cyan-500 shadow-[0_0_8px_rgba(6,182,212,0.3)]":"bg-white dark:bg-slate-900 text-gray-400 border-gray-300 dark:border-slate-700"}`,children:[c.jsx("div",{className:`w-2 h-2 rounded-full ${T?"bg-cyan-400":"bg-gray-400"}`})," V"]})]}),c.jsxs("div",{className:"ml-auto flex gap-2",children:[c.jsx("button",{onClick:()=>Ut(!Jt),className:`px-3 py-1.5 rounded-lg text-[10px] font-bold transition-all border ${Jt?"bg-emerald-600 text-white border-emerald-600 shadow-md":"bg-white dark:bg-slate-900 text-emerald-600 dark:text-emerald-400 border-emerald-200 dark:border-emerald-800 hover:bg-emerald-50"}`,children:""}),c.jsx("button",{onClick:()=>Zt(!ht),className:`px-3 py-1.5 rounded-lg text-[10px] font-bold transition-all border ${ht?"bg-indigo-600 text-white border-indigo-600 shadow-md":"bg-white dark:bg-slate-900 text-indigo-600 dark:text-indigo-400 border-indigo-200 dark:border-indigo-800 hover:bg-indigo-50"}`,children:"ROI"})]})]}),c.jsxs("div",{className:"flex items-center gap-4 justify-end border-t border-gray-200 dark:border-slate-800/50 pt-2.5",children:[c.jsx("button",{onClick:R,className:"px-4 py-1 text-[10px] font-bold bg-cyan-600/10 text-cyan-600 dark:text-cyan-400 hover:bg-cyan-600/20 rounded-md border border-cyan-500/30 transition-all uppercase tracking-widest shadow-sm",children:"Auto"}),c.jsxs("div",{className:"flex items-center gap-2 text-[10px] font-bold text-gray-500 dark:text-slate-400 uppercase",children:["Y-AXIS (LOG)",c.jsxs("div",{className:"flex items-center bg-white dark:bg-slate-800 border border-gray-200 dark:border-slate-700 rounded-md overflow-hidden shadow-sm",children:[c.jsx("input",{type:"text",value:w,onChange:Me=>b(Me.target.value),className:"w-14 px-2 py-1 bg-transparent text-center outline-none text-gray-900 dark:text-slate-100 border-r border-gray-200 dark:border-slate-700"}),c.jsx("span",{className:"px-2 text-gray-400",children:"to"}),c.jsx("input",{type:"text",value:x,onChange:Me=>y(Me.target.value),className:"w-14 px-2 py-1 bg-transparent text-center outline-none text-gray-900 dark:text-slate-100"})]})]})]})]}),c.jsxs("div",{className:"flex-1 p-4 overflow-hidden flex flex-col gap-2 relative bg-gray-50/30 dark:bg-slate-900/30",children:[c.jsx("div",{className:"absolute inset-0 flex items-center justify-center pointer-events-none z-[50] select-none opacity-10",children:c.jsx("svg",{viewBox:"0 0 500 100",className:"w-3/4 h-auto drop-shadow-lg",children:c.jsx("text",{x:"50%",y:"50%",dominantBaseline:"middle",textAnchor:"middle",className:"fill-gray-900 dark:fill-white",fontSize:"24",fontWeight:"bold",style:{fontFamily:"sans-serif",letterSpacing:"0.05em"},children:" y-g-jiang.github.io"})})}),we&&c.jsxs("div",{className:"absolute inset-0 flex flex-col items-center justify-center z-[55] bg-white/90 dark:bg-slate-900/90 backdrop-blur-[2px]",children:[c.jsx("div",{className:"w-10 h-10 border-4 border-cyan-500 border-t-transparent rounded-full animate-spin mb-4"}),c.jsx("span",{className:"text-cyan-600 dark:text-cyan-400 font-bold",children:"Computing FFT Stack..."}),h&&h.length>1&&c.jsxs("span",{className:"text-xs text-gray-500 mt-2 font-mono",children:["Processing frame ",it," / ",h.length]})]}),se?c.jsx("div",{className:"flex items-center justify-center h-full text-red-500 font-semibold",children:se}):c.jsxs("div",{className:"flex-1 bg-white dark:bg-slate-950 border border-gray-200 dark:border-slate-800 rounded-xl p-2 flex flex-col relative z-20 shadow-xl overflow-hidden",children:[c.jsx("div",{className:"flex-1 relative z-10",onMouseDown:Ct,onMouseMove:tt,onMouseUp:Hr,style:{cursor:ir?"col-resize":"crosshair"},children:c.jsx(Oo,{width:"100%",height:"100%",children:c.jsxs(Kl,{data:ct,margin:{top:10,right:10,bottom:20,left:0},children:[c.jsx(mo,{strokeDasharray:"3 3",stroke:"#374151",opacity:.08}),c.jsx(Ka,{dataKey:"freq",type:"number",domain:[0,.5],tickCount:6,tick:{fill:"#6b7280",fontSize:10},label:{value:"Frequency (cy/px)",position:"insideBottom",offset:-10,fill:"#6b7280",fontSize:11}}),c.jsx(Ya,{scale:"log",domain:[Math.pow(10,parseFloat(w)),Math.pow(10,parseFloat(x))],allowDataOverflow:!0,tick:{fill:"#6b7280",fontSize:10},tickFormatter:Me=>Number(Me).toExponential(0),width:45}),c.jsx(aa,{contentStyle:{backgroundColor:"rgba(15, 23, 42, 0.95)",border:"1px solid #334155",color:"#f3f4f6",fontSize:"11px",borderRadius:"8px"},formatter:Me=>[Number(Me).toExponential(3),""],labelFormatter:Me=>`Freq: ${Number(Me).toFixed(4)}`}),c.jsx(Do,{wrapperStyle:{fontSize:"10px"}}),c.jsx(ia,{type:"monotone",dataKey:"theory",name:"Theory Model",stroke:"#6366f1",strokeWidth:2,dot:!1,isAnimationActive:!1}),Ce.flatMap(Me=>{if(g!==-1&&g!==Me)return[];const ut=`c${Me}_h`,gt=`c${Me}_v`,yr=ye[`c${Me}`],lr=[];return T&&lr.push(c.jsx(ia,{type:"linear",dataKey:ut,name:`${ze[Me]} (H)`,stroke:yr,strokeWidth:1,dot:!1,isAnimationActive:!1},`${Me}_h`)),D&&lr.push(c.jsx(ia,{type:"linear",dataKey:gt,name:`${ze[Me]} (V)`,stroke:yr,strokeWidth:1,strokeDasharray:"3 3",dot:!1,isAnimationActive:!1},`${Me}_v`)),lr}),Lt&&c.jsx(z0,{x1:Lt[0],x2:Lt[1],fill:"#8884d8",fillOpacity:.15})]})})}),mr&&Lt&&c.jsxs("div",{className:"absolute bottom-12 left-12 bg-slate-900/90 backdrop-blur-md p-3 rounded-lg border border-indigo-500/50 shadow-2xl z-30 text-[10px] font-mono text-slate-100",children:[c.jsxs("div",{className:"text-indigo-400 font-bold mb-1 border-b border-indigo-500/30 pb-1",children:["Range: ",Lt[0].toFixed(3),"-",Lt[1].toFixed(3)]}),Object.entries(mr.stats).map(([Me,ut])=>c.jsxs("div",{className:"flex justify-between gap-4",children:[c.jsxs("span",{className:"text-slate-400",children:[Me,":"]}),c.jsx("span",{className:"font-bold text-cyan-400",children:ut.toFixed(5)})]},Me))]})]})]}),Jt&&c.jsxs("div",{className:"absolute top-48 right-8 z-[55] w-72 bg-white dark:bg-slate-900 rounded-xl shadow-2xl border border-gray-200 dark:border-slate-700 p-4 animate-in slide-in-from-top-2",children:[c.jsx("h4",{className:"text-[10px] uppercase font-bold text-emerald-600 dark:text-emerald-400 mb-2 border-b border-gray-100 dark:border-slate-800 pb-1",children:"Range Averaging"}),c.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[c.jsx("input",{type:"number",step:"0.01",value:ce,onChange:Me=>de(Me.target.value),className:"w-16 px-1 py-0.5 text-xs border rounded bg-transparent dark:border-slate-600 dark:text-white"}),c.jsx("span",{className:"text-gray-400",children:"-"}),c.jsx("input",{type:"number",step:"0.01",value:Ne,onChange:Me=>pe(Me.target.value),className:"w-16 px-1 py-0.5 text-xs border rounded bg-transparent dark:border-slate-600 dark:text-white"}),c.jsx("button",{onClick:ot,className:"flex-1 bg-emerald-600 text-white text-[10px] font-bold py-1 rounded",children:"Avg"})]}),c.jsx("div",{className:"flex flex-col gap-2 max-h-48 overflow-y-auto",children:Ce.map(Me=>{const ut=or[Me];if(!ut)return null;const gt=ye[`c${Me}`];return c.jsxs("div",{className:"bg-gray-50 dark:bg-slate-800/50 p-2 rounded text-[10px] border border-gray-100 dark:border-slate-800",children:[c.jsxs("div",{className:"flex items-center gap-2 font-bold mb-1",style:{color:gt},children:[ze[Me]," ",c.jsxs("span",{className:"text-gray-400 font-normal",children:["(",ut.count," pts)"]})]}),c.jsxs("div",{className:"grid grid-cols-2 gap-x-2 text-gray-700 dark:text-slate-300 font-mono",children:[c.jsxs("div",{children:["H: ",ut.h.toExponential(3)]}),c.jsxs("div",{children:["V: ",ut.v.toExponential(3)]})]})]},Me)})})]}),ht&&c.jsx("div",{className:"absolute top-48 right-8 z-[55] w-56 bg-white dark:bg-slate-900 rounded-xl shadow-2xl border border-gray-200 dark:border-slate-700 p-4 animate-in slide-in-from-top-2",children:c.jsxs("div",{className:"flex flex-col gap-3",children:[c.jsxs("div",{children:[c.jsx("h4",{className:"text-[9px] uppercase font-bold text-gray-400 mb-1",children:"Move"}),c.jsxs("div",{className:"grid grid-cols-3 gap-1",children:[c.jsx("div",{}),c.jsx("button",{onClick:()=>sr(0,-1),className:"p-1.5 bg-gray-100 dark:bg-slate-800 rounded",children:""}),c.jsx("div",{}),c.jsx("button",{onClick:()=>sr(-1,0),className:"p-1.5 bg-gray-100 dark:bg-slate-800 rounded",children:""}),c.jsx("div",{}),c.jsx("button",{onClick:()=>sr(1,0),className:"p-1.5 bg-gray-100 dark:bg-slate-800 rounded",children:""}),c.jsx("div",{}),c.jsx("button",{onClick:()=>sr(0,1),className:"p-1.5 bg-gray-100 dark:bg-slate-800 rounded",children:""}),c.jsx("div",{})]})]}),c.jsxs("div",{children:[c.jsx("h4",{className:"text-[9px] uppercase font-bold text-gray-400 mb-1",children:"Size"}),c.jsxs("div",{className:"grid grid-cols-2 gap-1",children:[c.jsx("button",{onClick:()=>Fr(2,0),className:"p-1 bg-gray-100 dark:bg-slate-800 rounded",children:"W+"}),c.jsx("button",{onClick:()=>Fr(-2,0),className:"p-1 bg-gray-100 dark:bg-slate-800 rounded",children:"W-"}),c.jsx("button",{onClick:()=>Fr(0,2),className:"p-1 bg-gray-100 dark:bg-slate-800 rounded",children:"H+"}),c.jsx("button",{onClick:()=>Fr(0,-2),className:"p-1 bg-gray-100 dark:bg-slate-800 rounded",children:"H-"})]})]})]})}),c.jsx(Tie,{isOpen:ke,onClose:()=>me(!1),rawImageData:n,roi:a,selectedChannel:g===-1?Ce[0]:g,channelName:g===-1?`${ze[Ce[0]]} (Default)`:ze[g],zIndex:s?s+2:102,onFocus:l})]}):null},$ie=({isOpen:e,onClose:t,onMinimize:r,rawImageData:n,roi:a,isBGGR:i,zIndex:o,onFocus:s,initialPosition:l,initialInternalState:u,onUpdateState:d})=>{const f=!!(n!=null&&n.isThreePlane),h=P.useMemo(()=>Gm(f,i),[f,i]),g=h.keys,v=h.keyToIndex,[w,b]=P.useState((u==null?void 0:u.selectedChannelKey)||h.defaultPrimaryKey),[x,y]=P.useState((u==null?void 0:u.blackLevel)??0),[_,j]=P.useState((u==null?void 0:u.whiteLevel)??16383),[S,k]=P.useState(null),[M,N]=P.useState(!1),[T,A]=P.useState(null),[D,$]=P.useState(l||{x:150,y:150}),[B,J]=P.useState(!1),W=P.useRef({x:0,y:0});P.useEffect(()=>{d&&d({selectedChannelKey:w,blackLevel:x,whiteLevel:_})},[w,x,_]),P.useEffect(()=>{g.includes(w)||b(h.defaultPrimaryKey)},[g,w,h]),P.useEffect(()=>{if(e&&n&&!u){const V=n.blackLevels?Math.floor(n.blackLevels[1]):0;y(V),j(n.whiteLevel||16383),k(null)}},[e,n]);const I=()=>{if(!n||!a)return;A(null),N(!0);const V=v[w];if(V===void 0){A("Invalid channel selection."),N(!1);return}setTimeout(()=>{try{const z=WT(n.data,n.width,n.height,a,V,x,_,!!n.isThreePlane);z?k(z):(A("No data found in selection with current filters."),k(null))}catch(z){console.error("Analysis failed:",z),A(z.message||"Analysis error")}finally{N(!1)}},50)},G=(V,z,q)=>{s&&s(),!(q.closest("button")||q.closest("input")||q.closest("select"))&&(J(!0),W.current={x:V-D.x,y:z-D.y})},U=V=>{G(V.clientX,V.clientY,V.target)},X=V=>{const z=V.touches[0];G(z.clientX,z.clientY,V.target)};return P.useEffect(()=>{const V=q=>{if(B){const te="touches"in q?q.touches[0].clientX:q.clientX,ie="touches"in q?q.touches[0].clientY:q.clientY;$({x:te-W.current.x,y:ie-W.current.y})}},z=()=>J(!1);return B&&(window.addEventListener("mousemove",V),window.addEventListener("mouseup",z),window.addEventListener("touchmove",V,{passive:!1}),window.addEventListener("touchend",z)),()=>{window.removeEventListener("mousemove",V),window.removeEventListener("mouseup",z),window.removeEventListener("touchmove",V),window.removeEventListener("touchend",z)}},[B]),e?c.jsxs("div",{className:"fixed flex flex-col bg-white dark:bg-slate-900 border border-gray-200 dark:border-slate-700 shadow-2xl rounded-xl resize-both overflow-hidden min-w-[500px] min-h-[400px] w-[900px] h-[700px]",style:{left:D.x,top:D.y,zIndex:o??100},onMouseDownCapture:s,children:[c.jsxs("div",{className:`flex justify-between items-center p-4 border-b border-gray-200 dark:border-slate-700 bg-white dark:bg-slate-900 select-none touch-none ${B?"cursor-grabbing":"cursor-grab"}`,onMouseDown:U,onTouchStart:X,children:[c.jsx("h2",{className:"text-xl font-bold text-gray-900 dark:text-slate-100 flex items-center gap-2 pointer-events-none",children:"Quantization Step Analysis"}),c.jsxs("div",{className:"flex items-center gap-1",children:[r&&c.jsx("button",{onClick:r,className:"text-gray-400 hover:text-gray-600 dark:hover:text-slate-300 p-2 rounded-lg hover:bg-gray-100 dark:hover:bg-slate-800 transition-colors",children:c.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M20 12H4"})})}),c.jsx("button",{onClick:t,className:"text-gray-400 hover:text-gray-600 dark:hover:text-slate-200 p-2",children:c.jsx("svg",{className:"w-6 h-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]})]}),c.jsxs("div",{className:"p-4 bg-gray-50 dark:bg-slate-800/50 border-b border-gray-200 dark:border-slate-700 flex flex-wrap gap-4 items-end flex-shrink-0",children:[c.jsxs("div",{className:"flex flex-col gap-1",children:[c.jsx("label",{className:"text-xs font-bold text-gray-500 dark:text-slate-400 uppercase",children:"Channel"}),c.jsx("select",{value:w,onChange:V=>b(V.target.value),className:"bg-white dark:bg-slate-700 border border-gray-300 dark:border-slate-600 rounded px-3 py-1.5 text-sm text-gray-900 dark:text-slate-100 outline-none focus:ring-1 focus:ring-cyan-500 min-w-[80px]",children:g.map(V=>c.jsx("option",{value:V,children:V},V))})]}),c.jsxs("div",{className:"flex flex-col gap-1",children:[c.jsx("label",{className:"text-xs font-bold text-gray-500 dark:text-slate-400 uppercase",children:"Black Level"}),c.jsx("input",{type:"number",value:x,onChange:V=>y(Number(V.target.value)),className:"w-24 px-3 py-1.5 bg-white dark:bg-slate-700 border border-gray-300 dark:border-slate-600 rounded outline-none text-sm text-gray-900 dark:text-slate-100"})]}),c.jsxs("div",{className:"flex flex-col gap-1",children:[c.jsx("label",{className:"text-xs font-bold text-gray-500 dark:text-slate-400 uppercase",children:"White Level"}),c.jsx("input",{type:"number",value:_,onChange:V=>j(Number(V.target.value)),className:"w-24 px-3 py-1.5 bg-white dark:bg-slate-700 border border-gray-300 dark:border-slate-600 rounded outline-none text-sm text-gray-900 dark:text-slate-100"})]}),c.jsx("button",{onClick:I,disabled:M,className:"mb-0.5 px-5 py-1.5 bg-cyan-600 hover:bg-cyan-500 text-white font-bold rounded shadow-sm hover:shadow transition-colors disabled:opacity-50 text-sm",children:M?"Analyzing...":"Run Analysis"})]}),c.jsxs("div",{className:"flex-1 overflow-y-auto p-4 flex flex-col gap-4 bg-white dark:bg-slate-900 min-h-0",children:[T&&c.jsx("div",{className:"p-3 bg-red-100 dark:bg-red-900/30 text-red-700 dark:text-red-300 rounded text-sm text-center flex-shrink-0",children:T}),!S&&!M&&!T&&c.jsx("div",{className:"flex-1 flex flex-col items-center justify-center text-gray-400 dark:text-slate-500 h-full",children:c.jsx("p",{children:"Configure parameters and click Run Analysis"})}),S&&c.jsxs(c.Fragment,{children:[c.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 flex-shrink-0",children:[c.jsxs("div",{className:"bg-gray-100 dark:bg-slate-800 p-3 rounded-lg border border-gray-200 dark:border-slate-700 text-center",children:[c.jsx("div",{className:"text-xs text-gray-500 dark:text-slate-400 uppercase mb-1",children:"Unique Codes"}),c.jsx("div",{className:"text-xl font-bold text-gray-900 dark:text-slate-100",children:S.uniqueCount})]}),c.jsxs("div",{className:"bg-gray-100 dark:bg-slate-800 p-3 rounded-lg border border-gray-200 dark:border-slate-700 text-center",children:[c.jsx("div",{className:"text-xs text-gray-500 dark:text-slate-400 uppercase mb-1",children:"Total Diffs"}),c.jsx("div",{className:"text-xl font-bold text-gray-900 dark:text-slate-100",children:S.diffCount})]})]}),c.jsxs("div",{className:"bg-white dark:bg-slate-800/50 rounded-xl border border-gray-200 dark:border-slate-700 overflow-hidden flex-shrink-0",children:[c.jsx("div",{className:"px-4 py-2 bg-gray-50 dark:bg-slate-800 border-b border-gray-200 dark:border-slate-700 text-xs font-bold text-gray-500 dark:text-slate-400 uppercase",children:"Step Distribution"}),c.jsx("div",{className:"p-4 flex flex-wrap gap-x-8 gap-y-2 text-sm font-mono max-h-32 overflow-y-auto",children:Object.entries(S.stepCounts).sort((V,z)=>parseFloat(V[0])-parseFloat(z[0])).map(([V,z])=>c.jsxs("div",{className:"flex gap-2",children:[c.jsxs("span",{className:"text-gray-500 dark:text-slate-400",children:["Step ",V,":"]}),c.jsx("span",{className:"text-cyan-600 dark:text-cyan-400 font-bold",children:String(z)})]},V))})]}),c.jsxs("div",{className:"flex-1 bg-white dark:bg-slate-900 border border-gray-200 dark:border-slate-700 rounded-xl p-2 relative overflow-hidden min-h-[300px]",children:[c.jsx("div",{className:"absolute top-2 left-4 text-xs font-bold text-gray-400 dark:text-slate-500 pointer-events-none z-20 bg-white/80 dark:bg-slate-900/80 px-2 rounded",children:"Step Size vs Code Value"}),c.jsx("div",{className:"absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 z-0 pointer-events-none select-none opacity-10 mix-blend-normal dark:mix-blend-plus-lighter",children:c.jsx("svg",{viewBox:"0 0 500 60",className:"w-96 h-auto",children:c.jsx("text",{x:"50%",y:"50%",dominantBaseline:"middle",textAnchor:"middle",className:"fill-gray-900 dark:fill-white",fontSize:"36",fontWeight:"bold",style:{fontFamily:"sans-serif",letterSpacing:"0.05em"},children:" y-g-jiang.github.io"})})}),c.jsx("div",{className:"relative z-10 w-full h-full",children:c.jsx(Oo,{width:"100%",height:"100%",children:c.jsxs(Kl,{data:S.plotData,margin:{top:20,right:20,bottom:20,left:10},children:[c.jsx(mo,{strokeDasharray:"3 3",stroke:"#374151",opacity:.1}),c.jsx(Ka,{dataKey:"x",type:"number",domain:["auto","auto"],tick:{fill:"#9ca3af",fontSize:10},label:{value:"Code Value (Shifted)",position:"insideBottom",offset:-10,fill:"#9ca3af",fontSize:11}}),c.jsx(Ya,{tick:{fill:"#9ca3af",fontSize:10},domain:[0,"auto"],allowDataOverflow:!1,label:{value:"Step Size (Delta)",angle:-90,position:"insideLeft",fill:"#9ca3af",fontSize:11}}),c.jsx(aa,{contentStyle:{backgroundColor:"rgba(17, 24, 39, 0.95)",border:"1px solid #374151",borderRadius:"0.5rem",color:"#f3f4f6",fontSize:"12px"},labelFormatter:V=>`Val: ${V}`,formatter:V=>[V,"Step Size"]}),c.jsx(ia,{type:"stepAfter",dataKey:"y",stroke:"#0891b2",strokeWidth:1.5,dot:{r:1.5,fill:"#0891b2",strokeWidth:0},activeDot:{r:4},isAnimationActive:!1})]})})})]})]})]})]}):null},Lie=({isOpen:e,onClose:t,rawImageData:r,roi:n,isBGGR:a,zIndex:i,onFocus:o,initialPosition:s,stackFiles:l})=>{const u=!!(r!=null&&r.isThreePlane),d=P.useMemo(()=>Gm(u,a),[u,a]),f=d.keyToIndex,h=d.keys,[g,v]=P.useState("cross"),[w,b]=P.useState(d.defaultPrimaryKey),[x,y]=P.useState(d.defaultSecondaryKey),[_,j]=P.useState("H"),[S,k]=P.useState(null),[M,N]=P.useState(!1),[T,A]=P.useState(0),[D,$]=P.useState(0),[B,J]=P.useState("single");P.useEffect(()=>{h.includes(w)||b(d.defaultPrimaryKey),h.includes(x)||y(d.defaultSecondaryKey)},[h,w,x,d]);const W=async I=>{if(!r||!n)return;N(!0),J(I),A(0),k(null);const G=f[w],U=g==="cross"?f[x]:G;if(G===void 0||U===void 0){N(!1);return}let X=0,V=0;if(g==="self"){const z=d.selfAdjacentStep;_==="H"?V=z:X=z}setTimeout(async()=>{try{let z={sumCov:0,sumVar1:0,sumVar2:0,n:0};if(I==="single")z=aS(r.data,r.width,r.height,n,G,U,X,V,!!r.isThreePlane);else if(l&&l.length>0)for(let q=0;q<l.length;q++){A(q+1);const te=await l[q].arrayBuffer(),ie=await Pu(te),he=aS(ie.data,ie.width,ie.height,n,G,U,X,V,!!ie.isThreePlane);z.sumCov+=he.sumCov,z.sumVar1+=he.sumVar1,z.sumVar2+=he.sumVar2,z.n+=he.n}$(z.n),k(FT(z))}catch(z){console.error("Pearson calculation failed",z),alert("Calculation error: "+z.message)}finally{N(!1)}},50)};return e?c.jsxs(Cl,{initialPosition:s||{x:200,y:200},onClose:t,zIndex:i,onFocus:o,className:"w-80 bg-white dark:bg-slate-900 border border-gray-200 dark:border-slate-700 flex flex-col shadow-2xl overflow-hidden",children:[c.jsxs("div",{className:"flex justify-between items-center px-4 py-3 border-b border-gray-200 dark:border-slate-700 bg-gray-50 dark:bg-slate-800",children:[c.jsxs("h3",{className:"text-sm font-bold text-gray-700 dark:text-slate-200 flex items-center gap-2",children:["Pearson Correlation",c.jsx("span",{className:"text-[10px] font-normal bg-white dark:bg-slate-700 px-1.5 py-0.5 rounded border border-gray-200 dark:border-slate-600",children:"r"})]}),c.jsx("button",{onClick:t,className:"text-gray-400 hover:text-red-500 transition-colors",children:c.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),c.jsxs("div",{className:"p-4 flex flex-col gap-4",children:[c.jsxs("div",{className:"flex bg-gray-100 dark:bg-slate-800 p-1 rounded-lg border border-gray-200 dark:border-slate-700",children:[c.jsx("button",{onClick:()=>v("cross"),className:`flex-1 py-1 text-[10px] font-bold rounded transition-all ${g==="cross"?"bg-indigo-600 text-white shadow":"text-gray-500 dark:text-slate-400 hover:bg-gray-200 dark:hover:bg-slate-700"}`,children:"Cross-Channel"}),c.jsx("button",{onClick:()=>v("self"),className:`flex-1 py-1 text-[10px] font-bold rounded transition-all ${g==="self"?"bg-indigo-600 text-white shadow":"text-gray-500 dark:text-slate-400 hover:bg-gray-200 dark:hover:bg-slate-700"}`,children:"Self-Adjacent"})]}),c.jsxs("div",{className:"flex items-center gap-3",children:[c.jsxs("div",{className:"flex-1 flex flex-col gap-1",children:[c.jsx("label",{className:"text-[9px] uppercase font-bold text-gray-400",children:g==="cross"?"Channel 1":"Channel"}),c.jsx("select",{value:w,onChange:I=>b(I.target.value),className:"bg-gray-100 dark:bg-slate-800 border border-gray-200 dark:border-slate-700 rounded px-2 py-1.5 text-xs text-gray-700 dark:text-slate-200 outline-none focus:ring-1 focus:ring-indigo-500",children:h.map(I=>c.jsx("option",{value:I,children:I},I))})]}),c.jsx("div",{className:"text-gray-300 dark:text-slate-600 mt-4 font-mono",children:g==="cross"?"x":"->"}),c.jsxs("div",{className:"flex-1 flex flex-col gap-1",children:[c.jsx("label",{className:"text-[9px] uppercase font-bold text-gray-400",children:g==="cross"?"Channel 2":"Direction"}),g==="cross"?c.jsx("select",{value:x,onChange:I=>y(I.target.value),className:"bg-gray-100 dark:bg-slate-800 border border-gray-200 dark:border-slate-700 rounded px-2 py-1.5 text-xs text-gray-700 dark:text-slate-200 outline-none focus:ring-1 focus:ring-indigo-500",children:h.map(I=>c.jsx("option",{value:I,children:I},I))}):c.jsxs("div",{className:"flex h-[28px] bg-gray-100 dark:bg-slate-800 rounded border border-gray-200 dark:border-slate-700 p-0.5",children:[c.jsx("button",{onClick:()=>j("H"),className:`flex-1 text-[9px] font-bold rounded ${_==="H"?"bg-slate-300 dark:bg-slate-600 text-indigo-600 dark:text-indigo-400":"text-gray-400"}`,children:"Horiz"}),c.jsx("button",{onClick:()=>j("V"),className:`flex-1 text-[9px] font-bold rounded ${_==="V"?"bg-slate-300 dark:bg-slate-600 text-indigo-600 dark:text-indigo-400":"text-gray-400"}`,children:"Vert"})]})]})]}),c.jsxs("div",{className:"grid grid-cols-1 gap-2",children:[c.jsx("button",{onClick:()=>W("single"),disabled:M,className:"w-full py-2 bg-indigo-600 hover:bg-indigo-500 disabled:bg-gray-400 text-white font-bold rounded shadow-md transition-all active:scale-95 text-xs",children:M&&B==="single"?"Calculating...":"Calc Current Frame"}),l&&l.length>0&&c.jsxs("button",{onClick:()=>W("stack"),disabled:M,className:"w-full py-2 bg-emerald-600 hover:bg-emerald-500 disabled:bg-gray-400 text-white font-bold rounded shadow-md transition-all active:scale-95 text-xs flex flex-col items-center justify-center",children:[c.jsx("span",{children:"Calc Stack Concatenated"}),M&&B==="stack"&&c.jsxs("span",{className:"text-[9px] font-normal opacity-80",children:["Progress: ",T," / ",l.length]})]})]}),S!==null&&c.jsxs("div",{className:"mt-2 p-4 bg-gray-50 dark:bg-slate-800/50 rounded-xl border border-gray-200 dark:border-slate-700 text-center animate-in fade-in slide-in-from-top-2",children:[c.jsxs("div",{className:"text-[10px] uppercase font-bold text-gray-400 dark:text-slate-500 mb-1",children:[g==="cross"?"Cross-Channel":`Self-Adj (${_})`," r"]}),c.jsx("div",{className:"text-2xl font-mono font-bold text-indigo-600 dark:text-indigo-400 select-all",style:{fontSize:"24px"},children:S.toFixed(5)}),c.jsxs("div",{className:"text-[9px] text-gray-400 mt-2 font-mono",children:["N = ",D.toLocaleString()," pairs"]}),c.jsx("div",{className:"mt-3 text-[10px] font-bold",children:Math.abs(S)>.5?c.jsx("span",{className:"text-red-500",children:"Significant Correlation"}):Math.abs(S)>.1?c.jsx("span",{className:"text-amber-500",children:"Weak Correlation"}):c.jsx("span",{className:"text-emerald-500",children:"Near-Zero (Uncorrelated)"})})]})]}),c.jsx("div",{className:"p-3 bg-gray-50/50 dark:bg-slate-800/30 text-[9px] text-gray-400 dark:text-slate-600 italic border-t border-gray-100 dark:border-slate-800",children:g==="cross"?u?"Comparing two channels at the same RGB pixel.":"Comparing two color channels in the same Bayer 2x2 cells.":`Comparing pixel (r,c) with (r${_==="V"?`+${d.selfAdjacentStep}`:""}, c${_==="H"?`+${d.selfAdjacentStep}`:""}) in the same channel.`})]}):null},Bie=[{href:"https://y-g-jiang.github.io/CBLD.html",text:" (Primary Source)",abbr:"CBLD",description:"ISO",highlight:!0},{href:"https://y-G-jiang.github.io/LAC.html",text:"",abbr:"LAC",description:""},{href:"https://y-G-jiang.github.io/CCGV.html",text:"adobeIECMF",abbr:"CCGV",description:"acrRAWxy"},{href:"https://y-G-jiang.github.io/JTJS.html",text:"",abbr:"JTJS",description:"CMF/"},{href:"https://y-G-jiang.github.io/XJZS.html",text:"",abbr:"XJZS",description:""}],Fie=["5","9","0","8","2","1","4","7","3","6"],Q4=e=>!e||e==="--"?"--":String(e).split("").map(t=>{const r=parseInt(t);return isNaN(r)?t:Fie[r]}).join(""),Uie=({isOpen:e,onClose:t})=>{const[r,n]=P.useState({pv:"--",uv:"--"});return P.useEffect(()=>{if(e){const a=()=>{const o=document.getElementById("vercount_value_site_pv"),s=document.getElementById("vercount_value_site_uv");o&&s&&n({pv:o.innerText||"--",uv:s.innerText||"--"})};a();const i=setTimeout(a,1e3);return()=>clearTimeout(i)}},[e]),e?c.jsx("div",{className:"fixed inset-0 z-[100] flex items-center justify-center bg-black/60 backdrop-blur-sm p-4 animate-in fade-in duration-200",onClick:t,children:c.jsxs("div",{className:"bg-white dark:bg-slate-900 w-full max-w-3xl rounded-2xl shadow-2xl border border-gray-200 dark:border-slate-700 overflow-hidden flex flex-col max-h-[90vh]",onClick:a=>a.stopPropagation(),children:[c.jsxs("div",{className:"flex justify-between items-center p-5 border-b border-gray-200 dark:border-slate-700 bg-gray-50 dark:bg-slate-800/50",children:[c.jsx("h2",{className:"text-xl font-bold text-gray-900 dark:text-white",children:"About / Tools"}),c.jsx("button",{onClick:t,className:"text-gray-400 hover:text-gray-600 dark:hover:text-slate-200 transition-colors p-1 rounded hover:bg-gray-200 dark:hover:bg-slate-700",children:c.jsx("svg",{className:"w-6 h-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),c.jsxs("div",{className:"p-6 overflow-y-auto scrollbar-thin scrollbar-thumb-gray-300 dark:scrollbar-thumb-slate-700 relative",children:[c.jsx("div",{className:"mb-8 p-4 bg-gray-50 dark:bg-slate-800/50 rounded-xl border border-gray-100 dark:border-slate-700 text-center",children:c.jsxs("p",{className:"text-lg text-gray-700 dark:text-slate-300",children:[c.jsx("span",{className:"font-bold mr-2",children:"about:"}),c.jsx("a",{href:"https://y-g-jiang.github.io/JOindex.html",target:"_blank",rel:"noopener noreferrer",className:"text-cyan-600 dark:text-cyan-400 hover:underline break-all font-mono",children:"https://y-g-jiang.github.io/JOindex.html"})]})}),c.jsxs("div",{className:"flex items-center gap-4 mb-6",children:[c.jsx("div",{className:"h-px bg-gray-200 dark:bg-slate-700 flex-1"}),c.jsx("span",{className:"text-sm font-bold text-gray-400 dark:text-slate-500 uppercase tracking-wider",children:"Primary Resources"}),c.jsx("div",{className:"h-px bg-gray-200 dark:bg-slate-700 flex-1"})]}),c.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4 mb-8",children:Bie.map(a=>c.jsxs("a",{href:a.href,target:"_blank",rel:"noopener noreferrer",className:`group block p-4 rounded-xl border transition-all duration-200 relative overflow-hidden ${a.highlight?"border-cyan-500 dark:border-cyan-400 bg-cyan-50/30 dark:bg-cyan-900/10 shadow-lg scale-[1.02] ring-2 ring-cyan-500/20":"border-gray-200 dark:border-slate-700 bg-white dark:bg-slate-800/30 hover:bg-gray-50 dark:hover:bg-slate-800 hover:border-cyan-500"}`,children:[c.jsx("div",{className:"absolute top-0 right-0 w-16 h-16 bg-gradient-to-bl from-cyan-500/5 to-transparent -mr-8 -mt-8 rounded-full pointer-events-none group-hover:from-cyan-500/10 transition-colors"}),c.jsxs("div",{className:"flex items-center gap-3 mb-2 relative z-10",children:[c.jsx("span",{className:`px-2 py-1 text-xs font-bold rounded transition-colors border ${a.highlight?"bg-cyan-600 text-white border-cyan-500":"bg-gray-100 dark:bg-slate-700 text-gray-600 dark:text-slate-300 border-gray-200 dark:border-slate-600 group-hover:border-cyan-200"}`,children:a.abbr}),c.jsx("h3",{className:`font-bold transition-colors ${a.highlight?"text-cyan-700 dark:text-cyan-300":"text-gray-800 dark:text-slate-200 group-hover:text-cyan-600"}`,children:a.text})]}),c.jsx("p",{className:`text-xs pl-1 transition-colors relative z-10 ${a.highlight?"text-cyan-600/80 dark:text-cyan-400/80":"text-gray-500 dark:text-slate-400"}`,children:a.description})]},a.abbr))}),c.jsx("div",{className:"flex justify-end mt-4",children:c.jsx("div",{className:"bg-gray-50 dark:bg-slate-900/50 rounded border border-gray-200 dark:border-slate-800 p-1.5 opacity-40 hover:opacity-100 transition-opacity cursor-default select-none group",children:c.jsxs("div",{className:"font-mono text-[10px] text-gray-400 dark:text-slate-600 leading-tight text-right flex flex-col",children:[c.jsx("span",{className:"group-hover:text-indigo-400 transition-colors",children:Q4(r.pv)}),c.jsx("span",{className:"group-hover:text-emerald-400 transition-colors",children:Q4(r.uv)})]})})})]})]})}):null},Gie=({isOpen:e,onClose:t,data:r,fileName:n,warning:a})=>{const[i,o]=P.useState(""),s=d=>{const f=new WeakSet;try{return JSON.stringify(d,(h,g)=>{if(typeof g=="bigint")return g.toString()+"n";if(typeof g=="object"&&g!==null){if(f.has(g))return"[Circular]";if(f.add(g),ArrayBuffer.isView(g))return`[${g.constructor.name}]`}return g})}catch{return"[Unable to serialize object]"}},l=P.useMemo(()=>{if(!r)return[];const d=[],f=(h,g=0)=>{if(g>5)return"...";if(h==null)return String(h);if(h instanceof Date)return h.toLocaleString();if(typeof h=="number")return h.toString();if(typeof h=="string")return h;if(typeof h=="bigint")return h.toString()+"n";if(ArrayBuffer.isView(h))return`<${h.constructor.name} len=${h.length} bytes=${h.byteLength}>`;if(h instanceof ArrayBuffer)return`<ArrayBuffer bytes=${h.byteLength}>`;if(typeof h=="object"){if(Array.isArray(h))return h.length===0?"[]":h.length>20?`[${h.slice(0,10).map(b=>typeof b=="number"?b.toFixed(2):f(b,g+1)).join(", ")}, ... (+${h.length-10} more)]`:`[${h.map(w=>typeof w=="number"?Number.isInteger(w)?w:w.toFixed(4):f(w,g+1)).join(", ")}]`;try{const v=Object.keys(h);return v.length>5?`{Object with ${v.length} keys}`:s(h)}catch{return"<Complex Object>"}}return String(h)};try{if(typeof r!="object")return[{key:"Value",value:String(r)}];Object.keys(r).sort().forEach(g=>{if(g==="MakerNote"||g==="UserComment"||g.includes("Strip")||g.includes("Offset")){d.push({key:g,value:"<Binary/Internal Data>"});return}const v=r[g];d.push({key:g,value:f(v)})})}catch(h){console.error("Error processing EXIF data:",h),d.push({key:"Error",value:"Failed to process metadata structure."})}return d},[r]);if(!e)return null;const u=l.filter(d=>d.key.toLowerCase().includes(i.toLowerCase())||d.value.toLowerCase().includes(i.toLowerCase()));return c.jsx("div",{className:"fixed inset-0 z-[100] flex items-center justify-center bg-black/60 backdrop-blur-sm p-4 animate-in fade-in duration-200",onClick:t,children:c.jsxs("div",{className:"bg-white dark:bg-slate-900 w-full max-w-3xl max-h-[90vh] rounded-2xl shadow-2xl flex flex-col border border-gray-200 dark:border-slate-700",onClick:d=>d.stopPropagation(),children:[c.jsxs("div",{className:"flex justify-between items-center p-5 border-b border-gray-200 dark:border-slate-700",children:[c.jsxs("div",{className:"overflow-hidden",children:[c.jsx("h2",{className:"text-xl font-bold text-gray-900 dark:text-slate-100",children:"EXIF Data"}),c.jsx("p",{className:"text-sm text-gray-500 dark:text-slate-400 mt-1 font-mono truncate",children:n})]}),c.jsx("button",{onClick:t,className:"text-gray-400 hover:text-gray-600 dark:hover:text-slate-200 transition-colors p-2 rounded-full hover:bg-gray-100 dark:hover:bg-slate-800",children:c.jsx("svg",{className:"w-6 h-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),a&&c.jsx("div",{className:"bg-amber-50 dark:bg-amber-900/20 px-4 py-2 border-b border-amber-100 dark:border-amber-800/50 text-center",children:c.jsx("p",{className:"text-xs text-amber-600 dark:text-amber-400 whitespace-pre-line font-medium leading-relaxed",children:a})}),c.jsx("div",{className:"p-4 border-b border-gray-200 dark:border-slate-700 bg-gray-50 dark:bg-slate-800/50",children:c.jsxs("div",{className:"relative",children:[c.jsx("svg",{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-gray-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})}),c.jsx("input",{type:"text",placeholder:"Search tags...",value:i,onChange:d=>o(d.target.value),className:"w-full pl-9 pr-4 py-2 bg-white dark:bg-slate-900 border border-gray-300 dark:border-slate-600 rounded-lg text-sm focus:ring-2 focus:ring-cyan-500 outline-none text-gray-900 dark:text-slate-100 transition-colors placeholder-gray-400"})]})}),c.jsx("div",{className:"overflow-y-auto flex-1 p-0 scrollbar-thin scrollbar-thumb-gray-300 dark:scrollbar-thumb-slate-700",children:u.length>0?c.jsxs("table",{className:"w-full text-left border-collapse table-fixed",children:[c.jsx("thead",{className:"bg-gray-50 dark:bg-slate-800 sticky top-0 shadow-sm z-10",children:c.jsxs("tr",{children:[c.jsx("th",{className:"py-3 px-5 font-semibold text-xs text-gray-500 dark:text-slate-400 uppercase tracking-wider w-1/3 border-b border-gray-200 dark:border-slate-700",children:"Tag Name"}),c.jsx("th",{className:"py-3 px-5 font-semibold text-xs text-gray-500 dark:text-slate-400 uppercase tracking-wider w-2/3 border-b border-gray-200 dark:border-slate-700",children:"Value"})]})}),c.jsx("tbody",{className:"divide-y divide-gray-100 dark:divide-slate-800",children:u.map(d=>c.jsxs("tr",{className:"hover:bg-gray-50 dark:hover:bg-slate-800/50 transition-colors group",children:[c.jsx("td",{className:"py-2 px-5 text-sm font-medium text-cyan-600 dark:text-cyan-400 font-mono break-words align-top",children:d.key}),c.jsx("td",{className:"py-2 px-5 text-sm text-gray-700 dark:text-slate-300 font-mono break-words align-top group-hover:text-gray-900 dark:group-hover:text-slate-100",children:d.value})]},d.key))})]}):c.jsx("div",{className:"flex flex-col items-center justify-center h-64 text-gray-400 dark:text-slate-500",children:c.jsxs("p",{children:['No tags found matching "',i,'"']})})}),c.jsx("div",{className:"p-4 border-t border-gray-200 dark:border-slate-700 bg-gray-50 dark:bg-slate-800/50 flex justify-end rounded-b-2xl",children:c.jsx("button",{onClick:t,className:"px-4 py-2 bg-gray-200 hover:bg-gray-300 dark:bg-slate-700 dark:hover:bg-slate-600 text-gray-800 dark:text-white rounded-lg text-sm font-semibold transition-colors",children:"Close"})})]})})},zie=100,px=e=>{if(e.length===0)return 0;if(e.length===1)return e[0];if(e.length===2)return .5*(e[0]+e[1]);let t=[...e].sort((r,n)=>r-n);for(;t.length>4;){let r=1/0,n=0;const a=t.length,i=Math.floor(a/2);for(let o=0;o<=a-i;o++){const s=t[o+i-1]-t[o];s<r&&(r=s,n=o)}t=t.slice(n,n+i)}return t.reduce((r,n)=>r+n,0)/t.length},e_=({min:e,max:t,value:r,onChange:n,vertical:a=!1,logScale:i=!1})=>{const o=P.useRef(null),s=P.useRef(null),l=P.useCallback(y=>{const _=i?Math.max(1e-6,e):e,j=i?Math.max(_*1.0001,t):t,S=Math.max(_,Math.min(j,y));if(i){const k=Math.log10(_),M=Math.log10(j);return(Math.log10(S)-k)/(M-k)}return(S-_)/(j-_)},[e,t,i]),u=P.useCallback(y=>{const _=i?Math.max(1e-6,e):e,j=i?Math.max(_*1.0001,t):t;if(i){const S=Math.log10(_),k=Math.log10(j);return Math.pow(10,S+y*(k-S))}return _+y*(j-_)},[e,t,i]),d=(y,_)=>{y.preventDefault(),y.stopPropagation(),s.current=_;const j=k=>{if(!s.current||!o.current)return;const M=o.current.getBoundingClientRect();let N=0;a?N=(M.bottom-k.clientY)/M.height:N=(k.clientX-M.left)/M.width,N=Math.max(0,Math.min(1,N));const T=u(N);if(s.current==="min"){const A=r[1];n([Math.min(T,A),A])}else{const A=r[0];n([A,Math.max(T,A)])}},S=()=>{s.current=null,window.removeEventListener("mousemove",j),window.removeEventListener("mouseup",S)};window.addEventListener("mousemove",j),window.addEventListener("mouseup",S)},f=l(r[0])*100,h=l(r[1])*100,g=a?{left:"50%",top:0,bottom:0,width:"4px",transform:"translateX(-50%)"}:{top:"50%",left:0,right:0,height:"4px",transform:"translateY(-50%)"},v=a?{left:"50%",bottom:`${f}%`,height:`${h-f}%`,width:"4px",transform:"translateX(-50%)"}:{top:"50%",left:`${f}%`,width:`${h-f}%`,height:"4px",transform:"translateY(-50%)"},w="absolute w-3 h-3 bg-white border-2 border-cyan-600 rounded-full shadow-md cursor-pointer hover:scale-125 transition-transform z-10",b=a?{left:"50%",bottom:`${f}%`,transform:"translate(-50%, 50%)"}:{top:"50%",left:`${f}%`,transform:"translate(-50%, -50%)"},x=a?{left:"50%",bottom:`${h}%`,transform:"translate(-50%, 50%)"}:{top:"50%",left:`${h}%`,transform:"translate(-50%, -50%)"};return c.jsxs("div",{ref:o,className:`relative select-none ${a?"h-full w-4 py-2":"w-full h-4 px-2"}`,children:[c.jsx("div",{className:"absolute bg-gray-300 dark:bg-slate-600 rounded-full",style:g}),c.jsx("div",{className:"absolute bg-cyan-500 dark:bg-cyan-400 rounded-full",style:v}),c.jsx("div",{className:w,style:b,onMouseDown:y=>d(y,"min")}),c.jsx("div",{className:w,style:x,onMouseDown:y=>d(y,"max")})]})},Wie=({isOpen:e,onClose:t,data:r,blackLevel:n,imageHeight:a,isBGGR:i,importedMetadata:o,theme:s,initialCameraModel:l,initialISO:u})=>{const[d,f]=P.useState("Noise"),[h,g]=P.useState(!0),[v,w]=P.useState(null),[b,x]=P.useState("default"),[y,_]=P.useState(!1),[j,S]=P.useState(!1),[k,M]=P.useState({R:!0,G1:!0,G2:!0,B:!0}),[N,T]=P.useState(""),[A,D]=P.useState(""),[$,B]=P.useState(""),[J,W]=P.useState(""),[I,G]=P.useState("10"),[U,X]=P.useState(""),[V,z]=P.useState("0 0 0 0"),[q,te]=P.useState("0 0 0 0"),[ie,he]=P.useState(!1),[ee,Le]=P.useState(null),[fe,ce]=P.useState(!1),[de,Ne]=P.useState(0),[pe,ke]=P.useState([]),[me,Be]=P.useState(""),[Se,we]=P.useState(""),Re=()=>{const ue=parseFloat(me),ve=parseFloat(Se);!isNaN(ue)&&!isNaN(ve)&&(ke([...pe,{id:Date.now(),x:ue,y:ve}]),Be(""),we(""))},[it,Qe]=P.useState(()=>localStorage.getItem("ptc_tester_name")||""),[se,Xe]=P.useState(""),[ht,Zt]=P.useState("");P.useEffect(()=>{localStorage.setItem("ptc_tester_name",it)},[it]);const Jt=P.useRef(ie),Ut=P.useRef(fe),Lt=P.useRef(de);P.useEffect(()=>{Jt.current=ie,Ut.current=fe,Lt.current=de},[ie,fe,de]);const[pr,ir]=P.useState(null),[zt,Tr]=P.useState({min:.01,max:90}),[lt,Nt]=P.useState({readNoise:0,gain:1,prnu:.5}),[wr,kr]=P.useState(2e6),_r=P.useRef(lt),zr=P.useRef(zt),Or=P.useRef(wr);P.useEffect(()=>{_r.current=lt,zr.current=zt,Or.current=wr},[lt,zt,wr]);const[or,Br]=P.useState({read:"0",gain:"1.0",prnu:"0.5",rangeMin:"0.01",rangeMax:"90"}),[Xt,Te]=P.useState({read:!0,shot:!0,prnu:!0,total:!0,fitRange:!0}),[Q,Ce]=P.useState(!1),[ye,ze]=P.useState([]),[ot,ct]=P.useState(null),[Ct,tt]=P.useState(""),Hr=P.useMemo(()=>n?n.join(","):"",[n]);P.useEffect(()=>{if(e){let ue="0 0 0 0";o&&o.blackLevel?ue=o.blackLevel.join(" "):ue=n&&n.length===4?n.join(" "):"0 0 0 0",z(ue),te(ue);let ve="";if(o&&o.height?ve=o.height.toString():a&&(ve=a.toString()),X(ve),ve){const ae=parseFloat(ve);!isNaN(ae)&&ae>0?G((2309.4/ae).toFixed(2)):G("10")}else G("10");Le(null),he(!1),ce(!1),Ne(0),ze([]),ct(null),Tr({min:.01,max:90}),Br({read:"0",gain:"0",prnu:"0",rangeMin:"0.01",rangeMax:"90"});const be={readNoise:0,gain:0,prnu:0};Nt(be),_r.current=be,T(""),D(""),B(""),W(""),f("Noise"),ir(null),kr(2e6),tt(""),S(!1),ke([]),Xe(ae=>ae.trim()===""&&l?l:ae),Zt(ae=>ae.trim()===""&&u?u:ae)}},[e,Hr,o,a,r,l,u]);const gr=ue=>{if(ue.key==="Enter"){const ve=parseFloat(U);if(!isNaN(ve)&&ve>0){const be=(2309.4/ve).toFixed(2);G(be)}ue.target.blur()}},Qt=P.useMemo(()=>{let ve=q.trim().split(/[\s,]+/).filter(Boolean).map(Number);for(ve.length===1&&(ve=[ve[0],ve[0],ve[0],ve[0]]);ve.length<4;)ve.push(0);const be=ae=>{switch(ae){case"R":return ve[0];case"G1":return ve[1];case"G2":return ve[2];case"B":return ve[3];default:return 0}};return r.map(ae=>{const $e=ae.mean-be(ae.channel),mt=ae.std>0?$e/ae.std:0;return{...ae,x:$e,std:ae.std,snr:mt}}).filter(ae=>ae.std>0)},[r,q]),jt=P.useMemo(()=>{const ue=lt.readNoise,ve=ue*ue;return Qt.map(be=>{let ae=0;if(d==="Noise")ae=be.std;else if(d==="SNR")ae=be.snr;else if(d==="Linear"){const mt=be.std*be.std-ve;ae=be.x!==0?mt/be.x:0}return{...be,y:ae}})},[Qt,d,lt.readNoise]),mr=P.useMemo(()=>{if(Qt.length===0)return"G1";const ue={R:0,G1:0,G2:0,B:0},ve={R:0,G1:0,G2:0,B:0};for(const $e of Qt)ue[$e.channel]+=$e.x,ve[$e.channel]++;let be="G1",ae=-1/0;return Object.keys(ue).forEach($e=>{const mt=ve[$e],bt=mt>0?ue[$e]/mt:-1/0;bt>ae&&(ae=bt,be=$e)}),be},[Qt]),R=P.useCallback(()=>{let ue=1/0,ve=-1/0;if(Qt.length===0)return{min:.1,max:1};for(let be=0;be<Qt.length;be++){const ae=Qt[be].x;h&&ae<=0||(ae<ue&&(ue=ae),ae>ve&&(ve=ae))}return ue===1/0?{min:.1,max:1}:{min:ue,max:ve}},[Qt,h]),sr=P.useCallback(()=>{let ue=1/0,ve=-1/0;if(jt.length===0)return{min:.1,max:1};for(let be=0;be<jt.length;be++){const ae=jt[be].y;h&&ae<=0||(ae<ue&&(ue=ae),ae>ve&&(ve=ae))}return ue===1/0?{min:.1,max:1}:{min:ue*.9,max:ve*1.1}},[jt,h]),{min:Fr,max:Me}=R(),{min:ut,max:gt}=sr(),yr=Me*(zt.min/100),lr=Me*(zt.max/100),et=P.useMemo(()=>{if(!h&&jt.length===0)return{shot:[],read:[],prnu:[],total:[]};const ue=N?parseFloat(N):Fr,ve=A?parseFloat(A):Me,be=100,ae=Math.max(.1,ue),$e=Math.max(1,ve);if(ae>=$e)return{shot:[],read:[],prnu:[],total:[]};const mt=Math.log10(ae),Ot=(Math.log10($e)-mt)/be,Bt=lt.readNoise,At=lt.gain>0?lt.gain:1,Kr=lt.prnu/100,jr=[],Er=[],Rr=[],De=[];for(let Mt=0;Mt<=be;Mt++){const wt=Math.pow(10,mt+Mt*Ot);if(d==="Linear"){const Wr=1/At,xr=Kr*Kr,Jn=Wr+xr*wt;De.push({x:wt,y:Jn}),jr.push({x:wt,y:Wr}),Rr.push({x:wt,y:xr*wt})}else{const Wr=Bt,xr=Math.sqrt(wt/At),Jn=Kr*wt,Cr=Math.sqrt(Wr*Wr+xr*xr+Jn*Jn);d==="Noise"?(jr.push({x:wt,y:xr}),Er.push({x:wt,y:Wr}),Rr.push({x:wt,y:Jn}),De.push({x:wt,y:Cr})):(xr>0&&jr.push({x:wt,y:wt/xr}),Wr>0&&Er.push({x:wt,y:wt/Wr}),Jn>0&&Rr.push({x:wt,y:wt/Jn}),Cr>0&&De.push({x:wt,y:wt/Cr}))}}return{shot:jr,read:Er,prnu:Rr,total:De}},[jt,h,N,A,lt,d,Fr,Me]),tr=P.useMemo(()=>{if(d==="Linear")return[];const ue=parseFloat(I);if(isNaN(ue)||ue<=0)return[];const ve=N?parseFloat(N):Fr,be=A?parseFloat(A):Me;return d==="SNR"?[{x:ve,y:ue},{x:be,y:ue}]:[{x:ve,y:ve/ue},{x:be,y:be/ue}]},[jt,I,d,N,A,Fr,Me]),rr=P.useCallback((ue,ve)=>{if(!ve||ve.length===0)return null;const be=[...ve].sort((ae,$e)=>ae.x-$e.x);for(let ae=0;ae<be.length-1;ae++){const $e=be[ae],mt=be[ae+1];if($e.snr<=ue&&mt.snr>=ue||$e.snr>=ue&&mt.snr<=ue){const bt=(ue-$e.snr)/(mt.snr-$e.snr);return $e.x+bt*(mt.x-$e.x)}}return null},[]),Dt=P.useMemo(()=>{const ue=Qt,ve=1e3,be=$e=>{if($e.length===0)return[];if($e.length<=ve)return $e;const mt=[...$e].sort((Bt,At)=>Bt.x-At.x),bt=[],Ot=mt.length/ve;for(let Bt=0;Bt<ve;Bt++){const At=Math.floor(Bt*Ot),Kr=Math.floor((Bt+1)*Ot),jr=mt.slice(At,Kr);if(jr.length===0)continue;jr.sort((Rr,De)=>Rr.std-De.std);const Er=Math.floor(jr.length/2);bt.push(jr[Er])}return bt},ae={R:[],G1:[],G2:[],B:[]};return ue.forEach($e=>{ae[$e.channel]&&ae[$e.channel].push($e)}),{R:be(ae.R),G1:be(ae.G1),G2:be(ae.G2),B:be(ae.B)}},[Qt]),Et=P.useMemo(()=>ee&&lt.gain?ee*lt.gain:null,[ee,lt.gain]),_e=P.useMemo(()=>{if(ee===null||ee===0)return null;const ue=parseFloat(I);let ve=null;if(!isNaN(ue)&&ue>0){let bt=0,Ot=0;if(["R","G1","G2","B"].forEach(Bt=>{const At=rr(ue,Dt[Bt]);At!==null&&(bt+=At,Ot++)}),Ot>0){const Bt=bt/Ot;ve=Math.log2(ee/Bt)}}const be=parseFloat(U);let ae=null,$e=NaN;if(!isNaN(be)&&be>0){$e=16e3/be;let bt=0,Ot=0;if(["R","G1","G2","B"].forEach(Bt=>{const At=rr($e,Dt[Bt]);At!==null&&(bt+=At,Ot++)}),Ot>0){const Bt=bt/Ot;ae=Math.log2(ee/Bt)}}let mt=null;if(!isNaN(be)&&be>0){const bt=rr($e,Dt[mr]);bt!==null&&(mt=Math.log2(ee/bt))}return{manualDR:ve,ptpDR:ae,d55DR:mt,manualTarget:ue,ptpTarget:$e,saturationSignal:ee,dominantChannel:mr}},[ee,I,U,Dt,rr,mr]),fr=P.useMemo(()=>{if(d==="Linear"||!_e||!_e.ptpTarget||isNaN(_e.ptpTarget))return[];const ue=_e.ptpTarget,ve=N?parseFloat(N):Fr,be=A?parseFloat(A):Me;return d==="SNR"?[{x:ve,y:ue},{x:be,y:ue}]:[{x:ve,y:ve/ue},{x:be,y:be/ue}]},[d,_e,N,A,Fr,Me]),F=P.useCallback(()=>{const be=document.createElement("canvas");be.width=2048,be.height=1536;const ae=be.getContext("2d");if(!ae)return;const $e=s==="dark",mt=$e?"#0f172a":"#ffffff",bt=$e?"#ffffff":"#000000",Ot=$e?"#475569":"#cbd5e1",Bt=$e?"#1e293b":"#f1f5f9",At=i?{R:"#ef4444",G1:"#22c55e",G2:"#4ade80",B:"#3b82f6"}:{R:"#ef4444",G1:"#22c55e",G2:"#4ade80",B:"#3b82f6"};ae.fillStyle=mt,ae.fillRect(0,0,2048,1536);let Kr=N?parseFloat(N):Fr,jr=A?parseFloat(A):Me,Er=$?parseFloat($):ut,Rr=J?parseFloat(J):gt;isNaN(Kr)&&(Kr=.1),isNaN(jr)&&(jr=1e4),isNaN(Er)&&(Er=.1),isNaN(Rr)&&(Rr=1e3);const De={top:80,right:80,bottom:100,left:120},Mt=2048-De.left-De.right,wt=1536-De.top-De.bottom,Wr=rt=>{if(h){const Yt=Math.log10(Math.max(1e-9,Kr)),Vt=Math.log10(Math.max(1e-9,jr)),Gt=Math.log10(Math.max(1e-9,rt));return De.left+(Gt-Yt)/(Vt-Yt)*Mt}else return De.left+(rt-Kr)/(jr-Kr)*Mt},xr=rt=>{if(h){const Yt=Math.log10(Math.max(1e-9,Er)),Vt=Math.log10(Math.max(1e-9,Rr)),Gt=Math.log10(Math.max(1e-9,rt));return De.top+wt-(Gt-Yt)/(Vt-Yt)*wt}else return De.top+wt-(rt-Er)/(Rr-Er)*wt};if(ae.beginPath(),h){const rt=(Yt,Vt,Gt)=>{const Qn=Math.log10(Math.max(1e-9,Yt)),cn=Math.log10(Math.max(1e-9,Vt)),ua=Math.floor(Qn),ri=Math.ceil(cn);for(let Bn=ua;Bn<=ri;Bn++){const Na=Math.pow(10,Bn);let an=Gt?Wr(Na):xr(Na);(Gt?an>=De.left-1&&an<=De.left+Mt+1:an>=De.top-1&&an<=De.top+wt+1)&&(ae.lineWidth=1.5,ae.strokeStyle=Ot,ae.beginPath(),Gt?(ae.moveTo(an,De.top),ae.lineTo(an,De.top+wt)):(ae.moveTo(De.left,an),ae.lineTo(De.left+Mt,an)),ae.stroke()),ae.lineWidth=.5,ae.strokeStyle=Bt;for(let _t=2;_t<10;_t++){const Ji=_t*Na;an=Gt?Wr(Ji):xr(Ji),(Gt?an>=De.left&&an<=De.left+Mt:an>=De.top&&an<=De.top+wt)&&(ae.beginPath(),Gt?(ae.moveTo(an,De.top),ae.lineTo(an,De.top+wt)):(ae.moveTo(De.left,an),ae.lineTo(De.left+Mt,an)),ae.stroke())}}};rt(Kr,jr,!0),rt(Er,Rr,!1)}else{ae.strokeStyle=Ot,ae.lineWidth=1;for(let rt=0;rt<=5;rt++){const Yt=De.left+Mt*rt/5;ae.beginPath(),ae.moveTo(Yt,De.top),ae.lineTo(Yt,De.top+wt),ae.stroke();const Vt=De.top+wt*rt/5;ae.beginPath(),ae.moveTo(De.left,Vt),ae.lineTo(De.left+Mt,Vt),ae.stroke()}}ae.strokeStyle=bt,ae.lineWidth=2,ae.strokeRect(De.left,De.top,Mt,wt);const Jn=(rt,Yt,Vt)=>{rt<De.left||rt>De.left+Mt||Yt<De.top||Yt>De.top+wt||(ae.fillStyle=Vt,ae.fillRect(rt-1.5,Yt-1.5,3,3))},Cr=jt.filter(rt=>!(h&&(rt.x<=0||rt.y<=0)));Cr.forEach(rt=>{k[rt.channel]&&rt.channel!==mr&&Jn(Wr(rt.x),xr(rt.y),At[rt.channel])}),Cr.forEach(rt=>{k[rt.channel]&&rt.channel===mr&&Jn(Wr(rt.x),xr(rt.y),At[rt.channel])}),pe.forEach(rt=>{const Yt=Wr(rt.x),Vt=xr(rt.y);if(Yt<De.left||Yt>De.left+Mt||Vt<De.top||Vt>De.top+wt)return;ae.strokeStyle="#d946ef",ae.lineWidth=2.5;const Gt=6;ae.beginPath(),ae.moveTo(Yt-Gt,Vt-Gt),ae.lineTo(Yt+Gt,Vt+Gt),ae.moveTo(Yt+Gt,Vt-Gt),ae.lineTo(Yt-Gt,Vt+Gt),ae.stroke()});const en=(rt,Yt,Vt=[])=>{if(rt.length<2)return;ae.beginPath(),ae.strokeStyle=Yt,ae.lineWidth=3,ae.setLineDash(Vt);let Gt=!1;for(const Qn of rt){const cn=Wr(Qn.x),ua=xr(Qn.y);if(cn<De.left-100||cn>De.left+Mt+100||ua<De.top-100||ua>De.top+wt+100){Gt=!1;continue}Gt?ae.lineTo(cn,ua):(ae.moveTo(cn,ua),Gt=!0)}ae.stroke(),ae.setLineDash([])},yn=$e?"#ffffff":"#000000";if(Xt.shot&&en(et.shot,"#94a3b8",[5,5]),Xt.read&&en(et.read,"#f43f5e",[3,3]),Xt.prnu&&en(et.prnu,"#f59e0b",[3,3]),Xt.total&&en(et.total,yn,[]),tr.length===2){const rt="#6366f1";en(tr,rt,[4,2]);const Yt=tr[1],Vt=xr(Yt.y);Vt>=De.top&&Vt<=De.top+wt&&(ae.fillStyle=rt,ae.font="bold 20px sans-serif",ae.textAlign="right",ae.textBaseline="bottom",ae.fillText(`M.Tgt=${I}`,De.left+Mt-10,Vt-8))}if(fr.length===2&&(_e!=null&&_e.ptpTarget)){const rt="#10b981";en(fr,rt,[4,4]);const Yt=fr[1],Vt=xr(Yt.y);if(Vt>=De.top&&Vt<=De.top+wt){ae.fillStyle=rt,ae.font="bold 20px sans-serif",ae.textAlign="right",ae.textBaseline="bottom";const Gt=_e.ptpTarget.toFixed(1),Qn=tr.length===2?xr(tr[1].y):-100,cn=Math.abs(Vt-Qn)<25?25:0;ae.fillText(`PTP=${Gt}`,De.left+Mt-10,Vt-8-cn)}}if(Xt.fitRange||fe){const rt=(Yt,Vt)=>{const Gt=Wr(Yt);Gt>=De.left&&Gt<=De.left+Mt&&(ae.beginPath(),ae.strokeStyle=Vt,ae.lineWidth=2,ae.setLineDash([8,8]),ae.moveTo(Gt,De.top),ae.lineTo(Gt,De.top+wt),ae.stroke(),ae.setLineDash([]))};rt(yr,"#22d3ee"),rt(lr,"#22d3ee")}if(ee){const rt=Wr(ee);rt>=De.left&&rt<=De.left+Mt&&(ae.strokeStyle="#ef4444",ae.lineWidth=3,ae.setLineDash([10,10]),ae.beginPath(),ae.moveTo(rt,De.top),ae.lineTo(rt,De.top+wt),ae.stroke(),ae.setLineDash([]),ae.fillStyle="#ef4444",ae.font="bold 24px sans-serif",ae.textAlign="center",ae.fillText("Sat",rt,De.top-10))}ae.fillStyle=bt,ae.font="28px monospace",ae.textAlign="center",ae.fillText(Kr.toExponential(1),De.left,De.top+wt+40),ae.fillText(jr.toExponential(1),De.left+Mt,De.top+wt+40),ae.fillText("Signal (DN)",De.left+Mt/2,De.top+wt+80),ae.textAlign="right",ae.textBaseline="middle",ae.fillText(Er.toExponential(1),De.left-20,De.top+wt),ae.fillText(Rr.toExponential(1),De.left-20,De.top),ae.save(),ae.translate(De.left-80,De.top+wt/2),ae.rotate(-Math.PI/2),ae.textAlign="center",ae.fillText(d==="Linear"?"(Var - RN) / Mean":d,0,0),ae.restore(),ae.save(),ae.translate(2048/2,1536/2),ae.rotate(-Math.PI/6),ae.textAlign="center",ae.textBaseline="middle",ae.fillStyle=$e?"rgba(255, 255, 255, 0.1)":"rgba(0, 0, 0, 0.1)",ae.font="bold 150px sans-serif",ae.fillText(" y-g-jiang.github.io",0,0),ae.restore(),ae.fillStyle=bt,ae.font="bold 36px sans-serif",ae.textAlign="left",ae.textBaseline="top",ae.fillText(`PTC Export: ${d} Mode`,De.left,20),ae.font="24px sans-serif",ae.fillStyle=$e?"#94a3b8":"#64748b",ae.fillText(`Points: ${jt.length} | Sat Channel: ${mr}`,De.left,65);const mi=De.left+30,qi=De.top+30,bs=70,xa=rt=>{if(!ee||rt<=0)return"--";const Yt=lt.readNoise,Vt=lt.gain,Gt=lt.prnu/100;if(Vt<=0)return"--";const Qn=rt*rt,cn=Yt*Yt,ua=1-Qn*Gt*Gt,ri=-(Qn/Vt),Bn=-(Qn*cn);let Na=0;if(Math.abs(ua)<1e-8)Math.abs(ri)>1e-8&&(Na=-Bn/ri);else{const an=ri*ri-4*ua*Bn;an>=0&&(Na=(-ri+Math.sqrt(an))/(2*ua))}return Na>0?Math.log2(ee/Na).toFixed(2)+" EV":"--"},Zi=_e!=null&&_e.ptpTarget&&!isNaN(_e.ptpTarget)?xa(_e.ptpTarget):"--",yi=I?xa(parseFloat(I)):"--";ae.font="bold 48px monospace",ae.textAlign="left",ae.textBaseline="top",ae.shadowColor=$e?"rgba(0,0,0,0.8)":"rgba(255,255,255,0.8)",ae.shadowBlur=4,ae.shadowOffsetX=1,ae.shadowOffsetY=1;const In=(rt,Yt,Vt,Gt)=>{const Qn=qi+Vt*bs;ae.fillStyle=bt,ae.fillText(rt,mi,Qn);const cn=ae.measureText(rt).width;ae.fillStyle=Gt||bt,ae.fillText(Yt,mi+cn,Qn)},Qa=or.read,So=parseFloat(or.gain).toFixed(3),ei=parseFloat(or.prnu).toFixed(2)+"%";let ti=`M.DR@SNR${I}: `;const La=parseFloat(U);if(!isNaN(La)&&La>0){const rt=(2309.4/La).toFixed(2);Math.abs(parseFloat(I)-parseFloat(rt))<.05&&(ti="8mpSNR=1 DR: ")}In("Tester: ",it||"N/A",0),In("Model : ",se||"Unknown",1),In("ISO   : ",ht||"N/A",2),In("RN/FPN: ",Qa,3,"#f43f5e"),In("KADC  : ",So,4,"#06b6d4"),In("PRNU  : ",ei,5,"#f59e0b"),In("PTP DR: ",_e!=null&&_e.ptpDR?_e.ptpDR.toFixed(2)+" EV":"--",6,"#10b981"),In("D55 DR: ",_e!=null&&_e.d55DR?_e.d55DR.toFixed(2)+" EV":"--",7,"#8b5cf6"),In("FWC   : ",Et?Et>1e4?(Et/1e3).toFixed(1)+"k":Math.round(Et).toString():"--",8,"#f97316"),In(ti,_e!=null&&_e.manualDR?_e.manualDR.toFixed(2)+" EV":"--",9,"#06b6d4"),In("PTCFitDR(PTP): ",Zi,10,"#10b981"),In("PTCFitDR(Man): ",yi,11,"#06b6d4"),ae.save(),ae.textAlign="right",ae.textBaseline="bottom",ae.fillStyle="#3b82f6",ae.font="bold 80px sans-serif",ae.shadowColor=$e?"rgba(0,0,0,0.8)":"rgba(255,255,255,0.8)",ae.shadowBlur=4,ae.shadowOffsetX=2,ae.shadowOffsetY=2;const tn=1988,Ca=1476,ws=90;ae.fillText("Online",tn,Ca),ae.fillText("Jiangtherapee",tn,Ca-ws),ae.restore();const Ma=document.createElement("a");Ma.download=`ptc_complete_${d}_${Date.now()}.jpg`,Ma.href=be.toDataURL("image/jpeg",.9),Ma.click()},[jt,mr,k,N,A,$,J,Fr,Me,ut,gt,h,s,d,ee,i,Xt,et,yr,lr,zt,fe,it,se,ht,_e,Et,I,tr,fr,or,U,pe]),Oe=P.useMemo(()=>{let ue=jt;if(h&&(ue=ue.filter($e=>$e.y>0&&$e.x>0)),b==="top3"){const $e=[...ue].sort((bt,Ot)=>Ot.x-bt.x),mt=Math.max(50,Math.ceil($e.length*.03));ue=$e.slice(0,mt)}const ve={R:[],G1:[],G2:[],B:[]};if(ue.forEach($e=>{ve[$e.channel]&&ve[$e.channel].push($e)}),b==="raw")return ve;const be=b==="top3"?500:zie,ae=$e=>{if($e.length<=be)return $e;const mt=[...$e].sort((Bt,At)=>Bt.x-At.x),bt=[],Ot=mt.length/be;for(let Bt=0;Bt<be;Bt++){const At=Math.floor(Bt*Ot),Kr=Math.floor((Bt+1)*Ot),jr=mt.slice(At,Kr);if(jr.length===0)continue;jr.sort((Rr,De)=>Rr.y-De.y);const Er=Math.floor(jr.length/2);bt.push(jr[Er])}return bt};return{R:ae(ve.R),G1:ae(ve.G1),G2:ae(ve.G2),B:ae(ve.B)}},[jt,b,h]),Ie=P.useMemo(()=>{if(Qt.length<5)return[];const ue=Qt.filter(be=>be.channel===mr);return[...ue.length>20?ue:Qt].sort((be,ae)=>be.x-ae.x).map(be=>({mean:be.x,std:be.std}))},[Qt,mr]),Tt=ue=>{const ve=ue.length;if(ve===0)return[];const be=ue.reduce((Mt,wt)=>Mt+wt,0)/ve,ae=ue.reduce((Mt,wt)=>Mt+Math.pow(wt-be,2),0)/(ve-1||1),$e=Math.sqrt(ae);if($e===0)return[{x:be-.001,density:0},{x:be,density:1},{x:be+.001,density:0}];const mt=1.06*$e*Math.pow(ve,-.2),bt=Math.min(...ue),Ot=Math.max(...ue),Bt=(Ot-bt)*.2||bt*.1,At=Math.max(0,bt-Bt),Kr=Ot+Bt,jr=100,Er=(Kr-At)/(jr-1),Rr=Mt=>1/Math.sqrt(2*Math.PI)*Math.exp(-.5*Mt*Mt),De=[];for(let Mt=0;Mt<jr;Mt++){const wt=At+Mt*Er;let Wr=0;for(let xr=0;xr<ve;xr++)Wr+=Rr((wt-ue[xr])/mt);Wr/=ve*mt,De.push({x:wt,density:Wr})}return De},Ve=P.useCallback((ue,ve,be,ae)=>{if(ue.length<5)return{gain:0,prnu:0};const $e=ue[ue.length-1].mean,mt=$e*(be.min/100),bt=$e*(be.max/100),Ot=ue.filter(Cr=>Cr.mean>=mt&&Cr.mean<=bt);if(Ot.length<5)return{gain:0,prnu:0};ir({nPoints:Ot.length});const Bt=ve*ve,At=[],Kr=[];if(Ot.forEach(Cr=>{const yn=Cr.std*Cr.std-Bt;if(Cr.mean>1&&yn>0){const mi=Cr.mean,qi=yn/Cr.mean;At.push({x:mi,y:qi}),Kr.push(Cr.mean/yn)}}),At.length<5)return{gain:0,prnu:0};const jr=[],Er=At.length,Rr=ae,De=Er*(Er-1)/2;if(De<=Rr)for(let Cr=0;Cr<Er;Cr++)for(let en=Cr+1;en<Er;en++){const yn=At[en].x-At[Cr].x;Math.abs(yn)>1e-5&&jr.push((At[en].y-At[Cr].y)/yn)}else{const Cr=Math.max(1,Math.floor(De/Rr));for(let en=0;en<Er;en++)for(let yn=en+1;yn<Er;yn+=Cr){const mi=At[yn].x-At[en].x;Math.abs(mi)>1e-5&&jr.push((At[yn].y-At[en].y)/mi)}}const Mt=px(jr),wt=At.map(Cr=>Cr.y-Mt*Cr.x),Wr=px(wt);let xr=0,Jn=0;if(Wr>1e-6?xr=1/Wr:xr=px(Kr),Mt>0&&(Jn=Math.sqrt(Mt)*100),Kr.length>0){const Cr=Tt(Kr);ze(Cr),ct(xr)}else ze([]);return{gain:xr,prnu:Jn}},[]),pt=P.useCallback(ue=>{let ve=ue.read??_r.current.readNoise;const be=ue.gRange??zr.current,ae=Or.current;if((ue.read!==void 0||ue.gRange!==void 0)&&ue.gain===void 0&&ue.prnu===void 0&&Ie.length>0&&ve>=0)S(!0),setTimeout(()=>{const mt=Ve(Ie,ve,be,ae);let bt=_r.current.gain,Ot=_r.current.prnu;mt.gain>0&&(bt=mt.gain,Ot=mt.prnu),Nt({readNoise:ve,gain:bt,prnu:Ot}),ue.gRange!==void 0&&Tr(ue.gRange),Br(Bt=>{var At,Kr;return{...Bt,read:ve.toString(),gain:bt>0?bt.toFixed(3):"0",prnu:Ot.toFixed(2),rangeMin:(((At=ue.gRange)==null?void 0:At.min)??Bt.rangeMin).toString(),rangeMax:(((Kr=ue.gRange)==null?void 0:Kr.max)??Bt.rangeMax).toString()}}),S(!1)},50);else{let mt=ue.gain!==void 0?ue.gain:_r.current.gain,bt=ue.prnu!==void 0?ue.prnu:_r.current.prnu;Nt({readNoise:ve,gain:mt,prnu:bt}),ue.gRange!==void 0&&Tr(ue.gRange),Br(Ot=>{var Bt,At;return{...Ot,read:ve.toString(),gain:mt>0?mt.toFixed(3):"0",prnu:bt.toFixed(2),rangeMin:(((Bt=ue.gRange)==null?void 0:Bt.min)??Ot.rangeMin).toString(),rangeMax:(((At=ue.gRange)==null?void 0:At.max)??Ot.rangeMax).toString()}})}},[Ie,Ve]),Ye=`${q}-${r.length}`;P.useEffect(()=>{if(!e||!r||r.length===0)return;const ue=Oe[mr];if(!ue||ue.length===0||Ct===Ye)return;M({R:mr==="R",G1:mr==="G1",G2:mr==="G2",B:mr==="B"});const ve=[...ue].sort((mt,bt)=>mt.x-bt.x);let be=0;ve.length>0&&(be=ve[0].std);const ae=Qt.filter(mt=>mt.channel===mr);let $e=-1/0;for(const mt of ae)mt.x>$e&&($e=mt.x);$e!==-1/0&&Le($e),pt({read:be}),tt(Ye)},[e,r,Ct,Ye,Oe,mr,pt,Qt]);const Wt=(ue,ve)=>{Br(be=>({...be,[ue]:ve}))},Ir=ue=>{let ve=parseFloat(or[ue]);isNaN(ve)||ve<0||pt({[ue]:ve})},Qr=()=>{te(V),tt("")},Kt=()=>{const ue=parseFloat(or.rangeMin),ve=parseFloat(or.rangeMax);!isNaN(ue)&&!isNaN(ve)&&ue<ve&&ue>=0&&ve<=100&&pt({gRange:{min:ue,max:ve}})},Pn=(ue,ve)=>{ue.key==="Enter"&&(ve==="rangeMin"||ve==="rangeMax"?Kt():Ir(ve),ue.target.blur())};P.useEffect(()=>{e&&Ie.length>0&&pt({})},[e,wr,Ie]);const qr=ue=>{M(ve=>({...ve,[ue]:!ve[ue]}))},Xr=()=>{x(ue=>ue==="top3"?"default":"top3")},cr=()=>{b==="raw"?x("default"):_(!0)},nr=()=>{_(!1),x("raw")},Ar=(ue,ve)=>{const be=parseFloat(ue),ae=parseFloat(ve);let $e=isNaN(be)?"auto":be,mt=isNaN(ae)?"auto":ae;return h&&typeof $e=="number"&&$e<=0&&($e="auto"),[$e,mt]},qe=ue=>{if(!ue||!ue.payload)return;const ve=ue.payload;if(w(ve),Jt.current&&(Le(ve.x),he(!1)),Ut.current){const be=zr.current.min,ae=zr.current.max,{max:$e}=R();if($e<=0)return;const mt=Math.max(0,Math.min(100,ve.x/$e*100));if(Lt.current===1){const bt=Math.min(mt,ae-.5);pt({gRange:{min:bt,max:ae}}),Ne(2)}else if(Lt.current===2){const bt=Math.max(mt,be+.5);pt({gRange:{min:be,max:bt}}),Ne(0),ce(!1)}}},hr=P.useCallback(ue=>{const{cx:ve,cy:be,fill:ae}=ue;return c.jsx("circle",{cx:ve,cy:be,r:3,fill:ae,stroke:"none",style:{cursor:"pointer"}})},[]),fn=({active:ue,payload:ve})=>{if(ue&&ve&&ve.length){const be=ve[0].payload;return c.jsxs("div",{className:"bg-slate-800 text-white text-xs p-2 rounded border border-slate-600 shadow-xl opacity-90 font-mono z-50",children:[c.jsx("div",{className:"font-bold border-b border-slate-600 pb-1 mb-1",children:be.channel}),c.jsxs("div",{children:["Signal: ",be.x.toFixed(2)]}),c.jsxs("div",{children:[d,": ",be.y.toFixed(4)]}),be.row!==void 0&&be.col!==void 0&&!isNaN(be.row)&&!isNaN(be.col)&&c.jsxs("div",{className:"text-cyan-400 mt-0.5",children:["Loc: Row ",be.row,", Col ",be.col]}),be.filename&&c.jsx("div",{className:"text-gray-400 mt-1 max-w-[200px] truncate",title:be.filename,children:be.filename})]})}return null},Ln=ue=>{f(ue),ue==="Linear"&&g(!1)};if(!e)return null;const Zn=s==="dark"?"#ffffff":"#000000";let Tn=d;d==="Linear"&&(Tn="(Var - RN) / Mean");const Oi=V!==q;return c.jsx("div",{className:"fixed inset-0 z-[60] flex items-center justify-center bg-black/60 backdrop-blur-sm p-4 animate-in fade-in",onClick:ue=>{ue.stopPropagation()},children:c.jsxs("div",{className:"bg-white dark:bg-slate-900 w-[98vw] max-w-[2200px] h-[95vh] rounded-2xl shadow-2xl flex flex-col border border-gray-200 dark:border-slate-700 overflow-hidden relative",onClick:ue=>ue.stopPropagation(),children:[c.jsx(dl,{isOpen:y,onClose:()=>_(!1),onConfirm:nr,title:"Warning: High Performance Cost",message:"Displaying all data points may cause the browser to freeze or become unresponsive, especially with large datasets. Are you sure you want to continue?",confirmText:"Yes, Show All"}),v&&c.jsxs("div",{className:"absolute top-20 right-8 z-30 bg-white/90 dark:bg-slate-800/90 border border-cyan-500 rounded-xl p-4 shadow-xl backdrop-blur-md max-w-xs animate-in fade-in zoom-in-95 duration-200",children:[c.jsxs("div",{className:"flex justify-between items-start mb-2 border-b border-gray-200 dark:border-slate-700 pb-2",children:[c.jsx("h4",{className:"font-bold text-gray-900 dark:text-white text-sm",children:"Selected Point"}),c.jsx("button",{onClick:()=>w(null),className:"text-gray-400 hover:text-gray-600 dark:hover:text-slate-200",children:c.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),c.jsx("div",{className:"space-y-1 text-xs font-mono text-gray-700 dark:text-slate-300",children:c.jsxs("div",{className:"grid grid-cols-2 gap-x-4 gap-y-1.5",children:[c.jsx("span",{className:"text-gray-500 dark:text-slate-500",children:"Channel:"}),c.jsx("span",{className:"font-bold",children:v.channel}),c.jsx("span",{className:"text-gray-500 dark:text-slate-500",children:"Signal (DN):"}),c.jsx("span",{children:v.x.toFixed(4)}),c.jsx("span",{className:"text-gray-500 dark:text-slate-500",children:"Noise (Std):"}),c.jsx("span",{children:v.std.toFixed(4)}),c.jsx("span",{className:"text-gray-500 dark:text-slate-500",children:"SNR:"}),c.jsx("span",{className:"text-purple-600 dark:text-purple-400 font-bold",children:(v.x/v.std).toFixed(2)})]})})]}),Q&&c.jsx("div",{className:"absolute inset-0 z-40 bg-white/95 dark:bg-slate-900/95 backdrop-blur-sm flex flex-col items-center justify-center p-8 animate-in fade-in zoom-in-95 duration-200",children:c.jsxs("div",{className:"w-full max-w-2xl h-[60vh] bg-gray-50 dark:bg-slate-800 rounded-xl border border-gray-200 dark:border-slate-700 shadow-2xl p-4 flex flex-col relative",children:[c.jsx("button",{onClick:()=>Ce(!1),className:"absolute top-4 right-4 text-gray-400 hover:text-red-500 transition-colors",children:c.jsx("svg",{className:"w-6 h-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})}),c.jsxs("div",{className:"mb-4 text-center",children:[c.jsx("h3",{className:"text-lg font-bold text-gray-800 dark:text-slate-200",children:"Gain Density Estimation"}),c.jsxs("p",{className:"text-xs text-gray-500 dark:text-slate-400",children:["HSM Mode: ",c.jsx("span",{className:"text-cyan-600 dark:text-cyan-400 font-bold",children:ot==null?void 0:ot.toFixed(4)}),c.jsx("span",{className:"mx-2",children:"|"}),"Data Points: ",ye.length>0?"Density Curve Generated":"No Data"]})]}),c.jsx("div",{className:"flex-1 min-h-0",children:ye.length>0?c.jsx(Oo,{width:"100%",height:"100%",children:c.jsxs(DO,{data:ye,margin:{top:10,right:30,left:0,bottom:20},children:[c.jsx(mo,{strokeDasharray:"3 3",stroke:"#374151",opacity:.3,vertical:!1}),c.jsx(Ka,{dataKey:"x",tickFormatter:ue=>ue.toFixed(2),tick:{fill:"#9ca3af",fontSize:10},label:{value:"Gain (e/ADU)",position:"insideBottom",offset:-15,fill:"#9ca3af",fontSize:12}}),c.jsx(Ya,{tick:{fill:"#9ca3af",fontSize:10}}),c.jsx(aa,{cursor:{stroke:"rgba(255,255,255,0.2)"},contentStyle:{backgroundColor:"#1f2937",border:"1px solid #374151",borderRadius:"0.5rem",color:"#f3f4f6"}}),c.jsx(Gi,{type:"monotone",dataKey:"density",stroke:"#0ea5e9",fill:"#0ea5e9",fillOpacity:.3,strokeWidth:2}),ot!==null&&c.jsx(tl,{x:ot,stroke:"#ef4444",strokeWidth:2,label:{value:"HSM",fill:"#ef4444",fontSize:10,position:"top"}})]})}):c.jsx("div",{className:"flex items-center justify-center h-full text-gray-400",children:"No data in selected range"})})]})}),c.jsxs("div",{className:"flex flex-wrap justify-between items-center p-3 border-b border-gray-200 dark:border-slate-700 bg-gray-50 dark:bg-slate-800/50 gap-4 flex-shrink-0",children:[c.jsxs("h2",{className:"text-lg font-bold text-gray-900 dark:text-slate-100 flex items-center gap-2",children:["Photon Transfer Curve",c.jsxs("span",{className:"text-xs font-normal bg-purple-100 dark:bg-purple-900/30 text-purple-600 dark:text-purple-300 px-2 py-0.5 rounded border border-purple-200 dark:border-purple-800",children:[r.length," Pts"]})]}),c.jsxs("div",{className:"flex gap-4 items-center flex-wrap",children:[c.jsxs("button",{onClick:F,className:"bg-green-600 hover:bg-green-500 text-white font-bold py-1 px-3 rounded text-xs shadow-md transition-all active:scale-95 flex items-center gap-1",title:"Render all points, target lines, and metadata to a high-res JPG",children:[c.jsx("svg",{className:"w-3 h-3",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"})}),"Export Complete Result"]}),c.jsxs("div",{className:"flex bg-white dark:bg-slate-700 rounded-lg p-1 border border-gray-200 dark:border-slate-600",children:[c.jsx("button",{onClick:()=>Ln("Noise"),className:`px-3 py-1 text-xs font-bold rounded transition-colors ${d==="Noise"?"bg-cyan-600 text-white shadow":"text-gray-600 dark:text-slate-300 hover:bg-gray-100 dark:hover:bg-slate-600"}`,children:"Noise ()"}),c.jsx("button",{onClick:()=>Ln("SNR"),className:`px-3 py-1 text-xs font-bold rounded transition-colors ${d==="SNR"?"bg-purple-600 text-white shadow":"text-gray-600 dark:text-slate-300 hover:bg-gray-100 dark:hover:bg-slate-600"}`,children:"SNR"}),c.jsx("button",{onClick:()=>Ln("Linear"),className:`px-3 py-1 text-xs font-bold rounded transition-colors ${d==="Linear"?"bg-indigo-600 text-white shadow":"text-gray-600 dark:text-slate-300 hover:bg-gray-100 dark:hover:bg-slate-600"}`,children:"Linear (PTC)"})]}),c.jsxs("label",{className:"flex items-center gap-2 text-xs text-gray-600 dark:text-slate-300 cursor-pointer select-none",children:[c.jsx("input",{type:"checkbox",checked:h,onChange:ue=>g(ue.target.checked),className:"rounded border-gray-300 text-cyan-600 focus:ring-cyan-500 bg-gray-100 dark:bg-slate-700 dark:border-slate-600"}),"Log-Log"]}),c.jsx("button",{onClick:t,className:"text-gray-400 hover:text-red-500 transition-colors p-1",children:c.jsx("svg",{className:"w-6 h-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]})]}),c.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-12 gap-0 border-b border-gray-200 dark:border-slate-700 bg-white dark:bg-slate-900 text-sm flex-shrink-0",children:[c.jsxs("div",{className:"lg:col-span-9 p-5 flex flex-col gap-5 border-r border-gray-200 dark:border-slate-700",children:[c.jsxs("div",{className:"flex flex-wrap gap-4 items-center justify-between text-xs",children:[c.jsxs("div",{className:"flex gap-4 items-center",children:[c.jsxs("div",{className:"flex items-center gap-1.5 bg-gray-50 dark:bg-slate-800 rounded-md p-1 border border-gray-200 dark:border-slate-700",children:[c.jsx("span",{className:"font-bold text-gray-500 dark:text-slate-400 pl-1",children:"X:"}),c.jsx("input",{type:"number",placeholder:"Min",value:N,onChange:ue=>T(ue.target.value),className:"w-12 px-1 py-0.5 bg-white dark:bg-slate-900 border border-gray-300 dark:border-slate-600 rounded text-center outline-none"}),c.jsx("span",{className:"text-gray-400",children:"-"}),c.jsx("input",{type:"number",placeholder:"Max",value:A,onChange:ue=>D(ue.target.value),className:"w-12 px-1 py-0.5 bg-white dark:bg-slate-900 border border-gray-300 dark:border-slate-600 rounded text-center outline-none"})]}),c.jsxs("div",{className:"flex items-center gap-1.5 bg-gray-50 dark:bg-slate-800 rounded-md p-1 border border-gray-200 dark:border-slate-700",children:[c.jsx("span",{className:"font-bold text-gray-500 dark:text-slate-400 pl-1",children:"Y:"}),c.jsx("input",{type:"number",placeholder:"Min",value:$,onChange:ue=>B(ue.target.value),className:"w-12 px-1 py-0.5 bg-white dark:bg-slate-900 border border-gray-300 dark:border-slate-600 rounded text-center outline-none"}),c.jsx("span",{className:"text-gray-400",children:"-"}),c.jsx("input",{type:"number",placeholder:"Max",value:J,onChange:ue=>W(ue.target.value),className:"w-12 px-1 py-0.5 bg-white dark:bg-slate-900 border border-gray-300 dark:border-slate-600 rounded text-center outline-none"})]}),c.jsx("button",{onClick:()=>{T(""),D(""),B(""),W("")},className:"text-xs text-cyan-600 dark:text-cyan-400 hover:underline",children:"Auto"})]}),c.jsxs("div",{className:"flex items-center gap-1 bg-white dark:bg-slate-700 p-1 rounded-lg border border-gray-200 dark:border-slate-600",children:[c.jsx("button",{onClick:()=>qr("R"),className:`w-6 h-6 text-[10px] font-bold rounded flex items-center justify-center transition-colors ${k.R?"bg-red-500 text-white":"bg-gray-100 dark:bg-slate-600 text-gray-400"}`,children:"R"}),c.jsx("button",{onClick:()=>qr("G1"),className:`w-6 h-6 text-[10px] font-bold rounded flex items-center justify-center transition-colors ${k.G1?"bg-green-500 text-white":"bg-gray-100 dark:bg-slate-600 text-gray-400"}`,children:"G1"}),c.jsx("button",{onClick:()=>qr("G2"),className:`w-6 h-6 text-[10px] font-bold rounded flex items-center justify-center transition-colors ${k.G2?"bg-green-400 text-white":"bg-gray-100 dark:bg-slate-600 text-gray-400"}`,children:"G2"}),c.jsx("button",{onClick:()=>qr("B"),className:`w-6 h-6 text-[10px] font-bold rounded flex items-center justify-center transition-colors ${k.B?"bg-blue-500 text-white":"bg-gray-100 dark:bg-slate-600 text-gray-400"}`,children:"B"})]})]}),c.jsxs("div",{className:"flex flex-wrap items-end gap-8",children:[c.jsxs("div",{className:"flex flex-col bg-gray-50 dark:bg-slate-800/50 p-2 rounded border border-gray-100 dark:border-slate-700",children:[c.jsx("span",{className:"text-[9px] uppercase font-bold text-gray-500 dark:text-slate-400 mb-1",children:"Black Level (0,0 0,1 1,0 1,1)"}),c.jsx("input",{type:"text",value:V,onChange:ue=>z(ue.target.value),className:"w-32 text-xs px-2 py-1 bg-white dark:bg-slate-900 border border-gray-300 dark:border-slate-600 rounded outline-none focus:border-cyan-500 font-mono",placeholder:"0 0 0 0"})]}),c.jsxs("div",{className:"flex flex-col justify-between bg-gray-50 dark:bg-slate-800/50 p-2 rounded border border-gray-100 dark:border-slate-700",children:[c.jsxs("div",{className:"flex justify-between items-center mb-1",children:[c.jsx("span",{className:"text-[9px] uppercase font-bold text-gray-500 dark:text-slate-400 mr-2",children:"Fit Range % (Robust)"}),c.jsx("button",{onClick:()=>{ce(!fe),Ne(fe?0:1)},className:`px-1.5 py-0.5 text-[9px] rounded border transition-colors ${fe?"bg-cyan-100 text-cyan-700 border-cyan-300 animate-pulse":"bg-white dark:bg-slate-700 border-gray-300 dark:border-slate-600 text-gray-600 dark:text-slate-300 hover:bg-gray-50"}`,children:fe?de===1?"Pick Min":"Pick Max":"Select"})]}),c.jsxs("div",{className:"flex items-center gap-1 text-xs",children:[c.jsx("input",{type:"number",step:"0.1",value:or.rangeMin,onChange:ue=>Wt("rangeMin",ue.target.value),onBlur:Kt,onKeyDown:ue=>Pn(ue,"rangeMin"),className:"w-10 bg-white dark:bg-slate-900 border border-gray-300 dark:border-slate-600 rounded px-1 py-0.5 text-center font-bold"}),c.jsx("span",{className:"text-gray-400",children:"-"}),c.jsx("input",{type:"number",step:"0.1",value:or.rangeMax,onChange:ue=>Wt("rangeMax",ue.target.value),onBlur:Kt,onKeyDown:ue=>Pn(ue,"rangeMax"),className:"w-10 bg-white dark:bg-slate-900 border border-gray-300 dark:border-slate-600 rounded px-1 py-0.5 text-center font-bold"})]})]}),c.jsxs("div",{className:"flex flex-col bg-indigo-50 dark:bg-indigo-900/20 p-2 rounded border border-indigo-100 dark:border-indigo-800/50",children:[c.jsx("span",{className:"text-[9px] uppercase font-bold text-indigo-600 dark:text-indigo-400 mb-1",children:"DR Params"}),c.jsxs("div",{className:"flex items-center gap-3",children:[c.jsxs("div",{className:"flex items-center gap-1",children:[c.jsx("span",{className:"text-[10px] font-bold text-indigo-500 dark:text-indigo-300",children:"Img H:"}),c.jsx("input",{type:"number",value:U,onChange:ue=>X(ue.target.value),onKeyDown:gr,placeholder:"Empty",className:"w-14 px-1 py-0.5 bg-white dark:bg-slate-900 border border-indigo-200 dark:border-indigo-800 rounded text-center font-bold text-indigo-700 dark:text-indigo-300 text-xs placeholder:font-normal placeholder:text-gray-300"})]}),c.jsxs("div",{className:"flex items-center gap-1",children:[c.jsx("span",{className:"text-[10px] font-bold text-indigo-500 dark:text-indigo-300",children:"Tgt SNR:"}),c.jsx("input",{type:"number",value:I,onChange:ue=>G(ue.target.value),className:"w-10 px-1 py-0.5 bg-white dark:bg-slate-900 border border-indigo-200 dark:border-indigo-800 rounded text-center font-bold text-indigo-700 dark:text-indigo-300 text-xs"})]})]})]}),c.jsxs("div",{className:"flex flex-col gap-1 text-[10px] justify-end pb-0.5",children:[c.jsx("button",{onClick:()=>{he(!ie),ee&&Le(null)},disabled:fe,className:`font-bold rounded border shadow-sm transition-all px-3 py-1.5 ${ie?"bg-amber-100 dark:bg-amber-900/30 text-amber-700 dark:text-amber-400 border-amber-500 animate-pulse":"bg-white dark:bg-slate-800 text-gray-600 dark:text-slate-300 border-gray-300 dark:border-slate-600 hover:bg-gray-50 dark:hover:bg-slate-700"}`,children:ie?"Pick Point":"Select Linear Limit"}),c.jsxs("div",{className:"flex gap-1",children:[c.jsx("button",{onClick:Xr,className:`flex-1 font-bold rounded border shadow-sm transition-all px-2 py-1 ${b==="top3"?"bg-indigo-600 text-white border-indigo-700":"bg-white dark:bg-slate-800 text-gray-600 dark:text-slate-300 border-gray-300 dark:border-slate-600 hover:bg-gray-50"}`,children:"Top 3%"}),c.jsx("button",{onClick:cr,className:`font-bold rounded border shadow-sm transition-all px-2 py-1 ${b==="raw"?"bg-red-600 text-white border-red-700":"text-red-500 border-red-200 hover:bg-red-50"}`,children:"All"})]})]})]}),c.jsxs("div",{className:"flex flex-wrap gap-4 items-center bg-gray-50/50 dark:bg-slate-800/20 p-2 rounded-lg border border-gray-100 dark:border-slate-800",children:[c.jsx("span",{className:"text-[10px] uppercase font-bold text-gray-400 dark:text-slate-500",children:"Metadata"}),c.jsxs("div",{className:"flex gap-2",children:[c.jsx("input",{type:"text",value:it,onChange:ue=>Qe(ue.target.value),placeholder:"Tester Name",className:"w-24 text-xs bg-white dark:bg-slate-900 border border-gray-300 dark:border-slate-600 rounded px-2 py-1 text-gray-700 dark:text-slate-300 outline-none focus:border-cyan-500 transition-colors"}),c.jsx("input",{type:"text",value:se,onChange:ue=>Xe(ue.target.value),placeholder:"Camera Model",className:"w-32 text-xs bg-white dark:bg-slate-900 border border-gray-300 dark:border-slate-600 rounded px-2 py-1 text-gray-700 dark:text-slate-300 outline-none focus:border-cyan-500 transition-colors"}),c.jsx("input",{type:"text",value:ht,onChange:ue=>Zt(ue.target.value),placeholder:"ISO",className:"w-16 text-xs bg-white dark:bg-slate-900 border border-gray-300 dark:border-slate-600 rounded px-2 py-1 text-gray-700 dark:text-slate-300 outline-none focus:border-cyan-500 transition-colors"})]})]}),c.jsxs("div",{className:"flex flex-wrap gap-4 items-center bg-fuchsia-50/50 dark:bg-fuchsia-900/10 p-2 rounded-lg border border-fuchsia-100 dark:border-fuchsia-900/30",children:[c.jsx("span",{className:"text-[10px] uppercase font-bold text-fuchsia-500 dark:text-fuchsia-400",children:"Markers"}),c.jsxs("div",{className:"flex gap-2 items-center",children:[c.jsx("input",{type:"number",value:me,onChange:ue=>Be(ue.target.value),placeholder:"X (Signal)",className:"w-20 text-xs bg-white dark:bg-slate-900 border border-gray-300 dark:border-slate-600 rounded px-2 py-1 outline-none focus:border-fuchsia-500 transition-colors"}),c.jsx("input",{type:"number",value:Se,onChange:ue=>we(ue.target.value),placeholder:"Y (Value)",className:"w-20 text-xs bg-white dark:bg-slate-900 border border-gray-300 dark:border-slate-600 rounded px-2 py-1 outline-none focus:border-fuchsia-500 transition-colors"}),c.jsx("button",{onClick:Re,className:"px-3 py-1 bg-fuchsia-600 hover:bg-fuchsia-500 text-white text-xs font-bold rounded shadow-sm transition-colors active:scale-95",children:"+"}),pe.length>0&&c.jsx("button",{onClick:()=>ke([]),className:"px-2 py-1 bg-gray-200 dark:bg-slate-700 hover:bg-red-500 hover:text-white text-gray-600 dark:text-slate-300 text-xs font-bold rounded shadow-sm transition-colors active:scale-95",children:"Clr"})]}),c.jsxs("div",{className:"text-[10px] text-gray-400 dark:text-slate-500 font-mono",children:[pe.length," pts"]})]}),c.jsxs("div",{className:"flex gap-4 text-[10px] pt-1 justify-center sm:justify-start flex-wrap",children:[c.jsxs("label",{className:"flex items-center gap-1 cursor-pointer select-none",children:[c.jsx("input",{type:"checkbox",checked:Xt.shot,onChange:ue=>Te({...Xt,shot:ue.target.checked}),className:"rounded text-gray-500"})," ",c.jsx("span",{className:"text-gray-500",children:"Shot Noise"})]}),c.jsxs("label",{className:"flex items-center gap-1 cursor-pointer select-none",children:[c.jsx("input",{type:"checkbox",checked:Xt.read,onChange:ue=>Te({...Xt,read:ue.target.checked}),className:"rounded text-rose-500"})," ",c.jsx("span",{className:"text-rose-500",children:"Read Noise"})]}),c.jsxs("label",{className:"flex items-center gap-1 cursor-pointer select-none",children:[c.jsx("input",{type:"checkbox",checked:Xt.prnu,onChange:ue=>Te({...Xt,prnu:ue.target.checked}),className:"rounded text-amber-500"})," ",c.jsx("span",{className:"text-amber-500",children:"PRNU"})]}),c.jsxs("label",{className:"flex items-center gap-1 cursor-pointer select-none",children:[c.jsx("input",{type:"checkbox",checked:Xt.total,onChange:ue=>Te({...Xt,total:ue.target.checked}),className:"rounded text-white"})," ",c.jsx("span",{className:"text-gray-900 dark:text-white font-bold",children:"Model"})]})]})]}),c.jsxs("div",{className:"lg:col-span-3 bg-slate-100 dark:bg-slate-800 p-4 flex flex-col justify-center gap-4",children:[c.jsxs("div",{children:[c.jsxs("div",{className:"flex justify-between items-center mb-1 px-1",children:[c.jsxs("h3",{className:"text-xs font-bold text-gray-500 dark:text-slate-400 uppercase flex items-center gap-2",children:["Fit Parameters (D55 SAT Channel:",mr,")",j&&c.jsx("span",{className:"text-orange-500 animate-pulse text-[10px]",children:"Calculating..."})]}),c.jsxs("div",{className:"flex gap-2 items-center",children:[c.jsx("button",{onClick:Qr,disabled:j,className:`px-3 py-1 text-white text-[10px] font-bold rounded shadow-sm transition-all flex items-center gap-1 active:scale-95 
                                            ${j?"bg-gray-400 cursor-wait":Oi?"bg-orange-500 hover:bg-orange-600 animate-pulse ring-2 ring-orange-400/50":"bg-cyan-600 hover:bg-cyan-500"}
                                        `,title:"Apply Black Level, Auto-detect Read Noise, then Recalculate Fit",children:j?c.jsxs(c.Fragment,{children:[c.jsxs("svg",{className:"w-3 h-3 animate-spin",viewBox:"0 0 24 24",fill:"none",children:[c.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),c.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4z"})]}),"Fitting..."]}):c.jsxs(c.Fragment,{children:[c.jsxs("svg",{className:"w-3 h-3",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:[c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M14.752 11.168l-3.197-2.132A1 1 0 0010 9.87v4.263a1 1 0 001.555.832l3.197-2.132a1 1 0 000-1.664z"}),c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})]}),"Apply & Calc"]})}),c.jsxs("select",{value:wr,onChange:ue=>kr(Number(ue.target.value)),className:"text-[9px] bg-slate-200 dark:bg-slate-700 text-gray-600 dark:text-slate-300 rounded px-1 py-0.5 border-none outline-none cursor-pointer hover:bg-slate-300 dark:hover:bg-slate-600 transition-colors",title:"Number of point-pairs to sample for robust regression (Theil-Sen)",children:[c.jsx("option",{value:1e5,children:"100k Pairs"}),c.jsx("option",{value:5e5,children:"500k Pairs"}),c.jsx("option",{value:2e6,children:"2M Pairs"}),c.jsx("option",{value:5e6,children:"5M Pairs"}),c.jsx("option",{value:1e7,children:"10M Pairs"})]}),pr&&c.jsxs("span",{className:"text-[10px] text-gray-400 dark:text-slate-500 font-mono",title:"Number of points used in regression",children:["N=",pr.nPoints]})]})]}),c.jsxs("div",{className:"grid grid-cols-3 gap-2",children:[c.jsxs("div",{className:"flex flex-col items-center",children:[c.jsx("label",{className:"text-[10px] text-gray-500 dark:text-slate-400 uppercase tracking-wide mb-1",children:"rn/fpn"}),c.jsx("input",{type:"text",inputMode:"decimal",value:or.read,onChange:ue=>Wt("read",ue.target.value),onBlur:()=>Ir("read"),onKeyDown:ue=>Pn(ue,"read"),className:"w-full text-center text-2xl font-light bg-transparent text-rose-500 outline-none border-b border-transparent focus:border-rose-500 transition-colors"})]}),c.jsxs("div",{className:"flex flex-col items-center relative group",children:[c.jsxs("label",{className:"text-[10px] text-gray-500 dark:text-slate-400 uppercase tracking-wide mb-1 flex items-center gap-1",children:["Kadc (HSM)",c.jsx("button",{onClick:()=>Ce(!0),className:"text-[9px] text-cyan-600 dark:text-cyan-400 hover:underline",children:"Dist."})]}),c.jsx("input",{type:"text",inputMode:"decimal",value:or.gain,onChange:ue=>Wt("gain",ue.target.value),onBlur:()=>Ir("gain"),onKeyDown:ue=>Pn(ue,"gain"),className:"w-full text-center text-2xl font-light bg-transparent text-slate-700 dark:text-slate-200 outline-none border-b border-transparent focus:border-cyan-500 transition-colors"})]}),c.jsxs("div",{className:"flex flex-col items-center",children:[c.jsx("label",{className:"text-[10px] text-gray-500 dark:text-slate-400 uppercase tracking-wide mb-1",children:"PRNU (%)"}),c.jsx("input",{type:"text",inputMode:"decimal",value:or.prnu,onChange:ue=>Wt("prnu",ue.target.value),onBlur:()=>Ir("prnu"),onKeyDown:ue=>Pn(ue,"prnu"),className:"w-full text-center text-2xl font-light bg-transparent text-amber-500 outline-none border-b border-transparent focus:border-amber-500 transition-colors"})]})]})]}),c.jsx("div",{className:"h-px bg-gray-200 dark:bg-slate-700 w-full"}),c.jsxs("div",{className:"grid grid-cols-2 gap-2 text-center",children:[c.jsxs("div",{className:"flex flex-col justify-center bg-cyan-50 dark:bg-cyan-900/10 p-2 rounded-lg border border-cyan-100 dark:border-cyan-900/30",children:[c.jsxs("h4",{className:"text-[10px] font-bold text-cyan-600 dark:text-cyan-500 uppercase tracking-wide mb-1 truncate",title:`Manual DR at SNR=${(_e==null?void 0:_e.manualTarget)||I}`,children:["M.DR @ SNR=",(_e==null?void 0:_e.manualTarget)||I]}),c.jsx("div",{className:"text-base font-bold text-cyan-700 dark:text-cyan-400 whitespace-nowrap",children:_e!=null&&_e.manualDR?`${_e.manualDR.toFixed(2)} EV`:"--"})]}),c.jsxs("div",{className:"flex flex-col justify-center bg-emerald-50 dark:bg-emerald-900/10 p-2 rounded-lg border border-emerald-100 dark:border-emerald-900/30",title:isNaN((_e==null?void 0:_e.ptpTarget)||NaN)?"Requires Image Height":`Standard Point-to-Point DR (Target SNR = 16000/${U||"H"})`,children:[c.jsx("h4",{className:"text-[10px] font-bold text-emerald-600 dark:text-emerald-500 uppercase tracking-wide mb-1",children:"PTP DR"}),c.jsx("div",{className:"text-base font-bold text-emerald-700 dark:text-emerald-400 whitespace-nowrap",children:_e!=null&&_e.ptpDR?`${_e.ptpDR.toFixed(2)} EV`:"--"})]}),c.jsxs("div",{className:"flex flex-col justify-center bg-purple-50 dark:bg-purple-900/10 p-2 rounded-lg border border-purple-100 dark:border-purple-900/30",title:isNaN((_e==null?void 0:_e.ptpTarget)||NaN)?"Requires Image Height":`D55 Saturation DR (Target SNR = 16000/${U||"H"} on ${_e==null?void 0:_e.dominantChannel} Channel)`,children:[c.jsxs("h4",{className:"text-[10px] font-bold text-purple-600 dark:text-purple-400 uppercase tracking-wide mb-1 truncate",children:["D55 DR (",_e==null?void 0:_e.dominantChannel,")"]}),c.jsx("div",{className:"text-base font-bold text-purple-700 dark:text-purple-400 whitespace-nowrap",children:_e!=null&&_e.d55DR?`${_e.d55DR.toFixed(2)} EV`:"--"})]}),c.jsxs("div",{className:"flex flex-col justify-center bg-orange-50 dark:bg-orange-900/10 p-2 rounded-lg border border-orange-100 dark:border-orange-900/30",children:[c.jsx("h4",{className:"text-[10px] font-bold text-orange-600 dark:text-orange-400 uppercase tracking-wide mb-1",children:"FWC"}),c.jsx("div",{className:"text-base font-bold text-orange-600 dark:text-orange-400 font-mono whitespace-nowrap truncate",title:Et!==null?`${Math.round(Et)}`:"",children:Et!==null?Et>1e4?`${(Et/1e3).toFixed(1)}k`:`${Math.round(Et)}`:"--"})]})]}),ee===null&&c.jsx("div",{className:"text-center text-[10px] text-red-500 animate-pulse font-bold mt-[-10px]",children:"Please select Linear Limit on chart to calc DR"})]})]}),c.jsxs("div",{className:`flex-1 p-4 bg-white dark:bg-slate-900 relative grid grid-cols-[auto_1fr] grid-rows-[1fr_auto] gap-2 ${ie||fe?"cursor-crosshair":""}`,children:[c.jsx("div",{className:"row-start-1 col-start-1 h-full",children:c.jsx(e_,{vertical:!0,min:ut,max:gt,value:[$?parseFloat($):ut,J?parseFloat(J):gt],onChange:([ue,ve])=>{B(ue.toString()),W(ve.toString())},logScale:h})}),c.jsxs("div",{className:"row-start-1 col-start-2 relative",children:[jt.length===0?c.jsx("div",{className:"flex h-full items-center justify-center text-gray-400",children:"No valid data points found."}):c.jsx(Oo,{width:"100%",height:"100%",children:c.jsxs(Mie,{margin:{top:20,right:20,bottom:0,left:0},onClick:qe,children:[c.jsx("defs",{children:c.jsxs("filter",{id:"glow",height:"300%",width:"300%",x:"-100%",y:"-100%",children:[c.jsx("feGaussianBlur",{stdDeviation:"2",result:"coloredBlur"}),c.jsxs("feMerge",{children:[c.jsx("feMergeNode",{in:"coloredBlur"}),c.jsx("feMergeNode",{in:"SourceGraphic"})]})]})}),c.jsx(mo,{strokeDasharray:"3 3",stroke:"#374151",opacity:.2}),c.jsx(Ka,{type:"number",dataKey:"x",name:"Signal",scale:h?"log":"linear",domain:Ar(N,A),allowDataOverflow:!0,hide:!0}),c.jsx(Ya,{type:"number",dataKey:"y",name:d,scale:h?"log":"linear",domain:Ar($,J),label:{value:Tn,angle:-90,position:"insideLeft",fill:"#9ca3af",fontSize:12},tick:{fill:"#9ca3af",fontSize:10},allowDataOverflow:!0}),c.jsx(aa,{content:c.jsx(fn,{}),cursor:{strokeDasharray:"3 3"}}),ee&&c.jsx(tl,{x:ee,stroke:"red",strokeDasharray:"3 3",label:{position:"top",value:"Sat",fill:"red",fontSize:10}}),(Xt.fitRange||fe)&&c.jsxs(c.Fragment,{children:[c.jsx(tl,{x:yr,stroke:"#22d3ee",strokeDasharray:"5 5",label:{position:"insideTopLeft",value:`Min: ${zt.min}%`,fill:"#22d3ee",fontSize:9}}),c.jsx(tl,{x:lr,stroke:"#22d3ee",strokeDasharray:"5 5",label:{position:"insideTopLeft",value:`Max: ${zt.max}%`,fill:"#22d3ee",fontSize:9}})]}),k.R&&c.jsx(Wa,{name:"Red",data:Oe.R,fill:"#ef4444",shape:hr,onClick:qe,style:s==="dark"?{filter:"url(#glow)"}:void 0},"scatter-R"),k.G1&&c.jsx(Wa,{name:"Green 1",data:Oe.G1,fill:"#22c55e",shape:hr,onClick:qe,style:s==="dark"?{filter:"url(#glow)"}:void 0},"scatter-G1"),k.G2&&c.jsx(Wa,{name:"Green 2",data:Oe.G2,fill:"#4ade80",shape:hr,onClick:qe,style:s==="dark"?{filter:"url(#glow)"}:void 0},"scatter-G2"),k.B&&c.jsx(Wa,{name:"Blue",data:Oe.B,fill:"#3b82f6",shape:hr,onClick:qe,style:s==="dark"?{filter:"url(#glow)"}:void 0},"scatter-B"),Xt.shot&&et.shot.length>0&&c.jsx(Wa,{name:"Shot Noise (Ideal)",data:et.shot,line:{stroke:"#94a3b8",strokeWidth:1,strokeDasharray:"5 5"},shape:()=>c.jsx(c.Fragment,{}),legendType:"none",isAnimationActive:!1},"line-shot"),Xt.read&&et.read.length>0&&c.jsx(Wa,{name:"Read Noise Floor",data:et.read,line:{stroke:"#f43f5e",strokeWidth:1,strokeDasharray:"3 3"},shape:()=>c.jsx(c.Fragment,{}),legendType:"none",isAnimationActive:!1},"line-read"),Xt.prnu&&et.prnu.length>0&&c.jsx(Wa,{name:"PRNU (Non-uniformity)",data:et.prnu,line:{stroke:"#f59e0b",strokeWidth:1,strokeDasharray:"3 3"},shape:()=>c.jsx(c.Fragment,{}),legendType:"none",isAnimationActive:!1},"line-prnu"),Xt.total&&et.total.length>0&&c.jsx(Wa,{name:"Total Noise Model",data:et.total,line:{stroke:Zn,strokeWidth:2},shape:()=>c.jsx(c.Fragment,{}),legendType:"none",isAnimationActive:!1},"line-total"),tr.length>0&&c.jsx(Wa,{name:`Target SNR=${I}`,data:tr,line:{stroke:"#6366f1",strokeWidth:2,strokeDasharray:"4 2"},shape:()=>c.jsx(c.Fragment,{}),legendType:"none",isAnimationActive:!1},"line-target"),fr.length>0&&c.jsx(Wa,{name:`PTP Target SNR=${_e!=null&&_e.ptpTarget?_e.ptpTarget.toFixed(1):"?"}`,data:fr,line:{stroke:"#10b981",strokeWidth:2,strokeDasharray:"4 4"},shape:()=>c.jsx(c.Fragment,{}),legendType:"none",isAnimationActive:!1},"line-ptp"),pe.length>0&&c.jsx(Wa,{name:"Manual Markers",data:pe,fill:"#d946ef",shape:"star",legendType:"star"},"manual-points")]})}),c.jsx("div",{className:"absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 pointer-events-none select-none opacity-25 mix-blend-normal dark:mix-blend-plus-lighter",children:c.jsx("svg",{viewBox:"0 0 500 60",className:"w-96 h-auto",children:c.jsx("text",{x:"50%",y:"50%",dominantBaseline:"middle",textAnchor:"middle",className:"fill-gray-900 dark:fill-white",fontSize:"36",fontWeight:"bold",style:{fontFamily:"sans-serif",letterSpacing:"0.05em"},children:" y-g-jiang.github.io"})})})]}),c.jsx("div",{className:"row-start-2 col-start-2 w-full",children:c.jsx(e_,{min:Fr,max:Me,value:[N?parseFloat(N):Fr,A?parseFloat(A):Me],onChange:([ue,ve])=>{T(ue.toString()),D(ve.toString())},logScale:h})})]})]})})},Vie=({searchTerm:e,onSearchChange:t,manufacturers:r,selectedManufacturer:n,onManufacturerChange:a,cameras:i,onCameraSelect:o})=>c.jsx("div",{className:"sticky top-4 z-10 bg-white/80 dark:bg-slate-900/80 backdrop-blur-sm p-4 rounded-xl border border-gray-200 dark:border-slate-700 shadow-sm",children:c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-5 gap-4",children:[c.jsxs("div",{className:"relative md:col-span-3",children:[c.jsx("input",{type:"text",placeholder:"Search camera model...",value:e,onChange:s=>t(s.target.value),className:"w-full pl-10 pr-4 py-2 bg-gray-50 dark:bg-slate-800 border border-gray-300 dark:border-slate-600 rounded-lg focus:ring-2 focus:ring-cyan-500 focus:border-cyan-500 outline-none transition-all duration-300 text-gray-900 dark:text-slate-200 placeholder-gray-500 dark:placeholder-slate-400"}),c.jsx("svg",{className:"w-5 h-5 text-gray-400 dark:text-slate-400 absolute top-1/2 left-3 transform -translate-y-1/2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})})]}),c.jsx("select",{value:n,onChange:s=>a(s.target.value),className:"w-full md:col-span-1 bg-gray-50 dark:bg-slate-800 border border-gray-300 dark:border-slate-600 rounded-lg px-4 py-2 focus:ring-2 focus:ring-cyan-500 focus:border-cyan-500 outline-none transition-all duration-300 appearance-none text-gray-900 dark:text-slate-200",children:r.map(s=>c.jsx("option",{value:s,children:s},s))}),c.jsxs("select",{onChange:s=>o(s.target.value),className:"w-full md:col-span-1 bg-gray-50 dark:bg-slate-800 border border-gray-300 dark:border-slate-600 rounded-lg px-4 py-2 focus:ring-2 focus:ring-cyan-500 focus:border-cyan-500 outline-none transition-all duration-300 appearance-none text-gray-900 dark:text-slate-200",value:"","aria-label":"Jump to camera model",children:[c.jsx("option",{value:"",disabled:!0,children:"Jump to model..."}),i.map(s=>c.jsx("option",{value:s.id,children:s.name},s.id))]})]})}),Hie=({active:e,payload:t,label:r,theme:n})=>{if(e&&t&&t.length){const a=t[0].payload,i=n==="dark"?"bg-slate-800/80 border-slate-600 text-slate-300":"bg-white/90 border-gray-200 text-gray-700";return c.jsxs("div",{className:`${i} backdrop-blur-sm border p-3 rounded-lg shadow-lg`,children:[c.jsx("p",{className:"label font-bold",children:`ISO ${r}`}),c.jsx("div",{className:"mt-2 space-y-1 text-sm",children:c.jsxs(c.Fragment,{children:[c.jsxs("div",{style:{color:"#f87171"},children:["Red: ",a.R_avg.toFixed(2)," (Range: ",a.R_range[0]," - ",a.R_range[1],")"]}),c.jsxs("div",{style:{color:"#4ade80"},children:["Green 1: ",a.G1_avg.toFixed(2)," (Range: ",a.G1_range[0]," - ",a.G1_range[1],")"]}),c.jsxs("div",{style:{color:"#60a5fa"},children:["Blue: ",a.B_avg.toFixed(2)," (Range: ",a.B_range[0]," - ",a.B_range[1],")"]}),c.jsxs("div",{style:{color:"#86efac"},children:["Green 2: ",a.G2_avg.toFixed(2)," (Range: ",a.G2_range[0]," - ",a.G2_range[1],")"]})]})})]})}return null},Xie=({data:e,theme:t="dark"})=>{const r=P.useMemo(()=>!e||e.length===0?[]:[...new Set(e.map(o=>o.iso))].sort((o,s)=>Number(o)-Number(s)),[e]),n=P.useMemo(()=>{if(!e||e.length===0)return[0,4096];const o=e.flatMap(v=>[...v.R_range,...v.G1_range,...v.G2_range,...v.B_range]);if(o.length===0)return[0,4096];let s=Math.min(...o),l=Math.max(...o);const u=.25,d=l-s;if(d<u){const v=u-d;s-=v/2,l+=v/2}const f=(l-s)*.1,h=s-f,g=l+f;return[h,g]},[e]),a=t==="dark"?"#475569":"#e5e7eb",i=t==="dark"?"#94a3b8":"#6b7280";return!e||e.length===0?c.jsx("div",{className:"flex items-center justify-center h-full text-gray-500 dark:text-slate-500",children:c.jsx("p",{children:"No data available for this mode."})}):c.jsx(Oo,{width:"100%",height:"100%",children:c.jsxs(DO,{data:e,margin:{top:5,right:20,left:0,bottom:5},children:[c.jsx(mo,{strokeDasharray:"3 3",stroke:a}),c.jsx(Ka,{dataKey:"iso",type:"number",domain:["dataMin","dataMax"],tick:{fill:i,fontSize:12},scale:"log",allowDuplicatedCategory:!1,ticks:r}),c.jsx(Ya,{tick:{fill:i,fontSize:12},domain:n,allowDecimals:!0,tickFormatter:o=>Number(o).toFixed(3)}),c.jsx(aa,{content:c.jsx(Hie,{theme:t})}),c.jsx(Do,{wrapperStyle:{fontSize:"14px",color:i}}),c.jsx(Gi,{type:"monotone",dataKey:"R_range",fill:"#f87171",stroke:"none",fillOpacity:.2,name:"Red",legendType:"none"}),c.jsx(ia,{type:"monotone",dataKey:"R_avg",stroke:"#f87171",strokeWidth:2,dot:!1,activeDot:{r:5},name:"Red"}),c.jsx(Gi,{type:"monotone",dataKey:"G1_range",fill:"#4ade80",stroke:"none",fillOpacity:.2,name:"Green 1",legendType:"none"}),c.jsx(ia,{type:"monotone",dataKey:"G1_avg",stroke:"#4ade80",strokeWidth:2,dot:!1,activeDot:{r:5},name:"Green 1"}),c.jsx(Gi,{type:"monotone",dataKey:"B_range",fill:"#60a5fa",stroke:"none",fillOpacity:.2,name:"Blue",legendType:"none"}),c.jsx(ia,{type:"monotone",dataKey:"B_avg",stroke:"#60a5fa",strokeWidth:2,dot:!1,activeDot:{r:5},name:"Blue"}),c.jsx(Gi,{type:"monotone",dataKey:"G2_range",fill:"#86efac",stroke:"none",fillOpacity:.2,name:"Green 2",legendType:"none"}),c.jsx(ia,{type:"monotone",dataKey:"G2_avg",stroke:"#86efac",strokeWidth:2,dot:!1,activeDot:{r:5},name:"Green 2"})]})})},Kie=oe.forwardRef(({camera:e,theme:t="dark"},r)=>{const n=P.useMemo(()=>e.shootingModes.map(f=>f.modeName),[e.shootingModes]),[a,i]=P.useState(n[0]||""),{chartData:o,tableData:s}=P.useMemo(()=>{const f=e.shootingModes.find(v=>v.modeName===a);if(!(f!=null&&f.data))return{chartData:[],tableData:[]};const h=f.data.map(v=>({iso:v.iso,R_range:v.r.range,R_avg:v.r.avg,G1_range:v.g1.range,G1_avg:v.g1.avg,B_range:v.b.range,B_avg:v.b.avg,G2_range:v.g2.range,G2_avg:v.g2.avg})),g=f.data.map(v=>({iso:v.iso,levels:[v.r.avg,v.g1.avg,v.g2.avg,v.b.avg],clipping:v.clipping}));return{chartData:h,tableData:g}},[e.shootingModes,a]),l=`Raw Data (${a})`,u=P.useRef(null),d=P.useRef(null);return P.useEffect(()=>{const f=u.current,h=d.current;if(!f||!h)return;const g=new ResizeObserver(v=>{for(let w of v){const{width:b}=w.contentRect,y=Math.max(8,b/35);h.style.fontSize=`${y}px`}});return g.observe(f),()=>g.disconnect()},[]),c.jsxs("div",{ref:r,className:"bg-white dark:bg-slate-800/50 border border-gray-200 dark:border-slate-700 rounded-xl shadow-lg p-6 flex flex-col gap-6 transform hover:scale-[1.02] hover:border-cyan-500/50 transition-all duration-500 ease-in-out",children:[c.jsxs("div",{className:"border-b border-gray-200 dark:border-slate-700 pb-4",children:[c.jsx("h2",{className:"text-2xl font-bold text-gray-900 dark:text-slate-100",children:e.name}),c.jsx("p",{className:"text-cyan-600 dark:text-cyan-400",children:e.manufacturer})]}),c.jsxs("div",{children:[c.jsxs("div",{className:"flex flex-col sm:flex-row justify-between sm:items-center gap-4 mb-4",children:[c.jsx("h3",{className:"text-lg font-semibold text-gray-800 dark:text-slate-300",children:"Black Level vs. ISO"}),c.jsx("select",{value:a,onChange:f=>i(f.target.value),className:"w-full sm:w-auto bg-gray-50 dark:bg-slate-700 border border-gray-300 dark:border-slate-600 rounded-md px-3 py-1 text-sm outline-none focus:ring-2 focus:ring-cyan-500 transition-all duration-300 text-gray-900 dark:text-slate-200","aria-label":`Select shooting mode for ${e.name}`,children:n.map(f=>c.jsx("option",{value:f,children:f},f))})]}),c.jsxs("div",{ref:u,className:"h-64 relative",children:[c.jsx(Xie,{data:o,theme:t},a),c.jsx("div",{className:"absolute top-1/2 left-[52%] transform -translate-x-1/2 -translate-y-1/2 -rotate-30 pointer-events-none",children:c.jsx("p",{ref:d,className:"font-bold text-gray-900/10 dark:text-slate-200/40 whitespace-nowrap",children:" y-g-jiang.github.io"})})]})]}),c.jsxs("div",{className:"overflow-x-auto",children:[c.jsx("div",{className:"flex justify-between items-center mb-4",children:c.jsx("h3",{className:"text-lg font-semibold text-gray-800 dark:text-slate-300",children:l})}),c.jsxs("table",{className:"w-full text-left border-collapse",children:[c.jsx("thead",{className:"bg-gray-100 dark:bg-slate-700/50",children:c.jsxs("tr",{children:[c.jsx("th",{className:"p-3 font-semibold text-sm text-gray-700 dark:text-slate-300",children:"ISO"}),c.jsx("th",{className:"p-3 font-semibold text-sm text-red-500 dark:text-red-400",children:"Red"}),c.jsx("th",{className:"p-3 font-semibold text-sm text-green-600 dark:text-green-400",children:"Green 1"}),c.jsx("th",{className:"p-3 font-semibold text-sm text-blue-500 dark:text-blue-400",children:"Blue"}),c.jsx("th",{className:"p-3 font-semibold text-sm text-green-500 dark:text-green-300",children:"Green 2"})]})}),c.jsx("tbody",{children:s.map(({iso:f,levels:h,clipping:g})=>c.jsxs("tr",{className:"border-b border-gray-200 dark:border-slate-700/50 last:border-b-0",children:[c.jsxs("td",{className:"p-3 font-mono text-gray-700 dark:text-slate-300 whitespace-nowrap",children:[f,g&&c.jsx("span",{className:"ml-3 text-xs font-semibold text-amber-600 dark:text-amber-400 bg-amber-100 dark:bg-amber-900/50 px-2 py-1 rounded-full align-middle",children:"Clipping"})]}),c.jsx("td",{className:"p-3 font-mono text-red-500 dark:text-red-400",children:h[0].toFixed(2)}),c.jsx("td",{className:"p-3 font-mono text-green-600 dark:text-green-400",children:h[1].toFixed(2)}),c.jsx("td",{className:"p-3 font-mono text-blue-500 dark:text-blue-400",children:h[3].toFixed(2)}),c.jsx("td",{className:"p-3 font-mono text-green-500 dark:text-green-300",children:h[2].toFixed(2)})]},f))})]})]})]})}),at=(e,t,r)=>({avg:e,range:[t,r]}),gx=[{id:"sony-a7r2",name:"Sony ILCE-7RM2 (A7R II)",manufacturer:"Sony",shootingModes:[{modeName:"Still (Mechanical Shutter)",data:[{iso:100,r:at(512.1,511.95,512.25),g1:at(512.05,511.9,512.2),b:at(512.12,511.98,512.28),g2:at(512.06,511.92,512.22)},{iso:200,r:at(512.15,512,512.3),g1:at(512.1,511.95,512.25),b:at(512.18,512.05,512.35),g2:at(512.12,511.98,512.28)},{iso:400,r:at(512.25,512.1,512.45),g1:at(512.2,512.05,512.4),b:at(512.3,512.15,512.5),g2:at(512.22,512.08,512.42)},{iso:800,r:at(512.5,512.2,512.8),g1:at(512.45,512.15,512.75),b:at(512.55,512.25,512.85),g2:at(512.48,512.18,512.78)},{iso:1600,r:at(513.1,512.8,513.4),g1:at(513.05,512.75,513.35),b:at(513.15,512.85,513.45),g2:at(513.08,512.78,513.38)}]}]},{id:"sony-a7c",name:"Sony ILCE-7C",manufacturer:"Sony",shootingModes:[{modeName:"Still (Mechanical)",data:[{iso:100,r:at(512.02,511.98,512.05),g1:at(512.01,511.97,512.04),b:at(512.03,511.99,512.06),g2:at(512.01,511.97,512.04)},{iso:640,r:at(512.15,512.05,512.25),g1:at(512.12,512.02,512.22),b:at(512.18,512.08,512.28),g2:at(512.13,512.03,512.23)}]}]},{id:"canon-r5",name:"Canon EOS R5",manufacturer:"Canon",shootingModes:[{modeName:"Mechanical Shutter",data:[{iso:100,r:at(512,511.8,512.2),g1:at(512,511.8,512.2),b:at(512,511.8,512.2),g2:at(512,511.8,512.2)},{iso:400,r:at(512,511.7,512.3),g1:at(512,511.7,512.3),b:at(512,511.7,512.3),g2:at(512,511.7,512.3)},{iso:1600,r:at(512.2,511.5,512.8),g1:at(512.2,511.5,512.8),b:at(512.2,511.5,512.8),g2:at(512.2,511.5,512.8)}]}]},{id:"canon-r6",name:"Canon EOS R6",manufacturer:"Canon",shootingModes:[{modeName:"Mechanical Shutter",data:[{iso:100,r:at(511.95,511.8,512.1),g1:at(511.95,511.8,512.1),b:at(511.95,511.8,512.1),g2:at(511.95,511.8,512.1)},{iso:800,r:at(512.1,511.9,512.3),g1:at(512.1,511.9,512.3),b:at(512.1,511.9,512.3),g2:at(512.1,511.9,512.3)}]}]},{id:"nikon-z9",name:"Nikon Z9",manufacturer:"Nikon",shootingModes:[{modeName:"Electronic Shutter",data:[{iso:64,r:at(400,399.9,400.1),g1:at(400,399.9,400.1),b:at(400,399.9,400.1),g2:at(400,399.9,400.1)},{iso:100,r:at(400,399.9,400.1),g1:at(400,399.9,400.1),b:at(400,399.9,400.1),g2:at(400,399.9,400.1)}]}]},{id:"nikon-z6-2",name:"Nikon Z 6II",manufacturer:"Nikon",shootingModes:[{modeName:"Still (Lossless)",data:[{iso:100,r:at(400.1,399.8,400.3),g1:at(400.1,399.8,400.3),b:at(400.1,399.8,400.3),g2:at(400.1,399.8,400.3)},{iso:800,r:at(400.3,399.5,401.1),g1:at(400.3,399.5,401.1),b:at(400.3,399.5,401.1),g2:at(400.3,399.5,401.1)}]}]},{id:"fujifilm-xt4",name:"Fujifilm X-T4",manufacturer:"Fujifilm",shootingModes:[{modeName:"Still (RAF)",data:[{iso:160,r:at(1024,1023.8,1024.2),g1:at(1024,1023.8,1024.2),b:at(1024,1023.8,1024.2),g2:at(1024,1023.8,1024.2)},{iso:800,r:at(1024.2,1023.5,1025),g1:at(1024.2,1023.5,1025),b:at(1024.2,1023.5,1025),g2:at(1024.2,1023.5,1025)}]}]}],Yie=({isOpen:e,onClose:t,theme:r})=>{const[n,a]=P.useState(""),[i,o]=P.useState("All"),s=P.useMemo(()=>["All",...Array.from(new Set(gx.map(f=>f.manufacturer))).sort()],[]),l=P.useMemo(()=>gx.filter(d=>{const f=d.name.toLowerCase().includes(n.toLowerCase()),h=i==="All"||d.manufacturer===i;return f&&h}),[n,i]),u=d=>{const f=document.getElementById(`camera-${d}`);f&&f.scrollIntoView({behavior:"smooth"})};return e?c.jsx("div",{className:"fixed inset-0 z-[100] flex items-center justify-center bg-black/60 backdrop-blur-sm p-4 animate-in fade-in duration-200",onClick:t,children:c.jsxs("div",{className:"bg-white dark:bg-slate-900 w-full max-w-6xl h-[90vh] rounded-2xl shadow-2xl flex flex-col border border-gray-200 dark:border-slate-700 overflow-hidden",onClick:d=>d.stopPropagation(),children:[c.jsxs("div",{className:"flex justify-between items-center p-5 border-b border-gray-200 dark:border-slate-700 bg-gray-50 dark:bg-slate-800/50",children:[c.jsxs("h2",{className:"text-xl font-bold text-gray-900 dark:text-slate-100 flex items-center gap-2",children:["Camera Black Level Database",c.jsxs("span",{className:"text-xs font-normal bg-cyan-100 dark:bg-cyan-900/30 text-cyan-600 dark:text-cyan-400 px-2 py-0.5 rounded border border-cyan-200 dark:border-cyan-800",children:[gx.length," Models"]})]}),c.jsx("button",{onClick:t,className:"text-gray-400 hover:text-gray-600 dark:hover:text-slate-200 transition-colors p-2 rounded-full hover:bg-gray-100 dark:hover:bg-slate-800",children:c.jsx("svg",{className:"w-6 h-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),c.jsx("div",{className:"p-4 border-b border-gray-200 dark:border-slate-700 bg-gray-50/50 dark:bg-slate-800/30",children:c.jsx(Vie,{searchTerm:n,onSearchChange:a,manufacturers:s,selectedManufacturer:i,onManufacturerChange:o,cameras:l,onCameraSelect:u})}),c.jsx("div",{className:"flex-1 overflow-y-auto p-6 scrollbar-thin scrollbar-thumb-gray-300 dark:scrollbar-thumb-slate-700 bg-gray-100 dark:bg-slate-950",children:c.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 xl:grid-cols-2 gap-6",children:[l.map(d=>c.jsx("div",{id:`camera-${d.id}`,children:c.jsx(Kie,{camera:d,theme:r})},d.id)),l.length===0&&c.jsx("div",{className:"col-span-full flex flex-col items-center justify-center py-20 text-gray-400 dark:text-slate-600",children:c.jsx("p",{className:"text-lg",children:"No cameras found matching your criteria."})})]})})]})}):null},qie=({isOpen:e,onClose:t,zIndex:r=150})=>{const[n,a]=P.useState(""),[i,o]=P.useState(""),[s,l]=P.useState(""),[u,d]=P.useState(""),[f,h]=P.useState(null),g=()=>{const v=parseFloat(n),w=parseFloat(i),b=parseFloat(s),x=parseFloat(u);if(isNaN(v)||isNaN(w)||isNaN(b)||isNaN(x)){h(null);return}const y=v,_=w,j=b*b,S=x*x,k=(y+_)/2;if(k<=1e-9){h(0);return}const M=j*S/k,N=Math.sqrt(M);h(N)};return e?c.jsxs(Cl,{initialPosition:{x:window.innerWidth/2-160,y:window.innerHeight/2-200},onClose:t,zIndex:r,className:"w-80 bg-white dark:bg-slate-900 border border-gray-200 dark:border-slate-700 flex flex-col shadow-2xl",children:[c.jsxs("div",{className:"flex justify-between items-center px-4 py-3 border-b border-gray-200 dark:border-slate-700 bg-gray-50 dark:bg-slate-800",children:[c.jsx("h3",{className:"text-sm font-bold text-gray-700 dark:text-slate-200",children:"Cross-Compensation Calc"}),c.jsx("button",{onClick:t,className:"text-gray-400 hover:text-red-500 transition-colors",children:c.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),c.jsxs("div",{className:"p-4 flex flex-col gap-3 text-xs",children:[c.jsxs("div",{className:"flex flex-col gap-1",children:[c.jsx("label",{className:"text-gray-500 dark:text-slate-400 font-bold",children:"H Mean (Power/Var)"}),c.jsx("input",{type:"number",step:"any",value:n,onChange:v=>a(v.target.value),className:"p-2 rounded bg-gray-100 dark:bg-slate-800 border border-gray-300 dark:border-slate-600 outline-none focus:border-indigo-500 text-gray-900 dark:text-slate-100 font-mono"})]}),c.jsxs("div",{className:"flex flex-col gap-1",children:[c.jsx("label",{className:"text-gray-500 dark:text-slate-400 font-bold",children:"V Mean (Power/Var)"}),c.jsx("input",{type:"number",step:"any",value:i,onChange:v=>o(v.target.value),className:"p-2 rounded bg-gray-100 dark:bg-slate-800 border border-gray-300 dark:border-slate-600 outline-none focus:border-indigo-500 text-gray-900 dark:text-slate-100 font-mono"})]}),c.jsxs("div",{className:"flex flex-col gap-1",children:[c.jsx("label",{className:"text-gray-500 dark:text-slate-400 font-bold",children:"H RMS 0 (Sigma)"}),c.jsx("input",{type:"number",step:"any",value:s,onChange:v=>l(v.target.value),className:"p-2 rounded bg-gray-100 dark:bg-slate-800 border border-gray-300 dark:border-slate-600 outline-none focus:border-indigo-500 text-gray-900 dark:text-slate-100 font-mono"})]}),c.jsxs("div",{className:"flex flex-col gap-1",children:[c.jsx("label",{className:"text-gray-500 dark:text-slate-400 font-bold",children:"V RMS 0 (Sigma)"}),c.jsx("input",{type:"number",step:"any",value:u,onChange:v=>d(v.target.value),className:"p-2 rounded bg-gray-100 dark:bg-slate-800 border border-gray-300 dark:border-slate-600 outline-none focus:border-indigo-500 text-gray-900 dark:text-slate-100 font-mono"})]}),c.jsx("button",{onClick:g,className:"mt-2 w-full py-2 bg-indigo-600 hover:bg-indigo-500 text-white font-bold rounded shadow transition-colors active:scale-95",children:"Calculate Sigma"}),f!==null&&c.jsxs("div",{className:"mt-2 p-3 bg-indigo-50 dark:bg-indigo-900/30 border border-indigo-200 dark:border-indigo-800 rounded text-center animate-in fade-in slide-in-from-top-1",children:[c.jsx("span",{className:"block text-[10px] uppercase font-bold text-gray-500 dark:text-slate-400 mb-1",children:"Original White Noise Sigma"}),c.jsx("span",{className:"text-lg font-mono font-bold text-indigo-700 dark:text-indigo-300 select-all",children:f.toFixed(5)})]})]})]}):null},q1=[[.1725,.0838,.0576],[.5481,.2985,.217],[.1103,.1968,.3359],[.1038,.1502,.0521],[.2244,.2177,.4302],[.1232,.519,.4044],[.7168,.199,.0271],[.065,.1063,.3924],[.5417,.0884,.1203],[.1042,.0438,.1396],[.3547,.5078,.0482],[.7805,.3541,.0215],[.0234,.0492,.2916],[.0653,.3019,.0645],[.4294,.0319,.0402],[.8568,.5754,.0079],[.5032,.0889,.3055],[0,.249,.383],[.9163,.9155,.8705],[.5819,.5911,.5839],[.3552,.361,.359],[.1876,.1924,.1917],[.0871,.0901,.0908],[.0321,.0319,.0326]],Zie=[[3.2404542,-1.5371385,-.4985314],[-.969266,1.8760108,.041556],[.0556434,-.2040259,1.0572252]];function Jie(e,t,r,n,a,i,o=.5){const u=[],d=Math.max(.1,Math.min(.9,o)),f=Math.hypot(t.x-e.x,t.y-e.y),h=Math.hypot(n.x-r.x,n.y-r.y),g=Math.hypot(r.x-e.x,r.y-e.y),v=Math.hypot(n.x-t.x,n.y-t.y),w=(f+h)/2/5,b=(g+v)/2/3,x=w*d,y=b*d;for(let _=0;_<4;_++)for(let j=0;j<6;j++){const S=j/5,k=_/3,M=(1-S)*(1-k)*e.x+S*(1-k)*t.x+(1-S)*k*r.x+S*k*n.x,N=(1-S)*(1-k)*e.y+S*(1-k)*t.y+(1-S)*k*r.y+S*k*n.y;u.push({x:M-x/2,y:N-y/2,w:x,h:y})}return u}function $O(e){e.length;const t=e[0].length;return Array(t).fill(0).map((r,n)=>e.map(a=>a[n]))}function Jh(e,t){const r=e.length,n=e[0].length,a=t.length,i=t[0].length;if(n!==a)throw new Error("Matrix dimensions mismatch");const o=Array(r).fill(0).map(()=>Array(i).fill(0));for(let s=0;s<r;s++)for(let l=0;l<i;l++)for(let u=0;u<n;u++)o[s][l]+=e[s][u]*t[u][l];return o}function Qie(e,t){const r=$O(e),n=Jh(r,e);for(let u=0;u<3;u++)n[u][u]+=1e-9;const a=[[n[0][0],n[0][1],n[0][2]],[n[1][0],n[1][1],n[1][2]],[n[2][0],n[2][1],n[2][2]]],i=oc(a);if(!i)throw new Error("Singular Matrix (Check Input Data)");const o=[[i[0][0],i[0][1],i[0][2]],[i[1][0],i[1][1],i[1][2]],[i[2][0],i[2][1],i[2][2]]],s=Jh(r,t);return Jh(o,s)}function eoe(e){const t=e.length,r=e.map((n,a)=>[...n,...Array(t).fill(0).map((i,o)=>a===o?1:0)]);for(let n=0;n<t;n++){let a=n;for(let s=n+1;s<t;s++)Math.abs(r[s][n])>Math.abs(r[a][n])&&(a=s);const i=r[n];r[n]=r[a],r[a]=i;const o=r[n][n];if(Math.abs(o)<1e-12)throw new Error("Singular Matrix");for(let s=n;s<2*t;s++)r[n][s]/=o;for(let s=0;s<t;s++)if(s!==n){const l=r[s][n];for(let u=n;u<2*t;u++)r[s][u]-=l*r[n][u]}}return r.map(n=>n.slice(t))}function toe(e,t,r){const n=[...e].sort((w,b)=>w.id-b.id);if(n.length!==24)throw new Error("Requires exactly 24 patches");const a=[];n.forEach(w=>{const b=w.rawMeans,x=[b[0]-t[0],b[1]-t[1],b[2]-t[2],b[3]-t[3]];let y,_,j;r?(j=x[0],_=(x[1]+x[2])/2,y=x[3]):(y=x[0],_=(x[1]+x[2])/2,j=x[3]),y=Math.max(0,y),_=Math.max(0,_),j=Math.max(0,j),a.push([y,_,j])});const o=a[18],s=(o[0]+o[1]+o[2])/3,l=1/Math.max(1e-9,s),u=a.map(w=>[w[0]*l,w[1]*l,w[2]*l]),f=Qie(u,q1),h=$O(f);let g;try{g=eoe(h)}catch{throw new Error("CCM Inversion Failed. Input data might be too dark or clipped.")}return{matrix:Jh(g,Zie)}}const roe=({isOpen:e,onClose:t,patchStats:r,initialIsBGGR:n,zIndex:a=200,sizeRatio:i,onSizeChange:o})=>{const[s,l]=P.useState(n),[u,d]=P.useState(["0","0","0","0"]),[f,h]=P.useState(null),[g,v]=P.useState(null);if(P.useEffect(()=>{if(e&&r&&r.length===24){const k=r[23].rawMeans;u[0]==="0"&&u[1]==="0"&&d([k[0].toFixed(2),k[1].toFixed(2),k[2].toFixed(2),k[3].toFixed(2)])}},[e,r]),P.useEffect(()=>{if(!e||!r||r.length!==24)return;const S=u.map(k=>parseFloat(k));if(!S.some(isNaN))try{const k=toe(r,S,s);h(k),v(null)}catch(k){v(k.message)}},[e,r,s,u]),!e)return null;const w=(S,k)=>{d(M=>{const N=[...M];return N[S]=k,N})},b=S=>{navigator.clipboard.writeText(S)},x=S=>S?S.map(k=>k.map(M=>M.toFixed(4))):[],y=f?x(f.matrix).flat().join(" "):"",_=s?["B","G1","G2","R"]:["R","G1","G2","B"],j=s?["text-blue-500","text-green-500","text-green-500","text-red-500"]:["text-red-500","text-green-500","text-green-500","text-blue-500"];return c.jsxs(Cl,{initialPosition:{x:window.innerWidth/2-200,y:100},onClose:t,zIndex:a,className:"w-[500px] bg-white dark:bg-slate-900 border border-gray-200 dark:border-slate-700 flex flex-col shadow-2xl rounded-xl overflow-hidden",children:[c.jsxs("div",{className:"flex justify-between items-center px-4 py-3 border-b border-gray-200 dark:border-slate-700 bg-gray-50 dark:bg-slate-800",children:[c.jsxs("h3",{className:"text-sm font-bold text-gray-800 dark:text-slate-100 flex items-center gap-2",children:[c.jsx("span",{className:"w-2 h-2 rounded-full bg-yellow-500"}),"Color Lab Result"]}),c.jsx("button",{onClick:t,className:"text-gray-400 hover:text-red-500 transition-colors",children:c.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),c.jsxs("div",{className:"p-5 flex flex-col gap-5",children:[c.jsxs("div",{className:"bg-gray-100 dark:bg-slate-800 p-3 rounded-lg border border-gray-200 dark:border-slate-700",children:[c.jsxs("div",{className:"flex justify-between items-center mb-1",children:[c.jsx("span",{className:"text-[10px] font-bold text-gray-500 dark:text-slate-400 uppercase",children:"Patch Sampling Size"}),c.jsxs("span",{className:"text-xs font-mono font-bold text-cyan-600 dark:text-cyan-400",children:[Math.round(i*100),"%"]})]}),c.jsx("input",{type:"range",min:"0.1",max:"0.9",step:"0.05",value:i,onChange:S=>o(parseFloat(S.target.value)),className:"w-full h-1.5 bg-gray-300 dark:bg-slate-600 rounded-lg appearance-none cursor-pointer accent-cyan-500"})]}),c.jsx("div",{className:"flex justify-center",children:c.jsxs("div",{className:"flex bg-gray-100 dark:bg-slate-800 p-1 rounded-lg border border-gray-200 dark:border-slate-700",children:[c.jsx("button",{onClick:()=>l(!1),className:`px-4 py-1.5 text-xs font-bold rounded transition-all ${s?"text-gray-500 dark:text-slate-400 hover:text-gray-700":"bg-white dark:bg-slate-600 text-indigo-600 dark:text-indigo-300 shadow-sm"}`,children:"RGGB Mode"}),c.jsx("button",{onClick:()=>l(!0),className:`px-4 py-1.5 text-xs font-bold rounded transition-all ${s?"bg-white dark:bg-slate-600 text-indigo-600 dark:text-indigo-300 shadow-sm":"text-gray-500 dark:text-slate-400 hover:text-gray-700"}`,children:"BGGR Mode"})]})}),c.jsxs("div",{className:"bg-gray-50 dark:bg-slate-800/50 p-3 rounded-lg border border-gray-100 dark:border-slate-700",children:[c.jsx("h4",{className:"text-[10px] font-bold text-gray-400 dark:text-slate-500 uppercase mb-2",children:"Input Black Levels ()"}),c.jsx("div",{className:"grid grid-cols-4 gap-2",children:[0,1,2,3].map(S=>c.jsxs("div",{className:"flex flex-col",children:[c.jsx("label",{className:`text-[10px] font-bold mb-1 ${j[S]}`,children:_[S]}),c.jsx("input",{type:"number",step:"0.01",value:u[S],onChange:k=>w(S,k.target.value),className:"w-full px-2 py-1 text-sm font-mono border border-gray-300 dark:border-slate-600 rounded bg-white dark:bg-slate-900 text-gray-900 dark:text-slate-100 outline-none focus:ring-1 focus:ring-yellow-500"})]},S))})]}),g?c.jsx("div",{className:"text-red-500 text-sm text-center bg-red-50 dark:bg-red-900/20 p-2 rounded",children:g}):f?c.jsx(c.Fragment,{children:c.jsxs("div",{className:"bg-gray-50 dark:bg-slate-800/50 p-3 rounded-lg border border-gray-100 dark:border-slate-700",children:[c.jsx("h4",{className:"text-[10px] font-bold text-gray-400 dark:text-slate-500 uppercase mb-2",children:"Calculated Color Matrix (XYZ  Camera RGB)"}),c.jsx("div",{className:"font-mono text-xs text-gray-700 dark:text-slate-300 grid grid-rows-3 gap-1 mb-3",children:x(f.matrix).map((S,k)=>c.jsxs("div",{className:"flex justify-between bg-white dark:bg-slate-900 px-2 py-1 rounded",children:[c.jsx("span",{className:"text-red-500/80 w-1/3 text-right",children:S[0]}),c.jsx("span",{className:"text-green-500/80 w-1/3 text-right",children:S[1]}),c.jsx("span",{className:"text-blue-500/80 w-1/3 text-right",children:S[2]})]},k))}),c.jsx("button",{onClick:()=>b(y),className:"w-full py-1.5 bg-indigo-600 hover:bg-indigo-500 text-white text-xs font-bold rounded shadow transition-transform active:scale-95 flex items-center justify-center gap-2",children:"Copy Matrix String (for customMatrix)"})]})}):c.jsx("div",{className:"text-gray-400 text-sm text-center",children:"Calculating..."})]})]})};function hw(e,t){const r=e.length;let n=0,a=0,i=0,o=0;for(let l=0;l<r;l++)n+=e[l],a+=t[l],i+=e[l]*t[l],o+=e[l]*e[l];const s=r*o-n*n;return s===0?{slope:0,intercept:0}:{slope:(r*i-n*a)/s,intercept:(a*o-n*i)/s}}function noe(e,t){const r=e.length,n=new Array(r).fill(0),a=2*t;for(let i=0;i<r;i++){const o=i>0?e[i-1]:e[0],s=i<r-1?e[i+1]:e[r-1];n[i]=(s-o)/a}return n}function aoe(e){const t=new Array(e.length).fill(0);t[0]=e[0];for(let r=1;r<e.length;r++){let n=e[r]-e[r-1];n>Math.PI?n-=2*Math.PI:n<-Math.PI&&(n+=2*Math.PI),t[r]=t[r-1]+n}return t}function ioe(e){const t=e.length,r=new Array(t).fill(0).map((i,o)=>o),{slope:n,intercept:a}=hw(r,e);return e.map((i,o)=>i-(n*o+a))}function ooe(e,t,r="RGGB"){const n=r.toUpperCase(),a=t%2,i=e%2;return n==="RGGB"||n==="BGGR"?(a+i)%2!==0:n==="GBRG"||n==="GRBG"?(a+i)%2===0:(a+i)%2!==0}function Z1(e,t,r,n,a){const i=Math.floor(n.x),o=Math.floor(n.y),s=Math.floor(n.w),l=Math.floor(n.h);if(s<8||l<8)return null;let u=[];for(let ce=0;ce<l;ce++){const de=[],Ne=(o+ce)*t;for(let pe=0;pe<s;pe++)de.push(e[Ne+i+pe]);u.push(de)}let d=0,f=0;for(let ce=1;ce<l-1;ce+=2)for(let de=1;de<s-1;de+=2)d+=Math.abs(u[ce][de+1]-u[ce][de-1]),f+=Math.abs(u[ce+1][de]-u[ce-1][de]);let h=s,g=l,v=u,w=2,b=!1;if(f>d){w=1,b=!0,v=Array(s).fill(0).map(()=>Array(l).fill(0));for(let ce=0;ce<l;ce++)for(let de=0;de<s;de++)v[de][l-1-ce]=u[ce][de];h=l,g=s}else w=2;const x=[],y=[];for(let ce=0;ce<g;ce++){const de=v[ce],Ne=de.map((me,Be)=>Be===0?0:Math.abs(me-de[Be-1])),pe=Math.max(...Ne),ke=Ne.indexOf(pe);if(pe>1){const me=Math.max(0,ke-3),Be=Math.min(h,ke+4);let Se=0,we=0;for(let Re=me;Re<Be;Re++)Se+=Ne[Re],we+=Re*Ne[Re];Se>0&&(x.push(we/Se),y.push(ce))}}if(x.length<g*.4)return null;const{slope:_,intercept:j}=hw(y,x),S=Math.cos(Math.atan(_)),k=[],M=[],N=(a==null?void 0:a.greenOnly)??!1,T=(a==null?void 0:a.globalX)??0,A=(a==null?void 0:a.globalY)??0,D=(a==null?void 0:a.bayerPattern)||"RGGB";for(let ce=0;ce<g;ce++){const de=_*ce+j;for(let Ne=0;Ne<h;Ne++){if(N){let pe,ke;if(b){const me=l-1-Ne,Be=ce;pe=T+i+Be,ke=A+o+me}else pe=T+i+Ne,ke=A+o+ce;if(!ooe(pe,ke,D))continue}k.push((Ne-de)*S),M.push(v[ce][Ne])}}const B=Math.min(s,l)/2;let J=0;for(const ce of k)Math.abs(ce)<=B&&J++;let W=.125;if(a!=null&&a.manualBinSize&&a.manualBinSize>0)W=Math.max(.01,Math.min(.5,a.manualBinSize));else if(J>0){const ce=40*B/J;W=Math.max(.01,Math.min(.125,ce))}const I=W,G=Array.from(k.keys()).sort((ce,de)=>k[ce]-k[de]),U=G.map(ce=>k[ce]),X=G.map(ce=>M[ce]);if(U.length===0)return null;const V=U[0],z=U[U.length-1],q=Math.floor((z-V)/I),te=new Array(q).fill(0),ie=new Array(q).fill(0);for(let ce=0;ce<U.length;ce++){const de=Math.floor((U[ce]-V)/I);de>=0&&de<q&&(te[de]+=X[ce],ie[de]++)}let he=X[0];for(let ce=0;ce<q;ce++)ie[ce]>0?(te[ce]/=ie[ce],he=te[ce]):te[ce]=he;const ee=te.slice(0,10).reduce((ce,de)=>ce+de,0)/10,Le=te.slice(-10).reduce((ce,de)=>ce+de,0)/10;if(ee>Le){const ce=Math.max(...te),de=Math.min(...te);for(let Ne=0;Ne<te.length;Ne++)te[Ne]=ce-te[Ne]+de}const fe=noe(te,I);return{esf:te,lsfFull:fe,binSize:I,orientation:w}}function LO(e,t,r,n=!1,a=0,i=!1){if(e.length===0)return null;const o=4096,s=new sc(o),l=r?1e3/r:1,u=new Float32Array(501);for(let y=0;y<=500;y++)u[y]=y/500*l*2;const d=new Float32Array(501).fill(0);let f=0,h=[],g=[],v=0,w=[];for(const y of e){let _=[...y.lsfFull];const j=y.binSize;let S=0,k=-1/0;for(let ie=0;ie<_.length;ie++)_[ie]>k&&(k=_[ie],S=ie);const M=k*.2;let N=0,T=_.length-1;for(let ie=S;ie>=0;ie--)if(_[ie]<M){N=ie;break}for(let ie=S;ie<_.length;ie++)if(_[ie]<M){T=ie;break}const A=T-N;let D=!1;if(n&&A>0){const ie=A*4,he=[],ee=[];if(a>0){const Le=Math.max(0,S-ie-a),fe=Math.max(0,S-ie);for(let Ne=Le;Ne<fe;Ne++)he.push(Ne),ee.push(_[Ne]);const ce=Math.min(_.length,S+ie),de=Math.min(_.length,S+ie+a);for(let Ne=ce;Ne<de;Ne++)he.push(Ne),ee.push(_[Ne])}else{for(let Le=0;Le<Math.max(0,S-ie);Le++)he.push(Le),ee.push(_[Le]);for(let Le=Math.min(_.length,S+ie);Le<_.length;Le++)he.push(Le),ee.push(_[Le])}if(he.length>2){const{slope:Le,intercept:fe}=hw(he,ee);for(let ce=0;ce<_.length;ce++)_[ce]=_[ce]-(Le*ce+fe);k=-1/0;for(let ce=0;ce<_.length;ce++)_[ce]>k&&(k=_[ce],S=ce);D=!0}}let $=0,B=0;if(t>0)B=t,$=Math.round(t/j);else{const ie=k*.2;let he=0,ee=_.length-1;for(let de=S;de>=0;de--)if(_[de]<ie){he=de;break}for(let de=S;de<_.length;de++)if(_[de]<ie){ee=de;break}const fe=(ee-he)*j;let ce=Math.max(2,fe*8);B=ce,$=Math.round(ce/j)}v+=B;const J=Math.max(0,S-$),W=Math.min(_.length,S+$),I=_.slice(J,W);if(I.length<8)continue;const G=new Float32Array(o).fill(0);let U=-1/0,X=0;for(let ie=0;ie<I.length;ie++)I[ie]>U&&(U=I[ie],X=ie);for(let ie=0;ie<I.length;ie++){let he=1;i&&(he=.5*(1-Math.cos(2*Math.PI*ie/(I.length-1))));const ee=I[ie]*he,Le=(ie-X+o)%o;G[Le]=ee}s.transform(G);const V=[],z=[],q=[];for(let ie=0;ie<=o/2;ie++){const he=s._real[ie],ee=s._imag[ie],Le=Math.sqrt(he*he+ee*ee);V.push(Le),z.push(ie/(o*j)*l),q.push(Math.atan2(ee,he))}const te=V[0];if(te>0){for(let ie=0;ie<=500;ie++){const he=u[ie];d[ie]+=t_(he,z,V)/te}if(f++,h.length===0){h=I,g=D?soe(_):y.esf;const ie=aoe(q),he=ioe(ie);for(let ee=0;ee<=500;ee++){const Le=u[ee];w.push(t_(Le,z,he))}}}}if(f===0)return null;const b=Array.from(d).map(y=>y/f);let x=null;for(let y=0;y<b.length-1;y++)if(b[y]>=.5&&b[y+1]<.5){x=u[y]+(.5-b[y])*(u[y+1]-u[y])/(b[y+1]-b[y]);break}return{esf:g,lsf:[],lsfCropped:h,mtf:b,ptf:w,freqs:Array.from(u),mtf50:x,calcRadius:v/f}}function soe(e){const t=new Array(e.length).fill(0);let r=0;for(let n=0;n<e.length;n++)r+=e[n],t[n]=r;return t}function t_(e,t,r){if(e<=t[0])return r[0];if(e>=t[t.length-1])return r[r.length-1];let n=0;for(;e>t[n+1];)n++;const a=(e-t[n])/(t[n+1]-t[n]);return r[n]+a*(r[n+1]-r[n])}const Ds=({locked:e,onToggle:t,title:r})=>c.jsx("span",{className:"inline-flex items-center justify-center p-1 rounded hover:bg-gray-200 dark:hover:bg-slate-700 transition-colors cursor-pointer select-none",title:r??(e?"Locked (Auto Fit will NOT change)":"Unlocked (Auto Fit may change)"),onMouseDown:n=>{n.stopPropagation()},onClick:n=>{n.stopPropagation(),t()},children:c.jsx("span",{className:`w-4 h-4 rounded-full border-2 transition-all active:scale-90 flex items-center justify-center ${e?"border-indigo-600 bg-indigo-600":"border-gray-400 dark:border-slate-500 bg-transparent hover:border-gray-500"}`,children:e&&c.jsx("span",{className:"w-2 h-2 rounded-full bg-white"})})}),loe=({isOpen:e,onClose:t,rawImageData:r,roi:n,zIndex:a=110,onFocus:i,displaySettings:o,isSfrLabOpen:s})=>{const[l,u]=P.useState([]),[d,f]=P.useState(""),[h,g]=P.useState(""),[v,w]=P.useState(12),[b,x]=P.useState(!0),[y,_]=P.useState(!0),[j,S]=P.useState(!0),[k,M]=P.useState(!1),[N,T]=P.useState(!1),[A,D]=P.useState(!1),[$,B]=P.useState(!1),[J,W]=P.useState("50"),[I,G]=P.useState(!1),[U,X]=P.useState("0.125"),[V,z]=P.useState(!1),[q,te]=P.useState({aperture:4,olpfSeparationPx:.7,fillFactor:.9,coreSigmaPx:.15,haloSigmaPx:.8,haloWeight:.25,wavelengthUm:.55,rolloff:1}),[ie,he]=P.useState({aperture:!1,olpfSeparationPx:!1,fillFactor:!1,coreSigmaPx:!1,haloSigmaPx:!1,haloWeight:!1,wavelengthUm:!1,rolloff:!1}),[ee,Le]=P.useState("0"),[fe,ce]=P.useState(""),[de,Ne]=P.useState(!1),[pe,ke]=P.useState(""),[me,Be]=P.useState(1),[Se,we]=P.useState(null),[Re,it]=P.useState({x:100,y:50}),[Qe,se]=P.useState({w:1e3,h:800}),[Xe,ht]=P.useState(!1),[Zt,Jt]=P.useState(!1),Ut=P.useRef({x:0,y:0}),Lt=P.useRef({w:0,h:0}),[pr,ir]=P.useState(!1),[zt,Tr]=P.useState(!1),lt=l.length>0?l[l.length-1].binSize:null,Nt=lt?(1/lt).toFixed(1):"-",wr=P.useMemo(()=>n?Math.max(n.w,n.h):100,[n]),_r=(o==null?void 0:o.renderMode)==="advanced-zero-dep",zr=P.useMemo(()=>{const F=parseFloat(d);return Number.isFinite(F)&&F>0?F:null},[d]),Or=zr!==null,or=Or?"lp/mm":"cy/px",Br=(F,Oe,Ie)=>Math.min(Ie,Math.max(Oe,F)),Xt=F=>{if(Math.abs(F)<1e-12)return 1;const Oe=Math.PI*F;return Math.sin(Oe)/Oe},Te=F=>F<=0?1:F>=1?0:2/Math.PI*(Math.acos(F)-F*Math.sqrt(1-F*F)),Q=(F,Oe,Ie,Tt)=>{const Ve=Br(Tt,0,1),pt=Math.max(0,Oe),Ye=Math.max(0,Ie),Wt=Math.exp(-2*Math.PI*Math.PI*pt*pt*F*F),Ir=Math.exp(-2*Math.PI*Math.PI*Ye*Ye*F*F);return(1-Ve)*Wt+Ve*Ir},Ce=P.useMemo(()=>Or&&zr?1e3/zr:1,[Or,zr]),ye=(F,Oe)=>{const{aperture:Ie,olpfSeparationPx:Tt,fillFactor:Ve,coreSigmaPx:pt,haloSigmaPx:Ye,haloWeight:Wt,wavelengthUm:Ir,rolloff:Qr}=Oe,Kt=Or?F/Ce:F,Pn=Math.max(1e-9,Ir)/1e3,qr=Or&&zr?zr/1e3:5/1e3,Xr=Math.max(1e-6,Ie),nr=1/(Pn*Xr)*qr,Ar=nr>0?Kt/nr:1e9,qe=Te(Ar),hr=Math.max(0,Tt),fn=Math.abs(Math.cos(Math.PI*Kt*hr)),Ln=Br(Ve,0,1),Zn=Math.abs(Xt(Kt*Ln)),Tn=Math.max(0,pt),Oi=Math.max(0,Ye),ue=Q(Kt,Tn,Oi,Wt);let ve=qe*fn*Zn*ue;const be=Math.max(.1,Qr);return ve=Math.pow(Math.max(0,ve),be),Math.min(1.2,Math.max(0,ve))},ze=()=>{if(!(!r||!n)){if(!_r){alert("Scalar Unmixing is required. Please configure Background/Foreground/BlackLevel in the Sidebar and click 'RUN UNMIXING' first.");return}try{let F=null;const Oe=I?parseFloat(U):void 0;if(o!=null&&o.advancedZeroDep){const Ie=i2(r,n,o);F=Z1(Ie.data,Ie.width,Ie.height,{x:0,y:0,w:Ie.width,h:Ie.height},{greenOnly:j,globalX:n.x,globalY:n.y,bayerPattern:r.bayerPattern,manualBinSize:Oe})}else F=Z1(r.data,r.width,r.height,n,{greenOnly:j,globalX:n.x,globalY:n.y,bayerPattern:r.bayerPattern,manualBinSize:Oe});F?u(Ie=>[...Ie,F]):alert("Could not detect valid edge.")}catch(F){console.error(F),alert("Error processing ROI")}}},ot=()=>{u([]),we(null),Be(1)},ct=()=>{if(!Se)return;const F=parseFloat(d),Tt=`data:text/csv;charset=utf-8,Frequency (${!isNaN(F)&&F>0?"lp/mm":"cy/px"}),MTF,Phase(Rad)
`+Se.freqs.map((Ye,Wt)=>{const Ir=Se.ptf?Se.ptf[Wt]:0;return`${Ye.toFixed(6)},${Se.mtf[Wt].toFixed(6)},${Ir?Ir.toFixed(6):0}`}).join(`
`),Ve=encodeURI(Tt),pt=document.createElement("a");pt.setAttribute("href",Ve),pt.setAttribute("download",`sfr_data_${Date.now()}.csv`),document.body.appendChild(pt),pt.click(),document.body.removeChild(pt)},Ct=()=>{if(!(Se!=null&&Se.mtf50)||!n)return;const F=n.x+n.w/2,Oe=n.y+n.h/2,Ie=`{${F.toFixed(1)},${Oe.toFixed(1)},${Se.mtf50.toFixed(4)}}`;navigator.clipboard.writeText(Ie)};P.useEffect(()=>{if(l.length===0){we(null);return}const F=parseFloat(d),Oe=!isNaN(F)&&F>0?F:null,Ie=b?-1:v,Tt=$&&parseFloat(J)||0,Ve=LO(l,Ie,Oe,y,Tt,k);we(Ve)},[l,v,b,y,d,$,J,k]),P.useEffect(()=>{e&&_r&&l.length===0&&n&&r&&ze()},[e]);const tt=F=>{i&&i(),!zt&&(F.target.closest("button")||F.target.closest("input")||F.target.closest("select")||F.target.closest("label")||(ht(!0),Ut.current={x:F.clientX-Re.x,y:F.clientY-Re.y}))},Hr=F=>{zt||(F.stopPropagation(),F.preventDefault(),Jt(!0),Ut.current={x:F.clientX,y:F.clientY},Lt.current={w:Qe.w,h:Qe.h})};P.useEffect(()=>{const F=Ie=>{if(Xe)it({x:Ie.clientX-Ut.current.x,y:Ie.clientY-Ut.current.y});else if(Zt){const Tt=Ie.clientX-Ut.current.x,Ve=Ie.clientX-Ut.current.y;se({w:Math.max(600,Lt.current.w+Tt),h:Math.max(500,Lt.current.h+Ve)})}},Oe=()=>{ht(!1),Jt(!1)};return(Xe||Zt)&&(window.addEventListener("mousemove",F),window.addEventListener("mouseup",Oe)),()=>{window.removeEventListener("mousemove",F),window.removeEventListener("mouseup",Oe)}},[Xe,Zt]);const gr=P.useMemo(()=>{if(!(Se!=null&&Se.mtf50)||!h)return null;const F=parseFloat(h);if(isNaN(F)||F<=0)return null;let Oe=Se.mtf50;const Ie=parseFloat(d);return!isNaN(Ie)&&Ie>0&&(Oe=Se.mtf50*(Ie/1e3)),Oe*2*F},[Se,h,d]),Qt=N?2:1,jt=Qt*Ce,mr=.004,R=P.useMemo(()=>{if(!V)return[];const F=[];for(let Oe=0;Oe<=Qt+1e-12;Oe+=mr){const Ie=Oe*Ce;F.push({freq:Ie,modelMtf:ye(Ie,q)})}return F},[V,q,Qt,Ce]),sr=P.useMemo(()=>{const F=Se?Se.mtf.map((Ie,Tt)=>({freq:Se.freqs[Tt],mtf:Ie})).filter(Ie=>Ie.freq<=jt):[];if(!V||R.length===0)return F.map(Ie=>({freq:Ie.freq,mtf:Ie.mtf,modelMtf:null}));const Oe=new Map;for(const Ie of R){const Tt=Ie.freq.toFixed(6);Oe.set(Tt,{freq:Ie.freq,mtf:null,modelMtf:Ie.modelMtf})}for(const Ie of F){const Tt=Ie.freq.toFixed(6),Ve=Oe.get(Tt);Ve?Ve.mtf=Ie.mtf:Oe.set(Tt,{freq:Ie.freq,mtf:Ie.mtf,modelMtf:null})}return Array.from(Oe.values()).sort((Ie,Tt)=>Ie.freq-Tt.freq)},[Se,jt,V,R]),Fr=Se?Se.lsfCropped.map((F,Oe)=>({x:Oe,y:F})):[],Me=Se?Se.esf.map((F,Oe)=>({x:Oe,y:F})):[],ut=P.useMemo(()=>Se!=null&&Se.ptf?Se.ptf.map((F,Oe)=>({freq:Se.freqs[Oe],ptf:F})).filter(F=>F.freq<=jt):[],[Se,jt]);if(!e)return null;const gt={aperture:[.7,64],olpfSeparationPx:[0,5],fillFactor:[.05,1],coreSigmaPx:[0,3],haloSigmaPx:[0,50],haloWeight:[0,1],wavelengthUm:[.4,.7],rolloff:[.2,6]},yr={aperture:.2,olpfSeparationPx:.05,fillFactor:.03,coreSigmaPx:.03,haloSigmaPx:.2,haloWeight:.05,wavelengthUm:.01,rolloff:.1},lr=()=>{let F=0,Oe=0;for(;F===0;)F=Math.random();for(;Oe===0;)Oe=Math.random();return Math.sqrt(-2*Math.log(F))*Math.cos(2*Math.PI*Oe)},et=()=>["aperture","olpfSeparationPx","fillFactor","coreSigmaPx","haloSigmaPx","haloWeight","wavelengthUm","rolloff"].filter(Oe=>!ie[Oe]),tr=(F,Oe)=>Oe.map(Ie=>F[Ie]),rr=(F,Oe,Ie,Tt)=>{const Ve={...Oe};for(let Wt=0;Wt<Ie.length;Wt++){const Ir=Ie[Wt],[Qr,Kt]=gt[Ir];Ve[Ir]=Br(F[Wt],Qr,Kt)}Object.keys(Tt).forEach(Wt=>{Tt[Wt]&&(Ve[Wt]=Oe[Wt])});const pt=Tt.coreSigmaPx,Ye=Tt.haloSigmaPx;return Ye&&!pt?Ve.coreSigmaPx=Math.min(Ve.coreSigmaPx,Oe.haloSigmaPx):pt&&!Ye?Ve.haloSigmaPx=Math.max(Ve.haloSigmaPx,Oe.coreSigmaPx):!pt&&!Ye&&(Ve.haloSigmaPx=Math.max(Ve.haloSigmaPx,Ve.coreSigmaPx)),Ve},Dt=(F,Oe)=>{const Ie=[...F];for(let Tt=0;Tt<Oe.length;Tt++){const Ve=Oe[Tt],pt=yr[Ve],Ye=Ve==="aperture"?.1:Ve==="wavelengthUm"?.02:.2;Ie[Tt]=Ie[Tt]+Ye*pt*lr()}return Ie},Et=(F,Oe,Ie,Tt)=>{const Ve=F.map(pt=>1/(1+.5*pt*pt));return pt=>{const Ye=rr(pt,Ie,Tt,ie);let Wt=0;for(let Kt=0;Kt<F.length;Kt++){const Pn=Oe[Kt],Xr=ye(F[Kt],Ye)-Pn;Wt+=Ve[Kt]*Xr*Xr}const Qr=1e-4*((ie.olpfSeparationPx?0:Ye.olpfSeparationPx*Ye.olpfSeparationPx)+(ie.coreSigmaPx?0:Ye.coreSigmaPx*Ye.coreSigmaPx)+(ie.haloSigmaPx?0:Ye.haloSigmaPx*Ye.haloSigmaPx)+(ie.rolloff?0:(Ye.rolloff-1)*(Ye.rolloff-1)));return Wt+Qr}},_e=(F,Oe,Ie,Tt=320)=>{const Ve=Oe.length,pt=new Array(Ve+1);pt[0]=[...Oe];for(let cr=0;cr<Ve;cr++){const nr=[...Oe];nr[cr]=nr[cr]+Ie[cr],pt[cr+1]=nr}const Ye=pt.map(cr=>F(cr)),Wt=()=>{const cr=Ye.map((qe,hr)=>[qe,hr]).sort((qe,hr)=>qe[0]-hr[0]).map(qe=>qe[1]),nr=cr.map(qe=>pt[qe]),Ar=cr.map(qe=>Ye[qe]);for(let qe=0;qe<pt.length;qe++)pt[qe]=nr[qe];for(let qe=0;qe<Ye.length;qe++)Ye[qe]=Ar[qe]},Ir=()=>{const cr=new Array(Ve).fill(0);for(let nr=0;nr<Ve;nr++){const Ar=pt[nr];for(let qe=0;qe<Ve;qe++)cr[qe]+=Ar[qe]}for(let nr=0;nr<Ve;nr++)cr[nr]/=Ve;return cr},Qr=(cr,nr,Ar=1)=>cr.map((qe,hr)=>qe+Ar*nr[hr]),Kt=(cr,nr)=>cr.map((Ar,qe)=>Ar-nr[qe]),Pn=1,qr=2,Xr=.5;for(let cr=0;cr<Tt;cr++){Wt();const nr=pt[0],Ar=pt[Ve],qe=Ir(),hr=Qr(qe,Kt(qe,Ar),Pn),fn=F(hr);if(fn<Ye[0]){const Tn=Qr(qe,Kt(hr,qe),qr),Oi=F(Tn);Oi<fn?(pt[Ve]=Tn,Ye[Ve]=Oi):(pt[Ve]=hr,Ye[Ve]=fn);continue}if(fn<Ye[Ve-1]){pt[Ve]=hr,Ye[Ve]=fn;continue}const Ln=Qr(qe,Kt(Ar,qe),-.5),Zn=F(Ln);if(Zn<Ye[Ve]){pt[Ve]=Ln,Ye[Ve]=Zn;continue}for(let Tn=1;Tn<Ve+1;Tn++)pt[Tn]=Qr(nr,Kt(pt[Tn],nr),Xr),Ye[Tn]=F(pt[Tn])}return Wt(),{x:pt[0],fx:Ye[0]}},fr=async()=>{if(!(Se!=null&&Se.freqs)||!(Se!=null&&Se.mtf)||Se.freqs.length<10){ke("No enough MTF data to fit.");return}const F=et();if(F.length===0){ke("All parameters are locked.");return}const Oe=Math.max(0,parseFloat(ee||"0")||0),Ie=jt,Tt=(()=>{const qe=parseFloat(fe||"");return Number.isFinite(qe)&&qe>0?qe:Ie})(),Ve=[];for(let qe=0;qe<Se.freqs.length;qe++){const hr=Se.freqs[qe],fn=Se.mtf[qe];hr>=Oe&&hr<=Tt&&Number.isFinite(fn)&&Ve.push([hr,fn])}if(Ve.length<10){ke("Fit range too narrow (need >= 10 points).");return}const Ye=Math.max(1,Math.floor(Ve.length/300)),Wt=Ve.filter((qe,hr)=>hr%Ye===0).map(qe=>qe[0]),Ir=Ve.filter((qe,hr)=>hr%Ye===0).map(qe=>qe[1]);Ne(!0),ke(`Fitting ${F.length} params (${Wt.length} pts) in [${Oe.toFixed(3)}, ${Tt.toFixed(3)}] ${or} ...`);const Qr=q,Kt=tr(Qr,F),Pn=F.map(qe=>yr[qe]),qr=Et(Wt,Ir,Qr,F),Xr=7;let cr=Kt,nr=qr(Kt);for(let qe=0;qe<Xr;qe++){const hr=qe===0?Kt:Dt(Kt,F),fn=_e(qr,hr,Pn,320);fn.fx<nr&&(nr=fn.fx,cr=fn.x),await new Promise(requestAnimationFrame)}const Ar=rr(cr,Qr,F,ie);te(Ar),ke(`Fit done. SSE=${nr.toExponential(3)}  unlocked=${F.length}  range=[${Oe.toFixed(3)}, ${Tt.toFixed(3)}] ${or}`),Ne(!1)};return c.jsxs("div",{className:`fixed flex flex-col bg-white dark:bg-slate-900 border border-gray-200 dark:border-slate-700 shadow-2xl overflow-hidden ${zt?"rounded-none":"rounded-xl"}`,style:zt?{inset:0,width:"100vw",height:"100vh",zIndex:a??100}:{left:Re.x,top:Re.y,width:Qe.w,height:pr?"auto":Qe.h,zIndex:a??100},onMouseDownCapture:i,children:[c.jsxs("div",{className:`flex justify-between items-center px-4 py-2 border-b border-gray-200 dark:border-slate-700 bg-gray-50 dark:bg-slate-800 select-none ${!zt&&Xe?"cursor-grabbing":zt?"":"cursor-grab"}`,onMouseDown:tt,onDoubleClick:()=>Tr(!zt),children:[c.jsxs("h3",{className:"text-sm font-bold text-orange-600 dark:text-orange-400 flex items-center gap-2 pointer-events-none",children:["SFR Expert (Adaptive Edge Method)",c.jsxs("span",{className:"text-xs bg-orange-100 dark:bg-orange-900/30 text-orange-700 dark:text-orange-300 px-2 py-0.5 rounded border border-orange-200 dark:border-orange-800",children:[l.length," ROI",l.length!==1?"s":""]})]}),c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx("button",{onClick:()=>Tr(!zt),className:"text-gray-400 hover:text-orange-500 transition-colors",title:zt?"Restore":"Maximize",children:zt?c.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 14h6v6M20 10h-6V4"})}):c.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 8V4m0 0h4M20 8V4m0 0h-4M4 16v4m0 0h4M20 16v4m0 0h-4"})})}),c.jsx("button",{onClick:()=>ir(!pr),className:"text-gray-400 hover:text-orange-500 transition-colors",children:c.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M20 12H4"})})})]})]}),!pr&&c.jsxs(c.Fragment,{children:[c.jsxs("div",{className:"p-3 bg-gray-50/50 dark:bg-slate-800/30 border-b border-gray-200 dark:border-slate-700 flex items-center gap-4 flex-wrap text-xs flex-shrink-0",children:[c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx("span",{className:"font-bold text-gray-500 dark:text-slate-400",children:"Pixel Pitch (m):"}),c.jsx("input",{type:"number",value:d,onMouseDown:F=>F.stopPropagation(),onClick:F=>F.stopPropagation(),onChange:F=>f(F.target.value),placeholder:"Default (cy/px)",className:"w-20 px-2 py-1 bg-white dark:bg-slate-900 border border-gray-300 dark:border-slate-600 rounded outline-none focus:border-orange-500"})]}),c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx("span",{className:"font-bold text-gray-500 dark:text-slate-400",children:"Image Height:"}),c.jsx("input",{type:"number",value:h,onMouseDown:F=>F.stopPropagation(),onClick:F=>F.stopPropagation(),onChange:F=>g(F.target.value),placeholder:"px",className:"w-16 px-2 py-1 bg-white dark:bg-slate-900 border border-gray-300 dark:border-slate-600 rounded outline-none focus:border-orange-500"})]}),c.jsxs("div",{className:"flex items-center gap-2 bg-blue-50 dark:bg-blue-900/20 px-2 py-1 rounded border border-blue-100 dark:border-blue-800",children:[c.jsx("span",{className:"font-bold text-blue-600 dark:text-blue-400",children:"Bin:"}),lt?c.jsxs("span",{className:"font-mono text-gray-700 dark:text-gray-300",children:[lt.toFixed(3),"px",c.jsxs("span",{className:"text-[10px] ml-1 text-gray-500",children:["(",Nt,"x)"]})]}):c.jsx("span",{className:"text-gray-400 italic",children:"..."}),c.jsxs("label",{className:"flex items-center gap-1 cursor-pointer select-none ml-2 border-l border-blue-200 dark:border-blue-700 pl-2",onMouseDown:F=>F.stopPropagation(),onClick:F=>F.stopPropagation(),children:[c.jsx("input",{type:"checkbox",checked:I,onChange:F=>{F.stopPropagation(),G(F.target.checked)},className:"w-3 h-3 text-blue-600 rounded focus:ring-blue-500 border-gray-300"}),c.jsx("span",{className:"text-[10px] font-bold text-blue-600 dark:text-blue-400",children:"Manual"})]}),I&&c.jsx("input",{type:"number",value:U,onMouseDown:F=>F.stopPropagation(),onClick:F=>F.stopPropagation(),onChange:F=>X(F.target.value),step:"0.001",min:"0.01",max:"0.5",className:"w-16 px-1 py-0.5 text-xs bg-white dark:bg-slate-900 border border-blue-300 dark:border-blue-600 rounded outline-none focus:border-orange-500",placeholder:"0.125"})]}),c.jsxs("div",{className:"flex items-center gap-4 flex-1 min-w-[500px] border-l border-gray-300 dark:border-slate-600 pl-3",children:[c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsxs("label",{className:"flex items-center gap-1 cursor-pointer select-none",title:"Linear detrending with limited fitting width",onMouseDown:F=>F.stopPropagation(),onClick:F=>F.stopPropagation(),children:[c.jsx("input",{type:"checkbox",checked:y,onChange:F=>{F.stopPropagation(),_(F.target.checked)},className:"w-4 h-4 text-purple-600 rounded focus:ring-purple-500 border-gray-300"}),c.jsx("span",{className:"font-bold text-purple-600 dark:text-purple-400",children:"Deshading"})]}),y&&c.jsxs(c.Fragment,{children:[c.jsxs("label",{className:"flex items-center gap-1 cursor-pointer select-none border-l border-purple-200 dark:border-purple-800 pl-2",onMouseDown:F=>F.stopPropagation(),onClick:F=>F.stopPropagation(),children:[c.jsx("input",{type:"checkbox",checked:$,onChange:F=>{F.stopPropagation(),B(F.target.checked)},className:"w-3 h-3 text-purple-600 rounded focus:ring-purple-500 border-gray-300"}),c.jsx("span",{className:"text-[10px] font-bold text-purple-600 dark:text-purple-400",children:"Limit Fit"})]}),$&&c.jsxs("div",{className:"flex items-center gap-1",title:"Width of data used for fitting (pixels)",children:[c.jsx("input",{type:"number",value:J,onMouseDown:F=>F.stopPropagation(),onClick:F=>F.stopPropagation(),onChange:F=>W(F.target.value),step:"5",min:"10",max:"500",className:"w-14 px-1 py-0.5 text-xs bg-white dark:bg-slate-900 border border-purple-300 dark:border-purple-600 rounded outline-none focus:border-orange-500"}),c.jsx("span",{className:"text-[10px] text-gray-500",children:"px"})]})]})]}),c.jsxs("label",{className:"flex items-center gap-1 cursor-pointer select-none",onMouseDown:F=>F.stopPropagation(),onClick:F=>F.stopPropagation(),children:[c.jsx("input",{type:"checkbox",checked:j,onChange:F=>{F.stopPropagation(),S(F.target.checked)},className:"w-4 h-4 text-emerald-600 rounded focus:ring-emerald-500 border-gray-300"}),c.jsx("span",{className:"font-bold text-emerald-600 dark:text-emerald-400",children:"G-Only"})]}),c.jsxs("label",{className:"flex items-center gap-1 cursor-pointer select-none",onMouseDown:F=>F.stopPropagation(),onClick:F=>F.stopPropagation(),title:"Apply Hann windowing before FFT",children:[c.jsx("input",{type:"checkbox",checked:k,onChange:F=>{F.stopPropagation(),M(F.target.checked)},className:"w-4 h-4 text-amber-600 rounded focus:ring-amber-500 border-gray-300"}),c.jsx("span",{className:"font-bold text-amber-600 dark:text-amber-400",children:"Hann On"})]}),c.jsxs("label",{className:"flex items-center gap-1 cursor-pointer select-none",onMouseDown:F=>F.stopPropagation(),onClick:F=>F.stopPropagation(),children:[c.jsx("input",{type:"checkbox",checked:N,onChange:F=>{F.stopPropagation(),T(F.target.checked)},className:"w-4 h-4 text-blue-600 rounded focus:ring-blue-500 border-gray-300"}),c.jsx("span",{className:"font-bold text-blue-600 dark:text-blue-400",children:"2 Freq"})]}),c.jsxs("label",{className:"flex items-center gap-1 cursor-pointer select-none",onMouseDown:F=>F.stopPropagation(),onClick:F=>F.stopPropagation(),children:[c.jsx("input",{type:"checkbox",checked:A,onChange:F=>{F.stopPropagation(),D(F.target.checked)},className:"w-4 h-4 text-teal-600 rounded focus:ring-teal-500 border-gray-300"}),c.jsx("span",{className:"font-bold text-teal-600 dark:text-teal-400",children:"Show PTF"})]}),c.jsxs("label",{className:"flex items-center gap-1 cursor-pointer select-none",onMouseDown:F=>F.stopPropagation(),onClick:F=>F.stopPropagation(),children:[c.jsx("input",{type:"checkbox",checked:b,onChange:F=>{F.stopPropagation();const Oe=F.target.checked;x(Oe),Oe||w(wr)},className:"w-4 h-4 text-orange-600 rounded focus:ring-orange-500 border-gray-300"}),c.jsx("span",{className:"font-bold text-gray-600 dark:text-slate-300",children:"Jiang's official NR"})]}),c.jsxs("div",{className:"flex-1 flex flex-col justify-center",children:[c.jsxs("div",{className:"flex justify-between items-baseline",children:[c.jsx("span",{className:"font-bold text-gray-500 dark:text-slate-400",children:b?"Calculated:":"Manual:"}),c.jsxs("span",{className:`font-mono font-bold ${b?"text-green-600 dark:text-green-400":"text-gray-700 dark:text-gray-300"}`,children:[b&&(Se!=null&&Se.calcRadius)?Se.calcRadius.toFixed(2):v.toFixed(1)," px"]})]}),c.jsx("input",{type:"range",min:"2",max:wr,step:"0.5",value:v,onMouseDown:F=>F.stopPropagation(),onChange:F=>{w(parseFloat(F.target.value)),x(!1)},disabled:b,className:`w-full h-1.5 rounded-lg appearance-none cursor-pointer ${b?"bg-gray-200 dark:bg-slate-800":"bg-gray-300 dark:bg-slate-600 accent-orange-500"}`})]})]}),c.jsxs("div",{className:"flex gap-2",children:[c.jsx("button",{onMouseDown:F=>F.stopPropagation(),onClick:F=>{F.stopPropagation(),ze()},disabled:!_r,title:_r?"":"Scalar Unmixing must be active. Run Unmixing in Sidebar first.",className:`px-3 py-1.5 text-white font-bold rounded shadow-sm transition-transform active:scale-95 ${_r?"bg-orange-600 hover:bg-orange-500":"bg-gray-400 cursor-not-allowed"}`,children:_r?"Add Current ROI":"Unmixing Required"}),c.jsx("button",{onMouseDown:F=>F.stopPropagation(),onClick:F=>{F.stopPropagation(),Ct()},disabled:!Se||!Se.mtf50||!n,className:"px-3 py-1.5 bg-cyan-600 hover:bg-cyan-500 disabled:bg-gray-300 disabled:text-gray-500 text-white font-bold rounded shadow-sm transition-transform active:scale-95",children:"Copy Pos/MTF50"}),c.jsx("button",{onMouseDown:F=>F.stopPropagation(),onClick:F=>{F.stopPropagation(),ct()},disabled:!Se,className:"px-3 py-1.5 bg-indigo-600 hover:bg-indigo-500 disabled:bg-gray-300 disabled:text-gray-500 text-white font-bold rounded shadow-sm transition-transform active:scale-95",children:"Export CSV"}),c.jsx("button",{onMouseDown:F=>F.stopPropagation(),onClick:F=>{F.stopPropagation(),ot()},className:"px-3 py-1.5 bg-gray-200 hover:bg-gray-300 dark:bg-slate-700 dark:hover:bg-slate-600 text-gray-600 dark:text-slate-300 font-bold rounded transition-colors",children:"Clear"})]})]}),c.jsxs("div",{className:"px-3 py-2 bg-indigo-50 dark:bg-indigo-900/20 border-b border-indigo-200 dark:border-indigo-800 flex items-center gap-4 flex-wrap text-xs",children:[c.jsxs("label",{className:"flex items-center gap-2 cursor-pointer select-none",onMouseDown:F=>F.stopPropagation(),onClick:F=>F.stopPropagation(),children:[c.jsx("input",{type:"checkbox",checked:V,onChange:F=>{F.stopPropagation(),z(F.target.checked)},className:"w-4 h-4 text-indigo-600 rounded focus:ring-indigo-500 border-gray-300"}),c.jsx("span",{className:"font-bold text-indigo-700 dark:text-indigo-400 text-sm",children:"Show Model Line"})]}),c.jsxs("div",{className:"flex items-center gap-2",title:"F-number (Aperture)",children:[c.jsx(Ds,{locked:ie.aperture,onToggle:()=>he(F=>({...F,aperture:!F.aperture}))}),c.jsx("span",{className:"font-bold text-gray-600 dark:text-slate-300",children:"F/"}),c.jsx("input",{type:"number",value:q.aperture,step:"0.05",min:"0.7",max:"64",onMouseDown:F=>F.stopPropagation(),onClick:F=>F.stopPropagation(),onChange:F=>{const Oe=parseFloat(F.target.value);Number.isFinite(Oe)&&te(Ie=>({...Ie,aperture:Oe}))},className:"w-20 px-1 py-0.5 bg-white dark:bg-slate-900 border border-indigo-300 dark:border-indigo-600 rounded text-xs"})]}),c.jsxs("div",{className:"flex items-center gap-2",title:"OLPF two-image split separation d (px)",children:[c.jsx(Ds,{locked:ie.olpfSeparationPx,onToggle:()=>he(F=>({...F,olpfSeparationPx:!F.olpfSeparationPx}))}),c.jsx("span",{className:"font-bold text-gray-600 dark:text-slate-300",children:"OLPF d:"}),c.jsx("input",{type:"number",value:q.olpfSeparationPx,step:"0.01",min:"0",max:"5",onMouseDown:F=>F.stopPropagation(),onClick:F=>F.stopPropagation(),onChange:F=>{const Oe=parseFloat(F.target.value);Number.isFinite(Oe)&&te(Ie=>({...Ie,olpfSeparationPx:Oe}))},className:"w-20 px-1 py-0.5 bg-white dark:bg-slate-900 border border-indigo-300 dark:border-indigo-600 rounded text-xs"}),c.jsx("span",{className:"text-[10px] text-gray-500",children:"px"})]}),c.jsxs("div",{className:"flex items-center gap-2",title:"Pixel Fill Factor (0..1)",children:[c.jsx(Ds,{locked:ie.fillFactor,onToggle:()=>he(F=>({...F,fillFactor:!F.fillFactor}))}),c.jsx("span",{className:"font-bold text-gray-600 dark:text-slate-300",children:"Fill:"}),c.jsx("input",{type:"number",value:q.fillFactor,step:"0.01",min:"0",max:"1",onMouseDown:F=>F.stopPropagation(),onClick:F=>F.stopPropagation(),onChange:F=>{const Oe=parseFloat(F.target.value);Number.isFinite(Oe)&&te(Ie=>({...Ie,fillFactor:Oe}))},className:"w-20 px-1 py-0.5 bg-white dark:bg-slate-900 border border-indigo-300 dark:border-indigo-600 rounded text-xs"})]}),c.jsxs("div",{className:"flex items-center gap-2",title:"Spherical core sigma (px)",children:[c.jsx(Ds,{locked:ie.coreSigmaPx,onToggle:()=>he(F=>({...F,coreSigmaPx:!F.coreSigmaPx}))}),c.jsx("span",{className:"font-bold text-gray-600 dark:text-slate-300",children:"Core :"}),c.jsx("input",{type:"number",value:q.coreSigmaPx,step:"0.01",min:"0",max:"10",onMouseDown:F=>F.stopPropagation(),onClick:F=>F.stopPropagation(),onChange:F=>{const Oe=parseFloat(F.target.value);Number.isFinite(Oe)&&te(Ie=>({...Ie,coreSigmaPx:Oe}))},className:"w-20 px-1 py-0.5 bg-white dark:bg-slate-900 border border-indigo-300 dark:border-indigo-600 rounded text-xs"}),c.jsx("span",{className:"text-[10px] text-gray-500",children:"px"})]}),c.jsxs("div",{className:"flex items-center gap-2",title:"Spherical halo sigma (px)",children:[c.jsx(Ds,{locked:ie.haloSigmaPx,onToggle:()=>he(F=>({...F,haloSigmaPx:!F.haloSigmaPx}))}),c.jsx("span",{className:"font-bold text-gray-600 dark:text-slate-300",children:"Halo :"}),c.jsx("input",{type:"number",value:q.haloSigmaPx,step:"0.01",min:"0",max:"50",onMouseDown:F=>F.stopPropagation(),onClick:F=>F.stopPropagation(),onChange:F=>{const Oe=parseFloat(F.target.value);Number.isFinite(Oe)&&te(Ie=>({...Ie,haloSigmaPx:Oe}))},className:"w-20 px-1 py-0.5 bg-white dark:bg-slate-900 border border-indigo-300 dark:border-indigo-600 rounded text-xs"}),c.jsx("span",{className:"text-[10px] text-gray-500",children:"px"})]}),c.jsxs("div",{className:"flex items-center gap-2",title:"Halo weight 0..1",children:[c.jsx(Ds,{locked:ie.haloWeight,onToggle:()=>he(F=>({...F,haloWeight:!F.haloWeight}))}),c.jsx("span",{className:"font-bold text-gray-600 dark:text-slate-300",children:"Halo w:"}),c.jsx("input",{type:"number",value:q.haloWeight,step:"0.01",min:"0",max:"1",onMouseDown:F=>F.stopPropagation(),onClick:F=>F.stopPropagation(),onChange:F=>{const Oe=parseFloat(F.target.value);Number.isFinite(Oe)&&te(Ie=>({...Ie,haloWeight:Oe}))},className:"w-20 px-1 py-0.5 bg-white dark:bg-slate-900 border border-indigo-300 dark:border-indigo-600 rounded text-xs"})]}),c.jsxs("div",{className:"flex items-center gap-2",title:"Wavelength (m) for diffraction model",children:[c.jsx(Ds,{locked:ie.wavelengthUm,onToggle:()=>he(F=>({...F,wavelengthUm:!F.wavelengthUm}))}),c.jsx("span",{className:"font-bold text-gray-600 dark:text-slate-300",children:":"}),c.jsx("input",{type:"number",value:q.wavelengthUm,step:"0.01",min:"0.35",max:"0.75",onMouseDown:F=>F.stopPropagation(),onClick:F=>F.stopPropagation(),onChange:F=>{const Oe=parseFloat(F.target.value);Number.isFinite(Oe)&&te(Ie=>({...Ie,wavelengthUm:Oe}))},className:"w-20 px-1 py-0.5 bg-white dark:bg-slate-900 border border-indigo-300 dark:border-indigo-600 rounded text-xs"}),c.jsx("span",{className:"text-[10px] text-gray-500",children:"m"})]}),c.jsxs("div",{className:"flex items-center gap-2",title:"Manual rolloff exponent",children:[c.jsx(Ds,{locked:ie.rolloff,onToggle:()=>he(F=>({...F,rolloff:!F.rolloff}))}),c.jsx("span",{className:"font-bold text-gray-600 dark:text-slate-300",children:"Rolloff:"}),c.jsx("input",{type:"number",value:q.rolloff,step:"0.01",min:"0.1",max:"10",onMouseDown:F=>F.stopPropagation(),onClick:F=>F.stopPropagation(),onChange:F=>{const Oe=parseFloat(F.target.value);Number.isFinite(Oe)&&te(Ie=>({...Ie,rolloff:Oe}))},className:"w-20 px-1 py-0.5 bg-white dark:bg-slate-900 border border-indigo-300 dark:border-indigo-600 rounded text-xs"})]}),c.jsxs("div",{className:"flex items-center gap-2 ml-2",children:[c.jsx("span",{className:"font-bold text-gray-600 dark:text-slate-300",children:"Fit:"}),c.jsx("input",{type:"number",value:ee,step:"0.001",min:"0",onMouseDown:F=>F.stopPropagation(),onClick:F=>F.stopPropagation(),onChange:F=>Le(F.target.value),className:"w-20 px-1 py-0.5 bg-white dark:bg-slate-900 border border-indigo-300 dark:border-indigo-600 rounded text-xs",title:`Fit range min (${or})`}),c.jsx("span",{className:"text-[10px] text-gray-500",children:"to"}),c.jsx("input",{type:"number",value:fe,step:"0.001",min:"0",onMouseDown:F=>F.stopPropagation(),onClick:F=>F.stopPropagation(),onChange:F=>ce(F.target.value),className:"w-20 px-1 py-0.5 bg-white dark:bg-slate-900 border border-indigo-300 dark:border-indigo-600 rounded text-xs",placeholder:`${jt.toFixed(2)}`,title:`Fit range max (${or}), blank = current max`}),c.jsx("button",{onMouseDown:F=>F.stopPropagation(),onClick:F=>{F.stopPropagation(),de||fr()},disabled:de||!Se,className:`px-2 py-1 rounded font-bold text-white text-xs transition-transform active:scale-95 ${de?"bg-gray-400":"bg-indigo-600 hover:bg-indigo-500"}`,title:"Auto fit UNLOCKED params to measured MTF in the given frequency range",children:de?"Fitting":"Auto Fit"})]}),c.jsx("span",{className:"text-[10px] text-gray-500 dark:text-slate-400 italic ml-2",children:"Dot filled = locked. Auto Fit only changes unlocked params."}),pe&&c.jsx("span",{className:"text-[10px] text-gray-500 dark:text-slate-400 italic ml-2",children:pe})]}),c.jsxs("div",{className:"flex-1 p-4 overflow-hidden flex flex-col gap-4 bg-white dark:bg-slate-950",children:[c.jsxs("div",{className:"h-[35%] min-h-[180px] flex gap-4",children:[c.jsxs("div",{className:"flex-1 bg-gray-50 dark:bg-slate-900/50 border border-gray-200 dark:border-slate-800 rounded-xl p-2 relative flex flex-col",children:[c.jsx("h4",{className:"text-[10px] font-bold text-gray-500 dark:text-slate-400 absolute top-2 left-3 z-10 bg-white/80 dark:bg-slate-900/80 px-1 rounded",children:"ESF"}),c.jsx("div",{className:"flex-1 min-h-0 w-full",children:c.jsx(Oo,{width:"100%",height:"100%",children:c.jsxs(Kl,{data:Me,children:[c.jsx(mo,{strokeDasharray:"3 3",stroke:"#374151",opacity:.1}),c.jsx(Ka,{dataKey:"x",hide:!0}),c.jsx(Ya,{hide:!0,domain:["auto","auto"]}),c.jsx(aa,{contentStyle:{fontSize:"10px"}}),c.jsx(ia,{type:"monotone",dataKey:"y",stroke:"#3b82f6",strokeWidth:1,dot:!1,isAnimationActive:!1})]})})})]}),c.jsxs("div",{className:"flex-1 bg-gray-50 dark:bg-slate-900/50 border border-gray-200 dark:border-slate-800 rounded-xl p-2 relative flex flex-col",children:[c.jsxs("div",{className:"absolute top-2 left-3 z-10 flex items-center gap-3",children:[c.jsxs("h4",{className:"text-[10px] font-bold text-gray-500 dark:text-slate-400 bg-white/80 dark:bg-slate-900/80 px-1 rounded",children:["LSF ",me>1?`(x${me.toFixed(0)})`:""]}),c.jsxs("div",{className:"flex items-center gap-1 bg-white/80 dark:bg-slate-900/80 px-1 rounded border border-gray-200 dark:border-slate-700",children:[c.jsx("span",{className:"text-[9px] text-gray-400 font-bold",children:"Zoom"}),c.jsx("input",{type:"range",min:"1",max:"50",step:"1",value:me,onMouseDown:F=>F.stopPropagation(),onChange:F=>Be(parseFloat(F.target.value)),className:"w-16 h-1 bg-gray-300 dark:bg-slate-600 rounded-lg appearance-none cursor-pointer accent-red-500"})]})]}),c.jsx("div",{className:"flex-1 min-h-0 w-full",children:c.jsx(Oo,{width:"100%",height:"100%",children:c.jsxs(Kl,{data:Fr,children:[c.jsx(mo,{strokeDasharray:"3 3",stroke:"#374151",opacity:.1}),c.jsx(tl,{y:0,stroke:"#9ca3af",strokeOpacity:.5,strokeDasharray:"3 3"}),c.jsx(Ka,{dataKey:"x",hide:!0}),c.jsx(Ya,{hide:!1,width:30,tick:{fontSize:9,fill:"#888"},domain:[F=>F,F=>F/me],allowDataOverflow:!0,tickFormatter:F=>F.toFixed(3)}),c.jsx(aa,{contentStyle:{fontSize:"10px"},formatter:F=>[F.toFixed(5),"Amplitude"]}),c.jsx(ia,{type:"monotone",dataKey:"y",stroke:"#ef4444",strokeWidth:2,dot:!1,isAnimationActive:!1})]})})})]})]}),c.jsxs("div",{className:"flex-1 flex gap-4 min-h-[250px]",children:[c.jsxs("div",{className:"flex-1 bg-white dark:bg-slate-900 border border-gray-200 dark:border-slate-800 rounded-xl p-2 relative flex flex-col",children:[c.jsxs("div",{className:"flex justify-between items-start px-2 mb-1",children:[c.jsx("h4",{className:"text-xs font-bold text-gray-500 dark:text-slate-400 uppercase",children:"MTF"}),c.jsxs("div",{className:"flex gap-4 items-center",children:[(Se==null?void 0:Se.mtf50)&&c.jsxs("div",{className:"text-sm font-bold text-gray-600 dark:text-slate-300",children:["MTF50 = ",c.jsxs("span",{className:"text-orange-600 dark:text-orange-400",children:[Se.mtf50.toFixed(2)," ",or]})]}),gr!==null&&c.jsxs("div",{className:"text-lg font-bold text-white bg-orange-500 px-3 py-0.5 rounded shadow-lg animate-in fade-in",children:[Math.round(gr)," LW/PH"]})]})]}),c.jsxs("div",{className:"flex-1 relative min-h-0 w-full",children:[c.jsx("div",{className:"absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 pointer-events-none select-none opacity-10",children:c.jsx("svg",{viewBox:"0 0 400 60",className:"w-[30rem] h-auto",children:c.jsx("text",{x:"50%",y:"50%",dominantBaseline:"middle",textAnchor:"middle",className:"fill-gray-900 dark:fill-white",fontSize:"24",fontWeight:"bold",children:" y-g-jiang.github.io"})})}),c.jsx(Oo,{width:"100%",height:"100%",children:c.jsxs(Kl,{data:sr,margin:{top:10,right:30,left:10,bottom:20},children:[c.jsx(mo,{strokeDasharray:"3 3",stroke:"#374151",opacity:.15}),c.jsx(Ka,{dataKey:"freq",type:"number",domain:[0,jt],tick:{fontSize:10,fill:"#9ca3af"},label:{value:`Frequency (${or})`,position:"insideBottom",offset:-10,fontSize:11,fill:"#9ca3af"}}),c.jsx(Ya,{domain:[0,1.1],tick:{fontSize:10,fill:"#9ca3af"},label:{value:"MTF",angle:-90,position:"insideLeft",fontSize:11,fill:"#9ca3af"}}),c.jsx(aa,{contentStyle:{backgroundColor:"rgba(15, 23, 42, 0.9)",border:"none",color:"#fff",fontSize:"11px",borderRadius:"4px"},labelFormatter:F=>`Freq: ${Number(F).toFixed(3)} ${or}`,formatter:(F,Oe)=>Oe==="Model"?[F==null?void 0:F.toFixed(4),"Model"]:[F==null?void 0:F.toFixed(4),"Measured"]}),c.jsx(Do,{verticalAlign:"top",height:20}),c.jsx(ia,{type:"monotone",dataKey:"mtf",name:"Measured",stroke:"#000000",strokeWidth:2,className:"dark:stroke-white",dot:!1,isAnimationActive:!1,connectNulls:!1}),V&&c.jsx(ia,{type:"monotone",dataKey:"modelMtf",name:"Model",stroke:"#0066cc",strokeWidth:2,strokeDasharray:"5 5",dot:!1,isAnimationActive:!1,connectNulls:!0}),(Se==null?void 0:Se.mtf50)&&c.jsx(G0,{x:Se.mtf50,y:.5,r:4,fill:"#f97316",stroke:"none",children:c.jsx(Sa,{value:"MTF50",position:"top",fill:"#f97316",fontSize:10,fontWeight:"bold"})})]})})]})]}),A&&c.jsxs("div",{className:"flex-1 bg-white dark:bg-slate-900 border border-gray-200 dark:border-slate-800 rounded-xl p-2 relative flex flex-col",children:[c.jsx("div",{className:"flex justify-between items-start px-2 mb-1",children:c.jsx("h4",{className:"text-xs font-bold text-teal-600 dark:text-teal-400 uppercase",children:"PTF / Phase"})}),c.jsx("div",{className:"flex-1 relative min-h-0 w-full",children:c.jsx(Oo,{width:"100%",height:"100%",children:c.jsxs(Kl,{data:ut,margin:{top:10,right:30,left:10,bottom:20},children:[c.jsx(mo,{strokeDasharray:"3 3",stroke:"#374151",opacity:.15}),c.jsx(Ka,{dataKey:"freq",type:"number",domain:[0,jt],tick:{fontSize:10,fill:"#9ca3af"},label:{value:`Frequency (${or})`,position:"insideBottom",offset:-10,fontSize:11,fill:"#9ca3af"}}),c.jsx(Ya,{tick:{fontSize:10,fill:"#9ca3af"},label:{value:"Phase (Rad)",angle:-90,position:"insideLeft",fontSize:11,fill:"#9ca3af"}}),c.jsx(aa,{contentStyle:{backgroundColor:"rgba(15, 23, 42, 0.9)",border:"none",color:"#fff",fontSize:"11px",borderRadius:"4px"},labelFormatter:F=>`Freq: ${Number(F).toFixed(3)} ${or}`,formatter:F=>[F==null?void 0:F.toFixed(4),"Phase (Rad)"]}),c.jsx(ia,{type:"monotone",dataKey:"ptf",name:"Phase",stroke:"#0d9488",strokeWidth:2,dot:!1,isAnimationActive:!1})]})})})]})]})]})]}),!zt&&c.jsx("div",{className:"absolute bottom-0 right-0 w-4 h-4 cursor-nwse-resize z-50 bg-gray-300 dark:bg-slate-600 rounded-tl hover:bg-orange-500 transition-colors",onMouseDown:Hr})]})},coe=`
import struct
import numpy as np

class Type:
    Short = (3,2); Long = (4,4); Rational = (5,8); Ascii = (2,1); Byte = (1,1)
    Undefined = (7,1); Srational = (10,8); IFD = (13,4)

class Tag:
    NewSubfileType = (254, Type.Long); ImageWidth = (256, Type.Long); ImageLength = (257, Type.Long)
    BitsPerSample = (258, Type.Short); Compression = (259, Type.Short)
    PhotometricInterpretation = (262, Type.Short); Make = (271, Type.Ascii); Model = (272, Type.Ascii)
    StripOffsets = (273, Type.Long); Orientation = (274, Type.Short); SamplesPerPixel = (277, Type.Short)
    RowsPerStrip = (278, Type.Short); StripByteCounts = (279, Type.Long)
    CFARepeatPatternDim = (33421, Type.Short); CFAPattern = (33422, Type.Byte)
    DNGVersion = (50706, Type.Byte); UniqueCameraModel = (50708, Type.Ascii)
    BlackLevel = (50714, Type.Short); WhiteLevel = (50717, Type.Short)
    ColorMatrix1 = (50721, Type.Srational); CalibrationIlluminant1 = (50778, Type.Short)
    BlackLevelRepeatDim = (50713, Type.Short)

class Compression: Uncompressed = 1
class PhotometricInterpretation: Color_Filter_Array = 32803
class CFAPattern: BGGR=[2,1,1,0]; GBRG=[1,2,0,1]; GRBG=[1,0,2,1]; RGGB=[0,1,1,2]

class dngTag(object):
    def __init__(self, tagType, value=[]):
        self.TagId = tagType[0]
        self.DataType = tagType[1]
        self.DataCount = len(value) if not isinstance(value, str) else len(value) + 1
        self.Value = self._pack_value(tagType[1], value)
        self.DataLength = len(self.Value)
        self.selfContained = (self.DataLength <= 4)
        self.DataOffset = 0

    def _pack_value(self, dtype, value):
        tid = dtype[0]
        if tid == 1: return struct.pack('<%sB' % len(value), *value)
        elif tid == 3: return struct.pack('<%sH' % len(value), *value)
        elif tid == 4: return struct.pack('<%sL' % len(value), *value)
        elif tid == 2: return struct.pack('<%ss' % len(value), value.encode("ascii")) + b'\\x00'
        elif tid == 5 or tid == 10: 
            flat = [item for sublist in value for item in sublist]
            fmt = 'L' if tid == 5 else 'l'
            return struct.pack('<%s%s' % (len(flat), fmt), *flat)
        return b''

    def write_directory(self, buf, offset):
        if self.selfContained:
            val = self.Value + b'\\x00' * (4 - len(self.Value))
            struct.pack_into("<HHI4s", buf, offset, self.TagId, self.DataType[0], self.DataCount, val)
        else:
            struct.pack_into("<HHII", buf, offset, self.TagId, self.DataType[0], self.DataCount, self.DataOffset)

    def write_data(self, buf):
        if not self.selfContained:
            struct.pack_into(f"<{len(self.Value)}s", buf, self.DataOffset, self.Value)

def convert_to_dng(raw_bytes, width, height, cfa_str, black_level_list, shift, linear_shift, cm_flat):
    # 1. Pixel Data Processing
    # Ensure raw_bytes is a bytes-like object
    raw_data = np.frombuffer(raw_bytes, dtype=np.uint16).copy()
    
    # Use int32 for calculations to prevent premature overflow and allow negative offsets
    raw_data = raw_data.astype(np.int32)

    # Apply Bit Shift (<<)
    if shift > 0:
        raw_data = raw_data * (1 << shift)
    
    # Apply Linear Offset (+)
    if linear_shift != 0:
        raw_data = raw_data + linear_shift

    # Clip to 16-bit range
    raw_data = np.clip(raw_data, 0, 65535).astype(np.uint16)

    # 2. Metadata Preparation
    white_level = 65019
    # Format Color Matrix for Srational (Value, Denominator)
    color_matrix = [[int(x * 10000), 10000] for x in cm_flat]

    cfa_map = {"BGGR": CFAPattern.BGGR, "GBRG": CFAPattern.GBRG, "GRBG": CFAPattern.GRBG, "RGGB": CFAPattern.RGGB}
    
    tags = [
        dngTag(Tag.NewSubfileType, [0]),
        dngTag(Tag.ImageWidth, [width]),
        dngTag(Tag.ImageLength, [height]),
        dngTag(Tag.BitsPerSample, [16]), 
        dngTag(Tag.Compression, [Compression.Uncompressed]),
        dngTag(Tag.PhotometricInterpretation, [PhotometricInterpretation.Color_Filter_Array]),
        dngTag(Tag.Make, "JO-Workstation"),
        dngTag(Tag.Model, "Manual-16bit"),
        dngTag(Tag.SamplesPerPixel, [1]),
        dngTag(Tag.RowsPerStrip, [height]), 
        dngTag(Tag.CFARepeatPatternDim, [2, 2]),
        dngTag(Tag.CFAPattern, cfa_map.get(cfa_str.upper(), CFAPattern.RGGB)),
        dngTag(Tag.BlackLevelRepeatDim, [2, 2]),
        dngTag(Tag.BlackLevel, [int(x) for x in black_level_list]),
        dngTag(Tag.WhiteLevel, [white_level]),
        dngTag(Tag.ColorMatrix1, color_matrix),
        dngTag(Tag.CalibrationIlluminant1, [21]),
        dngTag(Tag.DNGVersion, [1, 4, 0, 0]),
        dngTag(Tag.UniqueCameraModel, "Generic 16bit Raw")
    ]
    
    pixel_bytes = raw_data.tobytes()
    tags.append(dngTag(Tag.StripOffsets, [0])) 
    tags.append(dngTag(Tag.StripByteCounts, [len(pixel_bytes)]))
    tags.sort(key=lambda x: x.TagId)
    
    ifd_size = 2 + (len(tags) * 12) + 4
    current_data_offset = 8 + ifd_size
    
    for tag in tags:
        if not tag.selfContained:
            tag.DataOffset = current_data_offset
            current_data_offset = (current_data_offset + tag.DataLength + 3) & 0xFFFFFFFC
            
    img_offset = current_data_offset
    for tag in tags:
        if tag.TagId == Tag.StripOffsets[0]:
            tag.Value = struct.pack('<L', img_offset)
            break
            
    buf = bytearray(img_offset + len(pixel_bytes))
    struct.pack_into("<ccbbI", buf, 0, b'I', b'I', 0x2A, 0x00, 8)
    struct.pack_into("<H", buf, 8, len(tags))
    
    offset = 10
    for tag in tags:
        tag.write_directory(buf, offset)
        offset += 12
        
    struct.pack_into("<I", buf, offset, 0)
    for tag in tags:
        tag.write_data(buf)
        
    buf[img_offset:img_offset+len(pixel_bytes)] = pixel_bytes
    return bytes(buf)
`,uoe=({isOpen:e,onClose:t,rawImageData:r,fileName:n,zIndex:a=200,onFocus:i})=>{const[o,s]=P.useState(!0),[l,u]=P.useState(!1),[d,f]=P.useState(""),h=P.useRef(null),g=P.useRef(null),[v,w]=P.useState(4),[b,x]=P.useState(0),[y,_]=P.useState(""),[j,S]=P.useState(""),[k,M]=P.useState("RGGB"),[N,T]=P.useState(!1),[A,D]=P.useState(100),[$,B]=P.useState(4e3),[J,W]=P.useState(0),[I,G]=P.useState(0),U=P.useMemo(()=>Object.keys(ju).sort(),[]);P.useEffect(()=>{e&&!h.current&&(async()=>{try{const q=await window.loadPyodide();await q.loadPackage("numpy"),await q.runPythonAsync(coe),h.current=q,s(!1)}catch(q){console.error("Pyodide Init Failed",q)}})()},[e]),P.useEffect(()=>{if(e&&r){const z=r.whiteLevel;z>1e4?w(2):z>3e3?w(4):z>6e4&&w(0);const q=r.bayerPattern?r.bayerPattern.toUpperCase():"RGGB";["RGGB","BGGR","GBRG","GRBG"].includes(q)?M(q):M("RGGB");const te=Math.min(r.width,r.height),ie=Math.max(48,Math.round(te/40));D(ie),W(Math.round(ie*10)),G(Math.round(r.height-ie*2))}},[e,r]);const X=async z=>{if(!z.target.files||z.target.files.length===0||!h.current)return;const q=Array.from(z.target.files);u(!0);const te=y.trim()?y.trim().split(/\s+/).map(Number):[0,0,0,0];for(te.length===1&&!isNaN(te[0])&&te.push(te[0],te[0],te[0]);te.length<4;)te.push(0);const ie=j.trim()?j.trim().split(/[\s,\n]+/).map(Number):[1,0,0,0,1,0,0,0,1];if(ie.length!==9){alert("Color Matrix must contain exactly 9 numeric values."),u(!1);return}const he=h.current;for(let ee=0;ee<q.length;ee++){const Le=q[ee];f(`Processing ${ee+1}/${q.length}: ${Le.name}`);try{const fe=await Le.arrayBuffer(),ce=await Pu(fe);let de;if(N){const Re=document.createElement("canvas");Re.width=ce.width,Re.height=ce.height;const it=Re.getContext("2d");if(it){it.fillStyle="black",it.fillRect(0,0,Re.width,Re.height),it.font=`bold ${A}px sans-serif`,it.fillStyle="white",it.textBaseline="middle",it.textAlign="center",it.fillText("(C)  y-g-jiang.github.io",J,I);const Qe=it.getImageData(0,0,Re.width,Re.height).data;de=new Uint16Array(ce.data);const se=de.length;for(let Xe=0;Xe<se;Xe++)if(Qe[Xe*4]>128){let ht=de[Xe]+$;ht<0&&(ht=0),ht>65535&&(ht=65535),de[Xe]=ht}}else de=new Uint16Array(ce.data)}else de=ce.data;he.globals.set("js_raw_bytes",new Uint8Array(de.buffer,de.byteOffset,de.byteLength)),he.globals.set("js_width",ce.width),he.globals.set("js_height",ce.height),he.globals.set("js_cfa",k),he.globals.set("js_bl_list",te),he.globals.set("js_shift",v),he.globals.set("js_linear_shift",b),he.globals.set("js_cm_flat",ie);const Ne=await he.runPythonAsync(`
                    convert_to_dng(
                        js_raw_bytes.to_py(), 
                        js_width, 
                        js_height, 
                        js_cfa, 
                        js_bl_list.to_py(), 
                        js_shift,
                        js_linear_shift,
                        js_cm_flat.to_py()
                    )
                `),pe=Ne.toJs();Ne.destroy();const ke=new Blob([pe],{type:"image/x-adobe-dng"}),me=URL.createObjectURL(ke),Be=document.createElement("a");Be.href=me;const Se=Le.name.substring(0,Le.name.lastIndexOf("."))||"image",we=N?"_wm":"";Be.download=`${Se}_16bit_manual${we}.dng`,document.body.appendChild(Be),Be.click(),document.body.removeChild(Be),URL.revokeObjectURL(me),await new Promise(Re=>setTimeout(Re,200))}catch(fe){console.error(`Failed to batch process ${Le.name}`,fe)}}u(!1),f(""),z.target.value=""},V=async()=>{if(!(!r||!h.current)){u(!0);try{const z=h.current,q=y.trim()?y.trim().split(/\s+/).map(Number):[0,0,0,0];if(q.length===1&&!isNaN(q[0])&&q.push(q[0],q[0],q[0]),q.length<4)for(;q.length<4;)q.push(0);const te=j.trim()?j.trim().split(/[\s,\n]+/).map(Number):[1,0,0,0,1,0,0,0,1];if(te.length!==9)throw new Error("Color Matrix must contain exactly 9 numeric values.");const ie=k;let he;if(N){const ke=document.createElement("canvas");ke.width=r.width,ke.height=r.height;const me=ke.getContext("2d");if(me){me.fillStyle="black",me.fillRect(0,0,ke.width,ke.height),me.font=`bold ${A}px sans-serif`,me.fillStyle="white",me.textBaseline="middle",me.textAlign="center",me.fillText("(C)  y-g-jiang.github.io",J,I);const Be=me.getImageData(0,0,ke.width,ke.height).data;he=new Uint16Array(r.data);const Se=he.length;for(let we=0;we<Se;we++)if(Be[we*4]>128){let Re=he[we]+$;Re<0&&(Re=0),Re>65535&&(Re=65535),he[we]=Re}}else he=new Uint16Array(r.data)}else he=r.data;z.globals.set("js_raw_bytes",new Uint8Array(he.buffer,he.byteOffset,he.byteLength)),z.globals.set("js_width",r.width),z.globals.set("js_height",r.height),z.globals.set("js_cfa",ie),z.globals.set("js_bl_list",q),z.globals.set("js_shift",v),z.globals.set("js_linear_shift",b),z.globals.set("js_cm_flat",te);const ee=await z.runPythonAsync(`
                convert_to_dng(
                    js_raw_bytes.to_py(), 
                    js_width, 
                    js_height, 
                    js_cfa, 
                    js_bl_list.to_py(), 
                    js_shift,
                    js_linear_shift,
                    js_cm_flat.to_py()
                )
            `),Le=ee.toJs();ee.destroy();const fe=new Blob([Le],{type:"image/x-adobe-dng"}),ce=URL.createObjectURL(fe),de=document.createElement("a");de.href=ce;const Ne=n.substring(0,n.lastIndexOf("."))||"image",pe=N?"_wm":"";de.download=`${Ne}_16bit_manual${pe}.dng`,document.body.appendChild(de),de.click(),document.body.removeChild(de),URL.revokeObjectURL(ce)}catch(z){console.error(z),alert("Export Failed: "+z.message)}finally{u(!1)}}};return e?c.jsxs(Cl,{initialPosition:{x:window.innerWidth/2-250,y:50},onClose:t,zIndex:a,onFocus:i,className:"w-[500px] bg-white dark:bg-black border-2 border-black dark:border-white shadow-2xl rounded-none flex flex-col font-mono max-h-[90vh] overflow-y-auto",children:[c.jsxs("div",{className:"flex justify-between items-center px-4 py-2 border-b-2 border-black dark:border-gray-500 bg-gray-200 dark:bg-gray-800",children:[c.jsx("h3",{className:"text-sm font-bold text-black dark:text-white uppercase tracking-widest",children:"16-bit DNG Workstation"}),c.jsx("button",{onClick:t,className:"text-black dark:text-white hover:text-red-600 transition-colors",children:c.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:3,d:"M6 18L18 6M6 6l12 12"})})})]}),c.jsx("div",{className:"p-6 flex flex-col gap-6",children:o?c.jsxs("div",{className:"flex flex-col items-center justify-center py-10 gap-4",children:[c.jsx("div",{className:"w-8 h-8 border-4 border-black dark:border-white border-t-transparent animate-spin"}),c.jsx("p",{className:"text-xs font-bold text-gray-500 animate-pulse"})]}):c.jsxs(c.Fragment,{children:[c.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[c.jsxs("div",{className:"flex flex-col gap-1",children:[c.jsx("label",{className:"text-[10px] font-bold text-gray-500 dark:text-gray-400 uppercase",children:"Width (Read Only)"}),c.jsx("input",{type:"text",readOnly:!0,value:(r==null?void 0:r.width)||0,className:"w-full bg-gray-100 dark:bg-gray-900 border border-black dark:border-gray-600 px-2 py-1 text-sm text-gray-400"})]}),c.jsxs("div",{className:"flex flex-col gap-1",children:[c.jsx("label",{className:"text-[10px] font-bold text-gray-500 dark:text-gray-400 uppercase",children:"Height (Read Only)"}),c.jsx("input",{type:"text",readOnly:!0,value:(r==null?void 0:r.height)||0,className:"w-full bg-gray-100 dark:bg-gray-900 border border-black dark:border-gray-600 px-2 py-1 text-sm text-gray-400"})]})]}),c.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[c.jsxs("div",{className:"col-span-1 flex flex-col gap-1",children:[c.jsx("label",{className:"text-[10px] font-bold text-cyan-600 dark:text-cyan-400 uppercase",children:"Bit Shift (<<)"}),c.jsx("input",{type:"number",value:v,onChange:z=>w(parseInt(z.target.value)||0),className:"w-full bg-white dark:bg-gray-800 border-2 border-black dark:border-gray-500 px-2 py-1 text-sm font-bold"})]}),c.jsxs("div",{className:"col-span-1 flex flex-col gap-1",children:[c.jsx("label",{className:"text-[10px] font-bold text-emerald-600 dark:text-emerald-400 uppercase",children:"Offset (+)"}),c.jsx("input",{type:"number",value:b,onChange:z=>x(parseInt(z.target.value)||0),className:"w-full bg-white dark:bg-gray-800 border-2 border-black dark:border-gray-500 px-2 py-1 text-sm font-bold"})]}),c.jsxs("div",{className:"col-span-1 flex flex-col gap-1",children:[c.jsx("label",{className:"text-[10px] font-bold text-gray-600 dark:text-gray-400 uppercase",children:"Pattern"}),c.jsxs("select",{value:k,onChange:z=>M(z.target.value),className:"w-full bg-white dark:bg-gray-800 border-2 border-black dark:border-gray-500 px-1 py-1 text-sm font-bold",children:[c.jsx("option",{value:"RGGB",children:"RGGB"}),c.jsx("option",{value:"BGGR",children:"BGGR"}),c.jsx("option",{value:"GBRG",children:"GBRG"}),c.jsx("option",{value:"GRBG",children:"GRBG"})]})]})]}),c.jsx("div",{className:"mt-[-10px] grid grid-cols-3 gap-4",children:c.jsx("div",{className:"text-[9px] text-gray-400 dark:text-gray-500 col-span-2",children:"Shift: 4=12bit(x16), 2=14bit(x4). Added after shift."})}),c.jsxs("div",{className:"flex flex-col gap-1",children:[c.jsx("label",{className:"text-[10px] font-bold text-indigo-600 dark:text-indigo-400 uppercase",children:"16bit Black Level (Manual Fill)"}),c.jsx("input",{type:"text",value:y,onChange:z=>_(z.target.value),placeholder:"R G1 B G2",className:"w-full bg-white dark:bg-gray-800 border-2 border-black dark:border-gray-500 px-2 py-1 text-sm font-bold font-mono placeholder:font-normal placeholder:text-gray-400"})]}),c.jsxs("div",{className:"flex flex-col gap-1",children:[c.jsxs("div",{className:"flex justify-between items-end",children:[c.jsx("label",{className:"text-[10px] font-bold text-gray-500 dark:text-gray-400 uppercase",children:"Color Matrix (XYZ to Raw - 9 Values)"}),c.jsxs("select",{className:"text-[10px] bg-gray-100 dark:bg-gray-800 border border-black dark:border-gray-500 rounded-none px-1 py-0.5 max-w-[180px] cursor-pointer",onChange:z=>{const q=ju[z.target.value];q&&S(q),z.target.value=""},defaultValue:"",children:[c.jsx("option",{value:"",disabled:!0,children:"Select Camera Preset..."}),U.map(z=>c.jsx("option",{value:z,children:z},z))]})]}),c.jsx("textarea",{value:j,onChange:z=>S(z.target.value),placeholder:"e.g. 0.94 -0.39 -0.07 -0.28 1.09 0.22 -0.01 0.09 0.57",className:"w-full h-20 bg-white dark:bg-gray-800 border-2 border-black dark:border-gray-500 px-2 py-1 text-xs font-mono resize-none placeholder:font-normal placeholder:text-gray-400"}),c.jsx("span",{className:"text-[8px] text-gray-400 mt-0.5",children:"Enter 9 numbers separated by space or comma."})]}),c.jsxs("div",{className:"border border-gray-300 dark:border-gray-700 bg-gray-50 dark:bg-gray-900 rounded p-3",children:[c.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[c.jsx("input",{type:"checkbox",id:"enableWatermark",checked:N,onChange:z=>T(z.target.checked),className:"rounded border-gray-300 text-indigo-600 focus:ring-indigo-500"}),c.jsx("label",{htmlFor:"enableWatermark",className:"text-xs font-bold text-gray-700 dark:text-gray-300 select-none",children:"Add Watermark: (C)  y-g-jiang.github.io"})]}),N&&c.jsxs("div",{className:"space-y-2 animate-in slide-in-from-top-1",children:[c.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[c.jsxs("div",{className:"flex flex-col gap-1",children:[c.jsx("label",{className:"text-[9px] font-bold text-gray-500 dark:text-gray-400 uppercase",children:"Size (px)"}),c.jsx("input",{type:"number",value:A,onChange:z=>D(Math.max(10,parseInt(z.target.value)||10)),className:"w-full bg-white dark:bg-gray-800 border border-gray-400 dark:border-gray-600 px-2 py-1 text-xs"})]}),c.jsxs("div",{className:"flex flex-col gap-1",children:[c.jsx("label",{className:"text-[9px] font-bold text-gray-500 dark:text-gray-400 uppercase",children:"Depth (Shift DN)"}),c.jsx("input",{type:"number",value:$,onChange:z=>B(parseInt(z.target.value)||0),className:"w-full bg-white dark:bg-gray-800 border border-gray-400 dark:border-gray-600 px-2 py-1 text-xs",placeholder:"+/- value"})]})]}),c.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[c.jsxs("div",{className:"flex flex-col gap-1",children:[c.jsx("label",{className:"text-[9px] font-bold text-gray-500 dark:text-gray-400 uppercase",children:"Center X"}),c.jsx("input",{type:"number",value:J,onChange:z=>W(parseInt(z.target.value)||0),className:"w-full bg-white dark:bg-gray-800 border border-gray-400 dark:border-gray-600 px-2 py-1 text-xs"})]}),c.jsxs("div",{className:"flex flex-col gap-1",children:[c.jsx("label",{className:"text-[9px] font-bold text-gray-500 dark:text-gray-400 uppercase",children:"Center Y"}),c.jsx("input",{type:"number",value:I,onChange:z=>G(parseInt(z.target.value)||0),className:"w-full bg-white dark:bg-gray-800 border border-gray-400 dark:border-gray-600 px-2 py-1 text-xs"})]})]})]})]}),c.jsxs("div",{className:"flex gap-2",children:[c.jsx("input",{type:"file",ref:g,multiple:!0,className:"hidden",accept:".arw,.cr2,.cr3,.dng,.nef,.orf,.raf,.rw2,.pef,.srw,.sr2,.srf,.x3f,.erf,.mef,.mos,.mrw,.kdc,.dcr,.iiq,.3fr,.fff,.rwl,.nrw,.raw,.tif,.tiff",onChange:X}),c.jsx("button",{onClick:()=>{var z;return(z=g.current)==null?void 0:z.click()},disabled:l,className:"flex-1 py-4 text-sm font-bold uppercase tracking-widest transition-all shadow-[4px_4px_0px_black] active:shadow-none active:translate-x-1 active:translate-y-1 bg-white dark:bg-slate-800 border-2 border-black dark:border-white text-black dark:text-white hover:bg-gray-100 dark:hover:bg-slate-700",children:"Batch Export (Files)"}),c.jsx("button",{onClick:V,disabled:l,className:`flex-[2] py-4 text-sm font-bold uppercase tracking-widest transition-all shadow-[4px_4px_0px_black] active:shadow-none active:translate-x-1 active:translate-y-1 ${l?"bg-gray-400 cursor-wait":"bg-cyan-600 hover:bg-cyan-500 text-white border-2 border-black"}`,children:l?"Processing...":"Export Single"})]}),d&&c.jsx("div",{className:"text-center text-xs font-bold text-cyan-600 dark:text-cyan-400 animate-pulse",children:d})]})})]}):null};async function BO(e={}){var $d,W0,As;var t,r=e,n=!!globalThis.window,a=!!globalThis.WorkerGlobalScope,i=((W0=($d=globalThis.process)==null?void 0:$d.versions)==null?void 0:W0.node)&&((As=globalThis.process)==null?void 0:As.type)!="renderer";if(i){const{createRequire:p}=await St(()=>import("./__vite-browser-external-BIHI7g3E.js"),[]);var o=p(import.meta.url)}var s="./this.program",l=(p,m)=>{throw m},u=import.meta.url,d="";function f(p){return r.locateFile?r.locateFile(p,d):d+p}var h,g;if(i){var v=o("fs");u.startsWith("file:")&&(d=o("path").dirname(o("url").fileURLToPath(u))+"/"),g=p=>{p=_(p)?new URL(p):p;var m=v.readFileSync(p);return m},h=async(p,m=!0)=>{p=_(p)?new URL(p):p;var C=v.readFileSync(p,m?void 0:"utf8");return C},process.argv.length>1&&(s=process.argv[1].replace(/\\/g,"/")),process.argv.slice(2),l=(p,m)=>{throw process.exitCode=p,m}}else if(n||a){try{d=new URL(".",u).href}catch{}a&&(g=p=>{var m=new XMLHttpRequest;return m.open("GET",p,!1),m.responseType="arraybuffer",m.send(null),new Uint8Array(m.response)}),h=async p=>{if(_(p))return new Promise((C,O)=>{var L=new XMLHttpRequest;L.open("GET",p,!0),L.responseType="arraybuffer",L.onload=()=>{if(L.status==200||L.status==0&&L.response){C(L.response);return}O(L.status)},L.onerror=O,L.send(null)});var m=await fetch(p,{credentials:"same-origin"});if(m.ok)return m.arrayBuffer();throw new Error(m.status+" : "+m.url)}}var w=console.log.bind(console),b=console.error.bind(console),x,y=!1,_=p=>p.startsWith("file://"),j,S,k,M,N,T,A,D,$,B,J,W,I=!1;function G(){var p=vi.buffer;k=new Int8Array(p),N=new Int16Array(p),M=new Uint8Array(p),T=new Uint16Array(p),A=new Int32Array(p),D=new Uint32Array(p),$=new Float32Array(p),B=new Float64Array(p),J=new BigInt64Array(p),W=new BigUint64Array(p)}function U(){if(r.preRun)for(typeof r.preRun=="function"&&(r.preRun=[r.preRun]);r.preRun.length;)Be(r.preRun.shift());Ne(me)}function X(){I=!0,!r.noFSInit&&!R.initialized&&R.init(),Ko.da(),R.ignorePermissions=!1}function V(){if(r.postRun)for(typeof r.postRun=="function"&&(r.postRun=[r.postRun]);r.postRun.length;)ke(r.postRun.shift());Ne(pe)}function z(p){var C;(C=r.onAbort)==null||C.call(r,p),p="Aborted("+p+")",b(p),y=!0,p+=". Build with -sASSERTIONS for more info.";var m=new WebAssembly.RuntimeError(p);throw S==null||S(m),m}var q;function te(){return r.locateFile?f("joraw.wasm"):new URL("/assets/joraw-DraTMNgX.wasm",import.meta.url).href}function ie(p){if(p==q&&x)return new Uint8Array(x);if(g)return g(p);throw"both async and sync fetching of the wasm failed"}async function he(p){if(!x)try{var m=await h(p);return new Uint8Array(m)}catch{}return ie(p)}async function ee(p,m){try{var C=await he(p),O=await WebAssembly.instantiate(C,m);return O}catch(L){b(`failed to asynchronously prepare wasm: ${L}`),z(L)}}async function Le(p,m,C){if(!p&&!_(m)&&!i)try{var O=fetch(m,{credentials:"same-origin"}),L=await WebAssembly.instantiateStreaming(O,C);return L}catch(K){b(`wasm streaming compile failed: ${K}`),b("falling back to ArrayBuffer instantiation")}return ee(m,C)}function fe(){var p={a:Id};return p}async function ce(){function p(K,ne){return Ko=K.exports,Ko=Zm(Ko),va(Ko),G(),Ko}function m(K){return p(K.instance)}var C=fe();if(r.instantiateWasm)return new Promise((K,ne)=>{r.instantiateWasm(C,(le,ge)=>{K(p(le))})});q??(q=te());var O=await Le(x,q,C),L=m(O);return L}class de{constructor(m){Ht(this,"name","ExitStatus");this.message=`Program terminated with exit(${m})`,this.status=m}}var Ne=p=>{for(;p.length>0;)p.shift()(r)},pe=[],ke=p=>pe.push(p),me=[],Be=p=>me.push(p),Se=!0,we=p=>Ai(p),Re=()=>Ua(),it=9007199254740992,Qe=-9007199254740992,se=p=>p<Qe||p>it?NaN:Number(p),Xe=globalThis.TextDecoder&&new TextDecoder,ht=(p,m,C,O)=>{var L=m+C;if(O)return L;for(;p[m]&&!(m>=L);)++m;return m},Zt=(p,m=0,C,O)=>{m>>>=0;var L=ht(p,m,C,O);if(L-m>16&&p.buffer&&Xe)return Xe.decode(p.subarray(m,L));for(var K="";m<L;){var ne=p[m++];if(!(ne&128)){K+=String.fromCharCode(ne);continue}var le=p[m++]&63;if((ne&224)==192){K+=String.fromCharCode((ne&31)<<6|le);continue}var ge=p[m++]&63;if((ne&240)==224?ne=(ne&15)<<12|le<<6|ge:ne=(ne&7)<<18|le<<12|ge<<6|p[m++]&63,ne<65536)K+=String.fromCharCode(ne);else{var Ge=ne-65536;K+=String.fromCharCode(55296|Ge>>10,56320|Ge&1023)}}return K},Jt=(p,m,C)=>(p>>>=0,p?Zt(M,p,m,C):"");function Ut(p,m,C,O){return p>>>=0,m>>>=0,O>>>=0,z(`Assertion failed: ${Jt(p)}, at: `+[m?Jt(m):"unknown filename",C,O?Jt(O):"unknown function"])}class Lt{constructor(m){this.excPtr=m,this.ptr=m-24}set_type(m){D[this.ptr+4>>>2>>>0]=m}get_type(){return D[this.ptr+4>>>2>>>0]}set_destructor(m){D[this.ptr+8>>>2>>>0]=m}get_destructor(){return D[this.ptr+8>>>2>>>0]}set_caught(m){m=m?1:0,k[this.ptr+12>>>0]=m}get_caught(){return k[this.ptr+12>>>0]!=0}set_rethrown(m){m=m?1:0,k[this.ptr+13>>>0]=m}get_rethrown(){return k[this.ptr+13>>>0]!=0}init(m,C){this.set_adjusted_ptr(0),this.set_type(m),this.set_destructor(C)}set_adjusted_ptr(m){D[this.ptr+16>>>2>>>0]=m}get_adjusted_ptr(){return D[this.ptr+16>>>2>>>0]}}var pr=0;function ir(p,m,C){p>>>=0,m>>>=0,C>>>=0;var O=new Lt(p);throw O.init(m,C),pr=p,pr}var zt=()=>{var p=A[+sr.varargs>>>2>>>0];return sr.varargs+=4,p},Tr=zt,lt={isAbs:p=>p.charAt(0)==="/",splitPath:p=>{var m=/^(\/?|)([\s\S]*?)((?:\.{1,2}|[^\/]+?|)(\.[^.\/]*|))(?:[\/]*)$/;return m.exec(p).slice(1)},normalizeArray:(p,m)=>{for(var C=0,O=p.length-1;O>=0;O--){var L=p[O];L==="."?p.splice(O,1):L===".."?(p.splice(O,1),C++):C&&(p.splice(O,1),C--)}if(m)for(;C;C--)p.unshift("..");return p},normalize:p=>{var m=lt.isAbs(p),C=p.slice(-1)==="/";return p=lt.normalizeArray(p.split("/").filter(O=>!!O),!m).join("/"),!p&&!m&&(p="."),p&&C&&(p+="/"),(m?"/":"")+p},dirname:p=>{var m=lt.splitPath(p),C=m[0],O=m[1];return!C&&!O?".":(O&&(O=O.slice(0,-1)),C+O)},basename:p=>p&&p.match(/([^\/]+|\/)\/*$/)[1],join:(...p)=>lt.normalize(p.join("/")),join2:(p,m)=>lt.normalize(p+"/"+m)},Nt=()=>{if(i){var p=o("crypto");return m=>p.randomFillSync(m)}return m=>crypto.getRandomValues(m)},wr=p=>{(wr=Nt())(p)},kr={resolve:(...p)=>{for(var m="",C=!1,O=p.length-1;O>=-1&&!C;O--){var L=O>=0?p[O]:R.cwd();if(typeof L!="string")throw new TypeError("Arguments to path.resolve must be strings");if(!L)return"";m=L+"/"+m,C=lt.isAbs(L)}return m=lt.normalizeArray(m.split("/").filter(K=>!!K),!C).join("/"),(C?"/":"")+m||"."},relative:(p,m)=>{p=kr.resolve(p).slice(1),m=kr.resolve(m).slice(1);function C(Ge){for(var st=0;st<Ge.length&&Ge[st]==="";st++);for(var kt=Ge.length-1;kt>=0&&Ge[kt]==="";kt--);return st>kt?[]:Ge.slice(st,kt-st+1)}for(var O=C(p.split("/")),L=C(m.split("/")),K=Math.min(O.length,L.length),ne=K,le=0;le<K;le++)if(O[le]!==L[le]){ne=le;break}for(var ge=[],le=ne;le<O.length;le++)ge.push("..");return ge=ge.concat(L.slice(ne)),ge.join("/")}},_r=[],zr=p=>{for(var m=0,C=0;C<p.length;++C){var O=p.charCodeAt(C);O<=127?m++:O<=2047?m+=2:O>=55296&&O<=57343?(m+=4,++C):m+=3}return m},Or=(p,m,C,O)=>{if(C>>>=0,!(O>0))return 0;for(var L=C,K=C+O-1,ne=0;ne<p.length;++ne){var le=p.codePointAt(ne);if(le<=127){if(C>=K)break;m[C++>>>0]=le}else if(le<=2047){if(C+1>=K)break;m[C++>>>0]=192|le>>6,m[C++>>>0]=128|le&63}else if(le<=65535){if(C+2>=K)break;m[C++>>>0]=224|le>>12,m[C++>>>0]=128|le>>6&63,m[C++>>>0]=128|le&63}else{if(C+3>=K)break;m[C++>>>0]=240|le>>18,m[C++>>>0]=128|le>>12&63,m[C++>>>0]=128|le>>6&63,m[C++>>>0]=128|le&63,ne++}}return m[C>>>0]=0,C-L},or=(p,m,C)=>{var O=zr(p)+1,L=new Array(O),K=Or(p,L,0,L.length);return L.length=K,L},Br=()=>{var K;if(!_r.length){var p=null;if(i){var m=256,C=Buffer.alloc(m),O=0,L=process.stdin.fd;try{O=v.readSync(L,C,0,m)}catch(ne){if(ne.toString().includes("EOF"))O=0;else throw ne}O>0&&(p=C.slice(0,O).toString("utf-8"))}else(K=globalThis.window)!=null&&K.prompt&&(p=window.prompt("Input: "),p!==null&&(p+=`
`));if(!p)return null;_r=or(p)}return _r.shift()},Xt={ttys:[],init(){},shutdown(){},register(p,m){Xt.ttys[p]={input:[],output:[],ops:m},R.registerDevice(p,Xt.stream_ops)},stream_ops:{open(p){var m=Xt.ttys[p.node.rdev];if(!m)throw new R.ErrnoError(43);p.tty=m,p.seekable=!1},close(p){p.tty.ops.fsync(p.tty)},fsync(p){p.tty.ops.fsync(p.tty)},read(p,m,C,O,L){if(!p.tty||!p.tty.ops.get_char)throw new R.ErrnoError(60);for(var K=0,ne=0;ne<O;ne++){var le;try{le=p.tty.ops.get_char(p.tty)}catch{throw new R.ErrnoError(29)}if(le===void 0&&K===0)throw new R.ErrnoError(6);if(le==null)break;K++,m[C+ne]=le}return K&&(p.node.atime=Date.now()),K},write(p,m,C,O,L){if(!p.tty||!p.tty.ops.put_char)throw new R.ErrnoError(60);try{for(var K=0;K<O;K++)p.tty.ops.put_char(p.tty,m[C+K])}catch{throw new R.ErrnoError(29)}return O&&(p.node.mtime=p.node.ctime=Date.now()),K}},default_tty_ops:{get_char(p){return Br()},put_char(p,m){m===null||m===10?(w(Zt(p.output)),p.output=[]):m!=0&&p.output.push(m)},fsync(p){var m;((m=p.output)==null?void 0:m.length)>0&&(w(Zt(p.output)),p.output=[])},ioctl_tcgets(p){return{c_iflag:25856,c_oflag:5,c_cflag:191,c_lflag:35387,c_cc:[3,28,127,21,4,0,1,0,17,19,26,0,18,15,23,22,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]}},ioctl_tcsets(p,m,C){return 0},ioctl_tiocgwinsz(p){return[24,80]}},default_tty1_ops:{put_char(p,m){m===null||m===10?(b(Zt(p.output)),p.output=[]):m!=0&&p.output.push(m)},fsync(p){var m;((m=p.output)==null?void 0:m.length)>0&&(b(Zt(p.output)),p.output=[])}}},Te=p=>{z()},Q={ops_table:null,mount(p){return Q.createNode(null,"/",16895,0)},createNode(p,m,C,O){if(R.isBlkdev(C)||R.isFIFO(C))throw new R.ErrnoError(63);Q.ops_table||(Q.ops_table={dir:{node:{getattr:Q.node_ops.getattr,setattr:Q.node_ops.setattr,lookup:Q.node_ops.lookup,mknod:Q.node_ops.mknod,rename:Q.node_ops.rename,unlink:Q.node_ops.unlink,rmdir:Q.node_ops.rmdir,readdir:Q.node_ops.readdir,symlink:Q.node_ops.symlink},stream:{llseek:Q.stream_ops.llseek}},file:{node:{getattr:Q.node_ops.getattr,setattr:Q.node_ops.setattr},stream:{llseek:Q.stream_ops.llseek,read:Q.stream_ops.read,write:Q.stream_ops.write,mmap:Q.stream_ops.mmap,msync:Q.stream_ops.msync}},link:{node:{getattr:Q.node_ops.getattr,setattr:Q.node_ops.setattr,readlink:Q.node_ops.readlink},stream:{}},chrdev:{node:{getattr:Q.node_ops.getattr,setattr:Q.node_ops.setattr},stream:R.chrdev_stream_ops}});var L=R.createNode(p,m,C,O);return R.isDir(L.mode)?(L.node_ops=Q.ops_table.dir.node,L.stream_ops=Q.ops_table.dir.stream,L.contents={}):R.isFile(L.mode)?(L.node_ops=Q.ops_table.file.node,L.stream_ops=Q.ops_table.file.stream,L.usedBytes=0,L.contents=null):R.isLink(L.mode)?(L.node_ops=Q.ops_table.link.node,L.stream_ops=Q.ops_table.link.stream):R.isChrdev(L.mode)&&(L.node_ops=Q.ops_table.chrdev.node,L.stream_ops=Q.ops_table.chrdev.stream),L.atime=L.mtime=L.ctime=Date.now(),p&&(p.contents[m]=L,p.atime=p.mtime=p.ctime=L.atime),L},getFileDataAsTypedArray(p){return p.contents?p.contents.subarray?p.contents.subarray(0,p.usedBytes):new Uint8Array(p.contents):new Uint8Array(0)},expandFileStorage(p,m){var C=p.contents?p.contents.length:0;if(!(C>=m)){var O=1024*1024;m=Math.max(m,C*(C<O?2:1.125)>>>0),C!=0&&(m=Math.max(m,256));var L=p.contents;p.contents=new Uint8Array(m),p.usedBytes>0&&p.contents.set(L.subarray(0,p.usedBytes),0)}},resizeFileStorage(p,m){if(p.usedBytes!=m)if(m==0)p.contents=null,p.usedBytes=0;else{var C=p.contents;p.contents=new Uint8Array(m),C&&p.contents.set(C.subarray(0,Math.min(m,p.usedBytes))),p.usedBytes=m}},node_ops:{getattr(p){var m={};return m.dev=R.isChrdev(p.mode)?p.id:1,m.ino=p.id,m.mode=p.mode,m.nlink=1,m.uid=0,m.gid=0,m.rdev=p.rdev,R.isDir(p.mode)?m.size=4096:R.isFile(p.mode)?m.size=p.usedBytes:R.isLink(p.mode)?m.size=p.link.length:m.size=0,m.atime=new Date(p.atime),m.mtime=new Date(p.mtime),m.ctime=new Date(p.ctime),m.blksize=4096,m.blocks=Math.ceil(m.size/m.blksize),m},setattr(p,m){for(const C of["mode","atime","mtime","ctime"])m[C]!=null&&(p[C]=m[C]);m.size!==void 0&&Q.resizeFileStorage(p,m.size)},lookup(p,m){throw Q.doesNotExistError||(Q.doesNotExistError=new R.ErrnoError(44),Q.doesNotExistError.stack="<generic error, no stack>"),Q.doesNotExistError},mknod(p,m,C,O){return Q.createNode(p,m,C,O)},rename(p,m,C){var O;try{O=R.lookupNode(m,C)}catch{}if(O){if(R.isDir(p.mode))for(var L in O.contents)throw new R.ErrnoError(55);R.hashRemoveNode(O)}delete p.parent.contents[p.name],m.contents[C]=p,p.name=C,m.ctime=m.mtime=p.parent.ctime=p.parent.mtime=Date.now()},unlink(p,m){delete p.contents[m],p.ctime=p.mtime=Date.now()},rmdir(p,m){var C=R.lookupNode(p,m);for(var O in C.contents)throw new R.ErrnoError(55);delete p.contents[m],p.ctime=p.mtime=Date.now()},readdir(p){return[".","..",...Object.keys(p.contents)]},symlink(p,m,C){var O=Q.createNode(p,m,41471,0);return O.link=C,O},readlink(p){if(!R.isLink(p.mode))throw new R.ErrnoError(28);return p.link}},stream_ops:{read(p,m,C,O,L){var K=p.node.contents;if(L>=p.node.usedBytes)return 0;var ne=Math.min(p.node.usedBytes-L,O);if(ne>8&&K.subarray)m.set(K.subarray(L,L+ne),C);else for(var le=0;le<ne;le++)m[C+le]=K[L+le];return ne},write(p,m,C,O,L,K){if(m.buffer===k.buffer&&(K=!1),!O)return 0;var ne=p.node;if(ne.mtime=ne.ctime=Date.now(),m.subarray&&(!ne.contents||ne.contents.subarray)){if(K)return ne.contents=m.subarray(C,C+O),ne.usedBytes=O,O;if(ne.usedBytes===0&&L===0)return ne.contents=m.slice(C,C+O),ne.usedBytes=O,O;if(L+O<=ne.usedBytes)return ne.contents.set(m.subarray(C,C+O),L),O}if(Q.expandFileStorage(ne,L+O),ne.contents.subarray&&m.subarray)ne.contents.set(m.subarray(C,C+O),L);else for(var le=0;le<O;le++)ne.contents[L+le]=m[C+le];return ne.usedBytes=Math.max(ne.usedBytes,L+O),O},llseek(p,m,C){var O=m;if(C===1?O+=p.position:C===2&&R.isFile(p.node.mode)&&(O+=p.node.usedBytes),O<0)throw new R.ErrnoError(28);return O},mmap(p,m,C,O,L){if(!R.isFile(p.node.mode))throw new R.ErrnoError(43);var K,ne,le=p.node.contents;if(!(L&2)&&le&&le.buffer===k.buffer)ne=!1,K=le.byteOffset;else{if(ne=!0,K=Te(),!K)throw new R.ErrnoError(48);le&&((C>0||C+m<le.length)&&(le.subarray?le=le.subarray(C,C+m):le=Array.prototype.slice.call(le,C,C+m)),k.set(le,K>>>0))}return{ptr:K,allocated:ne}},msync(p,m,C,O,L){return Q.stream_ops.write(p,m,0,O,C,!1),0}}},Ce=p=>{var m={r:0,"r+":2,w:577,"w+":578,a:1089,"a+":1090},C=m[p];if(typeof C>"u")throw new Error(`Unknown file open mode: ${p}`);return C},ye=(p,m)=>{var C=0;return p&&(C|=365),m&&(C|=146),C},ze=async p=>{var m=await h(p);return new Uint8Array(m)},ot=(...p)=>R.createDataFile(...p),ct=0,Ct=null,tt=p=>{var C;if(ct--,(C=r.monitorRunDependencies)==null||C.call(r,ct),ct==0&&Ct){var m=Ct;Ct=null,m()}},Hr=p=>{var m;ct++,(m=r.monitorRunDependencies)==null||m.call(r,ct)},gr=[],Qt=async(p,m)=>{typeof Browser<"u"&&Browser.init();for(var C of gr)if(C.canHandle(m))return C.handle(p,m);return p},jt=async(p,m,C,O,L,K,ne,le)=>{var ge=m?kr.resolve(lt.join2(p,m)):p;Hr();try{var Ge=C;typeof C=="string"&&(Ge=await ze(C)),Ge=await Qt(Ge,ge),le==null||le(),K||ot(p,m,Ge,O,L,ne)}finally{tt()}},mr=(p,m,C,O,L,K,ne,le,ge,Ge)=>{jt(p,m,C,O,L,le,ge,Ge).then(K).catch(ne)},R={root:null,mounts:[],devices:{},streams:[],nextInode:1,nameTable:null,currentPath:"/",initialized:!1,ignorePermissions:!0,filesystems:null,syncFSRequests:0,readFiles:{},ErrnoError:class{constructor(p){Ht(this,"name","ErrnoError");this.errno=p}},FSStream:class{constructor(){Ht(this,"shared",{})}get object(){return this.node}set object(p){this.node=p}get isRead(){return(this.flags&2097155)!==1}get isWrite(){return(this.flags&2097155)!==0}get isAppend(){return this.flags&1024}get flags(){return this.shared.flags}set flags(p){this.shared.flags=p}get position(){return this.shared.position}set position(p){this.shared.position=p}},FSNode:class{constructor(p,m,C,O){Ht(this,"node_ops",{});Ht(this,"stream_ops",{});Ht(this,"readMode",365);Ht(this,"writeMode",146);Ht(this,"mounted",null);p||(p=this),this.parent=p,this.mount=p.mount,this.id=R.nextInode++,this.name=m,this.mode=C,this.rdev=O,this.atime=this.mtime=this.ctime=Date.now()}get read(){return(this.mode&this.readMode)===this.readMode}set read(p){p?this.mode|=this.readMode:this.mode&=~this.readMode}get write(){return(this.mode&this.writeMode)===this.writeMode}set write(p){p?this.mode|=this.writeMode:this.mode&=~this.writeMode}get isFolder(){return R.isDir(this.mode)}get isDevice(){return R.isChrdev(this.mode)}},lookupPath(p,m={}){if(!p)throw new R.ErrnoError(44);m.follow_mount??(m.follow_mount=!0),lt.isAbs(p)||(p=R.cwd()+"/"+p);e:for(var C=0;C<40;C++){for(var O=p.split("/").filter(Ge=>!!Ge),L=R.root,K="/",ne=0;ne<O.length;ne++){var le=ne===O.length-1;if(le&&m.parent)break;if(O[ne]!=="."){if(O[ne]===".."){if(K=lt.dirname(K),R.isRoot(L)){p=K+"/"+O.slice(ne+1).join("/"),C--;continue e}else L=L.parent;continue}K=lt.join2(K,O[ne]);try{L=R.lookupNode(L,O[ne])}catch(Ge){if((Ge==null?void 0:Ge.errno)===44&&le&&m.noent_okay)return{path:K};throw Ge}if(R.isMountpoint(L)&&(!le||m.follow_mount)&&(L=L.mounted.root),R.isLink(L.mode)&&(!le||m.follow)){if(!L.node_ops.readlink)throw new R.ErrnoError(52);var ge=L.node_ops.readlink(L);lt.isAbs(ge)||(ge=lt.dirname(K)+"/"+ge),p=ge+"/"+O.slice(ne+1).join("/");continue e}}}return{path:K,node:L}}throw new R.ErrnoError(32)},getPath(p){for(var m;;){if(R.isRoot(p)){var C=p.mount.mountpoint;return m?C[C.length-1]!=="/"?`${C}/${m}`:C+m:C}m=m?`${p.name}/${m}`:p.name,p=p.parent}},hashName(p,m){for(var C=0,O=0;O<m.length;O++)C=(C<<5)-C+m.charCodeAt(O)|0;return(p+C>>>0)%R.nameTable.length},hashAddNode(p){var m=R.hashName(p.parent.id,p.name);p.name_next=R.nameTable[m],R.nameTable[m]=p},hashRemoveNode(p){var m=R.hashName(p.parent.id,p.name);if(R.nameTable[m]===p)R.nameTable[m]=p.name_next;else for(var C=R.nameTable[m];C;){if(C.name_next===p){C.name_next=p.name_next;break}C=C.name_next}},lookupNode(p,m){var C=R.mayLookup(p);if(C)throw new R.ErrnoError(C);for(var O=R.hashName(p.id,m),L=R.nameTable[O];L;L=L.name_next){var K=L.name;if(L.parent.id===p.id&&K===m)return L}return R.lookup(p,m)},createNode(p,m,C,O){var L=new R.FSNode(p,m,C,O);return R.hashAddNode(L),L},destroyNode(p){R.hashRemoveNode(p)},isRoot(p){return p===p.parent},isMountpoint(p){return!!p.mounted},isFile(p){return(p&61440)===32768},isDir(p){return(p&61440)===16384},isLink(p){return(p&61440)===40960},isChrdev(p){return(p&61440)===8192},isBlkdev(p){return(p&61440)===24576},isFIFO(p){return(p&61440)===4096},isSocket(p){return(p&49152)===49152},flagsToPermissionString(p){var m=["r","w","rw"][p&3];return p&512&&(m+="w"),m},nodePermissions(p,m){return R.ignorePermissions?0:m.includes("r")&&!(p.mode&292)||m.includes("w")&&!(p.mode&146)||m.includes("x")&&!(p.mode&73)?2:0},mayLookup(p){if(!R.isDir(p.mode))return 54;var m=R.nodePermissions(p,"x");return m||(p.node_ops.lookup?0:2)},mayCreate(p,m){if(!R.isDir(p.mode))return 54;try{var C=R.lookupNode(p,m);return 20}catch{}return R.nodePermissions(p,"wx")},mayDelete(p,m,C){var O;try{O=R.lookupNode(p,m)}catch(K){return K.errno}var L=R.nodePermissions(p,"wx");if(L)return L;if(C){if(!R.isDir(O.mode))return 54;if(R.isRoot(O)||R.getPath(O)===R.cwd())return 10}else if(R.isDir(O.mode))return 31;return 0},mayOpen(p,m){return p?R.isLink(p.mode)?32:R.isDir(p.mode)&&(R.flagsToPermissionString(m)!=="r"||m&576)?31:R.nodePermissions(p,R.flagsToPermissionString(m)):44},checkOpExists(p,m){if(!p)throw new R.ErrnoError(m);return p},MAX_OPEN_FDS:4096,nextfd(){for(var p=0;p<=R.MAX_OPEN_FDS;p++)if(!R.streams[p])return p;throw new R.ErrnoError(33)},getStreamChecked(p){var m=R.getStream(p);if(!m)throw new R.ErrnoError(8);return m},getStream:p=>R.streams[p],createStream(p,m=-1){return p=Object.assign(new R.FSStream,p),m==-1&&(m=R.nextfd()),p.fd=m,R.streams[m]=p,p},closeStream(p){R.streams[p]=null},dupStream(p,m=-1){var O,L;var C=R.createStream(p,m);return(L=(O=C.stream_ops)==null?void 0:O.dup)==null||L.call(O,C),C},doSetAttr(p,m,C){var O=p==null?void 0:p.stream_ops.setattr,L=O?p:m;O??(O=m.node_ops.setattr),R.checkOpExists(O,63),O(L,C)},chrdev_stream_ops:{open(p){var C,O;var m=R.getDevice(p.node.rdev);p.stream_ops=m.stream_ops,(O=(C=p.stream_ops).open)==null||O.call(C,p)},llseek(){throw new R.ErrnoError(70)}},major:p=>p>>8,minor:p=>p&255,makedev:(p,m)=>p<<8|m,registerDevice(p,m){R.devices[p]={stream_ops:m}},getDevice:p=>R.devices[p],getMounts(p){for(var m=[],C=[p];C.length;){var O=C.pop();m.push(O),C.push(...O.mounts)}return m},syncfs(p,m){typeof p=="function"&&(m=p,p=!1),R.syncFSRequests++,R.syncFSRequests>1&&b(`warning: ${R.syncFSRequests} FS.syncfs operations in flight at once, probably just doing extra work`);var C=R.getMounts(R.root.mount),O=0;function L(le){return R.syncFSRequests--,m(le)}function K(le){if(le)return K.errored?void 0:(K.errored=!0,L(le));++O>=C.length&&L(null)}for(var ne of C)ne.type.syncfs?ne.type.syncfs(ne,p,K):K(null)},mount(p,m,C){var O=C==="/",L=!C,K;if(O&&R.root)throw new R.ErrnoError(10);if(!O&&!L){var ne=R.lookupPath(C,{follow_mount:!1});if(C=ne.path,K=ne.node,R.isMountpoint(K))throw new R.ErrnoError(10);if(!R.isDir(K.mode))throw new R.ErrnoError(54)}var le={type:p,opts:m,mountpoint:C,mounts:[]},ge=p.mount(le);return ge.mount=le,le.root=ge,O?R.root=ge:K&&(K.mounted=le,K.mount&&K.mount.mounts.push(le)),ge},unmount(p){var m=R.lookupPath(p,{follow_mount:!1});if(!R.isMountpoint(m.node))throw new R.ErrnoError(28);var C=m.node,O=C.mounted,L=R.getMounts(O);for(var[K,ne]of Object.entries(R.nameTable))for(;ne;){var le=ne.name_next;L.includes(ne.mount)&&R.destroyNode(ne),ne=le}C.mounted=null;var ge=C.mount.mounts.indexOf(O);C.mount.mounts.splice(ge,1)},lookup(p,m){return p.node_ops.lookup(p,m)},mknod(p,m,C){var O=R.lookupPath(p,{parent:!0}),L=O.node,K=lt.basename(p);if(!K)throw new R.ErrnoError(28);if(K==="."||K==="..")throw new R.ErrnoError(20);var ne=R.mayCreate(L,K);if(ne)throw new R.ErrnoError(ne);if(!L.node_ops.mknod)throw new R.ErrnoError(63);return L.node_ops.mknod(L,K,m,C)},statfs(p){return R.statfsNode(R.lookupPath(p,{follow:!0}).node)},statfsStream(p){return R.statfsNode(p.node)},statfsNode(p){var m={bsize:4096,frsize:4096,blocks:1e6,bfree:5e5,bavail:5e5,files:R.nextInode,ffree:R.nextInode-1,fsid:42,flags:2,namelen:255};return p.node_ops.statfs&&Object.assign(m,p.node_ops.statfs(p.mount.opts.root)),m},create(p,m=438){return m&=4095,m|=32768,R.mknod(p,m,0)},mkdir(p,m=511){return m&=1023,m|=16384,R.mknod(p,m,0)},mkdirTree(p,m){var C=p.split("/"),O="";for(var L of C)if(L){(O||lt.isAbs(p))&&(O+="/"),O+=L;try{R.mkdir(O,m)}catch(K){if(K.errno!=20)throw K}}},mkdev(p,m,C){return typeof C>"u"&&(C=m,m=438),m|=8192,R.mknod(p,m,C)},symlink(p,m){if(!kr.resolve(p))throw new R.ErrnoError(44);var C=R.lookupPath(m,{parent:!0}),O=C.node;if(!O)throw new R.ErrnoError(44);var L=lt.basename(m),K=R.mayCreate(O,L);if(K)throw new R.ErrnoError(K);if(!O.node_ops.symlink)throw new R.ErrnoError(63);return O.node_ops.symlink(O,L,p)},rename(p,m){var C=lt.dirname(p),O=lt.dirname(m),L=lt.basename(p),K=lt.basename(m),ne,le,ge;if(ne=R.lookupPath(p,{parent:!0}),le=ne.node,ne=R.lookupPath(m,{parent:!0}),ge=ne.node,!le||!ge)throw new R.ErrnoError(44);if(le.mount!==ge.mount)throw new R.ErrnoError(75);var Ge=R.lookupNode(le,L),st=kr.relative(p,O);if(st.charAt(0)!==".")throw new R.ErrnoError(28);if(st=kr.relative(m,C),st.charAt(0)!==".")throw new R.ErrnoError(55);var kt;try{kt=R.lookupNode(ge,K)}catch{}if(Ge!==kt){var xt=R.isDir(Ge.mode),Je=R.mayDelete(le,L,xt);if(Je)throw new R.ErrnoError(Je);if(Je=kt?R.mayDelete(ge,K,xt):R.mayCreate(ge,K),Je)throw new R.ErrnoError(Je);if(!le.node_ops.rename)throw new R.ErrnoError(63);if(R.isMountpoint(Ge)||kt&&R.isMountpoint(kt))throw new R.ErrnoError(10);if(ge!==le&&(Je=R.nodePermissions(le,"w"),Je))throw new R.ErrnoError(Je);R.hashRemoveNode(Ge);try{le.node_ops.rename(Ge,ge,K),Ge.parent=ge}catch(dr){throw dr}finally{R.hashAddNode(Ge)}}},rmdir(p){var m=R.lookupPath(p,{parent:!0}),C=m.node,O=lt.basename(p),L=R.lookupNode(C,O),K=R.mayDelete(C,O,!0);if(K)throw new R.ErrnoError(K);if(!C.node_ops.rmdir)throw new R.ErrnoError(63);if(R.isMountpoint(L))throw new R.ErrnoError(10);C.node_ops.rmdir(C,O),R.destroyNode(L)},readdir(p){var m=R.lookupPath(p,{follow:!0}),C=m.node,O=R.checkOpExists(C.node_ops.readdir,54);return O(C)},unlink(p){var m=R.lookupPath(p,{parent:!0}),C=m.node;if(!C)throw new R.ErrnoError(44);var O=lt.basename(p),L=R.lookupNode(C,O),K=R.mayDelete(C,O,!1);if(K)throw new R.ErrnoError(K);if(!C.node_ops.unlink)throw new R.ErrnoError(63);if(R.isMountpoint(L))throw new R.ErrnoError(10);C.node_ops.unlink(C,O),R.destroyNode(L)},readlink(p){var m=R.lookupPath(p),C=m.node;if(!C)throw new R.ErrnoError(44);if(!C.node_ops.readlink)throw new R.ErrnoError(28);return C.node_ops.readlink(C)},stat(p,m){var C=R.lookupPath(p,{follow:!m}),O=C.node,L=R.checkOpExists(O.node_ops.getattr,63);return L(O)},fstat(p){var m=R.getStreamChecked(p),C=m.node,O=m.stream_ops.getattr,L=O?m:C;return O??(O=C.node_ops.getattr),R.checkOpExists(O,63),O(L)},lstat(p){return R.stat(p,!0)},doChmod(p,m,C,O){R.doSetAttr(p,m,{mode:C&4095|m.mode&-4096,ctime:Date.now(),dontFollow:O})},chmod(p,m,C){var O;if(typeof p=="string"){var L=R.lookupPath(p,{follow:!C});O=L.node}else O=p;R.doChmod(null,O,m,C)},lchmod(p,m){R.chmod(p,m,!0)},fchmod(p,m){var C=R.getStreamChecked(p);R.doChmod(C,C.node,m,!1)},doChown(p,m,C){R.doSetAttr(p,m,{timestamp:Date.now(),dontFollow:C})},chown(p,m,C,O){var L;if(typeof p=="string"){var K=R.lookupPath(p,{follow:!O});L=K.node}else L=p;R.doChown(null,L,O)},lchown(p,m,C){R.chown(p,m,C,!0)},fchown(p,m,C){var O=R.getStreamChecked(p);R.doChown(O,O.node,!1)},doTruncate(p,m,C){if(R.isDir(m.mode))throw new R.ErrnoError(31);if(!R.isFile(m.mode))throw new R.ErrnoError(28);var O=R.nodePermissions(m,"w");if(O)throw new R.ErrnoError(O);R.doSetAttr(p,m,{size:C,timestamp:Date.now()})},truncate(p,m){if(m<0)throw new R.ErrnoError(28);var C;if(typeof p=="string"){var O=R.lookupPath(p,{follow:!0});C=O.node}else C=p;R.doTruncate(null,C,m)},ftruncate(p,m){var C=R.getStreamChecked(p);if(m<0||!(C.flags&2097155))throw new R.ErrnoError(28);R.doTruncate(C,C.node,m)},utime(p,m,C){var O=R.lookupPath(p,{follow:!0}),L=O.node,K=R.checkOpExists(L.node_ops.setattr,63);K(L,{atime:m,mtime:C})},open(p,m,C=438){if(p==="")throw new R.ErrnoError(44);m=typeof m=="string"?Ce(m):m,m&64?C=C&4095|32768:C=0;var O,L;if(typeof p=="object")O=p;else{L=p.endsWith("/");var K=R.lookupPath(p,{follow:!(m&131072),noent_okay:!0});O=K.node,p=K.path}var ne=!1;if(m&64)if(O){if(m&128)throw new R.ErrnoError(20)}else{if(L)throw new R.ErrnoError(31);O=R.mknod(p,C|511,0),ne=!0}if(!O)throw new R.ErrnoError(44);if(R.isChrdev(O.mode)&&(m&=-513),m&65536&&!R.isDir(O.mode))throw new R.ErrnoError(54);if(!ne){var le=R.mayOpen(O,m);if(le)throw new R.ErrnoError(le)}m&512&&!ne&&R.truncate(O,0),m&=-131713;var ge=R.createStream({node:O,path:R.getPath(O),flags:m,seekable:!0,position:0,stream_ops:O.stream_ops,ungotten:[],error:!1});return ge.stream_ops.open&&ge.stream_ops.open(ge),ne&&R.chmod(O,C&511),r.logReadFiles&&!(m&1)&&(p in R.readFiles||(R.readFiles[p]=1)),ge},close(p){if(R.isClosed(p))throw new R.ErrnoError(8);p.getdents&&(p.getdents=null);try{p.stream_ops.close&&p.stream_ops.close(p)}catch(m){throw m}finally{R.closeStream(p.fd)}p.fd=null},isClosed(p){return p.fd===null},llseek(p,m,C){if(R.isClosed(p))throw new R.ErrnoError(8);if(!p.seekable||!p.stream_ops.llseek)throw new R.ErrnoError(70);if(C!=0&&C!=1&&C!=2)throw new R.ErrnoError(28);return p.position=p.stream_ops.llseek(p,m,C),p.ungotten=[],p.position},read(p,m,C,O,L){if(O<0||L<0)throw new R.ErrnoError(28);if(R.isClosed(p))throw new R.ErrnoError(8);if((p.flags&2097155)===1)throw new R.ErrnoError(8);if(R.isDir(p.node.mode))throw new R.ErrnoError(31);if(!p.stream_ops.read)throw new R.ErrnoError(28);var K=typeof L<"u";if(!K)L=p.position;else if(!p.seekable)throw new R.ErrnoError(70);var ne=p.stream_ops.read(p,m,C,O,L);return K||(p.position+=ne),ne},write(p,m,C,O,L,K){if(O<0||L<0)throw new R.ErrnoError(28);if(R.isClosed(p))throw new R.ErrnoError(8);if(!(p.flags&2097155))throw new R.ErrnoError(8);if(R.isDir(p.node.mode))throw new R.ErrnoError(31);if(!p.stream_ops.write)throw new R.ErrnoError(28);p.seekable&&p.flags&1024&&R.llseek(p,0,2);var ne=typeof L<"u";if(!ne)L=p.position;else if(!p.seekable)throw new R.ErrnoError(70);var le=p.stream_ops.write(p,m,C,O,L,K);return ne||(p.position+=le),le},mmap(p,m,C,O,L){if(O&2&&!(L&2)&&(p.flags&2097155)!==2)throw new R.ErrnoError(2);if((p.flags&2097155)===1)throw new R.ErrnoError(2);if(!p.stream_ops.mmap)throw new R.ErrnoError(43);if(!m)throw new R.ErrnoError(28);return p.stream_ops.mmap(p,m,C,O,L)},msync(p,m,C,O,L){return p.stream_ops.msync?p.stream_ops.msync(p,m,C,O,L):0},ioctl(p,m,C){if(!p.stream_ops.ioctl)throw new R.ErrnoError(59);return p.stream_ops.ioctl(p,m,C)},readFile(p,m={}){m.flags=m.flags||0,m.encoding=m.encoding||"binary",m.encoding!=="utf8"&&m.encoding!=="binary"&&z(`Invalid encoding type "${m.encoding}"`);var C=R.open(p,m.flags),O=R.stat(p),L=O.size,K=new Uint8Array(L);return R.read(C,K,0,L,0),m.encoding==="utf8"&&(K=Zt(K)),R.close(C),K},writeFile(p,m,C={}){C.flags=C.flags||577;var O=R.open(p,C.flags,C.mode);typeof m=="string"&&(m=new Uint8Array(or(m))),ArrayBuffer.isView(m)?R.write(O,m,0,m.byteLength,void 0,C.canOwn):z("Unsupported data type"),R.close(O)},cwd:()=>R.currentPath,chdir(p){var m=R.lookupPath(p,{follow:!0});if(m.node===null)throw new R.ErrnoError(44);if(!R.isDir(m.node.mode))throw new R.ErrnoError(54);var C=R.nodePermissions(m.node,"x");if(C)throw new R.ErrnoError(C);R.currentPath=m.path},createDefaultDirectories(){R.mkdir("/tmp"),R.mkdir("/home"),R.mkdir("/home/web_user")},createDefaultDevices(){R.mkdir("/dev"),R.registerDevice(R.makedev(1,3),{read:()=>0,write:(O,L,K,ne,le)=>ne,llseek:()=>0}),R.mkdev("/dev/null",R.makedev(1,3)),Xt.register(R.makedev(5,0),Xt.default_tty_ops),Xt.register(R.makedev(6,0),Xt.default_tty1_ops),R.mkdev("/dev/tty",R.makedev(5,0)),R.mkdev("/dev/tty1",R.makedev(6,0));var p=new Uint8Array(1024),m=0,C=()=>(m===0&&(wr(p),m=p.byteLength),p[--m]);R.createDevice("/dev","random",C),R.createDevice("/dev","urandom",C),R.mkdir("/dev/shm"),R.mkdir("/dev/shm/tmp")},createSpecialDirectories(){R.mkdir("/proc");var p=R.mkdir("/proc/self");R.mkdir("/proc/self/fd"),R.mount({mount(){var m=R.createNode(p,"fd",16895,73);return m.stream_ops={llseek:Q.stream_ops.llseek},m.node_ops={lookup(C,O){var L=+O,K=R.getStreamChecked(L),ne={parent:null,mount:{mountpoint:"fake"},node_ops:{readlink:()=>K.path},id:L+1};return ne.parent=ne,ne},readdir(){return Array.from(R.streams.entries()).filter(([C,O])=>O).map(([C,O])=>C.toString())}},m}},{},"/proc/self/fd")},createStandardStreams(p,m,C){p?R.createDevice("/dev","stdin",p):R.symlink("/dev/tty","/dev/stdin"),m?R.createDevice("/dev","stdout",null,m):R.symlink("/dev/tty","/dev/stdout"),C?R.createDevice("/dev","stderr",null,C):R.symlink("/dev/tty1","/dev/stderr"),R.open("/dev/stdin",0),R.open("/dev/stdout",1),R.open("/dev/stderr",1)},staticInit(){R.nameTable=new Array(4096),R.mount(Q,{},"/"),R.createDefaultDirectories(),R.createDefaultDevices(),R.createSpecialDirectories(),R.filesystems={MEMFS:Q}},init(p,m,C){R.initialized=!0,p??(p=r.stdin),m??(m=r.stdout),C??(C=r.stderr),R.createStandardStreams(p,m,C)},quit(){R.initialized=!1;for(var p of R.streams)p&&R.close(p)},findObject(p,m){var C=R.analyzePath(p,m);return C.exists?C.object:null},analyzePath(p,m){try{var C=R.lookupPath(p,{follow:!m});p=C.path}catch{}var O={isRoot:!1,exists:!1,error:0,name:null,path:null,object:null,parentExists:!1,parentPath:null,parentObject:null};try{var C=R.lookupPath(p,{parent:!0});O.parentExists=!0,O.parentPath=C.path,O.parentObject=C.node,O.name=lt.basename(p),C=R.lookupPath(p,{follow:!m}),O.exists=!0,O.path=C.path,O.object=C.node,O.name=C.node.name,O.isRoot=C.path==="/"}catch(L){O.error=L.errno}return O},createPath(p,m,C,O){p=typeof p=="string"?p:R.getPath(p);for(var L=m.split("/").reverse();L.length;){var K=L.pop();if(K){var ne=lt.join2(p,K);try{R.mkdir(ne)}catch(le){if(le.errno!=20)throw le}p=ne}}return ne},createFile(p,m,C,O,L){var K=lt.join2(typeof p=="string"?p:R.getPath(p),m),ne=ye(O,L);return R.create(K,ne)},createDataFile(p,m,C,O,L,K){var ne=m;p&&(p=typeof p=="string"?p:R.getPath(p),ne=m?lt.join2(p,m):p);var le=ye(O,L),ge=R.create(ne,le);if(C){if(typeof C=="string"){for(var Ge=new Array(C.length),st=0,kt=C.length;st<kt;++st)Ge[st]=C.charCodeAt(st);C=Ge}R.chmod(ge,le|146);var xt=R.open(ge,577);R.write(xt,C,0,C.length,0,K),R.close(xt),R.chmod(ge,le)}},createDevice(p,m,C,O){var le;var L=lt.join2(typeof p=="string"?p:R.getPath(p),m),K=ye(!!C,!!O);(le=R.createDevice).major??(le.major=64);var ne=R.makedev(R.createDevice.major++,0);return R.registerDevice(ne,{open(ge){ge.seekable=!1},close(ge){var Ge;(Ge=O==null?void 0:O.buffer)!=null&&Ge.length&&O(10)},read(ge,Ge,st,kt,xt){for(var Je=0,dr=0;dr<kt;dr++){var Dr;try{Dr=C()}catch{throw new R.ErrnoError(29)}if(Dr===void 0&&Je===0)throw new R.ErrnoError(6);if(Dr==null)break;Je++,Ge[st+dr]=Dr}return Je&&(ge.node.atime=Date.now()),Je},write(ge,Ge,st,kt,xt){for(var Je=0;Je<kt;Je++)try{O(Ge[st+Je])}catch{throw new R.ErrnoError(29)}return kt&&(ge.node.mtime=ge.node.ctime=Date.now()),Je}}),R.mkdev(L,K,ne)},forceLoadFile(p){if(p.isDevice||p.isFolder||p.link||p.contents)return!0;if(globalThis.XMLHttpRequest)z("Lazy loading should have been performed (contents set) in createLazyFile, but it was not. Lazy loading only works in web workers. Use --embed-file or --preload-file in emcc on the main thread.");else try{p.contents=g(p.url)}catch{throw new R.ErrnoError(29)}},createLazyFile(p,m,C,O,L){class K{constructor(){Ht(this,"lengthKnown",!1);Ht(this,"chunks",[])}get(xt){if(!(xt>this.length-1||xt<0)){var Je=xt%this.chunkSize,dr=xt/this.chunkSize|0;return this.getter(dr)[Je]}}setDataGetter(xt){this.getter=xt}cacheLength(){var xt=new XMLHttpRequest;xt.open("HEAD",C,!1),xt.send(null),xt.status>=200&&xt.status<300||xt.status===304||z("Couldn't load "+C+". Status: "+xt.status);var Je=Number(xt.getResponseHeader("Content-length")),dr,Dr=(dr=xt.getResponseHeader("Accept-Ranges"))&&dr==="bytes",xn=(dr=xt.getResponseHeader("Content-Encoding"))&&dr==="gzip",Sn=1024*1024;Dr||(Sn=Je);var ba=(ai,to)=>{ai>to&&z("invalid range ("+ai+", "+to+") or no bytes requested!"),to>Je-1&&z("only "+Je+" bytes available! programmer error!");var Cn=new XMLHttpRequest;return Cn.open("GET",C,!1),Je!==Sn&&Cn.setRequestHeader("Range","bytes="+ai+"-"+to),Cn.responseType="arraybuffer",Cn.overrideMimeType&&Cn.overrideMimeType("text/plain; charset=x-user-defined"),Cn.send(null),Cn.status>=200&&Cn.status<300||Cn.status===304||z("Couldn't load "+C+". Status: "+Cn.status),Cn.response!==void 0?new Uint8Array(Cn.response||[]):or(Cn.responseText||"")},da=this;da.setDataGetter(ai=>{var to=ai*Sn,Cn=(ai+1)*Sn-1;return Cn=Math.min(Cn,Je-1),typeof da.chunks[ai]>"u"&&(da.chunks[ai]=ba(to,Cn)),typeof da.chunks[ai]>"u"&&z("doXHR failed!"),da.chunks[ai]}),(xn||!Je)&&(Sn=Je=1,Je=this.getter(0).length,Sn=Je,w("LazyFiles on gzip forces download of the whole file when length is accessed")),this._length=Je,this._chunkSize=Sn,this.lengthKnown=!0}get length(){return this.lengthKnown||this.cacheLength(),this._length}get chunkSize(){return this.lengthKnown||this.cacheLength(),this._chunkSize}}if(globalThis.XMLHttpRequest){a||z("Cannot do synchronous binary XHRs outside webworkers in modern browsers. Use --embed-file or --preload-file in emcc");var ne=new K,le={isDevice:!1,contents:ne}}else var le={isDevice:!1,url:C};var ge=R.createFile(p,m,le,O,L);le.contents?ge.contents=le.contents:le.url&&(ge.contents=null,ge.url=le.url),Object.defineProperties(ge,{usedBytes:{get:function(){return this.contents.length}}});var Ge={};for(const[kt,xt]of Object.entries(ge.stream_ops))Ge[kt]=(...Je)=>(R.forceLoadFile(ge),xt(...Je));function st(kt,xt,Je,dr,Dr){var xn=kt.node.contents;if(Dr>=xn.length)return 0;var Sn=Math.min(xn.length-Dr,dr);if(xn.slice)for(var ba=0;ba<Sn;ba++)xt[Je+ba]=xn[Dr+ba];else for(var ba=0;ba<Sn;ba++)xt[Je+ba]=xn.get(Dr+ba);return Sn}return Ge.read=(kt,xt,Je,dr,Dr)=>(R.forceLoadFile(ge),st(kt,xt,Je,dr,Dr)),Ge.mmap=(kt,xt,Je,dr,Dr)=>{R.forceLoadFile(ge);var xn=Te();if(!xn)throw new R.ErrnoError(48);return st(kt,k,xn,xt,Je),{ptr:xn,allocated:!0}},ge.stream_ops=Ge,ge}},sr={DEFAULT_POLLMASK:5,calculateAt(p,m,C){if(lt.isAbs(m))return m;var O;if(p===-100)O=R.cwd();else{var L=sr.getStreamFromFD(p);O=L.path}if(m.length==0){if(!C)throw new R.ErrnoError(44);return O}return O+"/"+m},writeStat(p,m){D[p>>>2>>>0]=m.dev,D[p+4>>>2>>>0]=m.mode,D[p+8>>>2>>>0]=m.nlink,D[p+12>>>2>>>0]=m.uid,D[p+16>>>2>>>0]=m.gid,D[p+20>>>2>>>0]=m.rdev,J[p+24>>>3>>>0]=BigInt(m.size),A[p+32>>>2>>>0]=4096,A[p+36>>>2>>>0]=m.blocks;var C=m.atime.getTime(),O=m.mtime.getTime(),L=m.ctime.getTime();return J[p+40>>>3>>>0]=BigInt(Math.floor(C/1e3)),D[p+48>>>2>>>0]=C%1e3*1e3*1e3,J[p+56>>>3>>>0]=BigInt(Math.floor(O/1e3)),D[p+64>>>2>>>0]=O%1e3*1e3*1e3,J[p+72>>>3>>>0]=BigInt(Math.floor(L/1e3)),D[p+80>>>2>>>0]=L%1e3*1e3*1e3,J[p+88>>>3>>>0]=BigInt(m.ino),0},writeStatFs(p,m){D[p+4>>>2>>>0]=m.bsize,D[p+60>>>2>>>0]=m.bsize,J[p+8>>>3>>>0]=BigInt(m.blocks),J[p+16>>>3>>>0]=BigInt(m.bfree),J[p+24>>>3>>>0]=BigInt(m.bavail),J[p+32>>>3>>>0]=BigInt(m.files),J[p+40>>>3>>>0]=BigInt(m.ffree),D[p+48>>>2>>>0]=m.fsid,D[p+64>>>2>>>0]=m.flags,D[p+56>>>2>>>0]=m.namelen},doMsync(p,m,C,O,L){if(!R.isFile(m.node.mode))throw new R.ErrnoError(43);if(O&2)return 0;var K=M.slice(p,p+C);R.msync(m,K,L,C,O)},getStreamFromFD(p){var m=R.getStreamChecked(p);return m},varargs:void 0,getStr(p){var m=Jt(p);return m}};function Fr(p,m,C){C>>>=0,sr.varargs=C;try{var O=sr.getStreamFromFD(p);switch(m){case 0:{var L=zt();if(L<0)return-28;for(;R.streams[L];)L++;var K;return K=R.dupStream(O,L),K.fd}case 1:case 2:return 0;case 3:return O.flags;case 4:{var L=zt();return O.flags|=L,0}case 12:{var L=Tr(),ne=0;return N[L+ne>>>1>>>0]=2,0}case 13:case 14:return 0}return-28}catch(le){if(typeof R>"u"||le.name!=="ErrnoError")throw le;return-le.errno}}function Me(p,m,C){C>>>=0,sr.varargs=C;try{var O=sr.getStreamFromFD(p);switch(m){case 21509:return O.tty?0:-59;case 21505:{if(!O.tty)return-59;if(O.tty.ops.ioctl_tcgets){var L=O.tty.ops.ioctl_tcgets(O),K=Tr();A[K>>>2>>>0]=L.c_iflag||0,A[K+4>>>2>>>0]=L.c_oflag||0,A[K+8>>>2>>>0]=L.c_cflag||0,A[K+12>>>2>>>0]=L.c_lflag||0;for(var ne=0;ne<32;ne++)k[K+ne+17>>>0]=L.c_cc[ne]||0;return 0}return 0}case 21510:case 21511:case 21512:return O.tty?0:-59;case 21506:case 21507:case 21508:{if(!O.tty)return-59;if(O.tty.ops.ioctl_tcsets){for(var K=Tr(),le=A[K>>>2>>>0],ge=A[K+4>>>2>>>0],Ge=A[K+8>>>2>>>0],st=A[K+12>>>2>>>0],kt=[],ne=0;ne<32;ne++)kt.push(k[K+ne+17>>>0]);return O.tty.ops.ioctl_tcsets(O.tty,m,{c_iflag:le,c_oflag:ge,c_cflag:Ge,c_lflag:st,c_cc:kt})}return 0}case 21519:{if(!O.tty)return-59;var K=Tr();return A[K>>>2>>>0]=0,0}case 21520:return O.tty?-28:-59;case 21537:case 21531:{var K=Tr();return R.ioctl(O,m,K)}case 21523:{if(!O.tty)return-59;if(O.tty.ops.ioctl_tiocgwinsz){var xt=O.tty.ops.ioctl_tiocgwinsz(O.tty),K=Tr();N[K>>>1>>>0]=xt[0],N[K+2>>>1>>>0]=xt[1]}return 0}case 21524:return O.tty?0:-59;case 21515:return O.tty?0:-59;default:return-28}}catch(Je){if(typeof R>"u"||Je.name!=="ErrnoError")throw Je;return-Je.errno}}function ut(p,m,C,O){m>>>=0,O>>>=0,sr.varargs=O;try{m=sr.getStr(m),m=sr.calculateAt(p,m);var L=O?zt():0;return R.open(m,C,L).fd}catch(K){if(typeof R>"u"||K.name!=="ErrnoError")throw K;return-K.errno}}function gt(p){p>>>=0;try{return p=sr.getStr(p),R.rmdir(p),0}catch(m){if(typeof R>"u"||m.name!=="ErrnoError")throw m;return-m.errno}}function yr(p,m,C){m>>>=0;try{if(m=sr.getStr(m),m=sr.calculateAt(p,m),!C)R.unlink(m);else if(C===512)R.rmdir(m);else return-28;return 0}catch(O){if(typeof R>"u"||O.name!=="ErrnoError")throw O;return-O.errno}}var lr=()=>z(""),et=p=>{p>>>=0;for(var m="";;){var C=M[p++>>>0];if(!C)return m;m+=String.fromCharCode(C)}},tr={},rr={},Dt={},Et=class extends Error{constructor(m){super(m),this.name="BindingError"}},_e=p=>{throw new Et(p)};function fr(p,m,C={}){var O=m.name;if(p||_e(`type "${O}" must have a positive integer typeid pointer`),rr.hasOwnProperty(p)){if(C.ignoreDuplicateRegistrations)return;_e(`Cannot register type '${O}' twice`)}if(rr[p]=m,delete Dt[p],tr.hasOwnProperty(p)){var L=tr[p];delete tr[p],L.forEach(K=>K())}}function F(p,m,C={}){return fr(p,m,C)}var Oe=(p,m,C)=>{switch(m){case 1:return C?O=>k[O>>>0]:O=>M[O>>>0];case 2:return C?O=>N[O>>>1>>>0]:O=>T[O>>>1>>>0];case 4:return C?O=>A[O>>>2>>>0]:O=>D[O>>>2>>>0];case 8:return C?O=>J[O>>>3>>>0]:O=>W[O>>>3>>>0];default:throw new TypeError(`invalid integer width (${m}): ${p}`)}},Ie=function(p,m,C,O,L){p>>>=0,m>>>=0,C>>>=0,m=et(m);const K=O===0n;let ne=le=>le;if(K){const le=C*8;ne=ge=>BigInt.asUintN(le,ge),L=ne(L)}F(p,{name:m,fromWireType:ne,toWireType:(le,ge)=>(typeof ge=="number"&&(ge=BigInt(ge)),ge),readValueFromPointer:Oe(m,C,!K),destructorFunction:null})};function Tt(p,m,C,O){p>>>=0,m>>>=0,m=et(m),F(p,{name:m,fromWireType:function(L){return!!L},toWireType:function(L,K){return K?C:O},readValueFromPointer:function(L){return this.fromWireType(M[L>>>0])},destructorFunction:null})}var Ve=p=>({count:p.count,deleteScheduled:p.deleteScheduled,preservePointerOnDelete:p.preservePointerOnDelete,ptr:p.ptr,ptrType:p.ptrType,smartPtr:p.smartPtr,smartPtrType:p.smartPtrType}),pt=p=>{function m(C){return C.$$.ptrType.registeredClass.name}_e(m(p)+" instance already deleted")},Ye=!1,Wt=p=>{},Ir=p=>{p.smartPtr?p.smartPtrType.rawDestructor(p.smartPtr):p.ptrType.registeredClass.rawDestructor(p.ptr)},Qr=p=>{p.count.value-=1;var m=p.count.value===0;m&&Ir(p)},Kt=p=>globalThis.FinalizationRegistry?(Ye=new FinalizationRegistry(m=>{Qr(m.$$)}),Kt=m=>{var C=m.$$,O=!!C.smartPtr;if(O){var L={$$:C};Ye.register(m,L,m)}return m},Wt=m=>Ye.unregister(m),Kt(p)):(Kt=m=>m,p),Pn=()=>{let p=qr.prototype;Object.assign(p,{isAliasOf(C){if(!(this instanceof qr)||!(C instanceof qr))return!1;var O=this.$$.ptrType.registeredClass,L=this.$$.ptr;C.$$=C.$$;for(var K=C.$$.ptrType.registeredClass,ne=C.$$.ptr;O.baseClass;)L=O.upcast(L),O=O.baseClass;for(;K.baseClass;)ne=K.upcast(ne),K=K.baseClass;return O===K&&L===ne},clone(){if(this.$$.ptr||pt(this),this.$$.preservePointerOnDelete)return this.$$.count.value+=1,this;var C=Kt(Object.create(Object.getPrototypeOf(this),{$$:{value:Ve(this.$$)}}));return C.$$.count.value+=1,C.$$.deleteScheduled=!1,C},delete(){this.$$.ptr||pt(this),this.$$.deleteScheduled&&!this.$$.preservePointerOnDelete&&_e("Object already scheduled for deletion"),Wt(this),Qr(this.$$),this.$$.preservePointerOnDelete||(this.$$.smartPtr=void 0,this.$$.ptr=void 0)},isDeleted(){return!this.$$.ptr},deleteLater(){return this.$$.ptr||pt(this),this.$$.deleteScheduled&&!this.$$.preservePointerOnDelete&&_e("Object already scheduled for deletion"),this.$$.deleteScheduled=!0,this}});const m=Symbol.dispose;m&&(p[m]=p.delete)};function qr(){}var Xr=(p,m)=>Object.defineProperty(m,"name",{value:p}),cr={},nr=(p,m,C)=>{if(p[m].overloadTable===void 0){var O=p[m];p[m]=function(...L){return p[m].overloadTable.hasOwnProperty(L.length)||_e(`Function '${C}' called with an invalid number of arguments (${L.length}) - expects one of (${p[m].overloadTable})!`),p[m].overloadTable[L.length].apply(this,L)},p[m].overloadTable=[],p[m].overloadTable[O.argCount]=O}},Ar=(p,m,C)=>{r.hasOwnProperty(p)?(_e(`Cannot register public name '${p}' twice`),nr(r,p,p),r[p].overloadTable.hasOwnProperty(C)&&_e(`Cannot register multiple overloads of a function with the same number of arguments (${C})!`),r[p].overloadTable[C]=m):(r[p]=m,r[p].argCount=C)},qe=48,hr=57,fn=p=>{p=p.replace(/[^a-zA-Z0-9_]/g,"$");var m=p.charCodeAt(0);return m>=qe&&m<=hr?`_${p}`:p};function Ln(p,m,C,O,L,K,ne,le){this.name=p,this.constructor=m,this.instancePrototype=C,this.rawDestructor=O,this.baseClass=L,this.getActualType=K,this.upcast=ne,this.downcast=le,this.pureVirtualFunctions=[]}var Zn=(p,m,C)=>{for(;m!==C;)m.upcast||_e(`Expected null or instance of ${C.name}, got an instance of ${m.name}`),p=m.upcast(p),m=m.baseClass;return p},Tn=p=>{if(p===null)return"null";var m=typeof p;return m==="object"||m==="array"||m==="function"?p.toString():""+p};function Oi(p,m){if(m===null)return this.isReference&&_e(`null is not a valid ${this.name}`),0;m.$$||_e(`Cannot pass "${Tn(m)}" as a ${this.name}`),m.$$.ptr||_e(`Cannot pass deleted object as a pointer of type ${this.name}`);var C=m.$$.ptrType.registeredClass,O=Zn(m.$$.ptr,C,this.registeredClass);return O}function ue(p,m){var C;if(m===null)return this.isReference&&_e(`null is not a valid ${this.name}`),this.isSmartPointer?(C=this.rawConstructor(),p!==null&&p.push(this.rawDestructor,C),C):0;(!m||!m.$$)&&_e(`Cannot pass "${Tn(m)}" as a ${this.name}`),m.$$.ptr||_e(`Cannot pass deleted object as a pointer of type ${this.name}`),!this.isConst&&m.$$.ptrType.isConst&&_e(`Cannot convert argument of type ${m.$$.smartPtrType?m.$$.smartPtrType.name:m.$$.ptrType.name} to parameter type ${this.name}`);var O=m.$$.ptrType.registeredClass;if(C=Zn(m.$$.ptr,O,this.registeredClass),this.isSmartPointer)switch(m.$$.smartPtr===void 0&&_e("Passing raw pointer to smart pointer is illegal"),this.sharingPolicy){case 0:m.$$.smartPtrType===this?C=m.$$.smartPtr:_e(`Cannot convert argument of type ${m.$$.smartPtrType?m.$$.smartPtrType.name:m.$$.ptrType.name} to parameter type ${this.name}`);break;case 1:C=m.$$.smartPtr;break;case 2:if(m.$$.smartPtrType===this)C=m.$$.smartPtr;else{var L=m.clone();C=this.rawShare(C,tn.toHandle(()=>L.delete())),p!==null&&p.push(this.rawDestructor,C)}break;default:_e("Unsupporting sharing policy")}return C}function ve(p,m){if(m===null)return this.isReference&&_e(`null is not a valid ${this.name}`),0;m.$$||_e(`Cannot pass "${Tn(m)}" as a ${this.name}`),m.$$.ptr||_e(`Cannot pass deleted object as a pointer of type ${this.name}`),m.$$.ptrType.isConst&&_e(`Cannot convert argument of type ${m.$$.ptrType.name} to parameter type ${this.name}`);var C=m.$$.ptrType.registeredClass,O=Zn(m.$$.ptr,C,this.registeredClass);return O}function be(p){return this.fromWireType(D[p>>>2>>>0])}var ae=(p,m,C)=>{if(m===C)return p;if(C.baseClass===void 0)return null;var O=ae(p,m,C.baseClass);return O===null?null:C.downcast(O)},$e={},mt=(p,m)=>{for(m===void 0&&_e("ptr should not be undefined");p.baseClass;)m=p.upcast(m),p=p.baseClass;return m},bt=(p,m)=>(m=mt(p,m),$e[m]),Ot=class extends Error{constructor(m){super(m),this.name="InternalError"}},Bt=p=>{throw new Ot(p)},At=(p,m)=>{(!m.ptrType||!m.ptr)&&Bt("makeClassHandle requires ptr and ptrType");var C=!!m.smartPtrType,O=!!m.smartPtr;return C!==O&&Bt("Both smartPtrType and smartPtr must be specified"),m.count={value:1},Kt(Object.create(p,{$$:{value:m,writable:!0}}))};function Kr(p){var m=this.getPointee(p);if(!m)return this.destructor(p),null;var C=bt(this.registeredClass,m);if(C!==void 0){if(C.$$.count.value===0)return C.$$.ptr=m,C.$$.smartPtr=p,C.clone();var O=C.clone();return this.destructor(p),O}function L(){return this.isSmartPointer?At(this.registeredClass.instancePrototype,{ptrType:this.pointeeType,ptr:m,smartPtrType:this,smartPtr:p}):At(this.registeredClass.instancePrototype,{ptrType:this,ptr:p})}var K=this.registeredClass.getActualType(m),ne=cr[K];if(!ne)return L.call(this);var le;this.isConst?le=ne.constPointerType:le=ne.pointerType;var ge=ae(m,this.registeredClass,le.registeredClass);return ge===null?L.call(this):this.isSmartPointer?At(le.registeredClass.instancePrototype,{ptrType:le,ptr:ge,smartPtrType:this,smartPtr:p}):At(le.registeredClass.instancePrototype,{ptrType:le,ptr:ge})}var jr=()=>{Object.assign(Er.prototype,{getPointee(p){return this.rawGetPointee&&(p=this.rawGetPointee(p)),p},destructor(p){var m;(m=this.rawDestructor)==null||m.call(this,p)},readValueFromPointer:be,fromWireType:Kr})};function Er(p,m,C,O,L,K,ne,le,ge,Ge,st){this.name=p,this.registeredClass=m,this.isReference=C,this.isConst=O,this.isSmartPointer=L,this.pointeeType=K,this.sharingPolicy=ne,this.rawGetPointee=le,this.rawConstructor=ge,this.rawShare=Ge,this.rawDestructor=st,!L&&m.baseClass===void 0?O?(this.toWireType=Oi,this.destructorFunction=null):(this.toWireType=ve,this.destructorFunction=null):this.toWireType=ue}var Rr=(p,m,C)=>{r.hasOwnProperty(p)||Bt("Replacing nonexistent public symbol"),r[p].overloadTable!==void 0&&C!==void 0||(r[p]=m,r[p].argCount=C)},De=[],Mt=p=>{var m=De[p];return m||(De[p]=m=Ei.get(p)),m},wt=(p,m,C=[],O=!1)=>{var L=Mt(m),K=L(...C);function ne(le){return p[0]=="p"?le>>>0:le}return ne(K)},Wr=(p,m,C=!1)=>(...O)=>wt(p,m,O,C),xr=(p,m,C=!1)=>{p=et(p);function O(){if(p.includes("p"))return Wr(p,m,C);var K=Mt(m);return K}var L=O();return typeof L!="function"&&_e(`unknown function pointer with signature ${p}: ${m}`),L};class Jn extends Error{}var Cr=p=>{var m=Zr(p),C=et(m);return on(m),C},en=(p,m)=>{var C=[],O={};function L(K){if(!O[K]&&!rr[K]){if(Dt[K]){Dt[K].forEach(L);return}C.push(K),O[K]=!0}}throw m.forEach(L),new Jn(`${p}: `+C.map(Cr).join([", "]))},yn=(p,m,C)=>{p.forEach(le=>Dt[le]=m);function O(le){var ge=C(le);ge.length!==p.length&&Bt("Mismatched type converter count");for(var Ge=0;Ge<p.length;++Ge)F(p[Ge],ge[Ge])}var L=new Array(m.length),K=[],ne=0;for(let[le,ge]of m.entries())rr.hasOwnProperty(ge)?L[le]=rr[ge]:(K.push(ge),tr.hasOwnProperty(ge)||(tr[ge]=[]),tr[ge].push(()=>{L[le]=rr[ge],++ne,ne===K.length&&O(L)}));K.length===0&&O(L)};function mi(p,m,C,O,L,K,ne,le,ge,Ge,st,kt,xt){p>>>=0,m>>>=0,C>>>=0,O>>>=0,L>>>=0,K>>>=0,ne>>>=0,le>>>=0,ge>>>=0,Ge>>>=0,st>>>=0,kt>>>=0,xt>>>=0,st=et(st),K=xr(L,K),le&&(le=xr(ne,le)),Ge&&(Ge=xr(ge,Ge)),xt=xr(kt,xt);var Je=fn(st);Ar(Je,function(){en(`Cannot construct ${st} due to unbound types`,[O])}),yn([p,m,C],O?[O]:[],dr=>{var V0;dr=dr[0];var Dr,xn;O?(Dr=dr.registeredClass,xn=Dr.instancePrototype):xn=qr.prototype;var Sn=Xr(st,function(...Ic){if(Object.getPrototypeOf(this)!==ba)throw new Et(`Use 'new' to construct ${st}`);if(da.constructor_body===void 0)throw new Et(`${st} has no accessible constructor`);var H0=da.constructor_body[Ic.length];if(H0===void 0)throw new Et(`Tried to invoke ctor of ${st} with invalid number of parameters (${Ic.length}) - expected (${Object.keys(da.constructor_body).toString()}) parameters instead!`);return H0.apply(this,Ic)}),ba=Object.create(xn,{constructor:{value:Sn}});Sn.prototype=ba;var da=new Ln(st,Sn,ba,xt,Dr,K,le,Ge);da.baseClass&&((V0=da.baseClass).__derivedClasses??(V0.__derivedClasses=[]),da.baseClass.__derivedClasses.push(da));var ai=new Er(st,da,!0,!1,!1),to=new Er(st+"*",da,!1,!1,!1),Cn=new Er(st+" const*",da,!1,!0,!1);return cr[p]={pointerType:to,constPointerType:Cn},Rr(Je,Sn),[ai,to,Cn]})}var qi=(p,m)=>{for(var C=[],O=0;O<p;O++)C.push(D[m+O*4>>>2>>>0]);return C},bs=p=>{for(;p.length;){var m=p.pop(),C=p.pop();C(m)}};function xa(p){for(var m=1;m<p.length;++m)if(p[m]!==null&&p[m].destructorFunction===void 0)return!0;return!1}function Zi(p,m,C,O){var L=xa(p),K=p.length-2,ne=[],le=["fn"];m&&le.push("thisWired");for(var ge=0;ge<K;++ge)ne.push(`arg${ge}`),le.push(`arg${ge}Wired`);ne=ne.join(","),le=le.join(",");var Ge=`return function (${ne}) {
`;L&&(Ge+=`var destructors = [];
`);var st=L?"destructors":"null",kt=["humanName","throwBindingError","invoker","fn","runDestructors","fromRetWire","toClassParamWire"];m&&(Ge+=`var thisWired = toClassParamWire(${st}, this);
`);for(var ge=0;ge<K;++ge){var xt=`toArg${ge}Wire`;Ge+=`var arg${ge}Wired = ${xt}(${st}, arg${ge});
`,kt.push(xt)}if(Ge+=(C||O?"var rv = ":"")+`invoker(${le});
`,L)Ge+=`runDestructors(destructors);
`;else for(var ge=m?1:2;ge<p.length;++ge){var Je=ge===1?"thisWired":"arg"+(ge-2)+"Wired";p[ge].destructorFunction!==null&&(Ge+=`${Je}_dtor(${Je});
`,kt.push(`${Je}_dtor`))}return C&&(Ge+=`var ret = fromRetWire(rv);
return ret;
`),Ge+=`}
`,new Function(kt,Ge)}function yi(p,m,C,O,L,K){var ne=m.length;ne<2&&_e("argTypes array size mismatch! Must at least get return value and 'this' types!");for(var le=m[1]!==null&&C!==null,ge=xa(m),Ge=!m[0].isVoid,st=m[0],kt=m[1],xt=[p,_e,O,L,bs,st.fromWireType.bind(st),kt==null?void 0:kt.toWireType.bind(kt)],Je=2;Je<ne;++Je){var dr=m[Je];xt.push(dr.toWireType.bind(dr))}if(!ge)for(var Je=le?1:2;Je<m.length;++Je)m[Je].destructorFunction!==null&&xt.push(m[Je].destructorFunction);var xn=Zi(m,le,Ge,K)(...xt);return Xr(p,xn)}var In=function(p,m,C,O,L,K){p>>>=0,C>>>=0,O>>>=0,L>>>=0,K>>>=0;var ne=qi(m,C);L=xr(O,L),yn([],[p],le=>{le=le[0];var ge=`constructor ${le.name}`;if(le.registeredClass.constructor_body===void 0&&(le.registeredClass.constructor_body=[]),le.registeredClass.constructor_body[m-1]!==void 0)throw new Et(`Cannot register multiple constructors with identical number of parameters (${m-1}) for class '${le.name}'! Overload resolution is currently only performed using the parameter count, not actual type info!`);return le.registeredClass.constructor_body[m-1]=()=>{en(`Cannot construct ${le.name} due to unbound types`,ne)},yn([],ne,Ge=>(Ge.splice(1,0,null),le.registeredClass.constructor_body[m-1]=yi(ge,Ge,null,L,K),[])),[]})},Qa=p=>{p=p.trim();const m=p.indexOf("(");return m===-1?p:p.slice(0,m)},So=function(p,m,C,O,L,K,ne,le,ge,Ge){p>>>=0,m>>>=0,O>>>=0,L>>>=0,K>>>=0,ne>>>=0;var st=qi(C,O);m=et(m),m=Qa(m),K=xr(L,K,ge),yn([],[p],kt=>{kt=kt[0];var xt=`${kt.name}.${m}`;m.startsWith("@@")&&(m=Symbol[m.substring(2)]),le&&kt.registeredClass.pureVirtualFunctions.push(m);function Je(){en(`Cannot call ${xt} due to unbound types`,st)}var dr=kt.registeredClass.instancePrototype,Dr=dr[m];return Dr===void 0||Dr.overloadTable===void 0&&Dr.className!==kt.name&&Dr.argCount===C-2?(Je.argCount=C-2,Je.className=kt.name,dr[m]=Je):(nr(dr,m,xt),dr[m].overloadTable[C-2]=Je),yn([],st,xn=>{var Sn=yi(xt,xn,kt,K,ne,ge);return dr[m].overloadTable===void 0?(Sn.argCount=C-2,dr[m]=Sn):dr[m].overloadTable[C-2]=Sn,[]}),[]})},ei=[],ti=[0,1,,1,null,1,!0,1,!1,1];function La(p){p>>>=0,p>9&&--ti[p+1]===0&&(ti[p]=void 0,ei.push(p))}var tn={toValue:p=>(p||_e(`Cannot use deleted val. handle = ${p}`),ti[p]),toHandle:p=>{switch(p){case void 0:return 2;case null:return 4;case!0:return 6;case!1:return 8;default:{const m=ei.pop()||ti.length;return ti[m]=p,ti[m+1]=1,m}}}},Ca={name:"emscripten::val",fromWireType:p=>{var m=tn.toValue(p);return La(p),m},toWireType:(p,m)=>tn.toHandle(m),readValueFromPointer:be,destructorFunction:null};function ws(p){return p>>>=0,F(p,Ca)}var Ma=(p,m)=>{switch(m){case 4:return function(C){return this.fromWireType($[C>>>2>>>0])};case 8:return function(C){return this.fromWireType(B[C>>>3>>>0])};default:throw new TypeError(`invalid float width (${m}): ${p}`)}},rt=function(p,m,C){p>>>=0,m>>>=0,C>>>=0,m=et(m),F(p,{name:m,fromWireType:O=>O,toWireType:(O,L)=>L,readValueFromPointer:Ma(m,C),destructorFunction:null})},Yt=function(p,m,C,O,L){p>>>=0,m>>>=0,C>>>=0,m=et(m);const K=O===0;let ne=ge=>ge;if(K){var le=32-8*C;ne=ge=>ge<<le>>>le,L=ne(L)}F(p,{name:m,fromWireType:ne,toWireType:(ge,Ge)=>Ge,readValueFromPointer:Oe(m,C,O!==0),destructorFunction:null})};function Vt(p,m,C){p>>>=0,C>>>=0;var O=[Int8Array,Uint8Array,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array,BigInt64Array,BigUint64Array],L=O[m];function K(ne){var le=D[ne>>>2>>>0],ge=D[ne+4>>>2>>>0];return new L(k.buffer,ge,le)}C=et(C),F(p,{name:C,fromWireType:K,readValueFromPointer:K},{ignoreDuplicateRegistrations:!0})}var Gt=Object.assign({optional:!0},Ca);function Qn(p,m){p>>>=0,F(p,Gt)}var cn=(p,m,C)=>Or(p,M,m,C);function ua(p,m){p>>>=0,m>>>=0,m=et(m),F(p,{name:m,fromWireType(C){var O=D[C>>>2>>>0],L=C+4,K;return K=Jt(L,O,!0),on(C),K},toWireType(C,O){O instanceof ArrayBuffer&&(O=new Uint8Array(O));var L,K=typeof O=="string";K||ArrayBuffer.isView(O)&&O.BYTES_PER_ELEMENT==1||_e("Cannot pass non-string to std::string"),K?L=zr(O):L=O.length;var ne=Mr(4+L+1),le=ne+4;return D[ne>>>2>>>0]=L,K?cn(O,le,L+1):M.set(O,le>>>0),C!==null&&C.push(on,ne),ne},readValueFromPointer:be,destructorFunction(C){on(C)}})}var ri=globalThis.TextDecoder?new TextDecoder("utf-16le"):void 0,Bn=(p,m,C)=>{var O=p>>>1,L=ht(T,O,m/2,C);if(L-O>16&&ri)return ri.decode(T.subarray(O>>>0,L>>>0));for(var K="",ne=O;ne<L;++ne){var le=T[ne>>>0];K+=String.fromCharCode(le)}return K},Na=(p,m,C)=>{if(C??(C=2147483647),C<2)return 0;C-=2;for(var O=m,L=C<p.length*2?C/2:p.length,K=0;K<L;++K){var ne=p.charCodeAt(K);N[m>>>1>>>0]=ne,m+=2}return N[m>>>1>>>0]=0,m-O},an=p=>p.length*2,Vo=(p,m,C)=>{for(var O="",L=p>>>2,K=0;!(K>=m/4);K++){var ne=D[L+K>>>0];if(!ne&&!C)break;O+=String.fromCodePoint(ne)}return O},_t=(p,m,C)=>{if(m>>>=0,C??(C=2147483647),C<4)return 0;for(var O=m,L=O+C-4,K=0;K<p.length;++K){var ne=p.codePointAt(K);if(ne>65535&&K++,A[m>>>2>>>0]=ne,m+=4,m+4>L)break}return A[m>>>2>>>0]=0,m-O},Ji=p=>{for(var m=0,C=0;C<p.length;++C){var O=p.codePointAt(C);O>65535&&C++,m+=4}return m};function It(p,m,C){p>>>=0,m>>>=0,C>>>=0,C=et(C);var O,L,K;m===2?(O=Bn,L=Na,K=an):(O=Vo,L=_t,K=Ji),F(p,{name:C,fromWireType:ne=>{var le=D[ne>>>2>>>0],ge=O(ne+4,le*m,!0);return on(ne),ge},toWireType:(ne,le)=>{typeof le!="string"&&_e(`Cannot pass non-string to C++ string type ${C}`);var ge=K(le),Ge=Mr(4+ge+m);return D[Ge>>>2>>>0]=ge/m,L(le,Ge+4,ge+m),ne!==null&&ne.push(on,Ge),Ge},readValueFromPointer:be,destructorFunction(ne){on(ne)}})}var Qi=function(p,m){p>>>=0,m>>>=0,m=et(m),F(p,{isVoid:!0,name:m,fromWireType:()=>{},toWireType:(C,O)=>{}})},_o=()=>{throw 1/0},ni=[],ks=p=>{var m=ni.length;return ni.push(p),m},Ss=(p,m)=>{var C=rr[p];return C===void 0&&_e(`${m} has unknown type ${Cr(p)}`),C},vd=(p,m)=>{for(var C=new Array(p),O=0;O<p;++O)C[O]=Ss(D[m+O*4>>>2>>>0],`parameter ${O}`);return C},Ml=(p,m,C)=>{var O=[],L=p(O,C);return O.length&&(D[m>>>2>>>0]=tn.toHandle(O)),L},zn={},_s=p=>{var m=zn[p];return m===void 0?et(p):m},js=function(p,m,C){m>>>=0;var O=8,[L,...K]=vd(p,m),ne=L.toWireType.bind(L),le=K.map(Je=>Je.readValueFromPointer.bind(Je));p--;var ge={toValue:tn.toValue},Ge=le.map((Je,dr)=>{var Dr=`argFromPtr${dr}`;return ge[Dr]=Je,`${Dr}(args${dr?"+"+dr*O:""})`}),st;switch(C){case 0:st="toValue(handle)";break;case 2:st="new (toValue(handle))";break;case 3:st="";break;case 1:ge.getStringOrSymbol=_s,st="toValue(handle)[getStringOrSymbol(methodName)]";break}st+=`(${Ge})`,L.isVoid||(ge.toReturnWire=ne,ge.emval_returnValue=Ml,st=`return emval_returnValue(toReturnWire, destructorsRef, ${st})`),st=`return function (handle, methodName, destructorsRef, args) {
  ${st}
  }`;var kt=new Function(Object.keys(ge),st)(...Object.values(ge)),xt=`methodCaller<(${K.map(Je=>Je.name)}) => ${L.name}>`;return ks(Xr(xt,kt))};function Cc(p){return p>>>=0,p?(p=_s(p),tn.toHandle(globalThis[p])):tn.toHandle(globalThis)}function Ps(p,m){return p>>>=0,m>>>=0,p=tn.toValue(p),m=tn.toValue(m),tn.toHandle(p[m])}function Mc(p){p>>>=0,p>9&&(ti[p+1]+=1)}function xi(p,m){return p>>>=0,m>>>=0,p=tn.toValue(p),m=tn.toValue(m),p instanceof m}function Ba(p,m,C,O,L){return p>>>=0,m>>>=0,C>>>=0,O>>>=0,L>>>=0,ni[p](m,C,O,L)}function Fa(){return tn.toHandle([])}function Cs(p){return p>>>=0,tn.toHandle(_s(p))}function bd(){return tn.toHandle({})}function wd(p){p>>>=0;var m=tn.toValue(p);bs(m),La(p)}function Nc(p,m,C){p>>>=0,m>>>=0,C>>>=0,p=tn.toValue(p),m=tn.toValue(m),C=tn.toValue(C),p[m]=C}function Ho(p){return p>>>=0,p=tn.toValue(p),tn.toHandle(typeof p)}function jo(p,m){p=se(p),m>>>=0;var C=new Date(p*1e3);A[m>>>2>>>0]=C.getUTCSeconds(),A[m+4>>>2>>>0]=C.getUTCMinutes(),A[m+8>>>2>>>0]=C.getUTCHours(),A[m+12>>>2>>>0]=C.getUTCDate(),A[m+16>>>2>>>0]=C.getUTCMonth(),A[m+20>>>2>>>0]=C.getUTCFullYear()-1900,A[m+24>>>2>>>0]=C.getUTCDay();var O=Date.UTC(C.getUTCFullYear(),0,1,0,0,0,0),L=(C.getTime()-O)/(1e3*60*60*24)|0;A[m+28>>>2>>>0]=L}var Ms=p=>p%4===0&&(p%100!==0||p%400===0),kd=[0,31,60,91,121,152,182,213,244,274,305,335],vt=[0,31,59,90,120,151,181,212,243,273,304,334],Oc=p=>{var m=Ms(p.getFullYear()),C=m?kd:vt,O=C[p.getMonth()]+p.getDate()-1;return O};function Sd(p,m){p=se(p),m>>>=0;var C=new Date(p*1e3);A[m>>>2>>>0]=C.getSeconds(),A[m+4>>>2>>>0]=C.getMinutes(),A[m+8>>>2>>>0]=C.getHours(),A[m+12>>>2>>>0]=C.getDate(),A[m+16>>>2>>>0]=C.getMonth(),A[m+20>>>2>>>0]=C.getFullYear()-1900,A[m+24>>>2>>>0]=C.getDay();var O=Oc(C)|0;A[m+28>>>2>>>0]=O,A[m+36>>>2>>>0]=-(C.getTimezoneOffset()*60);var L=new Date(C.getFullYear(),0,1),K=new Date(C.getFullYear(),6,1).getTimezoneOffset(),ne=L.getTimezoneOffset(),le=(K!=ne&&C.getTimezoneOffset()==Math.min(ne,K))|0;A[m+32>>>2>>>0]=le}var Po=function(p){p>>>=0;var m=(()=>{var C=new Date(A[p+20>>>2>>>0]+1900,A[p+16>>>2>>>0],A[p+12>>>2>>>0],A[p+8>>>2>>>0],A[p+4>>>2>>>0],A[p>>>2>>>0],0),O=A[p+32>>>2>>>0],L=C.getTimezoneOffset(),K=new Date(C.getFullYear(),0,1),ne=new Date(C.getFullYear(),6,1).getTimezoneOffset(),le=K.getTimezoneOffset(),ge=Math.min(le,ne);if(O<0)A[p+32>>>2>>>0]=+(ne!=le&&ge==L);else if(O>0!=(ge==L)){var Ge=Math.max(le,ne),st=O>0?ge:Ge;C.setTime(C.getTime()+(st-L)*6e4)}A[p+24>>>2>>>0]=C.getDay();var kt=Oc(C)|0;A[p+28>>>2>>>0]=kt,A[p>>>2>>>0]=C.getSeconds(),A[p+4>>>2>>>0]=C.getMinutes(),A[p+8>>>2>>>0]=C.getHours(),A[p+12>>>2>>>0]=C.getDate(),A[p+16>>>2>>>0]=C.getMonth(),A[p+20>>>2>>>0]=C.getYear();var xt=C.getTime();return isNaN(xt)?-1:xt/1e3})();return BigInt(m)},Ns=function(p,m,C,O){p>>>=0,m>>>=0,C>>>=0,O>>>=0;var L=new Date().getFullYear(),K=new Date(L,0,1),ne=new Date(L,6,1),le=K.getTimezoneOffset(),ge=ne.getTimezoneOffset(),Ge=Math.max(le,ge);D[p>>>2>>>0]=Ge*60,A[m>>>2>>>0]=+(le!=ge);var st=Je=>{var dr=Je>=0?"-":"+",Dr=Math.abs(Je),xn=String(Math.floor(Dr/60)).padStart(2,"0"),Sn=String(Dr%60).padStart(2,"0");return`UTC${dr}${xn}${Sn}`},kt=st(le),xt=st(ge);ge<le?(cn(kt,C,17),cn(xt,O,17)):(cn(kt,O,17),cn(xt,C,17))},Os=()=>Date.now(),_d=()=>4294901760,jd=(p,m)=>Math.ceil(p/m)*m,Pd=p=>{var m=vi.buffer.byteLength,C=(p-m+65535)/65536|0;try{return vi.grow(C),G(),1}catch{}};function Cd(p){p>>>=0;var m=M.length,C=_d();if(p>C)return!1;for(var O=1;O<=4;O*=2){var L=m*(1+.2/O);L=Math.min(L,p+100663296);var K=Math.min(C,jd(Math.max(p,L),65536)),ne=Pd(K);if(ne)return!0}return!1}var Nl={},Md=()=>s||"./this.program",Xo=()=>{if(!Xo.strings){var p=(typeof navigator=="object"&&navigator.language||"C").replace("-","_")+".UTF-8",m={USER:"web_user",LOGNAME:"web_user",PATH:"/",PWD:"/",HOME:"/home/web_user",LANG:p,_:Md()};for(var C in Nl)Nl[C]===void 0?delete m[C]:m[C]=Nl[C];var O=[];for(var C in m)O.push(`${C}=${m[C]}`);Xo.strings=O}return Xo.strings};function eo(p,m){p>>>=0,m>>>=0;var C=0,O=0;for(var L of Xo()){var K=m+C;D[p+O>>>2>>>0]=K,C+=cn(L,K,1/0)+1,O+=4}return 0}function Nd(p,m){p>>>=0,m>>>=0;var C=Xo();D[p>>>2>>>0]=C.length;var O=0;for(var L of C)O+=zr(L)+1;return D[m>>>2>>>0]=O,0}var Od=0,Ad=()=>Se||Od>0,Ed=p=>{var m;Ad()||((m=r.onExit)==null||m.call(r,p),y=!0),l(p,new de(p))},Td=(p,m)=>{Ed(p)},Ac=Td;function Ec(p){try{var m=sr.getStreamFromFD(p);return R.close(m),0}catch(C){if(typeof R>"u"||C.name!=="ErrnoError")throw C;return C.errno}}var Tc=(p,m,C,O)=>{for(var L=0,K=0;K<C;K++){var ne=D[m>>>2>>>0],le=D[m+4>>>2>>>0];m+=8;var ge=R.read(p,k,ne,le,O);if(ge<0)return-1;if(L+=ge,ge<le)break}return L};function Y(p,m,C,O){m>>>=0,C>>>=0,O>>>=0;try{var L=sr.getStreamFromFD(p),K=Tc(L,m,C);return D[O>>>2>>>0]=K,0}catch(ne){if(typeof R>"u"||ne.name!=="ErrnoError")throw ne;return ne.errno}}function Pe(p,m,C,O){m=se(m),O>>>=0;try{if(isNaN(m))return 61;var L=sr.getStreamFromFD(p);return R.llseek(L,m,C),J[O>>>3>>>0]=BigInt(L.position),L.getdents&&m===0&&C===0&&(L.getdents=null),0}catch(K){if(typeof R>"u"||K.name!=="ErrnoError")throw K;return K.errno}}var yt=(p,m,C,O)=>{for(var L=0,K=0;K<C;K++){var ne=D[m>>>2>>>0],le=D[m+4>>>2>>>0];m+=8;var ge=R.write(p,k,ne,le,O);if(ge<0)return-1;if(L+=ge,ge<le)break}return L};function ur(p,m,C,O){m>>>=0,C>>>=0,O>>>=0;try{var L=sr.getStreamFromFD(p),K=yt(L,m,C);return D[O>>>2>>>0]=K,0}catch(ne){if(typeof R>"u"||ne.name!=="ErrnoError")throw ne;return ne.errno}}if(R.createPreloadedFile=mr,R.preloadFile=jt,R.staticInit(),Pn(),jr(),r.noExitRuntime&&(Se=r.noExitRuntime),r.preloadPlugins&&(gr=r.preloadPlugins),r.print&&(w=r.print),r.printErr&&(b=r.printErr),r.wasmBinary&&(x=r.wasmBinary),r.arguments&&r.arguments,r.thisProgram&&(s=r.thisProgram),r.preInit)for(typeof r.preInit=="function"&&(r.preInit=[r.preInit]);r.preInit.length>0;)r.preInit.shift()();var Zr,on,Mr,hn,Ai,Ua,vi,Ei;function va(p){Zr=p.ea,on=p.fa,Mr=p.ga,hn=p.ia,Ai=p.ja,Ua=p.ka,vi=p.ca,Ei=p.ha}var Id={g:Ut,b:ir,A:Fr,V:Me,W:ut,L:gt,M:yr,J:lr,C:Ie,aa:Tt,F:mi,E:In,o:So,_:ws,B:rt,p:Yt,m:Vt,X:Qn,$:ua,x:It,ba:Qi,H:_o,f:js,a:La,q:Cc,i:Ps,j:Mc,D:xi,e:Ba,k:Fa,c:Cs,l:bd,d:wd,h:Nc,t:Ho,N:jo,O:Sd,P:Po,Q:Ns,Y:Os,K:Cd,S:eo,T:Nd,Z:Ac,y:Ec,U:Y,R:Pe,z:ur,G:qm,u:Ym,n:Hm,s:Xm,v:Vm,I:Wm,r:Km,w:Rd};function Wm(p){var m=Re();try{Mt(p)()}catch(C){if(we(m),C!==C+0)throw C;hn(1,0)}}function Vm(p,m){var C=Re();try{return Mt(p)(m)}catch(O){if(we(C),O!==O+0)throw O;return hn(1,0),0n}}function Hm(p,m,C,O,L){var K=Re();try{return Mt(p)(m,C,O,L)}catch(ne){if(we(K),ne!==ne+0)throw ne;hn(1,0)}}function Xm(p,m,C,O){var L=Re();try{return Mt(p)(m,C,O)}catch(K){if(we(L),K!==K+0)throw K;hn(1,0)}}function Km(p,m){var C=Re();try{Mt(p)(m)}catch(O){if(we(C),O!==O+0)throw O;hn(1,0)}}function Rd(p,m,C,O){var L=Re();try{Mt(p)(m,C,O)}catch(K){if(we(L),K!==K+0)throw K;hn(1,0)}}function Ym(p,m,C,O){var L=Re();try{return Mt(p)(m,C,O)}catch(K){if(we(L),K!==K+0)throw K;hn(1,0)}}function qm(p,m,C){var O=Re();try{return Mt(p)(m,C)}catch(L){if(we(O),L!==L+0)throw L;hn(1,0)}}function Zm(p){p=Object.assign({},p);var m=O=>L=>O(L)>>>0,C=O=>()=>O()>>>0;return p.ea=m(p.ea),p.ga=m(p.ga),p._emscripten_stack_alloc=m(p._emscripten_stack_alloc),p.ka=C(p.ka),p}function Dd(){if(ct>0){Ct=Dd;return}if(U(),ct>0){Ct=Dd;return}function p(){var m;r.calledRun=!0,!y&&(X(),j==null||j(r),(m=r.onRuntimeInitialized)==null||m.call(r),V())}r.setStatus?(r.setStatus("Running..."),setTimeout(()=>{setTimeout(()=>r.setStatus(""),1),p()},1)):p()}var Ko;return Ko=await ce(),Dd(),I?t=r:t=new Promise((p,m)=>{j=p,S=m}),t}const doe=Object.freeze(Object.defineProperty({__proto__:null,default:BO},Symbol.toStringTag,{value:"Module"})),foe=`
import struct
import numpy as np

class Type:
    Short = (3,2); Long = (4,4); Ascii = (2,1); Byte = (1,1)
    Srational = (10,8)

class Tag:
    NewSubfileType = (254, Type.Long); ImageWidth = (256, Type.Long); ImageLength = (257, Type.Long)
    BitsPerSample = (258, Type.Short); Compression = (259, Type.Short)
    PhotometricInterpretation = (262, Type.Short); Make = (271, Type.Ascii); Model = (272, Type.Ascii)
    StripOffsets = (273, Type.Long); SamplesPerPixel = (277, Type.Short)
    RowsPerStrip = (278, Type.Short); StripByteCounts = (279, Type.Long)
    CFARepeatPatternDim = (33421, Type.Short); CFAPattern = (33422, Type.Byte)
    DNGVersion = (50706, Type.Byte); UniqueCameraModel = (50708, Type.Ascii)
    BlackLevelRepeatDim = (50713, Type.Short)
    BlackLevel = (50714, Type.Short); WhiteLevel = (50717, Type.Short)
    ColorMatrix1 = (50721, Type.Srational); CalibrationIlluminant1 = (50778, Type.Short)

class Compression: Uncompressed = 1
class PhotometricInterpretation: Color_Filter_Array = 32803
class CFAPattern: BGGR=[2,1,1,0]; GBRG=[1,2,0,1]; GRBG=[1,0,2,1]; RGGB=[0,1,1,2]

class dngTag(object):
    def __init__(self, tagType, value=[]):
        self.TagId = tagType[0]
        self.DataType = tagType[1]
        self.DataCount = len(value) if not isinstance(value, str) else len(value) + 1
        self.Value = self._pack_value(tagType[1], value)
        self.DataLength = len(self.Value)
        self.selfContained = (self.DataLength <= 4)
        self.DataOffset = 0

    def _pack_value(self, dtype, value):
        tid = dtype[0]
        if tid == 1: return struct.pack('<%sB' % len(value), *value)
        elif tid == 3: return struct.pack('<%sH' % len(value), *value)
        elif tid == 4: return struct.pack('<%sL' % len(value), *value)
        elif tid == 2: return struct.pack('<%ss' % len(value), value.encode("ascii")) + b'\\x00'
        elif tid == 10:
            flat = [item for sublist in value for item in sublist]  # [[num,den]...]
            return struct.pack('<%sl' % len(flat), *flat)
        return b''

    def write_directory(self, buf, offset):
        if self.selfContained:
            val = self.Value + b'\\x00' * (4 - len(self.Value))
            struct.pack_into("<HHI4s", buf, offset, self.TagId, self.DataType[0], self.DataCount, val)
        else:
            struct.pack_into("<HHII", buf, offset, self.TagId, self.DataType[0], self.DataCount, self.DataOffset)

    def write_data(self, buf):
        if not self.selfContained:
            struct.pack_into(f"<{len(self.Value)}s", buf, self.DataOffset, self.Value)

def pack_dng_from_u16(raw_u16_bytes_le, width, height, cfa_str, black_level_list, cm_flat, make_str, model_str, unique_model_str):
    raw_data = np.frombuffer(raw_u16_bytes_le, dtype=np.uint16).copy()
    raw_data = raw_data.astype(np.int32)
    raw_data = np.clip(raw_data, 0, 65535).astype(np.uint16)

    white_level = 65019
    color_matrix = [[int(x * 10000), 10000] for x in cm_flat]
    cfa_map = {"BGGR": CFAPattern.BGGR, "GBRG": CFAPattern.GBRG, "GRBG": CFAPattern.GRBG, "RGGB": CFAPattern.RGGB}

    tags = [
        dngTag(Tag.NewSubfileType, [0]),
        dngTag(Tag.ImageWidth, [width]),
        dngTag(Tag.ImageLength, [height]),
        dngTag(Tag.BitsPerSample, [16]),
        dngTag(Tag.Compression, [Compression.Uncompressed]),
        dngTag(Tag.PhotometricInterpretation, [PhotometricInterpretation.Color_Filter_Array]),
        dngTag(Tag.Make, make_str),
        dngTag(Tag.Model, model_str),
        dngTag(Tag.SamplesPerPixel, [1]),
        dngTag(Tag.RowsPerStrip, [height]),
        dngTag(Tag.CFARepeatPatternDim, [2, 2]),
        dngTag(Tag.CFAPattern, cfa_map.get(cfa_str.upper(), CFAPattern.RGGB)),
        dngTag(Tag.BlackLevelRepeatDim, [2, 2]),
        dngTag(Tag.BlackLevel, [int(x) for x in black_level_list]),
        dngTag(Tag.WhiteLevel, [white_level]),
        dngTag(Tag.ColorMatrix1, color_matrix),
        dngTag(Tag.CalibrationIlluminant1, [21]),
        dngTag(Tag.DNGVersion, [1, 4, 0, 0]),
        dngTag(Tag.UniqueCameraModel, unique_model_str),
    ]

    pixel_bytes = raw_data.tobytes()
    tags.append(dngTag(Tag.StripOffsets, [0]))
    tags.append(dngTag(Tag.StripByteCounts, [len(pixel_bytes)]))
    tags.sort(key=lambda x: x.TagId)

    ifd_size = 2 + (len(tags) * 12) + 4
    current_data_offset = 8 + ifd_size

    for tag in tags:
        if not tag.selfContained:
            tag.DataOffset = current_data_offset
            current_data_offset = (current_data_offset + tag.DataLength + 3) & 0xFFFFFFFC

    img_offset = current_data_offset
    for tag in tags:
        if tag.TagId == Tag.StripOffsets[0]:
            tag.Value = struct.pack('<L', img_offset)
            break

    buf = bytearray(img_offset + len(pixel_bytes))
    struct.pack_into("<ccbbI", buf, 0, b'I', b'I', 0x2A, 0x00, 8)
    struct.pack_into("<H", buf, 8, len(tags))

    offset = 10
    for tag in tags:
        tag.write_directory(buf, offset)
        offset += 12

    struct.pack_into("<I", buf, offset, 0)
    for tag in tags:
        tag.write_data(buf)

    buf[img_offset:img_offset+len(pixel_bytes)] = pixel_bytes
    return bytes(buf)
`;let mx=null;async function hoe(e){return mx||(mx=(async()=>{if(!window.loadPyodide)throw new Error("Pyodide missing: window.loadPyodide not found.");e==null||e("Loading Pyodide...");const t=await window.loadPyodide();return e==null||e("Loading numpy..."),await t.loadPackage("numpy"),e==null||e("Init DNG writer kernel..."),await t.runPythonAsync(foe),t})()),mx}let yx=null;async function poe(){yx||(yx=BO({locateFile:(t,r)=>t.endsWith("joraw.wasm")?new URL("/assets/joraw-DraTMNgX.wasm",import.meta.url).href:r+t}));const e=await yx;return e.LibRaw||e.JoRaw}function goe(e,t,r,n){const a=t*r,i=new Float32Array(a);let o=0;for(let s=0;s<r;s++){const l=(s&1)<<1;for(let u=0;u<t;u++){const d=l|u&1;i[o]=e[o]-n[d],o++}}return i}function moe(e,t,r,n){const a=t*r,i=new Uint16Array(a);let o=0;for(let s=0;s<r;s++){const l=(s&1)<<1;for(let u=0;u<t;u++){const d=l|u&1;let f=e[o]+n[d];f<0&&(f=0),f>65535&&(f=65535),i[o]=f+.5|0,o++}}return i}function yoe(e){const t=new Uint16Array([255]);if(new Uint8Array(t.buffer)[0]===255)return new Uint8Array(e.buffer,e.byteOffset,e.byteLength);const n=new Uint8Array(e.length*2),a=new DataView(n.buffer);for(let i=0;i<e.length;i++)a.setUint16(i*2,e[i],!0);return n}function xoe(e){const t=e.trim(),r=[];let n=0;const a=d=>d>="0"&&d<="9",i=d=>d>="A"&&d<="Z"||d>="a"&&d<="z";for(;n<t.length;){const d=t[n];if(d<=" "){n++;continue}if(d==="("){r.push({t:"lp"}),n++;continue}if(d===")"){r.push({t:"rp"}),n++;continue}if(d===","){r.push({t:"comma"}),n++;continue}if(d==="+"&&t[n+1]==="+"){r.push({t:"op",v:"++"}),n+=2;continue}if(d==="+"){r.push({t:"op",v:"+"}),n++;continue}if(d==="-"){r.push({t:"op",v:"-"}),n++;continue}if(d==="*"){r.push({t:"op",v:"*"}),n++;continue}if(d==="/"){r.push({t:"op",v:"/"}),n++;continue}if(a(d)||d==="."){let f=n+1;for(;f<t.length&&(a(t[f])||t[f]===".");)f++;const h=Number(t.slice(n,f));if(!Number.isFinite(h))throw new Error(`Bad number: ${t.slice(n,f)}`);r.push({t:"num",v:h}),n=f;continue}if(i(d)){let f=n+1;for(;f<t.length&&i(t[f]);)f++;const h=t.slice(n,f).toUpperCase();let g=f;for(;g<t.length&&t[g]<=" ";)g++;t[g]==="("&&(h==="MAX"||h==="MIN"||h==="MID")?r.push({t:"func",name:h}):r.push({t:"id",v:h}),n=f;continue}throw new Error(`Unexpected char at ${n}: ${d}`)}const o=[];for(let d=0;d<r.length;d++){const f=r[d],h=o[o.length-1],g=!h||h.t==="op"||h.t==="lp"||h.t==="comma";if(f.t==="op"&&(f.v==="-"||f.v==="+")&&g){o.push({t:"num",v:0}),o.push(f);continue}o.push(f)}const s=[],l=d=>d.t==="num"||d.t==="id"||d.t==="rp",u=d=>d.t==="num"||d.t==="id"||d.t==="lp"||d.t==="func";for(let d=0;d<o.length;d++){const f=o[d],h=s[s.length-1];h&&l(h)&&u(f)&&s.push({t:"op",v:"*"}),s.push(f)}return s}function r_(e){return e==="*"||e==="/"?2:1}function voe(e){const t=[],r=[],n=[];for(const a of e){if(a.t==="num"||a.t==="id"){t.push(a);continue}if(a.t==="func"){r.push(a),n.push(1);continue}if(a.t==="comma"){for(;r.length&&r[r.length-1].t!=="lp";)t.push(r.pop());if(!r.length)throw new Error("Comma found outside parentheses.");if(!n.length)throw new Error("Comma found but no function context.");n[n.length-1]+=1;continue}if(a.t==="lp"){r.push(a);continue}if(a.t==="rp"){for(;r.length&&r[r.length-1].t!=="lp";)t.push(r.pop());if(!r.length)throw new Error("Mismatched parentheses");if(r.pop(),r.length&&r[r.length-1].t==="func"){const i=r.pop(),o=n.pop()??1;t.push({t:"func",name:i.name,argc:o})}continue}if(a.t==="op"){for(;r.length;){const i=r[r.length-1];if(i.t!=="op")break;const o=r_(a.v);if(r_(i.v)>=o)t.push(r.pop());else break}r.push(a);continue}}for(;r.length;){const a=r.pop();if(a.t==="lp"||a.t==="rp")throw new Error("Mismatched parentheses");if(a.t==="func"){const i=n.pop()??1;t.push({t:"func",name:a.name,argc:i})}else t.push(a)}if(n.length!==0)throw new Error("Internal error: argCountStack not empty.");return t}function boe(e,t){for(let n=1;n<t;n++){const a=e[n];let i=n-1;for(;i>=0&&e[i]>a;)e[i+1]=e[i],i--;e[i+1]=a}const r=t-1>>1;return e[r]}function woe(e,t,r){if(t.size===0)throw new Error("No RAW loaded.");const n=t.values().next().value,a=n.width,i=n.height,o=a*i,s=new Map,l=x=>{const y=t.get(x);if(!y)throw new Error(`Unknown RAW key: ${x}`);if(y.width!==a||y.height!==i)throw new Error("Dimension mismatch among RAWs.");let _=s.get(x);if(!_){_=new Float64Array(o);const j=y.workF32;for(let S=0;S<o;S++)_[S]=j[S];s.set(x,_)}return{kind:"img",v:_,w:a,h:i,firstId:x}},u=x=>({kind:"scalar",v:x}),d=x=>{if(x.kind==="img")return x;const y=new Float64Array(o);return y.fill(x.v),{kind:"img",v:y,w:a,h:i,firstId:void 0}},f=(x,y)=>x??y,h=[];for(const x of e){if(x.t==="num"){h.push(u(x.v));continue}if(x.t==="id"){h.push(l(x.v));continue}if(x.t==="func"){const y=x.argc??1;if(y<1)throw new Error(`${x.name.toLowerCase()}(...) requires at least 1 argument.`);const _=[];for(let N=0;N<y;N++){const T=h.pop();if(!T)throw new Error(`${x.name.toLowerCase()}(...) missing argument(s).`);_.push(T)}if(_.reverse(),_.every(N=>N.kind==="scalar")){const N=_.map(T=>T.v);for(let T=1;T<N.length;T++){const A=N[T];let D=T-1;for(;D>=0&&N[D]>A;)N[D+1]=N[D],D--;N[D+1]=A}if(x.name==="MAX")h.push(u(N[N.length-1]));else if(x.name==="MIN")h.push(u(N[0]));else{const T=N.length-1>>1;h.push(u(N[T]))}continue}const S=_.map(d),k=S.reduce((N,T)=>f(N,T.firstId),void 0),M=new Float64Array(o);if(x.name==="MAX"||x.name==="MIN"){const N=S[0].v;for(let T=0;T<o;T++)M[T]=N[T];if(x.name==="MAX")for(let T=1;T<S.length;T++){const A=S[T].v;for(let D=0;D<o;D++)A[D]>M[D]&&(M[D]=A[D])}else for(let T=1;T<S.length;T++){const A=S[T].v;for(let D=0;D<o;D++)A[D]<M[D]&&(M[D]=A[D])}h.push({kind:"img",v:M,w:a,h:i,firstId:k});continue}if(x.name==="MID"){const N=S.length,T=new Float64Array(N);for(let A=0;A<o;A++){for(let D=0;D<N;D++)T[D]=S[D].v[A];M[A]=boe(T,N)}h.push({kind:"img",v:M,w:a,h:i,firstId:k});continue}throw new Error(`Unknown function: ${x.name}`)}if(x.t==="op"){const y=x.v,_=h.pop(),j=h.pop();if(!j||!_)throw new Error(`Operator ${y} missing operands`);if(y==="++"){if(!r)throw new Error("Formula uses '++' but ppRange is null.");const A=d(j),D=d(_),$=D.firstId;if(!$){h.push(A);continue}const B=t.get($);if(!B)throw new Error(`Mask source RAW not found: ${$}`);const J=A.v,W=D.v,I=new Float64Array(o),G=r.min,U=r.max,X=B.origU16;for(let V=0;V<o;V++){const z=X[V];I[V]=z>=G&&z<=U?W[V]:J[V]}h.push({kind:"img",v:I,w:a,h:i,firstId:f(A.firstId,$)});continue}if(j.kind==="scalar"&&_.kind==="scalar"){if(y==="+")h.push(u(j.v+_.v));else if(y==="-")h.push(u(j.v-_.v));else if(y==="*")h.push(u(j.v*_.v));else if(y==="/")h.push(u(j.v/_.v));else throw new Error(`Unsupported op ${y}`);continue}const S=d(j),k=d(_),M=S.v,N=k.v,T=new Float64Array(o);if(y==="+")for(let A=0;A<o;A++)T[A]=M[A]+N[A];else if(y==="-")for(let A=0;A<o;A++)T[A]=M[A]-N[A];else if(y==="*")for(let A=0;A<o;A++)T[A]=M[A]*N[A];else if(y==="/")for(let A=0;A<o;A++)T[A]=M[A]/N[A];else throw new Error(`Unsupported op ${y}`);h.push({kind:"img",v:T,w:a,h:i,firstId:f(S.firstId,k.firstId)});continue}}if(h.length!==1)throw new Error("Expression did not reduce to a single value.");const g=h[0],v=g.kind==="img"?g:d(g),w=new Float32Array(o),b=v.v;for(let x=0;x<o;x++)w[x]=b[x];return w}async function koe(e,t,r,n,a,i,o,s,l){if(Object.keys(e).length===0)throw new Error("No files loaded.");if(!t.trim())throw new Error("Formula empty.");const d=t.includes("++");if(d&&!o)throw new Error("Formula contains '++' but ++Range is not provided.");l==null||l("Parsing formula...");const f=xoe(t),h=voe(f),g=new Set;for(const $ of f)$.t==="id"&&g.add($.v);for(const $ of g)if(!e[$])throw new Error(`Formula references "${$}" but it is not loaded.`);l==null||l("Initializing joraw...");const v=await poe(),w=[];let b=0,x=0;const y=Array.from(g);for(let $=0;$<y.length;$++){const B=y[$],J=e[B];l==null||l(`Decoding ${B}: ${J.name} ...`);const W=await J.arrayBuffer(),I=new v;try{await I.open(new Uint8Array(W));const G=I.getRawImage(),U=G.width,X=G.height,V=new Uint16Array(G.data),z=goe(V,U,X,r);if(w.length===0)b=U,x=X;else if(U!==b||X!==x)throw new Error(`Dimension mismatch: ${B} is ${U}x${X}, expected ${b}x${x}.`);w.push({key:B,file:J,width:U,height:X,origU16:V,workF32:z})}finally{I.delete?I.delete():I.close&&I.close()}}if(w.length===0)throw new Error("No referenced RAWs loaded.");l==null||l("Evaluating expression (float domain)...");const _=new Map(w.map($=>[$.key,$])),j=woe(h,_,d?o:null);if(s){let $=-1/0;for(let B=0;B<j.length;B++)j[B]>$&&($=j[B]);if($>1e-6){const W=(65019-Math.max(...n))/$;l==null||l(`Auto-filling 16bit: Max=${$.toFixed(2)}, Factor=${W.toFixed(4)}`);for(let I=0;I<j.length;I++)j[I]*=W}}l==null||l("Finalizing to 16-bit (add OutputBL pedestal + clip)...");const S=moe(j,b,x,n),k=yoe(S),M=a&&a.length===9?a:[1,0,0,0,1,0,0,0,1],N=await hoe(l);l==null||l("Packing DNG container..."),N.globals.set("js_raw_u16_le",k),N.globals.set("js_width",b),N.globals.set("js_height",x),N.globals.set("js_cfa",String(i||"RGGB")),N.globals.set("js_bl_out",Array.from(n)),N.globals.set("js_cm_flat",M),N.globals.set("js_make","JO-Workstation"),N.globals.set("js_model","StackingTool"),N.globals.set("js_unique_model","JO StackingTool 16bit");const T=await N.runPythonAsync(`
pack_dng_from_u16(
  js_raw_u16_le.to_py(),
  js_width,
  js_height,
  js_cfa,
  js_bl_out.to_py(),
  js_cm_flat.to_py(),
  js_make,
  js_model,
  js_unique_model
)
  `),A=T.toJs();T.destroy&&T.destroy();const D=new Uint8Array(A.byteLength);return D.set(A),D.buffer}const Soe=({isOpen:e,onClose:t,zIndex:r,onFocus:n})=>{const[a,i]=P.useState({}),[o,s]=P.useState(0),[l,u]=P.useState("0 0 0 0"),[d,f]=P.useState("0 0 0 0"),[h,g]=P.useState(()=>localStorage.getItem("stacking_formula")||""),[v,w]=P.useState(!0),[b,x]=P.useState("0-14000"),[y,_]=P.useState(!0),[j,S]=P.useState(""),[k,M]=P.useState("RGGB"),[N,T]=P.useState("Idle"),[A,D]=P.useState(!1),[$,B]=P.useState(null),J=P.useRef(null),W=P.useMemo(()=>Object.keys(ju).sort(),[]);P.useEffect(()=>{localStorage.setItem("stacking_formula",h)},[h]);const I=q=>{let te="",ie=q;for(;ie>=0;)te=String.fromCharCode(ie%26+65)+te,ie=Math.floor(ie/26)-1;return te},G=q=>{if(q.target.files&&q.target.files.length>0){const te={...a};let ie=o;Array.from(q.target.files).forEach(he=>{const ee=I(ie++);te[ee]=he}),i(te),s(ie)}q.target.value=""},U=()=>{i({}),s(0),B(null),T("Idle")},X=(q,te)=>{const ie=q.trim().split(/[\s,]+/).map(Number);if(ie.length<1||ie.some(isNaN))throw new Error(`Invalid ${te} Black Level format.`);return[ie[0],ie.length>1?ie[1]:ie[0],ie.length>2?ie[2]:ie[0],ie.length>3?ie[3]:ie[0]]},V=async()=>{if(Object.keys(a).length===0){B("No files loaded.");return}if(!h.trim()){B("Please enter a formula.");return}let q,te;try{q=X(l,"Input"),te=X(d,"Output")}catch(ee){B(ee.message);return}let ie=null;if(v){const ee=b.split("-").map(Le=>parseFloat(Le.trim()));if(ee.length===2&&!isNaN(ee[0])&&!isNaN(ee[1]))ie={min:Math.min(ee[0],ee[1]),max:Math.max(ee[0],ee[1])};else{B("Invalid ++Range format. Use min-max (e.g., 0-14000).");return}}else if(h.includes("++")){B("Formula contains '++' operator but ++Range is disabled.");return}let he=null;if(j.trim()&&(he=j.trim().split(/[\s,\n]+/).map(Number),he.length!==9||he.some(isNaN))){B("Color Matrix must be 9 numbers.");return}D(!0),B(null),T("Starting...");try{await new Promise(de=>setTimeout(de,50));const ee=await koe(a,h,q,te,he,k,ie,y,de=>T(de));T("Creating Download...");const Le=new Blob([ee],{type:"image/x-adobe-dng"}),fe=URL.createObjectURL(Le),ce=document.createElement("a");ce.href=fe,ce.download=`Stacked_Result_${Date.now()}.dng`,document.body.appendChild(ce),ce.click(),document.body.removeChild(ce),URL.revokeObjectURL(fe),T("Done!")}catch(ee){console.error(ee),B(ee.message),T("Failed")}finally{D(!1)}},z=()=>{f(l)};return e?c.jsxs(Cl,{initialPosition:{x:window.innerWidth/2-250,y:100},onClose:t,zIndex:r,onFocus:n,className:"w-[500px] bg-white dark:bg-slate-900 border-2 border-black dark:border-white shadow-2xl flex flex-col font-mono",children:[c.jsxs("div",{className:"flex justify-between items-center px-4 py-2 border-b-2 border-black dark:border-gray-500 bg-emerald-700 text-white",children:[c.jsx("h3",{className:"text-sm font-bold uppercase tracking-widest",children:"Advanced Math Stacking Tool"}),c.jsx("button",{onClick:t,className:"hover:text-red-300 transition-colors",children:""})]}),c.jsxs("div",{className:"p-4 flex flex-col gap-4 overflow-y-auto max-h-[80vh]",children:[c.jsx("div",{className:"h-28 border border-gray-300 dark:border-slate-700 bg-gray-50 dark:bg-black/30 rounded p-2 overflow-y-auto",children:Object.keys(a).length===0?c.jsx("div",{className:"h-full flex items-center justify-center text-gray-400 text-xs",children:"No files loaded. Click 'Add Files' below."}):c.jsx("div",{className:"space-y-1",children:Object.entries(a).map(([q,te])=>{const ie=te;return c.jsxs("div",{className:"flex justify-between text-xs border-b border-gray-200 dark:border-slate-800 pb-1 last:border-0",children:[c.jsx("span",{className:"font-bold text-emerald-600 dark:text-emerald-400 w-8",children:q}),c.jsx("span",{className:"truncate text-gray-700 dark:text-slate-300 flex-1",children:ie.name}),c.jsxs("span",{className:"text-gray-400",children:[(ie.size/1024/1024).toFixed(1),"MB"]})]},q)})})}),c.jsxs("div",{className:"flex flex-col gap-3 flex-shrink-0",children:[c.jsxs("div",{className:"flex gap-2",children:[c.jsx("input",{type:"file",ref:J,multiple:!0,className:"hidden",onChange:G,accept:".arw,.cr2,.cr3,.dng,.nef,.orf,.raf,.rw2,.pef,.srw,.sr2,.srf,.x3f,.erf,.mef,.mos,.mrw,.kdc,.dcr,.iiq,.3fr,.fff,.rwl,.nrw,.raw,.tif,.tiff"}),c.jsx("button",{onClick:()=>{var q;return(q=J.current)==null?void 0:q.click()},className:"flex-1 bg-gray-200 hover:bg-gray-300 dark:bg-slate-800 dark:hover:bg-slate-700 py-1 rounded text-xs font-bold transition-colors",children:"Add Files"}),c.jsx("button",{onClick:U,className:"px-3 bg-red-100 hover:bg-red-200 dark:bg-red-900/30 dark:hover:bg-red-900/50 text-red-600 dark:text-red-400 py-1 rounded text-xs font-bold transition-colors",children:"Clear"})]}),c.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[c.jsxs("div",{className:"flex flex-col gap-2",children:[c.jsxs("div",{children:[c.jsx("label",{className:"text-[10px] font-bold text-gray-500 dark:text-slate-400 uppercase block mb-1",children:"Input BL (Subtract)"}),c.jsx("input",{type:"text",value:l,onChange:q=>u(q.target.value),className:"w-full text-xs px-2 py-1 bg-white dark:bg-slate-900 border border-gray-300 dark:border-slate-600 rounded outline-none"}),c.jsx("div",{className:"text-[9px] text-gray-400 mt-0.5",children:"(0,0), (0,1), (1,0), (1,1)"})]}),c.jsxs("div",{children:[c.jsx("label",{className:"text-[10px] font-bold text-gray-500 dark:text-slate-400 uppercase block mb-1",children:"Output BL (Add to Result)"}),c.jsxs("div",{className:"flex gap-1",children:[c.jsx("input",{type:"text",value:d,onChange:q=>f(q.target.value),className:"w-full text-xs px-2 py-1 bg-white dark:bg-slate-900 border border-gray-300 dark:border-slate-600 rounded outline-none"}),c.jsx("button",{onClick:z,className:"px-2 bg-gray-200 dark:bg-slate-700 hover:bg-gray-300 rounded text-[9px]",title:"Copy Input to Output",children:""})]})]})]}),c.jsxs("div",{className:"flex flex-col justify-end",children:[c.jsx("label",{className:"text-[10px] font-bold text-gray-500 dark:text-slate-400 uppercase block mb-1",children:"Options"}),c.jsxs("label",{className:"flex items-center gap-1.5 cursor-pointer mb-2",children:[c.jsx("input",{type:"checkbox",checked:y,onChange:q=>_(q.target.checked),className:"rounded text-emerald-600 focus:ring-emerald-500"}),c.jsx("span",{className:"text-[10px] font-bold uppercase text-emerald-600 dark:text-emerald-400",children:"16bit (Auto Fill)"})]}),c.jsxs("div",{className:"flex items-center gap-1 mt-1",children:[c.jsx("input",{type:"checkbox",checked:v,onChange:q=>w(q.target.checked),className:"rounded",title:"Enable Conditional ++ Operator"}),c.jsx("span",{className:`text-[9px] font-bold uppercase ${v?"text-indigo-600 dark:text-indigo-400":"text-gray-400"}`,children:"++Range:"}),c.jsx("input",{type:"text",value:b,onChange:q=>x(q.target.value),disabled:!v,placeholder:"min-max",className:"w-full text-[10px] px-1 py-0.5 bg-white dark:bg-slate-900 border border-gray-300 dark:border-slate-600 rounded outline-none disabled:opacity-50"})]})]})]}),c.jsxs("div",{children:[c.jsx("label",{className:"text-[10px] font-bold text-gray-500 dark:text-slate-400 uppercase block mb-1",children:"Math Formula ( + - * / and ++ )"}),c.jsx("textarea",{value:h,onChange:q=>g(q.target.value),placeholder:"e.g. (A+B)/2 or A ++ 4*B",className:"w-full h-14 text-xs px-2 py-1 bg-white dark:bg-slate-900 border border-gray-300 dark:border-slate-600 rounded outline-none resize-none font-mono"}),c.jsxs("p",{className:"text-[9px] text-gray-400 mt-1 leading-tight",children:["Operators: +, -, *, /, ( ). ",c.jsx("br",{}),c.jsx("span",{className:"text-indigo-400 font-bold",children:"++"})," Operator: ",c.jsx("code",{children:"A ++ B"}),' means "Use B if B is in range, else use A". ',c.jsx("br",{}),"Inputs are linearized float32 (Raw - InputBL)."]})]}),c.jsxs("div",{className:"grid grid-cols-3 gap-2 items-end",children:[c.jsxs("div",{className:"col-span-2",children:[c.jsxs("div",{className:"flex justify-between items-end",children:[c.jsx("label",{className:"text-[10px] font-bold text-gray-500 dark:text-slate-400 uppercase",children:"Color Matrix (9 vals)"}),c.jsxs("select",{className:"text-[9px] bg-gray-100 dark:bg-slate-800 border border-black dark:border-slate-500 rounded-none px-1 py-0.5 max-w-[120px] cursor-pointer",onChange:q=>{const te=ju[q.target.value];te&&S(te),q.target.value=""},defaultValue:"",children:[c.jsx("option",{value:"",disabled:!0,children:"Presets..."}),W.map(q=>c.jsx("option",{value:q,children:q},q))]})]}),c.jsx("input",{type:"text",value:j,onChange:q=>S(q.target.value),placeholder:"e.g. 1 0 0 0 1 0 0 0 1",className:"w-full text-xs px-2 py-1 bg-white dark:bg-slate-900 border border-gray-300 dark:border-slate-600 rounded outline-none mt-1"})]}),c.jsxs("div",{children:[c.jsx("label",{className:"text-[10px] font-bold text-gray-500 dark:text-slate-400 uppercase block mb-1",children:"CFA Pattern"}),c.jsxs("select",{value:k,onChange:q=>M(q.target.value),className:"w-full bg-white dark:bg-slate-900 border border-gray-300 dark:border-slate-600 rounded px-1 py-1 text-xs font-bold",children:[c.jsx("option",{value:"RGGB",children:"RGGB"}),c.jsx("option",{value:"BGGR",children:"BGGR"}),c.jsx("option",{value:"GBRG",children:"GBRG"}),c.jsx("option",{value:"GRBG",children:"GRBG"})]})]})]}),$&&c.jsx("div",{className:"text-red-500 text-xs bg-red-50 dark:bg-red-900/20 p-2 rounded text-center font-bold",children:$}),c.jsxs("div",{className:"flex items-center gap-2 mt-2",children:[c.jsx("div",{className:"flex-1 text-xs text-emerald-600 dark:text-emerald-400 font-bold truncate",children:N}),c.jsx("button",{onClick:V,disabled:A,className:`px-6 py-2 text-sm font-bold uppercase tracking-wide text-white rounded shadow-md transition-all active:scale-95 ${A?"bg-gray-400 cursor-wait":"bg-emerald-600 hover:bg-emerald-500"}`,children:"Process & Save DNG"})]})]})]})]}):null},_oe=`
import struct
import numpy as np

class Type:
    Short = (3,2); Long = (4,4); Rational = (5,8); Ascii = (2,1); Byte = (1,1)
    Undefined = (7,1); Srational = (10,8); IFD = (13,4)

class Tag:
    NewSubfileType = (254, Type.Long); ImageWidth = (256, Type.Long); ImageLength = (257, Type.Long)
    BitsPerSample = (258, Type.Short); Compression = (259, Type.Short)
    PhotometricInterpretation = (262, Type.Short); Make = (271, Type.Ascii); Model = (272, Type.Ascii)
    StripOffsets = (273, Type.Long); Orientation = (274, Type.Short); SamplesPerPixel = (277, Type.Short)
    RowsPerStrip = (278, Type.Short); StripByteCounts = (279, Type.Long)
    CFARepeatPatternDim = (33421, Type.Short); CFAPattern = (33422, Type.Byte)
    DNGVersion = (50706, Type.Byte); UniqueCameraModel = (50708, Type.Ascii)
    BlackLevel = (50714, Type.Short); WhiteLevel = (50717, Type.Short)
    ColorMatrix1 = (50721, Type.Srational); CalibrationIlluminant1 = (50778, Type.Short)
    BlackLevelRepeatDim = (50713, Type.Short)

class Compression: Uncompressed = 1
class PhotometricInterpretation: Color_Filter_Array = 32803
class CFAPattern: BGGR=[2,1,1,0]; GBRG=[1,2,0,1]; GRBG=[1,0,2,1]; RGGB=[0,1,1,2]

class dngTag(object):
    def __init__(self, tagType, value=[]):
        self.TagId = tagType[0]
        self.DataType = tagType[1]
        self.DataCount = len(value) if not isinstance(value, str) else len(value) + 1
        self.Value = self._pack_value(tagType[1], value)
        self.DataLength = len(self.Value)
        self.selfContained = (self.DataLength <= 4)
        self.DataOffset = 0

    def _pack_value(self, dtype, value):
        tid = dtype[0]
        if tid == 1: return struct.pack('<%sB' % len(value), *value)
        elif tid == 3: return struct.pack('<%sH' % len(value), *value)
        elif tid == 4: return struct.pack('<%sL' % len(value), *value)
        elif tid == 2: return struct.pack('<%ss' % len(value), value.encode("ascii")) + b'\\x00'
        elif tid == 5 or tid == 10: 
            flat = [item for sublist in value for item in sublist]
            fmt = 'L' if tid == 5 else 'l'
            return struct.pack('<%s%s' % (len(flat), fmt), *flat)
        return b''

    def write_directory(self, buf, offset):
        if self.selfContained:
            val = self.Value + b'\\x00' * (4 - len(self.Value))
            struct.pack_into("<HHI4s", buf, offset, self.TagId, self.DataType[0], self.DataCount, val)
        else:
            struct.pack_into("<HHII", buf, offset, self.TagId, self.DataType[0], self.DataCount, self.DataOffset)

    def write_data(self, buf):
        if not self.selfContained:
            struct.pack_into(f"<{len(self.Value)}s", buf, self.DataOffset, self.Value)

def convert_to_dng(raw_bytes, width, height, cfa_str, black_level_list, shift, linear_shift, cm_flat):
    # 1. Pixel Data Processing
    # Ensure raw_bytes is a bytes-like object
    raw_data = np.frombuffer(raw_bytes, dtype=np.uint16).copy()
    
    # Use int32 for calculations
    raw_data = raw_data.astype(np.int32)

    # Apply Bit Shift (<<)
    if shift > 0:
        raw_data = raw_data * (1 << shift)
    
    # Apply Linear Offset (+)
    if linear_shift != 0:
        raw_data = raw_data + linear_shift

    # Clip to 16-bit range
    raw_data = np.clip(raw_data, 0, 65535).astype(np.uint16)

    # 2. Metadata Preparation
    white_level = 65019
    # Format Color Matrix for Srational (Value, Denominator)
    color_matrix = [[int(x * 10000), 10000] for x in cm_flat]

    cfa_map = {"BGGR": CFAPattern.BGGR, "GBRG": CFAPattern.GBRG, "GRBG": CFAPattern.GRBG, "RGGB": CFAPattern.RGGB}
    
    tags = [
        dngTag(Tag.NewSubfileType, [0]),
        dngTag(Tag.ImageWidth, [width]),
        dngTag(Tag.ImageLength, [height]),
        dngTag(Tag.BitsPerSample, [16]), 
        dngTag(Tag.Compression, [Compression.Uncompressed]),
        dngTag(Tag.PhotometricInterpretation, [PhotometricInterpretation.Color_Filter_Array]),
        dngTag(Tag.Make, "JO-Workstation"),
        dngTag(Tag.Model, "Z8-Rescued"),
        dngTag(Tag.SamplesPerPixel, [1]),
        dngTag(Tag.RowsPerStrip, [height]), 
        dngTag(Tag.CFARepeatPatternDim, [2, 2]),
        dngTag(Tag.CFAPattern, cfa_map.get(cfa_str.upper(), CFAPattern.RGGB)),
        dngTag(Tag.BlackLevelRepeatDim, [2, 2]),
        dngTag(Tag.BlackLevel, [int(x) for x in black_level_list]),
        dngTag(Tag.WhiteLevel, [white_level]),
        dngTag(Tag.ColorMatrix1, color_matrix),
        dngTag(Tag.CalibrationIlluminant1, [21]),
        dngTag(Tag.DNGVersion, [1, 4, 0, 0]),
        dngTag(Tag.UniqueCameraModel, "Nikon Z 8") 
    ]
    
    pixel_bytes = raw_data.tobytes()
    tags.append(dngTag(Tag.StripOffsets, [0])) 
    tags.append(dngTag(Tag.StripByteCounts, [len(pixel_bytes)]))
    tags.sort(key=lambda x: x.TagId)
    
    ifd_size = 2 + (len(tags) * 12) + 4
    current_data_offset = 8 + ifd_size
    
    for tag in tags:
        if not tag.selfContained:
            tag.DataOffset = current_data_offset
            current_data_offset = (current_data_offset + tag.DataLength + 3) & 0xFFFFFFFC
            
    img_offset = current_data_offset
    for tag in tags:
        if tag.TagId == Tag.StripOffsets[0]:
            tag.Value = struct.pack('<L', img_offset)
            break
            
    buf = bytearray(img_offset + len(pixel_bytes))
    struct.pack_into("<ccbbI", buf, 0, b'I', b'I', 0x2A, 0x00, 8)
    struct.pack_into("<H", buf, 8, len(tags))
    
    offset = 10
    for tag in tags:
        tag.write_directory(buf, offset)
        offset += 12
        
    struct.pack_into("<I", buf, offset, 0)
    for tag in tags:
        tag.write_data(buf)
        
    buf[img_offset:img_offset+len(pixel_bytes)] = pixel_bytes
    return bytes(buf)
`,joe=[1.1423,-.4564,-.1123,-.4816,1.2895,.2119,-.021,.1061,.7282],Poe=[4032,4032,4032,4032],Coe=2,Moe=({isOpen:e,onClose:t,zIndex:r=250,onFocus:n})=>{const[a,i]=P.useState(!0),[o,s]=P.useState(!1),[l,u]=P.useState(""),d=P.useRef(null),f=P.useRef(null);P.useEffect(()=>{e&&!d.current&&(async()=>{try{const v=await window.loadPyodide();await v.loadPackage("numpy"),await v.runPythonAsync(_oe),d.current=v,i(!1)}catch(v){console.error("Pyodide Init Failed",v),u("Error loading Python environment.")}})()},[e]);const h=async g=>{if(!g.target.files||g.target.files.length===0||!d.current)return;const v=Array.from(g.target.files);s(!0),u("Starting batch...");const w=d.current;for(let b=0;b<v.length;b++){const x=v[b];u(`Processing ${b+1}/${v.length}: ${x.name}`);try{const y=await x.arrayBuffer(),_=await Pu(y),{data:j,width:S,height:k}=_,M=[[0,0,0],[0,0,0],[0,0,0],[0,0,0]];for(let I=0;I<k;I+=2){const G=I*S,U=(I+1)*S;for(let X=0;X<S;X+=2){const V=[G+X,G+X+1,U+X,U+X+1];for(let z=0;z<4;z++){const q=j[V[z]];q>=1006&&q<=1008&&M[z][q-1006]++}}}const N=[-1,-1,-1,-1];for(let I=0;I<4;I++){const G=M[I][0],U=M[I][1],X=M[I][2];X<U?N[I]=1007:X>U&&U<G&&(N[I]=1006)}let T=!1;if(N.some(I=>I>-1)){T=!0;for(let I=0;I<k;I+=2){const G=I*S,U=(I+1)*S;for(let X=0;X<S;X+=2){const V=[G+X,G+X+1,U+X,U+X+1];for(let z=0;z<4;z++){const q=N[z];q>-1&&j[V[z]]<=q&&(j[V[z]]+=1)}}}}w.globals.set("js_raw_bytes",new Uint8Array(j.buffer,j.byteOffset,j.byteLength)),w.globals.set("js_width",S),w.globals.set("js_height",k),w.globals.set("js_cfa","RGGB"),w.globals.set("js_bl_list",Poe),w.globals.set("js_shift",Coe),w.globals.set("js_linear_shift",0),w.globals.set("js_cm_flat",joe);const A=await w.runPythonAsync(`
                    convert_to_dng(
                        js_raw_bytes.to_py(), 
                        js_width, 
                        js_height, 
                        js_cfa, 
                        js_bl_list.to_py(), 
                        js_shift,
                        js_linear_shift,
                        js_cm_flat.to_py()
                    )
                `),D=A.toJs();A.destroy();const $=new Blob([D],{type:"image/x-adobe-dng"}),B=URL.createObjectURL($),J=document.createElement("a");J.href=B;const W=x.name.substring(0,x.name.lastIndexOf("."))||"image";J.download=`${W}_Z8Rescued_16bit.dng`,document.body.appendChild(J),J.click(),document.body.removeChild(J),URL.revokeObjectURL(B),await new Promise(I=>setTimeout(I,100))}catch(y){console.error(`Error processing ${x.name}`,y),u(`Error on ${x.name}: ${y.message}`)}}s(!1),u("Batch Complete."),g.target.value=""};return e?c.jsxs(Cl,{initialPosition:{x:window.innerWidth/2-200,y:150},onClose:t,zIndex:r,onFocus:n,className:"w-[400px] bg-white dark:bg-slate-900 border-2 border-red-600 shadow-[8px_8px_0px_rgba(220,38,38,0.3)] rounded-none flex flex-col font-mono",children:[c.jsxs("div",{className:"flex justify-between items-center px-4 py-2 bg-red-600 text-white border-b-2 border-black dark:border-white",children:[c.jsxs("h3",{className:"text-sm font-bold uppercase tracking-widest flex items-center gap-2",children:[c.jsx("span",{className:"text-xl",children:""}),"  Z8 (Z8 Rescue)"]}),c.jsx("button",{onClick:t,className:"hover:text-black transition-colors font-bold",children:""})]}),c.jsx("div",{className:"p-6 flex flex-col gap-4",children:a?c.jsxs("div",{className:"flex flex-col items-center justify-center py-4",children:[c.jsx("div",{className:"w-6 h-6 border-4 border-red-600 border-t-transparent animate-spin rounded-full"}),c.jsx("p",{className:"text-xs mt-2 text-gray-500",children:"Loading Python Kernel..."})]}):c.jsxs(c.Fragment,{children:[c.jsxs("div",{className:"bg-red-50 dark:bg-red-900/10 border border-red-200 dark:border-red-800 p-3 text-[10px] text-gray-700 dark:text-gray-300 leading-relaxed",children:[c.jsx("strong",{className:"block mb-1 text-red-600 dark:text-red-400",children:"Logic:"}),"1. iso64 preferred",c.jsx("br",{}),"2. PTC",c.jsx("br",{}),"3. Apply bit-shift (x4) to 16-bit.",c.jsx("br",{}),"4. Export DNG with BL=4032 & Z8 Matrix."]}),c.jsxs("div",{className:"flex flex-col gap-2",children:[c.jsx("input",{type:"file",ref:f,multiple:!0,accept:".nef,.dng",className:"hidden",onChange:h}),c.jsx("button",{onClick:()=>{var g;return(g=f.current)==null?void 0:g.click()},disabled:o,className:`w-full py-3 font-bold uppercase text-xs tracking-widest shadow-md transition-all active:translate-y-1 ${o?"bg-gray-400 text-gray-700 cursor-wait":"bg-red-600 hover:bg-red-500 text-white border-2 border-black dark:border-white"}`,children:o?"Rescuing...":"Select Z8 Files & Rescue"})]}),l&&c.jsx("div",{className:"text-center text-[10px] font-bold text-red-600 dark:text-red-400 border-t border-gray-200 dark:border-slate-800 pt-2 animate-pulse",children:l})]})})]}):null};function n_(e,t,r,n=3){const i=r.byteLength,o=8,s=o+i,l=[{id:256,type:4,count:1,value:e},{id:257,type:4,count:1,value:t},{id:258,type:3,count:n,value:n===1?16:[16,16,16]},{id:259,type:3,count:1,value:1},{id:262,type:3,count:1,value:n===1?1:2},{id:273,type:4,count:1,value:o},{id:277,type:3,count:1,value:n},{id:278,type:4,count:1,value:t},{id:279,type:4,count:1,value:i}],u=2+l.length*12+4;let d=0;const f=l.map(y=>{let _=y.type===3?2:4;const j=y.count*_,S=j<=4;let k=0;return S||(k=d,d+=j),{...y,fits:S,totalBytes:j,extraOffset:k}}),h=s+u+d,g=new ArrayBuffer(h),v=new DataView(g),w=new Uint8Array(g);v.setUint16(0,18761,!0),v.setUint16(2,42,!0),v.setUint32(4,s,!0),w.set(new Uint8Array(r.buffer,r.byteOffset,r.byteLength),o);let b=s;v.setUint16(b,l.length,!0),b+=2;const x=s+u;return f.forEach(y=>{if(v.setUint16(b,y.id,!0),v.setUint16(b+2,y.type,!0),v.setUint32(b+4,y.count,!0),y.fits)Array.isArray(y.value)||(y.type===3?v.setUint16(b+8,y.value,!0):v.setUint32(b+8,y.value,!0));else{const _=x+y.extraOffset;v.setUint32(b+8,_,!0),Array.isArray(y.value)&&y.value.forEach((j,S)=>{v.setUint16(_+S*2,j,!0)})}b+=12}),v.setUint32(b,0,!0),g}const Noe="http://localhost:5428",Ooe=(e=!1)=>{const[t,r]=P.useState({isConnected:!1,message:"Initializing...",hasDngConverter:!1});return P.useEffect(()=>{if(e){r({isConnected:!1,message:"Bridge Paused",hasDngConverter:!1});return}const n=async()=>{try{const i=new AbortController,o=setTimeout(()=>i.abort(),1e3),s=await fetch(`${Noe}/health`,{method:"GET",signal:i.signal});if(clearTimeout(o),s.ok){const l=await s.json(),u=`Connected (${l.exiftool||"Ready"})`;r(d=>d.isConnected===!0&&d.message===u&&d.version===l.exiftool&&d.hasDngConverter===!!l.dng_converter?d:{isConnected:!0,message:u,version:l.exiftool,hasDngConverter:!!l.dng_converter})}else r(l=>l.isConnected===!1&&l.message==="Service Error"?l:{isConnected:!1,message:"Service Error",hasDngConverter:!1})}catch{r(o=>o.isConnected===!1&&o.message==="Not Detected"?o:{isConnected:!1,message:"Not Detected",hasDngConverter:!1})}};n();const a=setInterval(n,2e3);return()=>clearInterval(a)},[e]),t},Aoe="JTR_BlobStore",Go="raw_files",Eoe=1,zm=()=>new Promise((e,t)=>{const r=indexedDB.open(Aoe,Eoe);r.onupgradeneeded=n=>{const a=n.target.result;a.objectStoreNames.contains(Go)||a.createObjectStore(Go)},r.onsuccess=()=>e(r.result),r.onerror=()=>t(r.error)}),Toe=async(e,t)=>{const r=await zm();return new Promise((n,a)=>{const i=r.transaction(Go,"readwrite");i.objectStore(Go).put(t,e),i.oncomplete=()=>n(),i.onerror=()=>a(i.error)})},Ioe=async e=>{const t=await zm();return new Promise((r,n)=>{const o=t.transaction(Go,"readonly").objectStore(Go).get(e);o.onsuccess=()=>r(o.result),o.onerror=()=>n(o.error)})},Roe=async()=>{const e=await zm();return new Promise((t,r)=>{const n=e.transaction(Go,"readwrite");n.objectStore(Go).clear(),n.oncomplete=()=>t(),n.onerror=()=>r(n.error)})},FO="jtr_workspace_index",Doe=e=>{try{const t=JSON.stringify(e);localStorage.setItem(FO,t)}catch(t){console.error("Failed to save workspace index",t)}},$oe=()=>{try{const e=localStorage.getItem(FO);return e?JSON.parse(e):null}catch(e){return console.error("Failed to load workspace index",e),null}},Loe=async e=>{const n=(await zm()).transaction(Go,"readwrite").objectStore(Go),a=n.getAllKeys();a.onsuccess=()=>{a.result.forEach(o=>{e.includes(o)||n.delete(o)})}},Boe=[{x:3050,y:1973},{x:4245,y:1980},{x:3043,y:2870},{x:4243,y:2876}],Foe=1195,a_=150,i_=50,Uoe=[{x:3528,y:2437.5,ori:2},{x:3775,y:2419,ori:2},{x:3638.5,y:2303,ori:1},{x:3653,y:2548.5,ori:1},{x:3082,y:2413,ori:2},{x:2825,y:2427,ori:2},{x:2946,y:2300.5,ori:1},{x:2966,y:2550,ori:1},{x:3638.5,y:3e3,ori:1},{x:3657.5,y:3248.5,ori:1},{x:3521.5,y:3135,ori:2},{x:3770,y:3108.5,ori:2},{x:4375.5,y:3064.5,ori:2},{x:4620.5,y:3040,ori:2},{x:4486.5,y:2934,ori:1},{x:4509.5,y:3182.5,ori:1},{x:2066.5,y:1726,ori:2},{x:2176.5,y:1597,ori:1},{x:2194.5,y:1843,ori:1},{x:2313.5,y:1705,ori:2},{x:2675.5,y:1799.5,ori:2},{x:2789.5,y:1674,ori:1},{x:2926,y:1787.5,ori:2},{x:2810.5,y:1921.5,ori:1},{x:4380.5,y:1816,ori:2},{x:4497.5,y:1687,ori:1},{x:4513,y:1934.5,ori:1},{x:4628,y:1799.5,ori:2},{x:5099,y:1622.5,ori:1},{x:4985.5,y:1751,ori:2},{x:5122,y:1867.5,ori:1},{x:5229,y:1732,ori:2},{x:2194.5,y:2428,ori:2},{x:2305.5,y:2295.5,ori:1},{x:2327,y:2544,ori:1},{x:2442,y:2405,ori:2},{x:3530.5,y:1741.5,ori:2},{x:3640.5,y:1610,ori:1},{x:3777.5,y:1719.5,ori:2},{x:3666,y:1856.5,ori:1},{x:4222,y:2443.5,ori:2},{x:4470.5,y:2422,ori:2},{x:4334.5,y:2309,ori:1},{x:4356.5,y:2554,ori:1},{x:4965,y:2313,ori:1},{x:4852.5,y:2446,ori:2},{x:4987,y:2561,ori:1},{x:5097,y:2427,ori:2},{x:4981.5,y:3141.5,ori:2},{x:5096,y:3009,ori:1},{x:5222.5,y:3122.5,ori:2},{x:5115.5,y:3256.5,ori:1},{x:2779,y:2928,ori:1},{x:2667,y:3064.5,ori:2},{x:2799,y:3173.5,ori:1},{x:2917.5,y:3043,ori:2},{x:2167.5,y:2993,ori:1},{x:2052,y:3130,ori:2},{x:2187.5,y:3243.5,ori:1},{x:2304.5,y:3108.5,ori:2}];function Goe(e,t){let r=[],n=[];for(let o=0;o<4;o++){let s=e[o].x,l=e[o].y,u=t[o].x,d=t[o].y;r.push([s,l,1,0,0,0,-s*u,-l*u]),r.push([0,0,0,s,l,1,-s*d,-l*d]),n.push(u),n.push(d)}const a=8;for(let o=0;o<a;o++){let s=o;for(let l=o+1;l<a;l++)Math.abs(r[l][o])>Math.abs(r[s][o])&&(s=l);[r[o],r[s]]=[r[s],r[o]],[n[o],n[s]]=[n[s],n[o]];for(let l=o+1;l<a;l++){const u=r[l][o]/r[o][o];n[l]-=u*n[o];for(let d=o;d<a;d++)r[l][d]-=u*r[o][d]}}const i=new Array(a).fill(0);for(let o=a-1;o>=0;o--){let s=0;for(let l=o+1;l<a;l++)s+=r[o][l]*i[l];i[o]=(n[o]-s)/r[o][o]}return[[i[0],i[1],i[2]],[i[3],i[4],i[5]],[i[6],i[7],1]]}function zoe(e,t,r){const n=e[2][0]*t+e[2][1]*r+e[2][2];return{x:(e[0][0]*t+e[0][1]*r+e[0][2])/n,y:(e[1][0]*t+e[1][1]*r+e[1][2])/n}}function Woe(e){if(e.length!==4)return[];const t=Goe(Boe,e),n=Math.hypot(e[1].x-e[0].x,e[1].y-e[0].y)/Foe;return Uoe.map(a=>{const i=zoe(t,a.x,a.y);let o,s;return a.ori===1?(o=a_*n,s=i_*n):(o=i_*n,s=a_*n),{x:i.x-o/2,y:i.y-s/2,w:o,h:s,ori:a.ori}})}const Voe=[[3.2404542,-1.5371385,-.4985314],[-.969266,1.8760108,.041556],[.0556434,-.2040259,1.0572252]];function Hoe(e){const t=e.length;if(t===0)return 16383;const r=Math.max(1,Math.floor(t/1e6));let n=0;for(let a=0;a<t;a+=r){const i=e[a];i>n&&(n=i)}return n>17e3?65535:16383}const Xoe=`
struct Uniforms {
    width: u32,
    height: u32,
    whiteLevel: f32,
    exposureScale: f32,

    bl0: f32, bl1: f32, bl2: f32, bl3: f32,
    wb0: f32, wb1: f32, wb2: f32, wb3: f32,

    cm0: f32, cm1: f32, cm2: f32,
    cm3: f32, cm4: f32, cm5: f32,
    cm6: f32, cm7: f32, cm8: f32,

    renderMode: u32,
    isBGGR: u32,
    colorDemosaicMode: u32,

    neutral0: f32, neutral1: f32, neutral2: f32,

    hlrEnabled: u32,
    
    // Export specific flags (packed into padding or new fields)
    exportStretch: u32, 
    exportSrgb: u32,
};

struct UnmixParams {
    bl0: f32, bl1: f32, bl2: f32, bl3: f32,
    bg0: f32, bg1: f32, bg2: f32, bg3: f32,
    fg0: f32, fg1: f32, fg2: f32, fg3: f32,
};

@group(0) @binding(0) var<uniform> u : Uniforms;
@group(0) @binding(1) var<storage, read> rawData : array<u32>;
@group(0) @binding(3) var<uniform> unmix : UnmixParams;
@group(0) @binding(4) var<storage, read> lut : array<f32>; // 1024 float buffer

fn srgb_gamma(linear: f32) -> f32 {
    if (linear <= 0.0031308) { return 12.92 * linear; }
    return 1.055 * pow(linear, 1.0 / 2.4) - 0.055;
}

fn clamp01(x: f32) -> f32 { return max(0.0, min(1.0, x)); }
fn clamp_i32(v: i32, lo: i32, hi: i32) -> i32 { return max(lo, min(v, hi)); }

fn smootherstep(edge0: f32, edge1: f32, x: f32) -> f32 {
    let t = clamp01((x - edge0) / max(edge1 - edge0, 1e-6));
    return t*t*t*(t*(t*6.0 - 15.0) + 10.0);
}

fn get_raw_val(idx: u32) -> f32 {
    let u32Idx = idx / 2u;
    let shift = (idx % 2u) * 16u;
    let packed = rawData[u32Idx];
    return f32((packed >> shift) & 0xFFFFu);
}

fn get_bayer_idx(x: u32, y: u32) -> u32 {
    let rowIsOdd = (y % 2u);
    let colIsOdd = (x % 2u);
    return (rowIsOdd * 2u) + colIsOdd;
}

fn get_norm_pixel(x: i32, y: i32) -> f32 {
    let w = i32(u.width);
    let h = i32(u.height);
    let sx = clamp_i32(x, 0, w - 1);
    let sy = clamp_i32(y, 0, h - 1);
    let sxu = u32(sx);
    let syu = u32(sy);
    let idx = syu * u.width + sxu;
    let rawVal = get_raw_val(idx);
    let bIdx = get_bayer_idx(sxu, syu);

    var bl = 0.0;
    var wb = 1.0;
    if (bIdx == 0u) { bl = u.bl0; wb = u.wb0; }
    else if (bIdx == 1u) { bl = u.bl1; wb = u.wb1; }
    else if (bIdx == 2u) { bl = u.bl2; wb = u.wb2; }
    else { bl = u.bl3; wb = u.wb3; }

    let denom = max(u.whiteLevel - bl, 1.0);
    let val = max(0.0, rawVal - bl);
    return (val / denom) * wb;
}

fn shoulder_hue_preserve(rgbIn: vec3f) -> vec3f {
    var rgb = rgbIn;
    let knee = 0.90;
    let mx = max(rgb.x, max(rgb.y, rgb.z));
    if (mx <= knee) { return rgb; }
    let d = mx - knee;
    let mx2 = knee + (d * (1.0 - knee)) / (d + (1.0 - knee));
    let s = mx2 / max(mx, 1e-6);
    return rgb * s;
}

fn apply_lut(val: f32, offset: u32) -> f32 {
    let v = clamp01(val);
    let pos = v * 255.0;
    let idx = u32(pos);
    let f = fract(pos);
    let p0 = lut[offset + idx];
    let idxNext = min(idx + 1u, 255u);
    let p1 = lut[offset + idxNext];
    return mix(p0, p1, f);
}

fn interp_green_edge(xi: i32, yi: i32) -> f32 {
    let left = get_norm_pixel(xi - 1, yi);
    let right = get_norm_pixel(xi + 1, yi);
    let up = get_norm_pixel(xi, yi - 1);
    let down = get_norm_pixel(xi, yi + 1);
    let gradH = abs(left - right);
    let gradV = abs(up - down);
    if (gradH + 1e-6 < gradV) { return (left + right) * 0.5; }
    if (gradV + 1e-6 < gradH) { return (up + down) * 0.5; }
    return (left + right + up + down) * 0.25;
}

fn interp_diag_edge(xi: i32, yi: i32) -> f32 {
    let d1a = get_norm_pixel(xi - 1, yi - 1);
    let d1b = get_norm_pixel(xi + 1, yi + 1);
    let d2a = get_norm_pixel(xi + 1, yi - 1);
    let d2b = get_norm_pixel(xi - 1, yi + 1);
    let gradD1 = abs(d1a - d1b);
    let gradD2 = abs(d2a - d2b);
    if (gradD1 + 1e-6 < gradD2) { return (d1a + d1b) * 0.5; }
    if (gradD2 + 1e-6 < gradD1) { return (d2a + d2b) * 0.5; }
    return (d1a + d1b + d2a + d2b) * 0.25;
}
`,Koe=`
    let x = global_id.x;
    let y = global_id.y;
    if (x >= u.width || y >= u.height) { return; }
    let idx = y * u.width + x;

    var finalR: f32 = 0.0;
    var finalG: f32 = 0.0;
    var finalB: f32 = 0.0;
    
    // We compute 'linear-ish' float values first. 
    // In standard modes, these are 0..1.

    // MODE 0: mosaic gray
    if (u.renderMode == 0u) {
        let rawVal = get_raw_val(idx);
        let bIdx = get_bayer_idx(x, y);
        var bl = 0.0; var wb = 1.0;
        if (bIdx == 0u) { bl = u.bl0; wb = u.wb0; }
        else if (bIdx == 1u) { bl = u.bl1; wb = u.wb1; }
        else if (bIdx == 2u) { bl = u.bl2; wb = u.wb2; }
        else { bl = u.bl3; wb = u.wb3; }

        let val = max(0.0, rawVal - bl);
        var norm = val / max(u.whiteLevel - bl, 1.0);
        norm = clamp01(norm * u.exposureScale * wb);
        // Note: Gamma is applied at output stage for modularity
        finalR = norm; finalG = norm; finalB = norm;
    }
    // MODE 2: advanced unmix
    else if (u.renderMode == 2u) {
        let rawVal = get_raw_val(idx);
        let bIdx = get_bayer_idx(x, y);
        var bl = 0.0; var bg = 0.0; var fg = 0.0;
        if (bIdx == 0u) { bl = unmix.bl0; bg = unmix.bg0; fg = unmix.fg0; }
        else if (bIdx == 1u) { bl = unmix.bl1; bg = unmix.bg1; fg = unmix.fg1; }
        else if (bIdx == 2u) { bl = unmix.bl2; bg = unmix.bg2; fg = unmix.fg2; }
        else { bl = unmix.bl3; bg = unmix.bg3; fg = unmix.fg3; }

        let ref_bg = (unmix.bg1 + unmix.bg3) * 0.5;
        let ref_fg = (unmix.fg1 + unmix.fg3) * 0.5;
        let img_linear = max(0.0, rawVal - bl);
        let denom = fg - bg;
        var alpha = 0.0;
        if (abs(denom) > 1e-9) { alpha = (img_linear - bg) / denom; }

        var val = 0.0;
        if (alpha < 0.0) { val = img_linear * (ref_bg / max(bg, 1e-9)); }
        else if (alpha > 1.0) { val = img_linear * (ref_fg / max(fg, 1e-9)); }
        else { val = (1.0 - alpha) * ref_bg + alpha * ref_fg; }

        var norm = clamp01((val * u.exposureScale) / 65535.0);
        finalR = norm; finalG = norm; finalB = norm;
    }
    // MODE 1: color (bilinear or edge-aware)
    else {
        let xi = i32(x); let yi = i32(y);
        let rowIsOdd = (yi & 1); let colIsOdd = (xi & 1);
        var isRed = false; var isBlue = false;
        if (rowIsOdd == 0 && colIsOdd == 0) {
            if (u.isBGGR == 1u) { isBlue = true; } else { isRed = true; }
        } else if (rowIsOdd == 1 && colIsOdd == 1) {
            if (u.isBGGR == 1u) { isRed = true; } else { isBlue = true; }
        }

        var r_lin: f32 = 0.0; var g_lin: f32 = 0.0; var b_lin: f32 = 0.0;
        let useEdgeAware = (u.colorDemosaicMode == 1u);
        if (isRed) {
            r_lin = get_norm_pixel(xi, yi);
            if (useEdgeAware) {
                g_lin = interp_green_edge(xi, yi);
                b_lin = interp_diag_edge(xi, yi);
            } else {
                g_lin = (get_norm_pixel(xi, yi-1) + get_norm_pixel(xi, yi+1) + get_norm_pixel(xi-1, yi) + get_norm_pixel(xi+1, yi)) * 0.25;
                b_lin = (get_norm_pixel(xi-1, yi-1) + get_norm_pixel(xi+1, yi-1) + get_norm_pixel(xi-1, yi+1) + get_norm_pixel(xi+1, yi+1)) * 0.25;
            }
        } else if (isBlue) {
            b_lin = get_norm_pixel(xi, yi);
            if (useEdgeAware) {
                g_lin = interp_green_edge(xi, yi);
                r_lin = interp_diag_edge(xi, yi);
            } else {
                g_lin = (get_norm_pixel(xi, yi-1) + get_norm_pixel(xi, yi+1) + get_norm_pixel(xi-1, yi) + get_norm_pixel(xi+1, yi)) * 0.25;
                r_lin = (get_norm_pixel(xi-1, yi-1) + get_norm_pixel(xi+1, yi-1) + get_norm_pixel(xi-1, yi+1) + get_norm_pixel(xi+1, yi+1)) * 0.25;
            }
        } else {
            g_lin = get_norm_pixel(xi, yi);
            var horizIsRed = false;
            if (rowIsOdd == 0) { horizIsRed = (u.isBGGR == 0u); }
            else { horizIsRed = (u.isBGGR == 1u); }
            let valH = (get_norm_pixel(xi-1, yi) + get_norm_pixel(xi+1, yi)) * 0.5;
            let valV = (get_norm_pixel(xi, yi-1) + get_norm_pixel(xi, yi+1)) * 0.5;
            if (horizIsRed) { r_lin = valH; b_lin = valV; }
            else { b_lin = valH; r_lin = valV; }
        }

        // HLR
        if (u.hlrEnabled == 1u) {
            let targetWhite = vec3f(u.neutral0, u.neutral1, u.neutral2);
            let isBG = (u.isBGGR == 1u);
            let wbR = select(u.wb0, u.wb3, isBG); 
            let wbB = select(u.wb3, u.wb0, isBG);
            let r_s = r_lin / max(wbR, 1e-6);
            let g_s = g_lin;
            let b_s = b_lin / max(wbB, 1e-6);
            let mag_sensor = max(r_s, max(g_s, b_s));
            let mag_wb = max(r_lin, max(g_lin, b_lin));
            let hl_mask = smootherstep(0.85, 1.00, mag_sensor);
            if (hl_mask > 0.0) {
                let corrected = targetWhite * mag_wb;
                r_lin = mix(r_lin, corrected.x, hl_mask);
                g_lin = mix(g_lin, corrected.y, hl_mask);
                b_lin = mix(b_lin, corrected.z, hl_mask);
            }
        }

        // Matrix
        var rr = u.cm0*r_lin + u.cm1*g_lin + u.cm2*b_lin;
        var gg = u.cm3*r_lin + u.cm4*g_lin + u.cm5*b_lin;
        var bb = u.cm6*r_lin + u.cm7*g_lin + u.cm8*b_lin;

        // Exposure
        rr *= u.exposureScale;
        gg *= u.exposureScale;
        bb *= u.exposureScale;

        // Shoulder
        var rgb2 = shoulder_hue_preserve(vec3f(rr, gg, bb));

        // Curves
        let rgbPos = max(rgb2, vec3f(0.0));
        let luma = dot(rgbPos, vec3f(0.2126, 0.7152, 0.0722));
        let luma2 = apply_lut(luma, 0u);
        var masterScale = 1.0;
        if (luma > 1e-6) { masterScale = luma2 / luma; }
        let mr = rgb2.x * masterScale;
        let mg = rgb2.y * masterScale;
        let mb = rgb2.z * masterScale;

        finalR = apply_lut(mr, 256u);
        finalG = apply_lut(mg, 512u);
        finalB = apply_lut(mb, 768u);
    }
`;function o_(e){let t="",r="";return e==="display"?(t="@group(0) @binding(2) var<storage, read_write> output : array<u32>;",r=`
            // Standard Display Output (Always sRGB Gamma + 8-bit Packing)
            let r_gamma = srgb_gamma(clamp01(finalR));
            let g_gamma = srgb_gamma(clamp01(finalG));
            let b_gamma = srgb_gamma(clamp01(finalB));

            let r8 = u32(r_gamma * 255.0 + 0.5);
            let g8 = u32(g_gamma * 255.0 + 0.5);
            let b8 = u32(b_gamma * 255.0 + 0.5);
            let a8 = 255u;
            output[idx] = (a8 << 24u) | (b8 << 16u) | (g8 << 8u) | r8;
        `):(t="@group(0) @binding(2) var<storage, read_write> output : array<u32>;",r=`
            var r_out = clamp01(finalR);
            var g_out = clamp01(finalG);
            var b_out = clamp01(finalB);

            if (u.exportSrgb == 1u) {
                r_out = srgb_gamma(r_out);
                g_out = srgb_gamma(g_out);
                b_out = srgb_gamma(b_out);
            }

            var scale = 65535.0;
            if (u.exportStretch == 0u) {
                // Approximate raw magnitude restoration
                // get_norm_pixel divided by (White - Black)
                // So multiply by that range to restore DNs
                // Average green BL? Just use bl0 for simplicity or max range
                let bl = u.bl0; 
                scale = max(u.whiteLevel - bl, 1.0);
            }

            let r16 = u32(min(65535.0, r_out * scale));
            let g16 = u32(min(65535.0, g_out * scale));
            let b16 = u32(min(65535.0, b_out * scale));
            let a16 = 65535u; // Fully opaque

            // Pack: Little Endian logic
            // RG pack: (G << 16) | R
            // BA pack: (A << 16) | B
            
            let packedRG = (g16 << 16u) | r16;
            let packedBA = (a16 << 16u) | b16;

            output[idx * 2u] = packedRG;
            output[idx * 2u + 1u] = packedBA;
        `),`
        ${Xoe}
        ${t}
        @compute @workgroup_size(16, 16)
        fn main(@builtin(global_invocation_id) global_id : vec3u) {
            ${Koe}
            ${r}
        }
    `}class Yoe{constructor(){Ht(this,"device",null);Ht(this,"displayPipeline",null);Ht(this,"exportPipeline",null);Ht(this,"resources",new Map);Ht(this,"uniformBuffer",null);Ht(this,"unmixParamsBuffer",null);Ht(this,"lutBuffer",null);Ht(this,"isInitialized",!1)}async init(){if(this.isInitialized)return!0;if(!navigator.gpu)return console.warn("WebGPU not supported."),!1;try{const t=await navigator.gpu.requestAdapter();if(!t)throw new Error("No GPU adapter found.");const r={};t.limits.maxStorageBufferBindingSize&&(r.maxStorageBufferBindingSize=1024*1024*1024),t.limits.maxBufferSize&&(r.maxBufferSize=1024*1024*1024),this.device=await t.requestDevice({requiredLimits:r});const n=this.device.createBindGroupLayout({entries:[{binding:0,visibility:GPUShaderStage.COMPUTE,buffer:{type:"uniform"}},{binding:1,visibility:GPUShaderStage.COMPUTE,buffer:{type:"read-only-storage"}},{binding:2,visibility:GPUShaderStage.COMPUTE,buffer:{type:"storage"}},{binding:3,visibility:GPUShaderStage.COMPUTE,buffer:{type:"uniform"}},{binding:4,visibility:GPUShaderStage.COMPUTE,buffer:{type:"read-only-storage"}}]}),a=this.device.createShaderModule({code:o_("display")});this.displayPipeline=this.device.createComputePipeline({layout:this.device.createPipelineLayout({bindGroupLayouts:[n]}),compute:{module:a,entryPoint:"main"}});const i=this.device.createShaderModule({code:o_("export")});return this.exportPipeline=this.device.createComputePipeline({layout:this.device.createPipelineLayout({bindGroupLayouts:[n]}),compute:{module:i,entryPoint:"main"}}),this.uniformBuffer=this.device.createBuffer({size:256,usage:GPUBufferUsage.UNIFORM|GPUBufferUsage.COPY_DST}),this.unmixParamsBuffer=this.device.createBuffer({size:64,usage:GPUBufferUsage.UNIFORM|GPUBufferUsage.COPY_DST}),this.lutBuffer=this.device.createBuffer({size:4096,usage:GPUBufferUsage.STORAGE|GPUBufferUsage.COPY_DST}),this.isInitialized=!0,console.log("WebGPU Renderer Initialized"),!0}catch(t){return console.error("WebGPU Init Failed:",t),!1}}hasImage(t){return this.resources.has(t)}async uploadImage(t,r,n,a,i){if(this.isInitialized||await this.init(),!!this.device){if(this.resources.has(t)){const o=this.resources.get(t);if(o&&o.width===n&&o.height===a)return;this.disposeImage(t)}try{const o=n*a,s=Math.ceil(o*2/4)*4,l=this.device.createBuffer({size:s,usage:GPUBufferUsage.STORAGE|GPUBufferUsage.COPY_DST,mappedAtCreation:!0});new Uint16Array(l.getMappedRange()).set(r),l.unmap();const u=o*4,d=this.device.createBuffer({size:u,usage:GPUBufferUsage.STORAGE|GPUBufferUsage.COPY_SRC}),f=this.device.createBuffer({size:u,usage:GPUBufferUsage.MAP_READ|GPUBufferUsage.COPY_DST}),h=this.device.createBindGroup({layout:this.displayPipeline.getBindGroupLayout(0),entries:[{binding:0,resource:{buffer:this.uniformBuffer}},{binding:1,resource:{buffer:l}},{binding:2,resource:{buffer:d}},{binding:3,resource:{buffer:this.unmixParamsBuffer}},{binding:4,resource:{buffer:this.lutBuffer}}]}),g=i??Hoe(r);this.resources.set(t,{width:n,height:a,rawBuffer:l,outputBuffer:d,readBuffer:f,bindGroup:h,whiteLevel:g,busy:!1})}catch(o){console.error("[WebGPU] Buffer creation failed",o)}}}updateUniforms(t,r,n,a){const i=Math.pow(2,r.exposure),o=r.blackLevel||[0,0,0,0],s=r.wbGains||[1,1];let l=65532;r.highlightRecovery&&(l=r.customWhiteLevel??t.whiteLevel??16383);let u=[1,1,1,1];r.isBGGR?u=[s[1],1,1,s[0]]:u=[s[0],1,1,s[1]];let d=[[1,0,0],[0,1,0],[0,0,1]],f=[1,0,0,0,1,0,0,0,1],h=null;if(r.customMatrix&&r.customMatrix.length===9){const k=[[r.customMatrix[0],r.customMatrix[1],r.customMatrix[2]],[r.customMatrix[3],r.customMatrix[4],r.customMatrix[5]],[r.customMatrix[6],r.customMatrix[7],r.customMatrix[8]]],M=oc(k);M&&(d=Hf(Voe,M),f=[d[0][0],d[0][1],d[0][2],d[1][0],d[1][1],d[1][2],d[2][0],d[2][1],d[2][2]],h=oc(d))}const g=f;let v=0;r.renderMode==="zero-dep-color"&&(v=1),r.renderMode==="advanced-zero-dep"&&(v=2);const w=r.zeroDepColorDemosaic==="edge-aware"?1:0;let b=[1,1,1];if(h){b=$E(h,[1,1,1]);const k=Math.max(Math.abs(b[0]),Math.max(Math.abs(b[1]),Math.abs(b[2])));k>1e-6?b=[b[0]/k,b[1]/k,b[2]/k]:b=[1,1,1]}const x=new Float32Array([0,0,l,i,o[0],o[1],o[2],o[3],u[0],u[1],u[2],u[3],g[0],g[1],g[2],g[3],g[4],g[5],g[6],g[7],g[8],0,0,0,b[0],b[1],b[2],0,0,0]),y=new Uint32Array(x.buffer);y[0]=t.width,y[1]=t.height,y[21]=v,y[22]=r.isBGGR?1:0,y[23]=w,y[27]=1,y[28]=a.stretch?1:0,y[29]=a.srgb?1:0,this.device.queue.writeBuffer(this.uniformBuffer,0,x);const _=new Float32Array(16);if(v===2&&r.advancedZeroDep){const k=r.advancedZeroDep;_.set([k.bl[0],k.bl[1],k.bl[2],k.bl[3],Math.max(0,k.bg[0]-k.bl[0]),Math.max(0,k.bg[1]-k.bl[1]),Math.max(0,k.bg[2]-k.bl[2]),Math.max(0,k.bg[3]-k.bl[3]),Math.max(0,k.fg[0]-k.bl[0]),Math.max(0,k.fg[1]-k.bl[1]),Math.max(0,k.fg[2]-k.bl[2]),Math.max(0,k.fg[3]-k.bl[3])])}this.device.queue.writeBuffer(this.unmixParamsBuffer,0,_);const j=new Float32Array(1024),S=r.curves||{master:[{x:0,y:0},{x:1,y:1}],red:[{x:0,y:0},{x:1,y:1}],green:[{x:0,y:0},{x:1,y:1}],blue:[{x:0,y:0},{x:1,y:1}]};j.set(Da(S.master),0),j.set(Da(S.red),256),j.set(Da(S.green),512),j.set(Da(S.blue),768),this.device.queue.writeBuffer(this.lutBuffer,0,j)}async render(t,r,n){if(this.isInitialized||await this.init(),!this.device||!this.displayPipeline)return null;const a=this.resources.get(t);if(!a||a.busy)return null;a.busy=!0;try{this.updateUniforms(a,r,!1,{stretch:!1,srgb:!0});const i=this.device.createCommandEncoder(),o=i.beginComputePass();o.setPipeline(this.displayPipeline),o.setBindGroup(0,a.bindGroup),o.dispatchWorkgroups(Math.ceil(a.width/16),Math.ceil(a.height/16)),o.end(),i.copyBufferToBuffer(a.outputBuffer,0,a.readBuffer,0,a.width*a.height*4),this.device.queue.submit([i.finish()]),await a.readBuffer.mapAsync(GPUMapMode.READ);const s=new Uint8ClampedArray(a.readBuffer.getMappedRange()),l=new ImageData(new Uint8ClampedArray(s),a.width,a.height);return a.readBuffer.unmap(),l}catch(i){console.error("WebGPU Render Error",i);try{a.readBuffer.unmap()}catch{}return null}finally{a.busy=!1}}async export16Bit(t,r,n,a){if(this.isInitialized||await this.init(),!this.device||!this.exportPipeline)return null;const i=this.resources.get(t);if(!i)return null;const o=i.width*i.height*8,s=this.device.createBuffer({size:o,usage:GPUBufferUsage.STORAGE|GPUBufferUsage.COPY_SRC}),l=this.device.createBuffer({size:o,usage:GPUBufferUsage.MAP_READ|GPUBufferUsage.COPY_DST}),u=this.device.createBindGroup({layout:this.exportPipeline.getBindGroupLayout(0),entries:[{binding:0,resource:{buffer:this.uniformBuffer}},{binding:1,resource:{buffer:i.rawBuffer}},{binding:2,resource:{buffer:s}},{binding:3,resource:{buffer:this.unmixParamsBuffer}},{binding:4,resource:{buffer:this.lutBuffer}}]});this.updateUniforms(i,r,!0,{stretch:n,srgb:a});const d=this.device.createCommandEncoder(),f=d.beginComputePass();f.setPipeline(this.exportPipeline),f.setBindGroup(0,u),f.dispatchWorkgroups(Math.ceil(i.width/16),Math.ceil(i.height/16)),f.end(),d.copyBufferToBuffer(s,0,l,0,o),this.device.queue.submit([d.finish()]),await l.mapAsync(GPUMapMode.READ);const h=new Uint32Array(l.getMappedRange()),g=i.width*i.height,v=new Uint16Array(g*3);for(let w=0;w<g;w++){const b=h[w*2],x=h[w*2+1],y=b&65535,_=b>>>16&65535,j=x&65535;v[w*3]=y,v[w*3+1]=_,v[w*3+2]=j}return l.unmap(),s.destroy(),l.destroy(),v}disposeImage(t){const r=this.resources.get(t);r&&(r.rawBuffer.destroy(),r.outputBuffer.destroy(),r.readBuffer.destroy(),this.resources.delete(t))}disposeAll(){this.resources.forEach(t=>{t.rawBuffer.destroy(),t.outputBuffer.destroy(),t.readBuffer.destroy()}),this.resources.clear()}}const $s=new Yoe,qoe=`
struct LayerUniforms {
  width: u32,
  height: u32,
  blendMode: u32,  // 0=add, 1=subtract
  enabled: u32,
  opacity: f32,
  exposure: f32,
  temperature: f32,
  tint: f32,
  contrast: f32,
  highlights: f32,
  shadows: f32,
  vibrance: f32,
  saturation: f32,
  pad0: f32,
  pad1: f32,
  pad2: f32,
  mixerHue0: vec4f, // red, orange, yellow, green
  mixerHue1: vec4f, // aqua, blue, purple, magenta
  mixerSat0: vec4f,
  mixerSat1: vec4f,
  mixerLum0: vec4f,
  mixerLum1: vec4f,
};

@group(0) @binding(0) var<uniform> u: LayerUniforms;
@group(0) @binding(1) var<storage, read_write> work: array<vec4f>;
@group(0) @binding(2) var<storage, read> maskAlpha: array<f32>;
@group(0) @binding(3) var<storage, read> curveLut: array<f32>;

fn clamp01(x: f32) -> f32 {
  return max(0.0, min(1.0, x));
}

fn smoothstep01(edge0: f32, edge1: f32, x: f32) -> f32 {
  let denom = max(1e-6, edge1 - edge0);
  let t = clamp01((x - edge0) / denom);
  return t * t * (3.0 - 2.0 * t);
}

fn tone_adjust(value: f32, amount: f32, weight: f32) -> f32 {
  let amt = clamp(amount, -1.0, 1.0);
  let w = clamp01(weight);
  if (amt >= 0.0) {
    return value + (1.0 - value) * amt * w;
  }
  return value + value * amt * w;
}

fn rgb_to_hsl(c: vec3f) -> vec3f {
  let r = c.x;
  let g = c.y;
  let b = c.z;
  let maxc = max(r, max(g, b));
  let minc = min(r, min(g, b));
  let l = (maxc + minc) * 0.5;
  if (maxc == minc) {
    return vec3f(0.0, 0.0, l);
  }
  let d = maxc - minc;
  var h = 0.0;
  let s = select(d / (maxc + minc), d / (2.0 - maxc - minc), l > 0.5);
  if (maxc == r) {
    h = (g - b) / d + select(6.0, 0.0, g >= b);
  } else if (maxc == g) {
    h = (b - r) / d + 2.0;
  } else {
    h = (r - g) / d + 4.0;
  }
  h = h / 6.0;
  return vec3f(h, s, l);
}

fn hue2rgb(p: f32, q: f32, t: f32) -> f32 {
  var tt = t;
  if (tt < 0.0) { tt = tt + 1.0; }
  if (tt > 1.0) { tt = tt - 1.0; }
  if (tt < (1.0 / 6.0)) { return p + (q - p) * 6.0 * tt; }
  if (tt < 0.5) { return q; }
  if (tt < (2.0 / 3.0)) { return p + (q - p) * ((2.0 / 3.0) - tt) * 6.0; }
  return p;
}

fn hsl_to_rgb(hsl: vec3f) -> vec3f {
  let h = hsl.x;
  let s = hsl.y;
  let l = hsl.z;
  if (s == 0.0) {
    return vec3f(l, l, l);
  }
  let q = select(l * (1.0 + s), l + s - l * s, l >= 0.5);
  let p = 2.0 * l - q;
  return vec3f(
    hue2rgb(p, q, h + (1.0 / 3.0)),
    hue2rgb(p, q, h),
    hue2rgb(p, q, h - (1.0 / 3.0))
  );
}

fn hue_distance_deg(a: f32, b: f32) -> f32 {
  let d = abs(a - b);
  return min(d, 360.0 - d);
}

fn band_weight(hueDeg: f32, centerDeg: f32) -> f32 {
  return clamp01(1.0 - hue_distance_deg(hueDeg, centerDeg) / 45.0);
}

fn apply_lut(val: f32, offset: u32) -> f32 {
  let v = clamp01(val);
  let pos = v * 255.0;
  let idx = u32(pos);
  let f = fract(pos);
  let p0 = curveLut[offset + idx];
  let idxNext = min(idx + 1u, 255u);
  let p1 = curveLut[offset + idxNext];
  return p0 * (1.0 - f) + p1 * f;
}

@compute @workgroup_size(16, 16)
fn main(@builtin(global_invocation_id) gid: vec3u) {
  if (gid.x >= u.width || gid.y >= u.height) { return; }
  if (u.enabled == 0u) { return; }
  let idx = gid.y * u.width + gid.x;

  let mask = clamp01(maskAlpha[idx] * u.opacity);
  if (mask <= 0.0) { return; }

  let src = work[idx].xyz;
  var adjusted = src;

  if (u.exposure != 0.0) {
    adjusted = adjusted * exp2(u.exposure);
  }

  if (u.temperature != 0.0 || u.tint != 0.0) {
    let t = u.temperature / 100.0;
    let ti = u.tint / 100.0;
    adjusted = vec3f(
      adjusted.x * (1.0 + 0.18 * t + 0.08 * ti),
      adjusted.y * (1.0 - 0.16 * ti),
      adjusted.z * (1.0 - 0.18 * t + 0.08 * ti)
    );
  }

  if (u.contrast != 0.0) {
    let contrastScale = 1.0 + (u.contrast / 100.0);
    adjusted = (adjusted - vec3f(0.5, 0.5, 0.5)) * contrastScale + vec3f(0.5, 0.5, 0.5);
  }

  if (u.highlights != 0.0 || u.shadows != 0.0) {
    let lumaNow = clamp01(dot(adjusted, vec3f(0.2126, 0.7152, 0.0722)));
    let wHighlights = smoothstep01(0.5, 1.0, lumaNow);
    let wShadows = 1.0 - smoothstep01(0.0, 0.5, lumaNow);
    let highlightAmount = u.highlights / 100.0;
    let shadowAmount = u.shadows / 100.0;
    adjusted = vec3f(
      tone_adjust(adjusted.x, highlightAmount, wHighlights),
      tone_adjust(adjusted.y, highlightAmount, wHighlights),
      tone_adjust(adjusted.z, highlightAmount, wHighlights)
    );
    adjusted = vec3f(
      tone_adjust(adjusted.x, shadowAmount, wShadows),
      tone_adjust(adjusted.y, shadowAmount, wShadows),
      tone_adjust(adjusted.z, shadowAmount, wShadows)
    );
  }

  if (
    u.vibrance != 0.0 || u.saturation != 0.0 ||
    u.mixerHue0.x != 0.0 || u.mixerHue0.y != 0.0 || u.mixerHue0.z != 0.0 || u.mixerHue0.w != 0.0 ||
    u.mixerHue1.x != 0.0 || u.mixerHue1.y != 0.0 || u.mixerHue1.z != 0.0 || u.mixerHue1.w != 0.0 ||
    u.mixerSat0.x != 0.0 || u.mixerSat0.y != 0.0 || u.mixerSat0.z != 0.0 || u.mixerSat0.w != 0.0 ||
    u.mixerSat1.x != 0.0 || u.mixerSat1.y != 0.0 || u.mixerSat1.z != 0.0 || u.mixerSat1.w != 0.0 ||
    u.mixerLum0.x != 0.0 || u.mixerLum0.y != 0.0 || u.mixerLum0.z != 0.0 || u.mixerLum0.w != 0.0 ||
    u.mixerLum1.x != 0.0 || u.mixerLum1.y != 0.0 || u.mixerLum1.z != 0.0 || u.mixerLum1.w != 0.0
  ) {
    var hsl = rgb_to_hsl(vec3f(clamp01(adjusted.x), clamp01(adjusted.y), clamp01(adjusted.z)));

    if (u.vibrance != 0.0) {
      let vib = u.vibrance / 100.0;
      hsl.y = select(clamp01(hsl.y + vib * hsl.y), clamp01(hsl.y + vib * (1.0 - hsl.y)), vib >= 0.0);
    }
    if (u.saturation != 0.0) {
      hsl.y = clamp01(hsl.y + (u.saturation / 100.0));
    }

    let hueDeg = fract(hsl.x) * 360.0;
    let w0 = band_weight(hueDeg, 0.0);
    let w1 = band_weight(hueDeg, 30.0);
    let w2 = band_weight(hueDeg, 60.0);
    let w3 = band_weight(hueDeg, 120.0);
    let w4 = band_weight(hueDeg, 180.0);
    let w5 = band_weight(hueDeg, 240.0);
    let w6 = band_weight(hueDeg, 285.0);
    let w7 = band_weight(hueDeg, 320.0);

    let sumW = w0 + w1 + w2 + w3 + w4 + w5 + w6 + w7;
    if (sumW > 1e-6) {
      let hueSum =
        w0 * u.mixerHue0.x + w1 * u.mixerHue0.y + w2 * u.mixerHue0.z + w3 * u.mixerHue0.w +
        w4 * u.mixerHue1.x + w5 * u.mixerHue1.y + w6 * u.mixerHue1.z + w7 * u.mixerHue1.w;
      let satSum =
        w0 * u.mixerSat0.x + w1 * u.mixerSat0.y + w2 * u.mixerSat0.z + w3 * u.mixerSat0.w +
        w4 * u.mixerSat1.x + w5 * u.mixerSat1.y + w6 * u.mixerSat1.z + w7 * u.mixerSat1.w;
      let lumSum =
        w0 * u.mixerLum0.x + w1 * u.mixerLum0.y + w2 * u.mixerLum0.z + w3 * u.mixerLum0.w +
        w4 * u.mixerLum1.x + w5 * u.mixerLum1.y + w6 * u.mixerLum1.z + w7 * u.mixerLum1.w;
      let invW = 1.0 / sumW;
      let chromaWeight = clamp01((hsl.y - 0.03) / 0.25);
      let hueShiftNorm = ((hueSum * invW) / 100.0) * (45.0 / 360.0) * chromaWeight;
      hsl.x = fract(hsl.x + hueShiftNorm);
      hsl.y = clamp01(hsl.y + ((satSum * invW) / 100.0) * chromaWeight);
      hsl.z = clamp01(hsl.z + ((lumSum * invW) / 100.0) * chromaWeight);
    }

    adjusted = hsl_to_rgb(hsl);
  }

  let luma = max(0.0, dot(adjusted, vec3f(0.2126, 0.7152, 0.0722)));
  let lumaMapped = apply_lut(luma, 0u);
  let masterScale = select(1.0, lumaMapped / luma, luma > 1e-6);
  let mr = clamp01(adjusted.x * masterScale);
  let mg = clamp01(adjusted.y * masterScale);
  let mb = clamp01(adjusted.z * masterScale);
  adjusted = vec3f(
    apply_lut(mr, 256u),
    apply_lut(mg, 512u),
    apply_lut(mb, 768u)
  );

  let blendValue = select(adjusted, (2.0 * src - adjusted), u.blendMode == 1u);
  let mixed = src * (1.0 - mask) + blendValue * mask;
  work[idx] = vec4f(mixed, 1.0);
}
`,Zoe=`
struct OutputUniforms {
  width: u32,
  height: u32,
};

@group(0) @binding(0) var<uniform> u: OutputUniforms;
@group(0) @binding(1) var<storage, read> work: array<vec4f>;
@group(0) @binding(2) var<storage, read_write> outBuf: array<u32>;

fn clamp01(x: f32) -> f32 {
  return max(0.0, min(1.0, x));
}

fn linear_to_srgb(x: f32) -> f32 {
  let v = clamp01(x);
  if (v <= 0.0031308) {
    return 12.92 * v;
  }
  return 1.055 * pow(v, 1.0 / 2.4) - 0.055;
}

@compute @workgroup_size(16, 16)
fn main(@builtin(global_invocation_id) gid: vec3u) {
  if (gid.x >= u.width || gid.y >= u.height) { return; }
  let idx = gid.y * u.width + gid.x;
  let v = work[idx];
  let r8 = u32(linear_to_srgb(v.x) * 255.0 + 0.5);
  let g8 = u32(linear_to_srgb(v.y) * 255.0 + 0.5);
  let b8 = u32(linear_to_srgb(v.z) * 255.0 + 0.5);
  let a8 = 255u;
  outBuf[idx] = (a8 << 24u) | (b8 << 16u) | (g8 << 8u) | r8;
}
`;class Joe{constructor(){Ht(this,"device",null);Ht(this,"layerPipeline",null);Ht(this,"outputPipeline",null);Ht(this,"layerBindGroupLayout",null);Ht(this,"outputBindGroupLayout",null);Ht(this,"layerUniformBuffer",null);Ht(this,"outputUniformBuffer",null);Ht(this,"initialized",!1);Ht(this,"resources",new Map);Ht(this,"maskCpuCache",new Map);Ht(this,"maxBufferSize",256*1024*1024);Ht(this,"maxStorageBufferBindingSize",128*1024*1024);Ht(this,"lastRenderBusy",!1)}async init(){var t,r;if(this.initialized)return!0;if(!navigator.gpu)return!1;try{const n=await navigator.gpu.requestAdapter();if(!n)return!1;const a={};(t=n.limits)!=null&&t.maxBufferSize&&(this.maxBufferSize=Number(n.limits.maxBufferSize),a.maxBufferSize=this.maxBufferSize),(r=n.limits)!=null&&r.maxStorageBufferBindingSize&&(this.maxStorageBufferBindingSize=Number(n.limits.maxStorageBufferBindingSize),a.maxStorageBufferBindingSize=this.maxStorageBufferBindingSize),this.device=await n.requestDevice({requiredLimits:Object.keys(a).length?a:void 0});const i=this.device.createShaderModule({code:qoe}),o=this.device.createShaderModule({code:Zoe});return this.layerBindGroupLayout=this.device.createBindGroupLayout({entries:[{binding:0,visibility:GPUShaderStage.COMPUTE,buffer:{type:"uniform"}},{binding:1,visibility:GPUShaderStage.COMPUTE,buffer:{type:"storage"}},{binding:2,visibility:GPUShaderStage.COMPUTE,buffer:{type:"read-only-storage"}},{binding:3,visibility:GPUShaderStage.COMPUTE,buffer:{type:"read-only-storage"}}]}),this.outputBindGroupLayout=this.device.createBindGroupLayout({entries:[{binding:0,visibility:GPUShaderStage.COMPUTE,buffer:{type:"uniform"}},{binding:1,visibility:GPUShaderStage.COMPUTE,buffer:{type:"read-only-storage"}},{binding:2,visibility:GPUShaderStage.COMPUTE,buffer:{type:"storage"}}]}),this.layerPipeline=this.device.createComputePipeline({layout:this.device.createPipelineLayout({bindGroupLayouts:[this.layerBindGroupLayout]}),compute:{module:i,entryPoint:"main"}}),this.outputPipeline=this.device.createComputePipeline({layout:this.device.createPipelineLayout({bindGroupLayouts:[this.outputBindGroupLayout]}),compute:{module:o,entryPoint:"main"}}),this.layerUniformBuffer=this.device.createBuffer({size:160,usage:GPUBufferUsage.UNIFORM|GPUBufferUsage.COPY_DST}),this.outputUniformBuffer=this.device.createBuffer({size:16,usage:GPUBufferUsage.UNIFORM|GPUBufferUsage.COPY_DST}),this.initialized=!0,!0}catch(n){return console.error("[PS GPU] init failed",n),!1}}getMaskData(t){const r=`${t.id}:${t.version}`,n=this.maskCpuCache.get(r);if(n)return n;const a=t.alpha;if(this.maskCpuCache.set(r,a),this.maskCpuCache.size>48){const i=this.maskCpuCache.keys().next().value;i&&this.maskCpuCache.delete(i)}return a}ensureResource(t){if(!this.device)return null;let r=this.resources.get(t.id);const n=t.width*t.height,a=n*16,i=n*4;if(a>this.maxBufferSize||a>this.maxStorageBufferBindingSize)return console.warn(`[PS GPU] image too large for current storage buffer limits: ${a} bytes, maxStorageBufferBindingSize=${this.maxStorageBufferBindingSize}, maxBufferSize=${this.maxBufferSize}`),null;if(i>this.maxBufferSize||i>this.maxStorageBufferBindingSize)return console.warn(`[PS GPU] output too large for current storage buffer limits: ${i} bytes, maxStorageBufferBindingSize=${this.maxStorageBufferBindingSize}, maxBufferSize=${this.maxBufferSize}`),null;if(r&&(r.width!==t.width||r.height!==t.height)&&(this.dispose(t.id),r=void 0),r){if(r.baseSourceRef!==t.baseRgb){const o=new Float32Array(n*4);for(let s=0,l=0;s<n;s++,l+=3){const u=s*4;o[u]=t.baseRgb[l],o[u+1]=t.baseRgb[l+1],o[u+2]=t.baseRgb[l+2],o[u+3]=1}this.device.queue.writeBuffer(r.baseBuffer,0,o),r.baseSourceRef=t.baseRgb}}else{const o=new Float32Array(n*4);for(let f=0,h=0;f<n;f++,h+=3){const g=f*4;o[g]=t.baseRgb[h],o[g+1]=t.baseRgb[h+1],o[g+2]=t.baseRgb[h+2],o[g+3]=1}const s=this.device.createBuffer({size:a,usage:GPUBufferUsage.COPY_SRC|GPUBufferUsage.COPY_DST});this.device.queue.writeBuffer(s,0,o);const l=this.device.createBuffer({size:a,usage:GPUBufferUsage.COPY_DST|GPUBufferUsage.STORAGE}),u=this.device.createBuffer({size:i,usage:GPUBufferUsage.STORAGE|GPUBufferUsage.COPY_SRC}),d=this.device.createBuffer({size:i,usage:GPUBufferUsage.MAP_READ|GPUBufferUsage.COPY_DST});r={width:t.width,height:t.height,pixelCount:n,baseBuffer:s,baseSourceRef:t.baseRgb,workBuffer:l,outputBuffer:u,readBuffer:d,busy:!1,maskGpuCache:new Map,curveGpuCache:new Map},this.resources.set(t.id,r)}return r}ensureMaskBuffer(t,r){if(!this.device)return null;const n=`${r.id}:${r.version}`,a=[];for(const l of t.maskGpuCache.keys())l.startsWith(`${r.id}:`)&&l!==n&&a.push(l);for(const l of a){const u=t.maskGpuCache.get(l);u&&u.destroy(),t.maskGpuCache.delete(l)}const i=t.maskGpuCache.get(n);if(i)return i;const o=this.getMaskData(r),s=this.device.createBuffer({size:o.byteLength,usage:GPUBufferUsage.STORAGE|GPUBufferUsage.COPY_DST});return this.device.queue.writeBuffer(s,0,o),t.maskGpuCache.set(n,s),s}ensureCurveBuffer(t,r,n){if(!this.device)return null;const a=Yg(n),i=JSON.stringify(a),o=new Float32Array(1024);o.set(Da(a.master),0),o.set(Da(a.red),256),o.set(Da(a.green),512),o.set(Da(a.blue),768);let s=t.curveGpuCache.get(r);return s||(s={buffer:this.device.createBuffer({size:o.byteLength,usage:GPUBufferUsage.STORAGE|GPUBufferUsage.COPY_DST}),signature:""},t.curveGpuCache.set(r,s)),s.signature!==i&&(this.device.queue.writeBuffer(s.buffer,0,o),s.signature=i),s.buffer}async renderPreview(t){if(!this.initialized&&!await this.init()||!this.device||!this.layerPipeline||!this.outputPipeline||!this.layerUniformBuffer||!this.outputUniformBuffer)return null;const r=this.ensureResource(t);if(!r)return null;if(r.busy)return this.lastRenderBusy=!0,null;this.lastRenderBusy=!1,r.busy=!0;const n=[];try{const a=new Map;for(const f of t.layers)f.enabled&&a.set(f.maskId,f);const i=this.device.createCommandEncoder();i.copyBufferToBuffer(r.baseBuffer,0,r.workBuffer,0,r.pixelCount*16);for(const f of t.masks){const h=a.get(f.id);if(!h||!f.visible)continue;const g=this.ensureMaskBuffer(r,f),v=this.ensureCurveBuffer(r,h.id,h.curves);if(!g||!v)continue;const w=Su(h.basic),b=_u(h.mixer),x=new Float32Array(40),y=new Uint32Array(x.buffer);y[0]=r.width,y[1]=r.height,y[2]=h.blendMode==="subtract"?1:0,y[3]=h.enabled?1:0,x[4]=h.opacity,x[5]=w.exposure,x[6]=w.temperature,x[7]=w.tint,x[8]=w.contrast,x[9]=w.highlights,x[10]=w.shadows,x[11]=w.vibrance,x[12]=w.saturation,x[16]=b.red.hue,x[17]=b.orange.hue,x[18]=b.yellow.hue,x[19]=b.green.hue,x[20]=b.aqua.hue,x[21]=b.blue.hue,x[22]=b.purple.hue,x[23]=b.magenta.hue,x[24]=b.red.saturation,x[25]=b.orange.saturation,x[26]=b.yellow.saturation,x[27]=b.green.saturation,x[28]=b.aqua.saturation,x[29]=b.blue.saturation,x[30]=b.purple.saturation,x[31]=b.magenta.saturation,x[32]=b.red.luminance,x[33]=b.orange.luminance,x[34]=b.yellow.luminance,x[35]=b.green.luminance,x[36]=b.aqua.luminance,x[37]=b.blue.luminance,x[38]=b.purple.luminance,x[39]=b.magenta.luminance;const _=this.device.createBuffer({size:160,usage:GPUBufferUsage.UNIFORM|GPUBufferUsage.COPY_DST});this.device.queue.writeBuffer(_,0,x),n.push(_);const j=this.device.createBindGroup({layout:this.layerBindGroupLayout,entries:[{binding:0,resource:{buffer:_}},{binding:1,resource:{buffer:r.workBuffer}},{binding:2,resource:{buffer:g}},{binding:3,resource:{buffer:v}}]}),S=i.beginComputePass();S.setPipeline(this.layerPipeline),S.setBindGroup(0,j),S.dispatchWorkgroups(Math.ceil(r.width/16),Math.ceil(r.height/16)),S.end()}const o=new Uint32Array(4);o[0]=r.width,o[1]=r.height,this.device.queue.writeBuffer(this.outputUniformBuffer,0,o);const s=this.device.createBindGroup({layout:this.outputBindGroupLayout,entries:[{binding:0,resource:{buffer:this.outputUniformBuffer}},{binding:1,resource:{buffer:r.workBuffer}},{binding:2,resource:{buffer:r.outputBuffer}}]}),l=i.beginComputePass();l.setPipeline(this.outputPipeline),l.setBindGroup(0,s),l.dispatchWorkgroups(Math.ceil(r.width/16),Math.ceil(r.height/16)),l.end(),i.copyBufferToBuffer(r.outputBuffer,0,r.readBuffer,0,r.pixelCount*4),this.device.queue.submit([i.finish()]),await r.readBuffer.mapAsync(GPUMapMode.READ);const u=new Uint8ClampedArray(r.readBuffer.getMappedRange()),d=new ImageData(new Uint8ClampedArray(u),r.width,r.height);return r.readBuffer.unmap(),d}catch(a){console.error("[PS GPU] render failed",a);try{r.readBuffer.unmap()}catch{}return null}finally{for(const a of n)try{a.destroy()}catch{}r.busy=!1}}dispose(t){const r=this.resources.get(t);if(r){r.baseBuffer.destroy(),r.workBuffer.destroy(),r.outputBuffer.destroy(),r.readBuffer.destroy();for(const n of r.maskGpuCache.values())n.destroy();for(const n of r.curveGpuCache.values())n.buffer.destroy();this.resources.delete(t)}}wasBusyLastRender(){return this.lastRenderBusy}}const Ih=new Joe,Rh=1024,s_=/\.(arw|cr2|cr3|dng|nef|orf|raf|rw2|pef|srw|sr2|srf|x3f|erf|mef|mos|mrw|kdc|dcr|iiq|3fr|fff|rwl|nrw|raw)$/i,af="jiangtherapee onlinecsv",l_="jiangtherapee.ps.workflow.json",c_=80,Qoe=20,ese=6,Xn=e=>({x:e.x,y:e.y}),ec=e=>({...e,p1:Xn(e.p1),p2:Xn(e.p2)}),UO=e=>({model:e.model,focal:Number(e.focal)||0,k1:Number(e.k1)||0,k2:Number(e.k2)||0,a:Number(e.a)||0,b:Number(e.b)||0,c:Number(e.c)||0,lensLabel:e.lensLabel||""}),GO=e=>{switch(e.type){case"crop":return{type:"crop",rect:{...e.rect}};case"rotate":return{type:"rotate",angleDeg:e.angleDeg};case"flipH":return{type:"flipH"};case"flipV":return{type:"flipV"};case"lensDistortion":return{type:"lensDistortion",params:UO(e.params)};case"upright":return{type:"upright",guides:e.guides.map(ec)}}},Gs=e=>e.map(GO),Qu=e=>e.type==="ellipse"?{...e,center:Xn(e.center)}:{...e,points:e.points.map(t=>Xn(t))},pw=e=>{const t=Su(e==null?void 0:e.basic),r=e==null?void 0:e.hsl;return!(e!=null&&e.basic)&&r&&(t.saturation=Math.max(-100,Math.min(100,Number(r.saturation)||0)),t.exposure=Math.max(-5,Math.min(5,(Number(r.lightness)||0)/100*1.5))),t},gw=e=>{const t=_u(e==null?void 0:e.mixer),r=e==null?void 0:e.hsl;if(!(e!=null&&e.mixer)&&r&&Number.isFinite(Number(r.hue))){const n=Math.max(-100,Math.min(100,Number(r.hue)/180*100));return{red:{...t.red,hue:n},orange:{...t.orange,hue:n},yellow:{...t.yellow,hue:n},green:{...t.green,hue:n},aqua:{...t.aqua,hue:n},blue:{...t.blue,hue:n},purple:{...t.purple,hue:n},magenta:{...t.magenta,hue:n}}}return t},Dh=e=>({...e,baseRgb:e.baseRgb,masks:e.masks.map(t=>({...t,alpha:t.alpha,items:(t.items||[]).map(Qu)})),layers:e.layers.map(t=>({...t,basic:pw(t),mixer:gw(t),curves:{master:t.curves.master.map(Xn),red:t.curves.red.map(Xn),green:t.curves.green.map(Xn),blue:t.curves.blue.map(Xn)}})),guides:e.guides.map(t=>({...t,p1:Xn(t.p1),p2:Xn(t.p2)})),transform:{rotationDeg:e.transform.rotationDeg,crop:e.transform.crop?{...e.transform.crop}:null},history:e.history.map(t=>({...t}))}),Eg=e=>{var t,r,n,a;return{...e,basic:pw(e),mixer:gw(e),curves:{master:(((t=e.curves)==null?void 0:t.master)||[{x:0,y:0},{x:1,y:1}]).map(Xn),red:(((r=e.curves)==null?void 0:r.red)||[{x:0,y:0},{x:1,y:1}]).map(Xn),green:(((n=e.curves)==null?void 0:n.green)||[{x:0,y:0},{x:1,y:1}]).map(Xn),blue:(((a=e.curves)==null?void 0:a.blue)||[{x:0,y:0},{x:1,y:1}]).map(Xn)}}},tse=e=>({id:e.id,name:e.name,shape:e.shape,visible:e.visible,overlayVisible:e.overlayVisible??!0,items:(e.items||[]).map(Qu)}),u_=(e,t)=>({width:e.width,height:e.height,transformOps:Gs(t),masks:e.masks.map(tse),layers:e.layers.map(Eg),guides:e.guides.map(ec),selectedMaskId:e.selectedMaskId,selectedLayerId:e.selectedLayerId,selectedMaskItemId:e.selectedMaskItemId,selectedGuideId:e.selectedGuideId,transform:{rotationDeg:e.transform.rotationDeg,crop:e.transform.crop?{...e.transform.crop}:null}}),d_=(e,t)=>{var v,w,b;const r=Number(t.width),n=Number(t.height);if(!Number.isFinite(r)||!Number.isFinite(n)||r<=0||n<=0)throw new Error("Invalid workflow canvas size.");const a=Gs(t.transformOps||[]),i=rse(e,a);if(i.width!==r||i.height!==n)throw new Error(`Workflow transform replay size mismatch: expected ${r}x${n}, got ${i.width}x${i.height}.`);const o=(t.masks||[]).map(x=>({id:x.id,name:x.name,shape:x.shape||"full",width:r,height:n,alpha:new Float32Array(r*n),featherPx:0,visible:x.visible!==!1,overlayVisible:x.overlayVisible!==!1,version:1,items:(x.items||[]).map(Qu)})),s=((v=o[0])==null?void 0:v.id)||"",l=(t.layers||[]).map(x=>({...Eg(x),maskId:o.some(y=>y.id===x.maskId)?x.maskId:s})),u=(t.guides||[]).map(ec),d=o.some(x=>x.id===t.selectedMaskId)?t.selectedMaskId:((w=o[0])==null?void 0:w.id)||"",f=l.some(x=>x.id===t.selectedLayerId)?t.selectedLayerId:((b=l[0])==null?void 0:b.id)||"",h=t.selectedGuideId&&u.some(x=>x.id===t.selectedGuideId)?t.selectedGuideId:null,g=t.selectedMaskItemId&&o.some(x=>(x.items||[]).some(y=>y.id===t.selectedMaskItemId))?t.selectedMaskItemId:null;return CP({...i,width:r,height:n,masks:o,layers:l,guides:u,selectedMaskId:d,selectedLayerId:f,selectedMaskItemId:g,selectedGuideId:h,transform:t.transform?{rotationDeg:Number(t.transform.rotationDeg)||0,crop:t.transform.crop?{...t.transform.crop}:null}:{rotationDeg:0,crop:null}})},xx=e=>{const t={...e,baseRgb:e.baseRgb,masks:e.masks.map(r=>({...r,alpha:new Float32Array(r.width*r.height),items:(r.items||[]).map(Qu)})),layers:e.layers.map(r=>({...r,basic:pw(r),mixer:gw(r),curves:{master:r.curves.master.map(Xn),red:r.curves.red.map(Xn),green:r.curves.green.map(Xn),blue:r.curves.blue.map(Xn)}})),guides:e.guides.map(r=>({...r,p1:Xn(r.p1),p2:Xn(r.p2)})),transform:{rotationDeg:e.transform.rotationDeg,crop:e.transform.crop?{...e.transform.crop}:null},history:e.history.map(r=>({...r}))};return CP(t)},rse=(e,t)=>{var n;let r=e;for(const a of t){if(a.type==="crop"){r=EP(r,a.rect);continue}if(a.type==="rotate"){r=TP(r,a.angleDeg);continue}if(a.type==="flipH"){r=IP(r);continue}if(a.type==="flipV"){r=RP(r);continue}if(a.type==="lensDistortion"){r=DP(r,a.params);continue}const i={...r,guides:a.guides.map(ec),selectedGuideId:((n=a.guides[0])==null?void 0:n.id)||null};r=$P(i)}return r},nse=e=>{const t=atob(e);let r="";for(let n=0;n<t.length;n++)r+=`%${t.charCodeAt(n).toString(16).padStart(2,"0")}`;return decodeURIComponent(r)},f_=e=>{const t=e.trim();return t.startsWith('"')&&t.endsWith('"')?t.slice(1,-1).replace(/""/g,'"'):t},ase=e=>{const t=[];let r="",n=!1;for(let a=0;a<e.length;a++){const i=e[a];if(i==='"'){n&&e[a+1]==='"'?(r+='"',a++):n=!n;continue}if(i===","&&!n){t.push(r),r="";continue}r+=i}return t.push(r),t},h_=e=>(e||"image").replace(/\.[^/.]+$/,"")||"image",ise=(e,t,r)=>{const n=e.width,a=e.height,i=new ImageData(t,r),o=e.data,s=i.data,l=n/t,u=a/r;for(let d=0;d<r;d++){const f=Math.floor(d*u),h=d*t*4,g=f*n*4;for(let v=0;v<t;v++){const b=Math.floor(v*l)*4,x=h+v*4,y=g+b;s[x]=o[y],s[x+1]=o[y+1],s[x+2]=o[y+2],s[x+3]=o[y+3]}}return i},ose=(e,t)=>{if(!e)return null;if(t){const r=e.bayerPattern.toUpperCase(),n=l=>{const u=[];for(let d=0;d<4;d++)r[d]===l&&u.push(d);return u},a=t.BlackLevelRed,i=t.BlackLevelGreen,o=t.BlackLevelBlue;if(a!==void 0&&i!==void 0&&o!==void 0){const l=parseFloat(a),u=parseFloat(i),d=parseFloat(o);if(!isNaN(l)&&!isNaN(u)&&!isNaN(d)){const f=[0,0,0,0];if(f.fill(u),n("R").forEach(h=>f[h]=l),n("G").forEach(h=>f[h]=u),n("B").forEach(h=>d),f.some(h=>h>0))return f}}let s=t.BlackLevel;if(s===void 0&&(s=t.BlackLevel2),s!==void 0){let l=[];if(Array.isArray(s)?l=s.map(Number):typeof s=="string"?l=s.trim().split(/\s+/).map(Number):typeof s=="number"&&(l=[s,s,s,s]),l.length===1&&!isNaN(l[0])&&(l=[l[0],l[0],l[0],l[0]]),l.length>=4&&!l.slice(0,4).some(isNaN)&&l.some(u=>u>0))return[l[0],l[1],l[2],l[3]]}}return e.blackLevels&&e.blackLevels.length===4?[e.blackLevels[0],e.blackLevels[1],e.blackLevels[2],e.blackLevels[3]]:null},sse=({stats:e,onClose:t,onMinimize:r,isBGGR:n,onToggleBGGR:a,onOpenWindow:i,displaySettings:o,zIndex:s,onFocus:l,rawImageData:u})=>{if(!e)return null;const d=!!o.showKadc,f=o.blackLevel||[0,0,0,0],h=!!o.subtractBlackLevelFromStats&&!!o.blackLevel,g=!!(u!=null&&u.isThreePlane),v=P.useMemo(()=>{if(!e||!u||!o.advancedZeroDep||o.renderMode!=="advanced-zero-dep")return null;try{const{x:j,y:S,width:k,height:M}=e,N=i2(u,{x:j,y:S,w:k,h:M},o),T=[0,0,0,0],A=[0,0,0,0],D=Math.floor(S),$=Math.floor(j);for(let B=0;B<N.height;B++){const J=B*N.width;for(let W=0;W<N.width;W++){const I=N.data[J+W],G=D+B,U=$+W,X=G%2,V=U%2,z=X*2+V;T[z]+=I,A[z]++}}return T.map((B,J)=>A[J]>0?B/A[J]:0)}catch(j){return console.error("Unmix calc error",j),null}},[e,u,o]),w=(j,S,k)=>d?S<=1e-4?0:(j-k)/S:null,b=(j,S)=>h?j-f[S]:j,x=()=>{if(!h){alert(`Sub. BL
Please enable 'Sub. BL' in Tools sidebar first.`);return}let j,S,k,M;n?(M=0,S=1,k=2,j=3):(j=0,S=1,k=2,M=3);const N=A=>e.means[A]-f[A],T=A=>e.stdDevs[A];localStorage.setItem("import_signal_r",N(j).toString()),localStorage.setItem("import_signal_g1",N(S).toString()),localStorage.setItem("import_signal_g2",N(k).toString()),localStorage.setItem("import_signal_b",N(M).toString()),localStorage.setItem("import_sigma_r",T(j).toString()),localStorage.setItem("import_sigma_g1",T(S).toString()),localStorage.setItem("import_sigma_g2",T(k).toString()),localStorage.setItem("import_sigma_b",T(M).toString()),window.open("https://y-g-jiang.github.io/XJZS.html","_blank")},y=g?[{name:"R",desc:"RGB",mean:b(e.means[0],0),std:e.stdDevs[0],color:"text-red-500",snr:w(e.means[0],e.stdDevs[0],f[0]),unmixed:null},{name:"G",desc:"RGB",mean:b(e.means[1],1),std:e.stdDevs[1],color:"text-green-500",snr:w(e.means[1],e.stdDevs[1],f[1]),unmixed:null},{name:"B",desc:"RGB",mean:b(e.means[2],2),std:e.stdDevs[2],color:"text-blue-500",snr:w(e.means[2],e.stdDevs[2],f[2]),unmixed:null}]:n?[{name:"B",desc:"(0,0)",mean:b(e.means[0],0),std:e.stdDevs[0],color:"text-blue-500",snr:w(e.means[0],e.stdDevs[0],f[0]),unmixed:v?v[0]:null},{name:"G1",desc:"(0,1)",mean:b(e.means[1],1),std:e.stdDevs[1],color:"text-green-500",snr:w(e.means[1],e.stdDevs[1],f[1]),unmixed:v?v[1]:null},{name:"G2",desc:"(1,0)",mean:b(e.means[2],2),std:e.stdDevs[2],color:"text-green-500",snr:w(e.means[2],e.stdDevs[2],f[2]),unmixed:v?v[2]:null},{name:"R",desc:"(1,1)",mean:b(e.means[3],3),std:e.stdDevs[3],color:"text-red-500",snr:w(e.means[3],e.stdDevs[3],f[3]),unmixed:v?v[3]:null}]:[{name:"R",desc:"(0,0)",mean:b(e.means[0],0),std:e.stdDevs[0],color:"text-red-500",snr:w(e.means[0],e.stdDevs[0],f[0]),unmixed:v?v[0]:null},{name:"G1",desc:"(0,1)",mean:b(e.means[1],1),std:e.stdDevs[1],color:"text-green-500",snr:w(e.means[1],e.stdDevs[1],f[1]),unmixed:v?v[1]:null},{name:"G2",desc:"(1,0)",mean:b(e.means[2],2),std:e.stdDevs[2],color:"text-green-500",snr:w(e.means[2],e.stdDevs[2],f[2]),unmixed:v?v[2]:null},{name:"B",desc:"(1,1)",mean:b(e.means[3],3),std:e.stdDevs[3],color:"text-blue-500",snr:w(e.means[3],e.stdDevs[3],f[3]),unmixed:v?v[3]:null}],_=v?"w-96":d?"w-80":"w-60";return c.jsxs(Cl,{className:`${_} p-0 overflow-hidden transition-all duration-300 bg-white dark:bg-black border-2 border-black dark:border-white shadow-[4px_4px_0px_rgba(0,0,0,0.5)] dark:shadow-[4px_4px_0px_rgba(255,255,255,0.2)]`,onClose:t,zIndex:s,onFocus:l,initialPosition:{x:20,y:80},children:[c.jsxs("div",{className:"flex justify-between items-center px-3 py-2 border-b border-gray-100 dark:border-slate-800 bg-gray-50/50 dark:bg-slate-800/50 select-none",children:[c.jsxs("h3",{className:"text-xs font-bold text-gray-700 dark:text-slate-300 uppercase tracking-wider flex items-center gap-2",children:["ROI Analysis",c.jsxs("span",{className:"text-[10px] font-normal text-gray-400 bg-gray-200 dark:bg-slate-700 px-1.5 py-0.5 rounded",children:[Math.round(e.width),"",Math.round(e.height)]})]}),c.jsxs("div",{className:"flex items-center gap-1",children:[c.jsx("button",{onClick:r,className:"text-gray-400 hover:text-gray-600 dark:hover:text-slate-300 transition-colors p-1 rounded-md hover:bg-gray-200 dark:hover:bg-slate-700 relative z-20",children:c.jsx("svg",{className:"w-3.5 h-3.5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M20 12H4"})})}),c.jsx("button",{onClick:t,className:"text-gray-400 hover:text-red-500 dark:hover:text-red-400 transition-colors p-1 rounded-md hover:bg-gray-200 dark:hover:bg-slate-700 relative z-20",children:c.jsx("svg",{className:"w-3.5 h-3.5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]})]}),c.jsxs("div",{className:"p-3",children:[c.jsxs("div",{className:"flex justify-between items-center mb-3",children:[c.jsxs("div",{className:"text-[10px] text-gray-400 dark:text-slate-500 font-mono leading-tight",children:["X: ",Math.round(e.x),c.jsx("br",{}),"Y: ",Math.round(e.y)]}),!g&&c.jsx("button",{onClick:()=>a(!n),className:"text-[10px] font-bold px-2 py-1 rounded bg-gray-100 hover:bg-gray-200 dark:bg-slate-800 dark:hover:bg-slate-700 text-gray-600 dark:text-slate-300 transition-colors border border-gray-200 dark:border-slate-700 relative z-20",title:"Toggle Bayer Pattern Interpretation",children:n?"BGGR":"RGGB"})]}),c.jsxs("table",{className:"w-full mb-3",children:[c.jsx("thead",{children:c.jsxs("tr",{className:"text-[10px] text-gray-400 dark:text-slate-500 border-b border-gray-100 dark:border-slate-800",children:[c.jsx("th",{className:"text-left pb-1 font-medium",children:"Ch"}),c.jsxs("th",{className:"text-right pb-1 font-medium",children:["Mean",h?"*":""]}),c.jsx("th",{className:"text-right pb-1 font-medium",children:"Std()"}),d&&c.jsx("th",{className:"text-right pb-1 font-medium text-cyan-600 dark:text-cyan-400",children:"k"}),v&&c.jsx("th",{className:"text-right pb-1 font-medium text-indigo-600 dark:text-indigo-400",children:"Unmix"})]})}),c.jsx("tbody",{className:"font-mono text-xs",children:y.map((j,S)=>c.jsxs("tr",{className:"group hover:bg-gray-50 dark:hover:bg-slate-800/30 transition-colors",children:[c.jsxs("td",{className:"py-1",children:[c.jsx("span",{className:`font-bold ${j.color}`,children:j.name}),c.jsx("span",{className:"text-[9px] text-gray-300 dark:text-slate-600 ml-1 hidden group-hover:inline",children:j.desc})]}),c.jsx("td",{className:"py-1 text-right text-gray-700 dark:text-slate-200 font-semibold",children:j.mean.toFixed(2)}),c.jsx("td",{className:"py-1 text-right text-gray-500 dark:text-slate-400",children:j.std.toFixed(2)}),d&&c.jsx("td",{className:"py-1 text-right text-cyan-600 dark:text-cyan-400 font-bold",children:j.snr!==null?j.snr.toFixed(2):"-"}),v&&c.jsx("td",{className:"py-1 text-right text-indigo-600 dark:text-indigo-400 font-bold",children:j.unmixed!==null?j.unmixed.toFixed(1):"-"})]},S))})]}),h&&c.jsx("div",{className:"mb-2 text-[9px] text-gray-400 dark:text-slate-500 text-right italic",children:"* Mean adjusted by Black Level"}),c.jsxs("div",{className:"flex flex-wrap gap-2",children:[c.jsx("button",{onClick:()=>i("histogram"),className:"relative z-20 flex-1 min-w-[50px] py-1.5 bg-cyan-600 hover:bg-cyan-500 text-white text-[10px] font-bold uppercase tracking-wide rounded shadow-sm hover:shadow transition-all active:scale-95 flex items-center justify-center gap-1",children:"Hist"}),c.jsx("button",{onClick:()=>i("quant"),className:"relative z-20 flex-1 min-w-[50px] py-1.5 bg-teal-600 hover:bg-teal-500 text-white text-[10px] font-bold uppercase tracking-wide rounded shadow-sm hover:shadow transition-all active:scale-95 flex items-center justify-center gap-1",children:"Quant"}),c.jsx("button",{onClick:()=>i("fft"),className:"relative z-20 flex-1 min-w-[50px] py-1.5 bg-purple-600 hover:bg-purple-500 text-white text-[10px] font-bold uppercase tracking-wide rounded shadow-sm hover:shadow transition-all active:scale-95 flex items-center justify-center gap-1",children:"FFT"}),c.jsx("button",{onClick:()=>i("pearson"),className:"relative z-20 flex-1 min-w-[50px] py-1.5 bg-indigo-600 hover:bg-indigo-500 text-white text-[10px] font-bold uppercase tracking-wide rounded shadow-sm hover:shadow transition-all active:scale-95 flex items-center justify-center gap-1",children:"PCC"}),!g&&c.jsx("button",{onClick:x,className:"relative z-20 flex-1 min-w-[50px] py-1.5 bg-pink-600 hover:bg-pink-500 text-white text-[10px] font-bold uppercase tracking-wide rounded shadow-sm hover:shadow transition-all active:scale-95 flex items-center justify-center gap-1",children:"ColorN"})]})]})]})},lse=()=>{var vw;const[e,t]=P.useState("init"),[r,n]=P.useState("Checking storage..."),[a,i]=P.useState(null),o=P.useRef(!1),[s,l]=P.useState("dark"),[u,d]=P.useState(!1);P.useEffect(()=>((async()=>{const H=await $s.init();d(H),console.log("WebGPU Available:",H)})(),()=>{$s.disposeAll()}),[]),P.useEffect(()=>{const E=window.document.documentElement;E.classList.remove(s==="dark"?"light":"dark"),E.classList.add(s)},[s]);const[f,h]=P.useState(!1),[g,v]=P.useState(!1),[w,b]=P.useState(!1),[x,y]=P.useState(!1),[_,j]=P.useState(!1),[S,k]=P.useState(!1),M=Ooe(f||g||w),[N,T]=P.useState(!1),[A,D]=P.useState([]),[$,B]=P.useState(-1),[J,W]=P.useState([]),I=P.useMemo(()=>A[$],[A,$]),G=P.useRef(null);P.useEffect(()=>{G.current=I||null},[I]);const U=P.useRef({}),X=(I==null?void 0:I.file)||null,V=(I==null?void 0:I.imageElement)||null,z=(I==null?void 0:I.rawImageData)||null,q=(I==null?void 0:I.rawFileBuffer)||null,te=(I==null?void 0:I.renderedRawImageData)||null,ie=(I==null?void 0:I.referenceImageData)||null,he=(I==null?void 0:I.sampledImageData)||null,ee=(I==null?void 0:I.exifData)||null,Le=(I==null?void 0:I.isThreePlane)||!1,fe=(I==null?void 0:I.psDocument)||null,ce=(I==null?void 0:I.xtransPhase)||{x:0,y:0},de=(I==null?void 0:I.displaySettings)||{exposure:0,demosaicMethod:3,blackLevel:void 0,wbGains:[1,1],showKadc:!0,subtractBlackLevelFromStats:!0},Ne=P.useMemo(()=>fe?{...fe,guides:[],selectedGuideId:null}:null,[fe==null?void 0:fe.id,fe==null?void 0:fe.width,fe==null?void 0:fe.height,fe==null?void 0:fe.baseRgb,fe==null?void 0:fe.masks,fe==null?void 0:fe.layers,fe==null?void 0:fe.selectedMaskId,fe==null?void 0:fe.selectedLayerId,fe==null?void 0:fe.transform,fe==null?void 0:fe.historyIndex]),[pe,ke]=P.useState(!1),[me,Be]=P.useState(null),[Se,we]=P.useState(!1),[Re,it]=P.useState(!1),[Qe,se]=P.useState(null),[Xe,ht]=P.useState([]),[Zt,Jt]=P.useState(100),[Ut,Lt]=P.useState(!0),[pr,ir]=P.useState(!1),[zt,Tr]=P.useState(null),[lt,Nt]=P.useState(!1),[wr,kr]=P.useState(!1),[_r,zr]=P.useState(!1),[Or,or]=P.useState(!1),[Br,Xt]=P.useState(!1),[Te,Q]=P.useState("1.0"),[Ce,ye]=P.useState(!1),[ze,ot]=P.useState(!1),[ct,Ct]=P.useState(!1),[tt,Hr]=P.useState(!1),[gr,Qt]=P.useState(!1),[jt,mr]=P.useState(32),[R,sr]=P.useState(.35),[Fr,Me]=P.useState(.6),[ut,gt]=P.useState(24),[yr,lr]=P.useState("add"),[et,tr]=P.useState(null),[rr,Dt]=P.useState("off"),[Et,_e]=P.useState(null),[fr,F]=P.useState(null),[Oe,Ie]=P.useState(!1),[Tt,Ve]=P.useState(null),[pt,Ye]=P.useState(null),Wt=P.useRef({}),Ir=P.useRef(null),Qr=P.useRef([]),Kt=P.useRef(null),Pn=P.useRef(null);P.useEffect(()=>{Kt.current=Tt},[Tt]),P.useEffect(()=>{Pn.current=pt},[pt]);const[qr,Xr]=P.useState([]),[cr,nr]=P.useState(!1),[Ar,qe]=P.useState(0),[hr,fn]=P.useState([]),[Ln,Zn]=P.useState(!1),[Tn,Oi]=P.useState({x:0,y:0}),[ue,ve]=P.useState(!1),[be,ae]=P.useState(!1),[$e,mt]=P.useState([]),[bt,Ot]=P.useState(0),[Bt,At]=P.useState(null),[Kr,jr]=P.useState(!1),[Er,Rr]=P.useState([]),[De,Mt]=P.useState(.5),[wt,Wr]=P.useState(!1),[xr,Jn]=P.useState(2),[Cr,en]=P.useState(1),[yn,mi]=P.useState([]),[qi,bs]=P.useState(null),[xa,Zi]=P.useState(0),[yi,In]=P.useState([]),[Qa,So]=P.useState([]),[ei,ti]=P.useState(64),[La,tn]=P.useState(10),[Ca,ws]=P.useState(10),[Ma,rt]=P.useState(4),[Yt,Vt]=P.useState(1),[Gt,Qn]=P.useState(0),[cn,ua]=P.useState("processed"),[ri,Bn]=P.useState(!1),Na=P.useMemo(()=>de.blackLevel?de.blackLevel:z!=null&&z.blackLevels?[z.blackLevels[0],z.blackLevels[1],z.blackLevels[2],z.blackLevels[3]]:[0,0,0,0],[de.blackLevel,z]),an=(ee==null?void 0:ee.ImageHeight)||(ee==null?void 0:ee.ExifImageHeight)||(z==null?void 0:z.height)||0,[Vo,_t]=P.useState(null),[Ji,It]=P.useState(null),[Qi,_o]=P.useState({x:0,y:0}),[ni,ks]=P.useState(1),[Ss,vd]=P.useState("pan"),Ml=P.useRef(null),zn=P.useRef(null);P.useEffect(()=>{if(u&&I&&I.rawImageData&&I.id){const{data:E,width:H,height:Z}=I.rawImageData;$s.uploadImage(I.id,E,H,Z)}},[u,I==null?void 0:I.id]),P.useEffect(()=>{const E=$oe();E&&E.sessions.length>0?(i(E),t("prompt")):t("idle")},[]),P.useCallback(async()=>{o.current=!0,n("Cleaning up..."),localStorage.removeItem("jtr_workspace_index");try{await Roe()}catch(E){console.error("Failed to clear DB",E)}t("idle"),i(null),o.current=!1},[]),P.useCallback(async()=>{if(!a)return;t("restoring"),n("Restoring layout...");const E=a;if(l(E.theme),Lt(E.sidebarOpen),E.sessions.length>0){n(`Restoring ${E.sessions.length} images...`);const H=[];for(const Z of E.sessions){if(o.current)return;await new Promise(re=>setTimeout(re,50));try{const re=await Ioe(Z.id);if(re){const xe={id:Z.id,fileName:Z.fileName,file:null,imageElement:null,rawImageData:null,rawFileBuffer:re,renderedRawImageData:null,referenceImageData:null,sampledImageData:null,exifData:null,isThreePlane:Z.isThreePlane,displaySettings:Z.displaySettings,originalRawFileBuffer:null,isXTransOriginal:!1,isXTransConverted:!1,xtransPhase:{x:0,y:0},psDocument:null},{previewBlob:Ee,analysisData:Ae}=await Bc(re);let He=null;if(Ae)try{Z.displaySettings.renderMode==="zero-dependency"?He=await Dy(re,Z.displaySettings):Z.displaySettings.renderMode==="advanced-zero-dep"?He=await XT(re,Z.displaySettings):Z.displaySettings.renderMode==="zero-dep-color"?He=await HT(re,Z.displaySettings):He=await VT(re,Z.displaySettings)}catch(nt){console.error("Render failed",nt),He=await Dy(re,Z.displaySettings)}const Ke=URL.createObjectURL(Ee),Ue=new Image;Ue.src=Ke,await new Promise(nt=>{Ue.onload=()=>nt()}),H.push({...xe,rawImageData:Ae,renderedRawImageData:He,previewUrl:Ke,imageElement:Ue,exifData:Ae.metadata})}}catch(re){console.error(`Failed to restore session ${Z.id}`,re)}}if(o.current)return;if(D(H),E.activeSessionId){const Z=H.findIndex(re=>re.id===E.activeSessionId);Z>=0?B(Z):H.length>0&&B(0)}ht(E.windows)}o.current||t("idle")},[a]);const _s=P.useCallback(async()=>{zr(!1);const E=I;if(u&&E&&E.id&&$s.hasImage(E.id)&&(E.displaySettings.renderMode||"standard")!=="standard"){It("Exporting via WebGPU...");try{const re=await $s.export16Bit(E.id,E.displaySettings,Or,Br);if(re){const xe=n_(E.rawImageData.width,E.rawImageData.height,re,3),Ee=new Blob([xe],{type:"image/tiff"}),Ae=URL.createObjectURL(Ee),He=document.createElement("a");He.href=Ae,He.download=`export_webgpu_${Date.now()}.tiff`,document.body.appendChild(He),He.click(),document.body.removeChild(He),URL.revokeObjectURL(Ae),It(null);return}}catch(re){console.error("WebGPU Export Failed, falling back to CPU",re)}}!q||!I||(It("Exporting 16-bit TIFF (CPU)..."),setTimeout(async()=>{try{const H=await eC(q,de,Or,Br),Z=n_(H.width,H.height,H.data,H.channels),re=new Blob([Z],{type:"image/tiff"}),xe=URL.createObjectURL(re),Ee=document.createElement("a");Ee.href=xe,Ee.download=`export_${Date.now()}.tiff`,document.body.appendChild(Ee),Ee.click(),document.body.removeChild(Ee),URL.revokeObjectURL(xe)}catch(H){_t("Export failed: "+H.message)}finally{It(null)}},100))},[q,I,de,Or,Br,u]),js=P.useCallback(()=>{!q||!I||zr(!0)},[q,I]),Cc=P.useCallback(async()=>{},[z,I,Te,Na]);P.useEffect(()=>{const E=H=>{(H.ctrlKey||H.metaKey)&&H.key.toLowerCase()==="s"&&(H.preventDefault(),js())};return window.addEventListener("keydown",E),()=>window.removeEventListener("keydown",E)},[js]);const Ps=P.useRef(null),Mc=P.useCallback(()=>{e==="idle"&&(Ps.current&&clearTimeout(Ps.current),Ps.current=window.setTimeout(async()=>{var Z;const E={version:1,timestamp:Date.now(),activeSessionId:((Z=A[$])==null?void 0:Z.id)||null,theme:s,sidebarOpen:Ut,sessions:A.map(re=>({id:re.id,fileName:re.fileName,fileType:re.file?re.file.type:"application/octet-stream",fileSize:re.rawFileBuffer?re.rawFileBuffer.byteLength:0,displaySettings:re.displaySettings,isThreePlane:re.isThreePlane})),windows:Xe.map(re=>({id:re.id,type:re.type,roi:re.roi,zIndex:re.zIndex,initialPosition:re.initialPosition,sessionId:re.sessionId,isBGGR:re.isBGGR,isMinimized:re.isMinimized||!1,internalState:re.internalState}))};Doe(E);const H=A.map(re=>re.id);Loe(H)},1e3))},[A,Xe,$,s,Ut,e]);P.useEffect(()=>{Mc()},[Mc]);const xi=P.useCallback(E=>{D(H=>H.map((Z,re)=>re===$?{...Z,...E}:Z))},[$]),Ba=P.useCallback((E,H)=>{D(Z=>Z.map(re=>re.id===E?{...re,...H}:re))},[]),Fa=P.useCallback((E,H)=>({...E,history:H.entries.map(Z=>({id:Z.id,label:Z.label,timestamp:Z.timestamp})),historyIndex:H.index}),[]),Cs=P.useCallback((E,H,Z="Initialize PS Document",re=[])=>{const xe=Dh(H),Ae={entries:[{id:`history_${Date.now()}_${Math.random().toString(36).slice(2,7)}`,label:Z,timestamp:Date.now(),doc:xe,transformOps:Gs(re)}],index:0};return U.current[E]=Ae,Fa(H,Ae)},[Fa]);P.useEffect(()=>{const E=new Set(A.map(H=>H.id));Object.keys(U.current).forEach(H=>{E.has(H)||delete U.current[H]}),Object.keys(Wt.current).forEach(H=>{E.has(H)||delete Wt.current[H]})},[A]);const bd=()=>B(E=>Math.min(E+1,A.length-1)),wd=()=>B(E=>Math.max(0,E-1)),Nc=P.useCallback(E=>{if(!z)return null;const H=Math.max(0,Math.floor(E.x)),Z=Math.max(0,Math.floor(E.y)),re=Math.min(z.width,Math.ceil(E.x+E.w)),xe=Math.min(z.height,Math.ceil(E.y+E.h));if(re<=H||xe<=Z)return null;let Ee=0,Ae=0,He=null;if(te)Ee=te.width,Ae=te.height,He=te.data;else if(V&&V.naturalWidth>0&&V.naturalHeight>0){const $t=document.createElement("canvas");$t.width=V.naturalWidth,$t.height=V.naturalHeight;const pn=$t.getContext("2d");if(!pn)return null;pn.drawImage(V,0,0);const Wn=pn.getImageData(0,0,$t.width,$t.height);Ee=Wn.width,Ae=Wn.height,He=Wn.data}else return null;const Ke=Math.max(0,Math.min(Ee-1,Math.floor(H*Ee/z.width))),Ue=Math.max(0,Math.min(Ae-1,Math.floor(Z*Ae/z.height))),nt=Math.max(Ke+1,Math.min(Ee,Math.ceil(re*Ee/z.width))),Pt=Math.max(Ue+1,Math.min(Ae,Math.ceil(xe*Ae/z.height)));let Ze=0,Sr=0,Ur=0,sn=0,$r=0,vr=0,br=0;for(let $t=Ue;$t<Pt;$t++){const pn=$t*Ee;for(let Wn=Ke;Wn<nt;Wn++){const ii=(pn+Wn)*4,oi=He[ii],Es=He[ii+1],ro=He[ii+2];Ze+=oi,Sr+=Es,Ur+=ro,sn+=oi*oi,$r+=Es*Es,vr+=ro*ro,br++}}if(br<=0)return null;const Mn=Ze/br,Nn=Sr/br,ea=Ur/br,fa=Math.sqrt(Math.max(0,sn/br-Mn*Mn)),Ti=Math.sqrt(Math.max(0,$r/br-Nn*Nn)),Ga=Math.sqrt(Math.max(0,vr/br-ea*ea));return{x:H,y:Z,width:re-H,height:xe-Z,means:[Mn,Nn,ea,0],stdDevs:[fa,Ti,Ga,0],pixelCount:br}},[z,te,V]),Ho=P.useCallback(E=>z?z.isThreePlane&&Nc(E)||Ol(z.data,z.width,z.height,E.x,E.y,E.w,E.h):null,[z,Nc]);P.useEffect(()=>{if(!z||!me)return;const E=Ho({x:me.x,y:me.y,w:me.width,h:me.height});E&&Be(E)},[z,te,V,Ho]);const jo=P.useCallback(async E=>{const H=E.displaySettings.renderMode||"standard";if(u&&$s.hasImage(E.id)&&H!=="standard"&&!E.isThreePlane&&E.rawImageData){const xe=await $s.export16Bit(E.id,E.displaySettings,!0,!1);if(xe)return{width:E.rawImageData.width,height:E.rawImageData.height,data:zE(xe)}}return s_.test(E.fileName)&&E.rawFileBuffer?await KT(E.rawFileBuffer,E.displaySettings):E.renderedRawImageData?{width:E.renderedRawImageData.width,height:E.renderedRawImageData.height,data:MP(E.renderedRawImageData)}:E.imageElement?await WE(E.imageElement):null},[u]),Ms=P.useCallback(async E=>{if(E.psDocument)return;const H=await jo(E);if(!H)throw new Error("Failed to build PS source buffer.");const Z=Ik(E.id,H.width,H.height,H.data),re=Cs(E.id,Z,"Initialize PS Document");Ba(E.id,{psDocument:re})},[jo,Ba,Cs]),kd=P.useCallback(async()=>{if(tt){_t("PS Mode is locked and cannot be closed in this build.");return}const E=!tt;if(E&&I){It("Preparing PS Mode Float32 source...");try{await Ms(I)}catch(H){_t(`PS Mode init failed: ${H.message||H}`),It(null);return}It(null)}Hr(E),E?(Ce&&ye(!1),ze&&ot(!1),be&&ae(!1),ct&&Ct(!1),Ot(0),Rr([]),Xr([]),nr(!1),qe(0)):(Qt(!1),tr(null),Dt("off"),_e(null),Ye(null),Ve(null))},[tt,I,Ms,Ce,ze,be,ct]);P.useEffect(()=>{if(!tt||!I||I.psDocument)return;let E=!1;return(async()=>{try{await Ms(I)}catch(H){E||console.error("PS document auto-init failed:",H)}})(),()=>{E=!0}},[tt,I,Ms]),P.useEffect(()=>{if(!tt||!Ne){Ve(null);return}if(Oe)return;let E=!1;return(async()=>{var Ee;let H=null;const Z=Pn.current,re=Kt.current,xe=((Ee=G.current)==null?void 0:Ee.id)||Ne.id;if(u)if(H=await Ih.renderPreview(Ne),H)Wt.current[xe]=!0;else{const Ae=Ih.wasBusyLastRender(),He=!!Wt.current[xe];if(Ae||He)return}H||(Z&&re?H=sT(Ne,re,Z):H=hv(Ne)),E||(Ve(H),Z&&Ye(null))})(),()=>{E=!0}},[tt,Ne,u,Oe]);const vt=P.useCallback((E,H)=>{var Ze;const Z=G.current;if(!(Z!=null&&Z.psDocument))return;const re={label:(H==null?void 0:H.label)||"PS Edit",trackHistory:(H==null?void 0:H.trackHistory)!==!1,transformOp:H==null?void 0:H.transformOp},xe=E(Z.psDocument);if(xe===Z.psDocument)return;if(!re.trackHistory){const Sr=U.current[Z.id],Ur=Sr?Fa(xe,Sr):xe;Ba(Z.id,{psDocument:Ur});return}let Ee=U.current[Z.id];Ee||(Ee={entries:[{id:`history_${Date.now()}_${Math.random().toString(36).slice(2,7)}`,label:"Initialize PS Document",timestamp:Date.now(),doc:Dh(Z.psDocument),transformOps:[]}],index:0});const Ae=((Ze=Ee.entries[Ee.index])==null?void 0:Ze.transformOps)||[],He=re.transformOp?[...Ae,GO(re.transformOp)]:Ae,Ke=Ee.entries.slice(0,Ee.index+1);Ke.push({id:`history_${Date.now()}_${Math.random().toString(36).slice(2,7)}`,label:re.label,timestamp:Date.now(),doc:Dh(xe),transformOps:Gs(He)});let Ue=Ke.length-1;if(Ke.length>c_){const Sr=Ke.length-c_;Ke.splice(0,Sr),Ue=Math.max(0,Ue-Sr)}const nt={entries:Ke,index:Ue};U.current[Z.id]=nt;const Pt=Fa(xe,nt);Ba(Z.id,{psDocument:Pt})},[Ba,Fa]),Oc=P.useCallback(()=>{const E=G.current;if(!(E!=null&&E.psDocument))return;const H=U.current[E.id];if(!H||H.index<=0)return;const Z=H.index-1,re={...H,index:Z};U.current[E.id]=re;const xe=xx(re.entries[Z].doc),Ee=Fa(xe,re);Ba(E.id,{psDocument:Ee}),Ye(null),Ve(null)},[Ba,Fa]),Sd=P.useCallback(E=>{const H=G.current;if(!(H!=null&&H.psDocument))return;const Z=U.current[H.id];if(!Z||E<0||E>=Z.entries.length)return;const re={...Z,index:E};U.current[H.id]=re;const xe=xx(re.entries[E].doc),Ee=Fa(xe,re);Ba(H.id,{psDocument:Ee}),Ye(null),Ve(null)},[Ba,Fa]),Po=P.useCallback((E,H)=>{const Z=URL.createObjectURL(E),re=document.createElement("a");re.href=Z,re.download=H,document.body.appendChild(re),re.click(),document.body.removeChild(re),URL.revokeObjectURL(Z)},[]),Ns=P.useCallback((E,H,Z)=>new Promise((re,xe)=>{const Ee=document.createElement("canvas");Ee.width=E.width,Ee.height=E.height;const Ae=Ee.getContext("2d");if(!Ae){xe(new Error("Failed to get 2D canvas context."));return}Ae.putImageData(E,0,0),Ee.toBlob(He=>{if(!He){xe(new Error("Failed to encode image blob."));return}re(He)},H,Z)}),[]),Os=P.useCallback(async()=>{const E=G.current;if(!E)return null;const H=h_(E.fileName);if(tt&&E.psDocument){if(Kt.current)return{imageData:Kt.current,baseName:H};let Z=null;if(u)if(Z=await Ih.renderPreview(E.psDocument),Z)Wt.current[E.id]=!0;else{const re=Ih.wasBusyLastRender(),xe=!!Wt.current[E.id];if(re||xe)return null}return Z||(Z=hv(E.psDocument)),{imageData:Z,baseName:H}}if(cn==="reference"&&E.referenceImageData)return{imageData:E.referenceImageData,baseName:H};if(cn==="sampled"&&E.sampledImageData)return{imageData:E.sampledImageData,baseName:H};if(E.renderedRawImageData)return{imageData:E.renderedRawImageData,baseName:H};if(E.imageElement){const Z=E.imageElement.naturalWidth||E.imageElement.width,re=E.imageElement.naturalHeight||E.imageElement.height,xe=document.createElement("canvas");xe.width=Z,xe.height=re;const Ee=xe.getContext("2d");return Ee?(Ee.drawImage(E.imageElement,0,0,Z,re),{imageData:Ee.getImageData(0,0,Z,re),baseName:H}):null}return null},[tt,u,cn]),_d=P.useCallback(async()=>{try{const E=await Os();if(!E){_t("No image available for PNG export.");return}const H=await Ns(E.imageData,"image/png");Po(H,`${E.baseName}_ps_export_${Date.now()}.png`)}catch(E){_t(`PNG export failed: ${(E==null?void 0:E.message)||E}`)}},[Os,Ns,Po]),jd=P.useCallback(async()=>{try{const E=await Os();if(!E){_t("No image available for JPEG export.");return}const H=await Ns(E.imageData,"image/jpeg",.92);Po(H,`${E.baseName}_ps_export_${Date.now()}.jpg`)}catch(E){_t(`JPEG export failed: ${(E==null?void 0:E.message)||E}`)}},[Os,Ns,Po]),Pd=P.useCallback(async()=>{var H,Z,re,xe,Ee,Ae;const E=G.current;if(!(E!=null&&E.psDocument)){_t("No PS workflow to export.");return}It("Exporting PS workflow...");try{const He=E.psDocument,Ke=((H=E.rawImageData)==null?void 0:H.width)||((Z=E.imageElement)==null?void 0:Z.naturalWidth)||((re=E.imageElement)==null?void 0:re.width)||He.width,Ue=((xe=E.rawImageData)==null?void 0:xe.height)||((Ee=E.imageElement)==null?void 0:Ee.naturalHeight)||((Ae=E.imageElement)==null?void 0:Ae.height)||He.height,nt={signature:af,version:3,exportedAt:new Date().toISOString(),sourceFileName:E.fileName,sourceWidth:Ke,sourceHeight:Ue,width:He.width,height:He.height,displaySettings:{...E.displaySettings},psUi:{brushEnabled:gr,brushSize:jt,brushOpacity:R,brushFeather:Fr,ellipseFeather:ut,brushMode:yr},flow:(()=>{var $r,vr;const Ur=U.current[E.id],sn=((vr=($r=Ur==null?void 0:Ur.entries)==null?void 0:$r[Ur.index])==null?void 0:vr.transformOps)||[];return u_(He,sn)})(),history:(()=>{const Ur=U.current[E.id];if(!Ur||Ur.entries.length===0)return;const sn=Math.max(0,Math.min(Ur.entries.length-1,Ur.index)),$r=Math.max(0,sn-Qoe+1),vr=Ur.entries.slice($r,sn+1);return{index:vr.length-1,entries:vr.map(br=>({id:br.id,label:br.label,timestamp:br.timestamp,flow:u_(br.doc,br.transformOps||[])}))}})()},Ze=JSON.stringify({format:l_,version:1,payload:nt}),Sr=new Blob([Ze],{type:"application/json;charset=utf-8"});Po(Sr,`${h_(E.fileName)}_ps_workflow.json`)}catch(He){_t(`Export workflow failed: ${(He==null?void 0:He.message)||He}`)}finally{It(null)}},[Po,gr,jt,R,Fr,ut,yr]),Cd=P.useCallback(async E=>{var Z,re,xe,Ee,Ae,He,Ke;if(!G.current){_t("Load an image first, then import workflow file.");return}It("Importing PS workflow...");try{const Ue=G.current;if(!Ue)throw new Error("Session disappeared during import.");const nt=await E.text(),Pt=nt.trim();if(!Pt)throw new Error("Workflow file is empty.");let Ze=null;if(Pt.startsWith("{")){let $t;try{$t=JSON.parse(Pt)}catch{throw new Error("Invalid workflow JSON.")}const pn=$t;if((pn==null?void 0:pn.format)===l_&&(pn!=null&&pn.payload))Ze=pn.payload;else if($t!=null&&$t.payload&&((Z=$t==null?void 0:$t.payload)==null?void 0:Z.signature)===af)Ze=$t.payload;else if(($t==null?void 0:$t.signature)===af)Ze=$t;else throw new Error("Invalid workflow JSON signature.")}else{const $t={};if(nt.split(/\r?\n/).map(pn=>pn.trim()).filter(Boolean).forEach(pn=>{const Wn=ase(pn);if(Wn.length<2)return;const ii=f_(Wn[0]).trim().toLowerCase(),oi=f_(Wn.slice(1).join(","));$t[ii]=oi}),$t.signature!==af)throw new Error("Invalid workflow CSV signature.");Ze=$t.payload_json?JSON.parse($t.payload_json):$t.payload_b64?JSON.parse(nse($t.payload_b64)):null}if(!Ze)throw new Error("Missing workflow payload.");if(Ze.signature!==af)throw new Error("Workflow payload signature mismatch.");const Sr=Number(Ze.sourceWidth||Ze.width),Ur=Number(Ze.sourceHeight||Ze.height),sn=((re=Ue.rawImageData)==null?void 0:re.width)||((xe=Ue.imageElement)==null?void 0:xe.naturalWidth)||((Ee=Ue.imageElement)==null?void 0:Ee.width)||Sr,$r=((Ae=Ue.rawImageData)==null?void 0:Ae.height)||((He=Ue.imageElement)==null?void 0:He.naturalHeight)||((Ke=Ue.imageElement)==null?void 0:Ke.height)||Ur;if(Sr!==sn||Ur!==$r)throw new Error(`Source size mismatch: workflow expects ${Sr}x${Ur}, current file is ${sn}x${$r}.`);const vr=Number(Ze.width),br=Number(Ze.height);if(!Number.isFinite(vr)||!Number.isFinite(br)||vr<=0||br<=0)throw new Error("Invalid workflow canvas size.");const Mn=await jo(Ue);if(!Mn)throw new Error("Failed to rebuild source image for workflow import.");const Nn=Ik(Ue.id,Mn.width,Mn.height,Mn.data),ea={width:Number(Ze.flow.width||Ze.width),height:Number(Ze.flow.height||Ze.height),transformOps:Gs(Ze.flow.transformOps||[]),masks:(Ze.flow.masks||[]).map($t=>({...$t,items:($t.items||[]).map(Qu)})),layers:(Ze.flow.layers||[]).map(Eg),guides:(Ze.flow.guides||[]).map(ec),selectedMaskId:Ze.flow.selectedMaskId||"",selectedLayerId:Ze.flow.selectedLayerId||"",selectedMaskItemId:Ze.flow.selectedMaskItemId??null,selectedGuideId:Ze.flow.selectedGuideId??null,transform:Ze.flow.transform?{rotationDeg:Number(Ze.flow.transform.rotationDeg)||0,crop:Ze.flow.transform.crop?{...Ze.flow.transform.crop}:null}:{rotationDeg:0,crop:null}},fa=d_(Nn,ea);let Ti;const Ga=Ze.history;if(Ga&&Array.isArray(Ga.entries)&&Ga.entries.length>0){const $t=Number(Ga.index),pn=Number.isFinite($t)?Math.max(0,Math.min(Ga.entries.length-1,$t)):Ga.entries.length-1,Wn=Math.max(0,pn-ese+1),ii=Ga.entries.slice(Wn,pn+1),oi=[];for(const Dc of ii){const Oa=Dc.flow||ea,bw={width:Number(Oa.width||ea.width),height:Number(Oa.height||ea.height),transformOps:Gs(Oa.transformOps||[]),masks:(Oa.masks||[]).map(ww=>({...ww,items:(ww.items||[]).map(Qu)})),layers:(Oa.layers||[]).map(Eg),guides:(Oa.guides||[]).map(ec),selectedMaskId:Oa.selectedMaskId||"",selectedLayerId:Oa.selectedLayerId||"",selectedMaskItemId:Oa.selectedMaskItemId??null,selectedGuideId:Oa.selectedGuideId??null,transform:Oa.transform?{rotationDeg:Number(Oa.transform.rotationDeg)||0,crop:Oa.transform.crop?{...Oa.transform.crop}:null}:{rotationDeg:0,crop:null}},a6=d_(Nn,bw);oi.push({id:Dc.id||`history_${Date.now()}_${Math.random().toString(36).slice(2,7)}`,label:Dc.label||"PS Edit",timestamp:Number(Dc.timestamp)||Date.now(),doc:Dh(a6),transformOps:Gs(bw.transformOps||[])})}const Es=oi.length-1,ro={entries:oi,index:Es};U.current[Ue.id]=ro;const Rc=xx(oi[Es].doc);Ti=Fa(Rc,ro)}else{const $t=Gs(ea.transformOps||[]);Ti=Cs(Ue.id,fa,"Import Workflow",$t)}Ba(Ue.id,{psDocument:Ti,displaySettings:Ze.displaySettings?{...Ze.displaySettings}:Ue.displaySettings}),Ze.psUi&&(Qt(!!Ze.psUi.brushEnabled),mr(Math.max(1,Number(Ze.psUi.brushSize)||32)),sr(Math.max(0,Math.min(1,Number(Ze.psUi.brushOpacity)||.35))),Me(Math.max(0,Math.min(1,Number(Ze.psUi.brushFeather)||0))),gt(Math.max(0,Number(Ze.psUi.ellipseFeather)||0)),lr(Ze.psUi.brushMode==="subtract"?"subtract":"add")),tr(null),Dt("off"),_e(null),Ye(null),Ve(null)}catch(Ue){_t(`Import workflow failed: ${(Ue==null?void 0:Ue.message)||Ue}`)}finally{It(null)}},[jo,Cs,Ba,Fa]),Nl=P.useCallback(E=>{vt(H=>{const Z=H.layers.find(re=>re.id===E);return{...H,selectedLayerId:E,selectedMaskId:Z?Z.maskId:H.selectedMaskId}},{trackHistory:!1}),Ye(null)},[vt]),Md=P.useCallback(E=>{vt(H=>NP(H,E),{trackHistory:!1}),Ye(null)},[vt]),Xo=P.useCallback(E=>{vt(H=>ZE(H,E),{trackHistory:!1})},[vt]),eo=P.useCallback((E,H)=>{vt(Z=>JE(Z,E,H),{label:"Edit Ellipse"}),Ye(null)},[vt]),Nd=P.useCallback((E,H)=>{vt(Z=>QE(Z,E,H),{label:"Toggle Mask Overlay"})},[vt]),Od=P.useCallback(()=>{vt(E=>Yb(E),{label:"Add Mask"}),Ye(null)},[vt]),Ad=P.useCallback(()=>{Dt("center"),_e(null)},[]),Ed=P.useCallback(()=>{Dt("off"),_e(null)},[]),Td=P.useCallback(E=>{rr==="center"&&(_e({center:E,radiusX:1,radiusY:1,rotationDeg:0}),Dt("drag"))},[rr]),Ac=P.useCallback((E,H)=>{if(rr!=="drag"||!Et)return;const Z=E.x-Et.center.x,re=E.y-Et.center.y,xe={...Et,radiusX:Math.max(1,Math.abs(Z)),radiusY:Math.max(1,Math.abs(re))};_e(xe),H==="end"&&(vt(Ee=>KE(Ee,xe,ut,yr),{label:"Add Ellipse Item"}),Dt("off"),_e(null),Ye(null))},[rr,Et,vt,ut,yr]),Ec=P.useCallback(()=>{if(!me){_t("Create an ROI first, then crop.");return}const E={x:me.x,y:me.y,w:me.width,h:me.height};vt(H=>EP(H,E),{label:"Crop To ROI",transformOp:{type:"crop",rect:E}}),Ye(null),Ve(null),Be(null),se(null)},[vt,me]),Tc=P.useCallback(E=>{vt(H=>TP(H,E),{label:`Rotate ${E.toFixed(1)}deg`,transformOp:{type:"rotate",angleDeg:E}}),Ye(null),Ve(null),Be(null),se(null)},[vt]),Y=P.useCallback(()=>{vt(E=>IP(E),{label:"Flip Horizontal",transformOp:{type:"flipH"}}),Ye(null),Ve(null),Be(null),se(null)},[vt]),Pe=P.useCallback(()=>{vt(E=>RP(E),{label:"Flip Vertical",transformOp:{type:"flipV"}}),Ye(null),Ve(null),Be(null),se(null)},[vt]),yt=P.useCallback(()=>{var H,Z;const E=(((Z=(H=G.current)==null?void 0:H.psDocument)==null?void 0:Z.guides)||[]).map(ec);vt(re=>$P(re),{label:"Apply Upright",transformOp:{type:"upright",guides:E}}),Ye(null),Ve(null),Be(null),se(null)},[vt]),ur=P.useCallback(E=>{const H=UO(E);vt(Z=>DP(Z,H),{label:H.lensLabel?`Lens Correction (${H.lensLabel})`:`Lens Correction (${H.model})`,transformOp:{type:"lensDistortion",params:H}}),Ye(null),Ve(null),Be(null),se(null)},[vt]),Zr=P.useCallback(E=>{vt(H=>VE(H,E),{label:`Add ${E==="horizontal"?"H":"V"} Guide`})},[vt]),on=P.useCallback(E=>{vt(H=>HE(H,E),{trackHistory:!1})},[vt]),Mr=P.useCallback((E,H,Z)=>{vt(re=>Rk(re,E,H,Z),{label:"Edit Guide"})},[vt]),hn=P.useCallback(E=>{tr(E)},[]),Ai=P.useCallback(()=>{tr(null)},[]),Ua=P.useCallback(E=>{const H=et;H&&(vt(Z=>{if(!Z.selectedGuideId)return Z;const re=Z.guides.find(Ee=>Ee.id===Z.selectedGuideId);if(!re)return Z;const xe={x:E.x,y:E.y};return Rk(Z,re.id,H==="p1"?xe:re.p1,H==="p2"?xe:re.p2)},{label:"Pick Guide Endpoint"}),tr(null))},[vt,et]),vi=P.useCallback(E=>{vt(H=>XE(H,E),{label:"Delete Guide"})},[vt]),Ei=P.useCallback((E,H)=>{vt(Z=>({...Z,layers:Z.layers.map(re=>re.id===E?{...re,maskId:H}:re),selectedLayerId:E,selectedMaskId:H}),{label:"Bind Layer To Mask"}),Ye(null)},[vt]),va=P.useCallback((E,H)=>{vt(Z=>({...Z,layers:Z.layers.map(re=>re.id===E?{...re,blendMode:H}:re)}),{label:"Set Layer Blend"})},[vt]),Id=P.useCallback((E,H)=>{vt(Z=>({...Z,layers:Z.layers.map(re=>re.id===E?{...re,opacity:Math.max(0,Math.min(1,H))}:re)}),{label:"Set Layer Opacity"})},[vt]),Wm=P.useCallback((E,H)=>{const Z=Su(H);vt(re=>({...re,layers:re.layers.map(xe=>xe.id===E?{...xe,basic:Z}:xe)}),{label:"Set Layer Basic"}),Ye(null)},[vt]),Vm=P.useCallback((E,H)=>{const Z=Su(H);vt(re=>({...re,layers:re.layers.map(xe=>xe.id===E?{...xe,basic:Z}:xe)}),{trackHistory:!1}),Ye(null)},[vt]),Hm=P.useCallback((E,H)=>{const Z=_u(H);vt(re=>({...re,layers:re.layers.map(xe=>xe.id===E?{...xe,mixer:Z}:xe)}),{label:"Set Layer Mixer"}),Ye(null)},[vt]),Xm=P.useCallback((E,H)=>{const Z=_u(H);vt(re=>({...re,layers:re.layers.map(xe=>xe.id===E?{...xe,mixer:Z}:xe)}),{trackHistory:!1}),Ye(null)},[vt]),Km=P.useCallback((E,H)=>{var Ae,He;const Z=Ke=>{const Ue=(Ke||[]).map(nt=>({x:Math.max(0,Math.min(1,Number((nt==null?void 0:nt.x)??0))),y:Math.max(0,Math.min(1,Number((nt==null?void 0:nt.y)??0)))})).filter(nt=>!Number.isNaN(nt.x)&&!Number.isNaN(nt.y)).sort((nt,Pt)=>nt.x-Pt.x);return Ue.length<2?[{x:0,y:0},{x:1,y:1}]:(Ue[0].x=0,Ue[Ue.length-1].x=1,Ue)};vt(Ke=>({...Ke,layers:Ke.layers.map(Ue=>Ue.id===E?{...Ue,curves:{master:Z(H.master),red:Z(H.red),green:Z(H.green),blue:Z(H.blue)}}:Ue)}),{label:`Edit ${E} Curves`});const re=G.current,xe=(Ae=re==null?void 0:re.psDocument)==null?void 0:Ae.layers.find(Ke=>Ke.id===E),Ee=xe?(He=re==null?void 0:re.psDocument)==null?void 0:He.masks.find(Ke=>Ke.id===xe.maskId):null;Ye(Ee?GE(Ee):null)},[vt]),Rd=P.useCallback(E=>{Qr.current.push({x:E.x,y:E.y}),vt(Z=>YE(Z,E.x,E.y,jt,R,yr,Fr),{trackHistory:!1});const H={x0:Math.floor(E.x-jt-2),y0:Math.floor(E.y-jt-2),x1:Math.ceil(E.x+jt+2),y1:Math.ceil(E.y+jt+2)};Ye(Z=>Z?{x0:Math.min(Z.x0,H.x0),y0:Math.min(Z.y0,H.y0),x1:Math.max(Z.x1,H.x1),y1:Math.max(Z.y1,H.y1)}:H)},[vt,jt,R,yr,Fr]),Ym=P.useCallback((E,H)=>{if(!gr)return;if(H==="start"&&(Ie(!0),Qr.current=[]),H==="end"){fr!==null&&(cancelAnimationFrame(fr),F(null));const re=Ir.current;re&&Rd(re);const xe=Qr.current;xe.length>0&&vt(Ee=>qE(Ee,xe,jt,R,yr,Fr),{label:"Brush Stroke"}),Ir.current=null,Qr.current=[],Ie(!1);return}if(Ir.current=E,fr!==null)return;const Z=requestAnimationFrame(()=>{F(null);const re=Ir.current;re&&Rd(re)});F(Z)},[gr,fr,Rd,vt,jt,R,yr,Fr]);P.useEffect(()=>()=>{fr!==null&&cancelAnimationFrame(fr)},[fr]);const qm=E=>{if(!me||!I)return;const H=Date.now().toString()+Math.random().toString().slice(2,5),Z=Math.max(Zt,...Xe.map(Ee=>Ee.zIndex),100),re=Xe.length%10*30,xe=E==="fft"?{x:50,y:50}:E==="histogram"?{x:100,y:100}:{x:150,y:150};ht(Ee=>[...Ee,{id:H,type:E,roi:{x:me.x,y:me.y,w:me.width,h:me.height},zIndex:Z+1,initialPosition:{x:xe.x+re,y:xe.y+re},sessionId:I.id,isBGGR:Se,isMinimized:!1,stackFiles:(E==="fft"||E==="pearson"||E==="histogram")&&J.length>0?J:void 0}])},Zm=E=>{ht(H=>H.filter(Z=>Z.id!==E))},Dd=E=>{ht(H=>H.map(Z=>Z.id===E?{...Z,isMinimized:!0}:Z))},Ko=E=>{ht(H=>H.map(Z=>Z.id===E?{...Z,isMinimized:!1}:Z)),$d(E)},$d=E=>{ht(H=>{const Z=Math.max(Zt,...H.map(re=>re.zIndex));return H.map(re=>re.id===E?{...re,zIndex:Z+1}:re)})},W0=(E,H)=>{ht(Z=>Z.map(re=>re.id===E?{...re,internalState:{...re.internalState,...H}}:re))},As=()=>{const E=Math.max(Zt,...Xe.map(H=>H.zIndex));Jt(E+1)},p=(E,H)=>{ht(Z=>Z.map(re=>re.id===E?{...re,roi:H}:re))};P.useEffect(()=>{if(!ee)return;const E=ee.CFAPattern2||ee.CFAPattern;if(E){let H="";Array.isArray(E)?H=E.join(""):typeof E=="string"?H=E.replace(/[\s,]+/g,""):typeof E=="number"&&(H=String(E)),H==="0112"?we(!1):H==="2110"&&we(!0)}},[ee]),P.useEffect(()=>{tt||(Qt(!1),tr(null),Dt("off"),_e(null),Ie(!1),Ye(null))},[tt]),P.useEffect(()=>{(!tt||!(fe!=null&&fe.selectedGuideId))&&tr(null)},[tt,fe==null?void 0:fe.selectedGuideId]),P.useEffect(()=>{let E;const H=()=>{if(wt&&Ln){const Z=Date.now()/1e3,re=.55+.45*Math.sin(Z*xr);en(re),E=requestAnimationFrame(H)}else en(1)};return wt&&Ln?H():en(1),()=>{E&&cancelAnimationFrame(E)}},[wt,Ln,xr]),P.useEffect(()=>{const E=H=>{H.key==="Escape"&&Ln&&(Zn(!1),Oi({x:0,y:0}),Wr(!1))};return window.addEventListener("keydown",E),()=>window.removeEventListener("keydown",E)},[Ln]),P.useEffect(()=>()=>{A.forEach(E=>{E.previewUrl&&URL.revokeObjectURL(E.previewUrl)}),zn.current&&zn.current.terminate()},[]);const m=async(E,H=!0)=>{H&&(_o({x:0,y:0}),ks(1),Zi(0),In([]),So([]),ir(!1),Tr(null),ke(!1),ae(!1),mt([]),Rr([]),Ot(0),Xr([]));let Z=null;if(M.isConnected){const Ke=new FormData;Ke.append("file",E);try{const nt=await(await fetch("http://localhost:5428/read",{method:"POST",body:Ke})).json();if(nt.success){let Pt=nt.data;Array.isArray(Pt)&&Pt.length===1&&(Pt=Pt[0]),Z=Pt}}catch(Ue){console.warn("Auto Exif fetch failed",Ue)}}const re=E.name.toLowerCase(),xe=s_.test(re),Ee=E.type==="image/x-adobe-dng"||/\.dng$/i.test(re);let Ae={file:E,exifData:Z,psDocument:null};if(xe||Ee)try{H?It("Processing RAW file (this may take a moment)..."):Bn(!0);const Ke=await E.arrayBuffer();Ae.rawFileBuffer=Ke;const{previewBlob:Ue,analysisData:nt}=await Bc(Ke);Ae.rawImageData=nt,!Z&&nt.metadata&&(Ae.exifData=nt.metadata),Ae.isThreePlane=nt.isThreePlane||!1,nt.isThreePlane&&H&&ke(!0);let Pt=!1,Ze=null,Sr=!1;if(nt.isXTrans){Sr=!0,Ze=Ke;const $r=(await xh(Ke,0,0)).dngBuffer,vr=await Bc($r);Ae.rawFileBuffer=$r,Ae.rawImageData=vr.analysisData,Ae.previewUrl=URL.createObjectURL(vr.previewBlob),Pt=!0}else Ae.previewUrl=URL.createObjectURL(Ue);Ae.originalRawFileBuffer=Ze,Ae.isXTransOriginal=Sr,Ae.isXTransConverted=Pt,Ae.xtransPhase={x:0,y:0};const Ur=new Image;if(Ur.src=Ae.previewUrl||"",await new Promise((sn,$r)=>{Ur.onload=()=>{Ae.imageElement=Ur,sn()},Ur.onerror=()=>{sn()}}),H){const sn=Ae.rawImageData||nt,$r=ose(sn,Z||sn.metadata);let vr;$r&&$r.some(Nn=>Nn>0)&&(vr=$r);const br={exposure:0,demosaicMethod:-1,blackLevel:vr,wbGains:[1,1],showKadc:!1,subtractBlackLevelFromStats:!1,renderMode:"zero-dependency"},Mn=Ae.rawFileBuffer;if(Mn&&(xe||E.type==="image/x-adobe-dng"))try{const Nn=await Dy(Mn,br);Ae.renderedRawImageData=Nn,Ae.displaySettings=br}catch(Nn){console.error("Initial Zero-Dep Render Failed",Nn)}}}catch(Ke){_t(`Failed to process RAW file: ${Ke.message}`),It(null),Bn(!1);return}else try{It("Processing image...");const{previewBlob:Ke,analysisData:Ue}=await $T(E);Ae.rawImageData=Ue,!Z&&Ue.metadata&&(Ae.exifData=Ue.metadata),Ae.rawFileBuffer=await E.arrayBuffer(),Ae.isThreePlane=Ue.isThreePlane||!1,Ae.isXTransOriginal=!1,Ae.isXTransConverted=!1,Ae.originalRawFileBuffer=null;const nt=URL.createObjectURL(Ke);Ae.previewUrl=nt;const Pt=new Image;Pt.src=nt,await new Promise(Ze=>{Pt.onload=()=>{Ae.imageElement=Pt,Ze()},Pt.onerror=()=>{_t("Could not load the image file."),Ze()}})}catch(Ke){_t(`Failed to process image: ${Ke.message}`),It(null);return}const He=Date.now().toString()+Math.random();if(Ae.rawFileBuffer&&await Toe(He,Ae.rawFileBuffer),H){const Ke={exposure:0,demosaicMethod:-1,blackLevel:void 0,wbGains:[1,1],showKadc:!1,subtractBlackLevelFromStats:!1,renderMode:"zero-dependency"},Ue={id:He,fileName:E.name,file:E,imageElement:null,rawImageData:null,rawFileBuffer:null,renderedRawImageData:null,referenceImageData:null,sampledImageData:null,exifData:null,isThreePlane:!1,displaySettings:Ke,originalRawFileBuffer:null,isXTransOriginal:!1,isXTransConverted:!1,xtransPhase:{x:0,y:0},psDocument:null,...Ae};D(nt=>{const Pt=[...nt,Ue];return B(Pt.length-1),Pt})}else xi(Ae);It(null),Bn(!1)},C=P.useCallback(async()=>{const E=Rh,H=Rh,Z=new Uint16Array(E*H),re=Math.max(2,Ma),xe=Gt*re;for(let Ke=0;Ke<H;Ke++)for(let Ue=0;Ue<E;Ue++){const nt=.5+.5*Math.sin(2*Math.PI*(Ue+xe)/re);Z[Ke*E+Ue]=Math.round(1e3+nt*9e3)}const Ee=qh(E,H,Z,[0,0,0,0],16383,"RGGB"),Ae=new Blob([Ee],{type:"image/x-adobe-dng"}),He=new File([Ae],"pattern_test.dng",{type:"image/x-adobe-dng"});await m(He,(X==null?void 0:X.name)!=="pattern_test.dng")},[Ma,Gt,Yt,X]),O=E=>{var Z;if(tt){_t("Load Image is disabled while PS Mode is active."),E.target.value="";return}const H=(Z=E.target.files)==null?void 0:Z[0];H&&m(H,!0)},L=async(E,H)=>{if(tt){_t("Load Image is disabled while PS Mode is active.");return}if(H==="convert"){It("Converting RAW via Bridge...");try{const Z=new FormData;Z.append("file",E);const re=await fetch("http://localhost:5428/convert",{method:"POST",body:Z});if(!re.ok)throw new Error("Conversion failed on server");const xe=await re.blob(),Ee=new File([xe],E.name.replace(/\.[^/.]+$/,"")+".dng",{type:"image/x-adobe-dng"});await m(Ee,!0)}catch(Z){_t("DNG Conversion Failed: "+Z.message)}finally{It(null)}}else m(E,!0)},K=async(E,H,Z,re)=>{It("Processing Pair Difference...");try{const xe=await E.arrayBuffer(),Ee=await H.arrayBuffer(),Ae=await Ry(xe,Ee,Z,re),He=qh(Ae.width,Ae.height,Ae.rawData,[32768,32768,32768,32768],65535,"RGGB"),Ke=new Blob([He],{type:"image/x-adobe-dng"}),Ue=new File([Ke],`Diff_${E.name}_${H.name}.dng`,{type:"image/x-adobe-dng"});await m(Ue,!0)}catch(xe){_t("Pair Processing Failed: "+xe.message)}finally{It(null)}},ne=async E=>{const H=Array.from(E).sort((Z,re)=>Z.name.localeCompare(re.name,void 0,{numeric:!0}));if(H.length<2){_t("Need at least 2 files for batch diff.");return}It("Batch Difference Processing...");try{for(let Z=0;Z<H.length-1;Z+=2){const re=H[Z],xe=H[Z+1];It(`Processing pair ${Z/2+1}: ${re.name} - ${xe.name}`);const Ee=await re.arrayBuffer(),Ae=await xe.arrayBuffer(),He=await Ry(Ee,Ae,!1,!0),Ke=qh(He.width,He.height,He.rawData,[32768,32768,32768,32768],65535,"RGGB"),Ue=new Blob([Ke],{type:"image/x-adobe-dng"}),nt=URL.createObjectURL(Ue),Pt=document.createElement("a");Pt.href=nt,Pt.download=`Diff_${re.name}_vs_${xe.name}.dng`,document.body.appendChild(Pt),Pt.click(),document.body.removeChild(Pt),URL.revokeObjectURL(nt),await new Promise(Ze=>setTimeout(Ze,200))}}catch(Z){_t("Batch Diff Failed: "+Z.message)}finally{It(null)}},le=E=>{W(Array.from(E)),It(`Loaded ${E.length} files for Stack FFT. Open Stack Lab to process.`),setTimeout(()=>It(null),2e3)},ge=()=>{Nt(!0)},Ge=()=>{Nt(!1),ua("sampled"),It("Generating..."),setTimeout(()=>C(),50)},st=P.useRef({period:Ma,fill:Yt,phase:Gt});P.useEffect(()=>{(X==null?void 0:X.name)==="pattern_test.dng"&&(st.current.period!==Ma||st.current.fill!==Yt||st.current.phase!==Gt)&&(st.current={period:Ma,fill:Yt,phase:Gt},C())},[Ma,Yt,Gt,X]);const kt=P.useCallback(async E=>{var re;if(xi({displaySettings:E}),!G.current)return;const H=G.current.id;if(E.renderMode==="zero-dependency"||E.renderMode==="zero-dep-color"||E.renderMode==="advanced-zero-dep")if(u)try{Bn(!0);const xe=((re=G.current.rawImageData)==null?void 0:re.whiteLevel)||16383,Ee=await $s.render(H,E,xe);if(Ee){xi({renderedRawImageData:Ee}),Bn(!1);return}else throw new Error("WebGPU returned null frame.")}catch(xe){console.error("WebGPU Render failed:",xe),Bn(!1);return}else{_t("WebGPU not ready/supported. These modes require WebGPU.");return}if(!q)return;Bn(!0),zn.current&&zn.current.terminate();const Z=new Worker(new URL("/assets/renderWorker-B6LAImCA.js",import.meta.url),{type:"module"});zn.current=Z,Z.onmessage=xe=>{const{success:Ee,imageData:Ae,error:He}=xe.data;if(Ee){let Ke=Ae;(X==null?void 0:X.name)==="pattern_test.dng"&&(Ke=ise(Ae,Rh,Rh)),xi({renderedRawImageData:Ke})}else _t(He||"Unknown worker error");Bn(!1),Z.terminate(),zn.current=null},Z.postMessage({buffer:q.slice(0),settings:E})},[q,X,xi,u]),xt=async(E,H)=>{It("Re-sampling X-Trans with new Phase...");try{const re=(await xh(H,E.x,E.y)).dngBuffer,xe=await Bc(re),Ee=URL.createObjectURL(xe.previewBlob),Ae=new Image;Ae.src=Ee,await new Promise(He=>{Ae.onload=()=>He()}),I!=null&&I.previewUrl&&URL.revokeObjectURL(I.previewUrl),xi({rawFileBuffer:re,rawImageData:xe.analysisData,previewUrl:Ee,imageElement:Ae,xtransPhase:E}),Be(null)}catch(Z){console.error("X-Trans Phase Update Failed",Z),_t("Phase Update Failed: "+Z.message)}finally{It(null)}},Je=E=>{if(!I||!I.originalRawFileBuffer||!I.isXTransConverted)return;const H={...I.xtransPhase,...E};xt(H,I.originalRawFileBuffer)},dr=P.useCallback(async E=>{if(I)if(E){if(I.isXTransConverted)return;const H=I.originalRawFileBuffer||I.rawFileBuffer;if(!H)return;It("Converting X-Trans to Pseudo-Bayer DNG...");try{const Z=I.xtransPhase||{x:0,y:0},xe=(await xh(H,Z.x,Z.y)).dngBuffer,Ee=await Bc(xe),Ae=URL.createObjectURL(Ee.previewBlob),He=new Image;He.src=Ae,await new Promise(Ke=>{He.onload=()=>Ke()}),I.previewUrl&&URL.revokeObjectURL(I.previewUrl),xi({rawFileBuffer:xe,rawImageData:Ee.analysisData,previewUrl:Ae,imageElement:He,isXTransConverted:!0,originalRawFileBuffer:H}),Be(null)}catch(Z){console.error("X-Trans Conversion Failed",Z),_t("Failed to convert X-Trans: "+Z.message)}finally{It(null)}}else{if(!I.isXTransConverted)return;const H=I.originalRawFileBuffer;if(!H){_t("Original X-Trans buffer lost. Cannot revert.");return}It("Reverting to Native X-Trans...");try{const Z=await Bc(H),re=URL.createObjectURL(Z.previewBlob),xe=new Image;xe.src=re,await new Promise(Ee=>{xe.onload=()=>Ee()}),I.previewUrl&&URL.revokeObjectURL(I.previewUrl),xi({rawFileBuffer:H,rawImageData:Z.analysisData,previewUrl:re,imageElement:xe,isXTransConverted:!1}),Be(null)}catch(Z){console.error("X-Trans Revert Failed",Z),_t("Failed to revert X-Trans: "+Z.message)}finally{It(null)}}},[I,xi]),Dr=E=>{if(Ml.current){const H=Ml.current,{width:Z,height:re}=H.getBoundingClientRect(),xe=Z/2,Ee=re/2,Ae=E/ni,He=xe-(xe-Qi.x)*Ae,Ke=Ee-(Ee-Qi.y)*Ae;_o({x:He,y:Ke})}ks(E)},xn=E=>{if(!E)return;if(!z){Be(null);return}if(cr){E.w>0&&E.h>0&&Xr(Z=>[...Z,E]);return}Re&&it(!1);const H=Ho(E);Be(H)},Sn=E=>{se(E),xn(E)},ba=()=>{vd(E=>E==="pan"?"select":"pan")},da=(E,H,Z)=>{Xr(re=>{if(re.length===0)return re;if(E==="move")return re.map(xe=>({...xe,x:xe.x+H,y:xe.y+Z}));if(E==="scale"){const xe=re.reduce((Ae,He)=>Ae+He.x+He.w/2,0)/re.length,Ee=re.reduce((Ae,He)=>Ae+He.y+He.h/2,0)/re.length;return re.map(Ae=>{const He=Ae.x+Ae.w/2,Ke=Ae.y+Ae.h/2,Ue=xe+(He-xe)*H,nt=Ee+(Ke-Ee)*Z,Pt=Ae.w*H,Ze=Ae.h*Z;return{...Ae,x:Ue-Pt/2,y:nt-Ze/2,w:Pt,h:Ze}})}return re})},ai=()=>{if(qr.length===0){_t("No ROIs to save.");return}let E=`Index,X,Y,W,H,Orientation
`;qr.forEach((xe,Ee)=>{E+=`${Ee+1},${xe.x.toFixed(2)},${xe.y.toFixed(2)},${xe.w.toFixed(2)},${xe.h.toFixed(2)},${xe.ori||0}
`});const H=new Blob([E],{type:"text/csv;charset=utf-8;"}),Z=URL.createObjectURL(H),re=document.createElement("a");re.setAttribute("href",Z),re.setAttribute("download",`sfr_plate_template_${Date.now()}.csv`),document.body.appendChild(re),re.click(),document.body.removeChild(re),URL.revokeObjectURL(Z)},to=E=>{if(!E||E.length===0){_t("No valid ROIs found in file.");return}Xr(H=>[...H,...E])},Cn=E=>{if(qr.length===0){_t("ROIs ");return}if(!z||de.renderMode!=="advanced-zero-dep"){_t("Advanced Zero-Dep (Unmixed) mode required for scalar SFR calc.");return}It("Computing Batch SFR..."),setTimeout(()=>{try{const H=[];for(const Z of qr){const re=i2(z,Z,de),xe=Z1(re.data,re.width,re.height,{x:0,y:0,w:re.width,h:re.height},{greenOnly:E.greenOnly,globalX:Z.x,globalY:Z.y,bayerPattern:z.bayerPattern});if(xe){const Ee=E.useNR?-1:12,Ae=LO([xe],Ee,null,E.useDeshading);Ae&&Ae.mtf50!==null&&H.push({x:Z.x+Z.w/2,y:Z.y+Z.h/2,mtf50:Ae.mtf50,orientation:xe.orientation})}}if(H.length>0){const Z=H.map(re=>`{${re.x.toFixed(1)},${re.y.toFixed(1)},${re.mtf50.toFixed(4)},${re.orientation}}`).join("");navigator.clipboard.writeText(Z).then(()=>alert(`Computed ${H.length}/${qr.length} ROIs. Copied results to clipboard.`)).catch(re=>_t("Failed to copy results: "+re))}else _t("Failed to compute valid SFR for any selected ROIs.")}catch(H){_t("Batch Compute Failed: "+H.message)}finally{It(null)}},100)},V0=E=>{if(xa===0||xa>4)return;const H=[...yi,E];In(H),xa===4?(H0(H),Zi(0)):Zi(xa+1)},Ic=(E,H,Z,re)=>{const xe=E[0],Ee=E[1],Ae=E[2],He=E[3],Ke=H/2,Ue=[];for(let nt=0;nt<Z;nt++){const Pt=Z>1?nt/(Z-1):.5;for(let Ze=0;Ze<re;Ze++){const Sr=re>1?Ze/(re-1):.5,Ur=xe.x*(1-Sr)+Ee.x*Sr,sn=xe.y*(1-Sr)+Ee.y*Sr,$r=Ae.x*(1-Sr)+He.x*Sr,vr=Ae.y*(1-Sr)+He.y*Sr,br=Ur*(1-Pt)+$r*Pt,Mn=sn*(1-Pt)+vr*Pt,Nn=br-Ke,ea=Mn-Ke;Ue.push({x:Nn,y:ea,w:H,h:H})}}return Ue},H0=E=>{!z||!I||(It("Calculating DR Lab Grid..."),setTimeout(()=>{try{const H=Ic(E,ei,La,Ca);So(H);const Ee=[...[`#BlackLevel: ${(de.blackLevel||[0,0,0,0]).join(",")}`,`#ImageHeight: ${z.height}`],"Filename,Row,Col,R_Mean,G1_Mean,G2_Mean,B_Mean,R_Std,G1_Std,G2_Std,B_Std"],Ae=`img${I.fileName||"image"}`;H.forEach((Pt,Ze)=>{const Sr=Math.floor(Ze/Ca)+1,Ur=Ze%Ca+1,sn=Ol(z.data,z.width,z.height,Pt.x,Pt.y,Pt.w,Pt.h),$r=sn.means,vr=sn.stdDevs,br=`${Ae},${Sr},${Ur},${$r[0].toFixed(4)},${$r[1].toFixed(4)},${$r[2].toFixed(4)},${$r[3].toFixed(4)},${vr[0].toFixed(4)},${vr[1].toFixed(4)},${vr[2].toFixed(4)},${vr[3].toFixed(4)}`;Ee.push(br)});const He=Ee.join(`
`),Ke=new Blob([He],{type:"text/csv;charset=utf-8;"}),Ue=URL.createObjectURL(Ke),nt=document.createElement("a");nt.setAttribute("href",Ue),nt.setAttribute("download","dr_lab_results.csv"),document.body.appendChild(nt),nt.click(),document.body.removeChild(nt),URL.revokeObjectURL(Ue),In([])}catch(H){_t("DR Lab Error: "+H.message)}finally{It(null)}},100))},WO=async(E,H)=>{if(yi.length<4&&Qa.length<1){_t("Please mark the grid on an image first before running batch processing.");return}let Z=Qa;if(Z.length===0&&yi.length===4&&(Z=Ic(yi,ei,La,Ca)),Z.length===0){_t("No grid definitions found. Mark corners first.");return}It(H==="pair"?"Batch Pair Difference (Sigma = Diff/sqrt(2))":"Batch Processing...");const xe=(de.blackLevel||[0,0,0,0]).join(","),Ee=z?z.height:0,He=[...[`#BlackLevel: ${xe}`,`#ImageHeight: ${Ee}`,H==="pair"?"#Mode: Pair Difference (Sigma = Diff/sqrt(2), Full Float Stats)":"#Mode: Independent"],"Filename,Row,Col,R_Mean,G1_Mean,G2_Mean,B_Mean,R_Std,G1_Std,G2_Std,B_Std"],Ke=Array.from(E).sort((Ze,Sr)=>Ze.name.localeCompare(Sr.name,void 0,{numeric:!0}));if(H==="pair"&&Ke.length<2){_t("Need at least 2 files for Pair processing."),It(null);return}const Ue=G.current,nt=(Ue==null?void 0:Ue.isXTransConverted)||!1,Pt=(Ue==null?void 0:Ue.xtransPhase)||{x:0,y:0};try{const Ze=async vr=>{let br=await vr.arrayBuffer();return nt&&(br=(await xh(br,Pt.x,Pt.y)).dngBuffer),br};if(H==="single")for(let vr=0;vr<Ke.length;vr++){const br=Ke[vr];It(`Processing ${vr+1}/${Ke.length}: ${br.name}...`);const Mn=await Ze(br),Nn=await Pu(Mn),ea=`img${br.name}`;Z.forEach((fa,Ti)=>{const Ga=Math.floor(Ti/La)+1,$t=Ti%Ca+1,pn=Ol(Nn.data,Nn.width,Nn.height,fa.x,fa.y,fa.w,fa.h),Wn=pn.means,ii=pn.stdDevs,oi=`${ea},${Ga},${$t},${Wn[0].toFixed(4)},${Wn[1].toFixed(4)},${Wn[2].toFixed(4)},${Wn[3].toFixed(4)},${ii[0].toFixed(4)},${ii[1].toFixed(4)},${ii[2].toFixed(4)},${ii[3].toFixed(4)}`;He.push(oi)})}else for(let vr=0;vr<Ke.length-1;vr+=2){const br=Ke[vr],Mn=Ke[vr+1],Nn=`img${br.name} & ${Mn.name}`;It(`Processing Pair ${Math.floor(vr/2)+1}/${Math.floor(Ke.length/2)}: ${br.name} & ${Mn.name}...`);const ea=await Ze(br),fa=await Pu(ea),Ti=await Ze(Mn),Ga=await Ry(ea,Ti,!1,!1);Z.forEach(($t,pn)=>{const Wn=Math.floor(pn/La)+1,ii=pn%Ca+1,oi=Ol(fa.data,fa.width,fa.height,$t.x,$t.y,$t.w,$t.h),Es=Ol(Ga.rawData,Ga.width,Ga.height,$t.x,$t.y,$t.w,$t.h),ro=oi.means,Rc=Es.stdDevs.map(Oa=>Oa/1.41421356),Dc=`${Nn},${Wn},${ii},${ro[0].toFixed(4)},${ro[1].toFixed(4)},${ro[2].toFixed(4)},${ro[3].toFixed(4)},${Rc[0].toFixed(4)},${Rc[1].toFixed(4)},${Rc[2].toFixed(4)},${Rc[3].toFixed(4)}`;He.push(Dc)})}const Sr=He.join(`
`),Ur=new Blob([Sr],{type:"text/csv;charset=utf-8;"}),sn=URL.createObjectURL(Ur),$r=document.createElement("a");$r.href=sn,$r.setAttribute("download",`dr_lab_batch_${H}_${new Date().getTime()}.csv`),document.body.appendChild($r),$r.click(),document.body.removeChild($r),URL.revokeObjectURL(sn)}catch(Ze){console.error("Batch Error",Ze),_t("Batch Processing Failed: "+Ze.message)}finally{It(null)}},VO=()=>{mt([]),Ot(1)},HO=E=>{if(!be||bt===0)return;const H=[...$e,E];mt(H),H.length===4&&z?(mw(H,De),Ot(0)):Ot(Z=>Z+1)},mw=(E,H)=>{z&&(It("Analyzing Color Chart..."),setTimeout(()=>{try{const Z=Jie(E[0],E[1],E[2],E[3],z.width,z.height,H);Rr(Z);const xe=Z.map((Ee,Ae)=>{const He=Ol(z.data,z.width,z.height,Ee.x,Ee.y,Ee.w,Ee.h);return{id:Ae,rawMeans:He.means,refRGB:[0,0,0]}}).map((Ee,Ae)=>({...Ee,refRGB:q1[Ae]||[0,0,0]}));At(xe),jr(!0)}catch(Z){_t("Color Lab Error: "+Z.message)}finally{It(null)}},100))},XO=E=>{Mt(E),$e.length===4&&mw($e,E)},KO=()=>{jr(!1)},YO=()=>{ee||Tr("No EXIF data found. The file might not contain metadata or it was stripped during processing."),ir(!0)},qO=async E=>{It("Parsing PTC Data...");const H=[];let Z=null;try{for(let re=0;re<E.length;re++){const Ee=(await E[re].text()).split(`
`);let Ae=!0;for(const He of Ee){const Ke=He.trim();if(!Ke)continue;if(Ke.startsWith("#")){if(Ke.includes("BlackLevel:")){const fa=Ke.split(":")[1].trim().split(",");if(fa.length>=4){const Ti=fa.map(Number);Z||(Z={}),Z.blackLevel=Ti}}if(Ke.includes("ImageHeight:")){const fa=parseInt(Ke.split(":")[1].trim());isNaN(fa)||(Z||(Z={}),Z.height=fa)}continue}if(Ae){Ke.toLowerCase().includes("mean")&&Ke.toLowerCase().includes("std")&&(Ae=!1);continue}const Ue=Ke.split(",");if(Ue.length<5)continue;let nt=0,Pt;isNaN(parseFloat(Ue[0]))&&(Pt=Ue[0],nt=1);const Ze=parseInt(Ue[nt]),Sr=parseInt(Ue[nt+1]),Ur=parseFloat(Ue[nt+2]),sn=parseFloat(Ue[nt+3]),$r=parseFloat(Ue[nt+4]),vr=parseFloat(Ue[nt+5]),br=parseFloat(Ue[nt+6]),Mn=parseFloat(Ue[nt+7]),Nn=parseFloat(Ue[nt+8]),ea=parseFloat(Ue[nt+9]);!isNaN(Ur)&&!isNaN(br)&&H.push({channel:"R",mean:Ur,std:br,filename:Pt,row:Ze,col:Sr}),!isNaN(sn)&&!isNaN(Mn)&&H.push({channel:"G1",mean:sn,std:Mn,filename:Pt,row:Ze,col:Sr}),!isNaN($r)&&!isNaN(Nn)&&H.push({channel:"G2",mean:$r,std:Nn,filename:Pt,row:Ze,col:Sr}),!isNaN(vr)&&!isNaN(ea)&&H.push({channel:"B",mean:vr,std:ea,filename:Pt,row:Ze,col:Sr})}}mi(H),bs(Z),h(!0)}catch(re){console.error("PTC Parse Error",re),_t("Failed to parse CSV files: "+re.message)}finally{It(null)}},ZO=()=>{if(!q||!I)return;const E=new Blob([q],{type:"image/x-adobe-dng"}),H=URL.createObjectURL(E),Z=document.createElement("a");Z.href=H;const re=I.fileName||"image.dng",xe=re.toLowerCase().endsWith(".dng")?re:re.replace(/\.[^/.]+$/,"")+".dng";Z.download=xe,document.body.appendChild(Z),Z.click(),document.body.removeChild(Z),URL.revokeObjectURL(H)},JO=()=>{Zi(1),In([]),So([])},yw=()=>{window.open("https://github.com/y-g-jiang/y-g-jiang.github.io/blob/main/drtest.png","_blank")},QO=P.useMemo(()=>Bt?Bt.map((E,H)=>({...E,refRGB:q1[H]||[0,0,0]})):[],[Bt]),e6=()=>{qe(1),fn([]),Xr([])},t6=E=>{if(Ar===0)return;const H=[...hr,E];if(fn(H),H.length===4){qe(0);try{const Z=Woe(H);Xr(Z),Cn({useNR:!0,useDeshading:!0,greenOnly:!1})}catch(Z){console.error("Standard Chart Gen Error",Z),_t("Failed to generate chart ROIs.")}}else qe(Z=>Z+1)},r6=P.useMemo(()=>{if(!tt||!fe)return null;const E=fe.masks.find(H=>H.id===fe.selectedMaskId);return!E||!(E.overlayVisible??!0)?null:{alpha:E.alpha,width:E.width,height:E.height,version:E.version}},[tt,fe]),n6=P.useMemo(()=>{if(!tt||!fe||rr!=="off")return null;const E=fe.masks.find(Z=>Z.id===fe.selectedMaskId);if(!E)return null;const H=(E.items||[]).find(Z=>Z.id===fe.selectedMaskItemId);return!H||H.type!=="ellipse"?null:{id:H.id,center:H.center,radiusX:H.radiusX,radiusY:H.radiusY,rotationDeg:H.rotationDeg}},[tt,fe,rr]);let X0=Tt||te||V;tt||(cn==="reference"&&ie?X0=ie:cn==="sampled"&&he&&(X0=he));const xw=Ji||ri;return c.jsxs("div",{className:"flex flex-col h-screen bg-[#d4d4d4] dark:bg-[#111111] text-black dark:text-gray-200 font-mono transition-colors duration-300 overflow-hidden",children:[c.jsx("div",{className:"p-4 pb-0 flex-shrink-0",children:c.jsx(TE,{onLoadImage:O,onFileSelected:L,onGenerateFakeDng:ge,fileName:X?X.name:null,hasGeneratedData:(X==null?void 0:X.name)==="pattern_test.dng",viewMode:cn,onSetViewMode:ua,patternPeriod:Ma,onPatternPeriodChange:rt,fillFactor:Yt,onFillFactorChange:Vt,patternPhase:Gt,onPatternPhaseChange:Qn,showPatternControls:(X==null?void 0:X.name)==="pattern_test.dng",onOpenAbout:()=>kr(!0),onShowExif:YO,bridgeStatus:M,onBridgeClick:()=>T(!0),isDrLabOpen:Ce,onToggleDrLab:()=>{if(tt){_t("Cannot switch labs while PS Mode is locked.");return}ye(!Ce),Zi(0),In([]),So([]),ze&&ot(!1),be&&ae(!1),ct&&Ct(!1),Ot(0),Rr([]),Xr([]),nr(!1),qe(0)},isColorLabOpen:be,onToggleColorLab:()=>{if(tt){_t("Cannot switch labs while PS Mode is locked.");return}ae(!be),mt([]),Ot(0),Rr([]),Ce&&ye(!1),ze&&ot(!1),ct&&Ct(!1),Xr([]),nr(!1),qe(0)},isFftLabOpen:ze,onToggleFftLab:()=>{if(tt){_t("Cannot switch labs while PS Mode is locked.");return}ot(!ze),Ce&&ye(!1),be&&ae(!1),ct&&Ct(!1),Ot(0),Rr([]),Xr([]),nr(!1),qe(0)},isSfrLabOpen:ct,onToggleSfrLab:()=>{if(tt){_t("Cannot switch labs while PS Mode is locked.");return}Ct(!ct),Ce&&ye(!1),be&&ae(!1),ze&&ot(!1),Ot(0),Rr([]),Xr([]),nr(!1),qe(0)},isPsModeOpen:tt,onTogglePsMode:kd,onGenerateTestPic:yw,onPTCFilesSelected:qO,onDownloadDng:ZO,isThreePlane:Le,onOpenDatabase:()=>v(!0),isSidebarOpen:Ut,onToggleSidebar:()=>Lt(!Ut),stretchMultiplier:Te,onStretchMultiplierChange:Q,onStretchDngExport:Cc,isRawLoaded:!!z,onOpenSaveZ8:()=>k(!0)})}),c.jsxs("div",{className:"flex flex-1 overflow-hidden p-4 pt-2 gap-4 relative",children:[c.jsxs("div",{className:"flex-1 relative bg-gray-200 dark:bg-black border-4 border-gray-500 dark:border-gray-700 shadow-[inset_2px_2px_8px_rgba(0,0,0,0.2)] overflow-hidden transition-colors duration-300",ref:Ml,children:[xw&&c.jsxs("div",{className:"absolute bottom-4 right-4 z-50 flex items-center gap-2 bg-white/90 dark:bg-black/90 px-3 py-1.5 border-2 border-black dark:border-white shadow-[4px_4px_0px_black] dark:shadow-[4px_4px_0px_gray]",children:[c.jsx("div",{className:"w-4 h-4 border-2 border-black dark:border-white border-t-transparent animate-spin"}),c.jsx("span",{className:"text-xs font-bold text-black dark:text-white uppercase",children:Ji||"Processing..."})]}),u&&c.jsx("div",{className:"absolute top-2 left-2 z-30 pointer-events-none opacity-50 hover:opacity-100 transition-opacity",children:c.jsx("span",{className:"text-[9px] font-bold text-cyan-500 bg-black/50 px-1 py-0.5 rounded border border-cyan-500/50",children:" WebGPU"})}),A.length>1&&c.jsxs("div",{className:"absolute bottom-4 left-1/2 -translate-x-1/2 z-50 flex items-center gap-4 bg-white/90 dark:bg-slate-900/90 px-4 py-2 rounded-full shadow-lg border border-gray-200 dark:border-slate-700",children:[c.jsx("button",{onClick:wd,disabled:$===0,className:"p-1 hover:bg-gray-200 dark:hover:bg-slate-700 rounded-full disabled:opacity-30",children:c.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})})}),c.jsxs("span",{className:"font-mono text-xs font-bold text-gray-700 dark:text-gray-300",children:[$+1," / ",A.length]}),c.jsx("button",{onClick:bd,disabled:$===A.length-1,className:"p-1 hover:bg-gray-200 dark:hover:bg-slate-700 rounded-full disabled:opacity-30",children:c.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})})]}),c.jsxs("div",{className:"absolute bottom-4 left-4 z-40 flex flex-col-reverse gap-2 items-start pointer-events-none",children:[Re&&me&&c.jsxs("button",{onClick:()=>it(!1),className:"pointer-events-auto bg-white dark:bg-slate-800 border-2 border-black dark:border-white shadow-[4px_4px_0px_rgba(0,0,0,0.5)] px-3 py-2 text-xs font-bold uppercase tracking-widest hover:translate-x-1 transition-transform flex items-center gap-2",children:[c.jsx("span",{className:"w-2 h-2 rounded-full bg-green-500 animate-pulse"}),"ROI Stats"]}),Xe.filter(E=>E.isMinimized).map(E=>c.jsxs("button",{onClick:()=>Ko(E.id),className:"pointer-events-auto bg-white dark:bg-slate-800 border-2 border-black dark:border-white shadow-[4px_4px_0px_rgba(0,0,0,0.5)] px-3 py-2 text-xs font-bold uppercase tracking-widest hover:translate-x-1 transition-transform flex items-center gap-2",children:[c.jsx("span",{className:`w-2 h-2 rounded-full animate-pulse ${E.type==="histogram"?"bg-cyan-500":E.type==="fft"?"bg-purple-500":E.type==="quant"?"bg-teal-500":"bg-indigo-500"}`}),E.type==="histogram"?"Histogram":E.type==="fft"?"Power Spectrum":E.type==="quant"?"Quantization":"Pearson"]},E.id))]}),c.jsx(Uie,{isOpen:wr,onClose:()=>kr(!1)}),c.jsx(Gie,{isOpen:pr,onClose:()=>ir(!1),data:ee,fileName:X?X.name:"",warning:zt}),c.jsx(Wie,{isOpen:f,onClose:()=>h(!1),data:yn,blackLevel:Na,imageHeight:an,isBGGR:Se,importedMetadata:qi||void 0,theme:s,initialCameraModel:(ee==null?void 0:ee.Model)||"",initialISO:(ee==null?void 0:ee.ISO)||((vw=ee==null?void 0:ee.ISOSpeedRatings)==null?void 0:vw.toString())||""}),c.jsx(Yie,{isOpen:g,onClose:()=>v(!1),theme:s}),c.jsx(qie,{isOpen:w,onClose:()=>b(!1),zIndex:200}),c.jsx(roe,{isOpen:Kr,onClose:KO,patchStats:QO,initialIsBGGR:Se,sizeRatio:De,onSizeChange:XO}),c.jsx(loe,{isOpen:ct,isSfrLabOpen:ct,onClose:()=>{},rawImageData:z,roi:me?{x:me.x,y:me.y,w:me.width,h:me.height}:null,zIndex:200,onFocus:As,displaySettings:de}),c.jsx(uoe,{isOpen:x,onClose:()=>y(!1),rawImageData:z,fileName:(X==null?void 0:X.name)||"image.dng",zIndex:300,onFocus:As}),c.jsx(Soe,{isOpen:_,onClose:()=>j(!1),zIndex:350,onFocus:As}),c.jsx(Moe,{isOpen:S,onClose:()=>k(!1),zIndex:400,onFocus:As}),c.jsx(dl,{isOpen:lt,onClose:()=>Nt(!1),onConfirm:Ge,title:"High Resource Usage Warning",confirmText:"I know the risk and insist to continue",message:c.jsxs("div",{className:"flex flex-col gap-2",children:[c.jsx("p",{children:"Patter DNG mode involves high-frequency refreshing and heavy computation. Due to current memory management limitations, repeated use may lead to browser memory overflow or crashes. Please proceed with caution."}),c.jsx("p",{className:"text-xs text-gray-500"})]})}),c.jsx(dl,{isOpen:N,onClose:()=>T(!1),onConfirm:()=>{window.open("https://y-g-jiang.github.io/jiangbridge.exe","_blank"),T(!1)},title:"JiangBridge Connection / ",confirmText:"Download Bridge App",cancelText:"Cancel",message:c.jsxs("div",{className:"flex flex-col gap-4 text-left",children:[c.jsx("p",{className:"font-bold text-gray-800 dark:text-gray-200",children:"JiangBridge"}),c.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:'JiangBridge is optional for this webpage, but recommended for full functionality. Simply double-click and run it once after system startup. If the indicator light does not turn green after double-clicking, please consider checking whether the web page is allowed to "View and connect to any device on the network".'})]})}),c.jsx(dl,{isOpen:_r,onClose:()=>zr(!1),onConfirm:_s,title:"Export 16-bit TIFF Options",confirmText:"Confirm Export",message:c.jsxs("div",{className:"flex flex-col gap-4 text-left",children:[c.jsxs("div",{className:"grid grid-cols-2 gap-4 bg-gray-50 dark:bg-slate-800/80 p-4 border border-gray-400 dark:border-600",children:[c.jsxs("div",{className:"flex flex-col items-center gap-3",children:[c.jsxs("div",{className:"flex flex-col items-center text-center",children:[c.jsx("span",{className:"font-bold text-xs text-gray-800 dark:text-slate-200",children:"Stretch ()"}),c.jsx("span",{className:"text-[9px] text-gray-500 dark:text-slate-400 mt-0.5",children:"Map [0, White] to [0, 65535]"})]}),c.jsx("div",{onClick:()=>or(!Or),className:`relative w-12 h-6 border-2 border-black dark:border-white cursor-pointer ${Or?"bg-black dark:bg-white":"bg-gray-300 dark:bg-slate-600"}`,children:c.jsx("div",{className:`absolute top-0.5 left-0.5 w-4 h-4 bg-white dark:bg-black shadow-sm transition-transform ${Or?"translate-x-6":""}`})})]}),c.jsxs("div",{className:"flex flex-col items-center gap-3",children:[c.jsxs("div",{className:"flex flex-col items-center text-center",children:[c.jsx("span",{className:"font-bold text-xs text-gray-800 dark:text-slate-200",children:"sRGB Gamma"}),c.jsx("span",{className:"text-[9px] text-gray-500 dark:text-slate-400 mt-0.5",children:"Apply non-linear contrast"})]}),c.jsx("div",{onClick:()=>Xt(!Br),className:`relative w-12 h-6 border-2 border-black dark:border-white cursor-pointer ${Br?"bg-black dark:bg-white":"bg-gray-300 dark:bg-slate-600"}`,children:c.jsx("div",{className:`absolute top-0.5 left-0.5 w-4 h-4 bg-white dark:bg-black shadow-sm transition-transform ${Br?"translate-x-6":""}`})})]})]}),c.jsxs("div",{className:"p-3 bg-gray-200 dark:bg-slate-800 text-[11px] text-black dark:text-white italic border border-gray-400 dark:border-gray-600 text-center font-mono",children:[Or&&!Br&&"Mode: Stretched Linear. Histogram preserved but range expanded.",!Or&&Br&&"Mode: Native DN + sRGB. Best for analyzing raw distribution contrast.",Or&&Br&&"Mode: Ready-to-Use. Conventional 16-bit development.",!Or&&!Br&&"Mode: Native Linear. Pure physical sensor DN values."]})]})}),!Re&&c.jsx(sse,{stats:me,onClose:()=>{Be(null),se(null)},onMinimize:()=>it(!0),isBGGR:Se,onToggleBGGR:we,onOpenWindow:qm,displaySettings:de,zIndex:Zt,onFocus:As,rawImageData:z}),Xe.map(E=>{if(E.isMinimized)return null;const H=A.find(xe=>xe.id===E.sessionId),Z=H==null?void 0:H.rawImageData;if(!Z)return null;const re={key:E.id,isOpen:!0,onClose:()=>Zm(E.id),onMinimize:()=>Dd(E.id),rawImageData:Z,roi:E.roi,isBGGR:E.isBGGR,zIndex:E.zIndex,onFocus:()=>$d(E.id),initialPosition:E.initialPosition,initialInternalState:E.internalState,onUpdateState:xe=>W0(E.id,xe),stackFiles:E.stackFiles};return E.type==="histogram"?c.jsx(Eie,{...re}):E.type==="fft"?c.jsx(Die,{...re,onUpdateROI:xe=>p(E.id,xe)}):E.type==="quant"?c.jsx($ie,{...re}):E.type==="pearson"?c.jsx(Lie,{...re}):null}),Vo&&c.jsx("div",{className:"absolute inset-0 z-50 flex items-center justify-center bg-white/90 dark:bg-black/90 p-8",children:c.jsxs("div",{className:"max-w-md text-center p-6 bg-white dark:bg-black rounded-none border-2 border-red-600 shadow-[8px_8px_0px_rgba(200,0,0,0.5)]",children:[c.jsx("h3",{className:"text-xl font-bold text-red-600 uppercase mb-2",children:"Notice"}),c.jsx("p",{className:"text-black dark:text-white mb-6 whitespace-pre-wrap font-mono",children:Vo}),c.jsx("button",{onClick:()=>_t(null),className:"px-4 py-2 bg-gray-200 hover:bg-gray-300 dark:bg-gray-800 dark:hover:bg-gray-700 border-2 border-black dark:border-white text-black dark:text-white transition-colors uppercase font-bold",children:"Dismiss"})]})}),!X0&&!xw&&!Vo&&c.jsx("div",{className:"absolute inset-0 flex flex-col items-center justify-center text-gray-400 dark:text-gray-600 select-none font-mono",children:c.jsx("p",{className:"text-lg",children:"Load an image or generate a pattern"})}),c.jsx(IE,{image:X0,zoom:ni,pan:Qi,onPanChange:_o,onZoomChange:Dr,onSelectionChange:xn,forcedSelection:Qe,theme:s,touchAction:Ss,isMarking:xa>0||be&&bt>0||Ar>0||tt&&rr!=="off",onPointClick:E=>{xa>0?V0(E):be&&bt>0?HO(E):Ar>0&&t6(E)},markers:yi,gridRects:Qa,colorLabPoints:$e,colorLabRects:Er,sfrRects:qr,psMaskOverlay:r6,psMaskDirtyRect:pt,psGuides:tt&&fe?fe.guides:[],psSelectedGuideId:tt&&fe?fe.selectedGuideId:null,psGuidePickTarget:tt?et:null,psEllipseTool:tt?{mode:rr,draft:Et}:{mode:"off",draft:null},psEditableEllipse:n6,psBrush:{enabled:tt&&gr,size:jt,opacity:R,mode:yr},onPsBrushPaint:Ym,onPsGuidePickPoint:Ua,onPsEllipseCenterPick:Td,onPsEllipseDrag:Ac,onPsEditEllipse:eo}),Ar>0&&hr.map((E,H)=>c.jsxs("div",{className:"absolute pointer-events-none z-30",style:{left:E.x*ni+Qi.x,top:E.y*ni+Qi.y,transform:"translate(-50%, -50%)"},children:[c.jsx("div",{className:"w-3 h-3 border-2 border-cyan-400 rounded-full flex items-center justify-center bg-transparent",children:c.jsx("div",{className:"w-1 h-1 bg-cyan-400 rounded-full"})}),c.jsx("div",{className:"text-[10px] font-bold text-cyan-400 absolute top-3 left-1/2 -translate-x-1/2 bg-black/50 px-1 rounded",children:H+1})]},H)),c.jsx("div",{className:"absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 w-1/2 z-30 pointer-events-none select-none opacity-20 mix-blend-normal dark:mix-blend-plus-lighter",children:c.jsx("svg",{viewBox:"0 0 500 60",className:"w-full h-auto drop-shadow-none",children:c.jsx("text",{x:"50%",y:"50%",dominantBaseline:"middle",textAnchor:"middle",className:"fill-black dark:fill-white",fontSize:"26",fontWeight:"bold",style:{fontFamily:"Courier New, monospace",letterSpacing:"0.05em"},children:" y-g-jiang.github.io"})})}),z&&!xa&&!be&&!cr&&!Ar&&c.jsxs("div",{className:"absolute bottom-4 left-4 z-30 pointer-events-none opacity-60 text-[10px] text-black dark:text-white font-mono bg-white/50 dark:bg-black/50 px-1",children:["Hold ",c.jsx("b",{children:"Shift"})," + Drag to calculate Raw ROI stats"]}),cr&&c.jsx("div",{className:"absolute bottom-4 left-1/2 -translate-x-1/2 z-30 pointer-events-none text-sm font-bold text-red-500 bg-black/80 px-4 py-2 rounded-full border border-red-500 animate-pulse shadow-lg",children:"Manual Batch Marking Active (Shift+Drag to add)"}),Ar>0&&c.jsxs("div",{className:"absolute bottom-4 left-1/2 -translate-x-1/2 z-30 pointer-events-none text-sm font-bold text-emerald-500 bg-black/80 px-4 py-2 rounded-full border border-emerald-500 animate-pulse shadow-lg",children:["Calibration: Click Corner ",Ar,"/4"]}),be&&bt>0&&c.jsxs("div",{className:"absolute top-4 left-1/2 -translate-x-1/2 z-30 pointer-events-none text-sm font-bold text-yellow-500 bg-black/80 px-4 py-2 rounded-full border border-yellow-500 animate-pulse shadow-lg",children:[$e.length===0&&"Click Top-Left Corner of Chart",$e.length===1&&"Click Top-Right Corner",$e.length===2&&"Click Bottom-Left Corner",$e.length===3&&"Click Bottom-Right Corner",$e.length===4&&"Processing..."]}),c.jsx(u8,{zoom:ni,onZoomChange:Dr,onResetView:()=>{ks(1),_o({x:0,y:0})},touchAction:Ss,onToggleTouchAction:ba})]}),Ut&&c.jsx("div",{className:"w-80 flex-shrink-0 bg-white dark:bg-black border-4 border-gray-500 dark:border-gray-700 shadow-[inset_2px_2px_8px_rgba(0,0,0,0.2)] overflow-hidden transition-all duration-300",children:c.jsx(r8,{rawImageData:z,displaySettings:de,onApplyDisplaySettings:kt,onSetSelection:Sn,exifData:ee,isBridgeConnected:M.isConnected,isDrLabOpen:Ce,drMarkingStep:xa,onStartMarking:JO,onGenerateTestPic:yw,drRoiSize:ei,onDrRoiSizeChange:ti,drGridRows:La,onDrGridRowsChange:tn,drGridCols:Ca,onDrGridColsChange:ws,onBatchDrLab:WO,hasDrMarkers:Qa.length>0,isFftLabOpen:ze,onProcessPair:K,onProcessBatchDiff:ne,onProcessStackFft:le,onOpenCrossCalc:()=>b(!0),isThreePlane:Le,onToggleXTrans:dr,xtransPhase:ce,onXTransPhaseChange:Je,isXTransConverted:I==null?void 0:I.isXTransConverted,roiStats:me,isBGGR:Se,isColorLabOpen:be,colorLabMarkingStep:bt,onStartColorLabMarking:VO,isSfrLabOpen:ct,onOpenDngExport:()=>y(!0),sfrRectCount:qr.length,isBatchMarkingMode:cr,onToggleBatchMarking:()=>nr(!cr),onClearBatchMarks:()=>Xr([]),onBatchCompute:Cn,stdChartStep:Ar,onStartStandardCalibration:e6,onSaveBatchTemplate:ai,onImportBatchTemplate:to,onBatchTransform:da,onOpenStackingTool:()=>j(!0),isPsModeOpen:tt,psDocument:fe,canCreatePsEllipse:!!fe,psBrushEnabled:gr,psBrushSize:jt,psBrushOpacity:R,psBrushFeather:Fr,psEllipseFeather:ut,psBrushMode:yr,onPsAddMask:Od,onPsAddEllipseMask:Ad,onPsCancelEllipseTool:Ed,onPsFlipHorizontal:Y,onPsFlipVertical:Pe,onPsCropToRoi:Ec,onPsRotateCanvas:Tc,onPsApplyUpright:yt,onPsApplyLensDistortion:ur,onPsSelectLayer:Nl,onPsSelectMask:Md,onPsBindLayerMask:Ei,onPsSetLayerBlendMode:va,onPsSetLayerOpacity:Id,onPsSetLayerBasic:Wm,onPsSetLayerMixer:Hm,onPsPreviewLayerBasic:Vm,onPsPreviewLayerMixer:Xm,onPsSetLayerCurves:Km,onPsSelectMaskItem:Xo,onPsUpdateEllipseItem:eo,onPsSetMaskOverlayVisible:Nd,onPsAddGuide:Zr,onPsSelectGuide:on,onPsSetGuideEndpoints:Mr,psGuidePickTarget:et,onPsStartGuidePointPick:hn,onPsCancelGuidePointPick:Ai,onPsDeleteGuide:vi,onPsUndo:Oc,onPsJumpHistoryIndex:Sd,onPsExportWorkflowCsv:Pd,onPsImportWorkflowCsv:Cd,onPsExportPng:_d,onPsExportJpeg:jd,onPsBrushEnabledChange:Qt,onPsBrushSizeChange:mr,onPsBrushOpacityChange:sr,onPsBrushFeatherChange:Me,onPsEllipseFeatherChange:gt,onPsBrushModeChange:lr})}),c.jsx(d8,{theme:s,setTheme:l})]})]})},zO=document.getElementById("root");if(!zO)throw new Error("Could not find root element to mount to");const cse=vx.createRoot(zO);cse.render(c.jsx(oe.StrictMode,{children:c.jsx(lse,{})}));
