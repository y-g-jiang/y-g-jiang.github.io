var FN=Object.defineProperty;var UN=(e,t,r)=>t in e?FN(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r;var pr=(e,t,r)=>UN(e,typeof t!="symbol"?t+"":t,r);(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))n(a);new MutationObserver(a=>{for(const i of a)if(i.type==="childList")for(const o of i.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&n(o)}).observe(document,{childList:!0,subtree:!0});function r(a){const i={};return a.integrity&&(i.integrity=a.integrity),a.referrerPolicy&&(i.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?i.credentials="include":a.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function n(a){if(a.ep)return;a.ep=!0;const i=r(a);fetch(a.href,i)}})();var kd=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Fr(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var j3={exports:{}},np={},_3={exports:{}},ir={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var ed=Symbol.for("react.element"),GN=Symbol.for("react.portal"),zN=Symbol.for("react.fragment"),WN=Symbol.for("react.strict_mode"),VN=Symbol.for("react.profiler"),HN=Symbol.for("react.provider"),XN=Symbol.for("react.context"),KN=Symbol.for("react.forward_ref"),qN=Symbol.for("react.suspense"),YN=Symbol.for("react.memo"),ZN=Symbol.for("react.lazy"),Xb=Symbol.iterator;function QN(e){return e===null||typeof e!="object"?null:(e=Xb&&e[Xb]||e["@@iterator"],typeof e=="function"?e:null)}var P3={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},C3=Object.assign,N3={};function Uc(e,t,r){this.props=e,this.context=t,this.refs=N3,this.updater=r||P3}Uc.prototype.isReactComponent={};Uc.prototype.setState=function(e,t){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")};Uc.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function M3(){}M3.prototype=Uc.prototype;function Ox(e,t,r){this.props=e,this.context=t,this.refs=N3,this.updater=r||P3}var Ax=Ox.prototype=new M3;Ax.constructor=Ox;C3(Ax,Uc.prototype);Ax.isPureReactComponent=!0;var Kb=Array.isArray,O3=Object.prototype.hasOwnProperty,Tx={current:null},A3={key:!0,ref:!0,__self:!0,__source:!0};function T3(e,t,r){var n,a={},i=null,o=null;if(t!=null)for(n in t.ref!==void 0&&(o=t.ref),t.key!==void 0&&(i=""+t.key),t)O3.call(t,n)&&!A3.hasOwnProperty(n)&&(a[n]=t[n]);var s=arguments.length-2;if(s===1)a.children=r;else if(1<s){for(var l=Array(s),u=0;u<s;u++)l[u]=arguments[u+2];a.children=l}if(e&&e.defaultProps)for(n in s=e.defaultProps,s)a[n]===void 0&&(a[n]=s[n]);return{$$typeof:ed,type:e,key:i,ref:o,props:a,_owner:Tx.current}}function JN(e,t){return{$$typeof:ed,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}function Ex(e){return typeof e=="object"&&e!==null&&e.$$typeof===ed}function eM(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(r){return t[r]})}var qb=/\/+/g;function Lg(e,t){return typeof e=="object"&&e!==null&&e.key!=null?eM(""+e.key):t.toString(36)}function c0(e,t,r,n,a){var i=typeof e;(i==="undefined"||i==="boolean")&&(e=null);var o=!1;if(e===null)o=!0;else switch(i){case"string":case"number":o=!0;break;case"object":switch(e.$$typeof){case ed:case GN:o=!0}}if(o)return o=e,a=a(o),e=n===""?"."+Lg(o,0):n,Kb(a)?(r="",e!=null&&(r=e.replace(qb,"$&/")+"/"),c0(a,t,r,"",function(u){return u})):a!=null&&(Ex(a)&&(a=JN(a,r+(!a.key||o&&o.key===a.key?"":(""+a.key).replace(qb,"$&/")+"/")+e)),t.push(a)),1;if(o=0,n=n===""?".":n+":",Kb(e))for(var s=0;s<e.length;s++){i=e[s];var l=n+Lg(i,s);o+=c0(i,t,r,l,a)}else if(l=QN(e),typeof l=="function")for(e=l.call(e),s=0;!(i=e.next()).done;)i=i.value,l=n+Lg(i,s++),o+=c0(i,t,r,l,a);else if(i==="object")throw t=String(e),Error("Objects are not valid as a React child (found: "+(t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return o}function Sd(e,t,r){if(e==null)return e;var n=[],a=0;return c0(e,n,"","",function(i){return t.call(r,i,a++)}),n}function tM(e){if(e._status===-1){var t=e._result;t=t(),t.then(function(r){(e._status===0||e._status===-1)&&(e._status=1,e._result=r)},function(r){(e._status===0||e._status===-1)&&(e._status=2,e._result=r)}),e._status===-1&&(e._status=0,e._result=t)}if(e._status===1)return e._result.default;throw e._result}var _a={current:null},u0={transition:null},rM={ReactCurrentDispatcher:_a,ReactCurrentBatchConfig:u0,ReactCurrentOwner:Tx};function E3(){throw Error("act(...) is not supported in production builds of React.")}ir.Children={map:Sd,forEach:function(e,t,r){Sd(e,function(){t.apply(this,arguments)},r)},count:function(e){var t=0;return Sd(e,function(){t++}),t},toArray:function(e){return Sd(e,function(t){return t})||[]},only:function(e){if(!Ex(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};ir.Component=Uc;ir.Fragment=zN;ir.Profiler=VN;ir.PureComponent=Ox;ir.StrictMode=WN;ir.Suspense=qN;ir.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=rM;ir.act=E3;ir.cloneElement=function(e,t,r){if(e==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var n=C3({},e.props),a=e.key,i=e.ref,o=e._owner;if(t!=null){if(t.ref!==void 0&&(i=t.ref,o=Tx.current),t.key!==void 0&&(a=""+t.key),e.type&&e.type.defaultProps)var s=e.type.defaultProps;for(l in t)O3.call(t,l)&&!A3.hasOwnProperty(l)&&(n[l]=t[l]===void 0&&s!==void 0?s[l]:t[l])}var l=arguments.length-2;if(l===1)n.children=r;else if(1<l){s=Array(l);for(var u=0;u<l;u++)s[u]=arguments[u+2];n.children=s}return{$$typeof:ed,type:e.type,key:a,ref:i,props:n,_owner:o}};ir.createContext=function(e){return e={$$typeof:XN,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},e.Provider={$$typeof:HN,_context:e},e.Consumer=e};ir.createElement=T3;ir.createFactory=function(e){var t=T3.bind(null,e);return t.type=e,t};ir.createRef=function(){return{current:null}};ir.forwardRef=function(e){return{$$typeof:KN,render:e}};ir.isValidElement=Ex;ir.lazy=function(e){return{$$typeof:ZN,_payload:{_status:-1,_result:e},_init:tM}};ir.memo=function(e,t){return{$$typeof:YN,type:e,compare:t===void 0?null:t}};ir.startTransition=function(e){var t=u0.transition;u0.transition={};try{e()}finally{u0.transition=t}};ir.unstable_act=E3;ir.useCallback=function(e,t){return _a.current.useCallback(e,t)};ir.useContext=function(e){return _a.current.useContext(e)};ir.useDebugValue=function(){};ir.useDeferredValue=function(e){return _a.current.useDeferredValue(e)};ir.useEffect=function(e,t){return _a.current.useEffect(e,t)};ir.useId=function(){return _a.current.useId()};ir.useImperativeHandle=function(e,t,r){return _a.current.useImperativeHandle(e,t,r)};ir.useInsertionEffect=function(e,t){return _a.current.useInsertionEffect(e,t)};ir.useLayoutEffect=function(e,t){return _a.current.useLayoutEffect(e,t)};ir.useMemo=function(e,t){return _a.current.useMemo(e,t)};ir.useReducer=function(e,t,r){return _a.current.useReducer(e,t,r)};ir.useRef=function(e){return _a.current.useRef(e)};ir.useState=function(e){return _a.current.useState(e)};ir.useSyncExternalStore=function(e,t,r){return _a.current.useSyncExternalStore(e,t,r)};ir.useTransition=function(){return _a.current.useTransition()};ir.version="18.3.1";_3.exports=ir;var C=_3.exports;const J=Fr(C);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var nM=C,aM=Symbol.for("react.element"),iM=Symbol.for("react.fragment"),oM=Object.prototype.hasOwnProperty,sM=nM.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,lM={key:!0,ref:!0,__self:!0,__source:!0};function $3(e,t,r){var n,a={},i=null,o=null;r!==void 0&&(i=""+r),t.key!==void 0&&(i=""+t.key),t.ref!==void 0&&(o=t.ref);for(n in t)oM.call(t,n)&&!lM.hasOwnProperty(n)&&(a[n]=t[n]);if(e&&e.defaultProps)for(n in t=e.defaultProps,t)a[n]===void 0&&(a[n]=t[n]);return{$$typeof:aM,type:e,key:i,ref:o,props:a,_owner:sM.current}}np.Fragment=iM;np.jsx=$3;np.jsxs=$3;j3.exports=np;var c=j3.exports,Jm={},R3={exports:{}},Xa={},D3={exports:{}},I3={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(e){function t(F,H){var W=F.length;F.push(H);e:for(;0<W;){var Q=W-1>>>1,q=F[Q];if(0<a(q,H))F[Q]=H,F[W]=q,W=Q;else break e}}function r(F){return F.length===0?null:F[0]}function n(F){if(F.length===0)return null;var H=F[0],W=F.pop();if(W!==H){F[0]=W;e:for(var Q=0,q=F.length,re=q>>>1;Q<re;){var ee=2*(Q+1)-1,fe=F[ee],oe=ee+1,ye=F[oe];if(0>a(fe,W))oe<q&&0>a(ye,fe)?(F[Q]=ye,F[oe]=W,Q=oe):(F[Q]=fe,F[ee]=W,Q=ee);else if(oe<q&&0>a(ye,W))F[Q]=ye,F[oe]=W,Q=oe;else break e}}return H}function a(F,H){var W=F.sortIndex-H.sortIndex;return W!==0?W:F.id-H.id}if(typeof performance=="object"&&typeof performance.now=="function"){var i=performance;e.unstable_now=function(){return i.now()}}else{var o=Date,s=o.now();e.unstable_now=function(){return o.now()-s}}var l=[],u=[],f=1,d=null,p=3,m=!1,v=!1,b=!1,k=typeof setTimeout=="function"?setTimeout:null,x=typeof clearTimeout=="function"?clearTimeout:null,y=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function w(F){for(var H=r(u);H!==null;){if(H.callback===null)n(u);else if(H.startTime<=F)n(u),H.sortIndex=H.expirationTime,t(l,H);else break;H=r(u)}}function _(F){if(b=!1,w(F),!v)if(r(l)!==null)v=!0,D(S);else{var H=r(u);H!==null&&I(_,H.startTime-F)}}function S(F,H){v=!1,b&&(b=!1,x(A),A=-1),m=!0;var W=p;try{for(w(H),d=r(l);d!==null&&(!(d.expirationTime>H)||F&&!T());){var Q=d.callback;if(typeof Q=="function"){d.callback=null,p=d.priorityLevel;var q=Q(d.expirationTime<=H);H=e.unstable_now(),typeof q=="function"?d.callback=q:d===r(l)&&n(l),w(H)}else n(l);d=r(l)}if(d!==null)var re=!0;else{var ee=r(u);ee!==null&&I(_,ee.startTime-H),re=!1}return re}finally{d=null,p=W,m=!1}}var j=!1,M=null,A=-1,$=5,E=-1;function T(){return!(e.unstable_now()-E<$)}function B(){if(M!==null){var F=e.unstable_now();E=F;var H=!0;try{H=M(!0,F)}finally{H?U():(j=!1,M=null)}}else j=!1}var U;if(typeof y=="function")U=function(){y(B)};else if(typeof MessageChannel<"u"){var V=new MessageChannel,G=V.port2;V.port1.onmessage=B,U=function(){G.postMessage(null)}}else U=function(){k(B,0)};function D(F){M=F,j||(j=!0,U())}function I(F,H){A=k(function(){F(e.unstable_now())},H)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(F){F.callback=null},e.unstable_continueExecution=function(){v||m||(v=!0,D(S))},e.unstable_forceFrameRate=function(F){0>F||125<F?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):$=0<F?Math.floor(1e3/F):5},e.unstable_getCurrentPriorityLevel=function(){return p},e.unstable_getFirstCallbackNode=function(){return r(l)},e.unstable_next=function(F){switch(p){case 1:case 2:case 3:var H=3;break;default:H=p}var W=p;p=H;try{return F()}finally{p=W}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(F,H){switch(F){case 1:case 2:case 3:case 4:case 5:break;default:F=3}var W=p;p=F;try{return H()}finally{p=W}},e.unstable_scheduleCallback=function(F,H,W){var Q=e.unstable_now();switch(typeof W=="object"&&W!==null?(W=W.delay,W=typeof W=="number"&&0<W?Q+W:Q):W=Q,F){case 1:var q=-1;break;case 2:q=250;break;case 5:q=1073741823;break;case 4:q=1e4;break;default:q=5e3}return q=W+q,F={id:f++,callback:H,priorityLevel:F,startTime:W,expirationTime:q,sortIndex:-1},W>Q?(F.sortIndex=W,t(u,F),r(l)===null&&F===r(u)&&(b?(x(A),A=-1):b=!0,I(_,W-Q))):(F.sortIndex=q,t(l,F),v||m||(v=!0,D(S))),F},e.unstable_shouldYield=T,e.unstable_wrapCallback=function(F){var H=p;return function(){var W=p;p=H;try{return F.apply(this,arguments)}finally{p=W}}}})(I3);D3.exports=I3;var cM=D3.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var uM=C,Ha=cM;function Te(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,r=1;r<arguments.length;r++)t+="&args[]="+encodeURIComponent(arguments[r]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var L3=new Set,Qu={};function ml(e,t){oc(e,t),oc(e+"Capture",t)}function oc(e,t){for(Qu[e]=t,e=0;e<t.length;e++)L3.add(t[e])}var xo=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),ey=Object.prototype.hasOwnProperty,fM=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,Yb={},Zb={};function dM(e){return ey.call(Zb,e)?!0:ey.call(Yb,e)?!1:fM.test(e)?Zb[e]=!0:(Yb[e]=!0,!1)}function hM(e,t,r,n){if(r!==null&&r.type===0)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return n?!1:r!==null?!r.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function pM(e,t,r,n){if(t===null||typeof t>"u"||hM(e,t,r,n))return!0;if(n)return!1;if(r!==null)switch(r.type){case 3:return!t;case 4:return t===!1;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}function Pa(e,t,r,n,a,i,o){this.acceptsBooleans=t===2||t===3||t===4,this.attributeName=n,this.attributeNamespace=a,this.mustUseProperty=r,this.propertyName=e,this.type=t,this.sanitizeURL=i,this.removeEmptyString=o}var la={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){la[e]=new Pa(e,0,!1,e,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];la[t]=new Pa(t,1,!1,e[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(e){la[e]=new Pa(e,2,!1,e.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){la[e]=new Pa(e,2,!1,e,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){la[e]=new Pa(e,3,!1,e.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(e){la[e]=new Pa(e,3,!0,e,null,!1,!1)});["capture","download"].forEach(function(e){la[e]=new Pa(e,4,!1,e,null,!1,!1)});["cols","rows","size","span"].forEach(function(e){la[e]=new Pa(e,6,!1,e,null,!1,!1)});["rowSpan","start"].forEach(function(e){la[e]=new Pa(e,5,!1,e.toLowerCase(),null,!1,!1)});var $x=/[\-:]([a-z])/g;function Rx(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace($x,Rx);la[t]=new Pa(t,1,!1,e,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace($x,Rx);la[t]=new Pa(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace($x,Rx);la[t]=new Pa(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(e){la[e]=new Pa(e,1,!1,e.toLowerCase(),null,!1,!1)});la.xlinkHref=new Pa("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(e){la[e]=new Pa(e,1,!1,e.toLowerCase(),null,!0,!0)});function Dx(e,t,r,n){var a=la.hasOwnProperty(t)?la[t]:null;(a!==null?a.type!==0:n||!(2<t.length)||t[0]!=="o"&&t[0]!=="O"||t[1]!=="n"&&t[1]!=="N")&&(pM(t,r,a,n)&&(r=null),n||a===null?dM(t)&&(r===null?e.removeAttribute(t):e.setAttribute(t,""+r)):a.mustUseProperty?e[a.propertyName]=r===null?a.type===3?!1:"":r:(t=a.attributeName,n=a.attributeNamespace,r===null?e.removeAttribute(t):(a=a.type,r=a===3||a===4&&r===!0?"":""+r,n?e.setAttributeNS(n,t,r):e.setAttribute(t,r))))}var Po=uM.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,jd=Symbol.for("react.element"),Rl=Symbol.for("react.portal"),Dl=Symbol.for("react.fragment"),Ix=Symbol.for("react.strict_mode"),ty=Symbol.for("react.profiler"),B3=Symbol.for("react.provider"),F3=Symbol.for("react.context"),Lx=Symbol.for("react.forward_ref"),ry=Symbol.for("react.suspense"),ny=Symbol.for("react.suspense_list"),Bx=Symbol.for("react.memo"),Do=Symbol.for("react.lazy"),U3=Symbol.for("react.offscreen"),Qb=Symbol.iterator;function uu(e){return e===null||typeof e!="object"?null:(e=Qb&&e[Qb]||e["@@iterator"],typeof e=="function"?e:null)}var dn=Object.assign,Bg;function Ou(e){if(Bg===void 0)try{throw Error()}catch(r){var t=r.stack.trim().match(/\n( *(at )?)/);Bg=t&&t[1]||""}return`
`+Bg+e}var Fg=!1;function Ug(e,t){if(!e||Fg)return"";Fg=!0;var r=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(t,[])}catch(u){var n=u}Reflect.construct(e,[],t)}else{try{t.call()}catch(u){n=u}e.call(t.prototype)}else{try{throw Error()}catch(u){n=u}e()}}catch(u){if(u&&n&&typeof u.stack=="string"){for(var a=u.stack.split(`
`),i=n.stack.split(`
`),o=a.length-1,s=i.length-1;1<=o&&0<=s&&a[o]!==i[s];)s--;for(;1<=o&&0<=s;o--,s--)if(a[o]!==i[s]){if(o!==1||s!==1)do if(o--,s--,0>s||a[o]!==i[s]){var l=`
`+a[o].replace(" at new "," at ");return e.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",e.displayName)),l}while(1<=o&&0<=s);break}}}finally{Fg=!1,Error.prepareStackTrace=r}return(e=e?e.displayName||e.name:"")?Ou(e):""}function gM(e){switch(e.tag){case 5:return Ou(e.type);case 16:return Ou("Lazy");case 13:return Ou("Suspense");case 19:return Ou("SuspenseList");case 0:case 2:case 15:return e=Ug(e.type,!1),e;case 11:return e=Ug(e.type.render,!1),e;case 1:return e=Ug(e.type,!0),e;default:return""}}function ay(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case Dl:return"Fragment";case Rl:return"Portal";case ty:return"Profiler";case Ix:return"StrictMode";case ry:return"Suspense";case ny:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case F3:return(e.displayName||"Context")+".Consumer";case B3:return(e._context.displayName||"Context")+".Provider";case Lx:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case Bx:return t=e.displayName||null,t!==null?t:ay(e.type)||"Memo";case Do:t=e._payload,e=e._init;try{return ay(e(t))}catch{}}return null}function mM(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=t.render,e=e.displayName||e.name||"",t.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return ay(t);case 8:return t===Ix?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t}return null}function cs(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function G3(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function yM(e){var t=G3(e)?"checked":"value",r=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),n=""+e[t];if(!e.hasOwnProperty(t)&&typeof r<"u"&&typeof r.get=="function"&&typeof r.set=="function"){var a=r.get,i=r.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return a.call(this)},set:function(o){n=""+o,i.call(this,o)}}),Object.defineProperty(e,t,{enumerable:r.enumerable}),{getValue:function(){return n},setValue:function(o){n=""+o},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function _d(e){e._valueTracker||(e._valueTracker=yM(e))}function z3(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var r=t.getValue(),n="";return e&&(n=G3(e)?e.checked?"true":"false":e.value),e=n,e!==r?(t.setValue(e),!0):!1}function j0(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function iy(e,t){var r=t.checked;return dn({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:r??e._wrapperState.initialChecked})}function Jb(e,t){var r=t.defaultValue==null?"":t.defaultValue,n=t.checked!=null?t.checked:t.defaultChecked;r=cs(t.value!=null?t.value:r),e._wrapperState={initialChecked:n,initialValue:r,controlled:t.type==="checkbox"||t.type==="radio"?t.checked!=null:t.value!=null}}function W3(e,t){t=t.checked,t!=null&&Dx(e,"checked",t,!1)}function oy(e,t){W3(e,t);var r=cs(t.value),n=t.type;if(r!=null)n==="number"?(r===0&&e.value===""||e.value!=r)&&(e.value=""+r):e.value!==""+r&&(e.value=""+r);else if(n==="submit"||n==="reset"){e.removeAttribute("value");return}t.hasOwnProperty("value")?sy(e,t.type,r):t.hasOwnProperty("defaultValue")&&sy(e,t.type,cs(t.defaultValue)),t.checked==null&&t.defaultChecked!=null&&(e.defaultChecked=!!t.defaultChecked)}function e2(e,t,r){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var n=t.type;if(!(n!=="submit"&&n!=="reset"||t.value!==void 0&&t.value!==null))return;t=""+e._wrapperState.initialValue,r||t===e.value||(e.value=t),e.defaultValue=t}r=e.name,r!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,r!==""&&(e.name=r)}function sy(e,t,r){(t!=="number"||j0(e.ownerDocument)!==e)&&(r==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+r&&(e.defaultValue=""+r))}var Au=Array.isArray;function Yl(e,t,r,n){if(e=e.options,t){t={};for(var a=0;a<r.length;a++)t["$"+r[a]]=!0;for(r=0;r<e.length;r++)a=t.hasOwnProperty("$"+e[r].value),e[r].selected!==a&&(e[r].selected=a),a&&n&&(e[r].defaultSelected=!0)}else{for(r=""+cs(r),t=null,a=0;a<e.length;a++){if(e[a].value===r){e[a].selected=!0,n&&(e[a].defaultSelected=!0);return}t!==null||e[a].disabled||(t=e[a])}t!==null&&(t.selected=!0)}}function ly(e,t){if(t.dangerouslySetInnerHTML!=null)throw Error(Te(91));return dn({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function t2(e,t){var r=t.value;if(r==null){if(r=t.children,t=t.defaultValue,r!=null){if(t!=null)throw Error(Te(92));if(Au(r)){if(1<r.length)throw Error(Te(93));r=r[0]}t=r}t==null&&(t=""),r=t}e._wrapperState={initialValue:cs(r)}}function V3(e,t){var r=cs(t.value),n=cs(t.defaultValue);r!=null&&(r=""+r,r!==e.value&&(e.value=r),t.defaultValue==null&&e.defaultValue!==r&&(e.defaultValue=r)),n!=null&&(e.defaultValue=""+n)}function r2(e){var t=e.textContent;t===e._wrapperState.initialValue&&t!==""&&t!==null&&(e.value=t)}function H3(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function cy(e,t){return e==null||e==="http://www.w3.org/1999/xhtml"?H3(t):e==="http://www.w3.org/2000/svg"&&t==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var Pd,X3=function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(t,r,n,a){MSApp.execUnsafeLocalFunction(function(){return e(t,r,n,a)})}:e}(function(e,t){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=t;else{for(Pd=Pd||document.createElement("div"),Pd.innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=Pd.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}});function Ju(e,t){if(t){var r=e.firstChild;if(r&&r===e.lastChild&&r.nodeType===3){r.nodeValue=t;return}}e.textContent=t}var Ru={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},vM=["Webkit","ms","Moz","O"];Object.keys(Ru).forEach(function(e){vM.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),Ru[t]=Ru[e]})});function K3(e,t,r){return t==null||typeof t=="boolean"||t===""?"":r||typeof t!="number"||t===0||Ru.hasOwnProperty(e)&&Ru[e]?(""+t).trim():t+"px"}function q3(e,t){e=e.style;for(var r in t)if(t.hasOwnProperty(r)){var n=r.indexOf("--")===0,a=K3(r,t[r],n);r==="float"&&(r="cssFloat"),n?e.setProperty(r,a):e[r]=a}}var xM=dn({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function uy(e,t){if(t){if(xM[e]&&(t.children!=null||t.dangerouslySetInnerHTML!=null))throw Error(Te(137,e));if(t.dangerouslySetInnerHTML!=null){if(t.children!=null)throw Error(Te(60));if(typeof t.dangerouslySetInnerHTML!="object"||!("__html"in t.dangerouslySetInnerHTML))throw Error(Te(61))}if(t.style!=null&&typeof t.style!="object")throw Error(Te(62))}}function fy(e,t){if(e.indexOf("-")===-1)return typeof t.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var dy=null;function Fx(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var hy=null,Zl=null,Ql=null;function n2(e){if(e=nd(e)){if(typeof hy!="function")throw Error(Te(280));var t=e.stateNode;t&&(t=lp(t),hy(e.stateNode,e.type,t))}}function Y3(e){Zl?Ql?Ql.push(e):Ql=[e]:Zl=e}function Z3(){if(Zl){var e=Zl,t=Ql;if(Ql=Zl=null,n2(e),t)for(e=0;e<t.length;e++)n2(t[e])}}function Q3(e,t){return e(t)}function J3(){}var Gg=!1;function e4(e,t,r){if(Gg)return e(t,r);Gg=!0;try{return Q3(e,t,r)}finally{Gg=!1,(Zl!==null||Ql!==null)&&(J3(),Z3())}}function ef(e,t){var r=e.stateNode;if(r===null)return null;var n=lp(r);if(n===null)return null;r=n[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(n=!n.disabled)||(e=e.type,n=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!n;break e;default:e=!1}if(e)return null;if(r&&typeof r!="function")throw Error(Te(231,t,typeof r));return r}var py=!1;if(xo)try{var fu={};Object.defineProperty(fu,"passive",{get:function(){py=!0}}),window.addEventListener("test",fu,fu),window.removeEventListener("test",fu,fu)}catch{py=!1}function bM(e,t,r,n,a,i,o,s,l){var u=Array.prototype.slice.call(arguments,3);try{t.apply(r,u)}catch(f){this.onError(f)}}var Du=!1,_0=null,P0=!1,gy=null,wM={onError:function(e){Du=!0,_0=e}};function kM(e,t,r,n,a,i,o,s,l){Du=!1,_0=null,bM.apply(wM,arguments)}function SM(e,t,r,n,a,i,o,s,l){if(kM.apply(this,arguments),Du){if(Du){var u=_0;Du=!1,_0=null}else throw Error(Te(198));P0||(P0=!0,gy=u)}}function yl(e){var t=e,r=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,t.flags&4098&&(r=t.return),e=t.return;while(e)}return t.tag===3?r:null}function t4(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function a2(e){if(yl(e)!==e)throw Error(Te(188))}function jM(e){var t=e.alternate;if(!t){if(t=yl(e),t===null)throw Error(Te(188));return t!==e?null:e}for(var r=e,n=t;;){var a=r.return;if(a===null)break;var i=a.alternate;if(i===null){if(n=a.return,n!==null){r=n;continue}break}if(a.child===i.child){for(i=a.child;i;){if(i===r)return a2(a),e;if(i===n)return a2(a),t;i=i.sibling}throw Error(Te(188))}if(r.return!==n.return)r=a,n=i;else{for(var o=!1,s=a.child;s;){if(s===r){o=!0,r=a,n=i;break}if(s===n){o=!0,n=a,r=i;break}s=s.sibling}if(!o){for(s=i.child;s;){if(s===r){o=!0,r=i,n=a;break}if(s===n){o=!0,n=i,r=a;break}s=s.sibling}if(!o)throw Error(Te(189))}}if(r.alternate!==n)throw Error(Te(190))}if(r.tag!==3)throw Error(Te(188));return r.stateNode.current===r?e:t}function r4(e){return e=jM(e),e!==null?n4(e):null}function n4(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var t=n4(e);if(t!==null)return t;e=e.sibling}return null}var a4=Ha.unstable_scheduleCallback,i2=Ha.unstable_cancelCallback,_M=Ha.unstable_shouldYield,PM=Ha.unstable_requestPaint,Pn=Ha.unstable_now,CM=Ha.unstable_getCurrentPriorityLevel,Ux=Ha.unstable_ImmediatePriority,i4=Ha.unstable_UserBlockingPriority,C0=Ha.unstable_NormalPriority,NM=Ha.unstable_LowPriority,o4=Ha.unstable_IdlePriority,ap=null,Wi=null;function MM(e){if(Wi&&typeof Wi.onCommitFiberRoot=="function")try{Wi.onCommitFiberRoot(ap,e,void 0,(e.current.flags&128)===128)}catch{}}var Mi=Math.clz32?Math.clz32:TM,OM=Math.log,AM=Math.LN2;function TM(e){return e>>>=0,e===0?32:31-(OM(e)/AM|0)|0}var Cd=64,Nd=4194304;function Tu(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function N0(e,t){var r=e.pendingLanes;if(r===0)return 0;var n=0,a=e.suspendedLanes,i=e.pingedLanes,o=r&268435455;if(o!==0){var s=o&~a;s!==0?n=Tu(s):(i&=o,i!==0&&(n=Tu(i)))}else o=r&~a,o!==0?n=Tu(o):i!==0&&(n=Tu(i));if(n===0)return 0;if(t!==0&&t!==n&&!(t&a)&&(a=n&-n,i=t&-t,a>=i||a===16&&(i&4194240)!==0))return t;if(n&4&&(n|=r&16),t=e.entangledLanes,t!==0)for(e=e.entanglements,t&=n;0<t;)r=31-Mi(t),a=1<<r,n|=e[r],t&=~a;return n}function EM(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function $M(e,t){for(var r=e.suspendedLanes,n=e.pingedLanes,a=e.expirationTimes,i=e.pendingLanes;0<i;){var o=31-Mi(i),s=1<<o,l=a[o];l===-1?(!(s&r)||s&n)&&(a[o]=EM(s,t)):l<=t&&(e.expiredLanes|=s),i&=~s}}function my(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function s4(){var e=Cd;return Cd<<=1,!(Cd&4194240)&&(Cd=64),e}function zg(e){for(var t=[],r=0;31>r;r++)t.push(e);return t}function td(e,t,r){e.pendingLanes|=t,t!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,t=31-Mi(t),e[t]=r}function RM(e,t){var r=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var n=e.eventTimes;for(e=e.expirationTimes;0<r;){var a=31-Mi(r),i=1<<a;t[a]=0,n[a]=-1,e[a]=-1,r&=~i}}function Gx(e,t){var r=e.entangledLanes|=t;for(e=e.entanglements;r;){var n=31-Mi(r),a=1<<n;a&t|e[n]&t&&(e[n]|=t),r&=~a}}var Mr=0;function l4(e){return e&=-e,1<e?4<e?e&268435455?16:536870912:4:1}var c4,zx,u4,f4,d4,yy=!1,Md=[],Qo=null,Jo=null,es=null,tf=new Map,rf=new Map,Bo=[],DM="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function o2(e,t){switch(e){case"focusin":case"focusout":Qo=null;break;case"dragenter":case"dragleave":Jo=null;break;case"mouseover":case"mouseout":es=null;break;case"pointerover":case"pointerout":tf.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":rf.delete(t.pointerId)}}function du(e,t,r,n,a,i){return e===null||e.nativeEvent!==i?(e={blockedOn:t,domEventName:r,eventSystemFlags:n,nativeEvent:i,targetContainers:[a]},t!==null&&(t=nd(t),t!==null&&zx(t)),e):(e.eventSystemFlags|=n,t=e.targetContainers,a!==null&&t.indexOf(a)===-1&&t.push(a),e)}function IM(e,t,r,n,a){switch(t){case"focusin":return Qo=du(Qo,e,t,r,n,a),!0;case"dragenter":return Jo=du(Jo,e,t,r,n,a),!0;case"mouseover":return es=du(es,e,t,r,n,a),!0;case"pointerover":var i=a.pointerId;return tf.set(i,du(tf.get(i)||null,e,t,r,n,a)),!0;case"gotpointercapture":return i=a.pointerId,rf.set(i,du(rf.get(i)||null,e,t,r,n,a)),!0}return!1}function h4(e){var t=Ds(e.target);if(t!==null){var r=yl(t);if(r!==null){if(t=r.tag,t===13){if(t=t4(r),t!==null){e.blockedOn=t,d4(e.priority,function(){u4(r)});return}}else if(t===3&&r.stateNode.current.memoizedState.isDehydrated){e.blockedOn=r.tag===3?r.stateNode.containerInfo:null;return}}}e.blockedOn=null}function f0(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var r=vy(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(r===null){r=e.nativeEvent;var n=new r.constructor(r.type,r);dy=n,r.target.dispatchEvent(n),dy=null}else return t=nd(r),t!==null&&zx(t),e.blockedOn=r,!1;t.shift()}return!0}function s2(e,t,r){f0(e)&&r.delete(t)}function LM(){yy=!1,Qo!==null&&f0(Qo)&&(Qo=null),Jo!==null&&f0(Jo)&&(Jo=null),es!==null&&f0(es)&&(es=null),tf.forEach(s2),rf.forEach(s2)}function hu(e,t){e.blockedOn===t&&(e.blockedOn=null,yy||(yy=!0,Ha.unstable_scheduleCallback(Ha.unstable_NormalPriority,LM)))}function nf(e){function t(a){return hu(a,e)}if(0<Md.length){hu(Md[0],e);for(var r=1;r<Md.length;r++){var n=Md[r];n.blockedOn===e&&(n.blockedOn=null)}}for(Qo!==null&&hu(Qo,e),Jo!==null&&hu(Jo,e),es!==null&&hu(es,e),tf.forEach(t),rf.forEach(t),r=0;r<Bo.length;r++)n=Bo[r],n.blockedOn===e&&(n.blockedOn=null);for(;0<Bo.length&&(r=Bo[0],r.blockedOn===null);)h4(r),r.blockedOn===null&&Bo.shift()}var Jl=Po.ReactCurrentBatchConfig,M0=!0;function BM(e,t,r,n){var a=Mr,i=Jl.transition;Jl.transition=null;try{Mr=1,Wx(e,t,r,n)}finally{Mr=a,Jl.transition=i}}function FM(e,t,r,n){var a=Mr,i=Jl.transition;Jl.transition=null;try{Mr=4,Wx(e,t,r,n)}finally{Mr=a,Jl.transition=i}}function Wx(e,t,r,n){if(M0){var a=vy(e,t,r,n);if(a===null)Jg(e,t,n,O0,r),o2(e,n);else if(IM(a,e,t,r,n))n.stopPropagation();else if(o2(e,n),t&4&&-1<DM.indexOf(e)){for(;a!==null;){var i=nd(a);if(i!==null&&c4(i),i=vy(e,t,r,n),i===null&&Jg(e,t,n,O0,r),i===a)break;a=i}a!==null&&n.stopPropagation()}else Jg(e,t,n,null,r)}}var O0=null;function vy(e,t,r,n){if(O0=null,e=Fx(n),e=Ds(e),e!==null)if(t=yl(e),t===null)e=null;else if(r=t.tag,r===13){if(e=t4(t),e!==null)return e;e=null}else if(r===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return O0=e,null}function p4(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(CM()){case Ux:return 1;case i4:return 4;case C0:case NM:return 16;case o4:return 536870912;default:return 16}default:return 16}}var Go=null,Vx=null,d0=null;function g4(){if(d0)return d0;var e,t=Vx,r=t.length,n,a="value"in Go?Go.value:Go.textContent,i=a.length;for(e=0;e<r&&t[e]===a[e];e++);var o=r-e;for(n=1;n<=o&&t[r-n]===a[i-n];n++);return d0=a.slice(e,1<n?1-n:void 0)}function h0(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function Od(){return!0}function l2(){return!1}function Ka(e){function t(r,n,a,i,o){this._reactName=r,this._targetInst=a,this.type=n,this.nativeEvent=i,this.target=o,this.currentTarget=null;for(var s in e)e.hasOwnProperty(s)&&(r=e[s],this[s]=r?r(i):i[s]);return this.isDefaultPrevented=(i.defaultPrevented!=null?i.defaultPrevented:i.returnValue===!1)?Od:l2,this.isPropagationStopped=l2,this}return dn(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var r=this.nativeEvent;r&&(r.preventDefault?r.preventDefault():typeof r.returnValue!="unknown"&&(r.returnValue=!1),this.isDefaultPrevented=Od)},stopPropagation:function(){var r=this.nativeEvent;r&&(r.stopPropagation?r.stopPropagation():typeof r.cancelBubble!="unknown"&&(r.cancelBubble=!0),this.isPropagationStopped=Od)},persist:function(){},isPersistent:Od}),t}var Gc={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Hx=Ka(Gc),rd=dn({},Gc,{view:0,detail:0}),UM=Ka(rd),Wg,Vg,pu,ip=dn({},rd,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Xx,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==pu&&(pu&&e.type==="mousemove"?(Wg=e.screenX-pu.screenX,Vg=e.screenY-pu.screenY):Vg=Wg=0,pu=e),Wg)},movementY:function(e){return"movementY"in e?e.movementY:Vg}}),c2=Ka(ip),GM=dn({},ip,{dataTransfer:0}),zM=Ka(GM),WM=dn({},rd,{relatedTarget:0}),Hg=Ka(WM),VM=dn({},Gc,{animationName:0,elapsedTime:0,pseudoElement:0}),HM=Ka(VM),XM=dn({},Gc,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),KM=Ka(XM),qM=dn({},Gc,{data:0}),u2=Ka(qM),YM={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},ZM={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},QM={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function JM(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=QM[e])?!!t[e]:!1}function Xx(){return JM}var eO=dn({},rd,{key:function(e){if(e.key){var t=YM[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=h0(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?ZM[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Xx,charCode:function(e){return e.type==="keypress"?h0(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?h0(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),tO=Ka(eO),rO=dn({},ip,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),f2=Ka(rO),nO=dn({},rd,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Xx}),aO=Ka(nO),iO=dn({},Gc,{propertyName:0,elapsedTime:0,pseudoElement:0}),oO=Ka(iO),sO=dn({},ip,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),lO=Ka(sO),cO=[9,13,27,32],Kx=xo&&"CompositionEvent"in window,Iu=null;xo&&"documentMode"in document&&(Iu=document.documentMode);var uO=xo&&"TextEvent"in window&&!Iu,m4=xo&&(!Kx||Iu&&8<Iu&&11>=Iu),d2=" ",h2=!1;function y4(e,t){switch(e){case"keyup":return cO.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function v4(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var Il=!1;function fO(e,t){switch(e){case"compositionend":return v4(t);case"keypress":return t.which!==32?null:(h2=!0,d2);case"textInput":return e=t.data,e===d2&&h2?null:e;default:return null}}function dO(e,t){if(Il)return e==="compositionend"||!Kx&&y4(e,t)?(e=g4(),d0=Vx=Go=null,Il=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return m4&&t.locale!=="ko"?null:t.data;default:return null}}var hO={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function p2(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!hO[e.type]:t==="textarea"}function x4(e,t,r,n){Y3(n),t=A0(t,"onChange"),0<t.length&&(r=new Hx("onChange","change",null,r,n),e.push({event:r,listeners:t}))}var Lu=null,af=null;function pO(e){O4(e,0)}function op(e){var t=Fl(e);if(z3(t))return e}function gO(e,t){if(e==="change")return t}var b4=!1;if(xo){var Xg;if(xo){var Kg="oninput"in document;if(!Kg){var g2=document.createElement("div");g2.setAttribute("oninput","return;"),Kg=typeof g2.oninput=="function"}Xg=Kg}else Xg=!1;b4=Xg&&(!document.documentMode||9<document.documentMode)}function m2(){Lu&&(Lu.detachEvent("onpropertychange",w4),af=Lu=null)}function w4(e){if(e.propertyName==="value"&&op(af)){var t=[];x4(t,af,e,Fx(e)),e4(pO,t)}}function mO(e,t,r){e==="focusin"?(m2(),Lu=t,af=r,Lu.attachEvent("onpropertychange",w4)):e==="focusout"&&m2()}function yO(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return op(af)}function vO(e,t){if(e==="click")return op(t)}function xO(e,t){if(e==="input"||e==="change")return op(t)}function bO(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var Ai=typeof Object.is=="function"?Object.is:bO;function of(e,t){if(Ai(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var r=Object.keys(e),n=Object.keys(t);if(r.length!==n.length)return!1;for(n=0;n<r.length;n++){var a=r[n];if(!ey.call(t,a)||!Ai(e[a],t[a]))return!1}return!0}function y2(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function v2(e,t){var r=y2(e);e=0;for(var n;r;){if(r.nodeType===3){if(n=e+r.textContent.length,e<=t&&n>=t)return{node:r,offset:t-e};e=n}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=y2(r)}}function k4(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?k4(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function S4(){for(var e=window,t=j0();t instanceof e.HTMLIFrameElement;){try{var r=typeof t.contentWindow.location.href=="string"}catch{r=!1}if(r)e=t.contentWindow;else break;t=j0(e.document)}return t}function qx(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}function wO(e){var t=S4(),r=e.focusedElem,n=e.selectionRange;if(t!==r&&r&&r.ownerDocument&&k4(r.ownerDocument.documentElement,r)){if(n!==null&&qx(r)){if(t=n.start,e=n.end,e===void 0&&(e=t),"selectionStart"in r)r.selectionStart=t,r.selectionEnd=Math.min(e,r.value.length);else if(e=(t=r.ownerDocument||document)&&t.defaultView||window,e.getSelection){e=e.getSelection();var a=r.textContent.length,i=Math.min(n.start,a);n=n.end===void 0?i:Math.min(n.end,a),!e.extend&&i>n&&(a=n,n=i,i=a),a=v2(r,i);var o=v2(r,n);a&&o&&(e.rangeCount!==1||e.anchorNode!==a.node||e.anchorOffset!==a.offset||e.focusNode!==o.node||e.focusOffset!==o.offset)&&(t=t.createRange(),t.setStart(a.node,a.offset),e.removeAllRanges(),i>n?(e.addRange(t),e.extend(o.node,o.offset)):(t.setEnd(o.node,o.offset),e.addRange(t)))}}for(t=[],e=r;e=e.parentNode;)e.nodeType===1&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof r.focus=="function"&&r.focus(),r=0;r<t.length;r++)e=t[r],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var kO=xo&&"documentMode"in document&&11>=document.documentMode,Ll=null,xy=null,Bu=null,by=!1;function x2(e,t,r){var n=r.window===r?r.document:r.nodeType===9?r:r.ownerDocument;by||Ll==null||Ll!==j0(n)||(n=Ll,"selectionStart"in n&&qx(n)?n={start:n.selectionStart,end:n.selectionEnd}:(n=(n.ownerDocument&&n.ownerDocument.defaultView||window).getSelection(),n={anchorNode:n.anchorNode,anchorOffset:n.anchorOffset,focusNode:n.focusNode,focusOffset:n.focusOffset}),Bu&&of(Bu,n)||(Bu=n,n=A0(xy,"onSelect"),0<n.length&&(t=new Hx("onSelect","select",null,t,r),e.push({event:t,listeners:n}),t.target=Ll)))}function Ad(e,t){var r={};return r[e.toLowerCase()]=t.toLowerCase(),r["Webkit"+e]="webkit"+t,r["Moz"+e]="moz"+t,r}var Bl={animationend:Ad("Animation","AnimationEnd"),animationiteration:Ad("Animation","AnimationIteration"),animationstart:Ad("Animation","AnimationStart"),transitionend:Ad("Transition","TransitionEnd")},qg={},j4={};xo&&(j4=document.createElement("div").style,"AnimationEvent"in window||(delete Bl.animationend.animation,delete Bl.animationiteration.animation,delete Bl.animationstart.animation),"TransitionEvent"in window||delete Bl.transitionend.transition);function sp(e){if(qg[e])return qg[e];if(!Bl[e])return e;var t=Bl[e],r;for(r in t)if(t.hasOwnProperty(r)&&r in j4)return qg[e]=t[r];return e}var _4=sp("animationend"),P4=sp("animationiteration"),C4=sp("animationstart"),N4=sp("transitionend"),M4=new Map,b2="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function fs(e,t){M4.set(e,t),ml(t,[e])}for(var Yg=0;Yg<b2.length;Yg++){var Zg=b2[Yg],SO=Zg.toLowerCase(),jO=Zg[0].toUpperCase()+Zg.slice(1);fs(SO,"on"+jO)}fs(_4,"onAnimationEnd");fs(P4,"onAnimationIteration");fs(C4,"onAnimationStart");fs("dblclick","onDoubleClick");fs("focusin","onFocus");fs("focusout","onBlur");fs(N4,"onTransitionEnd");oc("onMouseEnter",["mouseout","mouseover"]);oc("onMouseLeave",["mouseout","mouseover"]);oc("onPointerEnter",["pointerout","pointerover"]);oc("onPointerLeave",["pointerout","pointerover"]);ml("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));ml("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));ml("onBeforeInput",["compositionend","keypress","textInput","paste"]);ml("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));ml("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));ml("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Eu="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),_O=new Set("cancel close invalid load scroll toggle".split(" ").concat(Eu));function w2(e,t,r){var n=e.type||"unknown-event";e.currentTarget=r,SM(n,t,void 0,e),e.currentTarget=null}function O4(e,t){t=(t&4)!==0;for(var r=0;r<e.length;r++){var n=e[r],a=n.event;n=n.listeners;e:{var i=void 0;if(t)for(var o=n.length-1;0<=o;o--){var s=n[o],l=s.instance,u=s.currentTarget;if(s=s.listener,l!==i&&a.isPropagationStopped())break e;w2(a,s,u),i=l}else for(o=0;o<n.length;o++){if(s=n[o],l=s.instance,u=s.currentTarget,s=s.listener,l!==i&&a.isPropagationStopped())break e;w2(a,s,u),i=l}}}if(P0)throw e=gy,P0=!1,gy=null,e}function Zr(e,t){var r=t[_y];r===void 0&&(r=t[_y]=new Set);var n=e+"__bubble";r.has(n)||(A4(t,e,2,!1),r.add(n))}function Qg(e,t,r){var n=0;t&&(n|=4),A4(r,e,n,t)}var Td="_reactListening"+Math.random().toString(36).slice(2);function sf(e){if(!e[Td]){e[Td]=!0,L3.forEach(function(r){r!=="selectionchange"&&(_O.has(r)||Qg(r,!1,e),Qg(r,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[Td]||(t[Td]=!0,Qg("selectionchange",!1,t))}}function A4(e,t,r,n){switch(p4(t)){case 1:var a=BM;break;case 4:a=FM;break;default:a=Wx}r=a.bind(null,t,r,e),a=void 0,!py||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(a=!0),n?a!==void 0?e.addEventListener(t,r,{capture:!0,passive:a}):e.addEventListener(t,r,!0):a!==void 0?e.addEventListener(t,r,{passive:a}):e.addEventListener(t,r,!1)}function Jg(e,t,r,n,a){var i=n;if(!(t&1)&&!(t&2)&&n!==null)e:for(;;){if(n===null)return;var o=n.tag;if(o===3||o===4){var s=n.stateNode.containerInfo;if(s===a||s.nodeType===8&&s.parentNode===a)break;if(o===4)for(o=n.return;o!==null;){var l=o.tag;if((l===3||l===4)&&(l=o.stateNode.containerInfo,l===a||l.nodeType===8&&l.parentNode===a))return;o=o.return}for(;s!==null;){if(o=Ds(s),o===null)return;if(l=o.tag,l===5||l===6){n=i=o;continue e}s=s.parentNode}}n=n.return}e4(function(){var u=i,f=Fx(r),d=[];e:{var p=M4.get(e);if(p!==void 0){var m=Hx,v=e;switch(e){case"keypress":if(h0(r)===0)break e;case"keydown":case"keyup":m=tO;break;case"focusin":v="focus",m=Hg;break;case"focusout":v="blur",m=Hg;break;case"beforeblur":case"afterblur":m=Hg;break;case"click":if(r.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":m=c2;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":m=zM;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":m=aO;break;case _4:case P4:case C4:m=HM;break;case N4:m=oO;break;case"scroll":m=UM;break;case"wheel":m=lO;break;case"copy":case"cut":case"paste":m=KM;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":m=f2}var b=(t&4)!==0,k=!b&&e==="scroll",x=b?p!==null?p+"Capture":null:p;b=[];for(var y=u,w;y!==null;){w=y;var _=w.stateNode;if(w.tag===5&&_!==null&&(w=_,x!==null&&(_=ef(y,x),_!=null&&b.push(lf(y,_,w)))),k)break;y=y.return}0<b.length&&(p=new m(p,v,null,r,f),d.push({event:p,listeners:b}))}}if(!(t&7)){e:{if(p=e==="mouseover"||e==="pointerover",m=e==="mouseout"||e==="pointerout",p&&r!==dy&&(v=r.relatedTarget||r.fromElement)&&(Ds(v)||v[bo]))break e;if((m||p)&&(p=f.window===f?f:(p=f.ownerDocument)?p.defaultView||p.parentWindow:window,m?(v=r.relatedTarget||r.toElement,m=u,v=v?Ds(v):null,v!==null&&(k=yl(v),v!==k||v.tag!==5&&v.tag!==6)&&(v=null)):(m=null,v=u),m!==v)){if(b=c2,_="onMouseLeave",x="onMouseEnter",y="mouse",(e==="pointerout"||e==="pointerover")&&(b=f2,_="onPointerLeave",x="onPointerEnter",y="pointer"),k=m==null?p:Fl(m),w=v==null?p:Fl(v),p=new b(_,y+"leave",m,r,f),p.target=k,p.relatedTarget=w,_=null,Ds(f)===u&&(b=new b(x,y+"enter",v,r,f),b.target=w,b.relatedTarget=k,_=b),k=_,m&&v)t:{for(b=m,x=v,y=0,w=b;w;w=Nl(w))y++;for(w=0,_=x;_;_=Nl(_))w++;for(;0<y-w;)b=Nl(b),y--;for(;0<w-y;)x=Nl(x),w--;for(;y--;){if(b===x||x!==null&&b===x.alternate)break t;b=Nl(b),x=Nl(x)}b=null}else b=null;m!==null&&k2(d,p,m,b,!1),v!==null&&k!==null&&k2(d,k,v,b,!0)}}e:{if(p=u?Fl(u):window,m=p.nodeName&&p.nodeName.toLowerCase(),m==="select"||m==="input"&&p.type==="file")var S=gO;else if(p2(p))if(b4)S=xO;else{S=yO;var j=mO}else(m=p.nodeName)&&m.toLowerCase()==="input"&&(p.type==="checkbox"||p.type==="radio")&&(S=vO);if(S&&(S=S(e,u))){x4(d,S,r,f);break e}j&&j(e,p,u),e==="focusout"&&(j=p._wrapperState)&&j.controlled&&p.type==="number"&&sy(p,"number",p.value)}switch(j=u?Fl(u):window,e){case"focusin":(p2(j)||j.contentEditable==="true")&&(Ll=j,xy=u,Bu=null);break;case"focusout":Bu=xy=Ll=null;break;case"mousedown":by=!0;break;case"contextmenu":case"mouseup":case"dragend":by=!1,x2(d,r,f);break;case"selectionchange":if(kO)break;case"keydown":case"keyup":x2(d,r,f)}var M;if(Kx)e:{switch(e){case"compositionstart":var A="onCompositionStart";break e;case"compositionend":A="onCompositionEnd";break e;case"compositionupdate":A="onCompositionUpdate";break e}A=void 0}else Il?y4(e,r)&&(A="onCompositionEnd"):e==="keydown"&&r.keyCode===229&&(A="onCompositionStart");A&&(m4&&r.locale!=="ko"&&(Il||A!=="onCompositionStart"?A==="onCompositionEnd"&&Il&&(M=g4()):(Go=f,Vx="value"in Go?Go.value:Go.textContent,Il=!0)),j=A0(u,A),0<j.length&&(A=new u2(A,e,null,r,f),d.push({event:A,listeners:j}),M?A.data=M:(M=v4(r),M!==null&&(A.data=M)))),(M=uO?fO(e,r):dO(e,r))&&(u=A0(u,"onBeforeInput"),0<u.length&&(f=new u2("onBeforeInput","beforeinput",null,r,f),d.push({event:f,listeners:u}),f.data=M))}O4(d,t)})}function lf(e,t,r){return{instance:e,listener:t,currentTarget:r}}function A0(e,t){for(var r=t+"Capture",n=[];e!==null;){var a=e,i=a.stateNode;a.tag===5&&i!==null&&(a=i,i=ef(e,r),i!=null&&n.unshift(lf(e,i,a)),i=ef(e,t),i!=null&&n.push(lf(e,i,a))),e=e.return}return n}function Nl(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function k2(e,t,r,n,a){for(var i=t._reactName,o=[];r!==null&&r!==n;){var s=r,l=s.alternate,u=s.stateNode;if(l!==null&&l===n)break;s.tag===5&&u!==null&&(s=u,a?(l=ef(r,i),l!=null&&o.unshift(lf(r,l,s))):a||(l=ef(r,i),l!=null&&o.push(lf(r,l,s)))),r=r.return}o.length!==0&&e.push({event:t,listeners:o})}var PO=/\r\n?/g,CO=/\u0000|\uFFFD/g;function S2(e){return(typeof e=="string"?e:""+e).replace(PO,`
`).replace(CO,"")}function Ed(e,t,r){if(t=S2(t),S2(e)!==t&&r)throw Error(Te(425))}function T0(){}var wy=null,ky=null;function Sy(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var jy=typeof setTimeout=="function"?setTimeout:void 0,NO=typeof clearTimeout=="function"?clearTimeout:void 0,j2=typeof Promise=="function"?Promise:void 0,MO=typeof queueMicrotask=="function"?queueMicrotask:typeof j2<"u"?function(e){return j2.resolve(null).then(e).catch(OO)}:jy;function OO(e){setTimeout(function(){throw e})}function em(e,t){var r=t,n=0;do{var a=r.nextSibling;if(e.removeChild(r),a&&a.nodeType===8)if(r=a.data,r==="/$"){if(n===0){e.removeChild(a),nf(t);return}n--}else r!=="$"&&r!=="$?"&&r!=="$!"||n++;r=a}while(r);nf(t)}function ts(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?")break;if(t==="/$")return null}}return e}function _2(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="$"||r==="$!"||r==="$?"){if(t===0)return e;t--}else r==="/$"&&t++}e=e.previousSibling}return null}var zc=Math.random().toString(36).slice(2),Fi="__reactFiber$"+zc,cf="__reactProps$"+zc,bo="__reactContainer$"+zc,_y="__reactEvents$"+zc,AO="__reactListeners$"+zc,TO="__reactHandles$"+zc;function Ds(e){var t=e[Fi];if(t)return t;for(var r=e.parentNode;r;){if(t=r[bo]||r[Fi]){if(r=t.alternate,t.child!==null||r!==null&&r.child!==null)for(e=_2(e);e!==null;){if(r=e[Fi])return r;e=_2(e)}return t}e=r,r=e.parentNode}return null}function nd(e){return e=e[Fi]||e[bo],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function Fl(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(Te(33))}function lp(e){return e[cf]||null}var Py=[],Ul=-1;function ds(e){return{current:e}}function en(e){0>Ul||(e.current=Py[Ul],Py[Ul]=null,Ul--)}function Wr(e,t){Ul++,Py[Ul]=e.current,e.current=t}var us={},ga=ds(us),Ta=ds(!1),Js=us;function sc(e,t){var r=e.type.contextTypes;if(!r)return us;var n=e.stateNode;if(n&&n.__reactInternalMemoizedUnmaskedChildContext===t)return n.__reactInternalMemoizedMaskedChildContext;var a={},i;for(i in r)a[i]=t[i];return n&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=a),a}function Ea(e){return e=e.childContextTypes,e!=null}function E0(){en(Ta),en(ga)}function P2(e,t,r){if(ga.current!==us)throw Error(Te(168));Wr(ga,t),Wr(Ta,r)}function T4(e,t,r){var n=e.stateNode;if(t=t.childContextTypes,typeof n.getChildContext!="function")return r;n=n.getChildContext();for(var a in n)if(!(a in t))throw Error(Te(108,mM(e)||"Unknown",a));return dn({},r,n)}function $0(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||us,Js=ga.current,Wr(ga,e),Wr(Ta,Ta.current),!0}function C2(e,t,r){var n=e.stateNode;if(!n)throw Error(Te(169));r?(e=T4(e,t,Js),n.__reactInternalMemoizedMergedChildContext=e,en(Ta),en(ga),Wr(ga,e)):en(Ta),Wr(Ta,r)}var lo=null,cp=!1,tm=!1;function E4(e){lo===null?lo=[e]:lo.push(e)}function EO(e){cp=!0,E4(e)}function hs(){if(!tm&&lo!==null){tm=!0;var e=0,t=Mr;try{var r=lo;for(Mr=1;e<r.length;e++){var n=r[e];do n=n(!0);while(n!==null)}lo=null,cp=!1}catch(a){throw lo!==null&&(lo=lo.slice(e+1)),a4(Ux,hs),a}finally{Mr=t,tm=!1}}return null}var Gl=[],zl=0,R0=null,D0=0,ai=[],ii=0,el=null,co=1,uo="";function As(e,t){Gl[zl++]=D0,Gl[zl++]=R0,R0=e,D0=t}function $4(e,t,r){ai[ii++]=co,ai[ii++]=uo,ai[ii++]=el,el=e;var n=co;e=uo;var a=32-Mi(n)-1;n&=~(1<<a),r+=1;var i=32-Mi(t)+a;if(30<i){var o=a-a%5;i=(n&(1<<o)-1).toString(32),n>>=o,a-=o,co=1<<32-Mi(t)+a|r<<a|n,uo=i+e}else co=1<<i|r<<a|n,uo=e}function Yx(e){e.return!==null&&(As(e,1),$4(e,1,0))}function Zx(e){for(;e===R0;)R0=Gl[--zl],Gl[zl]=null,D0=Gl[--zl],Gl[zl]=null;for(;e===el;)el=ai[--ii],ai[ii]=null,uo=ai[--ii],ai[ii]=null,co=ai[--ii],ai[ii]=null}var Va=null,Wa=null,an=!1,ji=null;function R4(e,t){var r=oi(5,null,null,0);r.elementType="DELETED",r.stateNode=t,r.return=e,t=e.deletions,t===null?(e.deletions=[r],e.flags|=16):t.push(r)}function N2(e,t){switch(e.tag){case 5:var r=e.type;return t=t.nodeType!==1||r.toLowerCase()!==t.nodeName.toLowerCase()?null:t,t!==null?(e.stateNode=t,Va=e,Wa=ts(t.firstChild),!0):!1;case 6:return t=e.pendingProps===""||t.nodeType!==3?null:t,t!==null?(e.stateNode=t,Va=e,Wa=null,!0):!1;case 13:return t=t.nodeType!==8?null:t,t!==null?(r=el!==null?{id:co,overflow:uo}:null,e.memoizedState={dehydrated:t,treeContext:r,retryLane:1073741824},r=oi(18,null,null,0),r.stateNode=t,r.return=e,e.child=r,Va=e,Wa=null,!0):!1;default:return!1}}function Cy(e){return(e.mode&1)!==0&&(e.flags&128)===0}function Ny(e){if(an){var t=Wa;if(t){var r=t;if(!N2(e,t)){if(Cy(e))throw Error(Te(418));t=ts(r.nextSibling);var n=Va;t&&N2(e,t)?R4(n,r):(e.flags=e.flags&-4097|2,an=!1,Va=e)}}else{if(Cy(e))throw Error(Te(418));e.flags=e.flags&-4097|2,an=!1,Va=e}}}function M2(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;Va=e}function $d(e){if(e!==Va)return!1;if(!an)return M2(e),an=!0,!1;var t;if((t=e.tag!==3)&&!(t=e.tag!==5)&&(t=e.type,t=t!=="head"&&t!=="body"&&!Sy(e.type,e.memoizedProps)),t&&(t=Wa)){if(Cy(e))throw D4(),Error(Te(418));for(;t;)R4(e,t),t=ts(t.nextSibling)}if(M2(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(Te(317));e:{for(e=e.nextSibling,t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="/$"){if(t===0){Wa=ts(e.nextSibling);break e}t--}else r!=="$"&&r!=="$!"&&r!=="$?"||t++}e=e.nextSibling}Wa=null}}else Wa=Va?ts(e.stateNode.nextSibling):null;return!0}function D4(){for(var e=Wa;e;)e=ts(e.nextSibling)}function lc(){Wa=Va=null,an=!1}function Qx(e){ji===null?ji=[e]:ji.push(e)}var $O=Po.ReactCurrentBatchConfig;function gu(e,t,r){if(e=r.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(r._owner){if(r=r._owner,r){if(r.tag!==1)throw Error(Te(309));var n=r.stateNode}if(!n)throw Error(Te(147,e));var a=n,i=""+e;return t!==null&&t.ref!==null&&typeof t.ref=="function"&&t.ref._stringRef===i?t.ref:(t=function(o){var s=a.refs;o===null?delete s[i]:s[i]=o},t._stringRef=i,t)}if(typeof e!="string")throw Error(Te(284));if(!r._owner)throw Error(Te(290,e))}return e}function Rd(e,t){throw e=Object.prototype.toString.call(t),Error(Te(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function O2(e){var t=e._init;return t(e._payload)}function I4(e){function t(x,y){if(e){var w=x.deletions;w===null?(x.deletions=[y],x.flags|=16):w.push(y)}}function r(x,y){if(!e)return null;for(;y!==null;)t(x,y),y=y.sibling;return null}function n(x,y){for(x=new Map;y!==null;)y.key!==null?x.set(y.key,y):x.set(y.index,y),y=y.sibling;return x}function a(x,y){return x=is(x,y),x.index=0,x.sibling=null,x}function i(x,y,w){return x.index=w,e?(w=x.alternate,w!==null?(w=w.index,w<y?(x.flags|=2,y):w):(x.flags|=2,y)):(x.flags|=1048576,y)}function o(x){return e&&x.alternate===null&&(x.flags|=2),x}function s(x,y,w,_){return y===null||y.tag!==6?(y=lm(w,x.mode,_),y.return=x,y):(y=a(y,w),y.return=x,y)}function l(x,y,w,_){var S=w.type;return S===Dl?f(x,y,w.props.children,_,w.key):y!==null&&(y.elementType===S||typeof S=="object"&&S!==null&&S.$$typeof===Do&&O2(S)===y.type)?(_=a(y,w.props),_.ref=gu(x,y,w),_.return=x,_):(_=b0(w.type,w.key,w.props,null,x.mode,_),_.ref=gu(x,y,w),_.return=x,_)}function u(x,y,w,_){return y===null||y.tag!==4||y.stateNode.containerInfo!==w.containerInfo||y.stateNode.implementation!==w.implementation?(y=cm(w,x.mode,_),y.return=x,y):(y=a(y,w.children||[]),y.return=x,y)}function f(x,y,w,_,S){return y===null||y.tag!==7?(y=qs(w,x.mode,_,S),y.return=x,y):(y=a(y,w),y.return=x,y)}function d(x,y,w){if(typeof y=="string"&&y!==""||typeof y=="number")return y=lm(""+y,x.mode,w),y.return=x,y;if(typeof y=="object"&&y!==null){switch(y.$$typeof){case jd:return w=b0(y.type,y.key,y.props,null,x.mode,w),w.ref=gu(x,null,y),w.return=x,w;case Rl:return y=cm(y,x.mode,w),y.return=x,y;case Do:var _=y._init;return d(x,_(y._payload),w)}if(Au(y)||uu(y))return y=qs(y,x.mode,w,null),y.return=x,y;Rd(x,y)}return null}function p(x,y,w,_){var S=y!==null?y.key:null;if(typeof w=="string"&&w!==""||typeof w=="number")return S!==null?null:s(x,y,""+w,_);if(typeof w=="object"&&w!==null){switch(w.$$typeof){case jd:return w.key===S?l(x,y,w,_):null;case Rl:return w.key===S?u(x,y,w,_):null;case Do:return S=w._init,p(x,y,S(w._payload),_)}if(Au(w)||uu(w))return S!==null?null:f(x,y,w,_,null);Rd(x,w)}return null}function m(x,y,w,_,S){if(typeof _=="string"&&_!==""||typeof _=="number")return x=x.get(w)||null,s(y,x,""+_,S);if(typeof _=="object"&&_!==null){switch(_.$$typeof){case jd:return x=x.get(_.key===null?w:_.key)||null,l(y,x,_,S);case Rl:return x=x.get(_.key===null?w:_.key)||null,u(y,x,_,S);case Do:var j=_._init;return m(x,y,w,j(_._payload),S)}if(Au(_)||uu(_))return x=x.get(w)||null,f(y,x,_,S,null);Rd(y,_)}return null}function v(x,y,w,_){for(var S=null,j=null,M=y,A=y=0,$=null;M!==null&&A<w.length;A++){M.index>A?($=M,M=null):$=M.sibling;var E=p(x,M,w[A],_);if(E===null){M===null&&(M=$);break}e&&M&&E.alternate===null&&t(x,M),y=i(E,y,A),j===null?S=E:j.sibling=E,j=E,M=$}if(A===w.length)return r(x,M),an&&As(x,A),S;if(M===null){for(;A<w.length;A++)M=d(x,w[A],_),M!==null&&(y=i(M,y,A),j===null?S=M:j.sibling=M,j=M);return an&&As(x,A),S}for(M=n(x,M);A<w.length;A++)$=m(M,x,A,w[A],_),$!==null&&(e&&$.alternate!==null&&M.delete($.key===null?A:$.key),y=i($,y,A),j===null?S=$:j.sibling=$,j=$);return e&&M.forEach(function(T){return t(x,T)}),an&&As(x,A),S}function b(x,y,w,_){var S=uu(w);if(typeof S!="function")throw Error(Te(150));if(w=S.call(w),w==null)throw Error(Te(151));for(var j=S=null,M=y,A=y=0,$=null,E=w.next();M!==null&&!E.done;A++,E=w.next()){M.index>A?($=M,M=null):$=M.sibling;var T=p(x,M,E.value,_);if(T===null){M===null&&(M=$);break}e&&M&&T.alternate===null&&t(x,M),y=i(T,y,A),j===null?S=T:j.sibling=T,j=T,M=$}if(E.done)return r(x,M),an&&As(x,A),S;if(M===null){for(;!E.done;A++,E=w.next())E=d(x,E.value,_),E!==null&&(y=i(E,y,A),j===null?S=E:j.sibling=E,j=E);return an&&As(x,A),S}for(M=n(x,M);!E.done;A++,E=w.next())E=m(M,x,A,E.value,_),E!==null&&(e&&E.alternate!==null&&M.delete(E.key===null?A:E.key),y=i(E,y,A),j===null?S=E:j.sibling=E,j=E);return e&&M.forEach(function(B){return t(x,B)}),an&&As(x,A),S}function k(x,y,w,_){if(typeof w=="object"&&w!==null&&w.type===Dl&&w.key===null&&(w=w.props.children),typeof w=="object"&&w!==null){switch(w.$$typeof){case jd:e:{for(var S=w.key,j=y;j!==null;){if(j.key===S){if(S=w.type,S===Dl){if(j.tag===7){r(x,j.sibling),y=a(j,w.props.children),y.return=x,x=y;break e}}else if(j.elementType===S||typeof S=="object"&&S!==null&&S.$$typeof===Do&&O2(S)===j.type){r(x,j.sibling),y=a(j,w.props),y.ref=gu(x,j,w),y.return=x,x=y;break e}r(x,j);break}else t(x,j);j=j.sibling}w.type===Dl?(y=qs(w.props.children,x.mode,_,w.key),y.return=x,x=y):(_=b0(w.type,w.key,w.props,null,x.mode,_),_.ref=gu(x,y,w),_.return=x,x=_)}return o(x);case Rl:e:{for(j=w.key;y!==null;){if(y.key===j)if(y.tag===4&&y.stateNode.containerInfo===w.containerInfo&&y.stateNode.implementation===w.implementation){r(x,y.sibling),y=a(y,w.children||[]),y.return=x,x=y;break e}else{r(x,y);break}else t(x,y);y=y.sibling}y=cm(w,x.mode,_),y.return=x,x=y}return o(x);case Do:return j=w._init,k(x,y,j(w._payload),_)}if(Au(w))return v(x,y,w,_);if(uu(w))return b(x,y,w,_);Rd(x,w)}return typeof w=="string"&&w!==""||typeof w=="number"?(w=""+w,y!==null&&y.tag===6?(r(x,y.sibling),y=a(y,w),y.return=x,x=y):(r(x,y),y=lm(w,x.mode,_),y.return=x,x=y),o(x)):r(x,y)}return k}var cc=I4(!0),L4=I4(!1),I0=ds(null),L0=null,Wl=null,Jx=null;function e1(){Jx=Wl=L0=null}function t1(e){var t=I0.current;en(I0),e._currentValue=t}function My(e,t,r){for(;e!==null;){var n=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,n!==null&&(n.childLanes|=t)):n!==null&&(n.childLanes&t)!==t&&(n.childLanes|=t),e===r)break;e=e.return}}function ec(e,t){L0=e,Jx=Wl=null,e=e.dependencies,e!==null&&e.firstContext!==null&&(e.lanes&t&&(Oa=!0),e.firstContext=null)}function fi(e){var t=e._currentValue;if(Jx!==e)if(e={context:e,memoizedValue:t,next:null},Wl===null){if(L0===null)throw Error(Te(308));Wl=e,L0.dependencies={lanes:0,firstContext:e}}else Wl=Wl.next=e;return t}var Is=null;function r1(e){Is===null?Is=[e]:Is.push(e)}function B4(e,t,r,n){var a=t.interleaved;return a===null?(r.next=r,r1(t)):(r.next=a.next,a.next=r),t.interleaved=r,wo(e,n)}function wo(e,t){e.lanes|=t;var r=e.alternate;for(r!==null&&(r.lanes|=t),r=e,e=e.return;e!==null;)e.childLanes|=t,r=e.alternate,r!==null&&(r.childLanes|=t),r=e,e=e.return;return r.tag===3?r.stateNode:null}var Io=!1;function n1(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function F4(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function go(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function rs(e,t,r){var n=e.updateQueue;if(n===null)return null;if(n=n.shared,gr&2){var a=n.pending;return a===null?t.next=t:(t.next=a.next,a.next=t),n.pending=t,wo(e,r)}return a=n.interleaved,a===null?(t.next=t,r1(n)):(t.next=a.next,a.next=t),n.interleaved=t,wo(e,r)}function p0(e,t,r){if(t=t.updateQueue,t!==null&&(t=t.shared,(r&4194240)!==0)){var n=t.lanes;n&=e.pendingLanes,r|=n,t.lanes=r,Gx(e,r)}}function A2(e,t){var r=e.updateQueue,n=e.alternate;if(n!==null&&(n=n.updateQueue,r===n)){var a=null,i=null;if(r=r.firstBaseUpdate,r!==null){do{var o={eventTime:r.eventTime,lane:r.lane,tag:r.tag,payload:r.payload,callback:r.callback,next:null};i===null?a=i=o:i=i.next=o,r=r.next}while(r!==null);i===null?a=i=t:i=i.next=t}else a=i=t;r={baseState:n.baseState,firstBaseUpdate:a,lastBaseUpdate:i,shared:n.shared,effects:n.effects},e.updateQueue=r;return}e=r.lastBaseUpdate,e===null?r.firstBaseUpdate=t:e.next=t,r.lastBaseUpdate=t}function B0(e,t,r,n){var a=e.updateQueue;Io=!1;var i=a.firstBaseUpdate,o=a.lastBaseUpdate,s=a.shared.pending;if(s!==null){a.shared.pending=null;var l=s,u=l.next;l.next=null,o===null?i=u:o.next=u,o=l;var f=e.alternate;f!==null&&(f=f.updateQueue,s=f.lastBaseUpdate,s!==o&&(s===null?f.firstBaseUpdate=u:s.next=u,f.lastBaseUpdate=l))}if(i!==null){var d=a.baseState;o=0,f=u=l=null,s=i;do{var p=s.lane,m=s.eventTime;if((n&p)===p){f!==null&&(f=f.next={eventTime:m,lane:0,tag:s.tag,payload:s.payload,callback:s.callback,next:null});e:{var v=e,b=s;switch(p=t,m=r,b.tag){case 1:if(v=b.payload,typeof v=="function"){d=v.call(m,d,p);break e}d=v;break e;case 3:v.flags=v.flags&-65537|128;case 0:if(v=b.payload,p=typeof v=="function"?v.call(m,d,p):v,p==null)break e;d=dn({},d,p);break e;case 2:Io=!0}}s.callback!==null&&s.lane!==0&&(e.flags|=64,p=a.effects,p===null?a.effects=[s]:p.push(s))}else m={eventTime:m,lane:p,tag:s.tag,payload:s.payload,callback:s.callback,next:null},f===null?(u=f=m,l=d):f=f.next=m,o|=p;if(s=s.next,s===null){if(s=a.shared.pending,s===null)break;p=s,s=p.next,p.next=null,a.lastBaseUpdate=p,a.shared.pending=null}}while(!0);if(f===null&&(l=d),a.baseState=l,a.firstBaseUpdate=u,a.lastBaseUpdate=f,t=a.shared.interleaved,t!==null){a=t;do o|=a.lane,a=a.next;while(a!==t)}else i===null&&(a.shared.lanes=0);rl|=o,e.lanes=o,e.memoizedState=d}}function T2(e,t,r){if(e=t.effects,t.effects=null,e!==null)for(t=0;t<e.length;t++){var n=e[t],a=n.callback;if(a!==null){if(n.callback=null,n=r,typeof a!="function")throw Error(Te(191,a));a.call(n)}}}var ad={},Vi=ds(ad),uf=ds(ad),ff=ds(ad);function Ls(e){if(e===ad)throw Error(Te(174));return e}function a1(e,t){switch(Wr(ff,t),Wr(uf,e),Wr(Vi,ad),e=t.nodeType,e){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:cy(null,"");break;default:e=e===8?t.parentNode:t,t=e.namespaceURI||null,e=e.tagName,t=cy(t,e)}en(Vi),Wr(Vi,t)}function uc(){en(Vi),en(uf),en(ff)}function U4(e){Ls(ff.current);var t=Ls(Vi.current),r=cy(t,e.type);t!==r&&(Wr(uf,e),Wr(Vi,r))}function i1(e){uf.current===e&&(en(Vi),en(uf))}var un=ds(0);function F0(e){for(var t=e;t!==null;){if(t.tag===13){var r=t.memoizedState;if(r!==null&&(r=r.dehydrated,r===null||r.data==="$?"||r.data==="$!"))return t}else if(t.tag===19&&t.memoizedProps.revealOrder!==void 0){if(t.flags&128)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var rm=[];function o1(){for(var e=0;e<rm.length;e++)rm[e]._workInProgressVersionPrimary=null;rm.length=0}var g0=Po.ReactCurrentDispatcher,nm=Po.ReactCurrentBatchConfig,tl=0,fn=null,Fn=null,Xn=null,U0=!1,Fu=!1,df=0,RO=0;function ua(){throw Error(Te(321))}function s1(e,t){if(t===null)return!1;for(var r=0;r<t.length&&r<e.length;r++)if(!Ai(e[r],t[r]))return!1;return!0}function l1(e,t,r,n,a,i){if(tl=i,fn=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,g0.current=e===null||e.memoizedState===null?BO:FO,e=r(n,a),Fu){i=0;do{if(Fu=!1,df=0,25<=i)throw Error(Te(301));i+=1,Xn=Fn=null,t.updateQueue=null,g0.current=UO,e=r(n,a)}while(Fu)}if(g0.current=G0,t=Fn!==null&&Fn.next!==null,tl=0,Xn=Fn=fn=null,U0=!1,t)throw Error(Te(300));return e}function c1(){var e=df!==0;return df=0,e}function Bi(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Xn===null?fn.memoizedState=Xn=e:Xn=Xn.next=e,Xn}function di(){if(Fn===null){var e=fn.alternate;e=e!==null?e.memoizedState:null}else e=Fn.next;var t=Xn===null?fn.memoizedState:Xn.next;if(t!==null)Xn=t,Fn=e;else{if(e===null)throw Error(Te(310));Fn=e,e={memoizedState:Fn.memoizedState,baseState:Fn.baseState,baseQueue:Fn.baseQueue,queue:Fn.queue,next:null},Xn===null?fn.memoizedState=Xn=e:Xn=Xn.next=e}return Xn}function hf(e,t){return typeof t=="function"?t(e):t}function am(e){var t=di(),r=t.queue;if(r===null)throw Error(Te(311));r.lastRenderedReducer=e;var n=Fn,a=n.baseQueue,i=r.pending;if(i!==null){if(a!==null){var o=a.next;a.next=i.next,i.next=o}n.baseQueue=a=i,r.pending=null}if(a!==null){i=a.next,n=n.baseState;var s=o=null,l=null,u=i;do{var f=u.lane;if((tl&f)===f)l!==null&&(l=l.next={lane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),n=u.hasEagerState?u.eagerState:e(n,u.action);else{var d={lane:f,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null};l===null?(s=l=d,o=n):l=l.next=d,fn.lanes|=f,rl|=f}u=u.next}while(u!==null&&u!==i);l===null?o=n:l.next=s,Ai(n,t.memoizedState)||(Oa=!0),t.memoizedState=n,t.baseState=o,t.baseQueue=l,r.lastRenderedState=n}if(e=r.interleaved,e!==null){a=e;do i=a.lane,fn.lanes|=i,rl|=i,a=a.next;while(a!==e)}else a===null&&(r.lanes=0);return[t.memoizedState,r.dispatch]}function im(e){var t=di(),r=t.queue;if(r===null)throw Error(Te(311));r.lastRenderedReducer=e;var n=r.dispatch,a=r.pending,i=t.memoizedState;if(a!==null){r.pending=null;var o=a=a.next;do i=e(i,o.action),o=o.next;while(o!==a);Ai(i,t.memoizedState)||(Oa=!0),t.memoizedState=i,t.baseQueue===null&&(t.baseState=i),r.lastRenderedState=i}return[i,n]}function G4(){}function z4(e,t){var r=fn,n=di(),a=t(),i=!Ai(n.memoizedState,a);if(i&&(n.memoizedState=a,Oa=!0),n=n.queue,u1(H4.bind(null,r,n,e),[e]),n.getSnapshot!==t||i||Xn!==null&&Xn.memoizedState.tag&1){if(r.flags|=2048,pf(9,V4.bind(null,r,n,a,t),void 0,null),Kn===null)throw Error(Te(349));tl&30||W4(r,t,a)}return a}function W4(e,t,r){e.flags|=16384,e={getSnapshot:t,value:r},t=fn.updateQueue,t===null?(t={lastEffect:null,stores:null},fn.updateQueue=t,t.stores=[e]):(r=t.stores,r===null?t.stores=[e]:r.push(e))}function V4(e,t,r,n){t.value=r,t.getSnapshot=n,X4(t)&&K4(e)}function H4(e,t,r){return r(function(){X4(t)&&K4(e)})}function X4(e){var t=e.getSnapshot;e=e.value;try{var r=t();return!Ai(e,r)}catch{return!0}}function K4(e){var t=wo(e,1);t!==null&&Oi(t,e,1,-1)}function E2(e){var t=Bi();return typeof e=="function"&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:hf,lastRenderedState:e},t.queue=e,e=e.dispatch=LO.bind(null,fn,e),[t.memoizedState,e]}function pf(e,t,r,n){return e={tag:e,create:t,destroy:r,deps:n,next:null},t=fn.updateQueue,t===null?(t={lastEffect:null,stores:null},fn.updateQueue=t,t.lastEffect=e.next=e):(r=t.lastEffect,r===null?t.lastEffect=e.next=e:(n=r.next,r.next=e,e.next=n,t.lastEffect=e)),e}function q4(){return di().memoizedState}function m0(e,t,r,n){var a=Bi();fn.flags|=e,a.memoizedState=pf(1|t,r,void 0,n===void 0?null:n)}function up(e,t,r,n){var a=di();n=n===void 0?null:n;var i=void 0;if(Fn!==null){var o=Fn.memoizedState;if(i=o.destroy,n!==null&&s1(n,o.deps)){a.memoizedState=pf(t,r,i,n);return}}fn.flags|=e,a.memoizedState=pf(1|t,r,i,n)}function $2(e,t){return m0(8390656,8,e,t)}function u1(e,t){return up(2048,8,e,t)}function Y4(e,t){return up(4,2,e,t)}function Z4(e,t){return up(4,4,e,t)}function Q4(e,t){if(typeof t=="function")return e=e(),t(e),function(){t(null)};if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function J4(e,t,r){return r=r!=null?r.concat([e]):null,up(4,4,Q4.bind(null,t,e),r)}function f1(){}function ej(e,t){var r=di();t=t===void 0?null:t;var n=r.memoizedState;return n!==null&&t!==null&&s1(t,n[1])?n[0]:(r.memoizedState=[e,t],e)}function tj(e,t){var r=di();t=t===void 0?null:t;var n=r.memoizedState;return n!==null&&t!==null&&s1(t,n[1])?n[0]:(e=e(),r.memoizedState=[e,t],e)}function rj(e,t,r){return tl&21?(Ai(r,t)||(r=s4(),fn.lanes|=r,rl|=r,e.baseState=!0),t):(e.baseState&&(e.baseState=!1,Oa=!0),e.memoizedState=r)}function DO(e,t){var r=Mr;Mr=r!==0&&4>r?r:4,e(!0);var n=nm.transition;nm.transition={};try{e(!1),t()}finally{Mr=r,nm.transition=n}}function nj(){return di().memoizedState}function IO(e,t,r){var n=as(e);if(r={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null},aj(e))ij(t,r);else if(r=B4(e,t,r,n),r!==null){var a=ja();Oi(r,e,n,a),oj(r,t,n)}}function LO(e,t,r){var n=as(e),a={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null};if(aj(e))ij(t,a);else{var i=e.alternate;if(e.lanes===0&&(i===null||i.lanes===0)&&(i=t.lastRenderedReducer,i!==null))try{var o=t.lastRenderedState,s=i(o,r);if(a.hasEagerState=!0,a.eagerState=s,Ai(s,o)){var l=t.interleaved;l===null?(a.next=a,r1(t)):(a.next=l.next,l.next=a),t.interleaved=a;return}}catch{}finally{}r=B4(e,t,a,n),r!==null&&(a=ja(),Oi(r,e,n,a),oj(r,t,n))}}function aj(e){var t=e.alternate;return e===fn||t!==null&&t===fn}function ij(e,t){Fu=U0=!0;var r=e.pending;r===null?t.next=t:(t.next=r.next,r.next=t),e.pending=t}function oj(e,t,r){if(r&4194240){var n=t.lanes;n&=e.pendingLanes,r|=n,t.lanes=r,Gx(e,r)}}var G0={readContext:fi,useCallback:ua,useContext:ua,useEffect:ua,useImperativeHandle:ua,useInsertionEffect:ua,useLayoutEffect:ua,useMemo:ua,useReducer:ua,useRef:ua,useState:ua,useDebugValue:ua,useDeferredValue:ua,useTransition:ua,useMutableSource:ua,useSyncExternalStore:ua,useId:ua,unstable_isNewReconciler:!1},BO={readContext:fi,useCallback:function(e,t){return Bi().memoizedState=[e,t===void 0?null:t],e},useContext:fi,useEffect:$2,useImperativeHandle:function(e,t,r){return r=r!=null?r.concat([e]):null,m0(4194308,4,Q4.bind(null,t,e),r)},useLayoutEffect:function(e,t){return m0(4194308,4,e,t)},useInsertionEffect:function(e,t){return m0(4,2,e,t)},useMemo:function(e,t){var r=Bi();return t=t===void 0?null:t,e=e(),r.memoizedState=[e,t],e},useReducer:function(e,t,r){var n=Bi();return t=r!==void 0?r(t):t,n.memoizedState=n.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},n.queue=e,e=e.dispatch=IO.bind(null,fn,e),[n.memoizedState,e]},useRef:function(e){var t=Bi();return e={current:e},t.memoizedState=e},useState:E2,useDebugValue:f1,useDeferredValue:function(e){return Bi().memoizedState=e},useTransition:function(){var e=E2(!1),t=e[0];return e=DO.bind(null,e[1]),Bi().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,r){var n=fn,a=Bi();if(an){if(r===void 0)throw Error(Te(407));r=r()}else{if(r=t(),Kn===null)throw Error(Te(349));tl&30||W4(n,t,r)}a.memoizedState=r;var i={value:r,getSnapshot:t};return a.queue=i,$2(H4.bind(null,n,i,e),[e]),n.flags|=2048,pf(9,V4.bind(null,n,i,r,t),void 0,null),r},useId:function(){var e=Bi(),t=Kn.identifierPrefix;if(an){var r=uo,n=co;r=(n&~(1<<32-Mi(n)-1)).toString(32)+r,t=":"+t+"R"+r,r=df++,0<r&&(t+="H"+r.toString(32)),t+=":"}else r=RO++,t=":"+t+"r"+r.toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},FO={readContext:fi,useCallback:ej,useContext:fi,useEffect:u1,useImperativeHandle:J4,useInsertionEffect:Y4,useLayoutEffect:Z4,useMemo:tj,useReducer:am,useRef:q4,useState:function(){return am(hf)},useDebugValue:f1,useDeferredValue:function(e){var t=di();return rj(t,Fn.memoizedState,e)},useTransition:function(){var e=am(hf)[0],t=di().memoizedState;return[e,t]},useMutableSource:G4,useSyncExternalStore:z4,useId:nj,unstable_isNewReconciler:!1},UO={readContext:fi,useCallback:ej,useContext:fi,useEffect:u1,useImperativeHandle:J4,useInsertionEffect:Y4,useLayoutEffect:Z4,useMemo:tj,useReducer:im,useRef:q4,useState:function(){return im(hf)},useDebugValue:f1,useDeferredValue:function(e){var t=di();return Fn===null?t.memoizedState=e:rj(t,Fn.memoizedState,e)},useTransition:function(){var e=im(hf)[0],t=di().memoizedState;return[e,t]},useMutableSource:G4,useSyncExternalStore:z4,useId:nj,unstable_isNewReconciler:!1};function bi(e,t){if(e&&e.defaultProps){t=dn({},t),e=e.defaultProps;for(var r in e)t[r]===void 0&&(t[r]=e[r]);return t}return t}function Oy(e,t,r,n){t=e.memoizedState,r=r(n,t),r=r==null?t:dn({},t,r),e.memoizedState=r,e.lanes===0&&(e.updateQueue.baseState=r)}var fp={isMounted:function(e){return(e=e._reactInternals)?yl(e)===e:!1},enqueueSetState:function(e,t,r){e=e._reactInternals;var n=ja(),a=as(e),i=go(n,a);i.payload=t,r!=null&&(i.callback=r),t=rs(e,i,a),t!==null&&(Oi(t,e,a,n),p0(t,e,a))},enqueueReplaceState:function(e,t,r){e=e._reactInternals;var n=ja(),a=as(e),i=go(n,a);i.tag=1,i.payload=t,r!=null&&(i.callback=r),t=rs(e,i,a),t!==null&&(Oi(t,e,a,n),p0(t,e,a))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var r=ja(),n=as(e),a=go(r,n);a.tag=2,t!=null&&(a.callback=t),t=rs(e,a,n),t!==null&&(Oi(t,e,n,r),p0(t,e,n))}};function R2(e,t,r,n,a,i,o){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(n,i,o):t.prototype&&t.prototype.isPureReactComponent?!of(r,n)||!of(a,i):!0}function sj(e,t,r){var n=!1,a=us,i=t.contextType;return typeof i=="object"&&i!==null?i=fi(i):(a=Ea(t)?Js:ga.current,n=t.contextTypes,i=(n=n!=null)?sc(e,a):us),t=new t(r,i),e.memoizedState=t.state!==null&&t.state!==void 0?t.state:null,t.updater=fp,e.stateNode=t,t._reactInternals=e,n&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=a,e.__reactInternalMemoizedMaskedChildContext=i),t}function D2(e,t,r,n){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(r,n),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(r,n),t.state!==e&&fp.enqueueReplaceState(t,t.state,null)}function Ay(e,t,r,n){var a=e.stateNode;a.props=r,a.state=e.memoizedState,a.refs={},n1(e);var i=t.contextType;typeof i=="object"&&i!==null?a.context=fi(i):(i=Ea(t)?Js:ga.current,a.context=sc(e,i)),a.state=e.memoizedState,i=t.getDerivedStateFromProps,typeof i=="function"&&(Oy(e,t,i,r),a.state=e.memoizedState),typeof t.getDerivedStateFromProps=="function"||typeof a.getSnapshotBeforeUpdate=="function"||typeof a.UNSAFE_componentWillMount!="function"&&typeof a.componentWillMount!="function"||(t=a.state,typeof a.componentWillMount=="function"&&a.componentWillMount(),typeof a.UNSAFE_componentWillMount=="function"&&a.UNSAFE_componentWillMount(),t!==a.state&&fp.enqueueReplaceState(a,a.state,null),B0(e,r,a,n),a.state=e.memoizedState),typeof a.componentDidMount=="function"&&(e.flags|=4194308)}function fc(e,t){try{var r="",n=t;do r+=gM(n),n=n.return;while(n);var a=r}catch(i){a=`
Error generating stack: `+i.message+`
`+i.stack}return{value:e,source:t,stack:a,digest:null}}function om(e,t,r){return{value:e,source:null,stack:r??null,digest:t??null}}function Ty(e,t){try{console.error(t.value)}catch(r){setTimeout(function(){throw r})}}var GO=typeof WeakMap=="function"?WeakMap:Map;function lj(e,t,r){r=go(-1,r),r.tag=3,r.payload={element:null};var n=t.value;return r.callback=function(){W0||(W0=!0,Gy=n),Ty(e,t)},r}function cj(e,t,r){r=go(-1,r),r.tag=3;var n=e.type.getDerivedStateFromError;if(typeof n=="function"){var a=t.value;r.payload=function(){return n(a)},r.callback=function(){Ty(e,t)}}var i=e.stateNode;return i!==null&&typeof i.componentDidCatch=="function"&&(r.callback=function(){Ty(e,t),typeof n!="function"&&(ns===null?ns=new Set([this]):ns.add(this));var o=t.stack;this.componentDidCatch(t.value,{componentStack:o!==null?o:""})}),r}function I2(e,t,r){var n=e.pingCache;if(n===null){n=e.pingCache=new GO;var a=new Set;n.set(t,a)}else a=n.get(t),a===void 0&&(a=new Set,n.set(t,a));a.has(r)||(a.add(r),e=r6.bind(null,e,t,r),t.then(e,e))}function L2(e){do{var t;if((t=e.tag===13)&&(t=e.memoizedState,t=t!==null?t.dehydrated!==null:!0),t)return e;e=e.return}while(e!==null);return null}function B2(e,t,r,n,a){return e.mode&1?(e.flags|=65536,e.lanes=a,e):(e===t?e.flags|=65536:(e.flags|=128,r.flags|=131072,r.flags&=-52805,r.tag===1&&(r.alternate===null?r.tag=17:(t=go(-1,1),t.tag=2,rs(r,t,1))),r.lanes|=1),e)}var zO=Po.ReactCurrentOwner,Oa=!1;function ba(e,t,r,n){t.child=e===null?L4(t,null,r,n):cc(t,e.child,r,n)}function F2(e,t,r,n,a){r=r.render;var i=t.ref;return ec(t,a),n=l1(e,t,r,n,i,a),r=c1(),e!==null&&!Oa?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~a,ko(e,t,a)):(an&&r&&Yx(t),t.flags|=1,ba(e,t,n,a),t.child)}function U2(e,t,r,n,a){if(e===null){var i=r.type;return typeof i=="function"&&!x1(i)&&i.defaultProps===void 0&&r.compare===null&&r.defaultProps===void 0?(t.tag=15,t.type=i,uj(e,t,i,n,a)):(e=b0(r.type,null,n,t,t.mode,a),e.ref=t.ref,e.return=t,t.child=e)}if(i=e.child,!(e.lanes&a)){var o=i.memoizedProps;if(r=r.compare,r=r!==null?r:of,r(o,n)&&e.ref===t.ref)return ko(e,t,a)}return t.flags|=1,e=is(i,n),e.ref=t.ref,e.return=t,t.child=e}function uj(e,t,r,n,a){if(e!==null){var i=e.memoizedProps;if(of(i,n)&&e.ref===t.ref)if(Oa=!1,t.pendingProps=n=i,(e.lanes&a)!==0)e.flags&131072&&(Oa=!0);else return t.lanes=e.lanes,ko(e,t,a)}return Ey(e,t,r,n,a)}function fj(e,t,r){var n=t.pendingProps,a=n.children,i=e!==null?e.memoizedState:null;if(n.mode==="hidden")if(!(t.mode&1))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},Wr(Hl,Ua),Ua|=r;else{if(!(r&1073741824))return e=i!==null?i.baseLanes|r:r,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,Wr(Hl,Ua),Ua|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},n=i!==null?i.baseLanes:r,Wr(Hl,Ua),Ua|=n}else i!==null?(n=i.baseLanes|r,t.memoizedState=null):n=r,Wr(Hl,Ua),Ua|=n;return ba(e,t,a,r),t.child}function dj(e,t){var r=t.ref;(e===null&&r!==null||e!==null&&e.ref!==r)&&(t.flags|=512,t.flags|=2097152)}function Ey(e,t,r,n,a){var i=Ea(r)?Js:ga.current;return i=sc(t,i),ec(t,a),r=l1(e,t,r,n,i,a),n=c1(),e!==null&&!Oa?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~a,ko(e,t,a)):(an&&n&&Yx(t),t.flags|=1,ba(e,t,r,a),t.child)}function G2(e,t,r,n,a){if(Ea(r)){var i=!0;$0(t)}else i=!1;if(ec(t,a),t.stateNode===null)y0(e,t),sj(t,r,n),Ay(t,r,n,a),n=!0;else if(e===null){var o=t.stateNode,s=t.memoizedProps;o.props=s;var l=o.context,u=r.contextType;typeof u=="object"&&u!==null?u=fi(u):(u=Ea(r)?Js:ga.current,u=sc(t,u));var f=r.getDerivedStateFromProps,d=typeof f=="function"||typeof o.getSnapshotBeforeUpdate=="function";d||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(s!==n||l!==u)&&D2(t,o,n,u),Io=!1;var p=t.memoizedState;o.state=p,B0(t,n,o,a),l=t.memoizedState,s!==n||p!==l||Ta.current||Io?(typeof f=="function"&&(Oy(t,r,f,n),l=t.memoizedState),(s=Io||R2(t,r,s,n,p,l,u))?(d||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount()),typeof o.componentDidMount=="function"&&(t.flags|=4194308)):(typeof o.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=n,t.memoizedState=l),o.props=n,o.state=l,o.context=u,n=s):(typeof o.componentDidMount=="function"&&(t.flags|=4194308),n=!1)}else{o=t.stateNode,F4(e,t),s=t.memoizedProps,u=t.type===t.elementType?s:bi(t.type,s),o.props=u,d=t.pendingProps,p=o.context,l=r.contextType,typeof l=="object"&&l!==null?l=fi(l):(l=Ea(r)?Js:ga.current,l=sc(t,l));var m=r.getDerivedStateFromProps;(f=typeof m=="function"||typeof o.getSnapshotBeforeUpdate=="function")||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(s!==d||p!==l)&&D2(t,o,n,l),Io=!1,p=t.memoizedState,o.state=p,B0(t,n,o,a);var v=t.memoizedState;s!==d||p!==v||Ta.current||Io?(typeof m=="function"&&(Oy(t,r,m,n),v=t.memoizedState),(u=Io||R2(t,r,u,n,p,v,l)||!1)?(f||typeof o.UNSAFE_componentWillUpdate!="function"&&typeof o.componentWillUpdate!="function"||(typeof o.componentWillUpdate=="function"&&o.componentWillUpdate(n,v,l),typeof o.UNSAFE_componentWillUpdate=="function"&&o.UNSAFE_componentWillUpdate(n,v,l)),typeof o.componentDidUpdate=="function"&&(t.flags|=4),typeof o.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof o.componentDidUpdate!="function"||s===e.memoizedProps&&p===e.memoizedState||(t.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||s===e.memoizedProps&&p===e.memoizedState||(t.flags|=1024),t.memoizedProps=n,t.memoizedState=v),o.props=n,o.state=v,o.context=l,n=u):(typeof o.componentDidUpdate!="function"||s===e.memoizedProps&&p===e.memoizedState||(t.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||s===e.memoizedProps&&p===e.memoizedState||(t.flags|=1024),n=!1)}return $y(e,t,r,n,i,a)}function $y(e,t,r,n,a,i){dj(e,t);var o=(t.flags&128)!==0;if(!n&&!o)return a&&C2(t,r,!1),ko(e,t,i);n=t.stateNode,zO.current=t;var s=o&&typeof r.getDerivedStateFromError!="function"?null:n.render();return t.flags|=1,e!==null&&o?(t.child=cc(t,e.child,null,i),t.child=cc(t,null,s,i)):ba(e,t,s,i),t.memoizedState=n.state,a&&C2(t,r,!0),t.child}function hj(e){var t=e.stateNode;t.pendingContext?P2(e,t.pendingContext,t.pendingContext!==t.context):t.context&&P2(e,t.context,!1),a1(e,t.containerInfo)}function z2(e,t,r,n,a){return lc(),Qx(a),t.flags|=256,ba(e,t,r,n),t.child}var Ry={dehydrated:null,treeContext:null,retryLane:0};function Dy(e){return{baseLanes:e,cachePool:null,transitions:null}}function pj(e,t,r){var n=t.pendingProps,a=un.current,i=!1,o=(t.flags&128)!==0,s;if((s=o)||(s=e!==null&&e.memoizedState===null?!1:(a&2)!==0),s?(i=!0,t.flags&=-129):(e===null||e.memoizedState!==null)&&(a|=1),Wr(un,a&1),e===null)return Ny(t),e=t.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?(t.mode&1?e.data==="$!"?t.lanes=8:t.lanes=1073741824:t.lanes=1,null):(o=n.children,e=n.fallback,i?(n=t.mode,i=t.child,o={mode:"hidden",children:o},!(n&1)&&i!==null?(i.childLanes=0,i.pendingProps=o):i=pp(o,n,0,null),e=qs(e,n,r,null),i.return=t,e.return=t,i.sibling=e,t.child=i,t.child.memoizedState=Dy(r),t.memoizedState=Ry,e):d1(t,o));if(a=e.memoizedState,a!==null&&(s=a.dehydrated,s!==null))return WO(e,t,o,n,s,a,r);if(i){i=n.fallback,o=t.mode,a=e.child,s=a.sibling;var l={mode:"hidden",children:n.children};return!(o&1)&&t.child!==a?(n=t.child,n.childLanes=0,n.pendingProps=l,t.deletions=null):(n=is(a,l),n.subtreeFlags=a.subtreeFlags&14680064),s!==null?i=is(s,i):(i=qs(i,o,r,null),i.flags|=2),i.return=t,n.return=t,n.sibling=i,t.child=n,n=i,i=t.child,o=e.child.memoizedState,o=o===null?Dy(r):{baseLanes:o.baseLanes|r,cachePool:null,transitions:o.transitions},i.memoizedState=o,i.childLanes=e.childLanes&~r,t.memoizedState=Ry,n}return i=e.child,e=i.sibling,n=is(i,{mode:"visible",children:n.children}),!(t.mode&1)&&(n.lanes=r),n.return=t,n.sibling=null,e!==null&&(r=t.deletions,r===null?(t.deletions=[e],t.flags|=16):r.push(e)),t.child=n,t.memoizedState=null,n}function d1(e,t){return t=pp({mode:"visible",children:t},e.mode,0,null),t.return=e,e.child=t}function Dd(e,t,r,n){return n!==null&&Qx(n),cc(t,e.child,null,r),e=d1(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function WO(e,t,r,n,a,i,o){if(r)return t.flags&256?(t.flags&=-257,n=om(Error(Te(422))),Dd(e,t,o,n)):t.memoizedState!==null?(t.child=e.child,t.flags|=128,null):(i=n.fallback,a=t.mode,n=pp({mode:"visible",children:n.children},a,0,null),i=qs(i,a,o,null),i.flags|=2,n.return=t,i.return=t,n.sibling=i,t.child=n,t.mode&1&&cc(t,e.child,null,o),t.child.memoizedState=Dy(o),t.memoizedState=Ry,i);if(!(t.mode&1))return Dd(e,t,o,null);if(a.data==="$!"){if(n=a.nextSibling&&a.nextSibling.dataset,n)var s=n.dgst;return n=s,i=Error(Te(419)),n=om(i,n,void 0),Dd(e,t,o,n)}if(s=(o&e.childLanes)!==0,Oa||s){if(n=Kn,n!==null){switch(o&-o){case 4:a=2;break;case 16:a=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:a=32;break;case 536870912:a=268435456;break;default:a=0}a=a&(n.suspendedLanes|o)?0:a,a!==0&&a!==i.retryLane&&(i.retryLane=a,wo(e,a),Oi(n,e,a,-1))}return v1(),n=om(Error(Te(421))),Dd(e,t,o,n)}return a.data==="$?"?(t.flags|=128,t.child=e.child,t=n6.bind(null,e),a._reactRetry=t,null):(e=i.treeContext,Wa=ts(a.nextSibling),Va=t,an=!0,ji=null,e!==null&&(ai[ii++]=co,ai[ii++]=uo,ai[ii++]=el,co=e.id,uo=e.overflow,el=t),t=d1(t,n.children),t.flags|=4096,t)}function W2(e,t,r){e.lanes|=t;var n=e.alternate;n!==null&&(n.lanes|=t),My(e.return,t,r)}function sm(e,t,r,n,a){var i=e.memoizedState;i===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:n,tail:r,tailMode:a}:(i.isBackwards=t,i.rendering=null,i.renderingStartTime=0,i.last=n,i.tail=r,i.tailMode=a)}function gj(e,t,r){var n=t.pendingProps,a=n.revealOrder,i=n.tail;if(ba(e,t,n.children,r),n=un.current,n&2)n=n&1|2,t.flags|=128;else{if(e!==null&&e.flags&128)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&W2(e,r,t);else if(e.tag===19)W2(e,r,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}n&=1}if(Wr(un,n),!(t.mode&1))t.memoizedState=null;else switch(a){case"forwards":for(r=t.child,a=null;r!==null;)e=r.alternate,e!==null&&F0(e)===null&&(a=r),r=r.sibling;r=a,r===null?(a=t.child,t.child=null):(a=r.sibling,r.sibling=null),sm(t,!1,a,r,i);break;case"backwards":for(r=null,a=t.child,t.child=null;a!==null;){if(e=a.alternate,e!==null&&F0(e)===null){t.child=a;break}e=a.sibling,a.sibling=r,r=a,a=e}sm(t,!0,r,null,i);break;case"together":sm(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function y0(e,t){!(t.mode&1)&&e!==null&&(e.alternate=null,t.alternate=null,t.flags|=2)}function ko(e,t,r){if(e!==null&&(t.dependencies=e.dependencies),rl|=t.lanes,!(r&t.childLanes))return null;if(e!==null&&t.child!==e.child)throw Error(Te(153));if(t.child!==null){for(e=t.child,r=is(e,e.pendingProps),t.child=r,r.return=t;e.sibling!==null;)e=e.sibling,r=r.sibling=is(e,e.pendingProps),r.return=t;r.sibling=null}return t.child}function VO(e,t,r){switch(t.tag){case 3:hj(t),lc();break;case 5:U4(t);break;case 1:Ea(t.type)&&$0(t);break;case 4:a1(t,t.stateNode.containerInfo);break;case 10:var n=t.type._context,a=t.memoizedProps.value;Wr(I0,n._currentValue),n._currentValue=a;break;case 13:if(n=t.memoizedState,n!==null)return n.dehydrated!==null?(Wr(un,un.current&1),t.flags|=128,null):r&t.child.childLanes?pj(e,t,r):(Wr(un,un.current&1),e=ko(e,t,r),e!==null?e.sibling:null);Wr(un,un.current&1);break;case 19:if(n=(r&t.childLanes)!==0,e.flags&128){if(n)return gj(e,t,r);t.flags|=128}if(a=t.memoizedState,a!==null&&(a.rendering=null,a.tail=null,a.lastEffect=null),Wr(un,un.current),n)break;return null;case 22:case 23:return t.lanes=0,fj(e,t,r)}return ko(e,t,r)}var mj,Iy,yj,vj;mj=function(e,t){for(var r=t.child;r!==null;){if(r.tag===5||r.tag===6)e.appendChild(r.stateNode);else if(r.tag!==4&&r.child!==null){r.child.return=r,r=r.child;continue}if(r===t)break;for(;r.sibling===null;){if(r.return===null||r.return===t)return;r=r.return}r.sibling.return=r.return,r=r.sibling}};Iy=function(){};yj=function(e,t,r,n){var a=e.memoizedProps;if(a!==n){e=t.stateNode,Ls(Vi.current);var i=null;switch(r){case"input":a=iy(e,a),n=iy(e,n),i=[];break;case"select":a=dn({},a,{value:void 0}),n=dn({},n,{value:void 0}),i=[];break;case"textarea":a=ly(e,a),n=ly(e,n),i=[];break;default:typeof a.onClick!="function"&&typeof n.onClick=="function"&&(e.onclick=T0)}uy(r,n);var o;r=null;for(u in a)if(!n.hasOwnProperty(u)&&a.hasOwnProperty(u)&&a[u]!=null)if(u==="style"){var s=a[u];for(o in s)s.hasOwnProperty(o)&&(r||(r={}),r[o]="")}else u!=="dangerouslySetInnerHTML"&&u!=="children"&&u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&u!=="autoFocus"&&(Qu.hasOwnProperty(u)?i||(i=[]):(i=i||[]).push(u,null));for(u in n){var l=n[u];if(s=a!=null?a[u]:void 0,n.hasOwnProperty(u)&&l!==s&&(l!=null||s!=null))if(u==="style")if(s){for(o in s)!s.hasOwnProperty(o)||l&&l.hasOwnProperty(o)||(r||(r={}),r[o]="");for(o in l)l.hasOwnProperty(o)&&s[o]!==l[o]&&(r||(r={}),r[o]=l[o])}else r||(i||(i=[]),i.push(u,r)),r=l;else u==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,s=s?s.__html:void 0,l!=null&&s!==l&&(i=i||[]).push(u,l)):u==="children"?typeof l!="string"&&typeof l!="number"||(i=i||[]).push(u,""+l):u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&(Qu.hasOwnProperty(u)?(l!=null&&u==="onScroll"&&Zr("scroll",e),i||s===l||(i=[])):(i=i||[]).push(u,l))}r&&(i=i||[]).push("style",r);var u=i;(t.updateQueue=u)&&(t.flags|=4)}};vj=function(e,t,r,n){r!==n&&(t.flags|=4)};function mu(e,t){if(!an)switch(e.tailMode){case"hidden":t=e.tail;for(var r=null;t!==null;)t.alternate!==null&&(r=t),t=t.sibling;r===null?e.tail=null:r.sibling=null;break;case"collapsed":r=e.tail;for(var n=null;r!==null;)r.alternate!==null&&(n=r),r=r.sibling;n===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:n.sibling=null}}function fa(e){var t=e.alternate!==null&&e.alternate.child===e.child,r=0,n=0;if(t)for(var a=e.child;a!==null;)r|=a.lanes|a.childLanes,n|=a.subtreeFlags&14680064,n|=a.flags&14680064,a.return=e,a=a.sibling;else for(a=e.child;a!==null;)r|=a.lanes|a.childLanes,n|=a.subtreeFlags,n|=a.flags,a.return=e,a=a.sibling;return e.subtreeFlags|=n,e.childLanes=r,t}function HO(e,t,r){var n=t.pendingProps;switch(Zx(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return fa(t),null;case 1:return Ea(t.type)&&E0(),fa(t),null;case 3:return n=t.stateNode,uc(),en(Ta),en(ga),o1(),n.pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),(e===null||e.child===null)&&($d(t)?t.flags|=4:e===null||e.memoizedState.isDehydrated&&!(t.flags&256)||(t.flags|=1024,ji!==null&&(Vy(ji),ji=null))),Iy(e,t),fa(t),null;case 5:i1(t);var a=Ls(ff.current);if(r=t.type,e!==null&&t.stateNode!=null)yj(e,t,r,n,a),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!n){if(t.stateNode===null)throw Error(Te(166));return fa(t),null}if(e=Ls(Vi.current),$d(t)){n=t.stateNode,r=t.type;var i=t.memoizedProps;switch(n[Fi]=t,n[cf]=i,e=(t.mode&1)!==0,r){case"dialog":Zr("cancel",n),Zr("close",n);break;case"iframe":case"object":case"embed":Zr("load",n);break;case"video":case"audio":for(a=0;a<Eu.length;a++)Zr(Eu[a],n);break;case"source":Zr("error",n);break;case"img":case"image":case"link":Zr("error",n),Zr("load",n);break;case"details":Zr("toggle",n);break;case"input":Jb(n,i),Zr("invalid",n);break;case"select":n._wrapperState={wasMultiple:!!i.multiple},Zr("invalid",n);break;case"textarea":t2(n,i),Zr("invalid",n)}uy(r,i),a=null;for(var o in i)if(i.hasOwnProperty(o)){var s=i[o];o==="children"?typeof s=="string"?n.textContent!==s&&(i.suppressHydrationWarning!==!0&&Ed(n.textContent,s,e),a=["children",s]):typeof s=="number"&&n.textContent!==""+s&&(i.suppressHydrationWarning!==!0&&Ed(n.textContent,s,e),a=["children",""+s]):Qu.hasOwnProperty(o)&&s!=null&&o==="onScroll"&&Zr("scroll",n)}switch(r){case"input":_d(n),e2(n,i,!0);break;case"textarea":_d(n),r2(n);break;case"select":case"option":break;default:typeof i.onClick=="function"&&(n.onclick=T0)}n=a,t.updateQueue=n,n!==null&&(t.flags|=4)}else{o=a.nodeType===9?a:a.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=H3(r)),e==="http://www.w3.org/1999/xhtml"?r==="script"?(e=o.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof n.is=="string"?e=o.createElement(r,{is:n.is}):(e=o.createElement(r),r==="select"&&(o=e,n.multiple?o.multiple=!0:n.size&&(o.size=n.size))):e=o.createElementNS(e,r),e[Fi]=t,e[cf]=n,mj(e,t,!1,!1),t.stateNode=e;e:{switch(o=fy(r,n),r){case"dialog":Zr("cancel",e),Zr("close",e),a=n;break;case"iframe":case"object":case"embed":Zr("load",e),a=n;break;case"video":case"audio":for(a=0;a<Eu.length;a++)Zr(Eu[a],e);a=n;break;case"source":Zr("error",e),a=n;break;case"img":case"image":case"link":Zr("error",e),Zr("load",e),a=n;break;case"details":Zr("toggle",e),a=n;break;case"input":Jb(e,n),a=iy(e,n),Zr("invalid",e);break;case"option":a=n;break;case"select":e._wrapperState={wasMultiple:!!n.multiple},a=dn({},n,{value:void 0}),Zr("invalid",e);break;case"textarea":t2(e,n),a=ly(e,n),Zr("invalid",e);break;default:a=n}uy(r,a),s=a;for(i in s)if(s.hasOwnProperty(i)){var l=s[i];i==="style"?q3(e,l):i==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,l!=null&&X3(e,l)):i==="children"?typeof l=="string"?(r!=="textarea"||l!=="")&&Ju(e,l):typeof l=="number"&&Ju(e,""+l):i!=="suppressContentEditableWarning"&&i!=="suppressHydrationWarning"&&i!=="autoFocus"&&(Qu.hasOwnProperty(i)?l!=null&&i==="onScroll"&&Zr("scroll",e):l!=null&&Dx(e,i,l,o))}switch(r){case"input":_d(e),e2(e,n,!1);break;case"textarea":_d(e),r2(e);break;case"option":n.value!=null&&e.setAttribute("value",""+cs(n.value));break;case"select":e.multiple=!!n.multiple,i=n.value,i!=null?Yl(e,!!n.multiple,i,!1):n.defaultValue!=null&&Yl(e,!!n.multiple,n.defaultValue,!0);break;default:typeof a.onClick=="function"&&(e.onclick=T0)}switch(r){case"button":case"input":case"select":case"textarea":n=!!n.autoFocus;break e;case"img":n=!0;break e;default:n=!1}}n&&(t.flags|=4)}t.ref!==null&&(t.flags|=512,t.flags|=2097152)}return fa(t),null;case 6:if(e&&t.stateNode!=null)vj(e,t,e.memoizedProps,n);else{if(typeof n!="string"&&t.stateNode===null)throw Error(Te(166));if(r=Ls(ff.current),Ls(Vi.current),$d(t)){if(n=t.stateNode,r=t.memoizedProps,n[Fi]=t,(i=n.nodeValue!==r)&&(e=Va,e!==null))switch(e.tag){case 3:Ed(n.nodeValue,r,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&Ed(n.nodeValue,r,(e.mode&1)!==0)}i&&(t.flags|=4)}else n=(r.nodeType===9?r:r.ownerDocument).createTextNode(n),n[Fi]=t,t.stateNode=n}return fa(t),null;case 13:if(en(un),n=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(an&&Wa!==null&&t.mode&1&&!(t.flags&128))D4(),lc(),t.flags|=98560,i=!1;else if(i=$d(t),n!==null&&n.dehydrated!==null){if(e===null){if(!i)throw Error(Te(318));if(i=t.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(Te(317));i[Fi]=t}else lc(),!(t.flags&128)&&(t.memoizedState=null),t.flags|=4;fa(t),i=!1}else ji!==null&&(Vy(ji),ji=null),i=!0;if(!i)return t.flags&65536?t:null}return t.flags&128?(t.lanes=r,t):(n=n!==null,n!==(e!==null&&e.memoizedState!==null)&&n&&(t.child.flags|=8192,t.mode&1&&(e===null||un.current&1?Gn===0&&(Gn=3):v1())),t.updateQueue!==null&&(t.flags|=4),fa(t),null);case 4:return uc(),Iy(e,t),e===null&&sf(t.stateNode.containerInfo),fa(t),null;case 10:return t1(t.type._context),fa(t),null;case 17:return Ea(t.type)&&E0(),fa(t),null;case 19:if(en(un),i=t.memoizedState,i===null)return fa(t),null;if(n=(t.flags&128)!==0,o=i.rendering,o===null)if(n)mu(i,!1);else{if(Gn!==0||e!==null&&e.flags&128)for(e=t.child;e!==null;){if(o=F0(e),o!==null){for(t.flags|=128,mu(i,!1),n=o.updateQueue,n!==null&&(t.updateQueue=n,t.flags|=4),t.subtreeFlags=0,n=r,r=t.child;r!==null;)i=r,e=n,i.flags&=14680066,o=i.alternate,o===null?(i.childLanes=0,i.lanes=e,i.child=null,i.subtreeFlags=0,i.memoizedProps=null,i.memoizedState=null,i.updateQueue=null,i.dependencies=null,i.stateNode=null):(i.childLanes=o.childLanes,i.lanes=o.lanes,i.child=o.child,i.subtreeFlags=0,i.deletions=null,i.memoizedProps=o.memoizedProps,i.memoizedState=o.memoizedState,i.updateQueue=o.updateQueue,i.type=o.type,e=o.dependencies,i.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),r=r.sibling;return Wr(un,un.current&1|2),t.child}e=e.sibling}i.tail!==null&&Pn()>dc&&(t.flags|=128,n=!0,mu(i,!1),t.lanes=4194304)}else{if(!n)if(e=F0(o),e!==null){if(t.flags|=128,n=!0,r=e.updateQueue,r!==null&&(t.updateQueue=r,t.flags|=4),mu(i,!0),i.tail===null&&i.tailMode==="hidden"&&!o.alternate&&!an)return fa(t),null}else 2*Pn()-i.renderingStartTime>dc&&r!==1073741824&&(t.flags|=128,n=!0,mu(i,!1),t.lanes=4194304);i.isBackwards?(o.sibling=t.child,t.child=o):(r=i.last,r!==null?r.sibling=o:t.child=o,i.last=o)}return i.tail!==null?(t=i.tail,i.rendering=t,i.tail=t.sibling,i.renderingStartTime=Pn(),t.sibling=null,r=un.current,Wr(un,n?r&1|2:r&1),t):(fa(t),null);case 22:case 23:return y1(),n=t.memoizedState!==null,e!==null&&e.memoizedState!==null!==n&&(t.flags|=8192),n&&t.mode&1?Ua&1073741824&&(fa(t),t.subtreeFlags&6&&(t.flags|=8192)):fa(t),null;case 24:return null;case 25:return null}throw Error(Te(156,t.tag))}function XO(e,t){switch(Zx(t),t.tag){case 1:return Ea(t.type)&&E0(),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return uc(),en(Ta),en(ga),o1(),e=t.flags,e&65536&&!(e&128)?(t.flags=e&-65537|128,t):null;case 5:return i1(t),null;case 13:if(en(un),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(Te(340));lc()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return en(un),null;case 4:return uc(),null;case 10:return t1(t.type._context),null;case 22:case 23:return y1(),null;case 24:return null;default:return null}}var Id=!1,ha=!1,KO=typeof WeakSet=="function"?WeakSet:Set,Ke=null;function Vl(e,t){var r=e.ref;if(r!==null)if(typeof r=="function")try{r(null)}catch(n){yn(e,t,n)}else r.current=null}function Ly(e,t,r){try{r()}catch(n){yn(e,t,n)}}var V2=!1;function qO(e,t){if(wy=M0,e=S4(),qx(e)){if("selectionStart"in e)var r={start:e.selectionStart,end:e.selectionEnd};else e:{r=(r=e.ownerDocument)&&r.defaultView||window;var n=r.getSelection&&r.getSelection();if(n&&n.rangeCount!==0){r=n.anchorNode;var a=n.anchorOffset,i=n.focusNode;n=n.focusOffset;try{r.nodeType,i.nodeType}catch{r=null;break e}var o=0,s=-1,l=-1,u=0,f=0,d=e,p=null;t:for(;;){for(var m;d!==r||a!==0&&d.nodeType!==3||(s=o+a),d!==i||n!==0&&d.nodeType!==3||(l=o+n),d.nodeType===3&&(o+=d.nodeValue.length),(m=d.firstChild)!==null;)p=d,d=m;for(;;){if(d===e)break t;if(p===r&&++u===a&&(s=o),p===i&&++f===n&&(l=o),(m=d.nextSibling)!==null)break;d=p,p=d.parentNode}d=m}r=s===-1||l===-1?null:{start:s,end:l}}else r=null}r=r||{start:0,end:0}}else r=null;for(ky={focusedElem:e,selectionRange:r},M0=!1,Ke=t;Ke!==null;)if(t=Ke,e=t.child,(t.subtreeFlags&1028)!==0&&e!==null)e.return=t,Ke=e;else for(;Ke!==null;){t=Ke;try{var v=t.alternate;if(t.flags&1024)switch(t.tag){case 0:case 11:case 15:break;case 1:if(v!==null){var b=v.memoizedProps,k=v.memoizedState,x=t.stateNode,y=x.getSnapshotBeforeUpdate(t.elementType===t.type?b:bi(t.type,b),k);x.__reactInternalSnapshotBeforeUpdate=y}break;case 3:var w=t.stateNode.containerInfo;w.nodeType===1?w.textContent="":w.nodeType===9&&w.documentElement&&w.removeChild(w.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(Te(163))}}catch(_){yn(t,t.return,_)}if(e=t.sibling,e!==null){e.return=t.return,Ke=e;break}Ke=t.return}return v=V2,V2=!1,v}function Uu(e,t,r){var n=t.updateQueue;if(n=n!==null?n.lastEffect:null,n!==null){var a=n=n.next;do{if((a.tag&e)===e){var i=a.destroy;a.destroy=void 0,i!==void 0&&Ly(t,r,i)}a=a.next}while(a!==n)}}function dp(e,t){if(t=t.updateQueue,t=t!==null?t.lastEffect:null,t!==null){var r=t=t.next;do{if((r.tag&e)===e){var n=r.create;r.destroy=n()}r=r.next}while(r!==t)}}function By(e){var t=e.ref;if(t!==null){var r=e.stateNode;switch(e.tag){case 5:e=r;break;default:e=r}typeof t=="function"?t(e):t.current=e}}function xj(e){var t=e.alternate;t!==null&&(e.alternate=null,xj(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&(delete t[Fi],delete t[cf],delete t[_y],delete t[AO],delete t[TO])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function bj(e){return e.tag===5||e.tag===3||e.tag===4}function H2(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||bj(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function Fy(e,t,r){var n=e.tag;if(n===5||n===6)e=e.stateNode,t?r.nodeType===8?r.parentNode.insertBefore(e,t):r.insertBefore(e,t):(r.nodeType===8?(t=r.parentNode,t.insertBefore(e,r)):(t=r,t.appendChild(e)),r=r._reactRootContainer,r!=null||t.onclick!==null||(t.onclick=T0));else if(n!==4&&(e=e.child,e!==null))for(Fy(e,t,r),e=e.sibling;e!==null;)Fy(e,t,r),e=e.sibling}function Uy(e,t,r){var n=e.tag;if(n===5||n===6)e=e.stateNode,t?r.insertBefore(e,t):r.appendChild(e);else if(n!==4&&(e=e.child,e!==null))for(Uy(e,t,r),e=e.sibling;e!==null;)Uy(e,t,r),e=e.sibling}var aa=null,wi=!1;function Eo(e,t,r){for(r=r.child;r!==null;)wj(e,t,r),r=r.sibling}function wj(e,t,r){if(Wi&&typeof Wi.onCommitFiberUnmount=="function")try{Wi.onCommitFiberUnmount(ap,r)}catch{}switch(r.tag){case 5:ha||Vl(r,t);case 6:var n=aa,a=wi;aa=null,Eo(e,t,r),aa=n,wi=a,aa!==null&&(wi?(e=aa,r=r.stateNode,e.nodeType===8?e.parentNode.removeChild(r):e.removeChild(r)):aa.removeChild(r.stateNode));break;case 18:aa!==null&&(wi?(e=aa,r=r.stateNode,e.nodeType===8?em(e.parentNode,r):e.nodeType===1&&em(e,r),nf(e)):em(aa,r.stateNode));break;case 4:n=aa,a=wi,aa=r.stateNode.containerInfo,wi=!0,Eo(e,t,r),aa=n,wi=a;break;case 0:case 11:case 14:case 15:if(!ha&&(n=r.updateQueue,n!==null&&(n=n.lastEffect,n!==null))){a=n=n.next;do{var i=a,o=i.destroy;i=i.tag,o!==void 0&&(i&2||i&4)&&Ly(r,t,o),a=a.next}while(a!==n)}Eo(e,t,r);break;case 1:if(!ha&&(Vl(r,t),n=r.stateNode,typeof n.componentWillUnmount=="function"))try{n.props=r.memoizedProps,n.state=r.memoizedState,n.componentWillUnmount()}catch(s){yn(r,t,s)}Eo(e,t,r);break;case 21:Eo(e,t,r);break;case 22:r.mode&1?(ha=(n=ha)||r.memoizedState!==null,Eo(e,t,r),ha=n):Eo(e,t,r);break;default:Eo(e,t,r)}}function X2(e){var t=e.updateQueue;if(t!==null){e.updateQueue=null;var r=e.stateNode;r===null&&(r=e.stateNode=new KO),t.forEach(function(n){var a=a6.bind(null,e,n);r.has(n)||(r.add(n),n.then(a,a))})}}function vi(e,t){var r=t.deletions;if(r!==null)for(var n=0;n<r.length;n++){var a=r[n];try{var i=e,o=t,s=o;e:for(;s!==null;){switch(s.tag){case 5:aa=s.stateNode,wi=!1;break e;case 3:aa=s.stateNode.containerInfo,wi=!0;break e;case 4:aa=s.stateNode.containerInfo,wi=!0;break e}s=s.return}if(aa===null)throw Error(Te(160));wj(i,o,a),aa=null,wi=!1;var l=a.alternate;l!==null&&(l.return=null),a.return=null}catch(u){yn(a,t,u)}}if(t.subtreeFlags&12854)for(t=t.child;t!==null;)kj(t,e),t=t.sibling}function kj(e,t){var r=e.alternate,n=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(vi(t,e),Li(e),n&4){try{Uu(3,e,e.return),dp(3,e)}catch(b){yn(e,e.return,b)}try{Uu(5,e,e.return)}catch(b){yn(e,e.return,b)}}break;case 1:vi(t,e),Li(e),n&512&&r!==null&&Vl(r,r.return);break;case 5:if(vi(t,e),Li(e),n&512&&r!==null&&Vl(r,r.return),e.flags&32){var a=e.stateNode;try{Ju(a,"")}catch(b){yn(e,e.return,b)}}if(n&4&&(a=e.stateNode,a!=null)){var i=e.memoizedProps,o=r!==null?r.memoizedProps:i,s=e.type,l=e.updateQueue;if(e.updateQueue=null,l!==null)try{s==="input"&&i.type==="radio"&&i.name!=null&&W3(a,i),fy(s,o);var u=fy(s,i);for(o=0;o<l.length;o+=2){var f=l[o],d=l[o+1];f==="style"?q3(a,d):f==="dangerouslySetInnerHTML"?X3(a,d):f==="children"?Ju(a,d):Dx(a,f,d,u)}switch(s){case"input":oy(a,i);break;case"textarea":V3(a,i);break;case"select":var p=a._wrapperState.wasMultiple;a._wrapperState.wasMultiple=!!i.multiple;var m=i.value;m!=null?Yl(a,!!i.multiple,m,!1):p!==!!i.multiple&&(i.defaultValue!=null?Yl(a,!!i.multiple,i.defaultValue,!0):Yl(a,!!i.multiple,i.multiple?[]:"",!1))}a[cf]=i}catch(b){yn(e,e.return,b)}}break;case 6:if(vi(t,e),Li(e),n&4){if(e.stateNode===null)throw Error(Te(162));a=e.stateNode,i=e.memoizedProps;try{a.nodeValue=i}catch(b){yn(e,e.return,b)}}break;case 3:if(vi(t,e),Li(e),n&4&&r!==null&&r.memoizedState.isDehydrated)try{nf(t.containerInfo)}catch(b){yn(e,e.return,b)}break;case 4:vi(t,e),Li(e);break;case 13:vi(t,e),Li(e),a=e.child,a.flags&8192&&(i=a.memoizedState!==null,a.stateNode.isHidden=i,!i||a.alternate!==null&&a.alternate.memoizedState!==null||(g1=Pn())),n&4&&X2(e);break;case 22:if(f=r!==null&&r.memoizedState!==null,e.mode&1?(ha=(u=ha)||f,vi(t,e),ha=u):vi(t,e),Li(e),n&8192){if(u=e.memoizedState!==null,(e.stateNode.isHidden=u)&&!f&&e.mode&1)for(Ke=e,f=e.child;f!==null;){for(d=Ke=f;Ke!==null;){switch(p=Ke,m=p.child,p.tag){case 0:case 11:case 14:case 15:Uu(4,p,p.return);break;case 1:Vl(p,p.return);var v=p.stateNode;if(typeof v.componentWillUnmount=="function"){n=p,r=p.return;try{t=n,v.props=t.memoizedProps,v.state=t.memoizedState,v.componentWillUnmount()}catch(b){yn(n,r,b)}}break;case 5:Vl(p,p.return);break;case 22:if(p.memoizedState!==null){q2(d);continue}}m!==null?(m.return=p,Ke=m):q2(d)}f=f.sibling}e:for(f=null,d=e;;){if(d.tag===5){if(f===null){f=d;try{a=d.stateNode,u?(i=a.style,typeof i.setProperty=="function"?i.setProperty("display","none","important"):i.display="none"):(s=d.stateNode,l=d.memoizedProps.style,o=l!=null&&l.hasOwnProperty("display")?l.display:null,s.style.display=K3("display",o))}catch(b){yn(e,e.return,b)}}}else if(d.tag===6){if(f===null)try{d.stateNode.nodeValue=u?"":d.memoizedProps}catch(b){yn(e,e.return,b)}}else if((d.tag!==22&&d.tag!==23||d.memoizedState===null||d===e)&&d.child!==null){d.child.return=d,d=d.child;continue}if(d===e)break e;for(;d.sibling===null;){if(d.return===null||d.return===e)break e;f===d&&(f=null),d=d.return}f===d&&(f=null),d.sibling.return=d.return,d=d.sibling}}break;case 19:vi(t,e),Li(e),n&4&&X2(e);break;case 21:break;default:vi(t,e),Li(e)}}function Li(e){var t=e.flags;if(t&2){try{e:{for(var r=e.return;r!==null;){if(bj(r)){var n=r;break e}r=r.return}throw Error(Te(160))}switch(n.tag){case 5:var a=n.stateNode;n.flags&32&&(Ju(a,""),n.flags&=-33);var i=H2(e);Uy(e,i,a);break;case 3:case 4:var o=n.stateNode.containerInfo,s=H2(e);Fy(e,s,o);break;default:throw Error(Te(161))}}catch(l){yn(e,e.return,l)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function YO(e,t,r){Ke=e,Sj(e)}function Sj(e,t,r){for(var n=(e.mode&1)!==0;Ke!==null;){var a=Ke,i=a.child;if(a.tag===22&&n){var o=a.memoizedState!==null||Id;if(!o){var s=a.alternate,l=s!==null&&s.memoizedState!==null||ha;s=Id;var u=ha;if(Id=o,(ha=l)&&!u)for(Ke=a;Ke!==null;)o=Ke,l=o.child,o.tag===22&&o.memoizedState!==null?Y2(a):l!==null?(l.return=o,Ke=l):Y2(a);for(;i!==null;)Ke=i,Sj(i),i=i.sibling;Ke=a,Id=s,ha=u}K2(e)}else a.subtreeFlags&8772&&i!==null?(i.return=a,Ke=i):K2(e)}}function K2(e){for(;Ke!==null;){var t=Ke;if(t.flags&8772){var r=t.alternate;try{if(t.flags&8772)switch(t.tag){case 0:case 11:case 15:ha||dp(5,t);break;case 1:var n=t.stateNode;if(t.flags&4&&!ha)if(r===null)n.componentDidMount();else{var a=t.elementType===t.type?r.memoizedProps:bi(t.type,r.memoizedProps);n.componentDidUpdate(a,r.memoizedState,n.__reactInternalSnapshotBeforeUpdate)}var i=t.updateQueue;i!==null&&T2(t,i,n);break;case 3:var o=t.updateQueue;if(o!==null){if(r=null,t.child!==null)switch(t.child.tag){case 5:r=t.child.stateNode;break;case 1:r=t.child.stateNode}T2(t,o,r)}break;case 5:var s=t.stateNode;if(r===null&&t.flags&4){r=s;var l=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":l.autoFocus&&r.focus();break;case"img":l.src&&(r.src=l.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(t.memoizedState===null){var u=t.alternate;if(u!==null){var f=u.memoizedState;if(f!==null){var d=f.dehydrated;d!==null&&nf(d)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(Te(163))}ha||t.flags&512&&By(t)}catch(p){yn(t,t.return,p)}}if(t===e){Ke=null;break}if(r=t.sibling,r!==null){r.return=t.return,Ke=r;break}Ke=t.return}}function q2(e){for(;Ke!==null;){var t=Ke;if(t===e){Ke=null;break}var r=t.sibling;if(r!==null){r.return=t.return,Ke=r;break}Ke=t.return}}function Y2(e){for(;Ke!==null;){var t=Ke;try{switch(t.tag){case 0:case 11:case 15:var r=t.return;try{dp(4,t)}catch(l){yn(t,r,l)}break;case 1:var n=t.stateNode;if(typeof n.componentDidMount=="function"){var a=t.return;try{n.componentDidMount()}catch(l){yn(t,a,l)}}var i=t.return;try{By(t)}catch(l){yn(t,i,l)}break;case 5:var o=t.return;try{By(t)}catch(l){yn(t,o,l)}}}catch(l){yn(t,t.return,l)}if(t===e){Ke=null;break}var s=t.sibling;if(s!==null){s.return=t.return,Ke=s;break}Ke=t.return}}var ZO=Math.ceil,z0=Po.ReactCurrentDispatcher,h1=Po.ReactCurrentOwner,ci=Po.ReactCurrentBatchConfig,gr=0,Kn=null,En=null,sa=0,Ua=0,Hl=ds(0),Gn=0,gf=null,rl=0,hp=0,p1=0,Gu=null,Na=null,g1=0,dc=1/0,so=null,W0=!1,Gy=null,ns=null,Ld=!1,zo=null,V0=0,zu=0,zy=null,v0=-1,x0=0;function ja(){return gr&6?Pn():v0!==-1?v0:v0=Pn()}function as(e){return e.mode&1?gr&2&&sa!==0?sa&-sa:$O.transition!==null?(x0===0&&(x0=s4()),x0):(e=Mr,e!==0||(e=window.event,e=e===void 0?16:p4(e.type)),e):1}function Oi(e,t,r,n){if(50<zu)throw zu=0,zy=null,Error(Te(185));td(e,r,n),(!(gr&2)||e!==Kn)&&(e===Kn&&(!(gr&2)&&(hp|=r),Gn===4&&Fo(e,sa)),$a(e,n),r===1&&gr===0&&!(t.mode&1)&&(dc=Pn()+500,cp&&hs()))}function $a(e,t){var r=e.callbackNode;$M(e,t);var n=N0(e,e===Kn?sa:0);if(n===0)r!==null&&i2(r),e.callbackNode=null,e.callbackPriority=0;else if(t=n&-n,e.callbackPriority!==t){if(r!=null&&i2(r),t===1)e.tag===0?EO(Z2.bind(null,e)):E4(Z2.bind(null,e)),MO(function(){!(gr&6)&&hs()}),r=null;else{switch(l4(n)){case 1:r=Ux;break;case 4:r=i4;break;case 16:r=C0;break;case 536870912:r=o4;break;default:r=C0}r=Aj(r,jj.bind(null,e))}e.callbackPriority=t,e.callbackNode=r}}function jj(e,t){if(v0=-1,x0=0,gr&6)throw Error(Te(327));var r=e.callbackNode;if(tc()&&e.callbackNode!==r)return null;var n=N0(e,e===Kn?sa:0);if(n===0)return null;if(n&30||n&e.expiredLanes||t)t=H0(e,n);else{t=n;var a=gr;gr|=2;var i=Pj();(Kn!==e||sa!==t)&&(so=null,dc=Pn()+500,Ks(e,t));do try{e6();break}catch(s){_j(e,s)}while(!0);e1(),z0.current=i,gr=a,En!==null?t=0:(Kn=null,sa=0,t=Gn)}if(t!==0){if(t===2&&(a=my(e),a!==0&&(n=a,t=Wy(e,a))),t===1)throw r=gf,Ks(e,0),Fo(e,n),$a(e,Pn()),r;if(t===6)Fo(e,n);else{if(a=e.current.alternate,!(n&30)&&!QO(a)&&(t=H0(e,n),t===2&&(i=my(e),i!==0&&(n=i,t=Wy(e,i))),t===1))throw r=gf,Ks(e,0),Fo(e,n),$a(e,Pn()),r;switch(e.finishedWork=a,e.finishedLanes=n,t){case 0:case 1:throw Error(Te(345));case 2:Ts(e,Na,so);break;case 3:if(Fo(e,n),(n&130023424)===n&&(t=g1+500-Pn(),10<t)){if(N0(e,0)!==0)break;if(a=e.suspendedLanes,(a&n)!==n){ja(),e.pingedLanes|=e.suspendedLanes&a;break}e.timeoutHandle=jy(Ts.bind(null,e,Na,so),t);break}Ts(e,Na,so);break;case 4:if(Fo(e,n),(n&4194240)===n)break;for(t=e.eventTimes,a=-1;0<n;){var o=31-Mi(n);i=1<<o,o=t[o],o>a&&(a=o),n&=~i}if(n=a,n=Pn()-n,n=(120>n?120:480>n?480:1080>n?1080:1920>n?1920:3e3>n?3e3:4320>n?4320:1960*ZO(n/1960))-n,10<n){e.timeoutHandle=jy(Ts.bind(null,e,Na,so),n);break}Ts(e,Na,so);break;case 5:Ts(e,Na,so);break;default:throw Error(Te(329))}}}return $a(e,Pn()),e.callbackNode===r?jj.bind(null,e):null}function Wy(e,t){var r=Gu;return e.current.memoizedState.isDehydrated&&(Ks(e,t).flags|=256),e=H0(e,t),e!==2&&(t=Na,Na=r,t!==null&&Vy(t)),e}function Vy(e){Na===null?Na=e:Na.push.apply(Na,e)}function QO(e){for(var t=e;;){if(t.flags&16384){var r=t.updateQueue;if(r!==null&&(r=r.stores,r!==null))for(var n=0;n<r.length;n++){var a=r[n],i=a.getSnapshot;a=a.value;try{if(!Ai(i(),a))return!1}catch{return!1}}}if(r=t.child,t.subtreeFlags&16384&&r!==null)r.return=t,t=r;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function Fo(e,t){for(t&=~p1,t&=~hp,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var r=31-Mi(t),n=1<<r;e[r]=-1,t&=~n}}function Z2(e){if(gr&6)throw Error(Te(327));tc();var t=N0(e,0);if(!(t&1))return $a(e,Pn()),null;var r=H0(e,t);if(e.tag!==0&&r===2){var n=my(e);n!==0&&(t=n,r=Wy(e,n))}if(r===1)throw r=gf,Ks(e,0),Fo(e,t),$a(e,Pn()),r;if(r===6)throw Error(Te(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,Ts(e,Na,so),$a(e,Pn()),null}function m1(e,t){var r=gr;gr|=1;try{return e(t)}finally{gr=r,gr===0&&(dc=Pn()+500,cp&&hs())}}function nl(e){zo!==null&&zo.tag===0&&!(gr&6)&&tc();var t=gr;gr|=1;var r=ci.transition,n=Mr;try{if(ci.transition=null,Mr=1,e)return e()}finally{Mr=n,ci.transition=r,gr=t,!(gr&6)&&hs()}}function y1(){Ua=Hl.current,en(Hl)}function Ks(e,t){e.finishedWork=null,e.finishedLanes=0;var r=e.timeoutHandle;if(r!==-1&&(e.timeoutHandle=-1,NO(r)),En!==null)for(r=En.return;r!==null;){var n=r;switch(Zx(n),n.tag){case 1:n=n.type.childContextTypes,n!=null&&E0();break;case 3:uc(),en(Ta),en(ga),o1();break;case 5:i1(n);break;case 4:uc();break;case 13:en(un);break;case 19:en(un);break;case 10:t1(n.type._context);break;case 22:case 23:y1()}r=r.return}if(Kn=e,En=e=is(e.current,null),sa=Ua=t,Gn=0,gf=null,p1=hp=rl=0,Na=Gu=null,Is!==null){for(t=0;t<Is.length;t++)if(r=Is[t],n=r.interleaved,n!==null){r.interleaved=null;var a=n.next,i=r.pending;if(i!==null){var o=i.next;i.next=a,n.next=o}r.pending=n}Is=null}return e}function _j(e,t){do{var r=En;try{if(e1(),g0.current=G0,U0){for(var n=fn.memoizedState;n!==null;){var a=n.queue;a!==null&&(a.pending=null),n=n.next}U0=!1}if(tl=0,Xn=Fn=fn=null,Fu=!1,df=0,h1.current=null,r===null||r.return===null){Gn=1,gf=t,En=null;break}e:{var i=e,o=r.return,s=r,l=t;if(t=sa,s.flags|=32768,l!==null&&typeof l=="object"&&typeof l.then=="function"){var u=l,f=s,d=f.tag;if(!(f.mode&1)&&(d===0||d===11||d===15)){var p=f.alternate;p?(f.updateQueue=p.updateQueue,f.memoizedState=p.memoizedState,f.lanes=p.lanes):(f.updateQueue=null,f.memoizedState=null)}var m=L2(o);if(m!==null){m.flags&=-257,B2(m,o,s,i,t),m.mode&1&&I2(i,u,t),t=m,l=u;var v=t.updateQueue;if(v===null){var b=new Set;b.add(l),t.updateQueue=b}else v.add(l);break e}else{if(!(t&1)){I2(i,u,t),v1();break e}l=Error(Te(426))}}else if(an&&s.mode&1){var k=L2(o);if(k!==null){!(k.flags&65536)&&(k.flags|=256),B2(k,o,s,i,t),Qx(fc(l,s));break e}}i=l=fc(l,s),Gn!==4&&(Gn=2),Gu===null?Gu=[i]:Gu.push(i),i=o;do{switch(i.tag){case 3:i.flags|=65536,t&=-t,i.lanes|=t;var x=lj(i,l,t);A2(i,x);break e;case 1:s=l;var y=i.type,w=i.stateNode;if(!(i.flags&128)&&(typeof y.getDerivedStateFromError=="function"||w!==null&&typeof w.componentDidCatch=="function"&&(ns===null||!ns.has(w)))){i.flags|=65536,t&=-t,i.lanes|=t;var _=cj(i,s,t);A2(i,_);break e}}i=i.return}while(i!==null)}Nj(r)}catch(S){t=S,En===r&&r!==null&&(En=r=r.return);continue}break}while(!0)}function Pj(){var e=z0.current;return z0.current=G0,e===null?G0:e}function v1(){(Gn===0||Gn===3||Gn===2)&&(Gn=4),Kn===null||!(rl&268435455)&&!(hp&268435455)||Fo(Kn,sa)}function H0(e,t){var r=gr;gr|=2;var n=Pj();(Kn!==e||sa!==t)&&(so=null,Ks(e,t));do try{JO();break}catch(a){_j(e,a)}while(!0);if(e1(),gr=r,z0.current=n,En!==null)throw Error(Te(261));return Kn=null,sa=0,Gn}function JO(){for(;En!==null;)Cj(En)}function e6(){for(;En!==null&&!_M();)Cj(En)}function Cj(e){var t=Oj(e.alternate,e,Ua);e.memoizedProps=e.pendingProps,t===null?Nj(e):En=t,h1.current=null}function Nj(e){var t=e;do{var r=t.alternate;if(e=t.return,t.flags&32768){if(r=XO(r,t),r!==null){r.flags&=32767,En=r;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{Gn=6,En=null;return}}else if(r=HO(r,t,Ua),r!==null){En=r;return}if(t=t.sibling,t!==null){En=t;return}En=t=e}while(t!==null);Gn===0&&(Gn=5)}function Ts(e,t,r){var n=Mr,a=ci.transition;try{ci.transition=null,Mr=1,t6(e,t,r,n)}finally{ci.transition=a,Mr=n}return null}function t6(e,t,r,n){do tc();while(zo!==null);if(gr&6)throw Error(Te(327));r=e.finishedWork;var a=e.finishedLanes;if(r===null)return null;if(e.finishedWork=null,e.finishedLanes=0,r===e.current)throw Error(Te(177));e.callbackNode=null,e.callbackPriority=0;var i=r.lanes|r.childLanes;if(RM(e,i),e===Kn&&(En=Kn=null,sa=0),!(r.subtreeFlags&2064)&&!(r.flags&2064)||Ld||(Ld=!0,Aj(C0,function(){return tc(),null})),i=(r.flags&15990)!==0,r.subtreeFlags&15990||i){i=ci.transition,ci.transition=null;var o=Mr;Mr=1;var s=gr;gr|=4,h1.current=null,qO(e,r),kj(r,e),wO(ky),M0=!!wy,ky=wy=null,e.current=r,YO(r),PM(),gr=s,Mr=o,ci.transition=i}else e.current=r;if(Ld&&(Ld=!1,zo=e,V0=a),i=e.pendingLanes,i===0&&(ns=null),MM(r.stateNode),$a(e,Pn()),t!==null)for(n=e.onRecoverableError,r=0;r<t.length;r++)a=t[r],n(a.value,{componentStack:a.stack,digest:a.digest});if(W0)throw W0=!1,e=Gy,Gy=null,e;return V0&1&&e.tag!==0&&tc(),i=e.pendingLanes,i&1?e===zy?zu++:(zu=0,zy=e):zu=0,hs(),null}function tc(){if(zo!==null){var e=l4(V0),t=ci.transition,r=Mr;try{if(ci.transition=null,Mr=16>e?16:e,zo===null)var n=!1;else{if(e=zo,zo=null,V0=0,gr&6)throw Error(Te(331));var a=gr;for(gr|=4,Ke=e.current;Ke!==null;){var i=Ke,o=i.child;if(Ke.flags&16){var s=i.deletions;if(s!==null){for(var l=0;l<s.length;l++){var u=s[l];for(Ke=u;Ke!==null;){var f=Ke;switch(f.tag){case 0:case 11:case 15:Uu(8,f,i)}var d=f.child;if(d!==null)d.return=f,Ke=d;else for(;Ke!==null;){f=Ke;var p=f.sibling,m=f.return;if(xj(f),f===u){Ke=null;break}if(p!==null){p.return=m,Ke=p;break}Ke=m}}}var v=i.alternate;if(v!==null){var b=v.child;if(b!==null){v.child=null;do{var k=b.sibling;b.sibling=null,b=k}while(b!==null)}}Ke=i}}if(i.subtreeFlags&2064&&o!==null)o.return=i,Ke=o;else e:for(;Ke!==null;){if(i=Ke,i.flags&2048)switch(i.tag){case 0:case 11:case 15:Uu(9,i,i.return)}var x=i.sibling;if(x!==null){x.return=i.return,Ke=x;break e}Ke=i.return}}var y=e.current;for(Ke=y;Ke!==null;){o=Ke;var w=o.child;if(o.subtreeFlags&2064&&w!==null)w.return=o,Ke=w;else e:for(o=y;Ke!==null;){if(s=Ke,s.flags&2048)try{switch(s.tag){case 0:case 11:case 15:dp(9,s)}}catch(S){yn(s,s.return,S)}if(s===o){Ke=null;break e}var _=s.sibling;if(_!==null){_.return=s.return,Ke=_;break e}Ke=s.return}}if(gr=a,hs(),Wi&&typeof Wi.onPostCommitFiberRoot=="function")try{Wi.onPostCommitFiberRoot(ap,e)}catch{}n=!0}return n}finally{Mr=r,ci.transition=t}}return!1}function Q2(e,t,r){t=fc(r,t),t=lj(e,t,1),e=rs(e,t,1),t=ja(),e!==null&&(td(e,1,t),$a(e,t))}function yn(e,t,r){if(e.tag===3)Q2(e,e,r);else for(;t!==null;){if(t.tag===3){Q2(t,e,r);break}else if(t.tag===1){var n=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof n.componentDidCatch=="function"&&(ns===null||!ns.has(n))){e=fc(r,e),e=cj(t,e,1),t=rs(t,e,1),e=ja(),t!==null&&(td(t,1,e),$a(t,e));break}}t=t.return}}function r6(e,t,r){var n=e.pingCache;n!==null&&n.delete(t),t=ja(),e.pingedLanes|=e.suspendedLanes&r,Kn===e&&(sa&r)===r&&(Gn===4||Gn===3&&(sa&130023424)===sa&&500>Pn()-g1?Ks(e,0):p1|=r),$a(e,t)}function Mj(e,t){t===0&&(e.mode&1?(t=Nd,Nd<<=1,!(Nd&130023424)&&(Nd=4194304)):t=1);var r=ja();e=wo(e,t),e!==null&&(td(e,t,r),$a(e,r))}function n6(e){var t=e.memoizedState,r=0;t!==null&&(r=t.retryLane),Mj(e,r)}function a6(e,t){var r=0;switch(e.tag){case 13:var n=e.stateNode,a=e.memoizedState;a!==null&&(r=a.retryLane);break;case 19:n=e.stateNode;break;default:throw Error(Te(314))}n!==null&&n.delete(t),Mj(e,r)}var Oj;Oj=function(e,t,r){if(e!==null)if(e.memoizedProps!==t.pendingProps||Ta.current)Oa=!0;else{if(!(e.lanes&r)&&!(t.flags&128))return Oa=!1,VO(e,t,r);Oa=!!(e.flags&131072)}else Oa=!1,an&&t.flags&1048576&&$4(t,D0,t.index);switch(t.lanes=0,t.tag){case 2:var n=t.type;y0(e,t),e=t.pendingProps;var a=sc(t,ga.current);ec(t,r),a=l1(null,t,n,e,a,r);var i=c1();return t.flags|=1,typeof a=="object"&&a!==null&&typeof a.render=="function"&&a.$$typeof===void 0?(t.tag=1,t.memoizedState=null,t.updateQueue=null,Ea(n)?(i=!0,$0(t)):i=!1,t.memoizedState=a.state!==null&&a.state!==void 0?a.state:null,n1(t),a.updater=fp,t.stateNode=a,a._reactInternals=t,Ay(t,n,e,r),t=$y(null,t,n,!0,i,r)):(t.tag=0,an&&i&&Yx(t),ba(null,t,a,r),t=t.child),t;case 16:n=t.elementType;e:{switch(y0(e,t),e=t.pendingProps,a=n._init,n=a(n._payload),t.type=n,a=t.tag=o6(n),e=bi(n,e),a){case 0:t=Ey(null,t,n,e,r);break e;case 1:t=G2(null,t,n,e,r);break e;case 11:t=F2(null,t,n,e,r);break e;case 14:t=U2(null,t,n,bi(n.type,e),r);break e}throw Error(Te(306,n,""))}return t;case 0:return n=t.type,a=t.pendingProps,a=t.elementType===n?a:bi(n,a),Ey(e,t,n,a,r);case 1:return n=t.type,a=t.pendingProps,a=t.elementType===n?a:bi(n,a),G2(e,t,n,a,r);case 3:e:{if(hj(t),e===null)throw Error(Te(387));n=t.pendingProps,i=t.memoizedState,a=i.element,F4(e,t),B0(t,n,null,r);var o=t.memoizedState;if(n=o.element,i.isDehydrated)if(i={element:n,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},t.updateQueue.baseState=i,t.memoizedState=i,t.flags&256){a=fc(Error(Te(423)),t),t=z2(e,t,n,r,a);break e}else if(n!==a){a=fc(Error(Te(424)),t),t=z2(e,t,n,r,a);break e}else for(Wa=ts(t.stateNode.containerInfo.firstChild),Va=t,an=!0,ji=null,r=L4(t,null,n,r),t.child=r;r;)r.flags=r.flags&-3|4096,r=r.sibling;else{if(lc(),n===a){t=ko(e,t,r);break e}ba(e,t,n,r)}t=t.child}return t;case 5:return U4(t),e===null&&Ny(t),n=t.type,a=t.pendingProps,i=e!==null?e.memoizedProps:null,o=a.children,Sy(n,a)?o=null:i!==null&&Sy(n,i)&&(t.flags|=32),dj(e,t),ba(e,t,o,r),t.child;case 6:return e===null&&Ny(t),null;case 13:return pj(e,t,r);case 4:return a1(t,t.stateNode.containerInfo),n=t.pendingProps,e===null?t.child=cc(t,null,n,r):ba(e,t,n,r),t.child;case 11:return n=t.type,a=t.pendingProps,a=t.elementType===n?a:bi(n,a),F2(e,t,n,a,r);case 7:return ba(e,t,t.pendingProps,r),t.child;case 8:return ba(e,t,t.pendingProps.children,r),t.child;case 12:return ba(e,t,t.pendingProps.children,r),t.child;case 10:e:{if(n=t.type._context,a=t.pendingProps,i=t.memoizedProps,o=a.value,Wr(I0,n._currentValue),n._currentValue=o,i!==null)if(Ai(i.value,o)){if(i.children===a.children&&!Ta.current){t=ko(e,t,r);break e}}else for(i=t.child,i!==null&&(i.return=t);i!==null;){var s=i.dependencies;if(s!==null){o=i.child;for(var l=s.firstContext;l!==null;){if(l.context===n){if(i.tag===1){l=go(-1,r&-r),l.tag=2;var u=i.updateQueue;if(u!==null){u=u.shared;var f=u.pending;f===null?l.next=l:(l.next=f.next,f.next=l),u.pending=l}}i.lanes|=r,l=i.alternate,l!==null&&(l.lanes|=r),My(i.return,r,t),s.lanes|=r;break}l=l.next}}else if(i.tag===10)o=i.type===t.type?null:i.child;else if(i.tag===18){if(o=i.return,o===null)throw Error(Te(341));o.lanes|=r,s=o.alternate,s!==null&&(s.lanes|=r),My(o,r,t),o=i.sibling}else o=i.child;if(o!==null)o.return=i;else for(o=i;o!==null;){if(o===t){o=null;break}if(i=o.sibling,i!==null){i.return=o.return,o=i;break}o=o.return}i=o}ba(e,t,a.children,r),t=t.child}return t;case 9:return a=t.type,n=t.pendingProps.children,ec(t,r),a=fi(a),n=n(a),t.flags|=1,ba(e,t,n,r),t.child;case 14:return n=t.type,a=bi(n,t.pendingProps),a=bi(n.type,a),U2(e,t,n,a,r);case 15:return uj(e,t,t.type,t.pendingProps,r);case 17:return n=t.type,a=t.pendingProps,a=t.elementType===n?a:bi(n,a),y0(e,t),t.tag=1,Ea(n)?(e=!0,$0(t)):e=!1,ec(t,r),sj(t,n,a),Ay(t,n,a,r),$y(null,t,n,!0,e,r);case 19:return gj(e,t,r);case 22:return fj(e,t,r)}throw Error(Te(156,t.tag))};function Aj(e,t){return a4(e,t)}function i6(e,t,r,n){this.tag=e,this.key=r,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=n,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function oi(e,t,r,n){return new i6(e,t,r,n)}function x1(e){return e=e.prototype,!(!e||!e.isReactComponent)}function o6(e){if(typeof e=="function")return x1(e)?1:0;if(e!=null){if(e=e.$$typeof,e===Lx)return 11;if(e===Bx)return 14}return 2}function is(e,t){var r=e.alternate;return r===null?(r=oi(e.tag,t,e.key,e.mode),r.elementType=e.elementType,r.type=e.type,r.stateNode=e.stateNode,r.alternate=e,e.alternate=r):(r.pendingProps=t,r.type=e.type,r.flags=0,r.subtreeFlags=0,r.deletions=null),r.flags=e.flags&14680064,r.childLanes=e.childLanes,r.lanes=e.lanes,r.child=e.child,r.memoizedProps=e.memoizedProps,r.memoizedState=e.memoizedState,r.updateQueue=e.updateQueue,t=e.dependencies,r.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},r.sibling=e.sibling,r.index=e.index,r.ref=e.ref,r}function b0(e,t,r,n,a,i){var o=2;if(n=e,typeof e=="function")x1(e)&&(o=1);else if(typeof e=="string")o=5;else e:switch(e){case Dl:return qs(r.children,a,i,t);case Ix:o=8,a|=8;break;case ty:return e=oi(12,r,t,a|2),e.elementType=ty,e.lanes=i,e;case ry:return e=oi(13,r,t,a),e.elementType=ry,e.lanes=i,e;case ny:return e=oi(19,r,t,a),e.elementType=ny,e.lanes=i,e;case U3:return pp(r,a,i,t);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case B3:o=10;break e;case F3:o=9;break e;case Lx:o=11;break e;case Bx:o=14;break e;case Do:o=16,n=null;break e}throw Error(Te(130,e==null?e:typeof e,""))}return t=oi(o,r,t,a),t.elementType=e,t.type=n,t.lanes=i,t}function qs(e,t,r,n){return e=oi(7,e,n,t),e.lanes=r,e}function pp(e,t,r,n){return e=oi(22,e,n,t),e.elementType=U3,e.lanes=r,e.stateNode={isHidden:!1},e}function lm(e,t,r){return e=oi(6,e,null,t),e.lanes=r,e}function cm(e,t,r){return t=oi(4,e.children!==null?e.children:[],e.key,t),t.lanes=r,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function s6(e,t,r,n,a){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=zg(0),this.expirationTimes=zg(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=zg(0),this.identifierPrefix=n,this.onRecoverableError=a,this.mutableSourceEagerHydrationData=null}function b1(e,t,r,n,a,i,o,s,l){return e=new s6(e,t,r,s,l),t===1?(t=1,i===!0&&(t|=8)):t=0,i=oi(3,null,null,t),e.current=i,i.stateNode=e,i.memoizedState={element:n,isDehydrated:r,cache:null,transitions:null,pendingSuspenseBoundaries:null},n1(i),e}function l6(e,t,r){var n=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Rl,key:n==null?null:""+n,children:e,containerInfo:t,implementation:r}}function Tj(e){if(!e)return us;e=e._reactInternals;e:{if(yl(e)!==e||e.tag!==1)throw Error(Te(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(Ea(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(t!==null);throw Error(Te(171))}if(e.tag===1){var r=e.type;if(Ea(r))return T4(e,r,t)}return t}function Ej(e,t,r,n,a,i,o,s,l){return e=b1(r,n,!0,e,a,i,o,s,l),e.context=Tj(null),r=e.current,n=ja(),a=as(r),i=go(n,a),i.callback=t??null,rs(r,i,a),e.current.lanes=a,td(e,a,n),$a(e,n),e}function gp(e,t,r,n){var a=t.current,i=ja(),o=as(a);return r=Tj(r),t.context===null?t.context=r:t.pendingContext=r,t=go(i,o),t.payload={element:e},n=n===void 0?null:n,n!==null&&(t.callback=n),e=rs(a,t,o),e!==null&&(Oi(e,a,o,i),p0(e,a,o)),o}function X0(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function J2(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var r=e.retryLane;e.retryLane=r!==0&&r<t?r:t}}function w1(e,t){J2(e,t),(e=e.alternate)&&J2(e,t)}function c6(){return null}var $j=typeof reportError=="function"?reportError:function(e){console.error(e)};function k1(e){this._internalRoot=e}mp.prototype.render=k1.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(Te(409));gp(e,t,null,null)};mp.prototype.unmount=k1.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;nl(function(){gp(null,e,null,null)}),t[bo]=null}};function mp(e){this._internalRoot=e}mp.prototype.unstable_scheduleHydration=function(e){if(e){var t=f4();e={blockedOn:null,target:e,priority:t};for(var r=0;r<Bo.length&&t!==0&&t<Bo[r].priority;r++);Bo.splice(r,0,e),r===0&&h4(e)}};function S1(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function yp(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function ew(){}function u6(e,t,r,n,a){if(a){if(typeof n=="function"){var i=n;n=function(){var u=X0(o);i.call(u)}}var o=Ej(t,n,e,0,null,!1,!1,"",ew);return e._reactRootContainer=o,e[bo]=o.current,sf(e.nodeType===8?e.parentNode:e),nl(),o}for(;a=e.lastChild;)e.removeChild(a);if(typeof n=="function"){var s=n;n=function(){var u=X0(l);s.call(u)}}var l=b1(e,0,!1,null,null,!1,!1,"",ew);return e._reactRootContainer=l,e[bo]=l.current,sf(e.nodeType===8?e.parentNode:e),nl(function(){gp(t,l,r,n)}),l}function vp(e,t,r,n,a){var i=r._reactRootContainer;if(i){var o=i;if(typeof a=="function"){var s=a;a=function(){var l=X0(o);s.call(l)}}gp(t,o,e,a)}else o=u6(r,t,e,a,n);return X0(o)}c4=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var r=Tu(t.pendingLanes);r!==0&&(Gx(t,r|1),$a(t,Pn()),!(gr&6)&&(dc=Pn()+500,hs()))}break;case 13:nl(function(){var n=wo(e,1);if(n!==null){var a=ja();Oi(n,e,1,a)}}),w1(e,1)}};zx=function(e){if(e.tag===13){var t=wo(e,134217728);if(t!==null){var r=ja();Oi(t,e,134217728,r)}w1(e,134217728)}};u4=function(e){if(e.tag===13){var t=as(e),r=wo(e,t);if(r!==null){var n=ja();Oi(r,e,t,n)}w1(e,t)}};f4=function(){return Mr};d4=function(e,t){var r=Mr;try{return Mr=e,t()}finally{Mr=r}};hy=function(e,t,r){switch(t){case"input":if(oy(e,r),t=r.name,r.type==="radio"&&t!=null){for(r=e;r.parentNode;)r=r.parentNode;for(r=r.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<r.length;t++){var n=r[t];if(n!==e&&n.form===e.form){var a=lp(n);if(!a)throw Error(Te(90));z3(n),oy(n,a)}}}break;case"textarea":V3(e,r);break;case"select":t=r.value,t!=null&&Yl(e,!!r.multiple,t,!1)}};Q3=m1;J3=nl;var f6={usingClientEntryPoint:!1,Events:[nd,Fl,lp,Y3,Z3,m1]},yu={findFiberByHostInstance:Ds,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},d6={bundleType:yu.bundleType,version:yu.version,rendererPackageName:yu.rendererPackageName,rendererConfig:yu.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Po.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=r4(e),e===null?null:e.stateNode},findFiberByHostInstance:yu.findFiberByHostInstance||c6,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Bd=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Bd.isDisabled&&Bd.supportsFiber)try{ap=Bd.inject(d6),Wi=Bd}catch{}}Xa.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=f6;Xa.createPortal=function(e,t){var r=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!S1(t))throw Error(Te(200));return l6(e,t,null,r)};Xa.createRoot=function(e,t){if(!S1(e))throw Error(Te(299));var r=!1,n="",a=$j;return t!=null&&(t.unstable_strictMode===!0&&(r=!0),t.identifierPrefix!==void 0&&(n=t.identifierPrefix),t.onRecoverableError!==void 0&&(a=t.onRecoverableError)),t=b1(e,1,!1,null,null,r,!1,n,a),e[bo]=t.current,sf(e.nodeType===8?e.parentNode:e),new k1(t)};Xa.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(Te(188)):(e=Object.keys(e).join(","),Error(Te(268,e)));return e=r4(t),e=e===null?null:e.stateNode,e};Xa.flushSync=function(e){return nl(e)};Xa.hydrate=function(e,t,r){if(!yp(t))throw Error(Te(200));return vp(null,e,t,!0,r)};Xa.hydrateRoot=function(e,t,r){if(!S1(e))throw Error(Te(405));var n=r!=null&&r.hydratedSources||null,a=!1,i="",o=$j;if(r!=null&&(r.unstable_strictMode===!0&&(a=!0),r.identifierPrefix!==void 0&&(i=r.identifierPrefix),r.onRecoverableError!==void 0&&(o=r.onRecoverableError)),t=Ej(t,null,e,1,r??null,a,!1,i,o),e[bo]=t.current,sf(e),n)for(e=0;e<n.length;e++)r=n[e],a=r._getVersion,a=a(r._source),t.mutableSourceEagerHydrationData==null?t.mutableSourceEagerHydrationData=[r,a]:t.mutableSourceEagerHydrationData.push(r,a);return new mp(t)};Xa.render=function(e,t,r){if(!yp(t))throw Error(Te(200));return vp(null,e,t,!1,r)};Xa.unmountComponentAtNode=function(e){if(!yp(e))throw Error(Te(40));return e._reactRootContainer?(nl(function(){vp(null,null,e,!1,function(){e._reactRootContainer=null,e[bo]=null})}),!0):!1};Xa.unstable_batchedUpdates=m1;Xa.unstable_renderSubtreeIntoContainer=function(e,t,r,n){if(!yp(r))throw Error(Te(200));if(e==null||e._reactInternals===void 0)throw Error(Te(38));return vp(e,t,r,!1,n)};Xa.version="18.3.1-next-f1338f8080-20240426";function Rj(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(Rj)}catch(e){console.error(e)}}Rj(),R3.exports=Xa;var h6=R3.exports,tw=h6;Jm.createRoot=tw.createRoot,Jm.hydrateRoot=tw.hydrateRoot;const os=({isOpen:e,onClose:t,onConfirm:r,title:n,message:a,confirmText:i="I know the risk and insist to continue",cancelText:o="Cancel"})=>e?c.jsx("div",{className:"fixed inset-0 z-[100] flex items-center justify-center bg-black/60 backdrop-blur-sm p-4 animate-in fade-in duration-200",children:c.jsxs("div",{className:"bg-white dark:bg-slate-900 w-full max-w-md rounded-2xl shadow-2xl border border-amber-500/30 overflow-hidden transform transition-all scale-100",children:[c.jsxs("div",{className:"bg-amber-500/10 p-6 flex flex-col items-center justify-center border-b border-amber-500/20",children:[c.jsx("div",{className:"w-16 h-16 bg-amber-100 dark:bg-amber-900/30 rounded-full flex items-center justify-center mb-4",children:c.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-10 w-10 text-amber-600 dark:text-amber-500",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})})}),c.jsx("h3",{className:"text-xl font-bold text-gray-900 dark:text-white text-center",children:n})]}),c.jsx("div",{className:"p-6",children:c.jsx("div",{className:"text-gray-600 dark:text-slate-300 text-center text-sm leading-relaxed",children:a})}),c.jsxs("div",{className:"p-4 bg-gray-50 dark:bg-slate-800/50 flex gap-3 justify-end border-t border-gray-200 dark:border-slate-800",children:[c.jsx("button",{onClick:t,className:"px-4 py-2 bg-white hover:bg-gray-100 dark:bg-slate-700 dark:hover:bg-slate-600 text-gray-700 dark:text-slate-200 font-semibold rounded-lg border border-gray-300 dark:border-slate-600 transition-colors text-sm",children:o}),c.jsx("button",{onClick:r,className:"px-4 py-2 bg-amber-600 hover:bg-amber-700 text-white font-bold rounded-lg shadow-lg shadow-amber-500/20 transition-all active:scale-95 text-sm",children:i})]})]})}):null,p6=({onFileSelected:e,onGenerateFakeDng:t,fileName:r,hasGeneratedData:n,viewMode:a,onSetViewMode:i,patternPeriod:o,onPatternPeriodChange:s,fillFactor:l,onFillFactorChange:u,patternPhase:f,onPatternPhaseChange:d,showPatternControls:p,onOpenAbout:m,onShowExif:v,bridgeStatus:b,onBridgeClick:k,isDrLabOpen:x,onToggleDrLab:y,isColorLabOpen:w,onToggleColorLab:_,isFftLabOpen:S,onToggleFftLab:j,isSfrLabOpen:M,onToggleSfrLab:A,onGenerateTestPic:$,onPTCFilesSelected:E,onDownloadDng:T,isThreePlane:B,onOpenDatabase:U,isSidebarOpen:V,onToggleSidebar:G,onOpenSaveZ8:D,isPsModeOpen:I,onTogglePsMode:F})=>{const H=C.useRef(null),W=C.useRef(null),[Q,q]=C.useState(!1),[re,ee]=C.useState(!1),[fe,oe]=C.useState(!1),[ye,ae]=C.useState("direct"),X=C.useRef(null),se=C.useRef(null);C.useEffect(()=>{const ke=ve=>{X.current&&!X.current.contains(ve.target)&&ee(!1),se.current&&!se.current.contains(ve.target)&&oe(!1)};return document.addEventListener("mousedown",ke),()=>document.removeEventListener("mousedown",ke)},[]);const he=ke=>{var ve,ge;ee(!1),ke==="direct"?(ae("direct"),(ve=H.current)==null||ve.click()):!b.isConnected||!b.hasDngConverter?q(!0):(ae("convert"),(ge=H.current)==null||ge.click())},le=ke=>{var ge;const ve=(ge=ke.target.files)==null?void 0:ge[0];ve&&e(ve,ye),ke.target.value=""},je=ke=>{ke.target.files&&ke.target.files.length>0&&E(ke.target.files),ke.target.value=""};return r==="pattern_test.dng"||(r==null||r.startsWith("Diff_")),c.jsxs("header",{className:"flex flex-col sm:flex-row justify-between items-center gap-4 mb-4 flex-shrink-0 relative z-50 font-mono",children:[c.jsx(os,{isOpen:Q,onClose:()=>q(!1),onConfirm:()=>q(!1),title:"DNG Converter Missing",confirmText:"OK",cancelText:"Cancel",message:c.jsxs("div",{className:"flex flex-col gap-4",children:[c.jsx("p",{className:"font-bold text-red-600 dark:text-red-400 text-base",children:"JiangBridge Offline or Adobe DNG Converter not installed"}),c.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"To use the conversion feature, you must run JiangBridge locally and have Adobe DNG Converter installed on your system."})]})}),c.jsxs("div",{className:"flex items-center gap-4",children:[c.jsx("h1",{className:"text-xl sm:text-2xl font-bold text-black dark:text-white text-center sm:text-left tracking-tight border-2 border-black dark:border-white px-2 py-1 bg-white dark:bg-black",children:"Jiangtherapee_Online"}),c.jsx("p",{className:"text-sm text-gray-600 dark:text-slate-400 hidden lg:block max-w-xs truncate font-bold",title:r||"No image loaded",children:r||"No_Image_Loaded"}),B&&c.jsx("span",{className:"bg-red-100 text-red-700 dark:bg-red-900/30 dark:text-red-400 border-2 border-red-500 dark:border-red-800 text-[10px] font-bold px-2 py-1 animate-pulse",children:" 3-PLANE / RGB MODE"})]}),c.jsxs("div",{className:"flex items-center gap-4 flex-wrap justify-end",children:[c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsxs("button",{onClick:b.isConnected?void 0:k,className:`px-3 py-1.5 text-xs font-bold transition-all duration-200 flex items-center gap-1.5 shadow-[2px_2px_0px_black] border-2 border-black dark:border-gray-500 ${b.isConnected?"bg-emerald-100 text-emerald-900 border-emerald-800 dark:bg-emerald-900/30 dark:text-emerald-400 dark:border-emerald-600 cursor-default":"bg-pink-100 text-pink-900 border-pink-800 dark:bg-pink-900/30 dark:text-pink-400 dark:border-pink-600 hover:bg-pink-200 dark:hover:bg-pink-900/50 cursor-pointer animate-pulse"}`,title:b.isConnected?"Local Bridge Service Connected":"Click to download Jiangbridge",children:[c.jsx("span",{className:`w-2 h-2 ${b.isConnected?"bg-emerald-600":"bg-pink-600"}`}),b.isConnected?`JiangBridge Ready ${b.hasDngConverter?"DNG+":""}`:"JiangBridge Offline"]}),x&&c.jsxs("button",{onClick:y,className:"px-3 py-1.5 text-xs font-bold transition-all duration-200 flex items-center gap-1.5 shadow-[2px_2px_0px_black] border-2 border-indigo-800 bg-indigo-100 text-indigo-900 dark:bg-indigo-900/30 dark:text-indigo-400 dark:border-indigo-600 hover:bg-indigo-200 dark:hover:bg-indigo-900/50 cursor-pointer animate-in fade-in",title:"Click to turn off DR Lab",children:[c.jsx("span",{className:"w-2 h-2 bg-indigo-600 animate-pulse"}),"DR Lab On"]}),w&&c.jsxs("button",{onClick:_,className:"px-3 py-1.5 text-xs font-bold transition-all duration-200 flex items-center gap-1.5 shadow-[2px_2px_0px_black] border-2 border-yellow-800 bg-yellow-100 text-yellow-900 dark:bg-yellow-900/30 dark:text-yellow-400 dark:border-yellow-600 hover:bg-yellow-200 dark:hover:bg-yellow-900/50 cursor-pointer animate-in fade-in",title:"Click to turn off Color Lab",children:[c.jsx("span",{className:"w-2 h-2 bg-yellow-500 animate-pulse"}),"Color Lab On"]}),S&&c.jsxs("button",{onClick:j,className:"px-3 py-1.5 text-xs font-bold transition-all duration-200 flex items-center gap-1.5 shadow-[2px_2px_0px_black] border-2 border-fuchsia-800 bg-fuchsia-100 text-fuchsia-900 dark:bg-fuchsia-900/30 dark:text-fuchsia-400 dark:border-fuchsia-600 hover:bg-fuchsia-200 dark:hover:bg-fuchsia-900/50 cursor-pointer animate-in fade-in",title:"Click to turn off FFT Lab",children:[c.jsx("span",{className:"w-2 h-2 bg-fuchsia-600 animate-pulse"}),"FFT Lab On"]}),M&&c.jsxs("button",{onClick:A,className:"px-3 py-1.5 text-xs font-bold transition-all duration-200 flex items-center gap-1.5 shadow-[2px_2px_0px_black] border-2 border-orange-800 bg-orange-100 text-orange-900 dark:bg-orange-900/30 dark:text-orange-400 dark:border-orange-600 hover:bg-orange-200 dark:hover:bg-orange-900/50 cursor-pointer animate-in fade-in",title:"Click to turn off SFR Lab",children:[c.jsx("span",{className:"w-2 h-2 bg-orange-600 animate-pulse"}),"SFR Lab On"]}),I&&c.jsxs("button",{onClick:F,className:"px-3 py-1.5 text-xs font-bold transition-all duration-200 flex items-center gap-1.5 shadow-[2px_2px_0px_black] border-2 border-teal-800 bg-teal-100 text-teal-900 dark:bg-teal-900/30 dark:text-teal-400 dark:border-teal-600 hover:bg-teal-200 dark:hover:bg-teal-900/50 cursor-pointer animate-in fade-in",title:"Click to turn off PS Mode",children:[c.jsx("span",{className:"w-2 h-2 bg-teal-500 animate-pulse"}),"PS Mode On"]})]}),c.jsx("input",{type:"file",ref:H,onChange:le,className:"hidden",accept:".arw,.cr2,.cr3,.dng,.nef,.orf,.raf,.rw2,.pef,.srw,.sr2,.srf,.x3f,.erf,.mef,.mos,.mrw,.kdc,.dcr,.iiq,.3fr,.fff,.rwl,.nrw,.raw,.tif,.tiff"}),c.jsx("input",{type:"file",ref:W,onChange:je,className:"hidden",multiple:!0,accept:".csv"}),c.jsxs("div",{className:"relative inline-block text-left",ref:se,children:[c.jsxs("button",{onClick:()=>oe(!fe),className:"bg-purple-700 hover:bg-purple-600 text-white font-bold py-2 px-4 border-2 border-black dark:border-white shadow-[4px_4px_0px_black] dark:shadow-[4px_4px_0px_gray] active:translate-x-[2px] active:translate-y-[2px] active:shadow-[2px_2px_0px_black] transition-all duration-100 text-sm whitespace-nowrap flex items-center gap-2",children:["TOOLS",c.jsx("svg",{className:`w-4 h-4 transition-transform duration-200 ${fe?"rotate-180":""}`,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),fe&&c.jsx("div",{className:"absolute right-0 mt-2 w-56 bg-white dark:bg-slate-800 shadow-[8px_8px_0px_rgba(0,0,0,0.5)] ring-1 ring-black ring-opacity-5 focus:outline-none z-50 overflow-hidden origin-top-right transition-all animate-in fade-in slide-in-from-top-2 border-2 border-black dark:border-gray-500",children:c.jsxs("div",{className:"py-1",children:[c.jsxs("button",{onClick:()=>{oe(!1),F&&!I&&F(),x&&y(),S&&j(),w&&_&&_(),M&&A&&A()},className:`w-full text-left px-4 py-3 text-sm transition-colors flex items-center gap-2 border-b border-gray-300 dark:border-gray-600 ${I?"bg-teal-100 dark:bg-teal-900/40 text-teal-800 dark:text-teal-300 font-bold":"text-gray-800 dark:text-slate-200 hover:bg-gray-200 dark:hover:bg-slate-700"}`,children:[c.jsx("svg",{className:"w-4 h-4 text-teal-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 6V4m0 2a2 2 0 100 4m0-4a2 2 0 110 4m-6 8a2 2 0 100-4m0 4a2 2 0 110-4m0 4v2m0-6V4m6 6v10m6-2a2 2 0 100-4m0 4a2 2 0 110-4m0 4v2m0-6V4"})}),c.jsxs("span",{children:["PS Mode ",I?"(On)":""]})]}),c.jsxs("button",{onClick:()=>{oe(!1),x||y(),S&&j(),w&&_&&_(),M&&A&&A(),I&&F()},className:`w-full text-left px-4 py-3 text-sm transition-colors flex items-center gap-2 border-b border-gray-300 dark:border-gray-600 ${x?"bg-indigo-100 dark:bg-indigo-900/40 text-indigo-800 dark:text-indigo-300 font-bold":"text-gray-800 dark:text-slate-200 hover:bg-gray-200 dark:hover:bg-slate-700"}`,children:[c.jsx("svg",{className:"w-4 h-4 text-indigo-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19.428 15.428a2 2 0 00-1.022-.547l-2.384-.477a6 6 0 00-3.86.517l-.318.158a6 6 0 01-3.86.517L6.05 15.21a2 2 0 00-1.806.547M8 4h8l-1 1v5.172a2 2 0 00.586 1.414l5 5c1.26 1.26.367 3.414-1.415 3.414H4.828c-1.782 0-2.674-2.154-1.414-3.414l5-5A2 2 0 009 10.172V5L8 4z"})}),c.jsxs("span",{children:["DR Lab ",x?"(On)":""]})]}),c.jsxs("button",{onClick:()=>{oe(!1),_&&!w&&_(),x&&y(),S&&j(),M&&A&&A(),I&&F()},className:`w-full text-left px-4 py-3 text-sm transition-colors flex items-center gap-2 border-b border-gray-300 dark:border-gray-600 ${w?"bg-yellow-100 dark:bg-yellow-900/40 text-yellow-800 dark:text-yellow-300 font-bold":"text-gray-800 dark:text-slate-200 hover:bg-gray-200 dark:hover:bg-slate-700"}`,children:[c.jsx("svg",{className:"w-4 h-4 text-yellow-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M7 21a4 4 0 01-4-4V5a2 2 0 012-2h4a2 2 0 012 2v12a4 4 0 01-4 4zm0 0h12a2 2 0 002-2v-4a2 2 0 00-2-2h-2.343M11 7.343l1.657-1.657a2 2 0 012.828 0l2.829 2.829a2 2 0 010 2.828l-8.486 8.485M7 17h.01"})}),c.jsxs("span",{children:["Color Lab ",w?"(On)":""]})]}),c.jsxs("button",{onClick:()=>{oe(!1),A&&!M&&A(),x&&y(),S&&j(),w&&_&&_(),I&&F()},className:`w-full text-left px-4 py-3 text-sm transition-colors flex items-center gap-2 border-b border-gray-300 dark:border-gray-600 ${M?"bg-orange-100 dark:bg-orange-900/40 text-orange-800 dark:text-orange-300 font-bold":"text-gray-800 dark:text-slate-200 hover:bg-gray-200 dark:hover:bg-slate-700"}`,children:[c.jsx("svg",{className:"w-4 h-4 text-orange-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 10V3L4 14h7v7l9-11h-7z"})}),c.jsxs("span",{children:["SFR Lab ",M?"(On)":""]})]}),c.jsxs("button",{onClick:()=>{oe(!1),S||j(),x&&y(),w&&_&&_(),M&&A&&A(),I&&F()},className:`w-full text-left px-4 py-3 text-sm transition-colors flex items-center gap-2 border-b border-gray-300 dark:border-gray-600 ${S?"bg-fuchsia-100 dark:bg-fuchsia-900/40 text-fuchsia-800 dark:text-fuchsia-300 font-bold":"text-gray-800 dark:text-slate-200 hover:bg-gray-200 dark:hover:bg-slate-700"}`,children:[c.jsx("svg",{className:"w-4 h-4 text-fuchsia-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2m0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"})}),c.jsxs("span",{children:["Stack Lab ",S?"(On)":""]})]}),c.jsx("div",{className:"border-t border-gray-300 dark:border-gray-600 my-1"}),c.jsxs("button",{onClick:()=>{oe(!1),D==null||D()},className:"w-full text-left px-4 py-2 text-sm text-red-600 dark:text-red-400 hover:bg-gray-200 dark:hover:bg-slate-700 transition-colors flex items-center gap-2",children:[c.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})}),c.jsx("span",{children:" Z8 (Save Z8)"})]}),c.jsxs("button",{onClick:()=>{oe(!1),t()},className:"w-full text-left px-4 py-2 text-sm text-gray-800 dark:text-slate-200 hover:bg-gray-200 dark:hover:bg-slate-700 transition-colors flex items-center gap-2",children:[c.jsx("svg",{className:"w-4 h-4 text-purple-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"})}),c.jsx("span",{children:"Generate Pattern DNG"})]}),c.jsxs("button",{onClick:()=>{var ke;oe(!1),(ke=W.current)==null||ke.click()},className:"w-full text-left px-4 py-2 text-sm text-gray-800 dark:text-slate-200 hover:bg-gray-200 dark:hover:bg-slate-700 transition-colors flex items-center gap-2",children:[c.jsx("svg",{className:"w-4 h-4 text-emerald-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M7 12l3-3 3 3 4-4M8 21l4-4 4 4M3 4h18M4 4h16v12a1 1 0 01-1 1H5a1 1 0 01-1-1V4z"})}),c.jsx("span",{children:"Generate PTC"})]}),c.jsxs("button",{onClick:()=>{oe(!1),window.open("https://y-g-jiang.github.io/CP.html","_blank")},className:"w-full text-left px-4 py-2 text-sm text-gray-800 dark:text-slate-200 hover:bg-gray-200 dark:hover:bg-slate-700 transition-colors flex items-center gap-2",children:[c.jsx("svg",{className:"w-4 h-4 text-teal-500",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2m0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"})}),c.jsx("span",{children:"Generate MTF Contour"})]})]})})]}),c.jsxs("div",{className:"relative inline-block text-left",ref:X,children:[c.jsxs("button",{onClick:()=>ee(!re),className:"bg-cyan-700 hover:bg-cyan-600 text-white font-bold py-2 px-4 border-2 border-black dark:border-white shadow-[4px_4px_0px_black] dark:shadow-[4px_4px_0px_gray] active:translate-x-[2px] active:translate-y-[2px] active:shadow-[2px_2px_0px_black] transition-all duration-100 text-sm whitespace-nowrap flex items-center gap-2",children:["Load Image",c.jsx("svg",{className:`w-4 h-4 transition-transform duration-200 ${re?"rotate-180":""}`,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),re&&c.jsx("div",{className:"absolute right-0 mt-2 w-56 bg-white dark:bg-slate-800 shadow-[8px_8px_0px_rgba(0,0,0,0.5)] ring-1 ring-black ring-opacity-5 focus:outline-none z-50 overflow-hidden origin-top-right transition-all animate-in fade-in slide-in-from-top-2 border-2 border-black dark:border-gray-500",children:c.jsxs("div",{className:"py-1",children:[c.jsxs("button",{onClick:()=>he("direct"),className:"w-full text-left px-4 py-3 text-sm text-gray-800 dark:text-slate-200 hover:bg-gray-200 dark:hover:bg-slate-700 transition-colors flex items-center gap-2 border-b border-gray-300 dark:border-gray-600",children:[c.jsx("svg",{className:"w-4 h-4 text-cyan-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-8l-4-4m0 0L8 8m4-4v12"})}),c.jsx("span",{children:"Load Image (Direct)"})]}),c.jsxs("button",{onClick:()=>he("convert"),className:"w-full text-left px-4 py-3 text-sm text-gray-800 dark:text-slate-200 hover:bg-gray-200 dark:hover:bg-slate-700 transition-colors flex items-center gap-2",children:[c.jsx("svg",{className:"w-4 h-4 text-purple-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19.428 15.428a2 2 0 00-1.022-.547l-2.384-.477a6 6 0 00-3.86.517l-.318.158a6 6 0 01-3.86.517L6.05 15.21a2 2 0 00-1.806.547M8 4h8l-1 1v5.172a2 2 0 00.586 1.414l5 5c1.26 1.26.367 3.414-1.415 3.414H4.828c-1.782 0-2.674-2.154-1.414-3.414l5-5A2 2 0 009 10.172V5L8 4z"})}),c.jsx("span",{children:"Convert to Adobe DNG & Load"})]})]})})]}),r&&v&&c.jsxs("button",{onClick:v,className:"bg-orange-600 hover:bg-orange-500 text-white font-bold py-2 px-4 border-2 border-black dark:border-white shadow-[4px_4px_0px_black] dark:shadow-[4px_4px_0px_gray] active:translate-x-[2px] active:translate-y-[2px] active:shadow-[2px_2px_0px_black] transition-all duration-100 text-sm whitespace-nowrap flex items-center gap-1",title:"View EXIF Data",children:[c.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),"EXIF"]}),c.jsx("button",{onClick:m,className:"bg-teal-700 hover:bg-teal-600 text-white font-bold py-2 px-4 border-2 border-black dark:border-white shadow-[4px_4px_0px_black] dark:shadow-[4px_4px_0px_gray] active:translate-x-[2px] active:translate-y-[2px] active:shadow-[2px_2px_0px_black] transition-all duration-100 text-sm whitespace-nowrap",children:"About/Tutorial/Tools"}),c.jsx("a",{href:"https://y-g-jiang.github.io/index.html",target:"_blank",rel:"noopener noreferrer",className:"bg-gray-300 hover:bg-gray-200 dark:bg-slate-700 dark:hover:bg-slate-600 text-black dark:text-white font-bold py-2 px-4 border-2 border-black dark:border-white shadow-[4px_4px_0px_black] dark:shadow-[4px_4px_0px_gray] active:translate-x-[2px] active:translate-y-[2px] active:shadow-[2px_2px_0px_black] transition-all duration-100 text-sm no-underline",children:"Home"}),c.jsxs("button",{onClick:G,className:`bg-slate-700 hover:bg-slate-600 text-white font-bold py-2 px-3 border-2 border-black dark:border-white shadow-[4px_4px_0px_black] dark:shadow-[4px_4px_0px_gray] active:translate-x-[2px] active:translate-y-[2px] active:shadow-[2px_2px_0px_black] transition-all duration-100 text-sm whitespace-nowrap flex items-center gap-2 ${V?"":"ring-2 ring-cyan-500 ring-offset-2 dark:ring-offset-black"}`,title:V?"Hide Control Panel":"Show Control Panel",children:[c.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:V?c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 5l7 7-7 7M5 5l7 7-7 7"}):c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11 19l-7-7 7-7m8 14l-7-7 7-7"})}),c.jsx("span",{className:"hidden sm:inline",children:V?"Hide Panel":"Show Panel"})]})]})]})},g6=({image:e,zoom:t,pan:r,onPanChange:n,onZoomChange:a,onSelectionChange:i,forcedSelection:o,theme:s,touchAction:l="pan",isMarking:u=!1,onPointClick:f,markers:d=[],gridRects:p=[],colorLabPoints:m=[],colorLabRects:v=[],sfrRects:b=[]})=>{var oe;const k=C.useRef(null),x=C.useRef(document.createElement("canvas")),[y,w]=C.useState(!1),[_,S]=C.useState({x:0,y:0}),j=C.useRef(null),M=C.useRef(null),A=C.useRef(null),[$,E]=C.useState(!1),[T,B]=C.useState(null),[U,V]=C.useState(null);C.useEffect(()=>{o!==void 0&&V(o)},[o]);const G=C.useCallback(()=>{const ye=k.current,ae=ye==null?void 0:ye.getContext("2d");return{canvas:ye,ctx:ae}},[]);C.useEffect(()=>{const ye=x.current,ae=ye.getContext("2d");if(!e||!ae)return;let X=0,se=0;e instanceof ImageData?(X=e.width,se=e.height):e instanceof HTMLImageElement&&(X=e.naturalWidth,se=e.naturalHeight),!(X===0||se===0)&&((ye.width!==X||ye.height!==se)&&(ye.width=X,ye.height=se),e instanceof ImageData?ae.putImageData(e,0,0):(ae.clearRect(0,0,X,se),ae.drawImage(e,0,0)))},[e]);const D=C.useCallback(()=>{const{canvas:ye,ctx:ae}=G();if(!(!ye||!ae||!e)){if(ae.setTransform(1,0,0,1,0,0),ae.fillStyle=s==="dark"?"rgb(15, 23, 42)":"rgb(243, 244, 246)",ae.fillRect(0,0,ye.width,ye.height),ae.setTransform(t,0,0,t,r.x,r.y),x.current.width>0&&(ae.imageSmoothingEnabled=!1,ae.drawImage(x.current,0,0)),U){ae.strokeStyle="#06b6d4",ae.lineWidth=1/t,ae.fillStyle="rgba(6, 182, 212, 0.2)",ae.beginPath(),ae.rect(U.x,U.y,U.w,U.h),ae.fill(),ae.stroke(),ae.save(),ae.fillStyle="#fff";const X=Math.max(10,14/t);ae.font=`${X}px monospace`,ae.shadowColor="rgba(0,0,0,0.8)",ae.shadowBlur=4,ae.shadowOffsetX=1,ae.shadowOffsetY=1,ae.fillText(`${Math.round(U.w)}x${Math.round(U.h)}`,U.x,U.y-5/t),ae.restore()}if(p&&p.length>0){ae.save(),ae.strokeStyle="#f59e0b",ae.lineWidth=1/t,ae.globalAlpha=.8,ae.beginPath(),p.forEach(he=>{ae.rect(he.x,he.y,he.w,he.h)}),ae.stroke();const X=p[0];ae.fillStyle="#f59e0b";const se=Math.max(10,12/t);ae.font=`${se}px monospace`,ae.fillText(`${Math.round(X.w)}x${Math.round(X.h)}`,X.x,X.y-4/t),ae.restore()}if(d&&d.length>0){ae.save();const X=6/t,se=Math.max(12,16/t);ae.font=`bold ${se}px sans-serif`,ae.textAlign="center",ae.textBaseline="middle",d.forEach((he,le)=>{ae.beginPath(),ae.arc(he.x,he.y,X,0,2*Math.PI),ae.fillStyle="white",ae.fill(),ae.strokeStyle="#4338ca",ae.lineWidth=2/t,ae.stroke(),ae.fillStyle="#4338ca",ae.fillText((le+1).toString(),he.x,he.y-12/t)}),ae.restore()}if(m&&m.length>0){ae.save();const X=5/t,se=Math.max(10,14/t);ae.font=`bold ${se}px sans-serif`,ae.textAlign="center",ae.textBaseline="middle",m.forEach((he,le)=>{ae.fillStyle="yellow",ae.fillRect(he.x-X,he.y-X,X*2,X*2),ae.strokeStyle="black",ae.lineWidth=1/t,ae.strokeRect(he.x-X,he.y-X,X*2,X*2),ae.fillStyle="yellow",ae.shadowColor="black",ae.shadowBlur=2,ae.fillText((le+1).toString(),he.x,he.y-10/t)}),ae.restore()}if(v&&v.length>0){if(ae.save(),ae.strokeStyle="yellow",ae.lineWidth=1/t,ae.globalAlpha=.9,ae.beginPath(),v.forEach(X=>{ae.rect(X.x,X.y,X.w,X.h)}),ae.stroke(),v[0]){const X=v[0];ae.fillStyle="yellow",ae.shadowColor="black",ae.shadowBlur=3;const se=Math.max(10,12/t);ae.font=`${se}px monospace`,ae.fillText(`${Math.round(X.w)}x${Math.round(X.h)}`,X.x,X.y-4/t)}ae.restore()}b&&b.length>0&&(ae.save(),ae.strokeStyle="#ef4444",ae.lineWidth=2/t,ae.globalAlpha=.9,ae.beginPath(),b.forEach(X=>{ae.rect(X.x,X.y,X.w,X.h)}),ae.stroke(),ae.restore())}},[G,e,t,r,s,U,p,d,m,v,b]);C.useEffect(()=>{const{canvas:ye}=G();if(!ye)return;const ae=new ResizeObserver(()=>{ye.width=ye.clientWidth,ye.height=ye.clientHeight,D()});return ae.observe(ye),()=>ae.disconnect()},[G,D]),C.useEffect(()=>{D()},[D,e,r,t,s,U,p,d,m,v,b]);const I=ye=>{const{canvas:ae}=G();if(!ae)return{x:0,y:0};const X=ae.getBoundingClientRect();return{x:ye.clientX-X.left,y:ye.clientY-X.top}},F=(ye,ae)=>({x:(ye-r.x)/t,y:(ae-r.y)/t}),H=ye=>{ye.preventDefault();const ae=I(ye);if(u&&f){const X=F(ae.x,ae.y);f(X);return}if(l==="select"||ye.shiftKey){E(!0);const X=F(ae.x,ae.y),se={x:Math.floor(X.x),y:Math.floor(X.y)};B(se),V(null),i&&i(null)}else w(!0),S({x:ae.x-r.x,y:ae.y-r.y})},W=ye=>{const ae=I(ye);if($&&T){const X=F(ae.x,ae.y),se=Math.floor(X.x),he=Math.floor(X.y),le=Math.min(T.x,se),je=Math.min(T.y,he),ke=Math.max(T.x,se),ve=Math.max(T.y,he),ge=ke-le+1,Me=ve-je+1;V({x:le,y:je,w:ge,h:Me})}else y&&n({x:ae.x-_.x,y:ae.y-_.y})},Q=()=>{$&&(E(!1),U&&i&&U.w>0&&U.h>0&&i(U)),w(!1)},q=ye=>{var ae;if(ye.touches.length===1){const X=ye.touches[0],se=(ae=k.current)==null?void 0:ae.getBoundingClientRect();if(!se)return;const he=X.clientX-se.left,le=X.clientY-se.top;if(u&&f){const je=F(he,le);f(je);return}if(l==="select"){const je=F(he,le),ke={x:Math.floor(je.x),y:Math.floor(je.y)};B(ke),E(!0),V(null),i&&i(null)}else A.current={x:he,y:le},S({x:he-r.x,y:le-r.y}),w(!0)}else if(ye.touches.length===2){const X=Math.hypot(ye.touches[0].clientX-ye.touches[1].clientX,ye.touches[0].clientY-ye.touches[1].clientY);j.current=X,M.current=t,w(!1),E(!1)}},re=ye=>{var ae;if(ye.touches.length===1){const X=ye.touches[0],se=(ae=k.current)==null?void 0:ae.getBoundingClientRect();if(!se)return;const he=X.clientX-se.left,le=X.clientY-se.top;if(u)return;if($&&T){const je=F(he,le),ke=Math.floor(je.x),ve=Math.floor(je.y),ge=Math.min(T.x,ke),Me=Math.min(T.y,ve),Oe=Math.max(T.x,ke),We=Math.max(T.y,ve),Le=Oe-ge+1,tt=We-Me+1;V({x:ge,y:Me,w:Le,h:tt})}else y&&n({x:he-_.x,y:le-_.y})}else if(ye.touches.length===2&&j.current&&M.current&&a){const se=Math.hypot(ye.touches[0].clientX-ye.touches[1].clientX,ye.touches[0].clientY-ye.touches[1].clientY)/j.current;a(M.current*se)}},ee=()=>{$&&(E(!1),U&&i&&U.w>0&&U.h>0&&i(U)),w(!1),j.current=null,M.current=null,A.current=null},fe=u||l==="select"||(oe=window.event)!=null&&oe.shiftKey?"cursor-crosshair":"cursor-grab active:cursor-grabbing";return c.jsx("canvas",{ref:k,className:`w-full h-full block touch-none ${fe}`,onMouseDown:H,onMouseMove:W,onMouseUp:Q,onMouseLeave:Q,onTouchStart:q,onTouchMove:re,onTouchEnd:ee,onTouchCancel:ee,tabIndex:0})},hc={"Canon EOS R5":"0.9766 -0.2953 -0.1254 -0.4276 1.2116 0.2433 -0.0437 0.1336 0.5131","Canon EOS 7D Mark II":"0.7268 -0.1082 -0.0969 -0.4186 1.1839 0.2663 -0.0825 0.2029 0.5839","Canon EOS R3":"0.9423 -0.2839 -0.1195 -0.4532 1.2377 0.2415 -0.0483 0.1374 0.5276","Canon EOS 5D Mark III":"0.6722 -0.0635 -0.0963 -0.4287 1.246 0.2028 -0.0908 0.2162 0.5668","Canon EOS 5DS R":"0.625 -0.0711 -0.0808 -0.5153 1.2794 0.2636 -0.1249 0.2198 0.561","Canon EOS R6":"0.8293 -0.1611 -0.1132 -0.4759 1.2711 0.2275 -0.1013 0.2415 0.5509","Samsung NX U":"0.7557 -0.2522 -0.0739 -0.4679 1.2949 0.1894 -0.084 0.1777 0.5311","Canon EOS R5 Mark II":"0.9396 -0.2598 -0.1207 -0.4408 1.2296 0.2369 -0.0505 0.1575 0.6077","Canon EOS 5DS":"0.625 -0.0711 -0.0808 -0.5153 1.2794 0.2636 -0.1249 0.2198 0.561","Canon EOS R":"0.8293 -0.1789 -0.1094 -0.5025 1.2925 0.2327 -0.1199 0.2769 0.6108","Canon EOS R6 Mark II":"0.9539 -0.2795 -0.1224 -0.4175 1.1998 0.2458 -0.0465 0.1755 0.6048","Canon EOS R7":"1.0424 -0.3138 -0.13 -0.4221 1.1938 0.2584 -0.0547 0.1658 0.6183","Canon EOS 5D Mark IV":"0.6446 -0.0366 -0.0864 -0.4436 1.2204 0.2513 -0.0952 0.2496 0.6348","Canon EOS-1D X Mark III":"0.8971 -0.2022 -0.1242 -0.5405 1.3249 0.238 -0.128 0.2483 0.6072","Sony ILCE-7M3":"0.7374 -0.2389 -0.0551 -0.5435 1.3162 0.2519 -0.1006 0.1795 0.6552","Hasselblad 50-15-Coated5":"0.5002 -0.0878 0.0111 -0.4856 1.1929 0.3338 -0.1183 0.2041 0.7022","Canon EOS-1D X":"0.6847 -0.0614 -0.1014 -0.4669 1.2737 0.2139 -0.1197 0.2488 0.6846","Fujifilm GFX 100":"1.6212 -0.8423 -0.1583 -0.4336 1.2583 0.1937 -0.0195 0.0726 0.6199","Phase One IQ180":"0.6294 0.0686 -0.0712 -0.5435 1.3417 0.2211 -0.1006 0.2435 0.5042","Phase One IQ3 100MP":"0.2423 0 0 0 0.9901 0 0 0 0.7989","Canon EOS-1D X Mark II":"0.7596 -0.0978 -0.0967 -0.4808 1.2571 0.2503 -0.1398 0.2567 0.5752","Canon PowerShot Pro70":"-0.5106 1.0695 0.1576 0.382 0.0053 0.4566 -0.6497 1.0736 0.6701 -0.3336 1.1887 0.1394","Sony ILCE-9":"0.6389 -0.1703 -0.0378 -0.4562 1.2265 0.2587 -0.067 0.1489 0.655","Sony ILCE-7CR":"0.82 -0.2976 -0.0719 -0.4296 1.2053 0.2532 -0.0429 0.1282 0.5774","Sony ILCE-7S":"0.5838 -0.143 -0.0246 -0.3497 1.1477 0.2297 -0.0748 0.1885 0.5778","Sony ILCE-7RM3":"0.664 -0.1847 -0.0503 -0.5238 1.301 0.2474 -0.0993 0.1673 0.6527","Sony DSC-RX1RM3":"0.9034 -0.349 -0.0777 -0.4004 1.1841 0.2448 -0.0484 0.1352 0.5552","Sony ILCE-6100":"0.7657 -0.2847 -0.0607 -0.4083 1.1966 0.2389 -0.0684 0.1418 0.5844","Sony ILCE-7RM2":"0.6629 -0.19 -0.0483 -0.4618 1.2349 0.255 -0.0622 0.1381 0.6514","Sony ILCE-5100":"0.5991 -0.1456 -0.0455 -0.4764 1.2135 0.298 -0.0707 0.1425 0.6701","Sony ILCE-7M2":"0.5271 -0.0712 -0.0347 -0.6153 1.3653 0.2763 -0.1601 0.2366 0.7242","Sony ILCE-7RM5":"0.82 -0.2976 -0.0719 -0.4296 1.2053 0.2532 -0.0429 0.1282 0.5774","Sony ILCA-77M2":"0.5991 -0.1732 -0.0443 -0.41 1.1989 0.2381 -0.0704 0.1467 0.5992","Sony ZV-1M2":"0.828 -0.2987 -0.0703 -0.3531 1.1645 0.2133 -0.055 0.1542 0.5312","Sony ILCE-7SM2":"0.5838 -0.143 -0.0246 -0.3497 1.1477 0.2297 -0.0748 0.1885 0.5778","Sony DSC-RX100M7":"1.0315 -0.439 -0.0937 -0.4859 1.2734 0.2365 -0.0734 0.1537 0.5997","Sony ILCE-6300":"0.5973 -0.1695 -0.0419 -0.3826 1.1797 0.2293 -0.0639 0.1398 0.5789","Sony ILCA-99M2":"0.666 -0.1918 -0.0471 -0.4613 1.2398 0.2485 -0.0649 0.1433 0.6447","Sony ILCE-9M3":"0.9811 -0.3908 -0.0752 -0.3704 1.1577 0.2417 -0.0073 0.095 0.598","Sony ILCE-9M2":"0.6389 -0.1703 -0.0378 -0.4562 1.2265 0.2587 -0.067 0.1489 0.655","Sony DSC-RX100M6":"0.7325 -0.2321 -0.0596 -0.3494 1.1674 0.2055 -0.0668 0.1562 0.5031","Sony ZV-E10M2":"0.6972 -0.2408 -0.06 -0.433 1.2101 0.2515 -0.0388 0.1277 0.5847","Sony DSC-RX100M4":"0.6596 -0.2079 -0.0562 -0.4782 1.3016 0.1933 -0.097 0.1581 0.5181","Sony ILCE-7SM3":"0.6912 -0.2127 -0.0469 -0.447 1.2175 0.2587 -0.0398 0.1478 0.6492","Sony ILCE-7":"0.5271 -0.0712 -0.0347 -0.6153 1.3653 0.2763 -0.1601 0.2366 0.7242","Sony ILCE-6000":"0.5991 -0.1456 -0.0455 -0.4764 1.2135 0.298 -0.0707 0.1425 0.6701","Sony ILCE-1":"0.8161 -0.2947 -0.0739 -0.4811 1.2668 0.2389 -0.0437 0.1229 0.6524","Sony ILCE-7M4":"0.746 -0.2365 -0.0588 -0.5687 1.3442 0.2474 -0.0624 0.1156 0.6584","Sony ILCE-7R":"0.4913 -0.0541 -0.0202 -0.613 1.3513 0.2906 -0.1564 0.2151 0.7183","Fujifilm X100VI":"1.1809 -0.5358 -0.1141 -0.4248 1.2164 0.2343 -0.0514 0.1097 0.5848","Fujifilm X-H2":"1.1809 -0.5358 -0.1141 -0.4248 1.2164 0.2343 -0.0514 0.1097 0.5848","Fujifilm X-A3":"1.2407 -0.5222 -0.1086 -0.2971 1.1116 0.212 -0.0294 0.1029 0.5284","Fujifilm X-H2S":"1.2836 -0.5909 -0.1032 -0.3087 1.1132 0.2236 -0.0035 0.0872 0.533","Fujifilm X-Pro3":"1.3426 -0.6334 -0.1177 -0.4244 1.2136 0.2371 -0.058 0.1303 0.598","Fujifilm X-T50":"1.1809 -0.5358 -0.1141 -0.4248 1.2164 0.2343 -0.0514 0.1097 0.5848","Fujifilm X-T2":"1.1434 -0.4948 -0.121 -0.3746 1.2042 0.1903 -0.0666 0.1479 0.5235","Fujifilm X-T5":"1.1809 -0.5358 -0.1141 -0.4248 1.2164 0.2343 -0.0514 0.1097 0.5848","Fujifilm X-Pro2":"1.1434 -0.4948 -0.121 -0.3746 1.2042 0.1903 -0.0666 0.1479 0.5235","Fujifilm X-A7":"1.5055 -0.7391 -0.1274 -0.4062 1.2071 0.2238 -0.061 0.1217 0.6147","Fujifilm X-H1":"1.1434 -0.4948 -0.121 -0.3746 1.2042 0.1903 -0.0666 0.1479 0.5235","Fujifilm X-S20":"1.2836 -0.5909 -0.1032 -0.3087 1.1132 0.2236 -0.0035 0.0872 0.533","Fujifilm X-S10":"1.3426 -0.6334 -0.1177 -0.4244 1.2136 0.2371 -0.058 0.1303 0.598","Fujifilm X-T30":"1.3426 -0.6334 -0.1177 -0.4244 1.2136 0.2371 -0.058 0.1303 0.598","Fujifilm X30":"1.2328 -0.5256 -0.1144 -0.4469 1.2927 0.1675 -0.0087 0.1291 0.4351","Fujifilm GFX 50R":"1.1756 -0.4754 -0.0874 -0.3056 1.1045 0.2305 -0.0381 0.1457 0.6006","Fujifilm X100V":"1.3717 -0.649 -0.1154 -0.4348 1.2266 0.2335 -0.069 0.1286 0.6134","Fujifilm X-A5":"1.1673 -0.476 -0.1041 -0.3988 1.2058 0.2166 -0.0771 0.1417 0.5569","Fujifilm X100F":"1.1434 -0.4948 -0.121 -0.3746 1.2042 0.1903 -0.0666 0.1479 0.5235","Fujifilm X-T100":"1.1673 -0.476 -0.1041 -0.3988 1.2058 0.2166 -0.0771 0.1417 0.5569","Fujifilm XQ1":"0.9252 -0.2704 -0.1064 -0.5893 1.4265 0.1717 -0.1101 0.2341 0.4349","Fujifilm X-T4":"1.3426 -0.6334 -0.1177 -0.4244 1.2136 0.2371 -0.058 0.1303 0.598","Fujifilm X-E3":"1.1434 -0.4948 -0.121 -0.3746 1.2042 0.1903 -0.0666 0.1479 0.5235","Fujifilm X-T20":"1.1434 -0.4948 -0.121 -0.3746 1.2042 0.1903 -0.0666 0.1479 0.5235","Fujifilm X-A2":"1.0763 -0.456 -0.0917 -0.3346 1.1311 0.2322 -0.0475 0.1135 0.5843","Fujifilm GFX 50S":"1.1756 -0.4754 -0.0874 -0.3056 1.1045 0.2305 -0.0381 0.1457 0.6006","Fujifilm X-A1":"1.1086 -0.4555 -0.0839 -0.3512 1.131 0.2517 -0.0815 0.1341 0.594","Fujifilm X70":"1.045 -0.4329 -0.0878 -0.3217 1.1105 0.2421 -0.0752 0.1758 0.6519","Fujifilm FinePix S1":"1.2297 -0.4882 -0.1202 -0.2106 1.0691 0.1623 -0.0088 0.1312 0.479","Fujifilm XQ2":"0.9252 -0.2704 -0.1064 -0.5893 1.4265 0.1717 -0.1101 0.2341 0.4349","Fujifilm X-E2":"0.8458 -0.2451 -0.0855 -0.4597 1.2447 0.2407 -0.1475 0.2482 0.6526","Fujifilm GFX 100RF":"1.2806 -0.5779 -0.111 -0.3546 1.1507 0.2318 -0.0177 0.0996 0.5715","Fujifilm X-T10":"0.8458 -0.2451 -0.0855 -0.4597 1.2447 0.2407 -0.1475 0.2482 0.6526","Fujifilm X-E5":"1.1809 -0.5358 -0.1141 -0.4248 1.2164 0.2343 -0.0514 0.1097 0.5848","Fujifilm X100T":"1.0592 -0.4262 -0.1008 -0.3514 1.1355 0.2465 -0.087 0.2025 0.6386","Fujifilm X100S":"1.0592 -0.4262 -0.1008 -0.3514 1.1355 0.2465 -0.087 0.2025 0.6386","Fujifilm X-T3":"1.3426 -0.6334 -0.1177 -0.4244 1.2136 0.2371 -0.058 0.1303 0.598","Fujifilm X-M5":"1.2836 -0.5909 -0.1032 -0.3087 1.1132 0.2236 -0.0035 0.0872 0.533","Fujifilm X-M1":"1.0413 -0.3996 -0.0993 -0.3721 1.164 0.2361 -0.0733 0.154 0.6011","Fujifilm X-T1":"0.8458 -0.2451 -0.0855 -0.4597 1.2447 0.2407 -0.1475 0.2482 0.6526","Fujifilm X20":"1.1768 -0.4971 -0.1133 -0.4904 1.2927 0.2183 -0.048 0.1723 0.4605","Fujifilm GFX 50S II":"1.1756 -0.4754 -0.0874 -0.3056 1.1045 0.2305 -0.0381 0.1457 0.6006","Fujifilm X-Pro1":"1.0413 -0.3996 -0.0993 -0.3721 1.164 0.2361 -0.0733 0.154 0.6011","Fujifilm XF10":"1.1673 -0.476 -0.1041 -0.3988 1.2058 0.2166 -0.0771 0.1417 0.5569","Fujifilm X-E2S":"1.1562 -0.5118 -0.0961 -0.3022 1.1007 0.2311 -0.0525 0.1569 0.6097","Nikon Coolpix P330":"1.0321 -0.392 -0.0931 -0.275 1.1146 0.1824 -0.0442 0.1545 0.5539","Nikon Coolpix P1000":"1.4294 -0.6116 -0.1333 -0.1628 1.0219 0.1637 -0.0014 0.1158 0.5022","Nikon Coolpix P340":"1.0321 -0.392 -0.0931 -0.275 1.1146 0.1824 -0.0442 0.1545 0.5539","Nikon Coolpix P7800":"1.0321 -0.392 -0.0931 -0.275 1.1146 0.1824 -0.0442 0.1545 0.5539","Nikon Coolpix P7700":"1.0321 -0.392 -0.0931 -0.275 1.1146 0.1824 -0.0442 0.1545 0.5539","Nikon 1 S2":"0.6612 -0.1342 -0.0618 -0.3338 1.1055 0.2623 -0.0174 0.1792 0.5075","Nikon D3300":"0.6988 -0.1384 -0.0714 -0.5631 1.341 0.2447 -0.1485 0.2204 0.7318","Nikon D3200":"0.7013 -0.1408 -0.0635 -0.5268 1.2902 0.264 -0.147 0.2801 0.7379","Nikon Z 8":"1.1423 -0.4564 -0.1123 -0.4816 1.2895 0.2119 -0.021 0.1061 0.7282","Nikon D810A":"1.1973 -0.5685 -0.0888 -0.1965 1.0326 0.1901 -0.0115 0.1123 0.7169","Nikon D5500":"0.8821 -0.2938 -0.0785 -0.4178 1.2142 0.2287 -0.0824 0.1651 0.686","Nikon Z 6 3":"1.1206 -0.4286 -0.0941 -0.4879 1.2847 0.2251 -0.0745 0.1654 0.7374","Nikon D750":"0.902 -0.289 -0.0715 -0.4535 1.2436 0.2348 -0.0934 0.1919 0.7086","Nikon Z 6":"0.9943 -0.3269 -0.0839 -0.5323 1.3269 0.2259 -0.1198 0.2083 0.7557","Nikon D500":"0.8813 -0.321 -0.1036 -0.4703 1.2868 0.2021 -0.1054 0.194 0.6129","Nikon D3400":"0.6988 -0.1384 -0.0714 -0.5631 1.341 0.2447 -0.1485 0.2204 0.7318","Nikon D5300":"0.6988 -0.1384 -0.0714 -0.5631 1.341 0.2447 -0.1485 0.2204 0.7318","Nikon D5600":"0.8821 -0.2938 -0.0785 -0.4178 1.2142 0.2287 -0.0824 0.1651 0.686","Nikon D780":"0.9943 -0.3269 -0.0839 -0.5323 1.3269 0.2259 -0.1198 0.2083 0.7557","Nikon Z 6 2":"0.9943 -0.3269 -0.0839 -0.5323 1.3269 0.2259 -0.1198 0.2083 0.7557","Nikon D5":"0.92 -0.3522 -0.0992 -0.5755 1.3803 0.2117 -0.0753 0.1486 0.6338","Nikon 1 J4":"0.5958 -0.1559 -0.0571 -0.4021 1.1453 0.2939 -0.0634 0.1548 0.5087","Nikon D800":"0.7866 -0.2108 -0.0555 -0.4869 1.2483 0.2681 -0.1176 0.2069 0.7501","Nikon 1 S1":"0.8994 -0.2667 -0.0865 -0.4594 1.2324 0.2552 -0.0699 0.1786 0.626","Nikon D850":"1.0405 -0.3755 -0.127 -0.5461 1.3787 0.1793 -0.104 0.2015 0.6785","Nikon 1 J3":"0.6588 -0.1305 -0.0693 -0.3277 1.0987 0.2634 -0.0355 0.2016 0.5106","Nikon D7200":"0.8322 -0.3112 -0.1047 -0.6367 1.4342 0.2179 -0.0988 0.1638 0.6394","Nikon Z 5":"0.8695 -0.2558 -0.0648 -0.5015 1.2711 0.2575 -0.1279 0.2215 0.7514","Nikon Z 50":"1.164 -0.4829 -0.1079 -0.5107 1.3006 0.2325 -0.0972 0.1711 0.738","Nikon Z 7 2":"1.3705 -0.6004 -0.14 -0.5464 1.3568 0.2062 -0.094 0.1706 0.7618","Nikon 1 J5":"0.752 -0.2518 -0.0645 -0.3844 1.2102 0.1945 -0.0913 0.2249 0.6835","Nikon Z 5 2":"1.3133 -0.5542 -0.128 -0.4325 1.2543 0.1972 0.0034 0.0792 0.7662","Nikon Z fc":"1.164 -0.4829 -0.1079 -0.5107 1.3006 0.2325 -0.0972 0.1711 0.738","Nikon Z f":"1.1607 -0.4491 -0.0977 -0.4522 1.246 0.2304 -0.0458 0.1519 0.7616","Nikon D610":"0.8178 -0.2245 -0.0609 -0.4857 1.2394 0.2776 -0.1207 0.2086 0.7298","Nikon Z 7":"1.3705 -0.6004 -0.14 -0.5464 1.3568 0.2062 -0.094 0.1706 0.7618","Nikon Df":"0.8598 -0.2848 -0.0857 -0.5618 1.3606 0.2195 -0.1002 0.1773 0.7137","Nikon 1 V3":"0.5958 -0.1559 -0.0571 -0.4021 1.1453 0.2939 -0.0634 0.1548 0.5087","Nikon D7000":"0.8198 -0.2239 -0.0724 -0.4871 1.2389 0.2798 -0.1043 0.205 0.7181","Nikon Z 9":"1.3389 -0.6049 -0.1441 -0.4544 1.2757 0.1969 0.0229 0.0498 0.739","Nikon Z 50 2":"1.164 -0.4829 -0.1079 -0.5107 1.3006 0.2325 -0.0972 0.1711 0.738","Nikon D4S":"0.8598 -0.2848 -0.0857 -0.5618 1.3606 0.2195 -0.1002 0.1773 0.7137","Nikon D810":"0.9369 -0.3195 -0.0791 -0.4488 1.243 0.2301 -0.0893 0.1796 0.6872","Nikon D4":"0.8598 -0.2848 -0.0857 -0.5618 1.3606 0.2195 -0.1002 0.1773 0.7137","DXO ONE":"0.6596 -0.2079 -0.0562 -0.4782 1.3016 0.1933 -0.097 0.1581 0.5181","DXO-ONE":"0.6596 -0.2079 -0.0562 -0.4782 1.3016 0.1933 -0.097 0.1581 0.5181","Nikon D800E":"0.7866 -0.2108 -0.0555 -0.4869 1.2483 0.2681 -0.1176 0.2069 0.7501","ZEISS ZX1":"1 -0.4766 -0.0938 -0.2969 1.1328 0.1875 -0.0313 0.1094 0.7422","PENTAX K-50":"0.8628 -0.2607 -0.1156 -0.3995 1.2301 0.1881 -0.099 0.1735 0.6595","PENTAX K-500":"0.8513 -0.2572 -0.114 -0.3995 1.2301 0.1881 -0.1003 0.1758 0.6683","PENTAX K-3 II":"0.8571 -0.259 -0.1148 -0.3995 1.2301 0.1881 -0.1052 0.1844 0.7013","PENTAX K-S2":"0.8009 -0.2517 -0.114 -0.3882 1.235 0.1689 -0.0844 0.1493 0.6312","PENTAX K-3":"0.8761 -0.2648 -0.1173 -0.3995 1.2301 0.1881 -0.0901 0.1579 0.6001","PENTAX KP":"0.7357 -0.2031 -0.132 -0.4842 1.3555 0.1349 -0.1538 0.2416 0.5736","PENTAX MX-1":"0.8804 -0.2523 -0.1238 -0.2423 1.1627 0.086 -0.0682 0.1774 0.4753","PENTAX K-70":"0.8117 -0.2078 -0.1275 -0.4359 1.2953 0.1515 -0.1096 0.1965 0.6073","PENTAX K-3 Mark III":"0.6842 -0.1581 -0.0867 -0.4614 1.2728 0.2065 -0.0639 0.1428 0.5682","PENTAX 645Z":"0.9829 -0.31 -0.1271 -0.3685 1.2133 0.1721 -0.1068 0.1977 0.6854","PENTAX K-1":"0.8566 -0.2746 -0.1201 -0.3612 1.2204 0.155 -0.0893 0.168 0.6264","PENTAX Q7":"1.2995 -0.5593 -0.1107 -0.1879 1.0139 0.2027 -0.0064 0.1233 0.4919","Canon PowerShot SX60 HS":"1.3161 -0.5451 -0.1344 -0.1989 1.0654 0.1531 -0.0047 0.1271 0.4955","Canon PowerShot G15":"0.7474 -0.2301 -0.0567 -0.4056 1.1456 0.2975 -0.0222 0.0716 0.4181","Canon PowerShot G5 X Mark II":"1.1629 -0.5713 -0.0914 -0.2706 1.109 0.1842 -0.0206 0.1225 0.5515","Canon PowerShot G16":"0.802 -0.2687 -0.0682 -0.3704 1.1879 0.2052 -0.0965 0.1921 0.5556","Canon PowerShot S120":"0.6961 -0.1685 -0.0695 -0.4625 1.2945 0.1836 -0.1114 0.2152 0.5518","Canon PowerShot G1 X":"0.7378 -0.1255 -0.1043 -0.4088 1.2251 0.2048 -0.0876 0.1946 0.5805","Canon EOS M5":"0.8532 -0.0701 -0.1167 -0.4095 1.1879 0.2508 -0.0797 0.2424 0.701","Canon EOS M6":"0.8532 -0.0701 -0.1167 -0.4095 1.1879 0.2508 -0.0797 0.2424 0.701","Canon PowerShot G7 X":"0.9602 -0.3823 -0.0937 -0.2984 1.1495 0.1675 -0.0407 0.1415 0.5049","Canon PowerShot G7 X Mark II":"0.9602 -0.3823 -0.0937 -0.2984 1.1495 0.1675 -0.0407 0.1415 0.5049","Canon PowerShot G9 X":"0.9602 -0.3823 -0.0937 -0.2984 1.1495 0.1675 -0.0407 0.1415 0.5049","Canon PowerShot G3 X":"0.9701 -0.3857 -0.0921 -0.3149 1.1537 0.1817 -0.0786 0.1817 0.5147","Canon EOS 6D Mark II":"0.6875 -0.097 -0.0932 -0.4691 1.2459 0.2501 -0.0874 0.1953 0.5809","Canon PowerShot G1 X Mark III":"0.8532 -0.0701 -0.1167 -0.4095 1.1879 0.2508 -0.0797 0.2424 0.701","Canon PowerShot G9 X Mark II":"1.0056 -0.4131 -0.0944 -0.2576 1.1143 0.1625 -0.0238 0.1294 0.5179","Canon EOS 200D":"0.7377 -0.0742 -0.0998 -0.4235 1.1981 0.2549 -0.0673 0.1918 0.5538","Canon EOS R10":"0.9269 -0.2012 -0.1107 -0.399 1.1762 0.2527 -0.0569 0.2093 0.4913","Canon PowerShot G5 X":"0.9602 -0.3823 -0.0937 -0.2984 1.1495 0.1675 -0.0407 0.1415 0.5049","Canon PowerShot G1 X Mark II":"0.7378 -0.1255 -0.1043 -0.4088 1.2251 0.2048 -0.0876 0.1946 0.5805","Canon EOS M100":"0.8532 -0.0701 -0.1167 -0.4095 1.1879 0.2508 -0.0797 0.2424 0.701","Canon EOS RP":"0.8608 -0.2097 -0.1178 -0.5425 1.3265 0.2383 -0.1149 0.2238 0.568","Canon EOS 7D":"0.6844 -0.0996 -0.0856 -0.3876 1.1761 0.2396 -0.0593 0.1772 0.6198","Canon EOS 90D":"1.1498 -0.3759 -0.1516 -0.5073 1.2954 0.2349 -0.0892 0.1867 0.6118","Canon PowerShot V1":"1.26 -0.4747 -0.2027 -0.611 1.5868 -0.0029 0.011 0.0479 0.6011","Canon EOS M3":"0.6362 -0.0823 -0.0847 -0.4426 1.2109 0.2616 -0.0743 0.1857 0.5635","Canon PowerShot G7 X Mark III":"1.1629 -0.5713 -0.0914 -0.2706 1.109 0.1842 -0.0206 0.1225 0.5515","Canon EOS M50":"0.8532 -0.0701 -0.1167 -0.4095 1.1879 0.2508 -0.0797 0.2424 0.701","Canon EOS 80D":"0.7457 -0.0671 -0.0937 -0.4849 1.2495 0.2643 -0.1213 0.2354 0.5492","Canon EOS M200":"1.0463 -0.2173 -0.1437 -0.4856 1.2635 0.2482 -0.1216 0.2915 0.7237","Canon EOS R100":"0.823 -0.1515 -0.1032 -0.4179 1.2005 0.2454 -0.0649 0.2076 0.4711","Canon EOS 700D":"0.6602 -0.0841 -0.0939 -0.4472 1.2458 0.2247 -0.0975 0.2039 0.6148","Canon EOS 100D":"0.6602 -0.0841 -0.0939 -0.4472 1.2458 0.2247 -0.0975 0.2039 0.6148","Canon EOS M6 Mark II":"1.1498 -0.3759 -0.1516 -0.5073 1.2954 0.2349 -0.0892 0.1867 0.6118","Canon EOS 70D":"0.7034 -0.0804 -0.1014 -0.442 1.2564 0.2058 -0.0851 0.1994 0.5758","Canon EOS R8":"0.9539 -0.2795 -0.1224 -0.4175 1.1998 0.2458 -0.0465 0.1755 0.6048","Canon EOS 6D":"0.7034 -0.0804 -0.1014 -0.442 1.2564 0.2058 -0.0851 0.1994 0.5758","Canon EOS R50 V":"0.9089 -0.181 -0.1209 -0.4294 1.2116 0.2454 -0.0498 0.1862 0.4923","Canon EOS 77D":"0.7377 -0.0742 -0.0998 -0.4235 1.1981 0.2549 -0.0673 0.1918 0.5538","LEICA M10":"0.8249 -0.2849 -0.062 -0.5415 1.4756 0.0565 -0.0957 0.3074 0.6517","LEICA Q (Typ 116)":"1.1865 -0.4523 -0.1441 -0.5423 1.4458 0.0935 -0.1587 0.2687 0.483","LEICA Q3 43":"1.1111 -0.3816 -0.1057 -0.375 1.2107 0.1829 -0.0947 0.1868 0.4645","LEICA Q2":"1.1865 -0.4523 -0.1441 -0.5423 1.4458 0.0935 -0.1587 0.2687 0.483","LEICA SL (Typ 601)":"1.1865 -0.4523 -0.1441 -0.5423 1.4458 0.0935 -0.1587 0.2687 0.483","LEICA D-Lux 8":"0.8585 -0.3127 -0.0833 -0.4005 1.225 0.1953 -0.065 0.1494 0.4862","LEICA T (Typ 701)":"0.5463 -0.0988 -0.0364 -0.4634 1.2036 0.2946 -0.0766 0.1389 0.6522","LEICA X (Typ 113)":"0.7712 -0.2059 -0.0653 -0.3882 1.1494 0.2726 -0.071 0.1332 0.5958","PENTAX K-1 Mark II":"0.8935 -0.2864 -0.1253 -0.3612 1.2204 0.155 -0.0905 0.1702 0.6346","Panasonic DMC-ZS40":"0.8607 -0.2822 -0.0808 -0.3755 1.193 0.2049 -0.082 0.206 0.5224","Panasonic DMC-CM1":"0.877 -0.3194 -0.082 -0.2871 1.1281 0.1803 -0.0513 0.1552 0.4434","Panasonic DC-G9":"0.7685 -0.2375 -0.0634 -0.3687 1.17 0.2249 -0.0748 0.1546 0.5111","Panasonic DMC-ZS50":"0.8802 -0.3135 -0.0789 -0.3151 1.1468 0.1904 -0.055 0.1745 0.481","Panasonic DMC-GX85":"0.7771 -0.302 -0.0629 -0.4029 1.195 0.2345 -0.0821 0.1977 0.6119","Panasonic DMC-LX9":"0.779 -0.2736 -0.0755 -0.3452 1.187 0.1769 -0.0628 0.1647 0.4898","Panasonic DC-FZ80":"1.1532 -0.4324 -0.1066 -0.2375 1.0847 0.1749 -0.0564 0.1699 0.4351","Panasonic DMC-FZ300":"0.8378 -0.2798 -0.0769 -0.3068 1.141 0.1877 -0.0538 0.1792 0.4623","Panasonic DMC-GX8":"0.7564 -0.2263 -0.0606 -0.3148 1.1239 0.2177 -0.054 0.1435 0.4853","Panasonic DC-S1RM2":"0.9941 -0.4056 -0.0871 -0.3745 1.1604 0.2433 -0.0254 0.1132 0.5526","Panasonic DC-GH6":"0.7949 -0.3491 -0.071 -0.3435 1.1681 0.1977 -0.0503 0.1622 0.5065","Panasonic DC-S1":"0.9744 -0.3905 -0.0779 -0.4899 1.2807 0.2324 -0.0798 0.163 0.5827","Olympus E-M5":"0.838 -0.263 -0.0639 -0.2887 1.0725 0.2496 -0.0627 0.1427 0.5438","Panasonic DMC-ZS100":"0.779 -0.2736 -0.0755 -0.3452 1.187 0.1769 -0.0628 0.1647 0.4898","Olympus E-M5 Mark II":"0.9422 -0.3258 -0.0711 -0.2655 1.0898 0.2015 -0.0512 0.1354 0.5512","Panasonic DC-GF9":"0.761 -0.278 -0.0576 -0.4614 1.2195 0.2733 -0.1375 0.2393 0.649","Panasonic DMC-GF7":"0.761 -0.278 -0.0576 -0.4614 1.2195 0.2733 -0.1375 0.2393 0.649","Olympus PEN-F":"0.9476 -0.3182 -0.0765 -0.2613 1.0958 0.1893 -0.0449 0.1315 0.5268","Panasonic DC-S1H":"0.9397 -0.3719 -0.0805 -0.5425 1.3326 0.2309 -0.0972 0.1715 0.6034","Panasonic DMC-LX100":"0.8844 -0.3538 -0.0768 -0.3709 1.1762 0.22 -0.0698 0.1792 0.522","Panasonic DMC-FZ2500":"0.7386 -0.2443 -0.0743 -0.3437 1.1864 0.1757 -0.0608 0.166 0.4766","Panasonic DC-G99":"0.9657 -0.3963 -0.0748 -0.3361 1.1378 0.2258 -0.0568 0.1415 0.5158","Panasonic DC-LX100M2":"0.8585 -0.3127 -0.0833 -0.4005 1.225 0.1953 -0.065 0.1494 0.4862","Panasonic DC-S1R":"1.1822 -0.5321 -0.1249 -0.5958 1.5114 0.0766 -0.0614 0.1264 0.7043","Panasonic DC-G9M2":"0.8325 -0.3456 -0.0623 -0.433 1.2089 0.2528 -0.086 0.2646 0.5984","Panasonic DC-S9":"0.9983 -0.389 -0.0841 -0.418 1.2164 0.2263 -0.0249 0.1139 0.5766","Panasonic DC-ZS200":"0.779 -0.2736 -0.0755 -0.3452 1.187 0.1769 -0.0628 0.1647 0.4898","Panasonic DC-GX9":"0.7564 -0.2263 -0.0606 -0.3148 1.1239 0.2177 -0.054 0.1435 0.4853","Panasonic DMC-G8":"0.761 -0.278 -0.0576 -0.4614 1.2195 0.2733 -0.1375 0.2393 0.649","Panasonic DMC-ZS60":"0.855 -0.2908 -0.0842 -0.3195 1.1529 0.1881 -0.0338 0.1603 0.4631","Panasonic DC-S1M2":"1.073 -0.4442 -0.0922 -0.4478 1.2504 0.2199 -0.038 0.1198 0.6039","Panasonic DC-GH5S":"0.6929 -0.2355 -0.0708 -0.4192 1.2534 0.1828 -0.1097 0.1989 0.5195","Panasonic DC-S5":"0.9744 -0.3905 -0.0779 -0.4899 1.2807 0.2324 -0.0798 0.163 0.5827","Panasonic DC-GH5M2":"0.93 -0.3659 -0.0755 -0.2981 1.0988 0.2287 -0.019 0.1077 0.5016","Panasonic DC-FZ1000M2":"0.9803 -0.4185 -0.0992 -0.4066 1.2578 0.1628 -0.0838 0.1824 0.5288","Panasonic DC-GH5":"0.7641 -0.2336 -0.0605 -0.3218 1.1299 0.2187 -0.0485 0.1338 0.5121","Panasonic DMC-GX7":"0.761 -0.278 -0.0576 -0.4614 1.2195 0.2733 -0.1375 0.2393 0.649","Panasonic DMC-LX7":"1.0148 -0.3743 -0.0991 -0.2837 1.1366 0.1659 -0.0701 0.1893 0.4899","Panasonic DC-GH7":"0.8573 -0.3575 -0.0678 -0.4252 1.2079 0.2451 -0.0808 0.2524 0.5936","Panasonic DC-S5M2":"1.0308 -0.4206 -0.0783 -0.4088 1.2102 0.2229 -0.0125 0.1051 0.5912","Panasonic DMC-LF1":"0.9379 -0.3267 -0.0816 -0.3227 1.156 0.1881 -0.0926 0.1928 0.534","Panasonic DMC-G7":"0.761 -0.278 -0.0576 -0.4614 1.2195 0.2733 -0.1375 0.2393 0.649","Olympus E-M1X":"1.1896 -0.511 -0.1076 -0.3181 1.1378 0.2048 -0.0519 0.1224 0.5166","OM Digital Solutions OM-1":"0.9488 -0.3984 -0.0714 -0.2887 1.0945 0.2229 -0.0137 0.096 0.5786","Olympus E-M10":"0.838 -0.263 -0.0639 -0.2887 1.0725 0.2496 -0.0627 0.1427 0.5438","Olympus E-M1 Mark III":"1.1896 -0.511 -0.1076 -0.3181 1.1378 0.2048 -0.0519 0.1224 0.5166","Olympus TG-4":"1.1426 -0.4159 -0.1126 -0.2066 1.0678 0.1593 -0.012 0.1327 0.4998","Olympus E-P5":"0.838 -0.263 -0.0639 -0.2887 1.0725 0.2496 -0.0627 0.1427 0.5438","Olympus E-M10 Mark II":"0.838 -0.263 -0.0639 -0.2887 1.0725 0.2496 -0.0627 0.1427 0.5438","Olympus E-M1":"0.7687 -0.1984 -0.0606 -0.4327 1.1928 0.2721 -0.1381 0.2339 0.6452","Olympus E-PL5":"0.838 -0.263 -0.0639 -0.2887 1.0725 0.2496 -0.0627 0.1427 0.5438","Panasonic DMC-GM1":"0.677 -0.1895 -0.0744 -0.5232 1.3145 0.2303 -0.1664 0.2691 0.5703","Panasonic DMC-GF6":"0.813 -0.2801 -0.0946 -0.352 1.1289 0.2552 -0.1314 0.2511 0.5791","Panasonic DMC-FZ1000":"0.783 -0.2696 -0.0763 -0.3325 1.1667 0.1866 -0.0641 0.1712 0.4824","Panasonic DMC-GH4":"0.7122 -0.2108 -0.0512 -0.3155 1.1201 0.2231 -0.0541 0.1423 0.5045","Panasonic DMC-GM5":"0.8238 -0.3244 -0.0679 -0.3921 1.1814 0.2384 -0.0836 0.2022 0.5852","OM Digital Solutions OM-5 Mark II":"1.2008 -0.523 -0.1123 -0.2265 1.0496 0.2046 0.0069 0.0734 0.4938",M1:"0.7712 -0.2059 -0.0653 -0.3882 1.1494 0.2726 -0.071 0.1332 0.5958","Olympus XZ-2":"0.9777 -0.3483 -0.0925 -0.2886 1.1297 0.18 -0.0602 0.1663 0.5134","Olympus E-M1 Mark II":"0.9383 -0.317 -0.0763 -0.2457 1.0702 0.202 -0.0384 0.1236 0.5552","Olympus E-PL7":"0.9197 -0.319 -0.0659 -0.2606 1.083 0.2039 -0.0458 0.125 0.5458","OM Digital Solutions OM-5":"1.1896 -0.511 -0.1076 -0.3181 1.1378 0.2048 -0.0519 0.1224 0.5166","Olympus E-M5 Mark III":"1.1896 -0.511 -0.1076 -0.3181 1.1378 0.2048 -0.0519 0.1224 0.5166","Olympus STYLUS 1":"0.836 -0.242 -0.088 -0.3928 1.2353 0.1739 -0.1381 0.2416 0.5173","RICOH GR IV":"0.6428 -0.1485 -0.0814 -0.4614 1.2728 0.2065 -0.0667 0.1489 0.5924","RICOH GR III":"0.6093 -0.1407 -0.0772 -0.4614 1.2728 0.2065 -0.0663 0.1481 0.5892","GR II":"0.4717 -0.085 -0.0431 -0.4977 1.2805 0.2417 -0.0641 0.1474 0.6143","Olympus E-M10 Mark III":"0.838 -0.263 -0.0639 -0.2887 1.0725 0.2496 -0.0627 0.1427 0.5438","Samsung NX1":"1.0686 -0.4042 -0.1052 -0.3595 1.3238 0.0276 -0.0464 0.1259 0.5931","Samsung NX2000":"0.7557 -0.2522 -0.0739 -0.4679 1.2949 0.1894 -0.084 0.1777 0.5311","Samsung NX500":"1.0686 -0.4042 -0.1052 -0.3595 1.3238 0.0276 -0.0464 0.1259 0.5931","Samsung NX300":"0.7557 -0.2522 -0.0739 -0.4679 1.2949 0.1894 -0.084 0.1777 0.5311","Samsung NX30":"0.7557 -0.2522 -0.0739 -0.4679 1.2949 0.1894 -0.084 0.1777 0.5311","Samsung NX mini":"0.5222 -0.1196 -0.055 -0.654 1.4649 0.2009 -0.1666 0.2819 0.5657","SIGMA fp L":"1.079 -0.2673 -0.228 -0.6718 1.5773 0.0854 -0.1473 0.2047 0.4597","sd Quattro H":"1.2907 0.0532 -0.3603 0.2957 0.7904 -0.0911 0.0255 0.7093 0.3228","Phase One IQ4 150MP":"0.6644 -0.2257 -0.0804 -0.6459 1.4562 0.2019 -0.1221 0.1876 0.6411","Sony ILCE-7RM4":"0.7662 -0.2686 -0.066 -0.524 1.2965 0.253 -0.0796 0.1508 0.6167","Fujifilm X-E4":"1.3426 -0.6334 -0.1177 -0.4244 1.2136 0.2371 -0.058 0.1303 0.598"},m6="modulepreload",y6=function(e){return"/"+e},rw={},Dj=function(t,r,n){let a=Promise.resolve();if(r&&r.length>0){document.getElementsByTagName("link");const o=document.querySelector("meta[property=csp-nonce]"),s=(o==null?void 0:o.nonce)||(o==null?void 0:o.getAttribute("nonce"));a=Promise.allSettled(r.map(l=>{if(l=y6(l),l in rw)return;rw[l]=!0;const u=l.endsWith(".css"),f=u?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${l}"]${f}`))return;const d=document.createElement("link");if(d.rel=u?"stylesheet":m6,u||(d.as="script"),d.crossOrigin="",d.href=l,s&&d.setAttribute("nonce",s),document.head.appendChild(d),u)return new Promise((p,m)=>{d.addEventListener("load",p),d.addEventListener("error",()=>m(new Error(`Unable to preload CSS for ${l}`)))})}))}function i(o){const s=new Event("vite:preloadError",{cancelable:!0});if(s.payload=o,window.dispatchEvent(s),!s.defaultPrevented)throw o}return a.then(o=>{for(const s of o||[])s.status==="rejected"&&i(s.reason);return t().catch(i)})};function al(e){const[[t,r,n],[a,i,o],[s,l,u]]=e,f=t*(i*u-o*l)-r*(a*u-o*s)+n*(a*l-i*s);if(Math.abs(f)<1e-10)return null;const d=1/f;return[[(i*u-o*l)*d,(n*l-r*u)*d,(r*o-n*i)*d],[(o*s-a*u)*d,(t*u-n*s)*d,(n*a-t*o)*d],[(a*l-i*s)*d,(r*s-t*l)*d,(t*i-r*a)*d]]}function v6(e,t){const[[r,n,a],[i,o,s],[l,u,f]]=e,[d,p,m]=t;return[r*d+n*p+a*m,i*d+o*p+s*m,l*d+u*p+f*m]}function mf(e,t){const r=[[0,0,0],[0,0,0],[0,0,0]];for(let n=0;n<3;n++)for(let a=0;a<3;a++)for(let i=0;i<3;i++)r[n][a]+=e[n][i]*t[i][a];return r}function x6(e){const t=e.length;if(t<2)return s=>{var l;return((l=e[0])==null?void 0:l.y)||0};const r=[...e].sort((s,l)=>s.x-l.x),n=r.map(s=>s.x),a=r.map(s=>s.y),i=new Float32Array(t-1),o=new Float32Array(t);for(let s=0;s<t-1;s++){const l=n[s+1]-n[s],u=a[s+1]-a[s];i[s]=u/(l||1e-9)}o[0]=i[0];for(let s=1;s<t-1;s++)o[s]=(i[s-1]+i[s])*.5;o[t-1]=i[t-2];for(let s=0;s<t-1;s++)if(i[s]===0)o[s]=0,o[s+1]=0;else{const l=o[s]/i[s],u=o[s+1]/i[s],f=l*l+u*u;if(f>9){const d=3/Math.sqrt(f);o[s]=l*d*i[s],o[s+1]=u*d*i[s]}}return s=>{let l=0;if(s<=n[0])return a[0];if(s>=n[t-1])return a[t-1];for(;s>n[l+1]&&l<t-2;)l++;const u=n[l+1]-n[l],f=1/u,p=(s-n[l])*f,m=p*p,v=m*p,b=2*v-3*m+1,k=v-2*m+p,x=-2*v+3*m,y=v-m,w=b*a[l]+k*u*o[l]+x*a[l+1]+y*u*o[l+1];return Math.max(0,Math.min(1,w))}}function Fd(e,t=256){const r=x6(e),n=new Float32Array(t);for(let a=0;a<t;a++){const i=a/(t-1);n[a]=r(i)}return n}class il{constructor(t){pr(this,"size");pr(this,"isPowerOfTwo");pr(this,"_real");pr(this,"_imag");pr(this,"_scratch",null);pr(this,"_rev",null);pr(this,"_m",0);pr(this,"_internalFFT",null);pr(this,"_chirpReal",null);pr(this,"_chirpImag",null);pr(this,"_bReal",null);pr(this,"_bImag",null);pr(this,"_hanning",null);pr(this,"_windowSumSq",0);this.size=t,this.isPowerOfTwo=(t&t-1)===0&&t>0,this._real=new Float32Array(t),this._imag=new Float32Array(t),this.isPowerOfTwo?this.initRadix2():this.initBluestein()}initRadix2(){const t=this.size,r=Math.log2(t);this._rev=new Uint32Array(t);for(let n=0;n<t;n++){let a=0,i=n;for(let o=0;o<r;o++)a=a<<1|i&1,i>>>=1;this._rev[n]=a}}initBluestein(){const t=this.size;this._m=Math.pow(2,Math.ceil(Math.log2(2*t-1))),this._internalFFT=new il(this._m),this._chirpReal=new Float32Array(t),this._chirpImag=new Float32Array(t);for(let a=0;a<t;a++){const i=-Math.PI*(a*a)/t;this._chirpReal[a]=Math.cos(i),this._chirpImag[a]=Math.sin(i)}const r=new Float32Array(this._m),n=new Float32Array(this._m);for(let a=0;a<t;a++)r[a]=this._chirpReal[a],n[a]=-this._chirpImag[a];for(let a=1;a<t;a++)r[this._m-a]=r[a],n[this._m-a]=n[a];this._internalFFT.transform(r,n),this._bReal=new Float32Array(this._internalFFT._real),this._bImag=new Float32Array(this._internalFFT._imag)}initHanning(){if(this._hanning)return;const t=this.size;this._hanning=new Float32Array(t);let r=0;for(let n=0;n<t;n++){const a=.5*(1-Math.cos(2*Math.PI*n/(t-1)));this._hanning[n]=a,r+=a*a}this._windowSumSq=r}transform(t,r){this.isPowerOfTwo?this.transformRadix2(t,r):this.transformBluestein(t,r)}transformRadix2(t,r){const n=this.size,a=this._rev,i=this._real,o=this._imag;if(t===i)for(let s=0;s<n;s++){const l=a[s];if(s<l){const u=i[s],f=o[s];i[s]=i[l],o[s]=o[l],i[l]=u,o[l]=f}}else for(let s=0;s<n;s++){const l=a[s];i[s]=t[l],o[s]=r?r[l]:0}for(let s=2;s<=n;s*=2){const l=s/2,u=-2*Math.PI/s,f=Math.cos(u),d=Math.sin(u);for(let p=0;p<n;p+=s){let m=1,v=0;for(let b=0;b<l;b++){const k=p+b,x=p+b+l,y=m*i[x]-v*o[x],w=m*o[x]+v*i[x],_=i[k],S=o[k];i[k]=_+y,o[k]=S+w,i[x]=_-y,o[x]=S-w;const j=m*f-v*d,M=m*d+v*f;m=j,v=M}}}}transformBluestein(t,r){const n=this.size,a=this._m,i=this._internalFFT,o=i._real,s=i._imag;o.fill(0),s.fill(0);for(let d=0;d<n;d++){const p=t[d],m=r?r[d]:0,v=this._chirpReal[d],b=this._chirpImag[d];o[d]=p*v-m*b,s[d]=p*b+m*v}i.transformRadix2(o,s);for(let d=0;d<a;d++){const p=i._real[d],m=i._imag[d],v=this._bReal[d],b=this._bImag[d];i._real[d]=p*v-m*b,i._imag[d]=p*b+m*v}const l=i._real,u=i._imag;for(let d=0;d<a;d++)u[d]=-u[d];i.transformRadix2(l,u);const f=1/a;for(let d=0;d<n;d++){const p=i._real[d]*f,m=-i._imag[d]*f,v=this._chirpReal[d],b=this._chirpImag[d];this._real[d]=p*v-m*b,this._imag[d]=p*b+m*v}}calculateSpectrum(t,r,n=!1){const a=this.size;let i=0;for(let f=0;f<a;f++)i+=t[f];const o=i/a;this._scratch||(this._scratch=new Float32Array(a));const s=this._scratch;if(n){this.initHanning();const f=this._hanning;for(let d=0;d<a;d++)s[d]=(t[d]-o)*f[d]}else for(let f=0;f<a;f++)s[f]=t[f]-o;this.transform(s);const l=r.length;let u=1/a;n&&this._windowSumSq>0&&(u=1/this._windowSumSq);for(let f=0;f<l;f++){const d=this._real[f],p=this._imag[f];r[f]+=(d*d+p*p)*u}}}function b6(e,t,r,n=!1){const a=new il(t),i=new il(r),o=t*r,s=new Float32Array(o),l=new Float32Array(o);let u=null,f=null;if(n){u=new Float32Array(t);for(let b=0;b<t;b++)u[b]=.5*(1-Math.cos(2*Math.PI*b/(t-1)));f=new Float32Array(r);for(let b=0;b<r;b++)f[b]=.5*(1-Math.cos(2*Math.PI*b/(r-1)))}for(let b=0;b<r;b++){const k=b*t,x=a._real;let y=0;for(let _=0;_<t;_++)y+=e[k+_];const w=y/t;if(u)for(let _=0;_<t;_++)x[_]=(e[k+_]-w)*u[_];else for(let _=0;_<t;_++)x[_]=e[k+_]-w;a.transform(x);for(let _=0;_<t;_++)s[k+_]=a._real[_],l[k+_]=a._imag[_]}for(let b=0;b<t;b++){const k=i._real,x=i._imag;for(let y=0;y<r;y++){const w=y*t+b;let _=s[w],S=l[w];f&&(_*=f[y],S*=f[y]),k[y]=_,x[y]=S}i.transform(k,x);for(let y=0;y<r;y++){const w=y*t+b;s[w]=i._real[y],l[w]=i._imag[y]}}const d=new Float32Array(o);let p=1,m=t,v=r;if(n&&u&&f){m=0;for(let b=0;b<t;b++)m+=u[b]*u[b];v=0;for(let b=0;b<r;b++)v+=f[b]*f[b]}p=1/(m*v);for(let b=0;b<o;b++)d[b]=(s[b]*s[b]+l[b]*l[b])*p;return d}function w6(e,t,r){const n=new Float32Array(e.length),a=Math.floor(t/2),i=Math.floor(r/2);for(let o=0;o<r;o++)for(let s=0;s<t;s++){const l=(s+a)%t,u=(o+i)%r,f=o*t+s,d=u*t+l;n[d]=e[f]}return n}function w0(e,t,r,n=[0,0,0,0],a=65535,i="RGGB",o=null){const l=e*t*2,u=8,f=u+l,d="Fake",p="StretchedNoiseCam",m="StretchedNoiseCam",v=G=>{const D=new Uint8Array(G.length+1);for(let I=0;I<G.length;I++)D[I]=G.charCodeAt(I);return D[G.length]=0,D},b=v(d),k=v(p),x=v(m),y=G=>{const D=[0,0,0,0],I={R:0,G:1,B:2},F=G.toUpperCase();for(let H=0;H<4;H++)D[H]=I[F[H]]??1;return D},w=G=>{const D=[];return G.forEach(I=>{D.push(Math.round(I*1e4)),D.push(1e4)}),D},_=[{id:254,type:4,count:1,value:0},{id:256,type:4,count:1,value:e},{id:257,type:4,count:1,value:t},{id:258,type:3,count:1,value:16},{id:259,type:3,count:1,value:1},{id:262,type:3,count:1,value:32803},{id:271,type:2,count:b.length,value:b},{id:272,type:2,count:k.length,value:k},{id:273,type:4,count:1,value:u},{id:277,type:3,count:1,value:1},{id:278,type:4,count:1,value:t},{id:279,type:4,count:1,value:l},{id:33421,type:3,count:2,value:[2,2]},{id:33422,type:1,count:4,value:y(i)},{id:50706,type:1,count:4,value:[1,4,0,0]},{id:50714,type:3,count:4,value:n.map(G=>Math.round(G))},{id:50715,type:4,count:1,value:Math.round(a)},{id:50717,type:2,count:x.length,value:x}];o&&o.length===9&&(_.push({id:50721,type:10,count:9,value:w(o)}),_.push({id:50778,type:3,count:1,value:21})),_.sort((G,D)=>G.id-D.id);const S=2+_.length*12+4;let j=0;const M=_.map(G=>{let D=1;G.type===3&&(D=2),G.type===4&&(D=4),(G.type===5||G.type===10)&&(D=8);const I=G.count*D,F=I<=4;let H=0;return F||(H=j,j+=I,j%2!==0&&j++),{...G,fits:F,totalBytes:I,extraOffset:H,typeSize:D}}),A=f+S,$=A+j,E=new ArrayBuffer($),T=new DataView(E),B=new Uint8Array(E);T.setUint16(0,18761,!0),T.setUint16(2,42,!0),T.setUint32(4,f,!0);const U=new Uint8Array(r.buffer,r.byteOffset,r.byteLength);B.set(U,u);let V=f;return T.setUint16(V,_.length,!0),V+=2,M.forEach(G=>{if(T.setUint16(V,G.id,!0),T.setUint16(V+2,G.type,!0),T.setUint32(V+4,G.count,!0),G.fits){const D=V+8;Array.isArray(G.value)?G.value.forEach((I,F)=>{G.type===1&&T.setUint8(D+F,I),G.type===3&&T.setUint16(D+F*2,I,!0)}):(G.type===3&&T.setUint16(D,G.value,!0),G.type===4&&T.setUint32(D,G.value,!0))}else{const D=A+G.extraOffset;T.setUint32(V+8,D,!0),G.value instanceof Uint8Array?B.set(G.value,D):Array.isArray(G.value)&&G.value.forEach((I,F)=>{G.type===1&&T.setUint8(D+F,I),G.type===2&&T.setUint8(D+F,I),G.type===3&&T.setUint16(D+F*2,I,!0),G.type===4&&T.setUint32(D+F*4,I,!0),(G.type===5||G.type===10)&&(G.type===10?T.setInt32(D+F*4,I,!0):T.setUint32(D+F*4,I,!0))})}V+=12}),T.setUint32(V,0,!0),E}var xp=typeof self<"u"?self:global;const yf=typeof navigator<"u",k6=yf&&typeof HTMLImageElement>"u",K0=!(typeof global>"u"||typeof process>"u"||!process.versions||!process.versions.node),bp=xp.Buffer,Ud=xp.BigInt,wp=!!bp,S6=e=>e;function q0(e,t=S6){if(K0)try{return typeof require=="function"?Promise.resolve(t(require(e))):import(e).then(t)}catch{console.warn(`Couldn't load ${e}`)}}let j1=xp.fetch;const j6=e=>j1=e;if(!xp.fetch){const e=q0("http",n=>n),t=q0("https",n=>n),r=(n,{headers:a}={})=>new Promise(async(i,o)=>{let{port:s,hostname:l,pathname:u,protocol:f,search:d}=new URL(n);const p={method:"GET",hostname:l,path:encodeURI(u)+d,headers:a};s!==""&&(p.port=Number(s));const m=(f==="https:"?await t:await e).request(p,v=>{if(v.statusCode===301||v.statusCode===302){let b=new URL(v.headers.location,n).toString();return r(b,{headers:a}).then(i).catch(o)}i({status:v.statusCode,arrayBuffer:()=>new Promise(b=>{let k=[];v.on("data",x=>k.push(x)),v.on("end",()=>b(Buffer.concat(k)))})})});m.on("error",o),m.end()});j6(r)}function jt(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}const Y0=e=>Ij(e)?void 0:e,_6=e=>e!==void 0;function Ij(e){return e===void 0||(e instanceof Map?e.size===0:Object.values(e).filter(_6).length===0)}function $n(e){let t=new Error(e);throw delete t.stack,t}function Bs(e){return(e=function(t){for(;t.endsWith("\0");)t=t.slice(0,-1);return t}(e).trim())===""?void 0:e}function Hy(e){let t=function(r){let n=0;return r.ifd0.enabled&&(n+=1024),r.exif.enabled&&(n+=2048),r.makerNote&&(n+=2048),r.userComment&&(n+=1024),r.gps.enabled&&(n+=512),r.interop.enabled&&(n+=100),r.ifd1.enabled&&(n+=1024),n+2048}(e);return e.jfif.enabled&&(t+=50),e.xmp.enabled&&(t+=2e4),e.iptc.enabled&&(t+=14e3),e.icc.enabled&&(t+=6e3),t}const Xy=e=>String.fromCharCode.apply(null,e),nw=typeof TextDecoder<"u"?new TextDecoder("utf-8"):void 0;function Lj(e){return nw?nw.decode(e):wp?Buffer.from(e).toString("utf8"):decodeURIComponent(escape(Xy(e)))}class Ma{static from(t,r){return t instanceof this&&t.le===r?t:new Ma(t,void 0,void 0,r)}constructor(t,r=0,n,a){if(typeof a=="boolean"&&(this.le=a),Array.isArray(t)&&(t=new Uint8Array(t)),t===0)this.byteOffset=0,this.byteLength=0;else if(t instanceof ArrayBuffer){n===void 0&&(n=t.byteLength-r);let i=new DataView(t,r,n);this._swapDataView(i)}else if(t instanceof Uint8Array||t instanceof DataView||t instanceof Ma){n===void 0&&(n=t.byteLength-r),(r+=t.byteOffset)+n>t.byteOffset+t.byteLength&&$n("Creating view outside of available memory in ArrayBuffer");let i=new DataView(t.buffer,r,n);this._swapDataView(i)}else if(typeof t=="number"){let i=new DataView(new ArrayBuffer(t));this._swapDataView(i)}else $n("Invalid input argument for BufferView: "+t)}_swapArrayBuffer(t){this._swapDataView(new DataView(t))}_swapBuffer(t){this._swapDataView(new DataView(t.buffer,t.byteOffset,t.byteLength))}_swapDataView(t){this.dataView=t,this.buffer=t.buffer,this.byteOffset=t.byteOffset,this.byteLength=t.byteLength}_lengthToEnd(t){return this.byteLength-t}set(t,r,n=Ma){return t instanceof DataView||t instanceof Ma?t=new Uint8Array(t.buffer,t.byteOffset,t.byteLength):t instanceof ArrayBuffer&&(t=new Uint8Array(t)),t instanceof Uint8Array||$n("BufferView.set(): Invalid data argument."),this.toUint8().set(t,r),new n(this,r,t.byteLength)}subarray(t,r){return r=r||this._lengthToEnd(t),new Ma(this,t,r)}toUint8(){return new Uint8Array(this.buffer,this.byteOffset,this.byteLength)}getUint8Array(t,r){return new Uint8Array(this.buffer,this.byteOffset+t,r)}getString(t=0,r=this.byteLength){return Lj(this.getUint8Array(t,r))}getLatin1String(t=0,r=this.byteLength){let n=this.getUint8Array(t,r);return Xy(n)}getUnicodeString(t=0,r=this.byteLength){const n=[];for(let a=0;a<r&&t+a<this.byteLength;a+=2)n.push(this.getUint16(t+a));return Xy(n)}getInt8(t){return this.dataView.getInt8(t)}getUint8(t){return this.dataView.getUint8(t)}getInt16(t,r=this.le){return this.dataView.getInt16(t,r)}getInt32(t,r=this.le){return this.dataView.getInt32(t,r)}getUint16(t,r=this.le){return this.dataView.getUint16(t,r)}getUint32(t,r=this.le){return this.dataView.getUint32(t,r)}getFloat32(t,r=this.le){return this.dataView.getFloat32(t,r)}getFloat64(t,r=this.le){return this.dataView.getFloat64(t,r)}getFloat(t,r=this.le){return this.dataView.getFloat32(t,r)}getDouble(t,r=this.le){return this.dataView.getFloat64(t,r)}getUintBytes(t,r,n){switch(r){case 1:return this.getUint8(t,n);case 2:return this.getUint16(t,n);case 4:return this.getUint32(t,n);case 8:return this.getUint64&&this.getUint64(t,n)}}getUint(t,r,n){switch(r){case 8:return this.getUint8(t,n);case 16:return this.getUint16(t,n);case 32:return this.getUint32(t,n);case 64:return this.getUint64&&this.getUint64(t,n)}}toString(t){return this.dataView.toString(t,this.constructor.name)}ensureChunk(){}}function Ky(e,t){$n(`${e} '${t}' was not loaded, try using full build of exifr.`)}let _1=class extends Map{constructor(t){super(),this.kind=t}get(t,r){return this.has(t)||Ky(this.kind,t),r&&(t in r||function(n,a){$n(`Unknown ${n} '${a}'.`)}(this.kind,t),r[t].enabled||Ky(this.kind,t)),super.get(t)}keyList(){return Array.from(this.keys())}};var Zi=new _1("file parser"),Tn=new _1("segment parser"),eo=new _1("file reader");function P6(e,t){return typeof e=="string"?aw(e,t):yf&&!k6&&e instanceof HTMLImageElement?aw(e.src,t):e instanceof Uint8Array||e instanceof ArrayBuffer||e instanceof DataView?new Ma(e):yf&&e instanceof Blob?qy(e,t,"blob",sl):void $n("Invalid input argument")}function aw(e,t){return(r=e).startsWith("data:")||r.length>1e4?Yy(e,t,"base64"):K0&&e.includes("://")?qy(e,t,"url",ol):K0?Yy(e,t,"fs"):yf?qy(e,t,"url",ol):void $n("Invalid input argument");var r}async function qy(e,t,r,n){return eo.has(r)?Yy(e,t,r):n?async function(a,i){let o=await i(a);return new Ma(o)}(e,n):void $n(`Parser ${r} is not loaded`)}async function Yy(e,t,r){let n=new(eo.get(r))(e,t);return await n.read(),n}const ol=e=>j1(e).then(t=>t.arrayBuffer()),sl=e=>new Promise((t,r)=>{let n=new FileReader;n.onloadend=()=>t(n.result||new ArrayBuffer),n.onerror=r,n.readAsArrayBuffer(e)});class C6 extends Map{get tagKeys(){return this.allKeys||(this.allKeys=Array.from(this.keys())),this.allKeys}get tagValues(){return this.allValues||(this.allValues=Array.from(this.values())),this.allValues}}function Nn(e,t,r){let n=new C6;for(let[a,i]of r)n.set(a,i);if(Array.isArray(t))for(let a of t)e.set(a,n);else e.set(t,n);return n}function ll(e,t,r){let n,a=e.get(t);for(n of r)a.set(n[0],n[1])}const qn=new Map,Ei=new Map,ss=new Map,Wo=["chunked","firstChunkSize","firstChunkSizeNode","firstChunkSizeBrowser","chunkSize","chunkLimit"],Wc=["jfif","xmp","icc","iptc","ihdr"],cl=["tiff",...Wc],mn=["ifd0","ifd1","exif","gps","interop"],Vo=[...cl,...mn],Ho=["makerNote","userComment"],Vc=["translateKeys","translateValues","reviveValues","multiSegment"],Xo=[...Vc,"sanitize","mergeOutput","silentErrors"];class Bj{get translate(){return this.translateKeys||this.translateValues||this.reviveValues}}class vu extends Bj{get needed(){return this.enabled||this.deps.size>0}constructor(t,r,n,a){if(super(),jt(this,"enabled",!1),jt(this,"skip",new Set),jt(this,"pick",new Set),jt(this,"deps",new Set),jt(this,"translateKeys",!1),jt(this,"translateValues",!1),jt(this,"reviveValues",!1),this.key=t,this.enabled=r,this.parse=this.enabled,this.applyInheritables(a),this.canBeFiltered=mn.includes(t),this.canBeFiltered&&(this.dict=qn.get(t)),n!==void 0)if(Array.isArray(n))this.parse=this.enabled=!0,this.canBeFiltered&&n.length>0&&this.translateTagSet(n,this.pick);else if(typeof n=="object"){if(this.enabled=!0,this.parse=n.parse!==!1,this.canBeFiltered){let{pick:i,skip:o}=n;i&&i.length>0&&this.translateTagSet(i,this.pick),o&&o.length>0&&this.translateTagSet(o,this.skip)}this.applyInheritables(n)}else n===!0||n===!1?this.parse=this.enabled=n:$n(`Invalid options argument: ${n}`)}applyInheritables(t){let r,n;for(r of Vc)n=t[r],n!==void 0&&(this[r]=n)}translateTagSet(t,r){if(this.dict){let n,a,{tagKeys:i,tagValues:o}=this.dict;for(n of t)typeof n=="string"?(a=o.indexOf(n),a===-1&&(a=i.indexOf(Number(n))),a!==-1&&r.add(Number(i[a]))):r.add(n)}else for(let n of t)r.add(n)}finalizeFilters(){!this.enabled&&this.deps.size>0?(this.enabled=!0,Z0(this.pick,this.deps)):this.enabled&&this.pick.size>0&&Z0(this.pick,this.deps)}}var va={jfif:!1,tiff:!0,xmp:!1,icc:!1,iptc:!1,ifd0:!0,ifd1:!1,exif:!0,gps:!0,interop:!1,ihdr:void 0,makerNote:!1,userComment:!1,multiSegment:!1,skip:[],pick:[],translateKeys:!0,translateValues:!0,reviveValues:!0,sanitize:!0,mergeOutput:!0,silentErrors:!0,chunked:!0,firstChunkSize:void 0,firstChunkSizeNode:512,firstChunkSizeBrowser:65536,chunkSize:65536,chunkLimit:5},iw=new Map;let vl=class extends Bj{static useCached(t){let r=iw.get(t);return r!==void 0||(r=new this(t),iw.set(t,r)),r}constructor(t){super(),t===!0?this.setupFromTrue():t===void 0?this.setupFromUndefined():Array.isArray(t)?this.setupFromArray(t):typeof t=="object"?this.setupFromObject(t):$n(`Invalid options argument ${t}`),this.firstChunkSize===void 0&&(this.firstChunkSize=yf?this.firstChunkSizeBrowser:this.firstChunkSizeNode),this.mergeOutput&&(this.ifd1.enabled=!1),this.filterNestedSegmentTags(),this.traverseTiffDependencyTree(),this.checkLoadedPlugins()}setupFromUndefined(){let t;for(t of Wo)this[t]=va[t];for(t of Xo)this[t]=va[t];for(t of Ho)this[t]=va[t];for(t of Vo)this[t]=new vu(t,va[t],void 0,this)}setupFromTrue(){let t;for(t of Wo)this[t]=va[t];for(t of Xo)this[t]=va[t];for(t of Ho)this[t]=!0;for(t of Vo)this[t]=new vu(t,!0,void 0,this)}setupFromArray(t){let r;for(r of Wo)this[r]=va[r];for(r of Xo)this[r]=va[r];for(r of Ho)this[r]=va[r];for(r of Vo)this[r]=new vu(r,!1,void 0,this);this.setupGlobalFilters(t,void 0,mn)}setupFromObject(t){let r;for(r of(mn.ifd0=mn.ifd0||mn.image,mn.ifd1=mn.ifd1||mn.thumbnail,Object.assign(this,t),Wo))this[r]=um(t[r],va[r]);for(r of Xo)this[r]=um(t[r],va[r]);for(r of Ho)this[r]=um(t[r],va[r]);for(r of cl)this[r]=new vu(r,va[r],t[r],this);for(r of mn)this[r]=new vu(r,va[r],t[r],this.tiff);this.setupGlobalFilters(t.pick,t.skip,mn,Vo),t.tiff===!0?this.batchEnableWithBool(mn,!0):t.tiff===!1?this.batchEnableWithUserValue(mn,t):Array.isArray(t.tiff)?this.setupGlobalFilters(t.tiff,void 0,mn):typeof t.tiff=="object"&&this.setupGlobalFilters(t.tiff.pick,t.tiff.skip,mn)}batchEnableWithBool(t,r){for(let n of t)this[n].enabled=r}batchEnableWithUserValue(t,r){for(let n of t){let a=r[n];this[n].enabled=a!==!1&&a!==void 0}}setupGlobalFilters(t,r,n,a=n){if(t&&t.length){for(let o of a)this[o].enabled=!1;let i=ow(t,n);for(let[o,s]of i)Z0(this[o].pick,s),this[o].enabled=!0}else if(r&&r.length){let i=ow(r,n);for(let[o,s]of i)Z0(this[o].skip,s)}}filterNestedSegmentTags(){let{ifd0:t,exif:r,xmp:n,iptc:a,icc:i}=this;this.makerNote?r.deps.add(37500):r.skip.add(37500),this.userComment?r.deps.add(37510):r.skip.add(37510),n.enabled||t.skip.add(700),a.enabled||t.skip.add(33723),i.enabled||t.skip.add(34675)}traverseTiffDependencyTree(){let{ifd0:t,exif:r,gps:n,interop:a}=this;a.needed&&(r.deps.add(40965),t.deps.add(40965)),r.needed&&t.deps.add(34665),n.needed&&t.deps.add(34853),this.tiff.enabled=mn.some(i=>this[i].enabled===!0)||this.makerNote||this.userComment;for(let i of mn)this[i].finalizeFilters()}get onlyTiff(){return!Wc.map(t=>this[t].enabled).some(t=>t===!0)&&this.tiff.enabled}checkLoadedPlugins(){for(let t of cl)this[t].enabled&&!Tn.has(t)&&Ky("segment parser",t)}};function ow(e,t){let r,n,a,i,o=[];for(a of t){for(i of(r=qn.get(a),n=[],r))(e.includes(i[0])||e.includes(i[1]))&&n.push(i[0]);n.length&&o.push([a,n])}return o}function um(e,t){return e!==void 0?e:t!==void 0?t:void 0}function Z0(e,t){for(let r of t)e.add(r)}jt(vl,"default",va);class ps{constructor(t){jt(this,"parsers",{}),jt(this,"output",{}),jt(this,"errors",[]),jt(this,"pushToErrors",r=>this.errors.push(r)),this.options=vl.useCached(t)}async read(t){this.file=await P6(t,this.options)}setup(){if(this.fileParser)return;let{file:t}=this,r=t.getUint16(0);for(let[n,a]of Zi)if(a.canHandle(t,r))return this.fileParser=new a(this.options,this.file,this.parsers),t[n]=!0;this.file.close&&this.file.close(),$n("Unknown file format")}async parse(){let{output:t,errors:r}=this;return this.setup(),this.options.silentErrors?(await this.executeParsers().catch(this.pushToErrors),r.push(...this.fileParser.errors)):await this.executeParsers(),this.file.close&&this.file.close(),this.options.silentErrors&&r.length>0&&(t.errors=r),Y0(t)}async executeParsers(){let{output:t}=this;await this.fileParser.parse();let r=Object.values(this.parsers).map(async n=>{let a=await n.parse();n.assignToOutput(t,a)});this.options.silentErrors&&(r=r.map(n=>n.catch(this.pushToErrors))),await Promise.all(r)}async extractThumbnail(){this.setup();let{options:t,file:r}=this,n=Tn.get("tiff",t);var a;if(r.tiff?a={start:0,type:"tiff"}:r.jpeg&&(a=await this.fileParser.getOrFindSegment("tiff")),a===void 0)return;let i=await this.fileParser.ensureSegmentChunk(a),o=this.parsers.tiff=new n(i,t,r),s=await o.extractThumbnail();return r.close&&r.close(),s}}async function kp(e,t){let r=new ps(t);return await r.read(e),r.parse()}var N6=Object.freeze({__proto__:null,parse:kp,Exifr:ps,fileParsers:Zi,segmentParsers:Tn,fileReaders:eo,tagKeys:qn,tagValues:Ei,tagRevivers:ss,createDictionary:Nn,extendDictionary:ll,fetchUrlAsArrayBuffer:ol,readBlobAsArrayBuffer:sl,chunkedProps:Wo,otherSegments:Wc,segments:cl,tiffBlocks:mn,segmentsAndBlocks:Vo,tiffExtractables:Ho,inheritables:Vc,allFormatters:Xo,Options:vl});class Sp{constructor(t,r,n){jt(this,"errors",[]),jt(this,"ensureSegmentChunk",async a=>{let i=a.start,o=a.size||65536;if(this.file.chunked)if(this.file.available(i,o))a.chunk=this.file.subarray(i,o);else try{a.chunk=await this.file.readChunk(i,o)}catch(s){$n(`Couldn't read segment: ${JSON.stringify(a)}. ${s.message}`)}else this.file.byteLength>i+o?a.chunk=this.file.subarray(i,o):a.size===void 0?a.chunk=this.file.subarray(i):$n("Segment unreachable: "+JSON.stringify(a));return a.chunk}),this.extendOptions&&this.extendOptions(t),this.options=t,this.file=r,this.parsers=n}injectSegment(t,r){this.options[t].enabled&&this.createParser(t,r)}createParser(t,r){let n=new(Tn.get(t))(r,this.options,this.file);return this.parsers[t]=n}createParsers(t){for(let r of t){let{type:n,chunk:a}=r,i=this.options[n];if(i&&i.enabled){let o=this.parsers[n];o&&o.append||o||this.createParser(n,a)}}}async readSegments(t){let r=t.map(this.ensureSegmentChunk);await Promise.all(r)}}let Pi=class{static findPosition(t,r){let n=t.getUint16(r+2)+2,a=typeof this.headerLength=="function"?this.headerLength(t,r,n):this.headerLength,i=r+a,o=n-a;return{offset:r,length:n,headerLength:a,start:i,size:o,end:i+o}}static parse(t,r={}){return new this(t,new vl({[this.type]:r}),t).parse()}normalizeInput(t){return t instanceof Ma?t:new Ma(t)}constructor(t,r={},n){jt(this,"errors",[]),jt(this,"raw",new Map),jt(this,"handleError",a=>{if(!this.options.silentErrors)throw a;this.errors.push(a.message)}),this.chunk=this.normalizeInput(t),this.file=n,this.type=this.constructor.type,this.globalOptions=this.options=r,this.localOptions=r[this.type],this.canTranslate=this.localOptions&&this.localOptions.translate}translate(){this.canTranslate&&(this.translated=this.translateBlock(this.raw,this.type))}get output(){return this.translated?this.translated:this.raw?Object.fromEntries(this.raw):void 0}translateBlock(t,r){let n=ss.get(r),a=Ei.get(r),i=qn.get(r),o=this.options[r],s=o.reviveValues&&!!n,l=o.translateValues&&!!a,u=o.translateKeys&&!!i,f={};for(let[d,p]of t)s&&n.has(d)?p=n.get(d)(p):l&&a.has(d)&&(p=this.translateValue(p,a.get(d))),u&&i.has(d)&&(d=i.get(d)||d),f[d]=p;return f}translateValue(t,r){return r[t]||r.DEFAULT||t}assignToOutput(t,r){this.assignObjectToOutput(t,this.constructor.type,r)}assignObjectToOutput(t,r,n){if(this.globalOptions.mergeOutput)return Object.assign(t,n);t[r]?Object.assign(t[r],n):t[r]=n}};jt(Pi,"headerLength",4),jt(Pi,"type",void 0),jt(Pi,"multiSegment",!1),jt(Pi,"canHandle",()=>!1);function M6(e){return e===192||e===194||e===196||e===219||e===221||e===218||e===254}function O6(e){return e>=224&&e<=239}function A6(e,t,r){for(let[n,a]of Tn)if(a.canHandle(e,t,r))return n}class sw extends Sp{constructor(...t){super(...t),jt(this,"appSegments",[]),jt(this,"jpegSegments",[]),jt(this,"unknownSegments",[])}static canHandle(t,r){return r===65496}async parse(){await this.findAppSegments(),await this.readSegments(this.appSegments),this.mergeMultiSegments(),this.createParsers(this.mergedAppSegments||this.appSegments)}setupSegmentFinderArgs(t){t===!0?(this.findAll=!0,this.wanted=new Set(Tn.keyList())):(t=t===void 0?Tn.keyList().filter(r=>this.options[r].enabled):t.filter(r=>this.options[r].enabled&&Tn.has(r)),this.findAll=!1,this.remaining=new Set(t),this.wanted=new Set(t)),this.unfinishedMultiSegment=!1}async findAppSegments(t=0,r){this.setupSegmentFinderArgs(r);let{file:n,findAll:a,wanted:i,remaining:o}=this;if(!a&&this.file.chunked&&(a=Array.from(i).some(s=>{let l=Tn.get(s),u=this.options[s];return l.multiSegment&&u.multiSegment}),a&&await this.file.readWhole()),t=this.findAppSegmentsInRange(t,n.byteLength),!this.options.onlyTiff&&n.chunked){let s=!1;for(;o.size>0&&!s&&(n.canReadNextChunk||this.unfinishedMultiSegment);){let{nextChunkOffset:l}=n,u=this.appSegments.some(f=>!this.file.available(f.offset||f.start,f.length||f.size));if(s=t>l&&!u?!await n.readNextChunk(t):!await n.readNextChunk(l),(t=this.findAppSegmentsInRange(t,n.byteLength))===void 0)return}}}findAppSegmentsInRange(t,r){r-=2;let n,a,i,o,s,l,{file:u,findAll:f,wanted:d,remaining:p,options:m}=this;for(;t<r;t++)if(u.getUint8(t)===255){if(n=u.getUint8(t+1),O6(n)){if(a=u.getUint16(t+2),i=A6(u,t,a),i&&d.has(i)&&(o=Tn.get(i),s=o.findPosition(u,t),l=m[i],s.type=i,this.appSegments.push(s),!f&&(o.multiSegment&&l.multiSegment?(this.unfinishedMultiSegment=s.chunkNumber<s.chunkCount,this.unfinishedMultiSegment||p.delete(i)):p.delete(i),p.size===0)))break;m.recordUnknownSegments&&(s=Pi.findPosition(u,t),s.marker=n,this.unknownSegments.push(s)),t+=a+1}else if(M6(n)){if(a=u.getUint16(t+2),n===218&&m.stopAfterSos!==!1)return;m.recordJpegSegments&&this.jpegSegments.push({offset:t,length:a,marker:n}),t+=a+1}}return t}mergeMultiSegments(){if(!this.appSegments.some(r=>r.multiSegment))return;let t=function(r,n){let a,i,o,s=new Map;for(let l=0;l<r.length;l++)a=r[l],i=a[n],s.has(i)?o=s.get(i):s.set(i,o=[]),o.push(a);return Array.from(s)}(this.appSegments,"type");this.mergedAppSegments=t.map(([r,n])=>{let a=Tn.get(r,this.options);return a.handleMultiSegments?{type:r,chunk:a.handleMultiSegments(n)}:n[0]})}getSegment(t){return this.appSegments.find(r=>r.type===t)}async getOrFindSegment(t){let r=this.getSegment(t);return r===void 0&&(await this.findAppSegments(0,[t]),r=this.getSegment(t)),r}}jt(sw,"type","jpeg"),Zi.set("jpeg",sw);const T6=[void 0,1,1,2,4,8,1,1,2,4,8,4,8,4];class E6 extends Pi{parseHeader(){var t=this.chunk.getUint16();t===18761?this.le=!0:t===19789&&(this.le=!1),this.chunk.le=this.le,this.headerParsed=!0}parseTags(t,r,n=new Map){let{pick:a,skip:i}=this.options[r];a=new Set(a);let o=a.size>0,s=i.size===0,l=this.chunk.getUint16(t);t+=2;for(let u=0;u<l;u++){let f=this.chunk.getUint16(t);if(o){if(a.has(f)&&(n.set(f,this.parseTag(t,f,r)),a.delete(f),a.size===0))break}else!s&&i.has(f)||n.set(f,this.parseTag(t,f,r));t+=12}return n}parseTag(t,r,n){let{chunk:a}=this,i=a.getUint16(t+2),o=a.getUint32(t+4),s=T6[i];if(s*o<=4?t+=8:t=a.getUint32(t+8),(i<1||i>13)&&$n(`Invalid TIFF value type. block: ${n.toUpperCase()}, tag: ${r.toString(16)}, type: ${i}, offset ${t}`),t>a.byteLength&&$n(`Invalid TIFF value offset. block: ${n.toUpperCase()}, tag: ${r.toString(16)}, type: ${i}, offset ${t} is outside of chunk size ${a.byteLength}`),i===1)return a.getUint8Array(t,o);if(i===2)return Bs(a.getString(t,o));if(i===7)return a.getUint8Array(t,o);if(o===1)return this.parseTagValue(i,t);{let l=new(function(f){switch(f){case 1:return Uint8Array;case 3:return Uint16Array;case 4:return Uint32Array;case 5:return Array;case 6:return Int8Array;case 8:return Int16Array;case 9:return Int32Array;case 10:return Array;case 11:return Float32Array;case 12:return Float64Array;default:return Array}}(i))(o),u=s;for(let f=0;f<o;f++)l[f]=this.parseTagValue(i,t),t+=u;return l}}parseTagValue(t,r){let{chunk:n}=this;switch(t){case 1:return n.getUint8(r);case 3:return n.getUint16(r);case 4:return n.getUint32(r);case 5:return n.getUint32(r)/n.getUint32(r+4);case 6:return n.getInt8(r);case 8:return n.getInt16(r);case 9:return n.getInt32(r);case 10:return n.getInt32(r)/n.getInt32(r+4);case 11:return n.getFloat(r);case 12:return n.getDouble(r);case 13:return n.getUint32(r);default:$n(`Invalid tiff type ${t}`)}}}class fm extends E6{static canHandle(t,r){return t.getUint8(r+1)===225&&t.getUint32(r+4)===1165519206&&t.getUint16(r+8)===0}async parse(){this.parseHeader();let{options:t}=this;return t.ifd0.enabled&&await this.parseIfd0Block(),t.exif.enabled&&await this.safeParse("parseExifBlock"),t.gps.enabled&&await this.safeParse("parseGpsBlock"),t.interop.enabled&&await this.safeParse("parseInteropBlock"),t.ifd1.enabled&&await this.safeParse("parseThumbnailBlock"),this.createOutput()}safeParse(t){let r=this[t]();return r.catch!==void 0&&(r=r.catch(this.handleError)),r}findIfd0Offset(){this.ifd0Offset===void 0&&(this.ifd0Offset=this.chunk.getUint32(4))}findIfd1Offset(){if(this.ifd1Offset===void 0){this.findIfd0Offset();let t=this.chunk.getUint16(this.ifd0Offset),r=this.ifd0Offset+2+12*t;this.ifd1Offset=this.chunk.getUint32(r)}}parseBlock(t,r){let n=new Map;return this[r]=n,this.parseTags(t,r,n),n}async parseIfd0Block(){if(this.ifd0)return;let{file:t}=this;this.findIfd0Offset(),this.ifd0Offset<8&&$n("Malformed EXIF data"),!t.chunked&&this.ifd0Offset>t.byteLength&&$n(`IFD0 offset points to outside of file.
this.ifd0Offset: ${this.ifd0Offset}, file.byteLength: ${t.byteLength}`),t.tiff&&await t.ensureChunk(this.ifd0Offset,Hy(this.options));let r=this.parseBlock(this.ifd0Offset,"ifd0");return r.size!==0?(this.exifOffset=r.get(34665),this.interopOffset=r.get(40965),this.gpsOffset=r.get(34853),this.xmp=r.get(700),this.iptc=r.get(33723),this.icc=r.get(34675),this.options.sanitize&&(r.delete(34665),r.delete(40965),r.delete(34853),r.delete(700),r.delete(33723),r.delete(34675)),r):void 0}async parseExifBlock(){if(this.exif||(this.ifd0||await this.parseIfd0Block(),this.exifOffset===void 0))return;this.file.tiff&&await this.file.ensureChunk(this.exifOffset,Hy(this.options));let t=this.parseBlock(this.exifOffset,"exif");return this.interopOffset||(this.interopOffset=t.get(40965)),this.makerNote=t.get(37500),this.userComment=t.get(37510),this.options.sanitize&&(t.delete(40965),t.delete(37500),t.delete(37510)),this.unpack(t,41728),this.unpack(t,41729),t}unpack(t,r){let n=t.get(r);n&&n.length===1&&t.set(r,n[0])}async parseGpsBlock(){if(this.gps||(this.ifd0||await this.parseIfd0Block(),this.gpsOffset===void 0))return;let t=this.parseBlock(this.gpsOffset,"gps");return t&&t.has(2)&&t.has(4)&&(t.set("latitude",lw(...t.get(2),t.get(1))),t.set("longitude",lw(...t.get(4),t.get(3)))),t}async parseInteropBlock(){if(!this.interop&&(this.ifd0||await this.parseIfd0Block(),this.interopOffset!==void 0||this.exif||await this.parseExifBlock(),this.interopOffset!==void 0))return this.parseBlock(this.interopOffset,"interop")}async parseThumbnailBlock(t=!1){if(!this.ifd1&&!this.ifd1Parsed&&(!this.options.mergeOutput||t))return this.findIfd1Offset(),this.ifd1Offset>0&&(this.parseBlock(this.ifd1Offset,"ifd1"),this.ifd1Parsed=!0),this.ifd1}async extractThumbnail(){if(this.headerParsed||this.parseHeader(),this.ifd1Parsed||await this.parseThumbnailBlock(!0),this.ifd1===void 0)return;let t=this.ifd1.get(513),r=this.ifd1.get(514);return this.chunk.getUint8Array(t,r)}get image(){return this.ifd0}get thumbnail(){return this.ifd1}createOutput(){let t,r,n,a={};for(r of mn)if(t=this[r],!Ij(t))if(n=this.canTranslate?this.translateBlock(t,r):Object.fromEntries(t),this.options.mergeOutput){if(r==="ifd1")continue;Object.assign(a,n)}else a[r]=n;return this.makerNote&&(a.makerNote=this.makerNote),this.userComment&&(a.userComment=this.userComment),a}assignToOutput(t,r){if(this.globalOptions.mergeOutput)Object.assign(t,r);else for(let[n,a]of Object.entries(r))this.assignObjectToOutput(t,n,a)}}function lw(e,t,r,n){var a=e+t/60+r/3600;return n!=="S"&&n!=="W"||(a*=-1),a}jt(fm,"type","tiff"),jt(fm,"headerLength",10),Tn.set("tiff",fm);var $6=Object.freeze({__proto__:null,default:N6,Exifr:ps,fileParsers:Zi,segmentParsers:Tn,fileReaders:eo,tagKeys:qn,tagValues:Ei,tagRevivers:ss,createDictionary:Nn,extendDictionary:ll,fetchUrlAsArrayBuffer:ol,readBlobAsArrayBuffer:sl,chunkedProps:Wo,otherSegments:Wc,segments:cl,tiffBlocks:mn,segmentsAndBlocks:Vo,tiffExtractables:Ho,inheritables:Vc,allFormatters:Xo,Options:vl,parse:kp});const P1={ifd0:!1,ifd1:!1,exif:!1,gps:!1,interop:!1,sanitize:!1,reviveValues:!0,translateKeys:!1,translateValues:!1,mergeOutput:!1},C1=Object.assign({},P1,{firstChunkSize:4e4,gps:[1,2,3,4]});async function Fj(e){let t=new ps(C1);await t.read(e);let r=await t.parse();if(r&&r.gps){let{latitude:n,longitude:a}=r.gps;return{latitude:n,longitude:a}}}const N1=Object.assign({},P1,{tiff:!1,ifd1:!0,mergeOutput:!1});async function Uj(e){let t=new ps(N1);await t.read(e);let r=await t.extractThumbnail();return r&&wp?bp.from(r):r}async function Gj(e){let t=await this.thumbnail(e);if(t!==void 0){let r=new Blob([t]);return URL.createObjectURL(r)}}const M1=Object.assign({},P1,{firstChunkSize:4e4,ifd0:[274]});async function O1(e){let t=new ps(M1);await t.read(e);let r=await t.parse();if(r&&r.ifd0)return r.ifd0[274]}const A1=Object.freeze({1:{dimensionSwapped:!1,scaleX:1,scaleY:1,deg:0,rad:0},2:{dimensionSwapped:!1,scaleX:-1,scaleY:1,deg:0,rad:0},3:{dimensionSwapped:!1,scaleX:1,scaleY:1,deg:180,rad:180*Math.PI/180},4:{dimensionSwapped:!1,scaleX:-1,scaleY:1,deg:180,rad:180*Math.PI/180},5:{dimensionSwapped:!0,scaleX:1,scaleY:-1,deg:90,rad:90*Math.PI/180},6:{dimensionSwapped:!0,scaleX:1,scaleY:1,deg:90,rad:90*Math.PI/180},7:{dimensionSwapped:!0,scaleX:1,scaleY:-1,deg:270,rad:270*Math.PI/180},8:{dimensionSwapped:!0,scaleX:1,scaleY:1,deg:270,rad:270*Math.PI/180}});let Fs=!0,Us=!0;if(typeof navigator=="object"){let e=navigator.userAgent;if(e.includes("iPad")||e.includes("iPhone")){let t=e.match(/OS (\d+)_(\d+)/);if(t){let[,r,n]=t;Fs=Number(r)+.1*Number(n)<13.4,Us=!1}}else if(e.includes("OS X 10")){let[,t]=e.match(/OS X 10[_.](\d+)/);Fs=Us=Number(t)<15}if(e.includes("Chrome/")){let[,t]=e.match(/Chrome\/(\d+)/);Fs=Us=Number(t)<81}else if(e.includes("Firefox/")){let[,t]=e.match(/Firefox\/(\d+)/);Fs=Us=Number(t)<77}}async function zj(e){let t=await O1(e);return Object.assign({canvas:Fs,css:Us},A1[t])}class R6 extends Ma{constructor(...t){super(...t),jt(this,"ranges",new D6),this.byteLength!==0&&this.ranges.add(0,this.byteLength)}_tryExtend(t,r,n){if(t===0&&this.byteLength===0&&n){let a=new DataView(n.buffer||n,n.byteOffset,n.byteLength);this._swapDataView(a)}else{let a=t+r;if(a>this.byteLength){let{dataView:i}=this._extend(a);this._swapDataView(i)}}}_extend(t){let r;r=wp?bp.allocUnsafe(t):new Uint8Array(t);let n=new DataView(r.buffer,r.byteOffset,r.byteLength);return r.set(new Uint8Array(this.buffer,this.byteOffset,this.byteLength),0),{uintView:r,dataView:n}}subarray(t,r,n=!1){return r=r||this._lengthToEnd(t),n&&this._tryExtend(t,r),this.ranges.add(t,r),super.subarray(t,r)}set(t,r,n=!1){n&&this._tryExtend(r,t.byteLength,t);let a=super.set(t,r);return this.ranges.add(r,a.byteLength),a}async ensureChunk(t,r){this.chunked&&(this.ranges.available(t,r)||await this.readChunk(t,r))}available(t,r){return this.ranges.available(t,r)}}class D6{constructor(){jt(this,"list",[])}get length(){return this.list.length}add(t,r,n=0){let a=t+r,i=this.list.filter(o=>cw(t,o.offset,a)||cw(t,o.end,a));if(i.length>0){t=Math.min(t,...i.map(s=>s.offset)),a=Math.max(a,...i.map(s=>s.end)),r=a-t;let o=i.shift();o.offset=t,o.length=r,o.end=a,this.list=this.list.filter(s=>!i.includes(s))}else this.list.push({offset:t,length:r,end:a})}available(t,r){let n=t+r;return this.list.some(a=>a.offset<=t&&n<=a.end)}}function cw(e,t,r){return e<=t&&t<=r}class jp extends R6{constructor(t,r){super(0),jt(this,"chunksRead",0),this.input=t,this.options=r}async readWhole(){this.chunked=!1,await this.readChunk(this.nextChunkOffset)}async readChunked(){this.chunked=!0,await this.readChunk(0,this.options.firstChunkSize)}async readNextChunk(t=this.nextChunkOffset){if(this.fullyRead)return this.chunksRead++,!1;let r=this.options.chunkSize,n=await this.readChunk(t,r);return!!n&&n.byteLength===r}async readChunk(t,r){if(this.chunksRead++,(r=this.safeWrapAddress(t,r))!==0)return this._readChunk(t,r)}safeWrapAddress(t,r){return this.size!==void 0&&t+r>this.size?Math.max(0,this.size-t):r}get nextChunkOffset(){if(this.ranges.list.length!==0)return this.ranges.list[0].length}get canReadNextChunk(){return this.chunksRead<this.options.chunkLimit}get fullyRead(){return this.size!==void 0&&this.nextChunkOffset===this.size}read(){return this.options.chunked?this.readChunked():this.readWhole()}close(){}}eo.set("blob",class extends jp{async readWhole(){this.chunked=!1;let e=await sl(this.input);this._swapArrayBuffer(e)}readChunked(){return this.chunked=!0,this.size=this.input.size,super.readChunked()}async _readChunk(e,t){let r=t?e+t:void 0,n=this.input.slice(e,r),a=await sl(n);return this.set(a,e,!0)}});var I6=Object.freeze({__proto__:null,default:$6,Exifr:ps,fileParsers:Zi,segmentParsers:Tn,fileReaders:eo,tagKeys:qn,tagValues:Ei,tagRevivers:ss,createDictionary:Nn,extendDictionary:ll,fetchUrlAsArrayBuffer:ol,readBlobAsArrayBuffer:sl,chunkedProps:Wo,otherSegments:Wc,segments:cl,tiffBlocks:mn,segmentsAndBlocks:Vo,tiffExtractables:Ho,inheritables:Vc,allFormatters:Xo,Options:vl,parse:kp,gpsOnlyOptions:C1,gps:Fj,thumbnailOnlyOptions:N1,thumbnail:Uj,thumbnailUrl:Gj,orientationOnlyOptions:M1,orientation:O1,rotations:A1,get rotateCanvas(){return Fs},get rotateCss(){return Us},rotation:zj});eo.set("url",class extends jp{async readWhole(){this.chunked=!1;let e=await ol(this.input);e instanceof ArrayBuffer?this._swapArrayBuffer(e):e instanceof Uint8Array&&this._swapBuffer(e)}async _readChunk(e,t){let r=t?e+t-1:void 0,n=this.options.httpHeaders||{};(e||r)&&(n.range=`bytes=${[e,r].join("-")}`);let a=await j1(this.input,{headers:n}),i=await a.arrayBuffer(),o=i.byteLength;if(a.status!==416)return o!==t&&(this.size=e+o),this.set(i,e,!0)}});Ma.prototype.getUint64=function(e){let t=this.getUint32(e),r=this.getUint32(e+4);return t<1048575?t<<32|r:typeof Ud!==void 0?(console.warn("Using BigInt because of type 64uint but JS can only handle 53b numbers."),Ud(t)<<Ud(32)|Ud(r)):void $n("Trying to read 64b value but JS can only handle 53b numbers.")};class L6 extends Sp{parseBoxes(t=0){let r=[];for(;t<this.file.byteLength-4;){let n=this.parseBoxHead(t);if(r.push(n),n.length===0)break;t+=n.length}return r}parseSubBoxes(t){t.boxes=this.parseBoxes(t.start)}findBox(t,r){return t.boxes===void 0&&this.parseSubBoxes(t),t.boxes.find(n=>n.kind===r)}parseBoxHead(t){let r=this.file.getUint32(t),n=this.file.getString(t+4,4),a=t+8;return r===1&&(r=this.file.getUint64(t+8),a+=8),{offset:t,length:r,kind:n,start:a}}parseBoxFullHead(t){if(t.version!==void 0)return;let r=this.file.getUint32(t.start);t.version=r>>24,t.start+=4}}class Wj extends L6{static canHandle(t,r){if(r!==0)return!1;let n=t.getUint16(2);if(n>50)return!1;let a=16,i=[];for(;a<n;)i.push(t.getString(a,4)),a+=4;return i.includes(this.type)}async parse(){let t=this.file.getUint32(0),r=this.parseBoxHead(t);for(;r.kind!=="meta";)t+=r.length,await this.file.ensureChunk(t,16),r=this.parseBoxHead(t);await this.file.ensureChunk(r.offset,r.length),this.parseBoxFullHead(r),this.parseSubBoxes(r),this.options.icc.enabled&&await this.findIcc(r),this.options.tiff.enabled&&await this.findExif(r)}async registerSegment(t,r,n){await this.file.ensureChunk(r,n);let a=this.file.subarray(r,n);this.createParser(t,a)}async findIcc(t){let r=this.findBox(t,"iprp");if(r===void 0)return;let n=this.findBox(r,"ipco");if(n===void 0)return;let a=this.findBox(n,"colr");a!==void 0&&await this.registerSegment("icc",a.offset+12,a.length)}async findExif(t){let r=this.findBox(t,"iinf");if(r===void 0)return;let n=this.findBox(t,"iloc");if(n===void 0)return;let a=this.findExifLocIdInIinf(r),i=this.findExtentInIloc(n,a);if(i===void 0)return;let[o,s]=i;await this.file.ensureChunk(o,s);let l=4+this.file.getUint32(o);o+=l,s-=l,await this.registerSegment("tiff",o,s)}findExifLocIdInIinf(t){this.parseBoxFullHead(t);let r,n,a,i,o=t.start,s=this.file.getUint16(o);for(o+=2;s--;){if(r=this.parseBoxHead(o),this.parseBoxFullHead(r),n=r.start,r.version>=2&&(a=r.version===3?4:2,i=this.file.getString(n+a+2,4),i==="Exif"))return this.file.getUintBytes(n,a);o+=r.length}}get8bits(t){let r=this.file.getUint8(t);return[r>>4,15&r]}findExtentInIloc(t,r){this.parseBoxFullHead(t);let n=t.start,[a,i]=this.get8bits(n++),[o,s]=this.get8bits(n++),l=t.version===2?4:2,u=t.version===1||t.version===2?2:0,f=s+a+i,d=t.version===2?4:2,p=this.file.getUintBytes(n,d);for(n+=d;p--;){let m=this.file.getUintBytes(n,l);n+=l+u+2+o;let v=this.file.getUint16(n);if(n+=2,m===r)return v>1&&console.warn(`ILOC box has more than one extent but we're only processing one
Please create an issue at https://github.com/MikeKovarik/exifr with this file`),[this.file.getUintBytes(n+s,a),this.file.getUintBytes(n+s+a,i)];n+=v*f}}}class Vj extends Wj{}jt(Vj,"type","heic");class uw extends Wj{}jt(uw,"type","avif"),Zi.set("heic",Vj),Zi.set("avif",uw),Nn(qn,["ifd0","ifd1"],[[256,"ImageWidth"],[257,"ImageHeight"],[258,"BitsPerSample"],[259,"Compression"],[262,"PhotometricInterpretation"],[270,"ImageDescription"],[271,"Make"],[272,"Model"],[273,"StripOffsets"],[274,"Orientation"],[277,"SamplesPerPixel"],[278,"RowsPerStrip"],[279,"StripByteCounts"],[282,"XResolution"],[283,"YResolution"],[284,"PlanarConfiguration"],[296,"ResolutionUnit"],[301,"TransferFunction"],[305,"Software"],[306,"ModifyDate"],[315,"Artist"],[316,"HostComputer"],[317,"Predictor"],[318,"WhitePoint"],[319,"PrimaryChromaticities"],[513,"ThumbnailOffset"],[514,"ThumbnailLength"],[529,"YCbCrCoefficients"],[530,"YCbCrSubSampling"],[531,"YCbCrPositioning"],[532,"ReferenceBlackWhite"],[700,"ApplicationNotes"],[33432,"Copyright"],[33723,"IPTC"],[34665,"ExifIFD"],[34675,"ICC"],[34853,"GpsIFD"],[330,"SubIFD"],[40965,"InteropIFD"],[40091,"XPTitle"],[40092,"XPComment"],[40093,"XPAuthor"],[40094,"XPKeywords"],[40095,"XPSubject"]]),Nn(qn,"exif",[[33434,"ExposureTime"],[33437,"FNumber"],[34850,"ExposureProgram"],[34852,"SpectralSensitivity"],[34855,"ISO"],[34858,"TimeZoneOffset"],[34859,"SelfTimerMode"],[34864,"SensitivityType"],[34865,"StandardOutputSensitivity"],[34866,"RecommendedExposureIndex"],[34867,"ISOSpeed"],[34868,"ISOSpeedLatitudeyyy"],[34869,"ISOSpeedLatitudezzz"],[36864,"ExifVersion"],[36867,"DateTimeOriginal"],[36868,"CreateDate"],[36873,"GooglePlusUploadCode"],[36880,"OffsetTime"],[36881,"OffsetTimeOriginal"],[36882,"OffsetTimeDigitized"],[37121,"ComponentsConfiguration"],[37122,"CompressedBitsPerPixel"],[37377,"ShutterSpeedValue"],[37378,"ApertureValue"],[37379,"BrightnessValue"],[37380,"ExposureCompensation"],[37381,"MaxApertureValue"],[37382,"SubjectDistance"],[37383,"MeteringMode"],[37384,"LightSource"],[37385,"Flash"],[37386,"FocalLength"],[37393,"ImageNumber"],[37394,"SecurityClassification"],[37395,"ImageHistory"],[37396,"SubjectArea"],[37500,"MakerNote"],[37510,"UserComment"],[37520,"SubSecTime"],[37521,"SubSecTimeOriginal"],[37522,"SubSecTimeDigitized"],[37888,"AmbientTemperature"],[37889,"Humidity"],[37890,"Pressure"],[37891,"WaterDepth"],[37892,"Acceleration"],[37893,"CameraElevationAngle"],[40960,"FlashpixVersion"],[40961,"ColorSpace"],[40962,"ExifImageWidth"],[40963,"ExifImageHeight"],[40964,"RelatedSoundFile"],[41483,"FlashEnergy"],[41486,"FocalPlaneXResolution"],[41487,"FocalPlaneYResolution"],[41488,"FocalPlaneResolutionUnit"],[41492,"SubjectLocation"],[41493,"ExposureIndex"],[41495,"SensingMethod"],[41728,"FileSource"],[41729,"SceneType"],[41730,"CFAPattern"],[41985,"CustomRendered"],[41986,"ExposureMode"],[41987,"WhiteBalance"],[41988,"DigitalZoomRatio"],[41989,"FocalLengthIn35mmFormat"],[41990,"SceneCaptureType"],[41991,"GainControl"],[41992,"Contrast"],[41993,"Saturation"],[41994,"Sharpness"],[41996,"SubjectDistanceRange"],[42016,"ImageUniqueID"],[42032,"OwnerName"],[42033,"SerialNumber"],[42034,"LensInfo"],[42035,"LensMake"],[42036,"LensModel"],[42037,"LensSerialNumber"],[42080,"CompositeImage"],[42081,"CompositeImageCount"],[42082,"CompositeImageExposureTimes"],[42240,"Gamma"],[59932,"Padding"],[59933,"OffsetSchema"],[65e3,"OwnerName"],[65001,"SerialNumber"],[65002,"Lens"],[65100,"RawFile"],[65101,"Converter"],[65102,"WhiteBalance"],[65105,"Exposure"],[65106,"Shadows"],[65107,"Brightness"],[65108,"Contrast"],[65109,"Saturation"],[65110,"Sharpness"],[65111,"Smoothness"],[65112,"MoireFilter"],[40965,"InteropIFD"]]),Nn(qn,"gps",[[0,"GPSVersionID"],[1,"GPSLatitudeRef"],[2,"GPSLatitude"],[3,"GPSLongitudeRef"],[4,"GPSLongitude"],[5,"GPSAltitudeRef"],[6,"GPSAltitude"],[7,"GPSTimeStamp"],[8,"GPSSatellites"],[9,"GPSStatus"],[10,"GPSMeasureMode"],[11,"GPSDOP"],[12,"GPSSpeedRef"],[13,"GPSSpeed"],[14,"GPSTrackRef"],[15,"GPSTrack"],[16,"GPSImgDirectionRef"],[17,"GPSImgDirection"],[18,"GPSMapDatum"],[19,"GPSDestLatitudeRef"],[20,"GPSDestLatitude"],[21,"GPSDestLongitudeRef"],[22,"GPSDestLongitude"],[23,"GPSDestBearingRef"],[24,"GPSDestBearing"],[25,"GPSDestDistanceRef"],[26,"GPSDestDistance"],[27,"GPSProcessingMethod"],[28,"GPSAreaInformation"],[29,"GPSDateStamp"],[30,"GPSDifferential"],[31,"GPSHPositioningError"]]),Nn(Ei,["ifd0","ifd1"],[[274,{1:"Horizontal (normal)",2:"Mirror horizontal",3:"Rotate 180",4:"Mirror vertical",5:"Mirror horizontal and rotate 270 CW",6:"Rotate 90 CW",7:"Mirror horizontal and rotate 90 CW",8:"Rotate 270 CW"}],[296,{1:"None",2:"inches",3:"cm"}]]);let Wu=Nn(Ei,"exif",[[34850,{0:"Not defined",1:"Manual",2:"Normal program",3:"Aperture priority",4:"Shutter priority",5:"Creative program",6:"Action program",7:"Portrait mode",8:"Landscape mode"}],[37121,{0:"-",1:"Y",2:"Cb",3:"Cr",4:"R",5:"G",6:"B"}],[37383,{0:"Unknown",1:"Average",2:"CenterWeightedAverage",3:"Spot",4:"MultiSpot",5:"Pattern",6:"Partial",255:"Other"}],[37384,{0:"Unknown",1:"Daylight",2:"Fluorescent",3:"Tungsten (incandescent light)",4:"Flash",9:"Fine weather",10:"Cloudy weather",11:"Shade",12:"Daylight fluorescent (D 5700 - 7100K)",13:"Day white fluorescent (N 4600 - 5400K)",14:"Cool white fluorescent (W 3900 - 4500K)",15:"White fluorescent (WW 3200 - 3700K)",17:"Standard light A",18:"Standard light B",19:"Standard light C",20:"D55",21:"D65",22:"D75",23:"D50",24:"ISO studio tungsten",255:"Other"}],[37385,{0:"Flash did not fire",1:"Flash fired",5:"Strobe return light not detected",7:"Strobe return light detected",9:"Flash fired, compulsory flash mode",13:"Flash fired, compulsory flash mode, return light not detected",15:"Flash fired, compulsory flash mode, return light detected",16:"Flash did not fire, compulsory flash mode",24:"Flash did not fire, auto mode",25:"Flash fired, auto mode",29:"Flash fired, auto mode, return light not detected",31:"Flash fired, auto mode, return light detected",32:"No flash function",65:"Flash fired, red-eye reduction mode",69:"Flash fired, red-eye reduction mode, return light not detected",71:"Flash fired, red-eye reduction mode, return light detected",73:"Flash fired, compulsory flash mode, red-eye reduction mode",77:"Flash fired, compulsory flash mode, red-eye reduction mode, return light not detected",79:"Flash fired, compulsory flash mode, red-eye reduction mode, return light detected",89:"Flash fired, auto mode, red-eye reduction mode",93:"Flash fired, auto mode, return light not detected, red-eye reduction mode",95:"Flash fired, auto mode, return light detected, red-eye reduction mode"}],[41495,{1:"Not defined",2:"One-chip color area sensor",3:"Two-chip color area sensor",4:"Three-chip color area sensor",5:"Color sequential area sensor",7:"Trilinear sensor",8:"Color sequential linear sensor"}],[41728,{1:"Film Scanner",2:"Reflection Print Scanner",3:"Digital Camera"}],[41729,{1:"Directly photographed"}],[41985,{0:"Normal",1:"Custom",2:"HDR (no original saved)",3:"HDR (original saved)",4:"Original (for HDR)",6:"Panorama",7:"Portrait HDR",8:"Portrait"}],[41986,{0:"Auto",1:"Manual",2:"Auto bracket"}],[41987,{0:"Auto",1:"Manual"}],[41990,{0:"Standard",1:"Landscape",2:"Portrait",3:"Night",4:"Other"}],[41991,{0:"None",1:"Low gain up",2:"High gain up",3:"Low gain down",4:"High gain down"}],[41996,{0:"Unknown",1:"Macro",2:"Close",3:"Distant"}],[42080,{0:"Unknown",1:"Not a Composite Image",2:"General Composite Image",3:"Composite Image Captured While Shooting"}]]);const fw={1:"No absolute unit of measurement",2:"Inch",3:"Centimeter"};Wu.set(37392,fw),Wu.set(41488,fw);const dm={0:"Normal",1:"Low",2:"High"};function dw(e){return typeof e=="object"&&e.length!==void 0?e[0]:e}function hw(e){let t=Array.from(e).slice(1);return t[1]>15&&(t=t.map(r=>String.fromCharCode(r))),t[2]!=="0"&&t[2]!==0||t.pop(),t.join(".")}function hm(e){if(typeof e=="string"){var[t,r,n,a,i,o]=e.trim().split(/[-: ]/g).map(Number),s=new Date(t,r-1,n);return Number.isNaN(a)||Number.isNaN(i)||Number.isNaN(o)||(s.setHours(a),s.setMinutes(i),s.setSeconds(o)),Number.isNaN(+s)?e:s}}function xu(e){if(typeof e=="string")return e;let t=[];if(e[1]===0&&e[e.length-1]===0)for(let r=0;r<e.length;r+=2)t.push(pw(e[r+1],e[r]));else for(let r=0;r<e.length;r+=2)t.push(pw(e[r],e[r+1]));return Bs(String.fromCodePoint(...t))}function pw(e,t){return e<<8|t}Wu.set(41992,dm),Wu.set(41993,dm),Wu.set(41994,dm),Nn(ss,["ifd0","ifd1"],[[50827,function(e){return typeof e!="string"?Lj(e):e}],[306,hm],[40091,xu],[40092,xu],[40093,xu],[40094,xu],[40095,xu]]),Nn(ss,"exif",[[40960,hw],[36864,hw],[36867,hm],[36868,hm],[40962,dw],[40963,dw]]),Nn(ss,"gps",[[0,e=>Array.from(e).join(".")],[7,e=>Array.from(e).join(":")]]);class pm extends Pi{static canHandle(t,r){return t.getUint8(r+1)===225&&t.getUint32(r+4)===1752462448&&t.getString(r+4,20)==="http://ns.adobe.com/"}static headerLength(t,r){return t.getString(r+4,34)==="http://ns.adobe.com/xmp/extension/"?79:33}static findPosition(t,r){let n=super.findPosition(t,r);return n.multiSegment=n.extended=n.headerLength===79,n.multiSegment?(n.chunkCount=t.getUint8(r+72),n.chunkNumber=t.getUint8(r+76),t.getUint8(r+77)!==0&&n.chunkNumber++):(n.chunkCount=1/0,n.chunkNumber=-1),n}static handleMultiSegments(t){return t.map(r=>r.chunk.getString()).join("")}normalizeInput(t){return typeof t=="string"?t:Ma.from(t).getString()}parse(t=this.chunk){if(!this.localOptions.parse)return t;t=function(i){let o={},s={};for(let l of qj)o[l]=[],s[l]=0;return i.replace(G6,(l,u,f)=>{if(u==="<"){let d=++s[f];return o[f].push(d),`${l}#${d}`}return`${l}#${o[f].pop()}`})}(t);let r=rc.findAll(t,"rdf","Description");r.length===0&&r.push(new rc("rdf","Description",void 0,t));let n,a={};for(let i of r)for(let o of i.properties)n=U6(o.ns,a),Hj(o,n);return function(i){let o;for(let s in i)o=i[s]=Y0(i[s]),o===void 0&&delete i[s];return Y0(i)}(a)}assignToOutput(t,r){if(this.localOptions.parse)for(let[n,a]of Object.entries(r))switch(n){case"tiff":this.assignObjectToOutput(t,"ifd0",a);break;case"exif":this.assignObjectToOutput(t,"exif",a);break;case"xmlns":break;default:this.assignObjectToOutput(t,n,a)}else t.xmp=r}}jt(pm,"type","xmp"),jt(pm,"multiSegment",!0),Tn.set("xmp",pm);class Q0{static findAll(t){return Xj(t,/([a-zA-Z0-9-]+):([a-zA-Z0-9-]+)=("[^"]*"|'[^']*')/gm).map(Q0.unpackMatch)}static unpackMatch(t){let r=t[1],n=t[2],a=t[3].slice(1,-1);return a=Kj(a),new Q0(r,n,a)}constructor(t,r,n){this.ns=t,this.name=r,this.value=n}serialize(){return this.value}}class rc{static findAll(t,r,n){if(r!==void 0||n!==void 0){r=r||"[\\w\\d-]+",n=n||"[\\w\\d-]+";var a=new RegExp(`<(${r}):(${n})(#\\d+)?((\\s+?[\\w\\d-:]+=("[^"]*"|'[^']*'))*\\s*)(\\/>|>([\\s\\S]*?)<\\/\\1:\\2\\3>)`,"gm")}else a=/<([\w\d-]+):([\w\d-]+)(#\d+)?((\s+?[\w\d-:]+=("[^"]*"|'[^']*'))*\s*)(\/>|>([\s\S]*?)<\/\1:\2\3>)/gm;return Xj(t,a).map(rc.unpackMatch)}static unpackMatch(t){let r=t[1],n=t[2],a=t[4],i=t[8];return new rc(r,n,a,i)}constructor(t,r,n,a){this.ns=t,this.name=r,this.attrString=n,this.innerXml=a,this.attrs=Q0.findAll(n),this.children=rc.findAll(a),this.value=this.children.length===0?Kj(a):void 0,this.properties=[...this.attrs,...this.children]}get isPrimitive(){return this.value!==void 0&&this.attrs.length===0&&this.children.length===0}get isListContainer(){return this.children.length===1&&this.children[0].isList}get isList(){let{ns:t,name:r}=this;return t==="rdf"&&(r==="Seq"||r==="Bag"||r==="Alt")}get isListItem(){return this.ns==="rdf"&&this.name==="li"}serialize(){if(this.properties.length===0&&this.value===void 0)return;if(this.isPrimitive)return this.value;if(this.isListContainer)return this.children[0].serialize();if(this.isList)return F6(this.children.map(B6));if(this.isListItem&&this.children.length===1&&this.attrs.length===0)return this.children[0].serialize();let t={};for(let r of this.properties)Hj(r,t);return this.value!==void 0&&(t.value=this.value),Y0(t)}}function Hj(e,t){let r=e.serialize();r!==void 0&&(t[e.name]=r)}var B6=e=>e.serialize(),F6=e=>e.length===1?e[0]:e,U6=(e,t)=>t[e]?t[e]:t[e]={};function Xj(e,t){let r,n=[];if(!e)return n;for(;(r=t.exec(e))!==null;)n.push(r);return n}function Kj(e){if(function(n){return n==null||n==="null"||n==="undefined"||n===""||n.trim()===""}(e))return;let t=Number(e);if(!Number.isNaN(t))return t;let r=e.toLowerCase();return r==="true"||r!=="false"&&e.trim()}const qj=["rdf:li","rdf:Seq","rdf:Bag","rdf:Alt","rdf:Description"],G6=new RegExp(`(<|\\/)(${qj.join("|")})`,"g");var Yj=Object.freeze({__proto__:null,default:I6,Exifr:ps,fileParsers:Zi,segmentParsers:Tn,fileReaders:eo,tagKeys:qn,tagValues:Ei,tagRevivers:ss,createDictionary:Nn,extendDictionary:ll,fetchUrlAsArrayBuffer:ol,readBlobAsArrayBuffer:sl,chunkedProps:Wo,otherSegments:Wc,segments:cl,tiffBlocks:mn,segmentsAndBlocks:Vo,tiffExtractables:Ho,inheritables:Vc,allFormatters:Xo,Options:vl,parse:kp,gpsOnlyOptions:C1,gps:Fj,thumbnailOnlyOptions:N1,thumbnail:Uj,thumbnailUrl:Gj,orientationOnlyOptions:M1,orientation:O1,rotations:A1,get rotateCanvas(){return Fs},get rotateCss(){return Us},rotation:zj});let gw=q0("fs",e=>e.promises);eo.set("fs",class extends jp{async readWhole(){this.chunked=!1,this.fs=await gw;let e=await this.fs.readFile(this.input);this._swapBuffer(e)}async readChunked(){this.chunked=!0,this.fs=await gw,await this.open(),await this.readChunk(0,this.options.firstChunkSize)}async open(){this.fh===void 0&&(this.fh=await this.fs.open(this.input,"r"),this.size=(await this.fh.stat(this.input)).size)}async _readChunk(e,t){this.fh===void 0&&await this.open(),e+t>this.size&&(t=this.size-e);var r=this.subarray(e,t,!0);return await this.fh.read(r.dataView,0,t,e),r}async close(){if(this.fh){let e=this.fh;this.fh=void 0,await e.close()}}});eo.set("base64",class extends jp{constructor(...e){super(...e),this.input=this.input.replace(/^data:([^;]+);base64,/gim,""),this.size=this.input.length/4*3,this.input.endsWith("==")?this.size-=2:this.input.endsWith("=")&&(this.size-=1)}async _readChunk(e,t){let r,n,a=this.input;e===void 0?(e=0,r=0,n=0):(r=4*Math.floor(e/3),n=e-r/4*3),t===void 0&&(t=this.size);let i=e+t,o=r+4*Math.ceil(i/3);a=a.slice(r,o);let s=Math.min(t,this.size-e);if(wp){let l=bp.from(a,"base64").slice(n,n+s);return this.set(l,e,!0)}{let l=this.subarray(e,s,!0),u=atob(a),f=l.toUint8();for(let d=0;d<s;d++)f[d]=u.charCodeAt(n+d);return l}}});class mw extends Sp{static canHandle(t,r){return r===18761||r===19789}extendOptions(t){let{ifd0:r,xmp:n,iptc:a,icc:i}=t;n.enabled&&r.deps.add(700),a.enabled&&r.deps.add(33723),i.enabled&&r.deps.add(34675),r.finalizeFilters()}async parse(){let{tiff:t,xmp:r,iptc:n,icc:a}=this.options;if(t.enabled||r.enabled||n.enabled||a.enabled){let i=Math.max(Hy(this.options),this.options.chunkSize);await this.file.ensureChunk(0,i),this.createParser("tiff",this.file),this.parsers.tiff.parseHeader(),await this.parsers.tiff.parseIfd0Block(),this.adaptTiffPropAsSegment("xmp"),this.adaptTiffPropAsSegment("iptc"),this.adaptTiffPropAsSegment("icc")}}adaptTiffPropAsSegment(t){if(this.parsers.tiff[t]){let r=this.parsers.tiff[t];this.injectSegment(t,r)}}}jt(mw,"type","tiff"),Zi.set("tiff",mw);let z6=q0("zlib");const W6=["ihdr","iccp","text","itxt","exif"];class yw extends Sp{constructor(...t){super(...t),jt(this,"catchError",r=>this.errors.push(r)),jt(this,"metaChunks",[]),jt(this,"unknownChunks",[])}static canHandle(t,r){return r===35152&&t.getUint32(0)===2303741511&&t.getUint32(4)===218765834}async parse(){let{file:t}=this;await this.findPngChunksInRange(8,t.byteLength),await this.readSegments(this.metaChunks),this.findIhdr(),this.parseTextChunks(),await this.findExif().catch(this.catchError),await this.findXmp().catch(this.catchError),await this.findIcc().catch(this.catchError)}async findPngChunksInRange(t,r){let{file:n}=this;for(;t<r;){let a=n.getUint32(t),i=n.getUint32(t+4),o=n.getString(t+4,4).toLowerCase(),s=a+4+4+4,l={type:o,offset:t,length:s,start:t+4+4,size:a,marker:i};W6.includes(o)?this.metaChunks.push(l):this.unknownChunks.push(l),t+=s}}parseTextChunks(){let t=this.metaChunks.filter(r=>r.type==="text");for(let r of t){let[n,a]=this.file.getString(r.start,r.size).split("\0");this.injectKeyValToIhdr(n,a)}}injectKeyValToIhdr(t,r){let n=this.parsers.ihdr;n&&n.raw.set(t,r)}findIhdr(){let t=this.metaChunks.find(r=>r.type==="ihdr");t&&this.options.ihdr.enabled!==!1&&this.createParser("ihdr",t.chunk)}async findExif(){let t=this.metaChunks.find(r=>r.type==="exif");t&&this.injectSegment("tiff",t.chunk)}async findXmp(){let t=this.metaChunks.filter(r=>r.type==="itxt");for(let r of t)r.chunk.getString(0,17)==="XML:com.adobe.xmp"&&this.injectSegment("xmp",r.chunk)}async findIcc(){let t=this.metaChunks.find(s=>s.type==="iccp");if(!t)return;let{chunk:r}=t,n=r.getUint8Array(0,81),a=0;for(;a<80&&n[a]!==0;)a++;let i=a+2,o=r.getString(0,a);if(this.injectKeyValToIhdr("ProfileName",o),K0){let s=await z6,l=r.getUint8Array(i);l=s.inflateSync(l),this.injectSegment("icc",l)}}}jt(yw,"type","png"),Zi.set("png",yw),Nn(qn,"interop",[[1,"InteropIndex"],[2,"InteropVersion"],[4096,"RelatedImageFileFormat"],[4097,"RelatedImageWidth"],[4098,"RelatedImageHeight"]]),ll(qn,"ifd0",[[11,"ProcessingSoftware"],[254,"SubfileType"],[255,"OldSubfileType"],[263,"Thresholding"],[264,"CellWidth"],[265,"CellLength"],[266,"FillOrder"],[269,"DocumentName"],[280,"MinSampleValue"],[281,"MaxSampleValue"],[285,"PageName"],[286,"XPosition"],[287,"YPosition"],[290,"GrayResponseUnit"],[297,"PageNumber"],[321,"HalftoneHints"],[322,"TileWidth"],[323,"TileLength"],[332,"InkSet"],[337,"TargetPrinter"],[18246,"Rating"],[18249,"RatingPercent"],[33550,"PixelScale"],[34264,"ModelTransform"],[34377,"PhotoshopSettings"],[50706,"DNGVersion"],[50707,"DNGBackwardVersion"],[50708,"UniqueCameraModel"],[50709,"LocalizedCameraModel"],[50736,"DNGLensInfo"],[50739,"ShadowScale"],[50740,"DNGPrivateData"],[33920,"IntergraphMatrix"],[33922,"ModelTiePoint"],[34118,"SEMInfo"],[34735,"GeoTiffDirectory"],[34736,"GeoTiffDoubleParams"],[34737,"GeoTiffAsciiParams"],[50341,"PrintIM"],[50721,"ColorMatrix1"],[50722,"ColorMatrix2"],[50723,"CameraCalibration1"],[50724,"CameraCalibration2"],[50725,"ReductionMatrix1"],[50726,"ReductionMatrix2"],[50727,"AnalogBalance"],[50728,"AsShotNeutral"],[50729,"AsShotWhiteXY"],[50730,"BaselineExposure"],[50731,"BaselineNoise"],[50732,"BaselineSharpness"],[50734,"LinearResponseLimit"],[50735,"CameraSerialNumber"],[50741,"MakerNoteSafety"],[50778,"CalibrationIlluminant1"],[50779,"CalibrationIlluminant2"],[50781,"RawDataUniqueID"],[50827,"OriginalRawFileName"],[50828,"OriginalRawFileData"],[50831,"AsShotICCProfile"],[50832,"AsShotPreProfileMatrix"],[50833,"CurrentICCProfile"],[50834,"CurrentPreProfileMatrix"],[50879,"ColorimetricReference"],[50885,"SRawType"],[50898,"PanasonicTitle"],[50899,"PanasonicTitle2"],[50931,"CameraCalibrationSig"],[50932,"ProfileCalibrationSig"],[50933,"ProfileIFD"],[50934,"AsShotProfileName"],[50936,"ProfileName"],[50937,"ProfileHueSatMapDims"],[50938,"ProfileHueSatMapData1"],[50939,"ProfileHueSatMapData2"],[50940,"ProfileToneCurve"],[50941,"ProfileEmbedPolicy"],[50942,"ProfileCopyright"],[50964,"ForwardMatrix1"],[50965,"ForwardMatrix2"],[50966,"PreviewApplicationName"],[50967,"PreviewApplicationVersion"],[50968,"PreviewSettingsName"],[50969,"PreviewSettingsDigest"],[50970,"PreviewColorSpace"],[50971,"PreviewDateTime"],[50972,"RawImageDigest"],[50973,"OriginalRawFileDigest"],[50981,"ProfileLookTableDims"],[50982,"ProfileLookTableData"],[51043,"TimeCodes"],[51044,"FrameRate"],[51058,"TStop"],[51081,"ReelName"],[51089,"OriginalDefaultFinalSize"],[51090,"OriginalBestQualitySize"],[51091,"OriginalDefaultCropSize"],[51105,"CameraLabel"],[51107,"ProfileHueSatMapEncoding"],[51108,"ProfileLookTableEncoding"],[51109,"BaselineExposureOffset"],[51110,"DefaultBlackRender"],[51111,"NewRawImageDigest"],[51112,"RawToPreviewGain"]]);let vw=[[273,"StripOffsets"],[279,"StripByteCounts"],[288,"FreeOffsets"],[289,"FreeByteCounts"],[291,"GrayResponseCurve"],[292,"T4Options"],[293,"T6Options"],[300,"ColorResponseUnit"],[320,"ColorMap"],[324,"TileOffsets"],[325,"TileByteCounts"],[326,"BadFaxLines"],[327,"CleanFaxData"],[328,"ConsecutiveBadFaxLines"],[330,"SubIFD"],[333,"InkNames"],[334,"NumberofInks"],[336,"DotRange"],[338,"ExtraSamples"],[339,"SampleFormat"],[340,"SMinSampleValue"],[341,"SMaxSampleValue"],[342,"TransferRange"],[343,"ClipPath"],[344,"XClipPathUnits"],[345,"YClipPathUnits"],[346,"Indexed"],[347,"JPEGTables"],[351,"OPIProxy"],[400,"GlobalParametersIFD"],[401,"ProfileType"],[402,"FaxProfile"],[403,"CodingMethods"],[404,"VersionYear"],[405,"ModeNumber"],[433,"Decode"],[434,"DefaultImageColor"],[435,"T82Options"],[437,"JPEGTables"],[512,"JPEGProc"],[515,"JPEGRestartInterval"],[517,"JPEGLosslessPredictors"],[518,"JPEGPointTransforms"],[519,"JPEGQTables"],[520,"JPEGDCTables"],[521,"JPEGACTables"],[559,"StripRowCounts"],[999,"USPTOMiscellaneous"],[18247,"XP_DIP_XML"],[18248,"StitchInfo"],[28672,"SonyRawFileType"],[28688,"SonyToneCurve"],[28721,"VignettingCorrection"],[28722,"VignettingCorrParams"],[28724,"ChromaticAberrationCorrection"],[28725,"ChromaticAberrationCorrParams"],[28726,"DistortionCorrection"],[28727,"DistortionCorrParams"],[29895,"SonyCropTopLeft"],[29896,"SonyCropSize"],[32781,"ImageID"],[32931,"WangTag1"],[32932,"WangAnnotation"],[32933,"WangTag3"],[32934,"WangTag4"],[32953,"ImageReferencePoints"],[32954,"RegionXformTackPoint"],[32955,"WarpQuadrilateral"],[32956,"AffineTransformMat"],[32995,"Matteing"],[32996,"DataType"],[32997,"ImageDepth"],[32998,"TileDepth"],[33300,"ImageFullWidth"],[33301,"ImageFullHeight"],[33302,"TextureFormat"],[33303,"WrapModes"],[33304,"FovCot"],[33305,"MatrixWorldToScreen"],[33306,"MatrixWorldToCamera"],[33405,"Model2"],[33421,"CFARepeatPatternDim"],[33422,"CFAPattern2"],[33423,"BatteryLevel"],[33424,"KodakIFD"],[33445,"MDFileTag"],[33446,"MDScalePixel"],[33447,"MDColorTable"],[33448,"MDLabName"],[33449,"MDSampleInfo"],[33450,"MDPrepDate"],[33451,"MDPrepTime"],[33452,"MDFileUnits"],[33589,"AdventScale"],[33590,"AdventRevision"],[33628,"UIC1Tag"],[33629,"UIC2Tag"],[33630,"UIC3Tag"],[33631,"UIC4Tag"],[33918,"IntergraphPacketData"],[33919,"IntergraphFlagRegisters"],[33921,"INGRReserved"],[34016,"Site"],[34017,"ColorSequence"],[34018,"IT8Header"],[34019,"RasterPadding"],[34020,"BitsPerRunLength"],[34021,"BitsPerExtendedRunLength"],[34022,"ColorTable"],[34023,"ImageColorIndicator"],[34024,"BackgroundColorIndicator"],[34025,"ImageColorValue"],[34026,"BackgroundColorValue"],[34027,"PixelIntensityRange"],[34028,"TransparencyIndicator"],[34029,"ColorCharacterization"],[34030,"HCUsage"],[34031,"TrapIndicator"],[34032,"CMYKEquivalent"],[34152,"AFCP_IPTC"],[34232,"PixelMagicJBIGOptions"],[34263,"JPLCartoIFD"],[34306,"WB_GRGBLevels"],[34310,"LeafData"],[34687,"TIFF_FXExtensions"],[34688,"MultiProfiles"],[34689,"SharedData"],[34690,"T88Options"],[34732,"ImageLayer"],[34750,"JBIGOptions"],[34856,"Opto-ElectricConvFactor"],[34857,"Interlace"],[34908,"FaxRecvParams"],[34909,"FaxSubAddress"],[34910,"FaxRecvTime"],[34929,"FedexEDR"],[34954,"LeafSubIFD"],[37387,"FlashEnergy"],[37388,"SpatialFrequencyResponse"],[37389,"Noise"],[37390,"FocalPlaneXResolution"],[37391,"FocalPlaneYResolution"],[37392,"FocalPlaneResolutionUnit"],[37397,"ExposureIndex"],[37398,"TIFF-EPStandardID"],[37399,"SensingMethod"],[37434,"CIP3DataFile"],[37435,"CIP3Sheet"],[37436,"CIP3Side"],[37439,"StoNits"],[37679,"MSDocumentText"],[37680,"MSPropertySetStorage"],[37681,"MSDocumentTextPosition"],[37724,"ImageSourceData"],[40965,"InteropIFD"],[40976,"SamsungRawPointersOffset"],[40977,"SamsungRawPointersLength"],[41217,"SamsungRawByteOrder"],[41218,"SamsungRawUnknown"],[41484,"SpatialFrequencyResponse"],[41485,"Noise"],[41489,"ImageNumber"],[41490,"SecurityClassification"],[41491,"ImageHistory"],[41494,"TIFF-EPStandardID"],[41995,"DeviceSettingDescription"],[42112,"GDALMetadata"],[42113,"GDALNoData"],[44992,"ExpandSoftware"],[44993,"ExpandLens"],[44994,"ExpandFilm"],[44995,"ExpandFilterLens"],[44996,"ExpandScanner"],[44997,"ExpandFlashLamp"],[46275,"HasselbladRawImage"],[48129,"PixelFormat"],[48130,"Transformation"],[48131,"Uncompressed"],[48132,"ImageType"],[48256,"ImageWidth"],[48257,"ImageHeight"],[48258,"WidthResolution"],[48259,"HeightResolution"],[48320,"ImageOffset"],[48321,"ImageByteCount"],[48322,"AlphaOffset"],[48323,"AlphaByteCount"],[48324,"ImageDataDiscard"],[48325,"AlphaDataDiscard"],[50215,"OceScanjobDesc"],[50216,"OceApplicationSelector"],[50217,"OceIDNumber"],[50218,"OceImageLogic"],[50255,"Annotations"],[50459,"HasselbladExif"],[50547,"OriginalFileName"],[50560,"USPTOOriginalContentType"],[50656,"CR2CFAPattern"],[50710,"CFAPlaneColor"],[50711,"CFALayout"],[50712,"LinearizationTable"],[50713,"BlackLevelRepeatDim"],[50714,"BlackLevel"],[50715,"BlackLevelDeltaH"],[50716,"BlackLevelDeltaV"],[50717,"WhiteLevel"],[50718,"DefaultScale"],[50719,"DefaultCropOrigin"],[50720,"DefaultCropSize"],[50733,"BayerGreenSplit"],[50737,"ChromaBlurRadius"],[50738,"AntiAliasStrength"],[50752,"RawImageSegmentation"],[50780,"BestQualityScale"],[50784,"AliasLayerMetadata"],[50829,"ActiveArea"],[50830,"MaskedAreas"],[50935,"NoiseReductionApplied"],[50974,"SubTileBlockSize"],[50975,"RowInterleaveFactor"],[51008,"OpcodeList1"],[51009,"OpcodeList2"],[51022,"OpcodeList3"],[51041,"NoiseProfile"],[51114,"CacheVersion"],[51125,"DefaultUserCrop"],[51157,"NikonNEFInfo"],[65024,"KdcIFD"]];ll(qn,"ifd0",vw),ll(qn,"exif",vw),Nn(Ei,"gps",[[23,{M:"Magnetic North",T:"True North"}],[25,{K:"Kilometers",M:"Miles",N:"Nautical Miles"}]]);class gm extends Pi{static canHandle(t,r){return t.getUint8(r+1)===224&&t.getUint32(r+4)===1246120262&&t.getUint8(r+8)===0}parse(){return this.parseTags(),this.translate(),this.output}parseTags(){this.raw=new Map([[0,this.chunk.getUint16(0)],[2,this.chunk.getUint8(2)],[3,this.chunk.getUint16(3)],[5,this.chunk.getUint16(5)],[7,this.chunk.getUint8(7)],[8,this.chunk.getUint8(8)]])}}jt(gm,"type","jfif"),jt(gm,"headerLength",9),Tn.set("jfif",gm),Nn(qn,"jfif",[[0,"JFIFVersion"],[2,"ResolutionUnit"],[3,"XResolution"],[5,"YResolution"],[7,"ThumbnailWidth"],[8,"ThumbnailHeight"]]);class xw extends Pi{parse(){return this.parseTags(),this.translate(),this.output}parseTags(){this.raw=new Map([[0,this.chunk.getUint32(0)],[4,this.chunk.getUint32(4)],[8,this.chunk.getUint8(8)],[9,this.chunk.getUint8(9)],[10,this.chunk.getUint8(10)],[11,this.chunk.getUint8(11)],[12,this.chunk.getUint8(12)],...Array.from(this.raw)])}}jt(xw,"type","ihdr"),Tn.set("ihdr",xw),Nn(qn,"ihdr",[[0,"ImageWidth"],[4,"ImageHeight"],[8,"BitDepth"],[9,"ColorType"],[10,"Compression"],[11,"Filter"],[12,"Interlace"]]),Nn(Ei,"ihdr",[[9,{0:"Grayscale",2:"RGB",3:"Palette",4:"Grayscale with Alpha",6:"RGB with Alpha",DEFAULT:"Unknown"}],[10,{0:"Deflate/Inflate",DEFAULT:"Unknown"}],[11,{0:"Adaptive",DEFAULT:"Unknown"}],[12,{0:"Noninterlaced",1:"Adam7 Interlace",DEFAULT:"Unknown"}]]);class k0 extends Pi{static canHandle(t,r){return t.getUint8(r+1)===226&&t.getUint32(r+4)===1229144927}static findPosition(t,r){let n=super.findPosition(t,r);return n.chunkNumber=t.getUint8(r+16),n.chunkCount=t.getUint8(r+17),n.multiSegment=n.chunkCount>1,n}static handleMultiSegments(t){return function(r){let n=function(a){let i=a[0].constructor,o=0;for(let u of a)o+=u.length;let s=new i(o),l=0;for(let u of a)s.set(u,l),l+=u.length;return s}(r.map(a=>a.chunk.toUint8()));return new Ma(n)}(t)}parse(){return this.raw=new Map,this.parseHeader(),this.parseTags(),this.translate(),this.output}parseHeader(){let{raw:t}=this;this.chunk.byteLength<84&&$n("ICC header is too short");for(let[r,n]of Object.entries(V6)){r=parseInt(r,10);let a=n(this.chunk,r);a!=="\0\0\0\0"&&t.set(r,a)}}parseTags(){let t,r,n,a,i,{raw:o}=this,s=this.chunk.getUint32(128),l=132,u=this.chunk.byteLength;for(;s--;){if(t=this.chunk.getString(l,4),r=this.chunk.getUint32(l+4),n=this.chunk.getUint32(l+8),a=this.chunk.getString(r,4),r+n>u)return void console.warn("reached the end of the first ICC chunk. Enable options.tiff.multiSegment to read all ICC segments.");i=this.parseTag(a,r,n),i!==void 0&&i!=="\0\0\0\0"&&o.set(t,i),l+=12}}parseTag(t,r,n){switch(t){case"desc":return this.parseDesc(r);case"mluc":return this.parseMluc(r);case"text":return this.parseText(r,n);case"sig ":return this.parseSig(r)}if(!(r+n>this.chunk.byteLength))return this.chunk.getUint8Array(r,n)}parseDesc(t){let r=this.chunk.getUint32(t+8)-1;return Bs(this.chunk.getString(t+12,r))}parseText(t,r){return Bs(this.chunk.getString(t+8,r-8))}parseSig(t){return Bs(this.chunk.getString(t+8,4))}parseMluc(t){let{chunk:r}=this,n=r.getUint32(t+8),a=r.getUint32(t+12),i=t+16,o=[];for(let s=0;s<n;s++){let l=r.getString(i+0,2),u=r.getString(i+2,2),f=r.getUint32(i+4),d=r.getUint32(i+8)+t,p=Bs(r.getUnicodeString(d,f));o.push({lang:l,country:u,text:p}),i+=a}return n===1?o[0].text:o}translateValue(t,r){return typeof t=="string"?r[t]||r[t.toLowerCase()]||t:r[t]||t}}jt(k0,"type","icc"),jt(k0,"multiSegment",!0),jt(k0,"headerLength",18);const V6={4:ao,8:function(e,t){return[e.getUint8(t),e.getUint8(t+1)>>4,e.getUint8(t+1)%16].map(r=>r.toString(10)).join(".")},12:ao,16:ao,20:ao,24:function(e,t){const r=e.getUint16(t),n=e.getUint16(t+2)-1,a=e.getUint16(t+4),i=e.getUint16(t+6),o=e.getUint16(t+8),s=e.getUint16(t+10);return new Date(Date.UTC(r,n,a,i,o,s))},36:ao,40:ao,48:ao,52:ao,64:(e,t)=>e.getUint32(t),80:ao};function ao(e,t){return Bs(e.getString(t,4))}Tn.set("icc",k0),Nn(qn,"icc",[[4,"ProfileCMMType"],[8,"ProfileVersion"],[12,"ProfileClass"],[16,"ColorSpaceData"],[20,"ProfileConnectionSpace"],[24,"ProfileDateTime"],[36,"ProfileFileSignature"],[40,"PrimaryPlatform"],[44,"CMMFlags"],[48,"DeviceManufacturer"],[52,"DeviceModel"],[56,"DeviceAttributes"],[64,"RenderingIntent"],[68,"ConnectionSpaceIlluminant"],[80,"ProfileCreator"],[84,"ProfileID"],["Header","ProfileHeader"],["MS00","WCSProfiles"],["bTRC","BlueTRC"],["bXYZ","BlueMatrixColumn"],["bfd","UCRBG"],["bkpt","MediaBlackPoint"],["calt","CalibrationDateTime"],["chad","ChromaticAdaptation"],["chrm","Chromaticity"],["ciis","ColorimetricIntentImageState"],["clot","ColorantTableOut"],["clro","ColorantOrder"],["clrt","ColorantTable"],["cprt","ProfileCopyright"],["crdi","CRDInfo"],["desc","ProfileDescription"],["devs","DeviceSettings"],["dmdd","DeviceModelDesc"],["dmnd","DeviceMfgDesc"],["dscm","ProfileDescriptionML"],["fpce","FocalPlaneColorimetryEstimates"],["gTRC","GreenTRC"],["gXYZ","GreenMatrixColumn"],["gamt","Gamut"],["kTRC","GrayTRC"],["lumi","Luminance"],["meas","Measurement"],["meta","Metadata"],["mmod","MakeAndModel"],["ncl2","NamedColor2"],["ncol","NamedColor"],["ndin","NativeDisplayInfo"],["pre0","Preview0"],["pre1","Preview1"],["pre2","Preview2"],["ps2i","PS2RenderingIntent"],["ps2s","PostScript2CSA"],["psd0","PostScript2CRD0"],["psd1","PostScript2CRD1"],["psd2","PostScript2CRD2"],["psd3","PostScript2CRD3"],["pseq","ProfileSequenceDesc"],["psid","ProfileSequenceIdentifier"],["psvm","PS2CRDVMSize"],["rTRC","RedTRC"],["rXYZ","RedMatrixColumn"],["resp","OutputResponse"],["rhoc","ReflectionHardcopyOrigColorimetry"],["rig0","PerceptualRenderingIntentGamut"],["rig2","SaturationRenderingIntentGamut"],["rpoc","ReflectionPrintOutputColorimetry"],["sape","SceneAppearanceEstimates"],["scoe","SceneColorimetryEstimates"],["scrd","ScreeningDesc"],["scrn","Screening"],["targ","CharTarget"],["tech","Technology"],["vcgt","VideoCardGamma"],["view","ViewingConditions"],["vued","ViewingCondDesc"],["wtpt","MediaWhitePoint"]]);const Gd={"4d2p":"Erdt Systems",AAMA:"Aamazing Technologies",ACER:"Acer",ACLT:"Acolyte Color Research",ACTI:"Actix Sytems",ADAR:"Adara Technology",ADBE:"Adobe",ADI:"ADI Systems",AGFA:"Agfa Graphics",ALMD:"Alps Electric",ALPS:"Alps Electric",ALWN:"Alwan Color Expertise",AMTI:"Amiable Technologies",AOC:"AOC International",APAG:"Apago",APPL:"Apple Computer",AST:"AST","AT&T":"AT&T",BAEL:"BARBIERI electronic",BRCO:"Barco NV",BRKP:"Breakpoint",BROT:"Brother",BULL:"Bull",BUS:"Bus Computer Systems","C-IT":"C-Itoh",CAMR:"Intel",CANO:"Canon",CARR:"Carroll Touch",CASI:"Casio",CBUS:"Colorbus PL",CEL:"Crossfield",CELx:"Crossfield",CGS:"CGS Publishing Technologies International",CHM:"Rochester Robotics",CIGL:"Colour Imaging Group, London",CITI:"Citizen",CL00:"Candela",CLIQ:"Color IQ",CMCO:"Chromaco",CMiX:"CHROMiX",COLO:"Colorgraphic Communications",COMP:"Compaq",COMp:"Compeq/Focus Technology",CONR:"Conrac Display Products",CORD:"Cordata Technologies",CPQ:"Compaq",CPRO:"ColorPro",CRN:"Cornerstone",CTX:"CTX International",CVIS:"ColorVision",CWC:"Fujitsu Laboratories",DARI:"Darius Technology",DATA:"Dataproducts",DCP:"Dry Creek Photo",DCRC:"Digital Contents Resource Center, Chung-Ang University",DELL:"Dell Computer",DIC:"Dainippon Ink and Chemicals",DICO:"Diconix",DIGI:"Digital","DL&C":"Digital Light & Color",DPLG:"Doppelganger",DS:"Dainippon Screen",DSOL:"DOOSOL",DUPN:"DuPont",EPSO:"Epson",ESKO:"Esko-Graphics",ETRI:"Electronics and Telecommunications Research Institute",EVER:"Everex Systems",EXAC:"ExactCODE",Eizo:"Eizo",FALC:"Falco Data Products",FF:"Fuji Photo Film",FFEI:"FujiFilm Electronic Imaging",FNRD:"Fnord Software",FORA:"Fora",FORE:"Forefront Technology",FP:"Fujitsu",FPA:"WayTech Development",FUJI:"Fujitsu",FX:"Fuji Xerox",GCC:"GCC Technologies",GGSL:"Global Graphics Software",GMB:"Gretagmacbeth",GMG:"GMG",GOLD:"GoldStar Technology",GOOG:"Google",GPRT:"Giantprint",GTMB:"Gretagmacbeth",GVC:"WayTech Development",GW2K:"Sony",HCI:"HCI",HDM:"Heidelberger Druckmaschinen",HERM:"Hermes",HITA:"Hitachi America",HP:"Hewlett-Packard",HTC:"Hitachi",HiTi:"HiTi Digital",IBM:"IBM",IDNT:"Scitex",IEC:"Hewlett-Packard",IIYA:"Iiyama North America",IKEG:"Ikegami Electronics",IMAG:"Image Systems",IMI:"Ingram Micro",INTC:"Intel",INTL:"N/A (INTL)",INTR:"Intra Electronics",IOCO:"Iocomm International Technology",IPS:"InfoPrint Solutions Company",IRIS:"Scitex",ISL:"Ichikawa Soft Laboratory",ITNL:"N/A (ITNL)",IVM:"IVM",IWAT:"Iwatsu Electric",Idnt:"Scitex",Inca:"Inca Digital Printers",Iris:"Scitex",JPEG:"Joint Photographic Experts Group",JSFT:"Jetsoft Development",JVC:"JVC Information Products",KART:"Scitex",KFC:"KFC Computek Components",KLH:"KLH Computers",KMHD:"Konica Minolta",KNCA:"Konica",KODA:"Kodak",KYOC:"Kyocera",Kart:"Scitex",LCAG:"Leica",LCCD:"Leeds Colour",LDAK:"Left Dakota",LEAD:"Leading Technology",LEXM:"Lexmark International",LINK:"Link Computer",LINO:"Linotronic",LITE:"Lite-On",Leaf:"Leaf",Lino:"Linotronic",MAGC:"Mag Computronic",MAGI:"MAG Innovision",MANN:"Mannesmann",MICN:"Micron Technology",MICR:"Microtek",MICV:"Microvitec",MINO:"Minolta",MITS:"Mitsubishi Electronics America",MITs:"Mitsuba",MNLT:"Minolta",MODG:"Modgraph",MONI:"Monitronix",MONS:"Monaco Systems",MORS:"Morse Technology",MOTI:"Motive Systems",MSFT:"Microsoft",MUTO:"MUTOH INDUSTRIES",Mits:"Mitsubishi Electric",NANA:"NANAO",NEC:"NEC",NEXP:"NexPress Solutions",NISS:"Nissei Sangyo America",NKON:"Nikon",NONE:"none",OCE:"Oce Technologies",OCEC:"OceColor",OKI:"Oki",OKID:"Okidata",OKIP:"Okidata",OLIV:"Olivetti",OLYM:"Olympus",ONYX:"Onyx Graphics",OPTI:"Optiquest",PACK:"Packard Bell",PANA:"Matsushita Electric Industrial",PANT:"Pantone",PBN:"Packard Bell",PFU:"PFU",PHIL:"Philips Consumer Electronics",PNTX:"HOYA",POne:"Phase One A/S",PREM:"Premier Computer Innovations",PRIN:"Princeton Graphic Systems",PRIP:"Princeton Publishing Labs",QLUX:"Hong Kong",QMS:"QMS",QPCD:"QPcard AB",QUAD:"QuadLaser",QUME:"Qume",RADI:"Radius",RDDx:"Integrated Color Solutions",RDG:"Roland DG",REDM:"REDMS Group",RELI:"Relisys",RGMS:"Rolf Gierling Multitools",RICO:"Ricoh",RNLD:"Edmund Ronald",ROYA:"Royal",RPC:"Ricoh Printing Systems",RTL:"Royal Information Electronics",SAMP:"Sampo",SAMS:"Samsung",SANT:"Jaime Santana Pomares",SCIT:"Scitex",SCRN:"Dainippon Screen",SDP:"Scitex",SEC:"Samsung",SEIK:"Seiko Instruments",SEIk:"Seikosha",SGUY:"ScanGuy.com",SHAR:"Sharp Laboratories",SICC:"International Color Consortium",SONY:"Sony",SPCL:"SpectraCal",STAR:"Star",STC:"Sampo Technology",Scit:"Scitex",Sdp:"Scitex",Sony:"Sony",TALO:"Talon Technology",TAND:"Tandy",TATU:"Tatung",TAXA:"TAXAN America",TDS:"Tokyo Denshi Sekei",TECO:"TECO Information Systems",TEGR:"Tegra",TEKT:"Tektronix",TI:"Texas Instruments",TMKR:"TypeMaker",TOSB:"Toshiba",TOSH:"Toshiba",TOTK:"TOTOKU ELECTRIC",TRIU:"Triumph",TSBT:"Toshiba",TTX:"TTX Computer Products",TVM:"TVM Professional Monitor",TW:"TW Casper",ULSX:"Ulead Systems",UNIS:"Unisys",UTZF:"Utz Fehlau & Sohn",VARI:"Varityper",VIEW:"Viewsonic",VISL:"Visual communication",VIVO:"Vivo Mobile Communication",WANG:"Wang",WLBR:"Wilbur Imaging",WTG2:"Ware To Go",WYSE:"WYSE Technology",XERX:"Xerox",XRIT:"X-Rite",ZRAN:"Zoran",Zebr:"Zebra Technologies",appl:"Apple Computer",bICC:"basICColor",berg:"bergdesign",ceyd:"Integrated Color Solutions",clsp:"MacDermid ColorSpan",ds:"Dainippon Screen",dupn:"DuPont",ffei:"FujiFilm Electronic Imaging",flux:"FluxData",iris:"Scitex",kart:"Scitex",lcms:"Little CMS",lino:"Linotronic",none:"none",ob4d:"Erdt Systems",obic:"Medigraph",quby:"Qubyx Sarl",scit:"Scitex",scrn:"Dainippon Screen",sdp:"Scitex",siwi:"SIWI GRAFIKA",yxym:"YxyMaster"},bw={scnr:"Scanner",mntr:"Monitor",prtr:"Printer",link:"Device Link",abst:"Abstract",spac:"Color Space Conversion Profile",nmcl:"Named Color",cenc:"ColorEncodingSpace profile",mid:"MultiplexIdentification profile",mlnk:"MultiplexLink profile",mvis:"MultiplexVisualization profile",nkpf:"Nikon Input Device Profile (NON-STANDARD!)"};Nn(Ei,"icc",[[4,Gd],[12,bw],[40,Object.assign({},Gd,bw)],[48,Gd],[80,Gd],[64,{0:"Perceptual",1:"Relative Colorimetric",2:"Saturation",3:"Absolute Colorimetric"}],["tech",{amd:"Active Matrix Display",crt:"Cathode Ray Tube Display",kpcd:"Photo CD",pmd:"Passive Matrix Display",dcam:"Digital Camera",dcpj:"Digital Cinema Projector",dmpc:"Digital Motion Picture Camera",dsub:"Dye Sublimation Printer",epho:"Electrophotographic Printer",esta:"Electrostatic Printer",flex:"Flexography",fprn:"Film Writer",fscn:"Film Scanner",grav:"Gravure",ijet:"Ink Jet Printer",imgs:"Photo Image Setter",mpfr:"Motion Picture Film Recorder",mpfs:"Motion Picture Film Scanner",offs:"Offset Lithography",pjtv:"Projection Television",rpho:"Photographic Paper Printer",rscn:"Reflective Scanner",silk:"Silkscreen",twax:"Thermal Wax Printer",vidc:"Video Camera",vidm:"Video Monitor"}]]);class zd extends Pi{static canHandle(t,r,n){return t.getUint8(r+1)===237&&t.getString(r+4,9)==="Photoshop"&&this.containsIptc8bim(t,r,n)!==void 0}static headerLength(t,r,n){let a,i=this.containsIptc8bim(t,r,n);if(i!==void 0)return a=t.getUint8(r+i+7),a%2!=0&&(a+=1),a===0&&(a=4),i+8+a}static containsIptc8bim(t,r,n){for(let a=0;a<n;a++)if(this.isIptcSegmentHead(t,r+a))return a}static isIptcSegmentHead(t,r){return t.getUint8(r)===56&&t.getUint32(r)===943868237&&t.getUint16(r+4)===1028}parse(){let{raw:t}=this,r=this.chunk.byteLength-1,n=!1;for(let a=0;a<r;a++)if(this.chunk.getUint8(a)===28&&this.chunk.getUint8(a+1)===2){n=!0;let i=this.chunk.getUint16(a+3),o=this.chunk.getUint8(a+2),s=this.chunk.getLatin1String(a+5,i);t.set(o,this.pluralizeValue(t.get(o),s)),a+=4+i}else if(n)break;return this.translate(),this.output}pluralizeValue(t,r){return t!==void 0?t instanceof Array?(t.push(r),t):[t,r]:r}}jt(zd,"type","iptc"),jt(zd,"translateValues",!1),jt(zd,"reviveValues",!1),Tn.set("iptc",zd),Nn(qn,"iptc",[[0,"ApplicationRecordVersion"],[3,"ObjectTypeReference"],[4,"ObjectAttributeReference"],[5,"ObjectName"],[7,"EditStatus"],[8,"EditorialUpdate"],[10,"Urgency"],[12,"SubjectReference"],[15,"Category"],[20,"SupplementalCategories"],[22,"FixtureIdentifier"],[25,"Keywords"],[26,"ContentLocationCode"],[27,"ContentLocationName"],[30,"ReleaseDate"],[35,"ReleaseTime"],[37,"ExpirationDate"],[38,"ExpirationTime"],[40,"SpecialInstructions"],[42,"ActionAdvised"],[45,"ReferenceService"],[47,"ReferenceDate"],[50,"ReferenceNumber"],[55,"DateCreated"],[60,"TimeCreated"],[62,"DigitalCreationDate"],[63,"DigitalCreationTime"],[65,"OriginatingProgram"],[70,"ProgramVersion"],[75,"ObjectCycle"],[80,"Byline"],[85,"BylineTitle"],[90,"City"],[92,"Sublocation"],[95,"State"],[100,"CountryCode"],[101,"Country"],[103,"OriginalTransmissionReference"],[105,"Headline"],[110,"Credit"],[115,"Source"],[116,"CopyrightNotice"],[118,"Contact"],[120,"Caption"],[121,"LocalCaption"],[122,"Writer"],[125,"RasterizedCaption"],[130,"ImageType"],[131,"ImageOrientation"],[135,"LanguageIdentifier"],[150,"AudioType"],[151,"AudioSamplingRate"],[152,"AudioSamplingResolution"],[153,"AudioDuration"],[154,"AudioOutcue"],[184,"JobID"],[185,"MasterDocumentID"],[186,"ShortDocumentID"],[187,"UniqueDocumentID"],[188,"OwnerID"],[200,"ObjectPreviewFileFormat"],[201,"ObjectPreviewFileVersion"],[202,"ObjectPreviewData"],[221,"Prefs"],[225,"ClassifyState"],[228,"SimilarityIndex"],[230,"DocumentNotes"],[231,"DocumentHistory"],[232,"ExifCameraInfo"],[255,"CatalogSets"]]),Nn(Ei,"iptc",[[10,{0:"0 (reserved)",1:"1 (most urgent)",2:"2",3:"3",4:"4",5:"5 (normal urgency)",6:"6",7:"7",8:"8 (least urgent)",9:"9 (user-defined priority)"}],[75,{a:"Morning",b:"Both Morning and Evening",p:"Evening"}],[131,{L:"Landscape",P:"Portrait",S:"Square"}]]);let mm=null;async function gs(){if(!mm)try{const n=(await Dj(()=>Promise.resolve().then(()=>yne),[])).default;if(typeof n!="function")throw new Error("JoRaw WASM import failed");const a=new URL("/assets/joraw-DraTMNgX.wasm",import.meta.url).href;mm=n({locateFile:(i,o)=>i.endsWith("joraw.wasm")?a:o+i})}catch(r){throw console.error("Failed to load joraw.js:",r),r}const e=await mm,t=e.LibRaw||e.JoRaw;if(!t)throw new Error("JoRaw class not found");return t}const T1=[[3.2404542,-1.5371385,-.4985314],[-.969266,1.8760108,.041556],[.0556434,-.2040259,1.0572252]],Hi=e=>e<=.0031308?12.92*e:1.055*Math.pow(e,1/2.4)-.055;async function Wd(e,t=0,r=0){const n=await gs(),a=new n;try{await a.open(new Uint8Array(e));const i=a.getRawImage(),o=new Uint16Array(i.data),s=i.width,l=i.height,u=Math.floor((s-t)/6)*2,f=Math.floor((l-r)/6)*2;if(u<=0||f<=0)throw new Error("Image too small for X-Trans subsampling with current phase.");const d=new Uint16Array(u*f);for(let m=0;m<f/2;m++){const v=m*6+r;if(v+3>=l)break;const b=v*s,k=(v+3)*s,x=m*2,y=x*u,w=(x+1)*u;for(let _=0;_<u/2;_++){const S=_*6+t;if(S+1>=s)break;const j=_*2;d[y+j]=o[b+S+1],d[y+j+1]=o[b+S+0],d[w+j]=o[k+S+0],d[w+j+1]=o[k+S+1]}}return{dngBuffer:w0(u,f,d),width:u,height:f}}finally{a.delete?a.delete():a.close()}}async function H6(e){const t=await createImageBitmap(e),r=t.width,n=t.height,a=document.createElement("canvas");a.width=r,a.height=n;const i=a.getContext("2d");if(!i)throw new Error("Failed to create canvas context");i.drawImage(t,0,0);const s=i.getImageData(0,0,r,n).data,l=r*n,u=new Uint16Array(l);for(let p=0;p<n;p++)for(let m=0;m<r;m++){const v=(p*r+m)*4,b=p*r+m,k=p%2===0,x=m%2===0;let y=0;k&&x?y=s[v]:!k&&!x?y=s[v+2]:y=s[v+1],u[b]=y*64}const f=await new Promise(p=>a.toBlob(p,"image/png"));let d={description:"Standard image (non-RAW)"};try{const p=await Yj.parse(e);p&&(d={...d,...p})}catch(p){console.warn("EXIF parsing failed for standard image",p)}return{previewBlob:f||e,analysisData:{data:u,width:r,height:n,bayerPattern:"RGGB",blackLevels:[0,0,0,0],whiteLevel:16320,metadata:d,isThreePlane:!0}}}const X6=async e=>{const t=await gs(),r=new t;try{await r.open(e,{useCameraWb:!0,outputBps:8,noAutoBright:!0,userQual:3,outputColor:1});const n=await r.imageData();return new Promise((a,i)=>{const o=document.createElement("canvas");o.width=n.width,o.height=n.height;const s=o.getContext("2d");if(!s){i(new Error("Could not create canvas context"));return}const l=s.createImageData(n.width,n.height),u=n.data,f=n.width*n.height;for(let d=0;d<f;d++){const p=d*3,m=d*4;l.data[m]=u[p],l.data[m+1]=u[p+1],l.data[m+2]=u[p+2],l.data[m+3]=255}s.putImageData(l,0,0),o.toBlob(d=>{d?a(d):i(new Error("Canvas to Blob failed"))},"image/jpeg",.85)})}finally{r.delete?r.delete():r.close()}},J0=async e=>{var n,a,i,o,s,l,u,f,d;const t=await gs(),r=new t;try{if(await r.open(e,{}),typeof r.getRawImage!="function")throw new Error("WASM mismatch");const p=r.getRawImage();let m=new Uint16Array(p.data);const v=await r.metadata(!0);let b={...v};try{const j=await Yj.parse(e.buffer);j&&(b={...b,...j})}catch(j){console.warn("exifr parsing failed for RAW buffer",j)}const k=((n=v.idata)==null?void 0:n.filters)||0,x=((a=v.idata)==null?void 0:a.colors)||0,y=k===0&&x===3,w=k===9;let _=[0,0,0,0],S=!1;if(r.getBlackLevels)try{const j=r.getBlackLevels();j.dng_cblack&&j.dng_cblack.length===4&&Array.from(j.dng_cblack).some(M=>M>0)?(_=Array.from(j.dng_cblack).map(Number),S=!0):j.cblack&&j.cblack.length===4&&Array.from(j.cblack).some(M=>M>0)?(_=Array.from(j.cblack).map(Number),S=!0):typeof j.black=="number"&&j.black>0&&(_=[j.black,j.black,j.black,j.black],S=!0)}catch(j){console.warn("getBlackLevels binding failed",j)}if(!S){let j=[];if((i=v.color_data)!=null&&i.cblack_rawpy_style)j=v.color_data.cblack_rawpy_style;else if((s=(o=v.color_data)==null?void 0:o.dng_levels)!=null&&s.dng_cblack)j=v.color_data.dng_levels.dng_cblack;else if(((l=v.black_level_per_channel)==null?void 0:l.length)>=4)j=v.black_level_per_channel;else if(((u=v.cblack)==null?void 0:u.length)>=4)j=v.cblack;else if(((d=(f=v.color)==null?void 0:f.cblack)==null?void 0:d.length)>=4)j=v.color.cblack;else{const M=v.black_level||v.color_data&&v.color_data.black||0;j=[M,M,M,M]}_=[Number(j[0])||0,Number(j[1])||0,Number(j[2])||0,Number(j[3])||0]}return{data:m,width:p.width,height:p.height,bayerPattern:v.color_desc||"RGGB",blackLevels:_,whiteLevel:v.white_level||16383,metadata:b,isThreePlane:y,isXTrans:w}}finally{r.delete?r.delete():r.close()}};async function Ml(e){const t=new Uint8Array(e.slice(0)),r=new Uint8Array(e.slice(0)),[n,a]=await Promise.all([X6(t),J0(r)]);return{previewBlob:n,analysisData:a}}async function pc(e){const t=new Uint8Array(e);return J0(t)}const ww=e=>(e--,e|=e>>1,e|=e>>2,e|=e>>4,e|=e>>8,e|=e>>16,e++,e);async function ym(e,t,r,n=!0){const a=await J0(new Uint8Array(e)),i=await J0(new Uint8Array(t));if(a.width!==i.width||a.height!==i.height)throw new Error("Dimension Mismatch");const o=a.width,s=a.height,l=r?ww(o):o,u=r?ww(s):s,f=l*u,d=new Uint16Array(f),p=32768,m=1.41421356;for(let v=0;v<s;v++){const b=v*o,k=v*l;for(let x=0;x<o;x++){const y=a.data[b+x],w=i.data[b+x];let _=y-w;n&&(_/=m);let S=_+p;S=Math.max(0,Math.min(65535,S)),d[k+x]=Math.round(S)}}return{rawData:d,width:l,height:u,metadata:a.metadata}}function Ns(e,t,r,n,a,i,o){const s=Math.max(0,Math.floor(n)),l=Math.max(0,Math.floor(a)),u=Math.min(t,Math.ceil(n+i)),f=Math.min(r,Math.ceil(a+o)),d=[0,0,0,0],p=[0,0,0,0],m=[0,0,0,0];for(let k=l;k<f;k++){const x=k*t,y=k%2;for(let w=s;w<u;w++){const _=w%2,S=e[x+w],j=y*2+_;d[j]+=S,p[j]+=S*S,m[j]++}}const v=[0,0,0,0],b=[0,0,0,0];for(let k=0;k<4;k++)if(m[k]>0){const x=d[k]/m[k];v[k]=x;const w=p[k]/m[k]-x*x;b[k]=Math.sqrt(Math.max(0,w))}return{x:s,y:l,width:u-s,height:f-l,means:v,stdDevs:b,pixelCount:m.reduce((k,x)=>k+x,0)}}function K6(e,t,r,n,a,i=!1){const o=Math.floor(Math.max(0,r.x)),s=Math.floor(Math.max(0,r.y)),l=Math.ceil(Math.min(t,r.x+r.w)),u=e.length/t,f=Math.ceil(Math.min(u,r.y+r.h)),d=[0,0,0,0],p=[0,0,0,0];for(let G=s;G<f;G++){const D=G*t,I=G%2;for(let F=o;F<l;F++){const H=F%2,W=I*2+H,Q=e[D+F],q=n[W]||0;d[W]+=Math.max(0,Q-q),p[W]++}}let m=0,v=3;i&&(m=3,v=0);const b=p[m]>0?d[m]/p[m]:1,k=(d[1]+d[2])/(p[1]+p[2]||1),x=p[v]>0?d[v]/p[v]:1;if(b<1||k<1||x<1)return[1,1];const y=[[a[0],a[1],a[2]],[a[3],a[4],a[5]],[a[6],a[7],a[8]]],w=al(y);if(!w)return console.warn("Color Matrix is not invertible, falling back to standard WB"),[k/b,k/x];const _=mf(T1,w),S=al(_);let j=1,M=1,A=1;if(S)j=S[0][0]+S[0][1]+S[0][2],M=S[1][0]+S[1][1]+S[1][2],A=S[2][0]+S[2][1]+S[2][2],Math.abs(M)<1e-6&&(M=1);else return console.warn("Final Matrix is not invertible"),[k/b,k/x];const $=k/b,E=k/x,T=j/M,B=A/M,U=$*T,V=E*B;return[Math.max(0,U),Math.max(0,V)]}function kw(e,t,r,n,a,i,o=0,s=0){const l=Math.max(0,Math.floor(n.x)),u=Math.max(0,Math.floor(n.y)),f=Math.min(t,Math.ceil(n.x+n.w)),d=Math.min(r,Math.ceil(n.y+n.h)),p=a>>1,m=a&1,v=(i>>1)+o,b=(i&1)+s;let k=0,x=0,y=0;for(let A=u;A<d-2;A+=2)for(let $=l;$<f-2;$+=2){const E=(A+p)*t+($+m),T=(A+v)*t+($+b);A+v>=r||$+b>=t||(k+=e[E],x+=e[T],y++)}if(y<2)return{sumCov:0,sumVar1:0,sumVar2:0,n:0};const w=k/y,_=x/y;let S=0,j=0,M=0;for(let A=u;A<d-2;A+=2)for(let $=l;$<f-2;$+=2){const E=(A+p)*t+($+m),T=(A+v)*t+($+b);if(A+v>=r||$+b>=t)continue;const B=e[E],U=e[T],V=B-w,G=U-_;S+=V*G,j+=V*V,M+=G*G}return{sumCov:S,sumVar1:j,sumVar2:M,n:y}}function q6(e){if(e.n<2)return 0;const t=Math.sqrt(e.sumVar1*e.sumVar2);return t===0?0:e.sumCov/t}function Y6(e,t,r,n,a,i,o,s,l,u,f){if(u<=l)return[];const d=Math.max(0,Math.floor(n)),p=Math.max(0,Math.floor(a)),m=Math.min(t,Math.ceil(n+i)),v=Math.min(r,Math.ceil(a+o)),b=u-l,k=f?Math.floor(b)+1:s,x=b/k,y=[new Uint32Array(k),new Uint32Array(k),new Uint32Array(k),new Uint32Array(k)];for(let _=p;_<v;_++){const S=_*t,j=_%2;for(let M=d;M<m;M++){const A=M%2,$=e[S+M];if($<l||$>u)continue;const E=j*2+A;let T;f?T=Math.floor($-l):T=Math.floor(($-l)/x),T<0&&(T=0),T>=k&&(T=k-1),y[E][T]++}}const w=[];for(let _=0;_<k;_++){const S=l+(f?_:_*x);w.push({binStart:S,c0:y[0][_],c1:y[1][_],c2:y[2][_],c3:y[3][_]})}return w}function Z6(e,t,r,n,a,i=!1,o=!1,s={rows:!1,rowGroup:0,cols:!1,colGroup:0},l=!0,u=1){const f=Math.max(0,Math.floor(n.x)),d=Math.max(0,Math.floor(n.y)),p=Math.min(t,Math.ceil(n.x+n.w)),m=Math.min(r,Math.ceil(n.y+n.h)),v=p-f,b=m-d;if(v<=1||b<=1)return null;let k=0;for(let T=f;T<p;T++)T%2===(a&1)&&k++;let x=0;for(let T=d;T<m;T++)T%2===a>>1&&x++;if(k<4||x<4)return null;const y=Math.max(1,u),w=Math.floor(2*k/(y+1)),_=Math.floor(2*x/(y+1));if(w<4||_<4)return null;const S=new il(w),j=new il(_),M=new Float32Array(Math.floor(w/2)+1),A=new Float32Array(Math.floor(_/2)+1);let $=0,E=0;for(let T=d;T<m;T++){const B=T%2;if(a>>1!==B||s.rows&&(T>>1&1)!==s.rowGroup)continue;const U=T*t,V=new Float32Array(k);let G=0;for(let D=f;D<p;D++)D%2===(a&1)&&G<k&&(V[G++]=e[U+D]);for(let D=0;D<y;D++){const I=Math.floor(D*w/2);if(I+w>k)break;const F=V.slice(I,I+w);S.calculateSpectrum(F,M,o),$++}if(!l)break}for(let T=f;T<p;T++){const B=T%2;if((a&1)!==B||s.cols&&(T>>1&1)!==s.rowGroup)continue;const U=new Float32Array(x);let V=0;for(let G=d;G<m;G++)G%2===a>>1&&V<x&&(U[V++]=e[G*t+T]);for(let G=0;G<y;G++){const D=Math.floor(G*_/2);if(D+_>x)break;const I=U.slice(D,D+_);j.calculateSpectrum(I,A,o),E++}if(!l)break}if($>0)for(let T=0;T<M.length;T++)M[T]/=$;if(E>0)for(let T=0;T<A.length;T++)A[T]/=E;return{avgHoriz:Array.from(M),avgVert:Array.from(A),sampleCount:{h:$,v:E}}}function Q6(e,t,r,n,a,i=!1){const o=Math.max(0,Math.floor(n.x)),s=Math.max(0,Math.floor(n.y)),l=Math.min(t,Math.ceil(n.x+n.w)),u=Math.min(r,Math.ceil(n.y+n.h));let f=-1;for(let y=s;y<u;y++)if(y%2===a>>1){f=y;break}if(f===-1)return null;let d=-1;for(let y=o;y<l;y++)if(y%2===(a&1)){d=y;break}if(d===-1)return null;const p=[];for(let y=f;y<u;y+=2){const w=y*t,_=[];for(let S=d;S<l;S+=2)_.push(e[w+S]);p.push(_)}const m=p.length;if(m===0)return null;const v=p[0].length;if(v===0)return null;const b=new Float32Array(v*m);for(let y=0;y<m;y++){const w=p[y];for(let _=0;_<v;_++)b[y*v+_]=w[_]}const k=b6(b,v,m,i),x=w6(k,v,m);return{width:v,height:m,data:x}}function J6(e,t,r,n,a,i,o){const{x:s,y:l,w:u,h:f}=n,d=[],p=Math.max(0,Math.floor(s)),m=Math.max(0,Math.floor(l)),v=Math.min(t,Math.ceil(s+u)),b=Math.min(r,Math.ceil(l+f)),k=a>>1,x=a&1;for(let j=m;j<b;j++){if(j%2!==k)continue;const M=j*t;for(let A=p;A<v;A++){if(A%2!==x)continue;const $=e[M+A];$>=i&&$<=o&&d.push($-i)}}if(d.length===0)return null;d.sort((j,M)=>j-M);const y=[d[0]];for(let j=1;j<d.length;j++)d[j]!==d[j-1]&&y.push(d[j]);const w=[],_=[],S={};for(let j=0;j<y.length-1;j++){const M=y[j],$=y[j+1]-M;w.push($),_.push({x:M,y:$}),S[$]=(S[$]||0)+1}return{uniqueCount:y.length,diffCount:w.length,stepCounts:S,plotData:_}}function E1(e,t,r){if(!r.advancedZeroDep)throw new Error("Unmixing settings not found in DisplaySettings.");const{bl:n,bg:a,fg:i}=r.advancedZeroDep,{data:o,width:s,whiteLevel:l}=e,u=a.map((w,_)=>Math.max(0,w-n[_])),f=i.map((w,_)=>Math.max(0,w-n[_])),d=(u[1]+u[3])/2,p=(f[1]+f[3])/2,m=Math.floor(t.x),v=Math.floor(t.y),b=Math.floor(t.w),k=Math.floor(t.h),x=Math.pow(2,r.exposure),y=new Uint16Array(b*k);for(let w=0;w<k;w++){const _=v+w;if(_<0||_>=e.height)continue;const S=_%2,j=_*s,M=w*b;for(let A=0;A<b;A++){const $=m+A;if($<0||$>=s)continue;const E=$%2;let T=0;!S&&!E?T=0:!S&&E?T=1:S&&!E?T=3:T=2;const B=o[j+$],U=n[T],V=u[T],G=f[T],D=Math.max(B-U,0),I=G-V||1e-9,F=(D-V)/I;let H;F<0?H=D*(d/Math.max(V,1e-9)):F>1?H=D*(p/Math.max(G,1e-9)):H=(1-F)*d+F*p,H*=x,y[M+A]=Math.max(0,Math.min(65535,Math.round(H)))}}return{data:y,width:b,height:k}}async function eA(e,t){const r=await gs(),n=new r;try{const a=new Uint8Array(e.slice(0));let i=!1,o=[];if(t.customMatrix&&t.customMatrix.length===9){const p=[[t.customMatrix[0],t.customMatrix[1],t.customMatrix[2]],[t.customMatrix[3],t.customMatrix[4],t.customMatrix[5]],[t.customMatrix[6],t.customMatrix[7],t.customMatrix[8]]],m=al(p);if(m){const v=t.wbGains?t.wbGains[0]:1,b=t.wbGains?t.wbGains[1]:1,x=mf(m,[[v,0,0],[0,1,0],[0,0,b]]),y=mf(T1,x);o=[y[0][0],y[0][1],y[0][2],y[1][0],y[1][1],y[1][2],y[2][0],y[2][1],y[2][2]],i=!0}else throw new Error("Custom Matrix is not invertible.")}const s={outputBps:16,noAutoBright:!0,bright:i?1:Math.pow(2,t.exposure)};t.blackLevel&&t.blackLevel.length===4&&(s.userBlack=0,s.userCblack=t.blackLevel.map(p=>{const m=Math.round(p);return m===0?1:m})),t.demosaicMethod===-1?s.noInterpolation=!0:s.userQual=t.demosaicMethod,i?(s.outputColor=0,s.gamma=[1,1],s.userMul=[1,1,1,1],s.useCameraWb=!1):(s.outputColor=1,s.useCameraWb=!0),await n.open(a,s);const l=await n.imageData(),u=new ImageData(l.width,l.height),f=u.data,d=new Uint16Array(l.data.buffer,l.data.byteOffset,l.data.byteLength/2);if(i&&o.length===9){const p=o,v=Math.pow(2,t.exposure)*.25;for(let b=0;b<d.length;b+=3){const k=d[b]/65535,x=d[b+1]/65535,y=d[b+2]/65535;let w=p[0]*k+p[1]*x+p[2]*y,_=p[3]*k+p[4]*x+p[5]*y,S=p[6]*k+p[7]*x+p[8]*y;w*=v,_*=v,S*=v,w=Math.max(0,Math.min(1,w)),_=Math.max(0,Math.min(1,_)),S=Math.max(0,Math.min(1,S)),w=Hi(w),_=Hi(_),S=Hi(S);const j=b/3*4;f[j]=Math.round(w*255),f[j+1]=Math.round(_*255),f[j+2]=Math.round(S*255),f[j+3]=255}}else for(let p=0;p<d.length;p+=3){const m=p/3*4;f[m]=d[p]>>8,f[m+1]=d[p+1]>>8,f[m+2]=d[p+2]>>8,f[m+3]=255}return u}finally{n.delete?n.delete():n.close()}}async function vm(e,t){const r=await gs(),n=new r;try{await n.open(new Uint8Array(e));let a=16383;try{const b=await n.metadata(!0);b&&b.white_level&&(a=b.white_level)}catch(b){console.warn("Metadata error",b)}const i=n.getRawImage(),o=i.width,s=i.height,l=i.data,u=new ImageData(o,s),f=u.data,d=t.blackLevel||[0,0,0,0],p=a,m=t.wbGains?t.wbGains[0]:1,v=t.wbGains?t.wbGains[1]:1;for(let b=0;b<s;b++){const k=b%2;for(let x=0;x<o;x++){const y=x%2,w=k*2+y,_=l[b*o+x],S=d[w];let j=(_-S)/(p-S);j=Math.max(0,Math.min(1,j)),t.exposure!==0&&(j*=Math.pow(2,t.exposure),j=Math.min(1,j)),w===0?j*=m:w===3&&(j*=v);const M=Math.round(Hi(Math.min(1,j))*255),A=(b*o+x)*4;f[A]=M,f[A+1]=M,f[A+2]=M,f[A+3]=255}}return u}finally{n.delete?n.delete():n.close()}}async function tA(e,t){const r=await gs(),n=new r;try{await n.open(new Uint8Array(e));let a=16383;try{const B=await n.metadata(!0);B&&B.white_level&&(a=B.white_level)}catch{}const i=n.getRawImage(),{width:o,height:s,data:l}=i,u=new ImageData(o,s),f=u.data,d=t.blackLevel||[0,0,0,0],p=a,m=t.wbGains?t.wbGains[0]:1,v=t.wbGains?t.wbGains[1]:1,b=Math.pow(2,t.exposure),k=!!t.isBGGR;let x=[[1,0,0],[0,1,0],[0,0,1]];if(t.customMatrix&&t.customMatrix.length===9){const B=[[t.customMatrix[0],t.customMatrix[1],t.customMatrix[2]],[t.customMatrix[3],t.customMatrix[4],t.customMatrix[5]],[t.customMatrix[6],t.customMatrix[7],t.customMatrix[8]]],U=al(B);U&&(x=mf(T1,U))}const y=x[0][0],w=x[0][1],_=x[0][2],S=x[1][0],j=x[1][1],M=x[1][2],A=x[2][0],$=x[2][1],E=x[2][2],T=new Float32Array(o*s);for(let B=0;B<o*s;B++){const U=Math.floor(B/o),V=B%o,G=U%2,D=V%2,I=G*2+D,F=l[B],H=d[I];let W=(F-H)/(p-H);W=Math.max(0,W),k?I===0?W*=v:I===3&&(W*=m):I===0?W*=m:I===3&&(W*=v),T[B]=W}for(let B=1;B<s-1;B++){const U=B%2,V=B*o;for(let G=1;G<o-1;G++){const D=G%2,I=V+G;let F=0,H=0,W=0,Q=!1,q=!1,re=!1;if(!U&&!D?k?q=!0:Q=!0:U&&D?k?Q=!0:q=!0:re=!0,Q)F=T[I],H=(T[I-1]+T[I+1]+T[I-o]+T[I+o])*.25,W=(T[I-o-1]+T[I-o+1]+T[I+o-1]+T[I+o+1])*.25;else if(q)W=T[I],H=(T[I-1]+T[I+1]+T[I-o]+T[I+o])*.25,F=(T[I-o-1]+T[I-o+1]+T[I+o-1]+T[I+o+1])*.25;else{H=T[I];const ae=(T[I-1]+T[I+1])*.5,X=(T[I-o]+T[I+o])*.5;let se=!1;!U&&D?k?se=!1:se=!0:k?se=!0:se=!1,se?(F=ae,W=X):(W=ae,F=X)}let ee=y*F+w*H+_*W,fe=S*F+j*H+M*W,oe=A*F+$*H+E*W;ee*=b,fe*=b,oe*=b,ee=Math.max(0,Math.min(1,ee)),fe=Math.max(0,Math.min(1,fe)),oe=Math.max(0,Math.min(1,oe)),ee=Hi(ee),fe=Hi(fe),oe=Hi(oe);const ye=I*4;f[ye]=Math.round(ee*255),f[ye+1]=Math.round(fe*255),f[ye+2]=Math.round(oe*255),f[ye+3]=255}}return u}finally{n.delete?n.delete():n.close()}}async function rA(e,t){const r=await gs(),n=new r;try{await n.open(new Uint8Array(e));let a=16383;try{const y=await n.metadata(!0);y&&y.white_level&&(a=y.white_level)}catch(y){console.warn("Metadata error",y)}const i=n.getRawImage(),{width:o,height:s,data:l}=i,u=new ImageData(o,s),f=u.data;if(!t.advancedZeroDep)throw new Error("Missing advanced settings");const{bl:d,bg:p,fg:m}=t.advancedZeroDep,v=p.map((y,w)=>Math.max(0,y-d[w])),b=m.map((y,w)=>Math.max(0,y-d[w])),k=(v[1]+v[3])/2,x=(b[1]+b[3])/2;for(let y=0;y<s;y++){const w=y%2;for(let _=0;_<o;_++){const S=_%2;let j=0;!w&&!S?j=0:!w&&S?j=1:w&&!S?j=3:j=2;const M=l[y*o+_],A=d[j],$=v[j],E=b[j],T=Math.max(M-A,0),B=E-$||1e-9,U=(T-$)/B;let V;U<0?V=T*(k/Math.max($,1e-9)):U>1?V=T*(x/Math.max(E,1e-9)):V=(1-U)*k+U*x;let G=V/65535;G=Math.max(0,Math.min(1,G));const D=Math.round(Hi(G)*255),I=(y*o+_)*4;f[I]=D,f[I+1]=D,f[I+2]=D,f[I+3]=255}}return u}finally{n.delete?n.delete():n.close()}}async function nA(e,t,r=!1,n=!1){const a=await gs(),i=new a;try{if(t.renderMode==="zero-dependency"||t.renderMode==="advanced-zero-dep"){await i.open(new Uint8Array(e));const o=await i.metadata(!0),s=(o==null?void 0:o.white_level)||16383,l=i.getRawImage(),{width:u,height:f,data:d}=l,p=new Uint16Array(u*f),m=Math.pow(2,t.exposure);if(t.renderMode==="advanced-zero-dep"&&t.advancedZeroDep){const{bl:v,bg:b,fg:k}=t.advancedZeroDep,x=b.map((S,j)=>Math.max(0,S-v[j])),y=k.map((S,j)=>Math.max(0,S-v[j])),w=(x[1]+x[3])/2,_=(y[1]+y[3])/2;for(let S=0;S<f;S++){const j=S%2;for(let M=0;M<u;M++){const A=M%2;let $=0;!j&&!A?$=0:!j&&A?$=1:j&&!A?$=3:$=2;const E=d[S*u+M],T=v[$],B=x[$],U=y[$],V=Math.max(E-T,0),G=U-B||1e-9,D=(V-B)/G;let I;D<0?I=V*(w/Math.max(B,1e-9)):D>1?I=V*(_/Math.max(U,1e-9)):I=(1-D)*w+D*_,I*=m;let F;if(n){const H=Math.max(0,Math.min(1,I/65535));F=Hi(H)*65535}else F=I;p[S*u+M]=Math.round(Math.max(0,Math.min(65535,F)))}}}else{const v=t.blackLevel||[0,0,0,0],b=t.wbGains?t.wbGains[0]:1,k=t.wbGains?t.wbGains[1]:1;for(let x=0;x<f;x++){const y=x%2;for(let w=0;w<u;w++){const _=w%2,S=y*2+_,j=d[x*u+w],M=v[S];let A=j-M;S===0?A*=b:S===3&&(A*=k),A*=m;const $=Math.max(0,Math.min(1,A/(r?s-M:s))),E=n?Hi($):$;p[x*u+w]=Math.round(E*65535)}}}return{data:p,width:u,height:f,channels:1}}else{const o=new Uint8Array(e.slice(0)),s={outputBps:16,noAutoBright:!r,bright:1,outputColor:n?1:0,useCameraWb:!0};t.blackLevel&&t.blackLevel.length===4&&(s.userBlack=0,s.userCblack=t.blackLevel.map(d=>Math.max(1,Math.round(d)))),t.demosaicMethod===-1?s.noInterpolation=!0:s.userQual=t.demosaicMethod,await i.open(o,s);const l=await i.imageData(),u=new Uint16Array(l.data.buffer,l.data.byteOffset,l.data.byteLength/2),f=Math.pow(2,t.exposure);if(f!==1)for(let d=0;d<u.length;d++)u[d]=Math.max(0,Math.min(65535,Math.round(u[d]*f)));return{data:u,width:l.width,height:l.height,channels:3}}}finally{i.delete?i.delete():i.close()}}const Ms=({title:e,children:t})=>c.jsxs("div",{className:"border-b border-gray-200 dark:border-slate-700 transition-colors duration-300",children:[c.jsx("div",{className:"p-4 font-semibold text-gray-800 dark:text-slate-200 bg-gray-50 dark:bg-slate-800/30 border-b border-gray-200 dark:border-slate-800 select-none cursor-default transition-colors duration-300",children:c.jsx("span",{children:e})}),c.jsx("div",{className:"p-4 bg-white dark:bg-slate-900/50 transition-colors duration-300",children:t})]}),aA=[{value:-1,label:"Raw Bayer (Grayscale)"},{value:0,label:"Linear interpolation"},{value:1,label:"VNG (Variable Number of Gradients)"},{value:2,label:"PPG (Patterned Pixel Grouping)"},{value:3,label:"AHD (Adaptive Homogeneity-Directed)"},{value:4,label:"DCB (Demosaicing with Color Back-refinement)"},{value:11,label:"DHT (Modified AHD)"},{value:12,label:"AAHD (Adaptive AHD)"}],Vd=({checked:e,onChange:t,label:r})=>c.jsxs("div",{className:"flex items-center justify-between py-2 cursor-pointer group",onClick:()=>t(!e),children:[c.jsx("span",{className:"text-sm font-medium text-gray-600 dark:text-slate-300 select-none group-hover:text-gray-900 dark:group-hover:text-slate-200 transition-colors",children:r}),c.jsx("div",{className:`relative w-11 h-6 rounded-full transition-colors duration-200 ease-in-out ${e?"bg-cyan-500 dark:bg-cyan-600":"bg-gray-300 dark:bg-slate-600 group-hover:bg-gray-400 dark:group-hover:bg-slate-500"}`,children:c.jsx("div",{className:`absolute left-1 top-1 bg-white w-4 h-4 rounded-full shadow-md transform transition-transform duration-200 ease-in-out ${e?"translate-x-5":"translate-x-0"}`})})]}),Hd=[{x:0,y:0},{x:1,y:1}],Xd=e=>e.map(t=>({x:t.x,y:t.y})),iA=()=>({master:Xd(Hd),red:Xd(Hd),green:Xd(Hd),blue:Xd(Hd)}),Sw=e=>{const t=iA();if(!e)return t;const r=n=>{const a=e==null?void 0:e[n];return Array.isArray(a)&&a.length>=2?a.map(i=>({x:Math.max(0,Math.min(1,Number((i==null?void 0:i.x)??0))),y:Math.max(0,Math.min(1,Number((i==null?void 0:i.y)??0)))})).filter(i=>!Number.isNaN(i.x)&&!Number.isNaN(i.y)).sort((i,o)=>i.x-o.x):t[n]};return{master:r("master"),red:r("red"),green:r("green"),blue:r("blue")}},oA=e=>{const t=[...e].sort((l,u)=>l.x-u.x),r=t.length,n=t.map(l=>l.x),a=t.map(l=>l.y);if(r<2)return l=>r===1?a[0]:0;const i=new Array(r-1).fill(0);for(let l=0;l<r-1;l++){const u=n[l+1]-n[l],f=a[l+1]-a[l];i[l]=u!==0?f/u:0}const o=new Array(r).fill(0);o[0]=i[0],o[r-1]=i[r-2];for(let l=1;l<r-1;l++)i[l-1]*i[l]<=0?o[l]=0:o[l]=(i[l-1]+i[l])/2;for(let l=0;l<r-1;l++){if(i[l]===0){o[l]=0,o[l+1]=0;continue}const u=o[l]/i[l],f=o[l+1]/i[l],d=u*u+f*f;if(d>9){const p=3/Math.sqrt(d);o[l]=p*u*i[l],o[l+1]=p*f*i[l]}}const s=(l,u)=>{const f=n[l],d=n[l+1],p=a[l],m=a[l+1],v=d-f;if(v<=0)return p;const b=(u-f)/v,k=b*b,x=k*b,y=2*x-3*k+1,w=x-2*k+b,_=-2*x+3*k,S=x-k,j=y*p+w*v*o[l]+_*m+S*v*o[l+1];return Math.max(0,Math.min(1,j))};return l=>{if(l<=n[0])return a[0];if(l>=n[r-1])return a[r-1];let u=0;for(;u<r-2&&l>n[u+1];)u++;return s(u,l)}},sA=({channel:e,points:t,onChange:r})=>{const n=C.useRef(null),[a,i]=C.useState(null),o=C.useMemo(()=>[...t].sort((m,v)=>m.x-v.x),[t]),s=C.useMemo(()=>{if(o.length<2)return"";const m=oA(o),v=120;let b=`M ${o[0].x*256} ${256-o[0].y*256}`;for(let k=1;k<=v;k++){const x=k/v,y=m(x);b+=` L ${x*256} ${256-y*256}`}return b},[o]),l=m=>{if(!n.current)return{x:0,y:0};const v=n.current.getBoundingClientRect();return{x:Math.max(0,Math.min(1,(m.clientX-v.left)/v.width)),y:Math.max(0,Math.min(1,1-(m.clientY-v.top)/v.height))}},u=(m,v)=>{m.stopPropagation(),m.preventDefault(),i(v)},f=m=>{if(a!==null)return;const v=l(m);if(o.some(k=>Math.abs(k.x-v.x)<.04))return;const b=[...o,v].sort((k,x)=>k.x-x.x);r(b)},d=(m,v)=>{m.stopPropagation(),!(v===0||v===o.length-1)&&r(o.filter((b,k)=>k!==v))};C.useEffect(()=>{const m=b=>{if(a===null)return;const k=l(b);let x=0,y=1;a>0&&(x=o[a-1].x+.01),a<o.length-1&&(y=o[a+1].x-.01),a===0?k.x=0:a===o.length-1?k.x=1:k.x=Math.max(x,Math.min(y,k.x));const w=[...o];w[a]=k,r(w)},v=()=>i(null);return a!==null&&(window.addEventListener("mousemove",m),window.addEventListener("mouseup",v)),()=>{window.removeEventListener("mousemove",m),window.removeEventListener("mouseup",v)}},[a,o,r]);const p=e==="master"?"#94a3b8":e==="red"?"#ef4444":e==="green"?"#22c55e":"#3b82f6";return c.jsx("div",{className:"w-full aspect-square bg-white dark:bg-slate-900 border border-gray-300 dark:border-slate-700 rounded relative select-none",children:c.jsxs("svg",{ref:n,width:"100%",height:"100%",viewBox:"0 0 256 256",className:"cursor-crosshair",onMouseDown:f,children:[c.jsx("path",{d:"M0,0 L0,256 L256,256 L256,0 Z",fill:"none",stroke:"transparent"}),c.jsx("path",{d:"M64,0 v256 M128,0 v256 M192,0 v256",stroke:"rgba(128,128,128,0.2)",strokeDasharray:"4 4"}),c.jsx("path",{d:"M0,64 h256 M0,128 h256 M0,192 h256",stroke:"rgba(128,128,128,0.2)",strokeDasharray:"4 4"}),c.jsx("line",{x1:"0",y1:"256",x2:"256",y2:"0",stroke:"rgba(128,128,128,0.1)"}),c.jsx("path",{d:s,fill:"none",stroke:p,strokeWidth:"2"}),o.map((m,v)=>c.jsx("circle",{cx:m.x*256,cy:256-m.y*256,r:a===v?6:4,fill:p,stroke:"white",strokeWidth:"1.5",className:"cursor-pointer",onMouseDown:b=>u(b,v),onDoubleClick:b=>d(b,v)},v))]})})},xm=(e,t)=>{if(!e)return null;if(t){const r=e.bayerPattern.toUpperCase(),n=l=>{const u=[];for(let f=0;f<4;f++)r[f]===l&&u.push(f);return u},a=t.BlackLevelRed,i=t.BlackLevelGreen,o=t.BlackLevelBlue;if(a!==void 0&&i!==void 0&&o!==void 0){const l=parseFloat(a),u=parseFloat(i),f=parseFloat(o);if(!isNaN(l)&&!isNaN(u)&&!isNaN(f)){const d=[0,0,0,0];return d.fill(u),n("R").forEach(p=>d[p]=l),n("G").forEach(p=>d[p]=u),n("B").forEach(p=>d[p]=f),d}}let s=t.BlackLevel;if(s===void 0&&(s=t.BlackLevel2),s!==void 0){let l=[];if(Array.isArray(s)?l=s.map(Number):typeof s=="string"?l=s.trim().split(/\s+/).map(Number):typeof s=="number"&&(l=[s,s,s,s]),l.length===1&&!isNaN(l[0])&&(l=[l[0],l[0],l[0],l[0]]),l.length>=4&&!l.slice(0,4).some(isNaN))return[l[0],l[1],l[2],l[3]]}}return e.blackLevels&&e.blackLevels.length===4?[e.blackLevels[0],e.blackLevels[1],e.blackLevels[2],e.blackLevels[3]]:null},lA=e=>{var Ri;const{rawImageData:t,displaySettings:r,onApplyDisplaySettings:n,onSetSelection:a,exifData:i,isBridgeConnected:o,isDrLabOpen:s,drMarkingStep:l,onStartMarking:u,onGenerateTestPic:f,drRoiSize:d,onDrRoiSizeChange:p,drGridRows:m,onDrGridRowsChange:v,drGridCols:b,onDrGridColsChange:k,onBatchDrLab:x,hasDrMarkers:y,isFftLabOpen:w,onProcessPair:_,onProcessBatchDiff:S,onProcessStackFft:j,onOpenCrossCalc:M,isThreePlane:A,onToggleXTrans:$,xtransPhase:E,onXTransPhaseChange:T,isXTransConverted:B,onCommand:U,isColorLabOpen:V,colorLabMarkingStep:G,onStartColorLabMarking:D,isSfrLabOpen:I,roiStats:F,isBGGR:H,onOpenDngExport:W,sfrRectCount:Q,isBatchMarkingMode:q,onToggleBatchMarking:re,onClearBatchMarks:ee,onBatchCompute:fe,stdChartStep:oe,onStartStandardCalibration:ye,onSaveBatchTemplate:ae,onImportBatchTemplate:X,onBatchTransform:se,onOpenStackingTool:he,isPsModeOpen:le}=e,je=!!t,ke=!!(t!=null&&t.isXTrans),ve=!!$,ge=C.useRef(!1),Me=C.useRef(null),Oe=()=>{ge.current=!0},We=()=>{ge.current=!1},[Le,tt]=C.useState(r.exposure.toString()),[mt,wt]=C.useState(""),[Qt,_t]=C.useState("0 0 0 0"),[Jt,Nt]=C.useState("1.0"),[er,Vr]=C.useState("1.0"),[Tt,Sr]=C.useState(r.demosaicMethod),[Ve,Pt]=C.useState(!!r.showKadc),[Bt,Dt]=C.useState(!!r.subtractBlackLevelFromStats),[tr,rr]=C.useState(!!r.highlightRecovery),[Hr,Ft]=C.useState(((Ri=r.customWhiteLevel)==null?void 0:Ri.toString())||(t==null?void 0:t.whiteLevel.toString())||"16383"),[bn,Ct]=C.useState("64"),[tn,Ge]=C.useState(!1),[rn,Ar]=C.useState(""),[sn,Xr]=C.useState(""),[Tr,Cr]=C.useState(""),[Er,wn]=C.useState(!1),[kn,qt]=C.useState(!1),[Et,fr]=C.useState(!1),[O,De]=C.useState(!1),[ht,Vt]=C.useState(!1),[$t,mr]=C.useState("single"),[$r,nr]=C.useState(!1),[He,pt]=C.useState(!0),[It,Ht]=C.useState(!0),[Ut,Se]=C.useState(!1),[ln,L]=C.useState(10),[we,Ne]=C.useState(1.05),gt=C.useMemo(()=>Object.keys(hc).sort(),[]),Xe=C.useRef(null),ot=C.useRef(null),ct=C.useRef(null),Yt=C.useRef(null),[xr,hn]=C.useState(null),[Gt,Sn]=C.useState(null),[jn,Zn]=C.useState(!1),[or,sr]=C.useState(!0),yr=C.useRef(null),Be=C.useRef(null),Zt=C.useRef(null),[jr,Qn]=C.useState("master"),[Jn,Kr]=C.useState(()=>Sw(r.curves));C.useEffect(()=>{Kr(Sw(r.curves))},[r.curves]);const qa=C.useCallback(ie=>{Kr(_e=>{const kt={..._e,[jr]:ie};return n({...r,curves:kt}),kt})},[jr,r,n]);C.useEffect(()=>{const ie=t!==Me.current;if(!(ge.current&&!ie)){if(ie&&(Me.current=t,We()),tt(r.exposure.toString()),r.customMatrix?wt(r.customMatrix.join(" ")):wt(""),r.blackLevel&&r.blackLevel.length===4)_t(r.blackLevel.join(" "));else{const _e=xm(t,i);_e&&_e.some(kt=>kt!==0)?_t(_e.join(" ")):_t("")}Nt(r.wbGains?r.wbGains[0].toString():"1.0"),Vr(r.wbGains?r.wbGains[1].toString():"1.0"),Sr(r.demosaicMethod),Pt(!!r.showKadc),Dt(!!r.subtractBlackLevelFromStats),rr(!!r.highlightRecovery),r.customWhiteLevel?Ft(r.customWhiteLevel.toString()):t!=null&&t.whiteLevel&&Ft(t.whiteLevel.toString()),r.advancedZeroDep&&(Ar(r.advancedZeroDep.bl.join(" ")),Xr(r.advancedZeroDep.bg.join(" ")),Cr(r.advancedZeroDep.fg.join(" ")),ie&&Ge(!0))}},[r,t,i]);const te=C.useRef(!1),me=C.useRef(null);C.useEffect(()=>{t!==me.current&&(te.current=!1,me.current=t)},[t]),C.useEffect(()=>{if(o&&t&&!te.current){te.current=!0;const ie=xm(t,i),_e=ie&&ie.some(kt=>kt>0);if(ie&&_e){console.log("[AutoApply] Detected Black Levels via Bridge:",ie);const kt={...r,blackLevel:ie,showKadc:!1,subtractBlackLevelFromStats:!1,exposure:r.exposure,wbGains:r.wbGains||[1,1],demosaicMethod:-1,renderMode:"zero-dependency"};n(kt)}}},[o,t,i,r,n]);const be=ie=>{Oe(),tt(ie)},Y=ie=>{Oe(),Nt(ie)},Ae=ie=>{Oe(),Vr(ie)},at=ie=>{Oe(),Sr(parseInt(ie.target.value,10))},rt=ie=>{Oe(),wt(ie.target.value)},Lt=()=>{We(),tt("0"),Sr(3),Nt("1.0"),Vr("1.0"),Pt(!0),Dt(!0),wt(""),rr(!1),Ft((t==null?void 0:t.whiteLevel.toString())||"16383"),Ge(!1);const ie=xm(t,i);_t(ie&&ie.some(_e=>_e!==0)?ie.join(" "):"")},dt=()=>{!t||!a||(a({x:0,y:0,w:t.width,h:t.height}),U==null||U("sel full"))},yt=()=>{if(!t||!a)return;const ie=parseInt(bn,10);if(isNaN(ie)||ie<=0)return;const _e=Math.min(ie,t.width),kt=Math.min(ie,t.height),vt=Math.floor((t.width-_e)/2),Ir=Math.floor((t.height-kt)/2);a({x:vt,y:Ir,w:_e,h:kt}),U==null||U(`sel center ${ie}`)},dr=()=>{if(!t||!F){alert("Please select a region on the image first.");return}const ie=ar()||[0,0,0,0],_e=mt.trim().replace(/[\s,\n]+/g," "),kt=_e?_e.split(" ").map(Number):[1,0,0,0,1,0,0,0,1];if(kt.length!==9){alert("Matrix must be 3x3 (9 values).");return}const[vt,Ir]=K6(t.data,t.width,{x:F.x,y:F.y,w:F.width,h:F.height},ie,kt,H);Oe(),Nt(vt.toFixed(4)),Vr(Ir.toFixed(4)),U==null||U(`wb ${vt.toFixed(4)} ${Ir.toFixed(4)} (Spot)`)},ar=()=>{const _e=Qt.split(/[\s,]+/).filter(kt=>kt.trim()!=="").map(Number);if(_e.length===1&&!isNaN(_e[0]))return[_e[0],_e[0],_e[0],_e[0]];if(_e.length>=4&&!_e.slice(0,4).some(isNaN))return[_e[0],_e[1],_e[2],_e[3]]},cr=ie=>{const _e=ie.trim().split(/[\s,]+/).map(Number);return _e.length===4&&!_e.some(isNaN)?_e:_e.length===1&&!isNaN(_e[0])?[_e[0],_e[0],_e[0],_e[0]]:null},hr=()=>{We(),U&&(Le!=="0"&&U(`ev ${Le}`),(Jt!=="1.0"||er!=="1.0")&&U(`wb ${Jt} ${er}`),Qt!=="0 0 0 0"&&Qt!==""&&U(`bl ${Qt}`),Tt!==3&&U(`demo ${Tt}`),mt.trim().length>0&&U(`matrix ${mt.replace(/\s+/g," ")}`),U("render"));const ie={...r},_e=parseFloat(Le);isNaN(_e)||(ie.exposure=_e);const kt=parseFloat(Jt),vt=parseFloat(er);!isNaN(kt)&&!isNaN(vt)&&(ie.wbGains=[kt,vt]),ie.demosaicMethod=Tt,ie.renderMode="standard";const Ir=ar();Ir?ie.blackLevel=Ir:delete ie.blackLevel;const _n=mt.trim().replace(/[\s,\n]+/g," ");if(_n){const br=_n.split(" ").map(Number);br.length===9&&!br.some(isNaN)?ie.customMatrix=br:alert("Invalid matrix format. Please ensure exactly 9 numeric values (3x3).")}else delete ie.customMatrix;if(ie.showKadc=Ve,ie.subtractBlackLevelFromStats=Bt,ie.highlightRecovery=tr,tr){const br=parseFloat(Hr);!isNaN(br)&&br>0&&(ie.customWhiteLevel=br)}else delete ie.customWhiteLevel;n(ie)},Pe=()=>{fr(H||!1),qt(!0)},ut=ie=>{We(),U&&(Le!=="0"&&U(`ev ${Le}`),(Jt!=="1.0"||er!=="1.0")&&U(`wb ${Jt} ${er}`),Qt!=="0 0 0 0"&&Qt!==""&&U(`bl ${Qt}`),U(ie==="bilinear"?"render zero color":"render zero"));const _e={...r},kt=ar();kt&&(_e.blackLevel=kt);const vt=parseFloat(Jt),Ir=parseFloat(er);!isNaN(vt)&&!isNaN(Ir)&&(_e.wbGains=[vt,Ir]);const _n=parseFloat(Le);if(isNaN(_n)||(_e.exposure=_n),ie==="bilinear"){const br=mt.trim().replace(/[\s,\n]+/g," ");if(br){const Ie=br.split(" ").map(Number);Ie.length===9&&!Ie.some(isNaN)&&(_e.customMatrix=Ie)}_e.isBGGR=Et}if(_e.renderMode=ie==="mosaic"?"zero-dependency":"zero-dep-color",_e.showKadc=Ve,_e.subtractBlackLevelFromStats=Bt,_e.highlightRecovery=tr,tr){const br=parseFloat(Hr);!isNaN(br)&&br>0&&(_e.customWhiteLevel=br)}else delete _e.customWhiteLevel;qt(!1),n(_e)},Qe=()=>{We();const ie=cr(rn),_e=cr(sn),kt=cr(Tr);if(!ie||!_e||!kt){alert("Please enter valid 4-channel numbers for BL, BG, and FG.");return}U&&(Le!=="0"&&U(`ev ${Le}`),U(`render unmix ${ie.join(" ")} ${_e.join(" ")} ${kt.join(" ")}`));const vt={...r,renderMode:"advanced-zero-dep",advancedZeroDep:{bl:ie,bg:_e,fg:kt}};if(vt.showKadc=Ve,vt.subtractBlackLevelFromStats=Bt,vt.highlightRecovery=tr,tr){const Ir=parseFloat(Hr);!isNaN(Ir)&&Ir>0&&(vt.customWhiteLevel=Ir)}n(vt)},Je=()=>{if(F){const ie=F.means,_e=[ie[0],ie[1],ie[3],ie[2]].map(kt=>kt.toFixed(1));Oe(),Xr(_e.join(" "))}else alert("Please select an ROI on the image first.")},Xt=()=>{if(F){const ie=F.means,_e=[ie[0],ie[1],ie[3],ie[2]].map(kt=>kt.toFixed(1));Oe(),Cr(_e.join(" "))}else alert("Please select an ROI on the image first.")},lt=ie=>{ie.target.files&&ie.target.files.length>0&&x&&(x(ie.target.files,$t),U==null||U(`drlab batch ${$t}`)),ie.target.value="",Vt(!1)},zt=async ie=>{var kt;const _e=(kt=ie.target.files)==null?void 0:kt[0];if(!(!_e||!X)){try{const Ir=(await _e.text()).split(`
`),_n=[];for(let br of Ir){if(br=br.trim(),!br||br.toLowerCase().startsWith("index"))continue;const Ie=br.split(",").map(Number);if(Ie.length>=5){const Mt=Ie[1],St=Ie[2],xt=Ie[3],qr=Ie[4],Kt=Ie[5];!isNaN(Mt)&&!isNaN(St)&&!isNaN(xt)&&!isNaN(qr)&&_n.push({x:Mt,y:St,w:xt,h:qr,ori:isNaN(Kt)?void 0:Kt})}}X(_n),alert(`Imported ${_n.length} ROIs successfully.`)}catch(vt){console.error("Import failed",vt),alert("Failed to import CSV: "+vt.message)}ie.target.value=""}},Nr=async ie=>{var kt;const _e=(kt=ie.target.files)==null?void 0:kt[0];if(_e){try{const Ir=(await _e.text()).split(`
`),_n=[];_n.push("#BlackLevel: 0,0,0,0"),_n.push("#ImageHeight: 0"),_n.push("Row,Col,R_Mean,G1_Mean,G2_Mean,B_Mean,R_Std,G1_Std,G2_Std,B_Std");let br=1;for(let xt=0;xt<Ir.length;xt++){const qr=Ir[xt].trim();if(!qr||qr.includes("R_mean")||qr.includes("R_std"))continue;const Kt=qr.split(/\s+/).map(Number);if(Kt.length<8||Kt.some(isNaN))continue;const ea=[br,1,Kt[0],Kt[2],Kt[6],Kt[4],Kt[1],Kt[3],Kt[7],Kt[5]].join(",");_n.push(ea),br++}const Ie=new Blob([_n.join(`
`)],{type:"text/csv"}),Mt=URL.createObjectURL(Ie),St=document.createElement("a");St.href=Mt,St.download=_e.name.replace(/\.[^/.]+$/,"")+"_converted.csv",document.body.appendChild(St),St.click(),document.body.removeChild(St),URL.revokeObjectURL(Mt)}catch(vt){console.error("Conversion failed",vt),alert("Failed to convert file.")}ie.target.value=""}},Dr=ie=>{ie.target.files&&ie.target.files[0]&&(hn(ie.target.files[0]),U==null||U("fft load a"))},ma=ie=>{ie.target.files&&ie.target.files[0]&&(Sn(ie.target.files[0]),U==null||U("fft load b"))},mi=()=>{xr&&Gt&&_&&(_(xr,Gt,jn,or),U==null||U("fft run"))},Oo=ie=>{ie.target.files&&ie.target.files.length>0&&S&&(S(ie.target.files),U==null||U("fft batch")),ie.target.value=""},yi=ie=>{ie.target.files&&ie.target.files.length>0&&j&&(j(ie.target.files),U==null||U("fft stack")),ie.target.value=""},Ya=()=>{fe&&(fe({useNR:He,useDeshading:It,greenOnly:Ut}),U==null||U("batch compute"))},Ia=(ie,_e,kt)=>{se&&se(ie,_e,kt)},Dn=rn.trim()!==""&&sn.trim()!==""&&Tr.trim()!=="",Ss=r.renderMode==="advanced-zero-dep";return c.jsxs("div",{className:"flex flex-col h-full bg-white dark:bg-black",children:[c.jsxs("div",{className:"flex-grow overflow-y-auto",children:[A&&c.jsxs("div",{className:"bg-red-50 dark:bg-red-900/20 p-3 border-b border-red-100 dark:border-red-800 text-center animate-pulse",children:[c.jsx("p",{className:"text-xs font-bold text-red-600 dark:text-red-400 uppercase tracking-wide",children:" 3-Plane / Full Color"}),c.jsx("p",{className:"text-[10px] text-red-500/80 dark:text-red-300/70 mt-1",children:"Demosaic disabled. Stats analysis treated as pseudo-Bayer."})]}),ke&&!B&&c.jsxs("div",{className:"bg-amber-50 dark:bg-amber-900/20 p-3 border-b border-amber-100 dark:border-amber-800 text-center",children:[c.jsx("p",{className:"text-xs font-bold text-amber-600 dark:text-amber-400 uppercase tracking-wide",children:" X-Trans Native (Unsupported)"}),c.jsx("p",{className:"text-[10px] text-amber-600/80 dark:text-amber-300/70 mt-1 text-left leading-tight px-1",children:"Currently reading raw 6x6 pattern as Bayer. Stats will be incorrect. Please enable Pseudo-Bayer conversion below."})]}),B&&c.jsxs("div",{className:"bg-emerald-50 dark:bg-emerald-900/20 p-3 border-b border-emerald-100 dark:border-emerald-800 text-center",children:[c.jsx("p",{className:"text-xs font-bold text-emerald-600 dark:text-emerald-400 uppercase tracking-wide",children:" X-Trans Pseudo-Bayer"}),c.jsx("p",{className:"text-[10px] text-emerald-600/80 dark:text-emerald-300/70 mt-1 text-left leading-tight px-1",children:"Converted 6x6  2x2 RGGB (Subsampled). Demosaic & Analysis fully supported."})]}),le&&c.jsx(Ms,{title:"PS Mode Curves",children:c.jsxs("div",{className:"space-y-3",children:[c.jsx("div",{className:"flex gap-2",children:["master","red","green","blue"].map(ie=>c.jsx("button",{onClick:()=>Qn(ie),className:`flex-1 py-1 text-xs font-bold uppercase rounded transition-colors ${jr===ie?"bg-slate-700 text-white":"bg-gray-200 dark:bg-slate-800 text-gray-600 dark:text-gray-400 hover:bg-gray-300 dark:hover:bg-slate-700"}`,children:ie==="master"?"Luma":ie},ie))}),c.jsx(sA,{channel:jr,points:Jn[jr],onChange:qa}),c.jsx("div",{className:"text-[10px] text-gray-400 mt-2 text-center",children:"Click: add  Drag: move  Double-click: remove (endpoints locked)"})]})}),I&&c.jsx(Ms,{title:"SFR Lab Tools (Scalar Unmixing)",children:c.jsxs("div",{className:"space-y-4",children:[c.jsxs("div",{className:"bg-orange-50 dark:bg-orange-900/20 p-3 rounded border border-orange-200 dark:border-orange-800",children:[c.jsx("h4",{className:"text-[10px] font-bold text-orange-600 dark:text-orange-400 uppercase mb-2",children:"Analyze ROI"}),c.jsx("p",{className:"text-[10px] text-gray-500 dark:text-slate-400 mb-2",children:"Select an edge on the main canvas and click analyze. Use the pop-up modal to view ESF/LSF/MTF."}),c.jsx("div",{className:"text-center text-xs font-bold text-orange-500",children:"(ROI Analysis Window is Active)"})]}),Ss&&c.jsxs("div",{className:"border-t border-orange-200 dark:border-orange-800 pt-3",children:[c.jsxs("div",{className:"flex justify-between items-center cursor-pointer",onClick:()=>nr(!$r),children:[c.jsx("h4",{className:"text-[10px] font-bold text-orange-600 dark:text-orange-400 uppercase",children:" (Batch Ops)"}),c.jsx("svg",{className:`w-4 h-4 text-orange-500 transition-transform ${$r?"rotate-180":""}`,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),$r&&c.jsxs("div",{className:"mt-3 space-y-3 bg-white/50 dark:bg-black/20 p-2 rounded animate-in slide-in-from-top-1",children:[c.jsxs("div",{className:"flex flex-col gap-2",children:[c.jsx("span",{className:"text-[9px] font-bold text-gray-600 dark:text-gray-300",children:" (Standard Chart)"}),c.jsx("button",{onClick:ye,disabled:!!oe&&oe>0,className:`w-full py-2 border font-bold text-xs rounded transition-all ${oe&&oe>0?"bg-emerald-600 text-white border-emerald-500 animate-pulse":"bg-white dark:bg-slate-800 border-gray-300 dark:border-slate-600 text-gray-700 dark:text-gray-300 hover:bg-gray-100"}`,children:oe&&oe>0?`Click ${oe===1?"TL":oe===2?"TR":oe===3?"BL":"BR"}`:"Start Calibration (4-Pts)"}),!!oe&&oe>0&&c.jsx("p",{className:"text-[9px] text-emerald-600 dark:text-emerald-400 font-bold text-center",children:"Click corners: TopLeft  TopRight  BottomLeft  BottomRight"})]}),c.jsx("div",{className:"h-px bg-gray-300 dark:bg-slate-600 w-full"}),c.jsxs("div",{className:"flex flex-col gap-2",children:[c.jsxs("div",{className:"flex justify-between items-center",children:[c.jsx("span",{className:"text-[9px] font-bold text-gray-600 dark:text-gray-300",children:" (Manual Mark)"}),Q!==void 0&&Q>0&&c.jsxs("span",{className:"text-[9px] text-orange-500 font-bold",children:[Q," Selected"]})]}),c.jsx("button",{onClick:re,className:`w-full py-2 font-bold text-xs rounded shadow transition-all ${q?"bg-orange-600 hover:bg-orange-500 text-white ring-2 ring-orange-300":"bg-white dark:bg-slate-800 border border-gray-300 dark:border-slate-600 text-gray-700 dark:text-gray-300 hover:bg-gray-100"}`,children:q?"Stop Marking (Active)":"Start Batch Marking"}),c.jsxs("div",{className:"flex gap-2",children:[c.jsxs("button",{onClick:ae,disabled:!Q,className:"flex-1 py-1.5 border border-indigo-300 dark:border-indigo-700 text-indigo-700 dark:text-indigo-400 font-bold text-[10px] rounded hover:bg-indigo-50 dark:hover:bg-indigo-900/30 transition-colors disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-1",children:[c.jsx("svg",{className:"w-3 h-3",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7H5a2 2 0 00-2 2v9a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2h-3m-1 4l-3 3m0 0l-3-3m3 3V4"})})," (Save)"]}),c.jsx("input",{type:"file",ref:Zt,className:"hidden",accept:".csv",onChange:zt}),c.jsxs("button",{onClick:()=>{var ie;return(ie=Zt.current)==null?void 0:ie.click()},className:"flex-1 py-1.5 border border-emerald-300 dark:border-emerald-700 text-emerald-700 dark:text-emerald-400 font-bold text-[10px] rounded hover:bg-emerald-50 dark:hover:bg-emerald-900/30 transition-colors flex items-center justify-center gap-1",children:[c.jsx("svg",{className:"w-3 h-3",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-8l-4-4m0 0L8 8m4-4v12"})})," (Import)"]})]}),Q!==void 0&&Q>0&&c.jsxs("div",{className:"bg-gray-100 dark:bg-slate-800/50 p-2 rounded border border-gray-200 dark:border-slate-700 mt-1",children:[c.jsx("div",{className:"text-[9px] font-bold text-gray-500 text-center mb-1",children:"UNIFIED TRANSFORM"}),c.jsxs("div",{className:"flex gap-2 mb-2 justify-center",children:[c.jsxs("div",{className:"flex flex-col items-center",children:[c.jsx("span",{className:"text-[8px] text-gray-400",children:"Step (px)"}),c.jsx("input",{type:"number",min:"1",value:ln,onChange:ie=>L(Number(ie.target.value)),className:"w-10 text-center text-[10px] bg-white dark:bg-slate-900 border rounded"})]}),c.jsxs("div",{className:"flex flex-col items-center",children:[c.jsx("span",{className:"text-[8px] text-gray-400",children:"Scale"}),c.jsx("input",{type:"number",step:"0.01",value:we,onChange:ie=>Ne(Number(ie.target.value)),className:"w-10 text-center text-[10px] bg-white dark:bg-slate-900 border rounded"})]})]}),c.jsxs("div",{className:"grid grid-cols-3 gap-1",children:[c.jsx("button",{onClick:()=>Ia("scale",1/we,1/we),className:"bg-white dark:bg-slate-700 hover:bg-gray-200 rounded text-[10px] border dark:border-slate-600 font-bold",title:"Zoom Out (Shrink)",children:"-"}),c.jsx("button",{onClick:()=>Ia("move",0,-ln),className:"bg-white dark:bg-slate-700 hover:bg-gray-200 rounded text-[10px] border dark:border-slate-600",children:""}),c.jsx("button",{onClick:()=>Ia("scale",we,we),className:"bg-white dark:bg-slate-700 hover:bg-gray-200 rounded text-[10px] border dark:border-slate-600 font-bold",title:"Zoom In (Expand)",children:"+"}),c.jsx("button",{onClick:()=>Ia("move",-ln,0),className:"bg-white dark:bg-slate-700 hover:bg-gray-200 rounded text-[10px] border dark:border-slate-600",children:""}),c.jsx("div",{className:"text-center text-[8px] text-gray-400 flex items-center justify-center",children:"Move"}),c.jsx("button",{onClick:()=>Ia("move",ln,0),className:"bg-white dark:bg-slate-700 hover:bg-gray-200 rounded text-[10px] border dark:border-slate-600",children:""}),c.jsx("div",{}),c.jsx("button",{onClick:()=>Ia("move",0,ln),className:"bg-white dark:bg-slate-700 hover:bg-gray-200 rounded text-[10px] border dark:border-slate-600",children:""}),c.jsx("div",{})]})]}),q&&c.jsx("p",{className:"text-[9px] text-gray-400 italic text-center mt-1",children:"Hold Shift + Drag on canvas to add multiple ROIs."}),c.jsxs("div",{className:"flex flex-col gap-1 text-[10px] mt-2 bg-gray-100 dark:bg-slate-800/50 p-2 rounded",children:[c.jsxs("div",{className:"flex justify-between items-center",children:[c.jsxs("label",{className:"flex items-center gap-1 cursor-pointer",children:[c.jsx("input",{type:"checkbox",checked:He,onChange:ie=>pt(ie.target.checked),className:"rounded text-orange-500"}),"Jiang Official NR"]}),c.jsxs("label",{className:"flex items-center gap-1 cursor-pointer",children:[c.jsx("input",{type:"checkbox",checked:It,onChange:ie=>Ht(ie.target.checked),className:"rounded text-purple-500"}),"Deshading"]})]}),c.jsx("div",{className:"h-px bg-gray-200 dark:bg-slate-700 my-1"}),c.jsxs("label",{className:"flex items-center gap-1 cursor-pointer",title:"Only use Green channel points for projection (reduces color moire issues)",children:[c.jsx("input",{type:"checkbox",checked:Ut,onChange:ie=>Se(ie.target.checked),className:"rounded text-emerald-500"}),c.jsx("span",{className:"font-bold text-emerald-600 dark:text-emerald-400",children:"Green Channel Only (G Only)"})]})]}),c.jsxs("button",{onClick:Ya,disabled:!Q,className:"w-full py-2 bg-indigo-600 hover:bg-indigo-500 disabled:bg-gray-300 disabled:text-gray-500 text-white font-bold text-xs rounded shadow transition-transform active:scale-95",children:["Calculate & Copy (",Q||0,")"]}),c.jsx("button",{onClick:ee,disabled:!Q,className:"w-full py-1.5 bg-gray-200 dark:bg-slate-700 hover:bg-red-100 hover:text-red-600 text-[10px] font-bold rounded transition-colors disabled:opacity-50",children:"Clear All Marks"})]})]})]}),c.jsx("div",{className:"h-px bg-gray-200 dark:bg-slate-700 w-full"}),c.jsx(Vd,{checked:tn,onChange:Ge,label:" (Scalar Unmixing)"}),tn&&c.jsxs("div",{className:"space-y-4 pl-2 border-l-2 border-indigo-200 dark:border-indigo-900 animate-in slide-in-from-top-2 duration-200",children:[c.jsxs("div",{className:"grid grid-cols-5 gap-1 items-center text-[9px] uppercase font-bold text-gray-400 mb-[-8px]",children:[c.jsx("div",{className:"col-span-1",children:"Param"}),c.jsx("div",{className:"text-center",children:"Ch0(R)"}),c.jsx("div",{className:"text-center",children:"Ch1(G1)"}),c.jsx("div",{className:"text-center",children:"Ch2(B)"}),c.jsx("div",{className:"text-center",children:"Ch3(G2)"})]}),c.jsxs("div",{className:"grid grid-cols-5 gap-2 items-center",children:[c.jsx("span",{className:"text-[10px] font-bold text-red-500",children:"BL:"}),c.jsx("input",{type:"text",value:rn,onChange:ie=>{Oe(),Ar(ie.target.value)},placeholder:"0 0 0 0",className:"col-span-4 px-2 py-1 bg-white dark:bg-slate-800 border border-gray-300 dark:border-slate-600 rounded text-xs font-mono text-gray-900 dark:text-slate-100"})]}),c.jsxs("div",{className:"grid grid-cols-5 gap-2 items-center",children:[c.jsx("span",{className:"text-[10px] font-bold text-indigo-500",children:"B ():"}),c.jsxs("div",{className:"col-span-4 flex gap-1",children:[c.jsx("input",{type:"text",value:sn,onChange:ie=>{Oe(),Xr(ie.target.value)},className:"flex-1 px-2 py-1 bg-white dark:bg-slate-800 border border-gray-300 dark:border-slate-600 rounded text-xs font-mono text-gray-900 dark:text-slate-100"}),c.jsx("button",{onClick:Je,className:"px-2 bg-gray-200 dark:bg-slate-700 hover:bg-gray-300 dark:hover:bg-slate-600 text-[9px] rounded font-bold transition-colors",title:"Fill with current ROI mean stats (Raw DN)",children:"Pick"})]})]}),c.jsxs("div",{className:"grid grid-cols-5 gap-2 items-center",children:[c.jsx("span",{className:"text-[10px] font-bold text-emerald-500",children:"F ():"}),c.jsxs("div",{className:"col-span-4 flex gap-1",children:[c.jsx("input",{type:"text",value:Tr,onChange:ie=>{Oe(),Cr(ie.target.value)},className:"flex-1 px-2 py-1 bg-white dark:bg-slate-800 border border-gray-300 dark:border-slate-600 rounded text-xs font-mono text-gray-900 dark:text-slate-100"}),c.jsx("button",{onClick:Xt,className:"px-2 bg-gray-200 dark:bg-slate-700 hover:bg-gray-300 dark:hover:bg-slate-600 text-[9px] rounded font-bold transition-colors",title:"Fill with current ROI mean stats (Raw DN)",children:"Pick"})]})]}),c.jsx("button",{onClick:Qe,disabled:!je||!Dn,className:"w-full bg-indigo-600 hover:bg-indigo-500 text-white font-bold py-2 rounded text-[10px] shadow transition-transform active:scale-95 disabled:bg-gray-300 dark:disabled:bg-slate-800 disabled:text-gray-500 disabled:cursor-not-allowed",children:"RUN UNMIXING (ADV ZERO-DEP)"}),c.jsx("p",{className:"text-[9px] text-gray-400 italic text-center",children:" + sRGB Gamma "})]})]})}),w&&c.jsx(Ms,{title:"FFT Lab (Noise Profile)",children:c.jsxs("div",{className:"space-y-6",children:[c.jsxs("div",{className:"space-y-3 bg-gray-50 dark:bg-slate-800/40 p-3 rounded-xl border border-gray-100 dark:border-slate-800",children:[c.jsxs("h4",{className:"text-[10px] font-bold text-fuchsia-600 dark:text-fuchsia-400 uppercase tracking-widest flex items-center gap-2",children:[c.jsx("span",{className:"w-1.5 h-1.5 rounded-full bg-fuchsia-500"})," 1. Pair Difference (Sub)"]}),c.jsxs("div",{className:"flex flex-col gap-2",children:[c.jsx("input",{type:"file",ref:Xe,className:"hidden",onChange:Dr,accept:".arw,.cr2,.cr3,.dng,.nef,.orf,.raf,.rw2,.pef,.srw,.sr2,.srf,.x3f,.erf,.mef,.mos,.mrw,.kdc,.dcr,.iiq,.3fr,.fff,.rwl,.nrw,.raw,.tif,.tiff"}),c.jsx("button",{onClick:()=>{var ie;return(ie=Xe.current)==null?void 0:ie.click()},className:`w-full py-2 px-3 rounded-lg border text-[10px] font-bold text-left truncate transition-colors ${xr?"bg-fuchsia-55 dark:bg-fuchsia-900/20 border-fuchsia-300 dark:border-fuchsia-800 text-fuchsia-700 dark:text-fuchsia-300":"bg-white dark:bg-slate-800 border-gray-300 dark:border-slate-600 text-gray-500 hover:bg-gray-50 dark:hover:bg-slate-700"}`,children:xr?`A: ${xr.name}`:"Load Image A"}),c.jsx("input",{type:"file",ref:ot,className:"hidden",onChange:ma,accept:".arw,.cr2,.cr3,.dng,.nef,.orf,.raf,.rw2,.pef,.srw,.sr2,.srf,.x3f,.erf,.mef,.mos,.mrw,.kdc,.dcr,.iiq,.3fr,.fff,.rwl,.nrw,.raw,.tif,.tiff"}),c.jsx("button",{onClick:()=>{var ie;return(ie=ot.current)==null?void 0:ie.click()},className:`w-full py-2 px-3 rounded-lg border text-[10px] font-bold text-left truncate transition-colors ${Gt?"bg-fuchsia-55 dark:bg-fuchsia-900/20 border-fuchsia-300 dark:border-fuchsia-800 text-fuchsia-700 dark:text-fuchsia-300":"bg-white dark:bg-slate-800 border-gray-300 dark:border-slate-600 text-gray-500 hover:bg-gray-50 dark:hover:bg-slate-700"}`,children:Gt?`B: ${Gt.name}`:"Load Image B"})]}),c.jsx("div",{className:"flex flex-col gap-1.5 pt-1",children:c.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[c.jsx("input",{type:"checkbox",checked:or,onChange:ie=>sr(ie.target.checked),className:"w-3 h-3 text-fuchsia-600 border-gray-300 rounded focus:ring-0"}),c.jsx("span",{className:"text-[10px] text-gray-600 dark:text-slate-300",children:"Normalize (2)"})]})}),c.jsxs("div",{className:"grid grid-cols-1 gap-2",children:[c.jsx("button",{onClick:mi,disabled:!xr||!Gt,className:"w-full bg-fuchsia-600 hover:bg-fuchsia-500 disabled:opacity-30 text-white font-bold py-2 rounded shadow transition-all active:scale-95 text-[10px]",children:"Generate Diff & Load"}),c.jsx("input",{type:"file",ref:ct,className:"hidden",multiple:!0,accept:".arw,.cr2,.cr3,.dng,.nef,.orf,.raf,.rw2,.pef,.srw,.sr2,.srf,.x3f,.erf,.mef,.mos,.mrw,.kdc,.dcr,.iiq,.3fr,.fff,.rwl,.nrw,.raw,.tif,.tiff",onChange:Oo}),c.jsx("button",{onClick:()=>{var ie;return(ie=ct.current)==null?void 0:ie.click()},className:"w-full bg-slate-700 hover:bg-slate-600 text-white font-bold py-2 rounded shadow transition-all active:scale-95 text-[10px] flex items-center justify-center gap-1",children:"Batch Diffs (Auto Download)"})]})]}),c.jsxs("div",{className:"space-y-3 bg-gray-50 dark:bg-slate-800/40 p-3 rounded-xl border border-gray-100 dark:border-slate-800",children:[c.jsxs("h4",{className:"text-[10px] font-bold text-cyan-600 dark:text-cyan-400 uppercase tracking-widest flex items-center gap-2",children:[c.jsx("span",{className:"w-1.5 h-1.5 rounded-full bg-cyan-500"})," 2. Stack FFT (Avg PSD)"]}),c.jsxs("div",{className:"flex flex-col gap-2",children:[c.jsx("input",{type:"file",ref:Yt,className:"hidden",multiple:!0,onChange:yi,accept:".arw,.cr2,.cr3,.dng,.nef,.orf,.raf,.rw2,.pef,.srw,.sr2,.srf,.x3f,.erf,.mef,.mos,.mrw,.kdc,.dcr,.iiq,.3fr,.fff,.rwl,.nrw,.raw,.tif,.tiff"}),c.jsx("button",{onClick:()=>{var ie;return(ie=Yt.current)==null?void 0:ie.click()},className:"w-full py-3 bg-cyan-600 hover:bg-cyan-500 text-white font-bold rounded-lg shadow-md transition-all active:scale-95 text-[10px] flex items-center justify-center gap-2",children:"Select Sequence Files"})]})]}),c.jsxs("div",{className:"flex flex-col gap-2 pt-2 border-t border-gray-100 dark:border-slate-800",children:[c.jsx("button",{onClick:()=>{M==null||M(),U==null||U("crosscalc")},className:"w-full bg-indigo-600 hover:bg-indigo-500 text-white font-bold py-2 px-4 rounded-lg shadow-md transition-all active:scale-95 text-[10px] flex items-center justify-center gap-2",children:"Cross-Compensation Calc"}),c.jsx("button",{onClick:()=>{he==null||he(),U==null||U("stack tool")},className:"w-full bg-emerald-600 hover:bg-emerald-500 text-white font-bold py-2 px-4 rounded-lg shadow-md transition-all active:scale-95 text-[10px] flex items-center justify-center gap-2",children:" (General Stack)"})]})]})}),s&&c.jsx(Ms,{title:"DR Lab Tools",children:c.jsxs("div",{className:"space-y-4",children:[c.jsx("button",{onClick:()=>{f==null||f(),U==null||U("gen test")},className:"w-full bg-amber-500 hover:bg-amber-600 text-white font-bold py-2 px-4 rounded-lg shadow-md transition-colors text-sm",children:"Generate Test Pic"}),c.jsxs("div",{className:"border-t border-gray-200 dark:border-slate-700 pt-3",children:[c.jsx("h4",{className:"text-xs font-bold text-gray-500 dark:text-slate-400 uppercase tracking-wide mb-2",children:"Grid Analysis"}),p&&d!==void 0&&c.jsx("div",{className:"flex items-center justify-between mb-3",children:c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx("span",{className:"text-sm text-gray-600 dark:text-slate-300",children:"Box Size:"}),c.jsx("input",{type:"number",min:"8",max:"512",step:"2",value:d,onChange:ie=>p(parseInt(ie.target.value)||64),className:"w-12 px-1 py-1 bg-white dark:bg-slate-800 border border-gray-300 dark:border-slate-600 rounded-md focus:ring-2 focus:ring-cyan-500 outline-none text-sm text-gray-900 dark:text-slate-100 text-center"}),c.jsx("span",{className:"text-xs text-gray-400",children:"px"})]})}),v&&k&&m!==void 0&&b!==void 0&&c.jsxs("div",{className:"flex items-center justify-between mb-3",children:[c.jsx("span",{className:"text-sm text-gray-600 dark:text-slate-400",children:"Layout:"}),c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx("input",{type:"number",min:"1",max:"50",value:m,onChange:ie=>v(Math.max(1,parseInt(ie.target.value)||1)),className:"w-10 px-1 py-1 bg-white dark:bg-slate-800 border border-gray-300 dark:border-slate-600 rounded-md outline-none text-sm text-center",title:"Rows"}),c.jsx("span",{className:"text-xs text-gray-400",children:"x"}),c.jsx("input",{type:"number",min:"1",max:"50",value:b,onChange:ie=>k(Math.max(1,parseInt(ie.target.value)||1)),className:"w-10 px-1 py-1 bg-white dark:bg-slate-800 border border-gray-300 dark:border-slate-600 rounded-md outline-none text-sm text-center",title:"Columns"})]})]}),c.jsxs("div",{className:"flex flex-col gap-2",children:[c.jsx("button",{onClick:()=>{u==null||u(),U==null||U("mark")},disabled:!je||l!==void 0&&l>0,className:`w-full font-bold py-2 px-4 rounded-lg shadow-md transition-all text-sm ${je?l&&l>0?"bg-indigo-100 dark:bg-indigo-900 text-indigo-700 dark:text-indigo-300 border-2 border-indigo-500":"bg-indigo-600 hover:bg-indigo-700 text-white":"bg-gray-300 text-gray-500 cursor-not-allowed"}`,children:l&&l>0?"Marking Active...":"Mark Corners"}),x&&c.jsxs(c.Fragment,{children:[c.jsx("input",{type:"file",ref:yr,className:"hidden",multiple:!0,accept:".arw,.cr2,.cr3,.dng,.nef,.orf,.raf,.rw2,.pef,.srw,.sr2,.srf,.x3f,.erf,.mef,.mos,.mrw,.kdc,.dcr,.iiq,.3fr,.fff,.rwl,.nrw,.raw,.tif,.tiff",onChange:lt}),c.jsxs("div",{className:"relative",children:[c.jsx("button",{onClick:()=>Vt(!ht),disabled:!y,className:"w-full font-bold py-2 px-4 rounded-lg shadow-md transition-all text-sm bg-emerald-600 hover:bg-emerald-700 disabled:bg-gray-300 disabled:text-gray-500 disabled:cursor-not-allowed text-white flex items-center justify-center gap-2",children:"Reuse Last & Batch"}),ht&&c.jsxs("div",{className:"absolute bottom-full left-0 w-full mb-1 bg-white dark:bg-slate-800 rounded-lg shadow-xl border border-gray-200 dark:border-slate-700 overflow-hidden z-20 flex flex-col animate-in fade-in zoom-in-95 duration-100",children:[c.jsx("button",{className:"px-4 py-2 text-left text-xs hover:bg-gray-100 dark:hover:bg-slate-700 text-gray-700 dark:text-slate-200 border-b border-gray-100 dark:border-slate-700",onClick:()=>{var ie;mr("single"),(ie=yr.current)==null||ie.click()},children:"1. Independent Frames"}),c.jsx("button",{className:"px-4 py-2 text-left text-xs hover:bg-gray-100 dark:hover:bg-slate-700 text-indigo-600 dark:text-indigo-400 font-bold",onClick:()=>{var ie;mr("pair"),(ie=yr.current)==null||ie.click()},children:"2. Pair Difference (A-B)"})]})]})]}),c.jsxs("div",{className:"pt-2 mt-2 border-t border-gray-100 dark:border-slate-800",children:[c.jsx("input",{type:"file",ref:Be,className:"hidden",accept:".txt",onChange:Nr}),c.jsx("button",{onClick:()=>{var ie;return(ie=Be.current)==null?void 0:ie.click()},className:"w-full font-bold py-2 px-4 rounded-lg shadow-sm transition-all text-xs bg-slate-100 hover:bg-slate-200 dark:bg-slate-800 dark:hover:bg-slate-700 text-gray-600 dark:text-slate-300 flex items-center justify-center gap-2 border border-gray-300 dark:border-slate-600",children:"Convert Format (.txt  .csv)"})]})]}),l!==void 0&&l>0&&c.jsx("div",{className:"mt-2 text-center",children:c.jsxs("p",{className:"text-xs text-indigo-600 dark:text-indigo-400 font-bold animate-pulse",children:[l===1&&"Click Top-Left Center",l===2&&"Click Top-Right Center",l===3&&"Click Bottom-Left Center",l===4&&"Click Bottom-Right Center"]})})]})]})}),V&&c.jsx(Ms,{title:"Color Lab Tools",children:c.jsxs("div",{className:"space-y-4",children:[c.jsx("div",{className:"text-sm text-gray-600 dark:text-slate-300 mb-2",children:"Calibrate colors using a standard ColorChecker 24 chart."}),c.jsx("button",{onClick:()=>{D==null||D(),U==null||U("cl mark")},disabled:!je||G!==void 0&&G>0,className:`w-full font-bold py-2 px-4 rounded-lg shadow-md transition-all text-sm ${je?G&&G>0?"bg-yellow-100 dark:bg-yellow-900 text-yellow-700 dark:text-yellow-300 border-2 border-yellow-500":"bg-yellow-600 hover:bg-yellow-700 text-white":"bg-gray-300 text-gray-500 cursor-not-allowed"}`,children:G&&G>0?"Marking Active...":"Mark 24-Patch Chart"}),G!==void 0&&G>0&&c.jsx("div",{className:"mt-2 text-center",children:c.jsxs("p",{className:"text-xs text-yellow-600 dark:text-yellow-400 font-bold animate-pulse",children:[G===1&&"Click Top-Left (Brown)",G===2&&"Click Top-Right (Cyanish)",G===3&&"Click Bottom-Left (White)",G===4&&"Click Bottom-Right (Black)"]})})]})}),c.jsx(Ms,{title:"Selection Tools",children:c.jsx("div",{className:"space-y-3",children:c.jsxs("div",{children:[c.jsx("label",{className:"text-xs font-bold text-gray-500 dark:text-slate-400 uppercase tracking-wide block mb-2",children:"Quick Select or Shift+drag"}),c.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[c.jsx("span",{className:"text-sm text-gray-600 dark:text-slate-300",children:"Size (px):"}),c.jsx("input",{type:"number",min:"1",value:bn,onChange:ie=>Ct(ie.target.value),disabled:!je,className:"flex-1 px-2 py-1 bg-white dark:bg-slate-800 border border-gray-300 dark:border-slate-600 rounded-md focus:ring-2 focus:ring-cyan-500 outline-none text-sm text-gray-900 dark:text-slate-100 transition-colors"})]}),c.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[c.jsx("button",{onClick:yt,disabled:!je,className:"px-3 py-1.5 bg-gray-200 hover:bg-gray-300 dark:bg-slate-700 dark:hover:bg-slate-600 text-gray-800 dark:text-slate-200 text-xs font-semibold rounded transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:"Center Rect"}),c.jsx("button",{onClick:dt,disabled:!je,className:"px-3 py-1.5 bg-gray-200 hover:bg-gray-300 dark:bg-slate-700 dark:hover:bg-slate-600 text-gray-800 dark:text-slate-200 text-xs font-semibold rounded transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:"Full Image"})]})]})})}),c.jsx(Ms,{title:"Display Controls",children:c.jsxs("div",{className:"space-y-5",children:[c.jsxs("p",{className:"text-gray-500 dark:text-slate-400 text-center text-sm",children:["Adjust parameters and click ",c.jsx("b",{children:"Apply"}),"."]}),c.jsxs("div",{children:[c.jsx("label",{htmlFor:"exposure",className:"text-xs font-bold text-gray-500 dark:text-slate-400 uppercase tracking-wide block mb-2",children:"Exposure (EV)"}),c.jsx("div",{className:"flex items-center gap-2 mb-2",children:c.jsx("input",{type:"range",min:"-5",max:"5",step:"0.1",disabled:!je,value:parseFloat(Le)||0,onChange:ie=>be(ie.target.value),className:"w-full h-2 bg-gray-300 dark:bg-slate-700 rounded-lg appearance-none cursor-pointer accent-cyan-500 disabled:opacity-50"})}),c.jsx("div",{className:"flex items-center gap-2",children:c.jsx("input",{id:"exposure",type:"number",step:"0.1",value:Le,onChange:ie=>be(ie.target.value),disabled:!je,className:"w-full px-2 py-1 bg-white dark:bg-slate-800 border border-gray-300 dark:border-slate-600 rounded-md focus:ring-2 focus:ring-cyan-500 outline-none text-sm text-gray-900 dark:text-slate-100 transition-colors duration-300"})})]}),c.jsxs("div",{children:[c.jsx(Vd,{checked:tr,onChange:ie=>{Oe(),rr(ie)},label:"Highlight Recovery"}),tr&&c.jsxs("div",{className:"mt-2 pl-2 border-l-2 border-orange-200 dark:border-orange-900 animate-in slide-in-from-top-1",children:[c.jsx("label",{className:"text-[10px] font-bold text-gray-500 dark:text-slate-400 uppercase block mb-1",children:"White Level (Clip Point)"}),c.jsx("input",{type:"number",value:Hr,onChange:ie=>{Oe(),Ft(ie.target.value)},className:"w-full px-2 py-1 bg-white dark:bg-slate-800 border border-gray-300 dark:border-slate-600 rounded-md focus:ring-2 focus:ring-orange-500 outline-none text-sm text-gray-900 dark:text-slate-100 transition-colors"})]})]}),ve&&c.jsxs("div",{className:"border-t border-gray-100 dark:border-slate-800 pt-2",children:[c.jsx(Vd,{checked:!!B,onChange:ie=>{Oe(),$&&$(ie),U==null||U(`xtrans ${ie?"on":"off"}`)},label:"Force X-Trans (6x6 -> 2x2)"}),B&&E&&T&&c.jsxs("div",{className:"mt-2 pl-2 border-l-2 border-emerald-500/50 bg-emerald-50/20 dark:bg-emerald-900/10 p-2 rounded",children:[c.jsx("label",{className:"text-[9px] font-bold text-gray-500 dark:text-slate-400 uppercase block mb-1",children:"Phase Offset (Fine Tune)"}),c.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[c.jsxs("div",{className:"flex flex-col",children:[c.jsx("span",{className:"text-[9px] text-gray-400",children:"X (0-5)"}),c.jsx("input",{type:"number",min:"0",max:"5",value:E.x,onChange:ie=>{Oe();const _e=Math.min(5,Math.max(0,parseInt(ie.target.value)||0));T({x:_e}),U==null||U(`xtrans phase ${_e} ${E.y}`)},className:"w-full text-xs px-1 py-0.5 bg-white dark:bg-slate-800 border border-gray-300 dark:border-slate-600 rounded text-center outline-none focus:border-cyan-500"})]}),c.jsxs("div",{className:"flex flex-col",children:[c.jsx("span",{className:"text-[9px] text-gray-400",children:"Y (0-5)"}),c.jsx("input",{type:"number",min:"0",max:"5",value:E.y,onChange:ie=>{Oe();const _e=Math.min(5,Math.max(0,parseInt(ie.target.value)||0));T({y:_e}),U==null||U(`xtrans phase ${E.x} ${_e}`)},className:"w-full text-xs px-1 py-0.5 bg-white dark:bg-slate-800 border border-gray-300 dark:border-slate-600 rounded text-center outline-none focus:border-cyan-500"})]})]})]})]}),c.jsxs("div",{className:"space-y-5 pt-2 animate-in slide-in-from-top-2 duration-200 border-t border-gray-200 dark:border-slate-700",children:[c.jsxs("div",{children:[c.jsx(Vd,{checked:Ve,onChange:ie=>{Oe(),Pt(ie)},label:"Show k"}),c.jsx("p",{className:"text-[10px] text-gray-400 dark:text-slate-500 mt-1"})]}),c.jsxs("div",{children:[c.jsxs("button",{onClick:dr,disabled:!je||!F,className:"w-full mb-3 px-3 py-1.5 bg-cyan-600 hover:bg-cyan-500 text-white text-xs font-bold rounded shadow-sm transition-all active:scale-95 disabled:bg-gray-300 dark:disabled:bg-slate-700 disabled:text-gray-500 dark:disabled:text-gray-500 disabled:cursor-not-allowed disabled:shadow-none flex items-center justify-center gap-2",title:"Calculate Gains to make the selected area neutral gray, accounting for Color Matrix",children:[c.jsx("svg",{className:"w-3.5 h-3.5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 10V3L4 14h7v7l9-11h-7z"})}),"Spot WB (Matrix-Aware)"]}),c.jsx("label",{className:"text-xs font-bold text-gray-500 dark:text-slate-400 uppercase tracking-wide block mb-2",children:"White Balance Gains"}),c.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[c.jsxs("div",{children:[c.jsx("span",{className:"text-xs text-red-500 dark:text-red-400 block mb-1",children:"Red"}),c.jsx("input",{type:"number",step:"0.01",value:Jt,onChange:ie=>Y(ie.target.value),disabled:!je,className:"w-full px-2 py-1 bg-white dark:bg-slate-800 border border-gray-300 dark:border-slate-600 rounded-md focus:ring-2 focus:ring-red-500 outline-none text-sm text-gray-900 dark:text-slate-100 transition-colors duration-300"})]}),c.jsxs("div",{children:[c.jsx("span",{className:"text-xs text-blue-500 dark:text-blue-400 block mb-1",children:"Blue"}),c.jsx("input",{type:"number",step:"0.01",value:er,onChange:ie=>Ae(ie.target.value),disabled:!je,className:"w-full px-2 py-1 bg-white dark:bg-slate-800 border border-gray-300 dark:border-slate-600 rounded-md focus:ring-2 focus:ring-blue-500 outline-none text-sm text-gray-900 dark:text-slate-100 transition-colors duration-300"})]})]})]}),c.jsxs("div",{children:[c.jsxs("div",{className:"flex justify-between items-end mb-2",children:[c.jsxs("label",{className:"text-xs font-bold text-gray-500 dark:text-slate-400 uppercase tracking-wide block mb-0 flex items-center",children:["Black Level (4-Ch)",c.jsx("span",{className:"ml-1 text-[10px] text-gray-400 dark:text-slate-500 font-normal normal-case",children:"Native"}),c.jsx("button",{onClick:()=>wn(!0),className:"ml-2 text-[10px] text-cyan-600 dark:text-cyan-400 hover:text-cyan-700 dark:hover:text-cyan-300 hover:underline cursor-pointer transition-colors",title:"About Black Level Settings",children:"[about]"})]}),c.jsxs("div",{className:"flex items-center gap-1.5",title:"Subtract Black Level from ROI Mean stats (for display)",children:[c.jsx("span",{className:"text-[9px] font-mono text-gray-400 dark:text-slate-500 uppercase tracking-wide",children:"Sub. BL"}),c.jsx("div",{className:`relative w-8 h-4 rounded-full cursor-pointer transition-colors duration-200 ease-in-out ${Bt?"bg-cyan-500":"bg-gray-300 dark:bg-slate-700"}`,onClick:()=>{Oe(),Dt(!Bt)},children:c.jsx("div",{className:`absolute top-0.5 left-0.5 bg-white w-3 h-3 rounded-full shadow-sm transform transition-transform duration-200 ${Bt?"translate-x-4":"translate-x-0"}`})})]})]}),c.jsx("input",{type:"text",value:Qt,onChange:ie=>{Oe(),_t(ie.target.value)},disabled:!je,placeholder:"0 0 0 0",className:"w-full px-2 py-1 bg-white dark:bg-slate-800 border border-gray-300 dark:border-slate-600 rounded-md focus:ring-2 focus:ring-cyan-500 outline-none text-xs font-mono text-gray-900 dark:text-slate-100 transition-colors duration-300",title:"Enter 4 values separated by space or comma"}),c.jsx("p",{className:"text-[10px] text-gray-400 dark:text-slate-500 mt-1",children:"Order: (0,0) (0,1) (1,0) (1,1). Spatial: TL, TR, BL, BR."})]}),c.jsxs("div",{children:[c.jsxs("div",{className:"flex justify-between items-end mb-2",children:[c.jsxs("label",{htmlFor:"customMatrix",className:"text-xs font-bold text-gray-500 dark:text-slate-400 uppercase tracking-wide block flex flex-col gap-1",children:[c.jsx("span",{children:"Custom Color Matrix"}),c.jsx("span",{className:"text-[9px] text-gray-400 dark:text-slate-500 font-normal normal-case",children:"XYZ to Camera RGB (3x3, 9 nums)"})]}),c.jsxs("select",{className:"text-[10px] bg-gray-100 dark:bg-gray-800 border border-black dark:border-gray-500 rounded-none px-1 py-0.5 max-w-[120px] cursor-pointer outline-none text-gray-700 dark:text-gray-300",onChange:ie=>{Oe();const _e=hc[ie.target.value];_e&&wt(_e),ie.target.value=""},defaultValue:"",children:[c.jsx("option",{value:"",disabled:!0,children:"Select Camera..."}),gt.map(ie=>c.jsx("option",{value:ie,children:ie},ie))]})]}),c.jsx("textarea",{id:"customMatrix",value:mt,onChange:rt,disabled:!je,placeholder:"0.66 -0.19 -0.04  -0.46 1.23 0.25  -0.06 0.13 0.65",className:"w-full h-24 px-2 py-2 bg-white dark:bg-slate-800 border border-gray-300 dark:border-slate-600 rounded-md focus:ring-2 focus:ring-cyan-500 outline-none transition-colors disabled:bg-gray-100 dark:disabled:bg-slate-800/50 disabled:cursor-not-allowed text-xs font-mono leading-relaxed text-gray-900 dark:text-slate-100"})]})]}),c.jsxs("div",{className:"pt-4 flex flex-col gap-2",children:[c.jsx("button",{onClick:Pe,disabled:!je,className:"w-full text-sm font-bold bg-slate-700 hover:bg-slate-600 text-white disabled:bg-gray-300 dark:disabled:bg-slate-800 disabled:text-gray-500 transition-all py-4 rounded-xl flex items-center justify-center border-2 border-slate-500 shadow-lg",title:"Diagnostic Mode. Direct RAW-to-Grayscale mapping using manual Black Level & WB Gains (R/B calibration).",children:c.jsxs("span",{className:"text-center leading-tight",children:["Apply Settings/Render",c.jsx("br",{}),c.jsx("span",{className:"text-xs font-normal opacity-90",children:"CM"})]})}),c.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[c.jsxs("button",{onClick:()=>De(!0),disabled:!je,className:"w-full text-xs font-bold bg-black text-gray-400 hover:bg-gray-800 hover:text-gray-300 dark:bg-black dark:text-gray-400 dark:hover:bg-gray-800 dark:hover:text-gray-300 disabled:bg-gray-300 dark:disabled:bg-slate-800 disabled:text-gray-500 disabled:cursor-not-allowed py-3 px-2 rounded-lg transition-all active:scale-95 border border-gray-700",children:["",c.jsx("br",{}),c.jsx("span",{className:"text-[10px] font-normal opacity-75",children:""})]}),c.jsx("button",{onClick:()=>W==null?void 0:W(),disabled:!je,className:"w-full text-xs font-bold bg-black text-gray-400 hover:bg-gray-800 hover:text-gray-300 dark:bg-black dark:text-gray-400 dark:hover:bg-gray-800 dark:hover:text-gray-300 disabled:bg-gray-300 dark:disabled:bg-slate-800 disabled:text-gray-500 disabled:cursor-not-allowed transition-all py-3 rounded-lg flex items-center justify-center border border-gray-700 active:scale-95",title:"Manual Lab Workstation: 16-bit Bit Shift and Manual DNG Container Packaging",children:"Generate 16bit DNG"})]}),c.jsx("div",{className:"text-center pt-1",children:c.jsx("button",{onClick:Lt,disabled:!je,className:"text-xs text-gray-400 hover:text-gray-600 dark:text-slate-400 dark:hover:text-slate-200 disabled:text-gray-300 dark:disabled:text-slate-600 transition-colors underline decoration-gray-300 hover:decoration-gray-600 underline-offset-2",children:"Reset Defaults (Local)"})})]})]})})]}),c.jsx(os,{isOpen:Er,onClose:()=>wn(!1),onConfirm:()=>{window.open("https://y-g-jiang.github.io/CBLD.html","_blank"),wn(!1)},title:"Black Level Info / ",confirmText:"Visit Database (CBLD)",cancelText:"Close",message:c.jsxs("div",{className:"flex flex-col gap-4 text-left text-sm text-gray-600 dark:text-slate-300",children:[c.jsxs("p",{className:"leading-relaxed",children:["JiangBridge/",c.jsx("a",{href:"https://y-g-jiang.github.io/CBLD.html",target:"_blank",rel:"noopener noreferrer",className:"text-cyan-600 dark:text-cyan-400 hover:underline mx-1 font-bold",children:"CBLD.html"}),""]}),c.jsx("div",{className:"h-px bg-gray-200 dark:bg-slate-700 w-full"}),c.jsxs("p",{className:"leading-relaxed",children:["Autofills. If no result is found or it's wrong or not precise enough, please check the ",c.jsx("a",{href:"https://y-g-jiang.github.io/CBLD.html",target:"_blank",rel:"noopener noreferrer",className:"text-cyan-600 dark:text-cyan-400 hover:underline mx-1 font-bold",children:"Black Level Database"}),"to find your camera model. However, manually capturing a dark frame(close the lens cap) with the same ISO/speed setting to calculate the average (using jiangtherapee) and input the values is highly recommended for higher decimal precision, as internal tags often lack accuracy."]})]})}),c.jsx(os,{isOpen:kn,onClose:()=>qt(!1),onConfirm:()=>{},title:"Select Zero-Dependency Mode",confirmText:"",cancelText:"",message:c.jsxs("div",{className:"flex flex-col gap-4",children:[c.jsx("div",{className:"text-gray-600 dark:text-slate-300 text-left text-sm leading-relaxed mb-2",children:"Select how you want to visualize the raw data without full JOraw processing."}),c.jsxs("div",{className:"flex justify-between items-center mb-2 px-1",children:[c.jsx("span",{className:"text-xs font-bold text-gray-500 dark:text-slate-400 uppercase",children:"Bayer Pattern"}),c.jsxs("div",{className:"flex bg-gray-100 dark:bg-slate-800 p-1 rounded-lg border border-gray-200 dark:border-slate-700",children:[c.jsx("button",{onClick:()=>fr(!1),className:`px-3 py-1 text-[10px] font-bold rounded transition-all ${Et?"text-gray-500 dark:text-slate-400":"bg-white dark:bg-slate-600 text-cyan-600 dark:text-cyan-400 shadow-sm"}`,children:"RGGB"}),c.jsx("button",{onClick:()=>fr(!0),className:`px-3 py-1 text-[10px] font-bold rounded transition-all ${Et?"bg-white dark:bg-slate-600 text-cyan-600 dark:text-cyan-400 shadow-sm":"text-gray-500 dark:text-slate-400"}`,children:"BGGR"})]})]}),c.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[c.jsxs("button",{onClick:()=>ut("mosaic"),className:"flex flex-col items-center justify-center p-4 bg-gray-100 hover:bg-gray-200 dark:bg-slate-800 dark:hover:bg-slate-700 border-2 border-transparent hover:border-gray-400 dark:hover:border-slate-500 rounded-xl transition-all group",children:[c.jsx("div",{className:"w-12 h-12 bg-gray-300 dark:bg-slate-600 rounded-full flex items-center justify-center mb-3 group-hover:scale-110 transition-transform",children:c.jsx("svg",{className:"w-6 h-6 text-gray-600 dark:text-slate-300",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2H6a2 2 0 01-2-2V6zM14 6a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2V6zM4 16a2 2 0 012-2h2a2 2 0 01-2 2H6a2 2 0 01-2-2v-2zM14 16a2 2 0 012-2h2a2 2 0 01-2 2h-2a2 2 0 01-2-2v-2z"})})}),c.jsx("span",{className:"font-bold text-gray-800 dark:text-slate-200",children:"Raw Mosaic"}),c.jsx("span",{className:"text-xs text-gray-500 dark:text-slate-400 mt-1",children:"Grayscale checkerboard"})]}),c.jsxs("button",{onClick:()=>ut("bilinear"),className:"flex flex-col items-center justify-center p-4 bg-gray-100 hover:bg-gray-200 dark:bg-slate-800 dark:hover:bg-slate-700 border-2 border-transparent hover:border-cyan-400 dark:hover:border-cyan-500 rounded-xl transition-all group",children:[c.jsx("div",{className:"w-12 h-12 bg-cyan-100 dark:bg-cyan-900/30 rounded-full flex items-center justify-center mb-3 group-hover:scale-110 transition-transform",children:c.jsx("svg",{className:"w-6 h-6 text-cyan-600 dark:text-cyan-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M7 21a4 4 0 01-4-4V5a2 2 0 012-2h4a2 2 0 012 2v12a4 4 0 01-4 4zm0 0h12a2 2 0 002-2v-4a2 2 0 00-2-2h-2.343M11 7.343l1.657-1.657a2 2 0 012.828 0l2.829 2.829a2 2 0 010 2.828l-8.486 8.485M7 17h.01"})})}),c.jsx("span",{className:"font-bold text-cyan-700 dark:text-cyan-400",children:"Basic Color"}),c.jsx("span",{className:"text-xs text-gray-500 dark:text-slate-400 mt-1",children:"Simple Demosaic + WB + Matrix"})]})]})]})}),c.jsx(os,{isOpen:O,onClose:()=>De(!1),onConfirm:()=>{hr(),De(!1)},title:"Official Render Options",confirmText:"Render",message:c.jsxs("div",{className:"flex flex-col gap-4 text-left",children:[c.jsx("p",{className:"text-sm text-gray-600 dark:text-slate-300",children:"Select a demosaicing algorithm for the standard render pipeline."}),c.jsxs("div",{children:[c.jsx("label",{htmlFor:"demosaic-modal",className:"text-xs font-bold text-gray-500 dark:text-slate-400 uppercase tracking-wide block mb-2",children:"Demosaic Method"}),c.jsx("select",{id:"demosaic-modal",value:Tt,onChange:at,disabled:!je||A||(t==null?void 0:t.isXTrans),className:"w-full px-2 py-2 bg-white dark:bg-slate-800 border border-gray-300 dark:border-slate-600 rounded-md focus:ring-2 focus:ring-cyan-500 outline-none transition-colors disabled:bg-gray-100 dark:disabled:bg-slate-800/50 disabled:cursor-not-allowed text-sm text-gray-900 dark:text-slate-100",children:aA.map(ie=>c.jsx("option",{value:ie.value,children:ie.label},ie.value))}),A&&c.jsx("p",{className:"text-[9px] text-gray-400 mt-1",children:"Full color data detected. Demosaicing skipped."}),(t==null?void 0:t.isXTrans)&&c.jsx("p",{className:"text-[9px] text-amber-500 mt-1",children:"X-Trans detected. Please enable Pseudo-Bayer conversion first."})]})]})})]})},cA=C.forwardRef((e,t)=>{const{rawImageData:r,displaySettings:n,onApplyDisplaySettings:a,onSetSelection:i,onStartMarking:o,onGenerateTestPic:s,onBatchDrLab:l,onProcessPair:u,onProcessBatchDiff:f,onProcessStackFft:d,onOpenCrossCalc:p,onToggleXTrans:m,onXTransPhaseChange:v}=e,[b,k]=C.useState([{id:"init",type:"info",text:'Jiangtherapee CLI v1.0. Type "help" for commands.'}]),[x,y]=C.useState(""),[w,_]=C.useState([]),[S,j]=C.useState(-1),M=C.useRef(null),A=C.useRef(null),$=C.useRef(null),E=C.useRef(null),T=C.useRef(null),B=C.useRef(null),U=C.useRef(null),V=C.useRef(null);C.useRef(null);const G=C.useRef({...n});C.useEffect(()=>{G.current={...n}},[n.exposure,n.demosaicMethod]);const D=C.useRef({fileA:null,fileB:null});C.useLayoutEffect(()=>{M.current&&(M.current.scrollTop=M.current.scrollHeight)},[b]);const I=(re,ee="out")=>{k(fe=>[...fe,{id:Date.now().toString()+Math.random(),type:ee,text:re}])};C.useImperativeHandle(t,()=>({log:(re,ee="in")=>{const fe=ee;let oe=re;ee==="in"&&!re.startsWith(">")&&(oe=`> ${re}`),I(oe,fe)}}));const F=C.useRef(null);C.useEffect(()=>{if(e.roiStats&&e.roiStats!==F.current){const re=e.roiStats,ee=Math.round(re.x),fe=Math.round(re.y),oe=Math.round(re.width),ye=Math.round(re.height);I(`> sel ${ee} ${fe} ${oe} ${ye}`,"in");const ae=e.isBGGR?[{name:"B",idx:0},{name:"G1",idx:1},{name:"G2",idx:2},{name:"R",idx:3}]:[{name:"R",idx:0},{name:"G1",idx:1},{name:"G2",idx:2},{name:"B",idx:3}],X=c.jsxs("div",{className:"font-mono text-xs mt-1 mb-2",children:[c.jsxs("div",{className:"text-gray-400 mb-1",children:["Region Stats [",ee,", ",fe,", ",oe,"x",ye,"]:"]}),c.jsxs("div",{className:"grid grid-cols-[30px_1fr_1fr] gap-x-2 border-b border-gray-700 pb-1 mb-1 text-gray-500 font-bold",children:[c.jsx("div",{children:"Ch"}),c.jsx("div",{className:"text-right",children:"Mean"}),c.jsx("div",{className:"text-right",children:"StdDev"})]}),ae.map(se=>c.jsxs("div",{className:"grid grid-cols-[30px_1fr_1fr] gap-x-2 hover:bg-gray-900",children:[c.jsx("div",{className:se.name==="R"?"text-red-500":se.name==="B"?"text-blue-500":"text-green-500",children:se.name}),c.jsx("div",{className:"text-right text-gray-300",children:re.means[se.idx].toFixed(2)}),c.jsx("div",{className:"text-right text-gray-400",children:re.stdDevs[se.idx].toFixed(2)})]},se.name))]});I(X,"out"),F.current=re}},[e.roiStats,e.isBGGR]);const H=re=>{var ye,ae,X,se,he,le,je;const ee=re.trim().split(/\s+/),fe=ee[0].toLowerCase(),oe=ee.slice(1);switch(fe){case"help":I("Available Commands:","info"),I("  ev <val>          Set Exposure (e.g. ev 1.5)","info"),I("  wb <r> <b>        Set WB Gains","info"),I("  bl <r> <g>...     Set Black Level (1 or 4 vals)","info"),I("  demo <id>         Demosaic (0=Lin, 3=AHD, -1=Raw)","info"),I("  matrix <n1..n9>   Set Custom Color Matrix","info"),I("  xtrans <on|off>   Force X-Trans Mode","info"),I("  xtrans phase <x> <y>  Set X-Trans Phase","info"),I("  render            Apply settings & Render","info"),I("  render zero       Zero-Dependency Render","info"),I("  render unmix      Advanced Unmixing Render","info"),I("  sel <full|center> Select ROI","info"),I("  sel <x> <y> <w> <h> Select ROI manually","info"),I("  mark              Start DR Lab Corner Marking","info"),I("  gen test          Generate Test Pattern","info"),I("  fft load <a>      Load FFT Pair Image A","info"),I("  fft load <b>      Load FFT Pair Image B","info"),I("  fft run           Run FFT Pair Diff","info"),I("  cls               Clear Screen","info");break;case"cls":case"clear":k([]);break;case"ev":case"exposure":if(oe.length<1){I(`Current EV: ${G.current.exposure}`,"info");return}const ke=parseFloat(oe[0]);if(isNaN(ke)){I("Invalid EV value","err");return}G.current.exposure=ke,I(`EV set to ${ke} (run 'render' to apply)`);break;case"wb":if(oe.length<2){I("Usage: wb <red_gain> <blue_gain>","err");return}const ve=parseFloat(oe[0]),ge=parseFloat(oe[1]);if(isNaN(ve)||isNaN(ge)){I("Invalid gains","err");return}G.current.wbGains=[ve,ge],I(`WB set to R:${ve} B:${ge}`);break;case"bl":case"black":if(oe.length===0){I(`Current BL: ${((ye=G.current.blackLevel)==null?void 0:ye.join(" "))||"Auto"}`,"info");return}let Me=oe.map(Number);if(Me.some(isNaN)){I("Invalid numbers","err");return}if(Me.length===1&&(Me=[Me[0],Me[0],Me[0],Me[0]]),Me.length<4){I("Need 1 or 4 values","err");return}G.current.blackLevel=[Me[0],Me[1],Me[2],Me[3]],G.current.subtractBlackLevelFromStats=!0,G.current.showKadc=!0,I(`Black Level set: ${Me.slice(0,4).join(" ")}`);break;case"demo":case"demosaic":if(oe.length===0){I("Usage: demo <id> (0=Lin, 1=VNG, 2=PPG, 3=AHD, 4=DCB, 11=DHT, 12=AAHD, -1=Raw)","info");return}const Oe=parseInt(oe[0]);if(isNaN(Oe)){I("Invalid method ID","err");return}G.current.demosaicMethod=Oe,I(`Demosaic set to ID ${Oe}`);break;case"matrix":if(oe.length!==9){I("Usage: matrix m1 m2 m3 m4 m5 m6 m7 m8 m9 (3x3)","err");return}const We=oe.map(Number);if(We.some(isNaN)){I("Invalid matrix values","err");return}G.current.customMatrix=We,I("Custom Color Matrix set.");break;case"xtrans":if(oe[0]==="on"||oe[0]==="true")m?(m(!0),I("X-Trans conversion ON")):I("Feature not available","err");else if(oe[0]==="off"||oe[0]==="false")m?(m(!1),I("X-Trans conversion OFF")):I("Feature not available","err");else if(oe[0]==="phase"){if(oe.length<3){I("Usage: xtrans phase <x> <y>","err");return}const Le=parseInt(oe[1]),tt=parseInt(oe[2]);v&&(v({x:Le,y:tt}),I(`X-Trans Phase set to (${Le}, ${tt})`))}else I("Usage: xtrans <on|off> OR xtrans phase <x> <y>","err");break;case"render":case"apply":if(oe[0]==="zero"){const Le=oe[1]==="color"?"zero-dep-color":"zero-dependency";G.current.renderMode=Le,I(`Rendering Zero-Dependency (${Le})...`)}else if(oe[0]==="unmix"){if(oe.length<13){I("Usage: render unmix <4xBL> <4xBG> <4xFG>","err");return}const Le=oe.slice(1).map(Number);if(Le.some(isNaN)){I("Invalid params","err");return}G.current.renderMode="advanced-zero-dep",G.current.advancedZeroDep={bl:[Le[0],Le[1],Le[2],Le[3]],bg:[Le[4],Le[5],Le[6],Le[7]],fg:[Le[8],Le[9],Le[10],Le[11]]},I("Rendering Advanced Unmix...")}else G.current.renderMode="standard",I("Rendering Standard Pipeline...");a({...G.current});break;case"sel":case"select":if(!r||!i){I("No image loaded","err");return}if(oe[0]==="full")i({x:0,y:0,w:r.width,h:r.height});else if(oe[0]==="center"){const Le=parseInt(oe[1])||64,tt=Math.floor((r.width-Le)/2),mt=Math.floor((r.height-Le)/2);i({x:tt,y:mt,w:Le,h:Le})}else if(oe.length===4){const[Le,tt,mt,wt]=oe.map(Number);if([Le,tt,mt,wt].some(isNaN)){I("Invalid coordinates","err");return}i({x:Le,y:tt,w:mt,h:wt})}else I("Usage: sel full | sel center <size> | sel <x> <y> <w> <h>","err");break;case"mark":o&&(o(),I("Interactive marking started. Click 4 corners on canvas."));break;case"gen":(oe[0]==="test"||oe[0]==="pattern")&&s&&(s(),I("Generated Test Pattern"));break;case"drlab":if(oe[0]==="config"){const[Le,tt,mt]=oe.slice(1).map(Number);e.onDrRoiSizeChange&&e.onDrRoiSizeChange(Le||64),e.onDrGridRowsChange&&e.onDrGridRowsChange(tt||10),e.onDrGridColsChange&&e.onDrGridColsChange(mt||10),I(`DR Grid Configured: Size=${Le}, Grid=${tt}x${mt}`)}else oe[0]==="batch"&&(oe[1]==="pair"?(I("Select file pairs for DR Lab..."),(ae=E.current)==null||ae.click()):(I("Select single files for DR Lab..."),(X=$.current)==null||X.click()));break;case"fft":oe[0]==="load"?oe[1]==="a"?(se=T.current)==null||se.click():oe[1]==="b"?(he=B.current)==null||he.click():I("Usage: fft load <a|b>","err"):oe[0]==="run"?D.current.fileA&&D.current.fileB&&u?(I(`Processing Pair: ${D.current.fileA.name} - ${D.current.fileB.name}`),u(D.current.fileA,D.current.fileB,!1,!0)):I("Load both A and B first","err"):oe[0]==="stack"?(I("Select files for Stack FFT..."),(le=U.current)==null||le.click()):oe[0]==="batch"&&(I("Select files for Batch Diff...","info"),(je=V.current)==null||je.click());break;case"crosscalc":p&&(p(),I("Opened Cross-Calculator"));break;default:I(`Unknown command: ${fe}`,"err")}},W=re=>{if(re.key==="Enter"){const ee=x.trim();if(!ee)return;I(`> ${ee}`,"in"),ee.split(";").forEach(oe=>{oe.trim()&&H(oe.trim())}),_(oe=>[...oe,ee]),j(-1),y("")}else if(re.key==="ArrowUp"){if(re.preventDefault(),w.length>0){const ee=S===-1?w.length-1:Math.max(0,S-1);j(ee),y(w[ee])}}else if(re.key==="ArrowDown")if(re.preventDefault(),S!==-1){const ee=Math.min(w.length-1,S+1);j(ee),y(w[ee])}else y("")},Q=(re,ee)=>{re.target.files&&re.target.files.length>0&&l&&(I(`Batch processing ${re.target.files.length} files in ${ee} mode...`),l(re.target.files,ee)),re.target.value=""},q=(re,ee)=>{var oe;const fe=(oe=re.target.files)==null?void 0:oe[0];fe&&(ee==="A"?D.current.fileA=fe:D.current.fileB=fe,I(`Loaded ${ee}: ${fe.name}`)),re.target.value=""};return c.jsxs("div",{className:"flex flex-col h-full bg-black text-green-500 font-mono text-sm border-l-4 border-gray-700 p-2 shadow-2xl",children:[c.jsxs("div",{className:"border-b border-green-800 pb-2 mb-2 flex justify-between items-end select-none",children:[c.jsx("h2",{className:"text-xl font-bold tracking-widest",children:"TERMINAL"}),c.jsx("div",{className:"text-[10px] text-green-700",children:"JIANGTHERAPEE_CLI_V1"})]}),c.jsx("div",{ref:M,className:"flex-grow overflow-y-auto overflow-x-hidden break-words mb-2 pr-1 scrollbar-thin scrollbar-thumb-green-900 scrollbar-track-black",children:b.map(re=>c.jsxs("div",{className:`mb-1 ${re.type==="in"?"opacity-50":""} ${re.type==="err"?"text-red-500":""} ${re.type==="info"?"text-cyan-400":""}`,children:[re.type!=="in"&&typeof re.text=="string"&&!re.text.startsWith(">")&&c.jsx("span",{className:"mr-2 opacity-50",children:">"}),re.text]},re.id))}),c.jsxs("div",{className:"relative flex items-center border-t border-green-800 pt-2",children:[c.jsx("span",{className:"text-green-500 mr-2 animate-pulse font-bold",children:">"}),c.jsx("input",{ref:A,type:"text",value:x,onChange:re=>y(re.target.value),onKeyDown:W,autoFocus:!0,className:"w-full bg-transparent border-none outline-none text-green-400 placeholder-green-900",placeholder:"Enter command (e.g. 'help')",spellCheck:!1,autoComplete:"off"})]}),c.jsx("input",{type:"file",ref:$,className:"hidden",multiple:!0,onChange:re=>Q(re,"single")}),c.jsx("input",{type:"file",ref:E,className:"hidden",multiple:!0,onChange:re=>Q(re,"pair")}),c.jsx("input",{type:"file",ref:T,className:"hidden",onChange:re=>q(re,"A")}),c.jsx("input",{type:"file",ref:B,className:"hidden",onChange:re=>q(re,"B")}),c.jsx("input",{type:"file",ref:U,className:"hidden",multiple:!0,onChange:re=>{e.onProcessStackFft&&re.target.files&&(I(`Loading ${re.target.files.length} frames for Stack FFT...`),e.onProcessStackFft(re.target.files)),re.target.value=""}}),c.jsx("input",{type:"file",ref:V,className:"hidden",multiple:!0,onChange:re=>{e.onProcessBatchDiff&&re.target.files&&(I("Starting Batch Diff..."),e.onProcessBatchDiff(re.target.files)),re.target.value=""}})]})}),uA=(e,t)=>{if(!e)return null;if(t){const r=e.bayerPattern.toUpperCase(),n=l=>{const u=[];for(let f=0;f<4;f++)r[f]===l&&u.push(f);return u},a=t.BlackLevelRed,i=t.BlackLevelGreen,o=t.BlackLevelBlue;if(a!==void 0&&i!==void 0&&o!==void 0){const l=parseFloat(a),u=parseFloat(i),f=parseFloat(o);if(!isNaN(l)&&!isNaN(u)&&!isNaN(f)){const d=[0,0,0,0];if(d.fill(u),n("R").forEach(p=>d[p]=l),n("G").forEach(p=>d[p]=u),n("B").forEach(p=>d[p]=f),d.some(p=>p>0))return d}}let s=t.BlackLevel;if(s===void 0&&(s=t.BlackLevel2),s!==void 0){let l=[];if(Array.isArray(s)?l=s.map(Number):typeof s=="string"?l=s.trim().split(/\s+/).map(Number):typeof s=="number"&&(l=[s,s,s,s]),l.length===1&&!isNaN(l[0])&&(l=[l[0],l[0],l[0],l[0]]),l.length>=4&&!l.slice(0,4).some(isNaN)&&l.some(u=>u>0))return[l[0],l[1],l[2],l[3]]}}return e.blackLevels&&e.blackLevels.length===4?[e.blackLevels[0],e.blackLevels[1],e.blackLevels[2],e.blackLevels[3]]:null},fA=e=>{const[t,r]=C.useState("gui"),{rawImageData:n,exifData:a,isBridgeConnected:i,displaySettings:o,onApplyDisplaySettings:s}=e,l=C.useRef(null),u=C.useRef(o);C.useEffect(()=>{u.current=o},[o]);const f=C.useRef(!1),d=C.useRef(null);C.useEffect(()=>{n!==d.current&&(f.current=!1,d.current=n)},[n]),C.useEffect(()=>{var w;if(!i||!n||f.current)return;const m=uA(n,a);if(!(!!m&&m.some(_=>_>0))||!m)return;const b=u.current,k=b.blackLevel;if(!!k&&k.some(_=>_>0)){f.current=!0;return}f.current=!0,console.log("[AutoApply] Detected Black Levels via Bridge:",m),(w=l.current)==null||w.log(`Auto-detected BL: ${m.join(" ")}`,"info");const y={...b,blackLevel:m};s(y)},[i,n,a,s]);const p=C.useCallback(m=>{var v;(v=l.current)==null||v.log(m,"in")},[]);return c.jsxs("div",{className:"flex flex-col h-full",children:[c.jsxs("div",{className:"flex bg-gray-200 dark:bg-gray-800 p-1 border-b border-gray-300 dark:border-gray-700 flex-shrink-0",children:[c.jsx("button",{onClick:()=>r("gui"),className:`flex-1 py-1 text-xs font-bold uppercase tracking-wider transition-colors border-r border-gray-300 dark:border-gray-700 ${t==="gui"?"bg-white dark:bg-black shadow-inner text-cyan-600 dark:text-cyan-400":"bg-gray-200 dark:bg-gray-900 text-gray-500 hover:text-gray-700 dark:hover:text-gray-300"}`,children:"GUI"}),c.jsx("button",{onClick:()=>r("terminal"),className:`flex-1 py-1 text-xs font-bold uppercase tracking-wider transition-colors ${t==="terminal"?"bg-black text-green-500 shadow-inner":"bg-gray-200 dark:bg-gray-900 text-gray-500 hover:text-gray-700 dark:hover:text-gray-300"}`,children:"Terminal"})]}),c.jsxs("div",{className:"flex-grow overflow-hidden relative",children:[c.jsx("div",{className:`h-full w-full ${t==="gui"?"block":"hidden"}`,children:c.jsx(lA,{...e,onCommand:p})}),c.jsx("div",{className:`h-full w-full ${t==="terminal"?"block":"hidden"}`,children:c.jsx(cA,{...e,ref:l})})]})]})},dA=()=>c.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M20 12H4"})}),hA=()=>c.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 4v16m8-8H4"})}),pA=()=>c.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M4 4v5h5M4 12a8 8 0 0114.24-5.12M20 20v-5h-5M20 12a8 8 0 01-14.24 5.12"})}),gA=()=>c.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M7 11.5V14m0-2.5v-6a1.5 1.5 0 113 0m-3 6a1.5 1.5 0 00-3 0v2a7.5 7.5 0 0015 0v-5a1.5 1.5 0 00-3 0m-6-3V11m0-5.5v-1a1.5 1.5 0 013 0v1m0 0V11m0-5.5a1.5 1.5 0 013 0v3m0 0V11"})}),mA=()=>c.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M4 8V4m0 0h4M4 4l5 5m11-1V4m0 0h-4m4 4l-5 5M4 16v4m0 0h4m-4 0l5-5m11 5l-5-5m5 5v-4m0 4h-4"})}),Zy=.1,Qy=16,yA=Math.log(Zy),vA=Math.log(Qy),xA=({zoom:e,onZoomChange:t,onResetView:r,touchAction:n,onToggleTouchAction:a})=>{const i=u=>{const f=parseFloat(u.target.value),d=Math.exp(f);t(Math.max(Zy,Math.min(Qy,d)))},o=()=>{t(Math.min(Qy,e*1.25))},s=()=>{t(Math.max(Zy,e/1.25))},l=Math.log(e);return c.jsxs("div",{className:"absolute top-4 right-4 flex gap-2",onClick:u=>u.stopPropagation(),children:[c.jsx("div",{className:"bg-white/90 dark:bg-slate-800/70 backdrop-blur-sm p-2 rounded-lg border border-gray-200 dark:border-slate-700 flex items-center shadow-lg transition-colors duration-300",children:c.jsx("button",{onClick:a,className:`p-1.5 rounded-md transition-colors flex items-center justify-center ${n==="select"?"bg-cyan-100 text-cyan-600 dark:bg-cyan-900/50 dark:text-cyan-400 ring-2 ring-cyan-500/50":"text-gray-500 dark:text-slate-400 hover:bg-gray-100 dark:hover:bg-slate-700"}`,title:n==="select"?"Mode: Selection (Drag to Select)":"Mode: Pan (Drag to Move)",children:n==="select"?c.jsx(mA,{}):c.jsx(gA,{})})}),c.jsxs("div",{className:"bg-white/90 dark:bg-slate-800/70 backdrop-blur-sm p-2 rounded-lg border border-gray-200 dark:border-slate-700 flex items-center gap-2 text-gray-700 dark:text-slate-300 shadow-lg transition-colors duration-300",children:[c.jsx("button",{onClick:s,className:"p-1 rounded-md hover:bg-gray-100 dark:hover:bg-slate-700 transition-colors",title:"Zoom Out","aria-label":"Zoom Out",children:c.jsx(dA,{})}),c.jsx("input",{type:"range",min:yA,max:vA,step:"0.01",value:l,onChange:i,className:"w-24 sm:w-32 h-2 bg-gray-300 dark:bg-slate-700 rounded-lg appearance-none cursor-pointer accent-cyan-500","aria-label":"Zoom slider"}),c.jsx("button",{onClick:o,className:"p-1 rounded-md hover:bg-gray-100 dark:hover:bg-slate-700 transition-colors",title:"Zoom In","aria-label":"Zoom In",children:c.jsx(hA,{})}),c.jsxs("span",{className:"w-16 text-center font-mono text-sm","aria-live":"polite",children:[(e*100).toFixed(0),"%"]}),c.jsx("button",{onClick:r,className:"p-1 rounded-md hover:bg-gray-100 dark:hover:bg-slate-700 transition-colors",title:"Reset View","aria-label":"Reset View",children:c.jsx(pA,{})})]})]})},bA=({theme:e,setTheme:t})=>{const r=()=>{t(e==="light"?"dark":"light")};return c.jsx("button",{onClick:r,className:"fixed bottom-6 right-6 z-50 p-3 rounded-full bg-white dark:bg-slate-800 border border-gray-200 dark:border-slate-700 shadow-lg text-gray-800 dark:text-yellow-400 hover:bg-gray-100 dark:hover:bg-slate-700 transition-all duration-300",title:`Switch to ${e==="light"?"dark":"light"} mode`,children:e==="light"?c.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6 text-slate-700",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003 0 0012 21a9.003 9.003 0 008.354-5.646z"})}):c.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z"})})})};function Zj(e){var t,r,n="";if(typeof e=="string"||typeof e=="number")n+=e;else if(typeof e=="object")if(Array.isArray(e)){var a=e.length;for(t=0;t<a;t++)e[t]&&(r=Zj(e[t]))&&(n&&(n+=" "),n+=r)}else for(r in e)e[r]&&(n&&(n+=" "),n+=r);return n}function lr(){for(var e,t,r=0,n="",a=arguments.length;r<a;r++)(e=arguments[r])&&(t=Zj(e))&&(n&&(n+=" "),n+=t);return n}var wA=Array.isArray,Da=wA,kA=typeof kd=="object"&&kd&&kd.Object===Object&&kd,Qj=kA,SA=Qj,jA=typeof self=="object"&&self&&self.Object===Object&&self,_A=SA||jA||Function("return this")(),to=_A,PA=to,CA=PA.Symbol,id=CA,jw=id,Jj=Object.prototype,NA=Jj.hasOwnProperty,MA=Jj.toString,bu=jw?jw.toStringTag:void 0;function OA(e){var t=NA.call(e,bu),r=e[bu];try{e[bu]=void 0;var n=!0}catch{}var a=MA.call(e);return n&&(t?e[bu]=r:delete e[bu]),a}var AA=OA,TA=Object.prototype,EA=TA.toString;function $A(e){return EA.call(e)}var RA=$A,_w=id,DA=AA,IA=RA,LA="[object Null]",BA="[object Undefined]",Pw=_w?_w.toStringTag:void 0;function FA(e){return e==null?e===void 0?BA:LA:Pw&&Pw in Object(e)?DA(e):IA(e)}var Co=FA;function UA(e){return e!=null&&typeof e=="object"}var No=UA,GA=Co,zA=No,WA="[object Symbol]";function VA(e){return typeof e=="symbol"||zA(e)&&GA(e)==WA}var Hc=VA,HA=Da,XA=Hc,KA=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,qA=/^\w*$/;function YA(e,t){if(HA(e))return!1;var r=typeof e;return r=="number"||r=="symbol"||r=="boolean"||e==null||XA(e)?!0:qA.test(e)||!KA.test(e)||t!=null&&e in Object(t)}var $1=YA;function ZA(e){var t=typeof e;return e!=null&&(t=="object"||t=="function")}var ms=ZA;const Xc=Fr(ms);var QA=Co,JA=ms,eT="[object AsyncFunction]",tT="[object Function]",rT="[object GeneratorFunction]",nT="[object Proxy]";function aT(e){if(!JA(e))return!1;var t=QA(e);return t==tT||t==rT||t==eT||t==nT}var R1=aT;const Rt=Fr(R1);var iT=to,oT=iT["__core-js_shared__"],sT=oT,bm=sT,Cw=function(){var e=/[^.]+$/.exec(bm&&bm.keys&&bm.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}();function lT(e){return!!Cw&&Cw in e}var cT=lT,uT=Function.prototype,fT=uT.toString;function dT(e){if(e!=null){try{return fT.call(e)}catch{}try{return e+""}catch{}}return""}var e_=dT,hT=R1,pT=cT,gT=ms,mT=e_,yT=/[\\^$.*+?()[\]{}|]/g,vT=/^\[object .+?Constructor\]$/,xT=Function.prototype,bT=Object.prototype,wT=xT.toString,kT=bT.hasOwnProperty,ST=RegExp("^"+wT.call(kT).replace(yT,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function jT(e){if(!gT(e)||pT(e))return!1;var t=hT(e)?ST:vT;return t.test(mT(e))}var _T=jT;function PT(e,t){return e==null?void 0:e[t]}var CT=PT,NT=_T,MT=CT;function OT(e,t){var r=MT(e,t);return NT(r)?r:void 0}var xl=OT,AT=xl,TT=AT(Object,"create"),_p=TT,Nw=_p;function ET(){this.__data__=Nw?Nw(null):{},this.size=0}var $T=ET;function RT(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t}var DT=RT,IT=_p,LT="__lodash_hash_undefined__",BT=Object.prototype,FT=BT.hasOwnProperty;function UT(e){var t=this.__data__;if(IT){var r=t[e];return r===LT?void 0:r}return FT.call(t,e)?t[e]:void 0}var GT=UT,zT=_p,WT=Object.prototype,VT=WT.hasOwnProperty;function HT(e){var t=this.__data__;return zT?t[e]!==void 0:VT.call(t,e)}var XT=HT,KT=_p,qT="__lodash_hash_undefined__";function YT(e,t){var r=this.__data__;return this.size+=this.has(e)?0:1,r[e]=KT&&t===void 0?qT:t,this}var ZT=YT,QT=$T,JT=DT,e8=GT,t8=XT,r8=ZT;function Kc(e){var t=-1,r=e==null?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}Kc.prototype.clear=QT;Kc.prototype.delete=JT;Kc.prototype.get=e8;Kc.prototype.has=t8;Kc.prototype.set=r8;var n8=Kc;function a8(){this.__data__=[],this.size=0}var i8=a8;function o8(e,t){return e===t||e!==e&&t!==t}var D1=o8,s8=D1;function l8(e,t){for(var r=e.length;r--;)if(s8(e[r][0],t))return r;return-1}var Pp=l8,c8=Pp,u8=Array.prototype,f8=u8.splice;function d8(e){var t=this.__data__,r=c8(t,e);if(r<0)return!1;var n=t.length-1;return r==n?t.pop():f8.call(t,r,1),--this.size,!0}var h8=d8,p8=Pp;function g8(e){var t=this.__data__,r=p8(t,e);return r<0?void 0:t[r][1]}var m8=g8,y8=Pp;function v8(e){return y8(this.__data__,e)>-1}var x8=v8,b8=Pp;function w8(e,t){var r=this.__data__,n=b8(r,e);return n<0?(++this.size,r.push([e,t])):r[n][1]=t,this}var k8=w8,S8=i8,j8=h8,_8=m8,P8=x8,C8=k8;function qc(e){var t=-1,r=e==null?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}qc.prototype.clear=S8;qc.prototype.delete=j8;qc.prototype.get=_8;qc.prototype.has=P8;qc.prototype.set=C8;var Cp=qc,N8=xl,M8=to,O8=N8(M8,"Map"),I1=O8,Mw=n8,A8=Cp,T8=I1;function E8(){this.size=0,this.__data__={hash:new Mw,map:new(T8||A8),string:new Mw}}var $8=E8;function R8(e){var t=typeof e;return t=="string"||t=="number"||t=="symbol"||t=="boolean"?e!=="__proto__":e===null}var D8=R8,I8=D8;function L8(e,t){var r=e.__data__;return I8(t)?r[typeof t=="string"?"string":"hash"]:r.map}var Np=L8,B8=Np;function F8(e){var t=B8(this,e).delete(e);return this.size-=t?1:0,t}var U8=F8,G8=Np;function z8(e){return G8(this,e).get(e)}var W8=z8,V8=Np;function H8(e){return V8(this,e).has(e)}var X8=H8,K8=Np;function q8(e,t){var r=K8(this,e),n=r.size;return r.set(e,t),this.size+=r.size==n?0:1,this}var Y8=q8,Z8=$8,Q8=U8,J8=W8,eE=X8,tE=Y8;function Yc(e){var t=-1,r=e==null?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}Yc.prototype.clear=Z8;Yc.prototype.delete=Q8;Yc.prototype.get=J8;Yc.prototype.has=eE;Yc.prototype.set=tE;var L1=Yc,t_=L1,rE="Expected a function";function B1(e,t){if(typeof e!="function"||t!=null&&typeof t!="function")throw new TypeError(rE);var r=function(){var n=arguments,a=t?t.apply(this,n):n[0],i=r.cache;if(i.has(a))return i.get(a);var o=e.apply(this,n);return r.cache=i.set(a,o)||i,o};return r.cache=new(B1.Cache||t_),r}B1.Cache=t_;var r_=B1;const nE=Fr(r_);var aE=r_,iE=500;function oE(e){var t=aE(e,function(n){return r.size===iE&&r.clear(),n}),r=t.cache;return t}var sE=oE,lE=sE,cE=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,uE=/\\(\\)?/g,fE=lE(function(e){var t=[];return e.charCodeAt(0)===46&&t.push(""),e.replace(cE,function(r,n,a,i){t.push(a?i.replace(uE,"$1"):n||r)}),t}),dE=fE;function hE(e,t){for(var r=-1,n=e==null?0:e.length,a=Array(n);++r<n;)a[r]=t(e[r],r,e);return a}var F1=hE,Ow=id,pE=F1,gE=Da,mE=Hc,Aw=Ow?Ow.prototype:void 0,Tw=Aw?Aw.toString:void 0;function n_(e){if(typeof e=="string")return e;if(gE(e))return pE(e,n_)+"";if(mE(e))return Tw?Tw.call(e):"";var t=e+"";return t=="0"&&1/e==-1/0?"-0":t}var yE=n_,vE=yE;function xE(e){return e==null?"":vE(e)}var a_=xE,bE=Da,wE=$1,kE=dE,SE=a_;function jE(e,t){return bE(e)?e:wE(e,t)?[e]:kE(SE(e))}var i_=jE,_E=Hc;function PE(e){if(typeof e=="string"||_E(e))return e;var t=e+"";return t=="0"&&1/e==-1/0?"-0":t}var Mp=PE,CE=i_,NE=Mp;function ME(e,t){t=CE(t,e);for(var r=0,n=t.length;e!=null&&r<n;)e=e[NE(t[r++])];return r&&r==n?e:void 0}var U1=ME,OE=U1;function AE(e,t,r){var n=e==null?void 0:OE(e,t);return n===void 0?r:n}var o_=AE;const ui=Fr(o_);function TE(e){return e==null}var EE=TE;const Ot=Fr(EE);var $E=Co,RE=Da,DE=No,IE="[object String]";function LE(e){return typeof e=="string"||!RE(e)&&DE(e)&&$E(e)==IE}var BE=LE;const ul=Fr(BE);var s_={exports:{}},Or={};/**
 * @license React
 * react-is.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var G1=Symbol.for("react.element"),z1=Symbol.for("react.portal"),Op=Symbol.for("react.fragment"),Ap=Symbol.for("react.strict_mode"),Tp=Symbol.for("react.profiler"),Ep=Symbol.for("react.provider"),$p=Symbol.for("react.context"),FE=Symbol.for("react.server_context"),Rp=Symbol.for("react.forward_ref"),Dp=Symbol.for("react.suspense"),Ip=Symbol.for("react.suspense_list"),Lp=Symbol.for("react.memo"),Bp=Symbol.for("react.lazy"),UE=Symbol.for("react.offscreen"),l_;l_=Symbol.for("react.module.reference");function pi(e){if(typeof e=="object"&&e!==null){var t=e.$$typeof;switch(t){case G1:switch(e=e.type,e){case Op:case Tp:case Ap:case Dp:case Ip:return e;default:switch(e=e&&e.$$typeof,e){case FE:case $p:case Rp:case Bp:case Lp:case Ep:return e;default:return t}}case z1:return t}}}Or.ContextConsumer=$p;Or.ContextProvider=Ep;Or.Element=G1;Or.ForwardRef=Rp;Or.Fragment=Op;Or.Lazy=Bp;Or.Memo=Lp;Or.Portal=z1;Or.Profiler=Tp;Or.StrictMode=Ap;Or.Suspense=Dp;Or.SuspenseList=Ip;Or.isAsyncMode=function(){return!1};Or.isConcurrentMode=function(){return!1};Or.isContextConsumer=function(e){return pi(e)===$p};Or.isContextProvider=function(e){return pi(e)===Ep};Or.isElement=function(e){return typeof e=="object"&&e!==null&&e.$$typeof===G1};Or.isForwardRef=function(e){return pi(e)===Rp};Or.isFragment=function(e){return pi(e)===Op};Or.isLazy=function(e){return pi(e)===Bp};Or.isMemo=function(e){return pi(e)===Lp};Or.isPortal=function(e){return pi(e)===z1};Or.isProfiler=function(e){return pi(e)===Tp};Or.isStrictMode=function(e){return pi(e)===Ap};Or.isSuspense=function(e){return pi(e)===Dp};Or.isSuspenseList=function(e){return pi(e)===Ip};Or.isValidElementType=function(e){return typeof e=="string"||typeof e=="function"||e===Op||e===Tp||e===Ap||e===Dp||e===Ip||e===UE||typeof e=="object"&&e!==null&&(e.$$typeof===Bp||e.$$typeof===Lp||e.$$typeof===Ep||e.$$typeof===$p||e.$$typeof===Rp||e.$$typeof===l_||e.getModuleId!==void 0)};Or.typeOf=pi;s_.exports=Or;var GE=s_.exports,zE=Co,WE=No,VE="[object Number]";function HE(e){return typeof e=="number"||WE(e)&&zE(e)==VE}var c_=HE;const XE=Fr(c_);var KE=c_;function qE(e){return KE(e)&&e!=+e}var YE=qE;const Zc=Fr(YE);var Ci=function(t){return t===0?0:t>0?1:-1},Gs=function(t){return ul(t)&&t.indexOf("%")===t.length-1},$e=function(t){return XE(t)&&!Zc(t)},ZE=function(t){return Ot(t)},zn=function(t){return $e(t)||ul(t)},QE=0,bl=function(t){var r=++QE;return"".concat(t||"").concat(r)},fl=function(t,r){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(!$e(t)&&!ul(t))return n;var i;if(Gs(t)){var o=t.indexOf("%");i=r*parseFloat(t.slice(0,o))/100}else i=+t;return Zc(i)&&(i=n),a&&i>r&&(i=r),i},Uo=function(t){if(!t)return null;var r=Object.keys(t);return r&&r.length?t[r[0]]:null},JE=function(t){if(!Array.isArray(t))return!1;for(var r=t.length,n={},a=0;a<r;a++)if(!n[t[a]])n[t[a]]=!0;else return!0;return!1},Cn=function(t,r){return $e(t)&&$e(r)?function(n){return t+n*(r-t)}:function(){return r}};function eh(e,t,r){return!e||!e.length?null:e.find(function(n){return n&&(typeof t=="function"?t(n):ui(n,t))===r})}var e$=function(t){if(!t||!t.length)return null;for(var r=t.length,n=0,a=0,i=0,o=0,s=1/0,l=-1/0,u=0,f=0,d=0;d<r;d++)u=t[d].cx||0,f=t[d].cy||0,n+=u,a+=f,i+=u*f,o+=u*u,s=Math.min(s,u),l=Math.max(l,u);var p=r*o!==n*n?(r*i-n*a)/(r*o-n*n):0;return{xmin:s,xmax:l,a:p,b:(a-p*n)/r}},t$=function(t,r){return $e(t)&&$e(r)?t-r:ul(t)&&ul(r)?t.localeCompare(r):t instanceof Date&&r instanceof Date?t.getTime()-r.getTime():String(t).localeCompare(String(r))};function nc(e,t){for(var r in e)if({}.hasOwnProperty.call(e,r)&&(!{}.hasOwnProperty.call(t,r)||e[r]!==t[r]))return!1;for(var n in t)if({}.hasOwnProperty.call(t,n)&&!{}.hasOwnProperty.call(e,n))return!1;return!0}function Jy(e){"@babel/helpers - typeof";return Jy=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Jy(e)}var r$=["viewBox","children"],n$=["aria-activedescendant","aria-atomic","aria-autocomplete","aria-busy","aria-checked","aria-colcount","aria-colindex","aria-colspan","aria-controls","aria-current","aria-describedby","aria-details","aria-disabled","aria-errormessage","aria-expanded","aria-flowto","aria-haspopup","aria-hidden","aria-invalid","aria-keyshortcuts","aria-label","aria-labelledby","aria-level","aria-live","aria-modal","aria-multiline","aria-multiselectable","aria-orientation","aria-owns","aria-placeholder","aria-posinset","aria-pressed","aria-readonly","aria-relevant","aria-required","aria-roledescription","aria-rowcount","aria-rowindex","aria-rowspan","aria-selected","aria-setsize","aria-sort","aria-valuemax","aria-valuemin","aria-valuenow","aria-valuetext","className","color","height","id","lang","max","media","method","min","name","style","target","width","role","tabIndex","accentHeight","accumulate","additive","alignmentBaseline","allowReorder","alphabetic","amplitude","arabicForm","ascent","attributeName","attributeType","autoReverse","azimuth","baseFrequency","baselineShift","baseProfile","bbox","begin","bias","by","calcMode","capHeight","clip","clipPath","clipPathUnits","clipRule","colorInterpolation","colorInterpolationFilters","colorProfile","colorRendering","contentScriptType","contentStyleType","cursor","cx","cy","d","decelerate","descent","diffuseConstant","direction","display","divisor","dominantBaseline","dur","dx","dy","edgeMode","elevation","enableBackground","end","exponent","externalResourcesRequired","fill","fillOpacity","fillRule","filter","filterRes","filterUnits","floodColor","floodOpacity","focusable","fontFamily","fontSize","fontSizeAdjust","fontStretch","fontStyle","fontVariant","fontWeight","format","from","fx","fy","g1","g2","glyphName","glyphOrientationHorizontal","glyphOrientationVertical","glyphRef","gradientTransform","gradientUnits","hanging","horizAdvX","horizOriginX","href","ideographic","imageRendering","in2","in","intercept","k1","k2","k3","k4","k","kernelMatrix","kernelUnitLength","kerning","keyPoints","keySplines","keyTimes","lengthAdjust","letterSpacing","lightingColor","limitingConeAngle","local","markerEnd","markerHeight","markerMid","markerStart","markerUnits","markerWidth","mask","maskContentUnits","maskUnits","mathematical","mode","numOctaves","offset","opacity","operator","order","orient","orientation","origin","overflow","overlinePosition","overlineThickness","paintOrder","panose1","pathLength","patternContentUnits","patternTransform","patternUnits","pointerEvents","pointsAtX","pointsAtY","pointsAtZ","preserveAlpha","preserveAspectRatio","primitiveUnits","r","radius","refX","refY","renderingIntent","repeatCount","repeatDur","requiredExtensions","requiredFeatures","restart","result","rotate","rx","ry","seed","shapeRendering","slope","spacing","specularConstant","specularExponent","speed","spreadMethod","startOffset","stdDeviation","stemh","stemv","stitchTiles","stopColor","stopOpacity","strikethroughPosition","strikethroughThickness","string","stroke","strokeDasharray","strokeDashoffset","strokeLinecap","strokeLinejoin","strokeMiterlimit","strokeOpacity","strokeWidth","surfaceScale","systemLanguage","tableValues","targetX","targetY","textAnchor","textDecoration","textLength","textRendering","to","transform","u1","u2","underlinePosition","underlineThickness","unicode","unicodeBidi","unicodeRange","unitsPerEm","vAlphabetic","values","vectorEffect","version","vertAdvY","vertOriginX","vertOriginY","vHanging","vIdeographic","viewTarget","visibility","vMathematical","widths","wordSpacing","writingMode","x1","x2","x","xChannelSelector","xHeight","xlinkActuate","xlinkArcrole","xlinkHref","xlinkRole","xlinkShow","xlinkTitle","xlinkType","xmlBase","xmlLang","xmlns","xmlnsXlink","xmlSpace","y1","y2","y","yChannelSelector","z","zoomAndPan","ref","key","angle"],Ew=["points","pathLength"],wm={svg:r$,polygon:Ew,polyline:Ew},W1=["dangerouslySetInnerHTML","onCopy","onCopyCapture","onCut","onCutCapture","onPaste","onPasteCapture","onCompositionEnd","onCompositionEndCapture","onCompositionStart","onCompositionStartCapture","onCompositionUpdate","onCompositionUpdateCapture","onFocus","onFocusCapture","onBlur","onBlurCapture","onChange","onChangeCapture","onBeforeInput","onBeforeInputCapture","onInput","onInputCapture","onReset","onResetCapture","onSubmit","onSubmitCapture","onInvalid","onInvalidCapture","onLoad","onLoadCapture","onError","onErrorCapture","onKeyDown","onKeyDownCapture","onKeyPress","onKeyPressCapture","onKeyUp","onKeyUpCapture","onAbort","onAbortCapture","onCanPlay","onCanPlayCapture","onCanPlayThrough","onCanPlayThroughCapture","onDurationChange","onDurationChangeCapture","onEmptied","onEmptiedCapture","onEncrypted","onEncryptedCapture","onEnded","onEndedCapture","onLoadedData","onLoadedDataCapture","onLoadedMetadata","onLoadedMetadataCapture","onLoadStart","onLoadStartCapture","onPause","onPauseCapture","onPlay","onPlayCapture","onPlaying","onPlayingCapture","onProgress","onProgressCapture","onRateChange","onRateChangeCapture","onSeeked","onSeekedCapture","onSeeking","onSeekingCapture","onStalled","onStalledCapture","onSuspend","onSuspendCapture","onTimeUpdate","onTimeUpdateCapture","onVolumeChange","onVolumeChangeCapture","onWaiting","onWaitingCapture","onAuxClick","onAuxClickCapture","onClick","onClickCapture","onContextMenu","onContextMenuCapture","onDoubleClick","onDoubleClickCapture","onDrag","onDragCapture","onDragEnd","onDragEndCapture","onDragEnter","onDragEnterCapture","onDragExit","onDragExitCapture","onDragLeave","onDragLeaveCapture","onDragOver","onDragOverCapture","onDragStart","onDragStartCapture","onDrop","onDropCapture","onMouseDown","onMouseDownCapture","onMouseEnter","onMouseLeave","onMouseMove","onMouseMoveCapture","onMouseOut","onMouseOutCapture","onMouseOver","onMouseOverCapture","onMouseUp","onMouseUpCapture","onSelect","onSelectCapture","onTouchCancel","onTouchCancelCapture","onTouchEnd","onTouchEndCapture","onTouchMove","onTouchMoveCapture","onTouchStart","onTouchStartCapture","onPointerDown","onPointerDownCapture","onPointerMove","onPointerMoveCapture","onPointerUp","onPointerUpCapture","onPointerCancel","onPointerCancelCapture","onPointerEnter","onPointerEnterCapture","onPointerLeave","onPointerLeaveCapture","onPointerOver","onPointerOverCapture","onPointerOut","onPointerOutCapture","onGotPointerCapture","onGotPointerCaptureCapture","onLostPointerCapture","onLostPointerCaptureCapture","onScroll","onScrollCapture","onWheel","onWheelCapture","onAnimationStart","onAnimationStartCapture","onAnimationEnd","onAnimationEndCapture","onAnimationIteration","onAnimationIterationCapture","onTransitionEnd","onTransitionEndCapture"],th=function(t,r){if(!t||typeof t=="function"||typeof t=="boolean")return null;var n=t;if(C.isValidElement(t)&&(n=t.props),!Xc(n))return null;var a={};return Object.keys(n).forEach(function(i){W1.includes(i)&&(a[i]=r||function(o){return n[i](n,o)})}),a},a$=function(t,r,n){return function(a){return t(r,n,a),null}},vf=function(t,r,n){if(!Xc(t)||Jy(t)!=="object")return null;var a=null;return Object.keys(t).forEach(function(i){var o=t[i];W1.includes(i)&&typeof o=="function"&&(a||(a={}),a[i]=a$(o,r,n))}),a},i$=["children"],o$=["children"];function $w(e,t){if(e==null)return{};var r=s$(e,t),n,a;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function s$(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function ev(e){"@babel/helpers - typeof";return ev=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ev(e)}var Rw={click:"onClick",mousedown:"onMouseDown",mouseup:"onMouseUp",mouseover:"onMouseOver",mousemove:"onMouseMove",mouseout:"onMouseOut",mouseenter:"onMouseEnter",mouseleave:"onMouseLeave",touchcancel:"onTouchCancel",touchend:"onTouchEnd",touchmove:"onTouchMove",touchstart:"onTouchStart",contextmenu:"onContextMenu",dblclick:"onDoubleClick"},mo=function(t){return typeof t=="string"?t:t?t.displayName||t.name||"Component":""},Dw=null,km=null,V1=function e(t){if(t===Dw&&Array.isArray(km))return km;var r=[];return C.Children.forEach(t,function(n){Ot(n)||(GE.isFragment(n)?r=r.concat(e(n.props.children)):r.push(n))}),km=r,Dw=t,r};function Ra(e,t){var r=[],n=[];return Array.isArray(t)?n=t.map(function(a){return mo(a)}):n=[mo(t)],V1(e).forEach(function(a){var i=ui(a,"type.displayName")||ui(a,"type.name");n.indexOf(i)!==-1&&r.push(a)}),r}function Ga(e,t){var r=Ra(e,t);return r&&r[0]}var Iw=function(t){if(!t||!t.props)return!1;var r=t.props,n=r.width,a=r.height;return!(!$e(n)||n<=0||!$e(a)||a<=0)},l$=["a","altGlyph","altGlyphDef","altGlyphItem","animate","animateColor","animateMotion","animateTransform","circle","clipPath","color-profile","cursor","defs","desc","ellipse","feBlend","feColormatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence","filter","font","font-face","font-face-format","font-face-name","font-face-url","foreignObject","g","glyph","glyphRef","hkern","image","line","lineGradient","marker","mask","metadata","missing-glyph","mpath","path","pattern","polygon","polyline","radialGradient","rect","script","set","stop","style","svg","switch","symbol","text","textPath","title","tref","tspan","use","view","vkern"],c$=function(t){return t&&t.type&&ul(t.type)&&l$.indexOf(t.type)>=0},u_=function(t){return t&&ev(t)==="object"&&"clipDot"in t},u$=function(t,r,n,a){var i,o=(i=wm==null?void 0:wm[a])!==null&&i!==void 0?i:[];return r.startsWith("data-")||!Rt(t)&&(a&&o.includes(r)||n$.includes(r))||n&&W1.includes(r)},At=function(t,r,n){if(!t||typeof t=="function"||typeof t=="boolean")return null;var a=t;if(C.isValidElement(t)&&(a=t.props),!Xc(a))return null;var i={};return Object.keys(a).forEach(function(o){var s;u$((s=a)===null||s===void 0?void 0:s[o],o,r,n)&&(i[o]=a[o])}),i},tv=function e(t,r){if(t===r)return!0;var n=C.Children.count(t);if(n!==C.Children.count(r))return!1;if(n===0)return!0;if(n===1)return Lw(Array.isArray(t)?t[0]:t,Array.isArray(r)?r[0]:r);for(var a=0;a<n;a++){var i=t[a],o=r[a];if(Array.isArray(i)||Array.isArray(o)){if(!e(i,o))return!1}else if(!Lw(i,o))return!1}return!0},Lw=function(t,r){if(Ot(t)&&Ot(r))return!0;if(!Ot(t)&&!Ot(r)){var n=t.props||{},a=n.children,i=$w(n,i$),o=r.props||{},s=o.children,l=$w(o,o$);return a&&s?nc(i,l)&&tv(a,s):!a&&!s?nc(i,l):!1}return!1},Bw=function(t,r){var n=[],a={};return V1(t).forEach(function(i,o){if(c$(i))n.push(i);else if(i){var s=mo(i.type),l=r[s]||{},u=l.handler,f=l.once;if(u&&(!f||!a[s])){var d=u(i,s,o);n.push(d),a[s]=!0}}}),n},f$=function(t){var r=t&&t.type;return r&&Rw[r]?Rw[r]:null},d$=function(t,r){return V1(r).indexOf(t)},h$=["children","width","height","viewBox","className","style","title","desc"];function rv(){return rv=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},rv.apply(this,arguments)}function p$(e,t){if(e==null)return{};var r=g$(e,t),n,a;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function g$(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function nv(e){var t=e.children,r=e.width,n=e.height,a=e.viewBox,i=e.className,o=e.style,s=e.title,l=e.desc,u=p$(e,h$),f=a||{width:r,height:n,x:0,y:0},d=lr("recharts-surface",i);return J.createElement("svg",rv({},At(u,!0,"svg"),{className:d,width:r,height:n,style:o,viewBox:"".concat(f.x," ").concat(f.y," ").concat(f.width," ").concat(f.height)}),J.createElement("title",null,s),J.createElement("desc",null,l),t)}var m$=["children","className"];function av(){return av=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},av.apply(this,arguments)}function y$(e,t){if(e==null)return{};var r=v$(e,t),n,a;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function v$(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}var kr=J.forwardRef(function(e,t){var r=e.children,n=e.className,a=y$(e,m$),i=lr("recharts-layer",n);return J.createElement("g",av({className:i},At(a,!0),{ref:t}),r)}),yo=function(t,r){for(var n=arguments.length,a=new Array(n>2?n-2:0),i=2;i<n;i++)a[i-2]=arguments[i]};function x$(e,t,r){var n=-1,a=e.length;t<0&&(t=-t>a?0:a+t),r=r>a?a:r,r<0&&(r+=a),a=t>r?0:r-t>>>0,t>>>=0;for(var i=Array(a);++n<a;)i[n]=e[n+t];return i}var b$=x$,w$=b$;function k$(e,t,r){var n=e.length;return r=r===void 0?n:r,!t&&r>=n?e:w$(e,t,r)}var S$=k$,j$="\\ud800-\\udfff",_$="\\u0300-\\u036f",P$="\\ufe20-\\ufe2f",C$="\\u20d0-\\u20ff",N$=_$+P$+C$,M$="\\ufe0e\\ufe0f",O$="\\u200d",A$=RegExp("["+O$+j$+N$+M$+"]");function T$(e){return A$.test(e)}var f_=T$;function E$(e){return e.split("")}var $$=E$,d_="\\ud800-\\udfff",R$="\\u0300-\\u036f",D$="\\ufe20-\\ufe2f",I$="\\u20d0-\\u20ff",L$=R$+D$+I$,B$="\\ufe0e\\ufe0f",F$="["+d_+"]",iv="["+L$+"]",ov="\\ud83c[\\udffb-\\udfff]",U$="(?:"+iv+"|"+ov+")",h_="[^"+d_+"]",p_="(?:\\ud83c[\\udde6-\\uddff]){2}",g_="[\\ud800-\\udbff][\\udc00-\\udfff]",G$="\\u200d",m_=U$+"?",y_="["+B$+"]?",z$="(?:"+G$+"(?:"+[h_,p_,g_].join("|")+")"+y_+m_+")*",W$=y_+m_+z$,V$="(?:"+[h_+iv+"?",iv,p_,g_,F$].join("|")+")",H$=RegExp(ov+"(?="+ov+")|"+V$+W$,"g");function X$(e){return e.match(H$)||[]}var K$=X$,q$=$$,Y$=f_,Z$=K$;function Q$(e){return Y$(e)?Z$(e):q$(e)}var J$=Q$,e7=S$,t7=f_,r7=J$,n7=a_;function a7(e){return function(t){t=n7(t);var r=t7(t)?r7(t):void 0,n=r?r[0]:t.charAt(0),a=r?e7(r,1).join(""):t.slice(1);return n[e]()+a}}var i7=a7,o7=i7,s7=o7("toUpperCase"),l7=s7;const Fp=Fr(l7);function zr(e){return function(){return e}}const v_=Math.cos,rh=Math.sin,$i=Math.sqrt,nh=Math.PI,Up=2*nh,sv=Math.PI,lv=2*sv,Es=1e-6,c7=lv-Es;function x_(e){this._+=e[0];for(let t=1,r=e.length;t<r;++t)this._+=arguments[t]+e[t]}function u7(e){let t=Math.floor(e);if(!(t>=0))throw new Error(`invalid digits: ${e}`);if(t>15)return x_;const r=10**t;return function(n){this._+=n[0];for(let a=1,i=n.length;a<i;++a)this._+=Math.round(arguments[a]*r)/r+n[a]}}class f7{constructor(t){this._x0=this._y0=this._x1=this._y1=null,this._="",this._append=t==null?x_:u7(t)}moveTo(t,r){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+r}`}closePath(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._append`Z`)}lineTo(t,r){this._append`L${this._x1=+t},${this._y1=+r}`}quadraticCurveTo(t,r,n,a){this._append`Q${+t},${+r},${this._x1=+n},${this._y1=+a}`}bezierCurveTo(t,r,n,a,i,o){this._append`C${+t},${+r},${+n},${+a},${this._x1=+i},${this._y1=+o}`}arcTo(t,r,n,a,i){if(t=+t,r=+r,n=+n,a=+a,i=+i,i<0)throw new Error(`negative radius: ${i}`);let o=this._x1,s=this._y1,l=n-t,u=a-r,f=o-t,d=s-r,p=f*f+d*d;if(this._x1===null)this._append`M${this._x1=t},${this._y1=r}`;else if(p>Es)if(!(Math.abs(d*l-u*f)>Es)||!i)this._append`L${this._x1=t},${this._y1=r}`;else{let m=n-o,v=a-s,b=l*l+u*u,k=m*m+v*v,x=Math.sqrt(b),y=Math.sqrt(p),w=i*Math.tan((sv-Math.acos((b+p-k)/(2*x*y)))/2),_=w/y,S=w/x;Math.abs(_-1)>Es&&this._append`L${t+_*f},${r+_*d}`,this._append`A${i},${i},0,0,${+(d*m>f*v)},${this._x1=t+S*l},${this._y1=r+S*u}`}}arc(t,r,n,a,i,o){if(t=+t,r=+r,n=+n,o=!!o,n<0)throw new Error(`negative radius: ${n}`);let s=n*Math.cos(a),l=n*Math.sin(a),u=t+s,f=r+l,d=1^o,p=o?a-i:i-a;this._x1===null?this._append`M${u},${f}`:(Math.abs(this._x1-u)>Es||Math.abs(this._y1-f)>Es)&&this._append`L${u},${f}`,n&&(p<0&&(p=p%lv+lv),p>c7?this._append`A${n},${n},0,1,${d},${t-s},${r-l}A${n},${n},0,1,${d},${this._x1=u},${this._y1=f}`:p>Es&&this._append`A${n},${n},0,${+(p>=sv)},${d},${this._x1=t+n*Math.cos(i)},${this._y1=r+n*Math.sin(i)}`)}rect(t,r,n,a){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+r}h${n=+n}v${+a}h${-n}Z`}toString(){return this._}}function H1(e){let t=3;return e.digits=function(r){if(!arguments.length)return t;if(r==null)t=null;else{const n=Math.floor(r);if(!(n>=0))throw new RangeError(`invalid digits: ${r}`);t=n}return e},()=>new f7(t)}function X1(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function b_(e){this._context=e}b_.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:this._context.lineTo(e,t);break}}};function Gp(e){return new b_(e)}function w_(e){return e[0]}function k_(e){return e[1]}function S_(e,t){var r=zr(!0),n=null,a=Gp,i=null,o=H1(s);e=typeof e=="function"?e:e===void 0?w_:zr(e),t=typeof t=="function"?t:t===void 0?k_:zr(t);function s(l){var u,f=(l=X1(l)).length,d,p=!1,m;for(n==null&&(i=a(m=o())),u=0;u<=f;++u)!(u<f&&r(d=l[u],u,l))===p&&((p=!p)?i.lineStart():i.lineEnd()),p&&i.point(+e(d,u,l),+t(d,u,l));if(m)return i=null,m+""||null}return s.x=function(l){return arguments.length?(e=typeof l=="function"?l:zr(+l),s):e},s.y=function(l){return arguments.length?(t=typeof l=="function"?l:zr(+l),s):t},s.defined=function(l){return arguments.length?(r=typeof l=="function"?l:zr(!!l),s):r},s.curve=function(l){return arguments.length?(a=l,n!=null&&(i=a(n)),s):a},s.context=function(l){return arguments.length?(l==null?n=i=null:i=a(n=l),s):n},s}function Kd(e,t,r){var n=null,a=zr(!0),i=null,o=Gp,s=null,l=H1(u);e=typeof e=="function"?e:e===void 0?w_:zr(+e),t=typeof t=="function"?t:zr(t===void 0?0:+t),r=typeof r=="function"?r:r===void 0?k_:zr(+r);function u(d){var p,m,v,b=(d=X1(d)).length,k,x=!1,y,w=new Array(b),_=new Array(b);for(i==null&&(s=o(y=l())),p=0;p<=b;++p){if(!(p<b&&a(k=d[p],p,d))===x)if(x=!x)m=p,s.areaStart(),s.lineStart();else{for(s.lineEnd(),s.lineStart(),v=p-1;v>=m;--v)s.point(w[v],_[v]);s.lineEnd(),s.areaEnd()}x&&(w[p]=+e(k,p,d),_[p]=+t(k,p,d),s.point(n?+n(k,p,d):w[p],r?+r(k,p,d):_[p]))}if(y)return s=null,y+""||null}function f(){return S_().defined(a).curve(o).context(i)}return u.x=function(d){return arguments.length?(e=typeof d=="function"?d:zr(+d),n=null,u):e},u.x0=function(d){return arguments.length?(e=typeof d=="function"?d:zr(+d),u):e},u.x1=function(d){return arguments.length?(n=d==null?null:typeof d=="function"?d:zr(+d),u):n},u.y=function(d){return arguments.length?(t=typeof d=="function"?d:zr(+d),r=null,u):t},u.y0=function(d){return arguments.length?(t=typeof d=="function"?d:zr(+d),u):t},u.y1=function(d){return arguments.length?(r=d==null?null:typeof d=="function"?d:zr(+d),u):r},u.lineX0=u.lineY0=function(){return f().x(e).y(t)},u.lineY1=function(){return f().x(e).y(r)},u.lineX1=function(){return f().x(n).y(t)},u.defined=function(d){return arguments.length?(a=typeof d=="function"?d:zr(!!d),u):a},u.curve=function(d){return arguments.length?(o=d,i!=null&&(s=o(i)),u):o},u.context=function(d){return arguments.length?(d==null?i=s=null:s=o(i=d),u):i},u}class j_{constructor(t,r){this._context=t,this._x=r}areaStart(){this._line=0}areaEnd(){this._line=NaN}lineStart(){this._point=0}lineEnd(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line}point(t,r){switch(t=+t,r=+r,this._point){case 0:{this._point=1,this._line?this._context.lineTo(t,r):this._context.moveTo(t,r);break}case 1:this._point=2;default:{this._x?this._context.bezierCurveTo(this._x0=(this._x0+t)/2,this._y0,this._x0,r,t,r):this._context.bezierCurveTo(this._x0,this._y0=(this._y0+r)/2,t,this._y0,t,r);break}}this._x0=t,this._y0=r}}function d7(e){return new j_(e,!0)}function h7(e){return new j_(e,!1)}const K1={draw(e,t){const r=$i(t/nh);e.moveTo(r,0),e.arc(0,0,r,0,Up)}},p7={draw(e,t){const r=$i(t/5)/2;e.moveTo(-3*r,-r),e.lineTo(-r,-r),e.lineTo(-r,-3*r),e.lineTo(r,-3*r),e.lineTo(r,-r),e.lineTo(3*r,-r),e.lineTo(3*r,r),e.lineTo(r,r),e.lineTo(r,3*r),e.lineTo(-r,3*r),e.lineTo(-r,r),e.lineTo(-3*r,r),e.closePath()}},__=$i(1/3),g7=__*2,m7={draw(e,t){const r=$i(t/g7),n=r*__;e.moveTo(0,-r),e.lineTo(n,0),e.lineTo(0,r),e.lineTo(-n,0),e.closePath()}},y7={draw(e,t){const r=$i(t),n=-r/2;e.rect(n,n,r,r)}},v7=.8908130915292852,P_=rh(nh/10)/rh(7*nh/10),x7=rh(Up/10)*P_,b7=-v_(Up/10)*P_,w7={draw(e,t){const r=$i(t*v7),n=x7*r,a=b7*r;e.moveTo(0,-r),e.lineTo(n,a);for(let i=1;i<5;++i){const o=Up*i/5,s=v_(o),l=rh(o);e.lineTo(l*r,-s*r),e.lineTo(s*n-l*a,l*n+s*a)}e.closePath()}},Sm=$i(3),k7={draw(e,t){const r=-$i(t/(Sm*3));e.moveTo(0,r*2),e.lineTo(-Sm*r,-r),e.lineTo(Sm*r,-r),e.closePath()}},ei=-.5,ti=$i(3)/2,cv=1/$i(12),S7=(cv/2+1)*3,j7={draw(e,t){const r=$i(t/S7),n=r/2,a=r*cv,i=n,o=r*cv+r,s=-i,l=o;e.moveTo(n,a),e.lineTo(i,o),e.lineTo(s,l),e.lineTo(ei*n-ti*a,ti*n+ei*a),e.lineTo(ei*i-ti*o,ti*i+ei*o),e.lineTo(ei*s-ti*l,ti*s+ei*l),e.lineTo(ei*n+ti*a,ei*a-ti*n),e.lineTo(ei*i+ti*o,ei*o-ti*i),e.lineTo(ei*s+ti*l,ei*l-ti*s),e.closePath()}};function _7(e,t){let r=null,n=H1(a);e=typeof e=="function"?e:zr(e||K1),t=typeof t=="function"?t:zr(t===void 0?64:+t);function a(){let i;if(r||(r=i=n()),e.apply(this,arguments).draw(r,+t.apply(this,arguments)),i)return r=null,i+""||null}return a.type=function(i){return arguments.length?(e=typeof i=="function"?i:zr(i),a):e},a.size=function(i){return arguments.length?(t=typeof i=="function"?i:zr(+i),a):t},a.context=function(i){return arguments.length?(r=i??null,a):r},a}function ah(){}function ih(e,t,r){e._context.bezierCurveTo((2*e._x0+e._x1)/3,(2*e._y0+e._y1)/3,(e._x0+2*e._x1)/3,(e._y0+2*e._y1)/3,(e._x0+4*e._x1+t)/6,(e._y0+4*e._y1+r)/6)}function C_(e){this._context=e}C_.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){switch(this._point){case 3:ih(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:ih(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function P7(e){return new C_(e)}function N_(e){this._context=e}N_.prototype={areaStart:ah,areaEnd:ah,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._y0=this._y1=this._y2=this._y3=this._y4=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x2,this._y2),this._context.closePath();break}case 2:{this._context.moveTo((this._x2+2*this._x3)/3,(this._y2+2*this._y3)/3),this._context.lineTo((this._x3+2*this._x2)/3,(this._y3+2*this._y2)/3),this._context.closePath();break}case 3:{this.point(this._x2,this._y2),this.point(this._x3,this._y3),this.point(this._x4,this._y4);break}}},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._x2=e,this._y2=t;break;case 1:this._point=2,this._x3=e,this._y3=t;break;case 2:this._point=3,this._x4=e,this._y4=t,this._context.moveTo((this._x0+4*this._x1+e)/6,(this._y0+4*this._y1+t)/6);break;default:ih(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function C7(e){return new N_(e)}function M_(e){this._context=e}M_.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3;var r=(this._x0+4*this._x1+e)/6,n=(this._y0+4*this._y1+t)/6;this._line?this._context.lineTo(r,n):this._context.moveTo(r,n);break;case 3:this._point=4;default:ih(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function N7(e){return new M_(e)}function O_(e){this._context=e}O_.prototype={areaStart:ah,areaEnd:ah,lineStart:function(){this._point=0},lineEnd:function(){this._point&&this._context.closePath()},point:function(e,t){e=+e,t=+t,this._point?this._context.lineTo(e,t):(this._point=1,this._context.moveTo(e,t))}};function M7(e){return new O_(e)}function Fw(e){return e<0?-1:1}function Uw(e,t,r){var n=e._x1-e._x0,a=t-e._x1,i=(e._y1-e._y0)/(n||a<0&&-0),o=(r-e._y1)/(a||n<0&&-0),s=(i*a+o*n)/(n+a);return(Fw(i)+Fw(o))*Math.min(Math.abs(i),Math.abs(o),.5*Math.abs(s))||0}function Gw(e,t){var r=e._x1-e._x0;return r?(3*(e._y1-e._y0)/r-t)/2:t}function jm(e,t,r){var n=e._x0,a=e._y0,i=e._x1,o=e._y1,s=(i-n)/3;e._context.bezierCurveTo(n+s,a+s*t,i-s,o-s*r,i,o)}function oh(e){this._context=e}oh.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:jm(this,this._t0,Gw(this,this._t0));break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){var r=NaN;if(e=+e,t=+t,!(e===this._x1&&t===this._y1)){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,jm(this,Gw(this,r=Uw(this,e,t)),r);break;default:jm(this,this._t0,r=Uw(this,e,t));break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t,this._t0=r}}};function A_(e){this._context=new T_(e)}(A_.prototype=Object.create(oh.prototype)).point=function(e,t){oh.prototype.point.call(this,t,e)};function T_(e){this._context=e}T_.prototype={moveTo:function(e,t){this._context.moveTo(t,e)},closePath:function(){this._context.closePath()},lineTo:function(e,t){this._context.lineTo(t,e)},bezierCurveTo:function(e,t,r,n,a,i){this._context.bezierCurveTo(t,e,n,r,i,a)}};function O7(e){return new oh(e)}function A7(e){return new A_(e)}function E_(e){this._context=e}E_.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=[],this._y=[]},lineEnd:function(){var e=this._x,t=this._y,r=e.length;if(r)if(this._line?this._context.lineTo(e[0],t[0]):this._context.moveTo(e[0],t[0]),r===2)this._context.lineTo(e[1],t[1]);else for(var n=zw(e),a=zw(t),i=0,o=1;o<r;++i,++o)this._context.bezierCurveTo(n[0][i],a[0][i],n[1][i],a[1][i],e[o],t[o]);(this._line||this._line!==0&&r===1)&&this._context.closePath(),this._line=1-this._line,this._x=this._y=null},point:function(e,t){this._x.push(+e),this._y.push(+t)}};function zw(e){var t,r=e.length-1,n,a=new Array(r),i=new Array(r),o=new Array(r);for(a[0]=0,i[0]=2,o[0]=e[0]+2*e[1],t=1;t<r-1;++t)a[t]=1,i[t]=4,o[t]=4*e[t]+2*e[t+1];for(a[r-1]=2,i[r-1]=7,o[r-1]=8*e[r-1]+e[r],t=1;t<r;++t)n=a[t]/i[t-1],i[t]-=n,o[t]-=n*o[t-1];for(a[r-1]=o[r-1]/i[r-1],t=r-2;t>=0;--t)a[t]=(o[t]-a[t+1])/i[t];for(i[r-1]=(e[r]+a[r-1])/2,t=0;t<r-1;++t)i[t]=2*e[t+1]-a[t+1];return[a,i]}function T7(e){return new E_(e)}function zp(e,t){this._context=e,this._t=t}zp.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=this._y=NaN,this._point=0},lineEnd:function(){0<this._t&&this._t<1&&this._point===2&&this._context.lineTo(this._x,this._y),(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line>=0&&(this._t=1-this._t,this._line=1-this._line)},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:{if(this._t<=0)this._context.lineTo(this._x,t),this._context.lineTo(e,t);else{var r=this._x*(1-this._t)+e*this._t;this._context.lineTo(r,this._y),this._context.lineTo(r,t)}break}}this._x=e,this._y=t}};function E7(e){return new zp(e,.5)}function $7(e){return new zp(e,0)}function R7(e){return new zp(e,1)}function gc(e,t){if((o=e.length)>1)for(var r=1,n,a,i=e[t[0]],o,s=i.length;r<o;++r)for(a=i,i=e[t[r]],n=0;n<s;++n)i[n][1]+=i[n][0]=isNaN(a[n][1])?a[n][0]:a[n][1]}function uv(e){for(var t=e.length,r=new Array(t);--t>=0;)r[t]=t;return r}function D7(e,t){return e[t]}function I7(e){const t=[];return t.key=e,t}function L7(){var e=zr([]),t=uv,r=gc,n=D7;function a(i){var o=Array.from(e.apply(this,arguments),I7),s,l=o.length,u=-1,f;for(const d of i)for(s=0,++u;s<l;++s)(o[s][u]=[0,+n(d,o[s].key,u,i)]).data=d;for(s=0,f=X1(t(o));s<l;++s)o[f[s]].index=s;return r(o,f),o}return a.keys=function(i){return arguments.length?(e=typeof i=="function"?i:zr(Array.from(i)),a):e},a.value=function(i){return arguments.length?(n=typeof i=="function"?i:zr(+i),a):n},a.order=function(i){return arguments.length?(t=i==null?uv:typeof i=="function"?i:zr(Array.from(i)),a):t},a.offset=function(i){return arguments.length?(r=i??gc,a):r},a}function B7(e,t){if((n=e.length)>0){for(var r,n,a=0,i=e[0].length,o;a<i;++a){for(o=r=0;r<n;++r)o+=e[r][a][1]||0;if(o)for(r=0;r<n;++r)e[r][a][1]/=o}gc(e,t)}}function F7(e,t){if((a=e.length)>0){for(var r=0,n=e[t[0]],a,i=n.length;r<i;++r){for(var o=0,s=0;o<a;++o)s+=e[o][r][1]||0;n[r][1]+=n[r][0]=-s/2}gc(e,t)}}function U7(e,t){if(!(!((o=e.length)>0)||!((i=(a=e[t[0]]).length)>0))){for(var r=0,n=1,a,i,o;n<i;++n){for(var s=0,l=0,u=0;s<o;++s){for(var f=e[t[s]],d=f[n][1]||0,p=f[n-1][1]||0,m=(d-p)/2,v=0;v<s;++v){var b=e[t[v]],k=b[n][1]||0,x=b[n-1][1]||0;m+=k-x}l+=d,u+=m*d}a[n-1][1]+=a[n-1][0]=r,l&&(r-=u/l)}a[n-1][1]+=a[n-1][0]=r,gc(e,t)}}function xf(e){"@babel/helpers - typeof";return xf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},xf(e)}var G7=["type","size","sizeType"];function fv(){return fv=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},fv.apply(this,arguments)}function Ww(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Vw(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Ww(Object(r),!0).forEach(function(n){z7(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Ww(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function z7(e,t,r){return t=W7(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function W7(e){var t=V7(e,"string");return xf(t)=="symbol"?t:t+""}function V7(e,t){if(xf(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(xf(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function H7(e,t){if(e==null)return{};var r=X7(e,t),n,a;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function X7(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}var $_={symbolCircle:K1,symbolCross:p7,symbolDiamond:m7,symbolSquare:y7,symbolStar:w7,symbolTriangle:k7,symbolWye:j7},K7=Math.PI/180,q7=function(t){var r="symbol".concat(Fp(t));return $_[r]||K1},Y7=function(t,r,n){if(r==="area")return t;switch(n){case"cross":return 5*t*t/9;case"diamond":return .5*t*t/Math.sqrt(3);case"square":return t*t;case"star":{var a=18*K7;return 1.25*t*t*(Math.tan(a)-Math.tan(a*2)*Math.pow(Math.tan(a),2))}case"triangle":return Math.sqrt(3)*t*t/4;case"wye":return(21-10*Math.sqrt(3))*t*t/8;default:return Math.PI*t*t/4}},Z7=function(t,r){$_["symbol".concat(Fp(t))]=r},Wp=function(t){var r=t.type,n=r===void 0?"circle":r,a=t.size,i=a===void 0?64:a,o=t.sizeType,s=o===void 0?"area":o,l=H7(t,G7),u=Vw(Vw({},l),{},{type:n,size:i,sizeType:s}),f=function(){var k=q7(n),x=_7().type(k).size(Y7(i,s,n));return x()},d=u.className,p=u.cx,m=u.cy,v=At(u,!0);return p===+p&&m===+m&&i===+i?J.createElement("path",fv({},v,{className:lr("recharts-symbols",d),transform:"translate(".concat(p,", ").concat(m,")"),d:f()})):null};Wp.registerSymbol=Z7;function mc(e){"@babel/helpers - typeof";return mc=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},mc(e)}function dv(){return dv=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},dv.apply(this,arguments)}function Hw(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Q7(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Hw(Object(r),!0).forEach(function(n){bf(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Hw(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function J7(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function e9(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,D_(n.key),n)}}function t9(e,t,r){return t&&e9(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function r9(e,t,r){return t=sh(t),n9(e,R_()?Reflect.construct(t,r||[],sh(e).constructor):t.apply(e,r))}function n9(e,t){if(t&&(mc(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return a9(e)}function a9(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function R_(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(R_=function(){return!!e})()}function sh(e){return sh=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},sh(e)}function i9(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&hv(e,t)}function hv(e,t){return hv=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},hv(e,t)}function bf(e,t,r){return t=D_(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function D_(e){var t=o9(e,"string");return mc(t)=="symbol"?t:t+""}function o9(e,t){if(mc(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(mc(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var ri=32,q1=function(e){function t(){return J7(this,t),r9(this,t,arguments)}return i9(t,e),t9(t,[{key:"renderIcon",value:function(n){var a=this.props.inactiveColor,i=ri/2,o=ri/6,s=ri/3,l=n.inactive?a:n.color;if(n.type==="plainline")return J.createElement("line",{strokeWidth:4,fill:"none",stroke:l,strokeDasharray:n.payload.strokeDasharray,x1:0,y1:i,x2:ri,y2:i,className:"recharts-legend-icon"});if(n.type==="line")return J.createElement("path",{strokeWidth:4,fill:"none",stroke:l,d:"M0,".concat(i,"h").concat(s,`
            A`).concat(o,",").concat(o,",0,1,1,").concat(2*s,",").concat(i,`
            H`).concat(ri,"M").concat(2*s,",").concat(i,`
            A`).concat(o,",").concat(o,",0,1,1,").concat(s,",").concat(i),className:"recharts-legend-icon"});if(n.type==="rect")return J.createElement("path",{stroke:"none",fill:l,d:"M0,".concat(ri/8,"h").concat(ri,"v").concat(ri*3/4,"h").concat(-ri,"z"),className:"recharts-legend-icon"});if(J.isValidElement(n.legendIcon)){var u=Q7({},n);return delete u.legendIcon,J.cloneElement(n.legendIcon,u)}return J.createElement(Wp,{fill:l,cx:i,cy:i,size:ri,sizeType:"diameter",type:n.type})}},{key:"renderItems",value:function(){var n=this,a=this.props,i=a.payload,o=a.iconSize,s=a.layout,l=a.formatter,u=a.inactiveColor,f={x:0,y:0,width:ri,height:ri},d={display:s==="horizontal"?"inline-block":"block",marginRight:10},p={display:"inline-block",verticalAlign:"middle",marginRight:4};return i.map(function(m,v){var b=m.formatter||l,k=lr(bf(bf({"recharts-legend-item":!0},"legend-item-".concat(v),!0),"inactive",m.inactive));if(m.type==="none")return null;var x=Rt(m.value)?null:m.value;yo(!Rt(m.value),`The name property is also required when using a function for the dataKey of a chart's cartesian components. Ex: <Bar name="Name of my Data"/>`);var y=m.inactive?u:m.color;return J.createElement("li",dv({className:k,style:d,key:"legend-item-".concat(v)},vf(n.props,m,v)),J.createElement(nv,{width:o,height:o,viewBox:f,style:p},n.renderIcon(m)),J.createElement("span",{className:"recharts-legend-item-text",style:{color:y}},b?b(x,m,v):x))})}},{key:"render",value:function(){var n=this.props,a=n.payload,i=n.layout,o=n.align;if(!a||!a.length)return null;var s={padding:0,margin:0,textAlign:i==="horizontal"?o:"left"};return J.createElement("ul",{className:"recharts-default-legend",style:s},this.renderItems())}}])}(C.PureComponent);bf(q1,"displayName","Legend");bf(q1,"defaultProps",{iconSize:14,layout:"horizontal",align:"center",verticalAlign:"middle",inactiveColor:"#ccc"});var s9=Cp;function l9(){this.__data__=new s9,this.size=0}var c9=l9;function u9(e){var t=this.__data__,r=t.delete(e);return this.size=t.size,r}var f9=u9;function d9(e){return this.__data__.get(e)}var h9=d9;function p9(e){return this.__data__.has(e)}var g9=p9,m9=Cp,y9=I1,v9=L1,x9=200;function b9(e,t){var r=this.__data__;if(r instanceof m9){var n=r.__data__;if(!y9||n.length<x9-1)return n.push([e,t]),this.size=++r.size,this;r=this.__data__=new v9(n)}return r.set(e,t),this.size=r.size,this}var w9=b9,k9=Cp,S9=c9,j9=f9,_9=h9,P9=g9,C9=w9;function Qc(e){var t=this.__data__=new k9(e);this.size=t.size}Qc.prototype.clear=S9;Qc.prototype.delete=j9;Qc.prototype.get=_9;Qc.prototype.has=P9;Qc.prototype.set=C9;var I_=Qc,N9="__lodash_hash_undefined__";function M9(e){return this.__data__.set(e,N9),this}var O9=M9;function A9(e){return this.__data__.has(e)}var T9=A9,E9=L1,$9=O9,R9=T9;function lh(e){var t=-1,r=e==null?0:e.length;for(this.__data__=new E9;++t<r;)this.add(e[t])}lh.prototype.add=lh.prototype.push=$9;lh.prototype.has=R9;var L_=lh;function D9(e,t){for(var r=-1,n=e==null?0:e.length;++r<n;)if(t(e[r],r,e))return!0;return!1}var B_=D9;function I9(e,t){return e.has(t)}var F_=I9,L9=L_,B9=B_,F9=F_,U9=1,G9=2;function z9(e,t,r,n,a,i){var o=r&U9,s=e.length,l=t.length;if(s!=l&&!(o&&l>s))return!1;var u=i.get(e),f=i.get(t);if(u&&f)return u==t&&f==e;var d=-1,p=!0,m=r&G9?new L9:void 0;for(i.set(e,t),i.set(t,e);++d<s;){var v=e[d],b=t[d];if(n)var k=o?n(b,v,d,t,e,i):n(v,b,d,e,t,i);if(k!==void 0){if(k)continue;p=!1;break}if(m){if(!B9(t,function(x,y){if(!F9(m,y)&&(v===x||a(v,x,r,n,i)))return m.push(y)})){p=!1;break}}else if(!(v===b||a(v,b,r,n,i))){p=!1;break}}return i.delete(e),i.delete(t),p}var U_=z9,W9=to,V9=W9.Uint8Array,H9=V9;function X9(e){var t=-1,r=Array(e.size);return e.forEach(function(n,a){r[++t]=[a,n]}),r}var K9=X9;function q9(e){var t=-1,r=Array(e.size);return e.forEach(function(n){r[++t]=n}),r}var Y1=q9,Xw=id,Kw=H9,Y9=D1,Z9=U_,Q9=K9,J9=Y1,eR=1,tR=2,rR="[object Boolean]",nR="[object Date]",aR="[object Error]",iR="[object Map]",oR="[object Number]",sR="[object RegExp]",lR="[object Set]",cR="[object String]",uR="[object Symbol]",fR="[object ArrayBuffer]",dR="[object DataView]",qw=Xw?Xw.prototype:void 0,_m=qw?qw.valueOf:void 0;function hR(e,t,r,n,a,i,o){switch(r){case dR:if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case fR:return!(e.byteLength!=t.byteLength||!i(new Kw(e),new Kw(t)));case rR:case nR:case oR:return Y9(+e,+t);case aR:return e.name==t.name&&e.message==t.message;case sR:case cR:return e==t+"";case iR:var s=Q9;case lR:var l=n&eR;if(s||(s=J9),e.size!=t.size&&!l)return!1;var u=o.get(e);if(u)return u==t;n|=tR,o.set(e,t);var f=Z9(s(e),s(t),n,a,i,o);return o.delete(e),f;case uR:if(_m)return _m.call(e)==_m.call(t)}return!1}var pR=hR;function gR(e,t){for(var r=-1,n=t.length,a=e.length;++r<n;)e[a+r]=t[r];return e}var G_=gR,mR=G_,yR=Da;function vR(e,t,r){var n=t(e);return yR(e)?n:mR(n,r(e))}var xR=vR;function bR(e,t){for(var r=-1,n=e==null?0:e.length,a=0,i=[];++r<n;){var o=e[r];t(o,r,e)&&(i[a++]=o)}return i}var wR=bR;function kR(){return[]}var SR=kR,jR=wR,_R=SR,PR=Object.prototype,CR=PR.propertyIsEnumerable,Yw=Object.getOwnPropertySymbols,NR=Yw?function(e){return e==null?[]:(e=Object(e),jR(Yw(e),function(t){return CR.call(e,t)}))}:_R,MR=NR;function OR(e,t){for(var r=-1,n=Array(e);++r<e;)n[r]=t(r);return n}var AR=OR,TR=Co,ER=No,$R="[object Arguments]";function RR(e){return ER(e)&&TR(e)==$R}var DR=RR,Zw=DR,IR=No,z_=Object.prototype,LR=z_.hasOwnProperty,BR=z_.propertyIsEnumerable,FR=Zw(function(){return arguments}())?Zw:function(e){return IR(e)&&LR.call(e,"callee")&&!BR.call(e,"callee")},Z1=FR,ch={exports:{}};function UR(){return!1}var GR=UR;ch.exports;(function(e,t){var r=to,n=GR,a=t&&!t.nodeType&&t,i=a&&!0&&e&&!e.nodeType&&e,o=i&&i.exports===a,s=o?r.Buffer:void 0,l=s?s.isBuffer:void 0,u=l||n;e.exports=u})(ch,ch.exports);var W_=ch.exports,zR=9007199254740991,WR=/^(?:0|[1-9]\d*)$/;function VR(e,t){var r=typeof e;return t=t??zR,!!t&&(r=="number"||r!="symbol"&&WR.test(e))&&e>-1&&e%1==0&&e<t}var Q1=VR,HR=9007199254740991;function XR(e){return typeof e=="number"&&e>-1&&e%1==0&&e<=HR}var J1=XR,KR=Co,qR=J1,YR=No,ZR="[object Arguments]",QR="[object Array]",JR="[object Boolean]",eD="[object Date]",tD="[object Error]",rD="[object Function]",nD="[object Map]",aD="[object Number]",iD="[object Object]",oD="[object RegExp]",sD="[object Set]",lD="[object String]",cD="[object WeakMap]",uD="[object ArrayBuffer]",fD="[object DataView]",dD="[object Float32Array]",hD="[object Float64Array]",pD="[object Int8Array]",gD="[object Int16Array]",mD="[object Int32Array]",yD="[object Uint8Array]",vD="[object Uint8ClampedArray]",xD="[object Uint16Array]",bD="[object Uint32Array]",Qr={};Qr[dD]=Qr[hD]=Qr[pD]=Qr[gD]=Qr[mD]=Qr[yD]=Qr[vD]=Qr[xD]=Qr[bD]=!0;Qr[ZR]=Qr[QR]=Qr[uD]=Qr[JR]=Qr[fD]=Qr[eD]=Qr[tD]=Qr[rD]=Qr[nD]=Qr[aD]=Qr[iD]=Qr[oD]=Qr[sD]=Qr[lD]=Qr[cD]=!1;function wD(e){return YR(e)&&qR(e.length)&&!!Qr[KR(e)]}var kD=wD;function SD(e){return function(t){return e(t)}}var V_=SD,uh={exports:{}};uh.exports;(function(e,t){var r=Qj,n=t&&!t.nodeType&&t,a=n&&!0&&e&&!e.nodeType&&e,i=a&&a.exports===n,o=i&&r.process,s=function(){try{var l=a&&a.require&&a.require("util").types;return l||o&&o.binding&&o.binding("util")}catch{}}();e.exports=s})(uh,uh.exports);var jD=uh.exports,_D=kD,PD=V_,Qw=jD,Jw=Qw&&Qw.isTypedArray,CD=Jw?PD(Jw):_D,H_=CD,ND=AR,MD=Z1,OD=Da,AD=W_,TD=Q1,ED=H_,$D=Object.prototype,RD=$D.hasOwnProperty;function DD(e,t){var r=OD(e),n=!r&&MD(e),a=!r&&!n&&AD(e),i=!r&&!n&&!a&&ED(e),o=r||n||a||i,s=o?ND(e.length,String):[],l=s.length;for(var u in e)(t||RD.call(e,u))&&!(o&&(u=="length"||a&&(u=="offset"||u=="parent")||i&&(u=="buffer"||u=="byteLength"||u=="byteOffset")||TD(u,l)))&&s.push(u);return s}var ID=DD,LD=Object.prototype;function BD(e){var t=e&&e.constructor,r=typeof t=="function"&&t.prototype||LD;return e===r}var FD=BD;function UD(e,t){return function(r){return e(t(r))}}var X_=UD,GD=X_,zD=GD(Object.keys,Object),WD=zD,VD=FD,HD=WD,XD=Object.prototype,KD=XD.hasOwnProperty;function qD(e){if(!VD(e))return HD(e);var t=[];for(var r in Object(e))KD.call(e,r)&&r!="constructor"&&t.push(r);return t}var YD=qD,ZD=R1,QD=J1;function JD(e){return e!=null&&QD(e.length)&&!ZD(e)}var od=JD,eI=ID,tI=YD,rI=od;function nI(e){return rI(e)?eI(e):tI(e)}var Vp=nI,aI=xR,iI=MR,oI=Vp;function sI(e){return aI(e,oI,iI)}var lI=sI,ek=lI,cI=1,uI=Object.prototype,fI=uI.hasOwnProperty;function dI(e,t,r,n,a,i){var o=r&cI,s=ek(e),l=s.length,u=ek(t),f=u.length;if(l!=f&&!o)return!1;for(var d=l;d--;){var p=s[d];if(!(o?p in t:fI.call(t,p)))return!1}var m=i.get(e),v=i.get(t);if(m&&v)return m==t&&v==e;var b=!0;i.set(e,t),i.set(t,e);for(var k=o;++d<l;){p=s[d];var x=e[p],y=t[p];if(n)var w=o?n(y,x,p,t,e,i):n(x,y,p,e,t,i);if(!(w===void 0?x===y||a(x,y,r,n,i):w)){b=!1;break}k||(k=p=="constructor")}if(b&&!k){var _=e.constructor,S=t.constructor;_!=S&&"constructor"in e&&"constructor"in t&&!(typeof _=="function"&&_ instanceof _&&typeof S=="function"&&S instanceof S)&&(b=!1)}return i.delete(e),i.delete(t),b}var hI=dI,pI=xl,gI=to,mI=pI(gI,"DataView"),yI=mI,vI=xl,xI=to,bI=vI(xI,"Promise"),wI=bI,kI=xl,SI=to,jI=kI(SI,"Set"),K_=jI,_I=xl,PI=to,CI=_I(PI,"WeakMap"),NI=CI,pv=yI,gv=I1,mv=wI,yv=K_,vv=NI,q_=Co,Jc=e_,tk="[object Map]",MI="[object Object]",rk="[object Promise]",nk="[object Set]",ak="[object WeakMap]",ik="[object DataView]",OI=Jc(pv),AI=Jc(gv),TI=Jc(mv),EI=Jc(yv),$I=Jc(vv),$s=q_;(pv&&$s(new pv(new ArrayBuffer(1)))!=ik||gv&&$s(new gv)!=tk||mv&&$s(mv.resolve())!=rk||yv&&$s(new yv)!=nk||vv&&$s(new vv)!=ak)&&($s=function(e){var t=q_(e),r=t==MI?e.constructor:void 0,n=r?Jc(r):"";if(n)switch(n){case OI:return ik;case AI:return tk;case TI:return rk;case EI:return nk;case $I:return ak}return t});var RI=$s,Pm=I_,DI=U_,II=pR,LI=hI,ok=RI,sk=Da,lk=W_,BI=H_,FI=1,ck="[object Arguments]",uk="[object Array]",qd="[object Object]",UI=Object.prototype,fk=UI.hasOwnProperty;function GI(e,t,r,n,a,i){var o=sk(e),s=sk(t),l=o?uk:ok(e),u=s?uk:ok(t);l=l==ck?qd:l,u=u==ck?qd:u;var f=l==qd,d=u==qd,p=l==u;if(p&&lk(e)){if(!lk(t))return!1;o=!0,f=!1}if(p&&!f)return i||(i=new Pm),o||BI(e)?DI(e,t,r,n,a,i):II(e,t,l,r,n,a,i);if(!(r&FI)){var m=f&&fk.call(e,"__wrapped__"),v=d&&fk.call(t,"__wrapped__");if(m||v){var b=m?e.value():e,k=v?t.value():t;return i||(i=new Pm),a(b,k,r,n,i)}}return p?(i||(i=new Pm),LI(e,t,r,n,a,i)):!1}var zI=GI,WI=zI,dk=No;function Y_(e,t,r,n,a){return e===t?!0:e==null||t==null||!dk(e)&&!dk(t)?e!==e&&t!==t:WI(e,t,r,n,Y_,a)}var eb=Y_,VI=I_,HI=eb,XI=1,KI=2;function qI(e,t,r,n){var a=r.length,i=a,o=!n;if(e==null)return!i;for(e=Object(e);a--;){var s=r[a];if(o&&s[2]?s[1]!==e[s[0]]:!(s[0]in e))return!1}for(;++a<i;){s=r[a];var l=s[0],u=e[l],f=s[1];if(o&&s[2]){if(u===void 0&&!(l in e))return!1}else{var d=new VI;if(n)var p=n(u,f,l,e,t,d);if(!(p===void 0?HI(f,u,XI|KI,n,d):p))return!1}}return!0}var YI=qI,ZI=ms;function QI(e){return e===e&&!ZI(e)}var Z_=QI,JI=Z_,eL=Vp;function tL(e){for(var t=eL(e),r=t.length;r--;){var n=t[r],a=e[n];t[r]=[n,a,JI(a)]}return t}var rL=tL;function nL(e,t){return function(r){return r==null?!1:r[e]===t&&(t!==void 0||e in Object(r))}}var Q_=nL,aL=YI,iL=rL,oL=Q_;function sL(e){var t=iL(e);return t.length==1&&t[0][2]?oL(t[0][0],t[0][1]):function(r){return r===e||aL(r,e,t)}}var lL=sL;function cL(e,t){return e!=null&&t in Object(e)}var uL=cL,fL=i_,dL=Z1,hL=Da,pL=Q1,gL=J1,mL=Mp;function yL(e,t,r){t=fL(t,e);for(var n=-1,a=t.length,i=!1;++n<a;){var o=mL(t[n]);if(!(i=e!=null&&r(e,o)))break;e=e[o]}return i||++n!=a?i:(a=e==null?0:e.length,!!a&&gL(a)&&pL(o,a)&&(hL(e)||dL(e)))}var vL=yL,xL=uL,bL=vL;function wL(e,t){return e!=null&&bL(e,t,xL)}var kL=wL,SL=eb,jL=o_,_L=kL,PL=$1,CL=Z_,NL=Q_,ML=Mp,OL=1,AL=2;function TL(e,t){return PL(e)&&CL(t)?NL(ML(e),t):function(r){var n=jL(r,e);return n===void 0&&n===t?_L(r,e):SL(t,n,OL|AL)}}var EL=TL;function $L(e){return e}var eu=$L;function RL(e){return function(t){return t==null?void 0:t[e]}}var DL=RL,IL=U1;function LL(e){return function(t){return IL(t,e)}}var BL=LL,FL=DL,UL=BL,GL=$1,zL=Mp;function WL(e){return GL(e)?FL(zL(e)):UL(e)}var VL=WL,HL=lL,XL=EL,KL=eu,qL=Da,YL=VL;function ZL(e){return typeof e=="function"?e:e==null?KL:typeof e=="object"?qL(e)?XL(e[0],e[1]):HL(e):YL(e)}var ys=ZL;function QL(e,t,r,n){for(var a=e.length,i=r+(n?1:-1);n?i--:++i<a;)if(t(e[i],i,e))return i;return-1}var J_=QL;function JL(e){return e!==e}var eB=JL;function tB(e,t,r){for(var n=r-1,a=e.length;++n<a;)if(e[n]===t)return n;return-1}var rB=tB,nB=J_,aB=eB,iB=rB;function oB(e,t,r){return t===t?iB(e,t,r):nB(e,aB,r)}var sB=oB,lB=sB;function cB(e,t){var r=e==null?0:e.length;return!!r&&lB(e,t,0)>-1}var uB=cB;function fB(e,t,r){for(var n=-1,a=e==null?0:e.length;++n<a;)if(r(t,e[n]))return!0;return!1}var dB=fB;function hB(){}var pB=hB,Cm=K_,gB=pB,mB=Y1,yB=1/0,vB=Cm&&1/mB(new Cm([,-0]))[1]==yB?function(e){return new Cm(e)}:gB,xB=vB,bB=L_,wB=uB,kB=dB,SB=F_,jB=xB,_B=Y1,PB=200;function CB(e,t,r){var n=-1,a=wB,i=e.length,o=!0,s=[],l=s;if(r)o=!1,a=kB;else if(i>=PB){var u=t?null:jB(e);if(u)return _B(u);o=!1,a=SB,l=new bB}else l=t?[]:s;e:for(;++n<i;){var f=e[n],d=t?t(f):f;if(f=r||f!==0?f:0,o&&d===d){for(var p=l.length;p--;)if(l[p]===d)continue e;t&&l.push(d),s.push(f)}else a(l,d,r)||(l!==s&&l.push(d),s.push(f))}return s}var NB=CB,MB=ys,OB=NB;function AB(e,t){return e&&e.length?OB(e,MB(t)):[]}var TB=AB;const hk=Fr(TB);function eP(e,t,r){return t===!0?hk(e,r):Rt(t)?hk(e,t):e}function yc(e){"@babel/helpers - typeof";return yc=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},yc(e)}var EB=["ref"];function pk(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function io(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?pk(Object(r),!0).forEach(function(n){Hp(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):pk(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function $B(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function gk(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,rP(n.key),n)}}function RB(e,t,r){return t&&gk(e.prototype,t),r&&gk(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function DB(e,t,r){return t=fh(t),IB(e,tP()?Reflect.construct(t,r||[],fh(e).constructor):t.apply(e,r))}function IB(e,t){if(t&&(yc(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return LB(e)}function LB(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function tP(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(tP=function(){return!!e})()}function fh(e){return fh=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},fh(e)}function BB(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&xv(e,t)}function xv(e,t){return xv=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},xv(e,t)}function Hp(e,t,r){return t=rP(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function rP(e){var t=FB(e,"string");return yc(t)=="symbol"?t:t+""}function FB(e,t){if(yc(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(yc(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}function UB(e,t){if(e==null)return{};var r=GB(e,t),n,a;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function GB(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function zB(e){return e.value}function WB(e,t){if(J.isValidElement(e))return J.cloneElement(e,t);if(typeof e=="function")return J.createElement(e,t);t.ref;var r=UB(t,EB);return J.createElement(q1,r)}var mk=1,Xi=function(e){function t(){var r;$B(this,t);for(var n=arguments.length,a=new Array(n),i=0;i<n;i++)a[i]=arguments[i];return r=DB(this,t,[].concat(a)),Hp(r,"lastBoundingBox",{width:-1,height:-1}),r}return BB(t,e),RB(t,[{key:"componentDidMount",value:function(){this.updateBBox()}},{key:"componentDidUpdate",value:function(){this.updateBBox()}},{key:"getBBox",value:function(){if(this.wrapperNode&&this.wrapperNode.getBoundingClientRect){var n=this.wrapperNode.getBoundingClientRect();return n.height=this.wrapperNode.offsetHeight,n.width=this.wrapperNode.offsetWidth,n}return null}},{key:"updateBBox",value:function(){var n=this.props.onBBoxUpdate,a=this.getBBox();a?(Math.abs(a.width-this.lastBoundingBox.width)>mk||Math.abs(a.height-this.lastBoundingBox.height)>mk)&&(this.lastBoundingBox.width=a.width,this.lastBoundingBox.height=a.height,n&&n(a)):(this.lastBoundingBox.width!==-1||this.lastBoundingBox.height!==-1)&&(this.lastBoundingBox.width=-1,this.lastBoundingBox.height=-1,n&&n(null))}},{key:"getBBoxSnapshot",value:function(){return this.lastBoundingBox.width>=0&&this.lastBoundingBox.height>=0?io({},this.lastBoundingBox):{width:0,height:0}}},{key:"getDefaultPosition",value:function(n){var a=this.props,i=a.layout,o=a.align,s=a.verticalAlign,l=a.margin,u=a.chartWidth,f=a.chartHeight,d,p;if(!n||(n.left===void 0||n.left===null)&&(n.right===void 0||n.right===null))if(o==="center"&&i==="vertical"){var m=this.getBBoxSnapshot();d={left:((u||0)-m.width)/2}}else d=o==="right"?{right:l&&l.right||0}:{left:l&&l.left||0};if(!n||(n.top===void 0||n.top===null)&&(n.bottom===void 0||n.bottom===null))if(s==="middle"){var v=this.getBBoxSnapshot();p={top:((f||0)-v.height)/2}}else p=s==="bottom"?{bottom:l&&l.bottom||0}:{top:l&&l.top||0};return io(io({},d),p)}},{key:"render",value:function(){var n=this,a=this.props,i=a.content,o=a.width,s=a.height,l=a.wrapperStyle,u=a.payloadUniqBy,f=a.payload,d=io(io({position:"absolute",width:o||"auto",height:s||"auto"},this.getDefaultPosition(l)),l);return J.createElement("div",{className:"recharts-legend-wrapper",style:d,ref:function(m){n.wrapperNode=m}},WB(i,io(io({},this.props),{},{payload:eP(f,u,zB)})))}}],[{key:"getWithHeight",value:function(n,a){var i=io(io({},this.defaultProps),n.props),o=i.layout;return o==="vertical"&&$e(n.props.height)?{height:n.props.height}:o==="horizontal"?{width:n.props.width||a}:null}}])}(C.PureComponent);Hp(Xi,"displayName","Legend");Hp(Xi,"defaultProps",{iconSize:14,layout:"horizontal",align:"center",verticalAlign:"bottom"});var yk=id,VB=Z1,HB=Da,vk=yk?yk.isConcatSpreadable:void 0;function XB(e){return HB(e)||VB(e)||!!(vk&&e&&e[vk])}var KB=XB,qB=G_,YB=KB;function nP(e,t,r,n,a){var i=-1,o=e.length;for(r||(r=YB),a||(a=[]);++i<o;){var s=e[i];t>0&&r(s)?t>1?nP(s,t-1,r,n,a):qB(a,s):n||(a[a.length]=s)}return a}var aP=nP;function ZB(e){return function(t,r,n){for(var a=-1,i=Object(t),o=n(t),s=o.length;s--;){var l=o[e?s:++a];if(r(i[l],l,i)===!1)break}return t}}var QB=ZB,JB=QB,eF=JB(),tF=eF,rF=tF,nF=Vp;function aF(e,t){return e&&rF(e,t,nF)}var iP=aF,iF=od;function oF(e,t){return function(r,n){if(r==null)return r;if(!iF(r))return e(r,n);for(var a=r.length,i=t?a:-1,o=Object(r);(t?i--:++i<a)&&n(o[i],i,o)!==!1;);return r}}var sF=oF,lF=iP,cF=sF,uF=cF(lF),tb=uF,fF=tb,dF=od;function hF(e,t){var r=-1,n=dF(e)?Array(e.length):[];return fF(e,function(a,i,o){n[++r]=t(a,i,o)}),n}var oP=hF;function pF(e,t){var r=e.length;for(e.sort(t);r--;)e[r]=e[r].value;return e}var gF=pF,xk=Hc;function mF(e,t){if(e!==t){var r=e!==void 0,n=e===null,a=e===e,i=xk(e),o=t!==void 0,s=t===null,l=t===t,u=xk(t);if(!s&&!u&&!i&&e>t||i&&o&&l&&!s&&!u||n&&o&&l||!r&&l||!a)return 1;if(!n&&!i&&!u&&e<t||u&&r&&a&&!n&&!i||s&&r&&a||!o&&a||!l)return-1}return 0}var yF=mF,vF=yF;function xF(e,t,r){for(var n=-1,a=e.criteria,i=t.criteria,o=a.length,s=r.length;++n<o;){var l=vF(a[n],i[n]);if(l){if(n>=s)return l;var u=r[n];return l*(u=="desc"?-1:1)}}return e.index-t.index}var bF=xF,Nm=F1,wF=U1,kF=ys,SF=oP,jF=gF,_F=V_,PF=bF,CF=eu,NF=Da;function MF(e,t,r){t.length?t=Nm(t,function(i){return NF(i)?function(o){return wF(o,i.length===1?i[0]:i)}:i}):t=[CF];var n=-1;t=Nm(t,_F(kF));var a=SF(e,function(i,o,s){var l=Nm(t,function(u){return u(i)});return{criteria:l,index:++n,value:i}});return jF(a,function(i,o){return PF(i,o,r)})}var OF=MF;function AF(e,t,r){switch(r.length){case 0:return e.call(t);case 1:return e.call(t,r[0]);case 2:return e.call(t,r[0],r[1]);case 3:return e.call(t,r[0],r[1],r[2])}return e.apply(t,r)}var TF=AF,EF=TF,bk=Math.max;function $F(e,t,r){return t=bk(t===void 0?e.length-1:t,0),function(){for(var n=arguments,a=-1,i=bk(n.length-t,0),o=Array(i);++a<i;)o[a]=n[t+a];a=-1;for(var s=Array(t+1);++a<t;)s[a]=n[a];return s[t]=r(o),EF(e,this,s)}}var RF=$F;function DF(e){return function(){return e}}var IF=DF,LF=xl,BF=function(){try{var e=LF(Object,"defineProperty");return e({},"",{}),e}catch{}}(),sP=BF,FF=IF,wk=sP,UF=eu,GF=wk?function(e,t){return wk(e,"toString",{configurable:!0,enumerable:!1,value:FF(t),writable:!0})}:UF,zF=GF,WF=800,VF=16,HF=Date.now;function XF(e){var t=0,r=0;return function(){var n=HF(),a=VF-(n-r);if(r=n,a>0){if(++t>=WF)return arguments[0]}else t=0;return e.apply(void 0,arguments)}}var KF=XF,qF=zF,YF=KF,ZF=YF(qF),QF=ZF,JF=eu,eU=RF,tU=QF;function rU(e,t){return tU(eU(e,t,JF),e+"")}var nU=rU,aU=D1,iU=od,oU=Q1,sU=ms;function lU(e,t,r){if(!sU(r))return!1;var n=typeof t;return(n=="number"?iU(r)&&oU(t,r.length):n=="string"&&t in r)?aU(r[t],e):!1}var Xp=lU,cU=aP,uU=OF,fU=nU,kk=Xp,dU=fU(function(e,t){if(e==null)return[];var r=t.length;return r>1&&kk(e,t[0],t[1])?t=[]:r>2&&kk(t[0],t[1],t[2])&&(t=[t[0]]),uU(e,cU(t,1),[])}),hU=dU;const rb=Fr(hU);function wf(e){"@babel/helpers - typeof";return wf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},wf(e)}function bv(){return bv=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},bv.apply(this,arguments)}function pU(e,t){return vU(e)||yU(e,t)||mU(e,t)||gU()}function gU(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function mU(e,t){if(e){if(typeof e=="string")return Sk(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Sk(e,t)}}function Sk(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function yU(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,a,i,o,s=[],l=!0,u=!1;try{if(i=(r=r.call(e)).next,t!==0)for(;!(l=(n=i.call(r)).done)&&(s.push(n.value),s.length!==t);l=!0);}catch(f){u=!0,a=f}finally{try{if(!l&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(u)throw a}}return s}}function vU(e){if(Array.isArray(e))return e}function jk(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Mm(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?jk(Object(r),!0).forEach(function(n){xU(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):jk(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function xU(e,t,r){return t=bU(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function bU(e){var t=wU(e,"string");return wf(t)=="symbol"?t:t+""}function wU(e,t){if(wf(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(wf(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function kU(e){return Array.isArray(e)&&zn(e[0])&&zn(e[1])?e.join(" ~ "):e}var SU=function(t){var r=t.separator,n=r===void 0?" : ":r,a=t.contentStyle,i=a===void 0?{}:a,o=t.itemStyle,s=o===void 0?{}:o,l=t.labelStyle,u=l===void 0?{}:l,f=t.payload,d=t.formatter,p=t.itemSorter,m=t.wrapperClassName,v=t.labelClassName,b=t.label,k=t.labelFormatter,x=t.accessibilityLayer,y=x===void 0?!1:x,w=function(){if(f&&f.length){var B={padding:0,margin:0},U=(p?rb(f,p):f).map(function(V,G){if(V.type==="none")return null;var D=Mm({display:"block",paddingTop:4,paddingBottom:4,color:V.color||"#000"},s),I=V.formatter||d||kU,F=V.value,H=V.name,W=F,Q=H;if(I&&W!=null&&Q!=null){var q=I(F,H,V,G,f);if(Array.isArray(q)){var re=pU(q,2);W=re[0],Q=re[1]}else W=q}return J.createElement("li",{className:"recharts-tooltip-item",key:"tooltip-item-".concat(G),style:D},zn(Q)?J.createElement("span",{className:"recharts-tooltip-item-name"},Q):null,zn(Q)?J.createElement("span",{className:"recharts-tooltip-item-separator"},n):null,J.createElement("span",{className:"recharts-tooltip-item-value"},W),J.createElement("span",{className:"recharts-tooltip-item-unit"},V.unit||""))});return J.createElement("ul",{className:"recharts-tooltip-item-list",style:B},U)}return null},_=Mm({margin:0,padding:10,backgroundColor:"#fff",border:"1px solid #ccc",whiteSpace:"nowrap"},i),S=Mm({margin:0},u),j=!Ot(b),M=j?b:"",A=lr("recharts-default-tooltip",m),$=lr("recharts-tooltip-label",v);j&&k&&f!==void 0&&f!==null&&(M=k(b,f));var E=y?{role:"status","aria-live":"assertive"}:{};return J.createElement("div",bv({className:A,style:_},E),J.createElement("p",{className:$,style:S},J.isValidElement(M)?M:"".concat(M)),w())};function kf(e){"@babel/helpers - typeof";return kf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},kf(e)}function Yd(e,t,r){return t=jU(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function jU(e){var t=_U(e,"string");return kf(t)=="symbol"?t:t+""}function _U(e,t){if(kf(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(kf(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var wu="recharts-tooltip-wrapper",PU={visibility:"hidden"};function CU(e){var t=e.coordinate,r=e.translateX,n=e.translateY;return lr(wu,Yd(Yd(Yd(Yd({},"".concat(wu,"-right"),$e(r)&&t&&$e(t.x)&&r>=t.x),"".concat(wu,"-left"),$e(r)&&t&&$e(t.x)&&r<t.x),"".concat(wu,"-bottom"),$e(n)&&t&&$e(t.y)&&n>=t.y),"".concat(wu,"-top"),$e(n)&&t&&$e(t.y)&&n<t.y))}function _k(e){var t=e.allowEscapeViewBox,r=e.coordinate,n=e.key,a=e.offsetTopLeft,i=e.position,o=e.reverseDirection,s=e.tooltipDimension,l=e.viewBox,u=e.viewBoxDimension;if(i&&$e(i[n]))return i[n];var f=r[n]-s-a,d=r[n]+a;if(t[n])return o[n]?f:d;if(o[n]){var p=f,m=l[n];return p<m?Math.max(d,l[n]):Math.max(f,l[n])}var v=d+s,b=l[n]+u;return v>b?Math.max(f,l[n]):Math.max(d,l[n])}function NU(e){var t=e.translateX,r=e.translateY,n=e.useTranslate3d;return{transform:n?"translate3d(".concat(t,"px, ").concat(r,"px, 0)"):"translate(".concat(t,"px, ").concat(r,"px)")}}function MU(e){var t=e.allowEscapeViewBox,r=e.coordinate,n=e.offsetTopLeft,a=e.position,i=e.reverseDirection,o=e.tooltipBox,s=e.useTranslate3d,l=e.viewBox,u,f,d;return o.height>0&&o.width>0&&r?(f=_k({allowEscapeViewBox:t,coordinate:r,key:"x",offsetTopLeft:n,position:a,reverseDirection:i,tooltipDimension:o.width,viewBox:l,viewBoxDimension:l.width}),d=_k({allowEscapeViewBox:t,coordinate:r,key:"y",offsetTopLeft:n,position:a,reverseDirection:i,tooltipDimension:o.height,viewBox:l,viewBoxDimension:l.height}),u=NU({translateX:f,translateY:d,useTranslate3d:s})):u=PU,{cssProperties:u,cssClasses:CU({translateX:f,translateY:d,coordinate:r})}}function vc(e){"@babel/helpers - typeof";return vc=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},vc(e)}function Pk(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Ck(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Pk(Object(r),!0).forEach(function(n){kv(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Pk(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function OU(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function AU(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,cP(n.key),n)}}function TU(e,t,r){return t&&AU(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function EU(e,t,r){return t=dh(t),$U(e,lP()?Reflect.construct(t,r||[],dh(e).constructor):t.apply(e,r))}function $U(e,t){if(t&&(vc(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return RU(e)}function RU(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function lP(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(lP=function(){return!!e})()}function dh(e){return dh=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},dh(e)}function DU(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&wv(e,t)}function wv(e,t){return wv=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},wv(e,t)}function kv(e,t,r){return t=cP(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function cP(e){var t=IU(e,"string");return vc(t)=="symbol"?t:t+""}function IU(e,t){if(vc(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(vc(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var Nk=1,LU=function(e){function t(){var r;OU(this,t);for(var n=arguments.length,a=new Array(n),i=0;i<n;i++)a[i]=arguments[i];return r=EU(this,t,[].concat(a)),kv(r,"state",{dismissed:!1,dismissedAtCoordinate:{x:0,y:0},lastBoundingBox:{width:-1,height:-1}}),kv(r,"handleKeyDown",function(o){if(o.key==="Escape"){var s,l,u,f;r.setState({dismissed:!0,dismissedAtCoordinate:{x:(s=(l=r.props.coordinate)===null||l===void 0?void 0:l.x)!==null&&s!==void 0?s:0,y:(u=(f=r.props.coordinate)===null||f===void 0?void 0:f.y)!==null&&u!==void 0?u:0}})}}),r}return DU(t,e),TU(t,[{key:"updateBBox",value:function(){if(this.wrapperNode&&this.wrapperNode.getBoundingClientRect){var n=this.wrapperNode.getBoundingClientRect();(Math.abs(n.width-this.state.lastBoundingBox.width)>Nk||Math.abs(n.height-this.state.lastBoundingBox.height)>Nk)&&this.setState({lastBoundingBox:{width:n.width,height:n.height}})}else(this.state.lastBoundingBox.width!==-1||this.state.lastBoundingBox.height!==-1)&&this.setState({lastBoundingBox:{width:-1,height:-1}})}},{key:"componentDidMount",value:function(){document.addEventListener("keydown",this.handleKeyDown),this.updateBBox()}},{key:"componentWillUnmount",value:function(){document.removeEventListener("keydown",this.handleKeyDown)}},{key:"componentDidUpdate",value:function(){var n,a;this.props.active&&this.updateBBox(),this.state.dismissed&&(((n=this.props.coordinate)===null||n===void 0?void 0:n.x)!==this.state.dismissedAtCoordinate.x||((a=this.props.coordinate)===null||a===void 0?void 0:a.y)!==this.state.dismissedAtCoordinate.y)&&(this.state.dismissed=!1)}},{key:"render",value:function(){var n=this,a=this.props,i=a.active,o=a.allowEscapeViewBox,s=a.animationDuration,l=a.animationEasing,u=a.children,f=a.coordinate,d=a.hasPayload,p=a.isAnimationActive,m=a.offset,v=a.position,b=a.reverseDirection,k=a.useTranslate3d,x=a.viewBox,y=a.wrapperStyle,w=MU({allowEscapeViewBox:o,coordinate:f,offsetTopLeft:m,position:v,reverseDirection:b,tooltipBox:this.state.lastBoundingBox,useTranslate3d:k,viewBox:x}),_=w.cssClasses,S=w.cssProperties,j=Ck(Ck({transition:p&&i?"transform ".concat(s,"ms ").concat(l):void 0},S),{},{pointerEvents:"none",visibility:!this.state.dismissed&&i&&d?"visible":"hidden",position:"absolute",top:0,left:0},y);return J.createElement("div",{tabIndex:-1,className:_,style:j,ref:function(A){n.wrapperNode=A}},u)}}])}(C.PureComponent),BU=function(){return!(typeof window<"u"&&window.document&&window.document.createElement&&window.setTimeout)},vs={isSsr:BU()};function xc(e){"@babel/helpers - typeof";return xc=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},xc(e)}function Mk(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Ok(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Mk(Object(r),!0).forEach(function(n){nb(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Mk(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function FU(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function UU(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,fP(n.key),n)}}function GU(e,t,r){return t&&UU(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function zU(e,t,r){return t=hh(t),WU(e,uP()?Reflect.construct(t,r||[],hh(e).constructor):t.apply(e,r))}function WU(e,t){if(t&&(xc(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return VU(e)}function VU(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function uP(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(uP=function(){return!!e})()}function hh(e){return hh=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},hh(e)}function HU(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Sv(e,t)}function Sv(e,t){return Sv=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},Sv(e,t)}function nb(e,t,r){return t=fP(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function fP(e){var t=XU(e,"string");return xc(t)=="symbol"?t:t+""}function XU(e,t){if(xc(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(xc(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}function KU(e){return e.dataKey}function qU(e,t){return J.isValidElement(e)?J.cloneElement(e,t):typeof e=="function"?J.createElement(e,t):J.createElement(SU,t)}var Un=function(e){function t(){return FU(this,t),zU(this,t,arguments)}return HU(t,e),GU(t,[{key:"render",value:function(){var n=this,a=this.props,i=a.active,o=a.allowEscapeViewBox,s=a.animationDuration,l=a.animationEasing,u=a.content,f=a.coordinate,d=a.filterNull,p=a.isAnimationActive,m=a.offset,v=a.payload,b=a.payloadUniqBy,k=a.position,x=a.reverseDirection,y=a.useTranslate3d,w=a.viewBox,_=a.wrapperStyle,S=v??[];d&&S.length&&(S=eP(v.filter(function(M){return M.value!=null&&(M.hide!==!0||n.props.includeHidden)}),b,KU));var j=S.length>0;return J.createElement(LU,{allowEscapeViewBox:o,animationDuration:s,animationEasing:l,isAnimationActive:p,active:i,coordinate:f,hasPayload:j,offset:m,position:k,reverseDirection:x,useTranslate3d:y,viewBox:w,wrapperStyle:_},qU(u,Ok(Ok({},this.props),{},{payload:S})))}}])}(C.PureComponent);nb(Un,"displayName","Tooltip");nb(Un,"defaultProps",{accessibilityLayer:!1,allowEscapeViewBox:{x:!1,y:!1},animationDuration:400,animationEasing:"ease",contentStyle:{},coordinate:{x:0,y:0},cursor:!0,cursorStyle:{},filterNull:!0,isAnimationActive:!vs.isSsr,itemStyle:{},labelStyle:{},offset:10,reverseDirection:{x:!1,y:!1},separator:" : ",trigger:"hover",useTranslate3d:!1,viewBox:{x:0,y:0,height:0,width:0},wrapperStyle:{}});var YU=to,ZU=function(){return YU.Date.now()},QU=ZU,JU=/\s/;function eG(e){for(var t=e.length;t--&&JU.test(e.charAt(t)););return t}var tG=eG,rG=tG,nG=/^\s+/;function aG(e){return e&&e.slice(0,rG(e)+1).replace(nG,"")}var iG=aG,oG=iG,Ak=ms,sG=Hc,Tk=NaN,lG=/^[-+]0x[0-9a-f]+$/i,cG=/^0b[01]+$/i,uG=/^0o[0-7]+$/i,fG=parseInt;function dG(e){if(typeof e=="number")return e;if(sG(e))return Tk;if(Ak(e)){var t=typeof e.valueOf=="function"?e.valueOf():e;e=Ak(t)?t+"":t}if(typeof e!="string")return e===0?e:+e;e=oG(e);var r=cG.test(e);return r||uG.test(e)?fG(e.slice(2),r?2:8):lG.test(e)?Tk:+e}var dP=dG,hG=ms,Om=QU,Ek=dP,pG="Expected a function",gG=Math.max,mG=Math.min;function yG(e,t,r){var n,a,i,o,s,l,u=0,f=!1,d=!1,p=!0;if(typeof e!="function")throw new TypeError(pG);t=Ek(t)||0,hG(r)&&(f=!!r.leading,d="maxWait"in r,i=d?gG(Ek(r.maxWait)||0,t):i,p="trailing"in r?!!r.trailing:p);function m(j){var M=n,A=a;return n=a=void 0,u=j,o=e.apply(A,M),o}function v(j){return u=j,s=setTimeout(x,t),f?m(j):o}function b(j){var M=j-l,A=j-u,$=t-M;return d?mG($,i-A):$}function k(j){var M=j-l,A=j-u;return l===void 0||M>=t||M<0||d&&A>=i}function x(){var j=Om();if(k(j))return y(j);s=setTimeout(x,b(j))}function y(j){return s=void 0,p&&n?m(j):(n=a=void 0,o)}function w(){s!==void 0&&clearTimeout(s),u=0,n=l=a=s=void 0}function _(){return s===void 0?o:y(Om())}function S(){var j=Om(),M=k(j);if(n=arguments,a=this,l=j,M){if(s===void 0)return v(l);if(d)return clearTimeout(s),s=setTimeout(x,t),m(l)}return s===void 0&&(s=setTimeout(x,t)),o}return S.cancel=w,S.flush=_,S}var vG=yG,xG=vG,bG=ms,wG="Expected a function";function kG(e,t,r){var n=!0,a=!0;if(typeof e!="function")throw new TypeError(wG);return bG(r)&&(n="leading"in r?!!r.leading:n,a="trailing"in r?!!r.trailing:a),xG(e,t,{leading:n,maxWait:t,trailing:a})}var SG=kG;const hP=Fr(SG);function Sf(e){"@babel/helpers - typeof";return Sf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Sf(e)}function $k(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Zd(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?$k(Object(r),!0).forEach(function(n){jG(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):$k(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function jG(e,t,r){return t=_G(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _G(e){var t=PG(e,"string");return Sf(t)=="symbol"?t:t+""}function PG(e,t){if(Sf(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(Sf(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function CG(e,t){return AG(e)||OG(e,t)||MG(e,t)||NG()}function NG(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function MG(e,t){if(e){if(typeof e=="string")return Rk(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Rk(e,t)}}function Rk(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function OG(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,a,i,o,s=[],l=!0,u=!1;try{if(i=(r=r.call(e)).next,t!==0)for(;!(l=(n=i.call(r)).done)&&(s.push(n.value),s.length!==t);l=!0);}catch(f){u=!0,a=f}finally{try{if(!l&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(u)throw a}}return s}}function AG(e){if(Array.isArray(e))return e}var Ui=C.forwardRef(function(e,t){var r=e.aspect,n=e.initialDimension,a=n===void 0?{width:-1,height:-1}:n,i=e.width,o=i===void 0?"100%":i,s=e.height,l=s===void 0?"100%":s,u=e.minWidth,f=u===void 0?0:u,d=e.minHeight,p=e.maxHeight,m=e.children,v=e.debounce,b=v===void 0?0:v,k=e.id,x=e.className,y=e.onResize,w=e.style,_=w===void 0?{}:w,S=C.useRef(null),j=C.useRef();j.current=y,C.useImperativeHandle(t,function(){return Object.defineProperty(S.current,"current",{get:function(){return console.warn("The usage of ref.current.current is deprecated and will no longer be supported."),S.current},configurable:!0})});var M=C.useState({containerWidth:a.width,containerHeight:a.height}),A=CG(M,2),$=A[0],E=A[1],T=C.useCallback(function(U,V){E(function(G){var D=Math.round(U),I=Math.round(V);return G.containerWidth===D&&G.containerHeight===I?G:{containerWidth:D,containerHeight:I}})},[]);C.useEffect(function(){var U=function(H){var W,Q=H[0].contentRect,q=Q.width,re=Q.height;T(q,re),(W=j.current)===null||W===void 0||W.call(j,q,re)};b>0&&(U=hP(U,b,{trailing:!0,leading:!1}));var V=new ResizeObserver(U),G=S.current.getBoundingClientRect(),D=G.width,I=G.height;return T(D,I),V.observe(S.current),function(){V.disconnect()}},[T,b]);var B=C.useMemo(function(){var U=$.containerWidth,V=$.containerHeight;if(U<0||V<0)return null;yo(Gs(o)||Gs(l),`The width(%s) and height(%s) are both fixed numbers,
       maybe you don't need to use a ResponsiveContainer.`,o,l),yo(!r||r>0,"The aspect(%s) must be greater than zero.",r);var G=Gs(o)?U:o,D=Gs(l)?V:l;r&&r>0&&(G?D=G/r:D&&(G=D*r),p&&D>p&&(D=p)),yo(G>0||D>0,`The width(%s) and height(%s) of chart should be greater than 0,
       please check the style of container, or the props width(%s) and height(%s),
       or add a minWidth(%s) or minHeight(%s) or use aspect(%s) to control the
       height and width.`,G,D,o,l,f,d,r);var I=!Array.isArray(m)&&mo(m.type).endsWith("Chart");return J.Children.map(m,function(F){return J.isValidElement(F)?C.cloneElement(F,Zd({width:G,height:D},I?{style:Zd({height:"100%",width:"100%",maxHeight:D,maxWidth:G},F.props.style)}:{})):F})},[r,m,l,p,d,f,$,o]);return J.createElement("div",{id:k?"".concat(k):void 0,className:lr("recharts-responsive-container",x),style:Zd(Zd({},_),{},{width:o,height:l,minWidth:f,minHeight:d,maxHeight:p}),ref:S},B)}),ab=function(t){return null};ab.displayName="Cell";function jf(e){"@babel/helpers - typeof";return jf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},jf(e)}function Dk(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function jv(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Dk(Object(r),!0).forEach(function(n){TG(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Dk(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function TG(e,t,r){return t=EG(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function EG(e){var t=$G(e,"string");return jf(t)=="symbol"?t:t+""}function $G(e,t){if(jf(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(jf(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Ol={widthCache:{},cacheCount:0},RG=2e3,DG={position:"absolute",top:"-20000px",left:0,padding:0,margin:0,border:"none",whiteSpace:"pre"},Ik="recharts_measurement_span";function IG(e){var t=jv({},e);return Object.keys(t).forEach(function(r){t[r]||delete t[r]}),t}var Vu=function(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(t==null||vs.isSsr)return{width:0,height:0};var n=IG(r),a=JSON.stringify({text:t,copyStyle:n});if(Ol.widthCache[a])return Ol.widthCache[a];try{var i=document.getElementById(Ik);i||(i=document.createElement("span"),i.setAttribute("id",Ik),i.setAttribute("aria-hidden","true"),document.body.appendChild(i));var o=jv(jv({},DG),n);Object.assign(i.style,o),i.textContent="".concat(t);var s=i.getBoundingClientRect(),l={width:s.width,height:s.height};return Ol.widthCache[a]=l,++Ol.cacheCount>RG&&(Ol.cacheCount=0,Ol.widthCache={}),l}catch{return{width:0,height:0}}},LG=function(t){return{top:t.top+window.scrollY-document.documentElement.clientTop,left:t.left+window.scrollX-document.documentElement.clientLeft}};function _f(e){"@babel/helpers - typeof";return _f=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_f(e)}function ph(e,t){return GG(e)||UG(e,t)||FG(e,t)||BG()}function BG(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function FG(e,t){if(e){if(typeof e=="string")return Lk(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Lk(e,t)}}function Lk(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function UG(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,a,i,o,s=[],l=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=i.call(r)).done)&&(s.push(n.value),s.length!==t);l=!0);}catch(f){u=!0,a=f}finally{try{if(!l&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(u)throw a}}return s}}function GG(e){if(Array.isArray(e))return e}function zG(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Bk(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,VG(n.key),n)}}function WG(e,t,r){return t&&Bk(e.prototype,t),r&&Bk(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function VG(e){var t=HG(e,"string");return _f(t)=="symbol"?t:t+""}function HG(e,t){if(_f(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(_f(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var Fk=/(-?\d+(?:\.\d+)?[a-zA-Z%]*)([*/])(-?\d+(?:\.\d+)?[a-zA-Z%]*)/,Uk=/(-?\d+(?:\.\d+)?[a-zA-Z%]*)([+-])(-?\d+(?:\.\d+)?[a-zA-Z%]*)/,XG=/^px|cm|vh|vw|em|rem|%|mm|in|pt|pc|ex|ch|vmin|vmax|Q$/,KG=/(-?\d+(?:\.\d+)?)([a-zA-Z%]+)?/,pP={cm:96/2.54,mm:96/25.4,pt:96/72,pc:96/6,in:96,Q:96/(2.54*40),px:1},qG=Object.keys(pP),Xl="NaN";function YG(e,t){return e*pP[t]}var Qd=function(){function e(t,r){zG(this,e),this.num=t,this.unit=r,this.num=t,this.unit=r,Number.isNaN(t)&&(this.unit=""),r!==""&&!XG.test(r)&&(this.num=NaN,this.unit=""),qG.includes(r)&&(this.num=YG(t,r),this.unit="px")}return WG(e,[{key:"add",value:function(r){return this.unit!==r.unit?new e(NaN,""):new e(this.num+r.num,this.unit)}},{key:"subtract",value:function(r){return this.unit!==r.unit?new e(NaN,""):new e(this.num-r.num,this.unit)}},{key:"multiply",value:function(r){return this.unit!==""&&r.unit!==""&&this.unit!==r.unit?new e(NaN,""):new e(this.num*r.num,this.unit||r.unit)}},{key:"divide",value:function(r){return this.unit!==""&&r.unit!==""&&this.unit!==r.unit?new e(NaN,""):new e(this.num/r.num,this.unit||r.unit)}},{key:"toString",value:function(){return"".concat(this.num).concat(this.unit)}},{key:"isNaN",value:function(){return Number.isNaN(this.num)}}],[{key:"parse",value:function(r){var n,a=(n=KG.exec(r))!==null&&n!==void 0?n:[],i=ph(a,3),o=i[1],s=i[2];return new e(parseFloat(o),s??"")}}])}();function gP(e){if(e.includes(Xl))return Xl;for(var t=e;t.includes("*")||t.includes("/");){var r,n=(r=Fk.exec(t))!==null&&r!==void 0?r:[],a=ph(n,4),i=a[1],o=a[2],s=a[3],l=Qd.parse(i??""),u=Qd.parse(s??""),f=o==="*"?l.multiply(u):l.divide(u);if(f.isNaN())return Xl;t=t.replace(Fk,f.toString())}for(;t.includes("+")||/.-\d+(?:\.\d+)?/.test(t);){var d,p=(d=Uk.exec(t))!==null&&d!==void 0?d:[],m=ph(p,4),v=m[1],b=m[2],k=m[3],x=Qd.parse(v??""),y=Qd.parse(k??""),w=b==="+"?x.add(y):x.subtract(y);if(w.isNaN())return Xl;t=t.replace(Uk,w.toString())}return t}var Gk=/\(([^()]*)\)/;function ZG(e){for(var t=e;t.includes("(");){var r=Gk.exec(t),n=ph(r,2),a=n[1];t=t.replace(Gk,gP(a))}return t}function QG(e){var t=e.replace(/\s+/g,"");return t=ZG(t),t=gP(t),t}function JG(e){try{return QG(e)}catch{return Xl}}function Am(e){var t=JG(e.slice(5,-1));return t===Xl?"":t}var ez=["x","y","lineHeight","capHeight","scaleToFit","textAnchor","verticalAnchor","fill"],tz=["dx","dy","angle","className","breakAll"];function _v(){return _v=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},_v.apply(this,arguments)}function zk(e,t){if(e==null)return{};var r=rz(e,t),n,a;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function rz(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function Wk(e,t){return oz(e)||iz(e,t)||az(e,t)||nz()}function nz(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function az(e,t){if(e){if(typeof e=="string")return Vk(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Vk(e,t)}}function Vk(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function iz(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,a,i,o,s=[],l=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=i.call(r)).done)&&(s.push(n.value),s.length!==t);l=!0);}catch(f){u=!0,a=f}finally{try{if(!l&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(u)throw a}}return s}}function oz(e){if(Array.isArray(e))return e}var mP=/[ \f\n\r\t\v\u2028\u2029]+/,yP=function(t){var r=t.children,n=t.breakAll,a=t.style;try{var i=[];Ot(r)||(n?i=r.toString().split(""):i=r.toString().split(mP));var o=i.map(function(l){return{word:l,width:Vu(l,a).width}}),s=n?0:Vu("",a).width;return{wordsWithComputedWidth:o,spaceWidth:s}}catch{return null}},sz=function(t,r,n,a,i){var o=t.maxLines,s=t.children,l=t.style,u=t.breakAll,f=$e(o),d=s,p=function(){var G=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return G.reduce(function(D,I){var F=I.word,H=I.width,W=D[D.length-1];if(W&&(a==null||i||W.width+H+n<Number(a)))W.words.push(F),W.width+=H+n;else{var Q={words:[F],width:H};D.push(Q)}return D},[])},m=p(r),v=function(G){return G.reduce(function(D,I){return D.width>I.width?D:I})};if(!f)return m;for(var b="",k=function(G){var D=d.slice(0,G),I=yP({breakAll:u,style:l,children:D+b}).wordsWithComputedWidth,F=p(I),H=F.length>o||v(F).width>Number(a);return[H,F]},x=0,y=d.length-1,w=0,_;x<=y&&w<=d.length-1;){var S=Math.floor((x+y)/2),j=S-1,M=k(j),A=Wk(M,2),$=A[0],E=A[1],T=k(S),B=Wk(T,1),U=B[0];if(!$&&!U&&(x=S+1),$&&U&&(y=S-1),!$&&U){_=E;break}w++}return _||m},Hk=function(t){var r=Ot(t)?[]:t.toString().split(mP);return[{words:r}]},lz=function(t){var r=t.width,n=t.scaleToFit,a=t.children,i=t.style,o=t.breakAll,s=t.maxLines;if((r||n)&&!vs.isSsr){var l,u,f=yP({breakAll:o,children:a,style:i});if(f){var d=f.wordsWithComputedWidth,p=f.spaceWidth;l=d,u=p}else return Hk(a);return sz({breakAll:o,children:a,maxLines:s,style:i},l,u,r,n)}return Hk(a)},Xk="#808080",gh=function(t){var r=t.x,n=r===void 0?0:r,a=t.y,i=a===void 0?0:a,o=t.lineHeight,s=o===void 0?"1em":o,l=t.capHeight,u=l===void 0?"0.71em":l,f=t.scaleToFit,d=f===void 0?!1:f,p=t.textAnchor,m=p===void 0?"start":p,v=t.verticalAnchor,b=v===void 0?"end":v,k=t.fill,x=k===void 0?Xk:k,y=zk(t,ez),w=C.useMemo(function(){return lz({breakAll:y.breakAll,children:y.children,maxLines:y.maxLines,scaleToFit:d,style:y.style,width:y.width})},[y.breakAll,y.children,y.maxLines,d,y.style,y.width]),_=y.dx,S=y.dy,j=y.angle,M=y.className,A=y.breakAll,$=zk(y,tz);if(!zn(n)||!zn(i))return null;var E=n+($e(_)?_:0),T=i+($e(S)?S:0),B;switch(b){case"start":B=Am("calc(".concat(u,")"));break;case"middle":B=Am("calc(".concat((w.length-1)/2," * -").concat(s," + (").concat(u," / 2))"));break;default:B=Am("calc(".concat(w.length-1," * -").concat(s,")"));break}var U=[];if(d){var V=w[0].width,G=y.width;U.push("scale(".concat(($e(G)?G/V:1)/V,")"))}return j&&U.push("rotate(".concat(j,", ").concat(E,", ").concat(T,")")),U.length&&($.transform=U.join(" ")),J.createElement("text",_v({},At($,!0),{x:E,y:T,className:lr("recharts-text",M),textAnchor:m,fill:x.includes("url")?Xk:x}),w.map(function(D,I){var F=D.words.join(A?"":" ");return J.createElement("tspan",{x:E,dy:I===0?B:s,key:"".concat(F,"-").concat(I)},F)}))};function ls(e,t){return e==null||t==null?NaN:e<t?-1:e>t?1:e>=t?0:NaN}function cz(e,t){return e==null||t==null?NaN:t<e?-1:t>e?1:t>=e?0:NaN}function ib(e){let t,r,n;e.length!==2?(t=ls,r=(s,l)=>ls(e(s),l),n=(s,l)=>e(s)-l):(t=e===ls||e===cz?e:uz,r=e,n=e);function a(s,l,u=0,f=s.length){if(u<f){if(t(l,l)!==0)return f;do{const d=u+f>>>1;r(s[d],l)<0?u=d+1:f=d}while(u<f)}return u}function i(s,l,u=0,f=s.length){if(u<f){if(t(l,l)!==0)return f;do{const d=u+f>>>1;r(s[d],l)<=0?u=d+1:f=d}while(u<f)}return u}function o(s,l,u=0,f=s.length){const d=a(s,l,u,f-1);return d>u&&n(s[d-1],l)>-n(s[d],l)?d-1:d}return{left:a,center:o,right:i}}function uz(){return 0}function vP(e){return e===null?NaN:+e}function*fz(e,t){for(let r of e)r!=null&&(r=+r)>=r&&(yield r)}const dz=ib(ls),sd=dz.right;ib(vP).center;class Kk extends Map{constructor(t,r=gz){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:r}}),t!=null)for(const[n,a]of t)this.set(n,a)}get(t){return super.get(qk(this,t))}has(t){return super.has(qk(this,t))}set(t,r){return super.set(hz(this,t),r)}delete(t){return super.delete(pz(this,t))}}function qk({_intern:e,_key:t},r){const n=t(r);return e.has(n)?e.get(n):r}function hz({_intern:e,_key:t},r){const n=t(r);return e.has(n)?e.get(n):(e.set(n,r),r)}function pz({_intern:e,_key:t},r){const n=t(r);return e.has(n)&&(r=e.get(n),e.delete(n)),r}function gz(e){return e!==null&&typeof e=="object"?e.valueOf():e}function mz(e=ls){if(e===ls)return xP;if(typeof e!="function")throw new TypeError("compare is not a function");return(t,r)=>{const n=e(t,r);return n||n===0?n:(e(r,r)===0)-(e(t,t)===0)}}function xP(e,t){return(e==null||!(e>=e))-(t==null||!(t>=t))||(e<t?-1:e>t?1:0)}const yz=Math.sqrt(50),vz=Math.sqrt(10),xz=Math.sqrt(2);function mh(e,t,r){const n=(t-e)/Math.max(0,r),a=Math.floor(Math.log10(n)),i=n/Math.pow(10,a),o=i>=yz?10:i>=vz?5:i>=xz?2:1;let s,l,u;return a<0?(u=Math.pow(10,-a)/o,s=Math.round(e*u),l=Math.round(t*u),s/u<e&&++s,l/u>t&&--l,u=-u):(u=Math.pow(10,a)*o,s=Math.round(e/u),l=Math.round(t/u),s*u<e&&++s,l*u>t&&--l),l<s&&.5<=r&&r<2?mh(e,t,r*2):[s,l,u]}function Pv(e,t,r){if(t=+t,e=+e,r=+r,!(r>0))return[];if(e===t)return[e];const n=t<e,[a,i,o]=n?mh(t,e,r):mh(e,t,r);if(!(i>=a))return[];const s=i-a+1,l=new Array(s);if(n)if(o<0)for(let u=0;u<s;++u)l[u]=(i-u)/-o;else for(let u=0;u<s;++u)l[u]=(i-u)*o;else if(o<0)for(let u=0;u<s;++u)l[u]=(a+u)/-o;else for(let u=0;u<s;++u)l[u]=(a+u)*o;return l}function Cv(e,t,r){return t=+t,e=+e,r=+r,mh(e,t,r)[2]}function Nv(e,t,r){t=+t,e=+e,r=+r;const n=t<e,a=n?Cv(t,e,r):Cv(e,t,r);return(n?-1:1)*(a<0?1/-a:a)}function Yk(e,t){let r;for(const n of e)n!=null&&(r<n||r===void 0&&n>=n)&&(r=n);return r}function Zk(e,t){let r;for(const n of e)n!=null&&(r>n||r===void 0&&n>=n)&&(r=n);return r}function bP(e,t,r=0,n=1/0,a){if(t=Math.floor(t),r=Math.floor(Math.max(0,r)),n=Math.floor(Math.min(e.length-1,n)),!(r<=t&&t<=n))return e;for(a=a===void 0?xP:mz(a);n>r;){if(n-r>600){const l=n-r+1,u=t-r+1,f=Math.log(l),d=.5*Math.exp(2*f/3),p=.5*Math.sqrt(f*d*(l-d)/l)*(u-l/2<0?-1:1),m=Math.max(r,Math.floor(t-u*d/l+p)),v=Math.min(n,Math.floor(t+(l-u)*d/l+p));bP(e,t,m,v,a)}const i=e[t];let o=r,s=n;for(ku(e,r,t),a(e[n],i)>0&&ku(e,r,n);o<s;){for(ku(e,o,s),++o,--s;a(e[o],i)<0;)++o;for(;a(e[s],i)>0;)--s}a(e[r],i)===0?ku(e,r,s):(++s,ku(e,s,n)),s<=t&&(r=s+1),t<=s&&(n=s-1)}return e}function ku(e,t,r){const n=e[t];e[t]=e[r],e[r]=n}function bz(e,t,r){if(e=Float64Array.from(fz(e)),!(!(n=e.length)||isNaN(t=+t))){if(t<=0||n<2)return Zk(e);if(t>=1)return Yk(e);var n,a=(n-1)*t,i=Math.floor(a),o=Yk(bP(e,i).subarray(0,i+1)),s=Zk(e.subarray(i+1));return o+(s-o)*(a-i)}}function wz(e,t,r=vP){if(!(!(n=e.length)||isNaN(t=+t))){if(t<=0||n<2)return+r(e[0],0,e);if(t>=1)return+r(e[n-1],n-1,e);var n,a=(n-1)*t,i=Math.floor(a),o=+r(e[i],i,e),s=+r(e[i+1],i+1,e);return o+(s-o)*(a-i)}}function kz(e,t,r){e=+e,t=+t,r=(a=arguments.length)<2?(t=e,e=0,1):a<3?1:+r;for(var n=-1,a=Math.max(0,Math.ceil((t-e)/r))|0,i=new Array(a);++n<a;)i[n]=e+n*r;return i}function gi(e,t){switch(arguments.length){case 0:break;case 1:this.range(e);break;default:this.range(t).domain(e);break}return this}function Mo(e,t){switch(arguments.length){case 0:break;case 1:{typeof e=="function"?this.interpolator(e):this.range(e);break}default:{this.domain(e),typeof t=="function"?this.interpolator(t):this.range(t);break}}return this}const Mv=Symbol("implicit");function ob(){var e=new Kk,t=[],r=[],n=Mv;function a(i){let o=e.get(i);if(o===void 0){if(n!==Mv)return n;e.set(i,o=t.push(i)-1)}return r[o%r.length]}return a.domain=function(i){if(!arguments.length)return t.slice();t=[],e=new Kk;for(const o of i)e.has(o)||e.set(o,t.push(o)-1);return a},a.range=function(i){return arguments.length?(r=Array.from(i),a):r.slice()},a.unknown=function(i){return arguments.length?(n=i,a):n},a.copy=function(){return ob(t,r).unknown(n)},gi.apply(a,arguments),a}function Pf(){var e=ob().unknown(void 0),t=e.domain,r=e.range,n=0,a=1,i,o,s=!1,l=0,u=0,f=.5;delete e.unknown;function d(){var p=t().length,m=a<n,v=m?a:n,b=m?n:a;i=(b-v)/Math.max(1,p-l+u*2),s&&(i=Math.floor(i)),v+=(b-v-i*(p-l))*f,o=i*(1-l),s&&(v=Math.round(v),o=Math.round(o));var k=kz(p).map(function(x){return v+i*x});return r(m?k.reverse():k)}return e.domain=function(p){return arguments.length?(t(p),d()):t()},e.range=function(p){return arguments.length?([n,a]=p,n=+n,a=+a,d()):[n,a]},e.rangeRound=function(p){return[n,a]=p,n=+n,a=+a,s=!0,d()},e.bandwidth=function(){return o},e.step=function(){return i},e.round=function(p){return arguments.length?(s=!!p,d()):s},e.padding=function(p){return arguments.length?(l=Math.min(1,u=+p),d()):l},e.paddingInner=function(p){return arguments.length?(l=Math.min(1,p),d()):l},e.paddingOuter=function(p){return arguments.length?(u=+p,d()):u},e.align=function(p){return arguments.length?(f=Math.max(0,Math.min(1,p)),d()):f},e.copy=function(){return Pf(t(),[n,a]).round(s).paddingInner(l).paddingOuter(u).align(f)},gi.apply(d(),arguments)}function wP(e){var t=e.copy;return e.padding=e.paddingOuter,delete e.paddingInner,delete e.paddingOuter,e.copy=function(){return wP(t())},e}function Hu(){return wP(Pf.apply(null,arguments).paddingInner(1))}function sb(e,t,r){e.prototype=t.prototype=r,r.constructor=e}function kP(e,t){var r=Object.create(e.prototype);for(var n in t)r[n]=t[n];return r}function ld(){}var Cf=.7,yh=1/Cf,ac="\\s*([+-]?\\d+)\\s*",Nf="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",Ki="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",Sz=/^#([0-9a-f]{3,8})$/,jz=new RegExp(`^rgb\\(${ac},${ac},${ac}\\)$`),_z=new RegExp(`^rgb\\(${Ki},${Ki},${Ki}\\)$`),Pz=new RegExp(`^rgba\\(${ac},${ac},${ac},${Nf}\\)$`),Cz=new RegExp(`^rgba\\(${Ki},${Ki},${Ki},${Nf}\\)$`),Nz=new RegExp(`^hsl\\(${Nf},${Ki},${Ki}\\)$`),Mz=new RegExp(`^hsla\\(${Nf},${Ki},${Ki},${Nf}\\)$`),Qk={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};sb(ld,Mf,{copy(e){return Object.assign(new this.constructor,this,e)},displayable(){return this.rgb().displayable()},hex:Jk,formatHex:Jk,formatHex8:Oz,formatHsl:Az,formatRgb:eS,toString:eS});function Jk(){return this.rgb().formatHex()}function Oz(){return this.rgb().formatHex8()}function Az(){return SP(this).formatHsl()}function eS(){return this.rgb().formatRgb()}function Mf(e){var t,r;return e=(e+"").trim().toLowerCase(),(t=Sz.exec(e))?(r=t[1].length,t=parseInt(t[1],16),r===6?tS(t):r===3?new Aa(t>>8&15|t>>4&240,t>>4&15|t&240,(t&15)<<4|t&15,1):r===8?Jd(t>>24&255,t>>16&255,t>>8&255,(t&255)/255):r===4?Jd(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|t&240,((t&15)<<4|t&15)/255):null):(t=jz.exec(e))?new Aa(t[1],t[2],t[3],1):(t=_z.exec(e))?new Aa(t[1]*255/100,t[2]*255/100,t[3]*255/100,1):(t=Pz.exec(e))?Jd(t[1],t[2],t[3],t[4]):(t=Cz.exec(e))?Jd(t[1]*255/100,t[2]*255/100,t[3]*255/100,t[4]):(t=Nz.exec(e))?aS(t[1],t[2]/100,t[3]/100,1):(t=Mz.exec(e))?aS(t[1],t[2]/100,t[3]/100,t[4]):Qk.hasOwnProperty(e)?tS(Qk[e]):e==="transparent"?new Aa(NaN,NaN,NaN,0):null}function tS(e){return new Aa(e>>16&255,e>>8&255,e&255,1)}function Jd(e,t,r,n){return n<=0&&(e=t=r=NaN),new Aa(e,t,r,n)}function Tz(e){return e instanceof ld||(e=Mf(e)),e?(e=e.rgb(),new Aa(e.r,e.g,e.b,e.opacity)):new Aa}function Ov(e,t,r,n){return arguments.length===1?Tz(e):new Aa(e,t,r,n??1)}function Aa(e,t,r,n){this.r=+e,this.g=+t,this.b=+r,this.opacity=+n}sb(Aa,Ov,kP(ld,{brighter(e){return e=e==null?yh:Math.pow(yh,e),new Aa(this.r*e,this.g*e,this.b*e,this.opacity)},darker(e){return e=e==null?Cf:Math.pow(Cf,e),new Aa(this.r*e,this.g*e,this.b*e,this.opacity)},rgb(){return this},clamp(){return new Aa(Ys(this.r),Ys(this.g),Ys(this.b),vh(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:rS,formatHex:rS,formatHex8:Ez,formatRgb:nS,toString:nS}));function rS(){return`#${zs(this.r)}${zs(this.g)}${zs(this.b)}`}function Ez(){return`#${zs(this.r)}${zs(this.g)}${zs(this.b)}${zs((isNaN(this.opacity)?1:this.opacity)*255)}`}function nS(){const e=vh(this.opacity);return`${e===1?"rgb(":"rgba("}${Ys(this.r)}, ${Ys(this.g)}, ${Ys(this.b)}${e===1?")":`, ${e})`}`}function vh(e){return isNaN(e)?1:Math.max(0,Math.min(1,e))}function Ys(e){return Math.max(0,Math.min(255,Math.round(e)||0))}function zs(e){return e=Ys(e),(e<16?"0":"")+e.toString(16)}function aS(e,t,r,n){return n<=0?e=t=r=NaN:r<=0||r>=1?e=t=NaN:t<=0&&(e=NaN),new _i(e,t,r,n)}function SP(e){if(e instanceof _i)return new _i(e.h,e.s,e.l,e.opacity);if(e instanceof ld||(e=Mf(e)),!e)return new _i;if(e instanceof _i)return e;e=e.rgb();var t=e.r/255,r=e.g/255,n=e.b/255,a=Math.min(t,r,n),i=Math.max(t,r,n),o=NaN,s=i-a,l=(i+a)/2;return s?(t===i?o=(r-n)/s+(r<n)*6:r===i?o=(n-t)/s+2:o=(t-r)/s+4,s/=l<.5?i+a:2-i-a,o*=60):s=l>0&&l<1?0:o,new _i(o,s,l,e.opacity)}function $z(e,t,r,n){return arguments.length===1?SP(e):new _i(e,t,r,n??1)}function _i(e,t,r,n){this.h=+e,this.s=+t,this.l=+r,this.opacity=+n}sb(_i,$z,kP(ld,{brighter(e){return e=e==null?yh:Math.pow(yh,e),new _i(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=e==null?Cf:Math.pow(Cf,e),new _i(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=this.h%360+(this.h<0)*360,t=isNaN(e)||isNaN(this.s)?0:this.s,r=this.l,n=r+(r<.5?r:1-r)*t,a=2*r-n;return new Aa(Tm(e>=240?e-240:e+120,a,n),Tm(e,a,n),Tm(e<120?e+240:e-120,a,n),this.opacity)},clamp(){return new _i(iS(this.h),e0(this.s),e0(this.l),vh(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const e=vh(this.opacity);return`${e===1?"hsl(":"hsla("}${iS(this.h)}, ${e0(this.s)*100}%, ${e0(this.l)*100}%${e===1?")":`, ${e})`}`}}));function iS(e){return e=(e||0)%360,e<0?e+360:e}function e0(e){return Math.max(0,Math.min(1,e||0))}function Tm(e,t,r){return(e<60?t+(r-t)*e/60:e<180?r:e<240?t+(r-t)*(240-e)/60:t)*255}const lb=e=>()=>e;function Rz(e,t){return function(r){return e+r*t}}function Dz(e,t,r){return e=Math.pow(e,r),t=Math.pow(t,r)-e,r=1/r,function(n){return Math.pow(e+n*t,r)}}function Iz(e){return(e=+e)==1?jP:function(t,r){return r-t?Dz(t,r,e):lb(isNaN(t)?r:t)}}function jP(e,t){var r=t-e;return r?Rz(e,r):lb(isNaN(e)?t:e)}const oS=function e(t){var r=Iz(t);function n(a,i){var o=r((a=Ov(a)).r,(i=Ov(i)).r),s=r(a.g,i.g),l=r(a.b,i.b),u=jP(a.opacity,i.opacity);return function(f){return a.r=o(f),a.g=s(f),a.b=l(f),a.opacity=u(f),a+""}}return n.gamma=e,n}(1);function Lz(e,t){t||(t=[]);var r=e?Math.min(t.length,e.length):0,n=t.slice(),a;return function(i){for(a=0;a<r;++a)n[a]=e[a]*(1-i)+t[a]*i;return n}}function Bz(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}function Fz(e,t){var r=t?t.length:0,n=e?Math.min(r,e.length):0,a=new Array(n),i=new Array(r),o;for(o=0;o<n;++o)a[o]=tu(e[o],t[o]);for(;o<r;++o)i[o]=t[o];return function(s){for(o=0;o<n;++o)i[o]=a[o](s);return i}}function Uz(e,t){var r=new Date;return e=+e,t=+t,function(n){return r.setTime(e*(1-n)+t*n),r}}function xh(e,t){return e=+e,t=+t,function(r){return e*(1-r)+t*r}}function Gz(e,t){var r={},n={},a;(e===null||typeof e!="object")&&(e={}),(t===null||typeof t!="object")&&(t={});for(a in t)a in e?r[a]=tu(e[a],t[a]):n[a]=t[a];return function(i){for(a in r)n[a]=r[a](i);return n}}var Av=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,Em=new RegExp(Av.source,"g");function zz(e){return function(){return e}}function Wz(e){return function(t){return e(t)+""}}function Vz(e,t){var r=Av.lastIndex=Em.lastIndex=0,n,a,i,o=-1,s=[],l=[];for(e=e+"",t=t+"";(n=Av.exec(e))&&(a=Em.exec(t));)(i=a.index)>r&&(i=t.slice(r,i),s[o]?s[o]+=i:s[++o]=i),(n=n[0])===(a=a[0])?s[o]?s[o]+=a:s[++o]=a:(s[++o]=null,l.push({i:o,x:xh(n,a)})),r=Em.lastIndex;return r<t.length&&(i=t.slice(r),s[o]?s[o]+=i:s[++o]=i),s.length<2?l[0]?Wz(l[0].x):zz(t):(t=l.length,function(u){for(var f=0,d;f<t;++f)s[(d=l[f]).i]=d.x(u);return s.join("")})}function tu(e,t){var r=typeof t,n;return t==null||r==="boolean"?lb(t):(r==="number"?xh:r==="string"?(n=Mf(t))?(t=n,oS):Vz:t instanceof Mf?oS:t instanceof Date?Uz:Bz(t)?Lz:Array.isArray(t)?Fz:typeof t.valueOf!="function"&&typeof t.toString!="function"||isNaN(t)?Gz:xh)(e,t)}function cb(e,t){return e=+e,t=+t,function(r){return Math.round(e*(1-r)+t*r)}}function Hz(e,t){t===void 0&&(t=e,e=tu);for(var r=0,n=t.length-1,a=t[0],i=new Array(n<0?0:n);r<n;)i[r]=e(a,a=t[++r]);return function(o){var s=Math.max(0,Math.min(n-1,Math.floor(o*=n)));return i[s](o-s)}}function Xz(e){return function(){return e}}function bh(e){return+e}var sS=[0,1];function wa(e){return e}function Tv(e,t){return(t-=e=+e)?function(r){return(r-e)/t}:Xz(isNaN(t)?NaN:.5)}function Kz(e,t){var r;return e>t&&(r=e,e=t,t=r),function(n){return Math.max(e,Math.min(t,n))}}function qz(e,t,r){var n=e[0],a=e[1],i=t[0],o=t[1];return a<n?(n=Tv(a,n),i=r(o,i)):(n=Tv(n,a),i=r(i,o)),function(s){return i(n(s))}}function Yz(e,t,r){var n=Math.min(e.length,t.length)-1,a=new Array(n),i=new Array(n),o=-1;for(e[n]<e[0]&&(e=e.slice().reverse(),t=t.slice().reverse());++o<n;)a[o]=Tv(e[o],e[o+1]),i[o]=r(t[o],t[o+1]);return function(s){var l=sd(e,s,1,n)-1;return i[l](a[l](s))}}function cd(e,t){return t.domain(e.domain()).range(e.range()).interpolate(e.interpolate()).clamp(e.clamp()).unknown(e.unknown())}function Kp(){var e=sS,t=sS,r=tu,n,a,i,o=wa,s,l,u;function f(){var p=Math.min(e.length,t.length);return o!==wa&&(o=Kz(e[0],e[p-1])),s=p>2?Yz:qz,l=u=null,d}function d(p){return p==null||isNaN(p=+p)?i:(l||(l=s(e.map(n),t,r)))(n(o(p)))}return d.invert=function(p){return o(a((u||(u=s(t,e.map(n),xh)))(p)))},d.domain=function(p){return arguments.length?(e=Array.from(p,bh),f()):e.slice()},d.range=function(p){return arguments.length?(t=Array.from(p),f()):t.slice()},d.rangeRound=function(p){return t=Array.from(p),r=cb,f()},d.clamp=function(p){return arguments.length?(o=p?!0:wa,f()):o!==wa},d.interpolate=function(p){return arguments.length?(r=p,f()):r},d.unknown=function(p){return arguments.length?(i=p,d):i},function(p,m){return n=p,a=m,f()}}function ub(){return Kp()(wa,wa)}function Zz(e){return Math.abs(e=Math.round(e))>=1e21?e.toLocaleString("en").replace(/,/g,""):e.toString(10)}function wh(e,t){if(!isFinite(e)||e===0)return null;var r=(e=t?e.toExponential(t-1):e.toExponential()).indexOf("e"),n=e.slice(0,r);return[n.length>1?n[0]+n.slice(2):n,+e.slice(r+1)]}function bc(e){return e=wh(Math.abs(e)),e?e[1]:NaN}function Qz(e,t){return function(r,n){for(var a=r.length,i=[],o=0,s=e[0],l=0;a>0&&s>0&&(l+s+1>n&&(s=Math.max(1,n-l)),i.push(r.substring(a-=s,a+s)),!((l+=s+1)>n));)s=e[o=(o+1)%e.length];return i.reverse().join(t)}}function Jz(e){return function(t){return t.replace(/[0-9]/g,function(r){return e[+r]})}}var eW=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function Of(e){if(!(t=eW.exec(e)))throw new Error("invalid format: "+e);var t;return new fb({fill:t[1],align:t[2],sign:t[3],symbol:t[4],zero:t[5],width:t[6],comma:t[7],precision:t[8]&&t[8].slice(1),trim:t[9],type:t[10]})}Of.prototype=fb.prototype;function fb(e){this.fill=e.fill===void 0?" ":e.fill+"",this.align=e.align===void 0?">":e.align+"",this.sign=e.sign===void 0?"-":e.sign+"",this.symbol=e.symbol===void 0?"":e.symbol+"",this.zero=!!e.zero,this.width=e.width===void 0?void 0:+e.width,this.comma=!!e.comma,this.precision=e.precision===void 0?void 0:+e.precision,this.trim=!!e.trim,this.type=e.type===void 0?"":e.type+""}fb.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function tW(e){e:for(var t=e.length,r=1,n=-1,a;r<t;++r)switch(e[r]){case".":n=a=r;break;case"0":n===0&&(n=r),a=r;break;default:if(!+e[r])break e;n>0&&(n=0);break}return n>0?e.slice(0,n)+e.slice(a+1):e}var kh;function rW(e,t){var r=wh(e,t);if(!r)return kh=void 0,e.toPrecision(t);var n=r[0],a=r[1],i=a-(kh=Math.max(-8,Math.min(8,Math.floor(a/3)))*3)+1,o=n.length;return i===o?n:i>o?n+new Array(i-o+1).join("0"):i>0?n.slice(0,i)+"."+n.slice(i):"0."+new Array(1-i).join("0")+wh(e,Math.max(0,t+i-1))[0]}function lS(e,t){var r=wh(e,t);if(!r)return e+"";var n=r[0],a=r[1];return a<0?"0."+new Array(-a).join("0")+n:n.length>a+1?n.slice(0,a+1)+"."+n.slice(a+1):n+new Array(a-n.length+2).join("0")}const cS={"%":(e,t)=>(e*100).toFixed(t),b:e=>Math.round(e).toString(2),c:e=>e+"",d:Zz,e:(e,t)=>e.toExponential(t),f:(e,t)=>e.toFixed(t),g:(e,t)=>e.toPrecision(t),o:e=>Math.round(e).toString(8),p:(e,t)=>lS(e*100,t),r:lS,s:rW,X:e=>Math.round(e).toString(16).toUpperCase(),x:e=>Math.round(e).toString(16)};function uS(e){return e}var fS=Array.prototype.map,dS=["y","z","a","f","p","n","","m","","k","M","G","T","P","E","Z","Y"];function nW(e){var t=e.grouping===void 0||e.thousands===void 0?uS:Qz(fS.call(e.grouping,Number),e.thousands+""),r=e.currency===void 0?"":e.currency[0]+"",n=e.currency===void 0?"":e.currency[1]+"",a=e.decimal===void 0?".":e.decimal+"",i=e.numerals===void 0?uS:Jz(fS.call(e.numerals,String)),o=e.percent===void 0?"%":e.percent+"",s=e.minus===void 0?"":e.minus+"",l=e.nan===void 0?"NaN":e.nan+"";function u(d,p){d=Of(d);var m=d.fill,v=d.align,b=d.sign,k=d.symbol,x=d.zero,y=d.width,w=d.comma,_=d.precision,S=d.trim,j=d.type;j==="n"?(w=!0,j="g"):cS[j]||(_===void 0&&(_=12),S=!0,j="g"),(x||m==="0"&&v==="=")&&(x=!0,m="0",v="=");var M=(p&&p.prefix!==void 0?p.prefix:"")+(k==="$"?r:k==="#"&&/[boxX]/.test(j)?"0"+j.toLowerCase():""),A=(k==="$"?n:/[%p]/.test(j)?o:"")+(p&&p.suffix!==void 0?p.suffix:""),$=cS[j],E=/[defgprs%]/.test(j);_=_===void 0?6:/[gprs]/.test(j)?Math.max(1,Math.min(21,_)):Math.max(0,Math.min(20,_));function T(B){var U=M,V=A,G,D,I;if(j==="c")V=$(B)+V,B="";else{B=+B;var F=B<0||1/B<0;if(B=isNaN(B)?l:$(Math.abs(B),_),S&&(B=tW(B)),F&&+B==0&&b!=="+"&&(F=!1),U=(F?b==="("?b:s:b==="-"||b==="("?"":b)+U,V=(j==="s"&&!isNaN(B)&&kh!==void 0?dS[8+kh/3]:"")+V+(F&&b==="("?")":""),E){for(G=-1,D=B.length;++G<D;)if(I=B.charCodeAt(G),48>I||I>57){V=(I===46?a+B.slice(G+1):B.slice(G))+V,B=B.slice(0,G);break}}}w&&!x&&(B=t(B,1/0));var H=U.length+B.length+V.length,W=H<y?new Array(y-H+1).join(m):"";switch(w&&x&&(B=t(W+B,W.length?y-V.length:1/0),W=""),v){case"<":B=U+B+V+W;break;case"=":B=U+W+B+V;break;case"^":B=W.slice(0,H=W.length>>1)+U+B+V+W.slice(H);break;default:B=W+U+B+V;break}return i(B)}return T.toString=function(){return d+""},T}function f(d,p){var m=Math.max(-8,Math.min(8,Math.floor(bc(p)/3)))*3,v=Math.pow(10,-m),b=u((d=Of(d),d.type="f",d),{suffix:dS[8+m/3]});return function(k){return b(v*k)}}return{format:u,formatPrefix:f}}var t0,db,_P;aW({thousands:",",grouping:[3],currency:["$",""]});function aW(e){return t0=nW(e),db=t0.format,_P=t0.formatPrefix,t0}function iW(e){return Math.max(0,-bc(Math.abs(e)))}function oW(e,t){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(bc(t)/3)))*3-bc(Math.abs(e)))}function sW(e,t){return e=Math.abs(e),t=Math.abs(t)-e,Math.max(0,bc(t)-bc(e))+1}function PP(e,t,r,n){var a=Nv(e,t,r),i;switch(n=Of(n??",f"),n.type){case"s":{var o=Math.max(Math.abs(e),Math.abs(t));return n.precision==null&&!isNaN(i=oW(a,o))&&(n.precision=i),_P(n,o)}case"":case"e":case"g":case"p":case"r":{n.precision==null&&!isNaN(i=sW(a,Math.max(Math.abs(e),Math.abs(t))))&&(n.precision=i-(n.type==="e"));break}case"f":case"%":{n.precision==null&&!isNaN(i=iW(a))&&(n.precision=i-(n.type==="%")*2);break}}return db(n)}function xs(e){var t=e.domain;return e.ticks=function(r){var n=t();return Pv(n[0],n[n.length-1],r??10)},e.tickFormat=function(r,n){var a=t();return PP(a[0],a[a.length-1],r??10,n)},e.nice=function(r){r==null&&(r=10);var n=t(),a=0,i=n.length-1,o=n[a],s=n[i],l,u,f=10;for(s<o&&(u=o,o=s,s=u,u=a,a=i,i=u);f-- >0;){if(u=Cv(o,s,r),u===l)return n[a]=o,n[i]=s,t(n);if(u>0)o=Math.floor(o/u)*u,s=Math.ceil(s/u)*u;else if(u<0)o=Math.ceil(o*u)/u,s=Math.floor(s*u)/u;else break;l=u}return e},e}function Sh(){var e=ub();return e.copy=function(){return cd(e,Sh())},gi.apply(e,arguments),xs(e)}function CP(e){var t;function r(n){return n==null||isNaN(n=+n)?t:n}return r.invert=r,r.domain=r.range=function(n){return arguments.length?(e=Array.from(n,bh),r):e.slice()},r.unknown=function(n){return arguments.length?(t=n,r):t},r.copy=function(){return CP(e).unknown(t)},e=arguments.length?Array.from(e,bh):[0,1],xs(r)}function NP(e,t){e=e.slice();var r=0,n=e.length-1,a=e[r],i=e[n],o;return i<a&&(o=r,r=n,n=o,o=a,a=i,i=o),e[r]=t.floor(a),e[n]=t.ceil(i),e}function hS(e){return Math.log(e)}function pS(e){return Math.exp(e)}function lW(e){return-Math.log(-e)}function cW(e){return-Math.exp(-e)}function uW(e){return isFinite(e)?+("1e"+e):e<0?0:e}function fW(e){return e===10?uW:e===Math.E?Math.exp:t=>Math.pow(e,t)}function dW(e){return e===Math.E?Math.log:e===10&&Math.log10||e===2&&Math.log2||(e=Math.log(e),t=>Math.log(t)/e)}function gS(e){return(t,r)=>-e(-t,r)}function hb(e){const t=e(hS,pS),r=t.domain;let n=10,a,i;function o(){return a=dW(n),i=fW(n),r()[0]<0?(a=gS(a),i=gS(i),e(lW,cW)):e(hS,pS),t}return t.base=function(s){return arguments.length?(n=+s,o()):n},t.domain=function(s){return arguments.length?(r(s),o()):r()},t.ticks=s=>{const l=r();let u=l[0],f=l[l.length-1];const d=f<u;d&&([u,f]=[f,u]);let p=a(u),m=a(f),v,b;const k=s==null?10:+s;let x=[];if(!(n%1)&&m-p<k){if(p=Math.floor(p),m=Math.ceil(m),u>0){for(;p<=m;++p)for(v=1;v<n;++v)if(b=p<0?v/i(-p):v*i(p),!(b<u)){if(b>f)break;x.push(b)}}else for(;p<=m;++p)for(v=n-1;v>=1;--v)if(b=p>0?v/i(-p):v*i(p),!(b<u)){if(b>f)break;x.push(b)}x.length*2<k&&(x=Pv(u,f,k))}else x=Pv(p,m,Math.min(m-p,k)).map(i);return d?x.reverse():x},t.tickFormat=(s,l)=>{if(s==null&&(s=10),l==null&&(l=n===10?"s":","),typeof l!="function"&&(!(n%1)&&(l=Of(l)).precision==null&&(l.trim=!0),l=db(l)),s===1/0)return l;const u=Math.max(1,n*s/t.ticks().length);return f=>{let d=f/i(Math.round(a(f)));return d*n<n-.5&&(d*=n),d<=u?l(f):""}},t.nice=()=>r(NP(r(),{floor:s=>i(Math.floor(a(s))),ceil:s=>i(Math.ceil(a(s)))})),t}function MP(){const e=hb(Kp()).domain([1,10]);return e.copy=()=>cd(e,MP()).base(e.base()),gi.apply(e,arguments),e}function mS(e){return function(t){return Math.sign(t)*Math.log1p(Math.abs(t/e))}}function yS(e){return function(t){return Math.sign(t)*Math.expm1(Math.abs(t))*e}}function pb(e){var t=1,r=e(mS(t),yS(t));return r.constant=function(n){return arguments.length?e(mS(t=+n),yS(t)):t},xs(r)}function OP(){var e=pb(Kp());return e.copy=function(){return cd(e,OP()).constant(e.constant())},gi.apply(e,arguments)}function vS(e){return function(t){return t<0?-Math.pow(-t,e):Math.pow(t,e)}}function hW(e){return e<0?-Math.sqrt(-e):Math.sqrt(e)}function pW(e){return e<0?-e*e:e*e}function gb(e){var t=e(wa,wa),r=1;function n(){return r===1?e(wa,wa):r===.5?e(hW,pW):e(vS(r),vS(1/r))}return t.exponent=function(a){return arguments.length?(r=+a,n()):r},xs(t)}function mb(){var e=gb(Kp());return e.copy=function(){return cd(e,mb()).exponent(e.exponent())},gi.apply(e,arguments),e}function gW(){return mb.apply(null,arguments).exponent(.5)}function xS(e){return Math.sign(e)*e*e}function mW(e){return Math.sign(e)*Math.sqrt(Math.abs(e))}function AP(){var e=ub(),t=[0,1],r=!1,n;function a(i){var o=mW(e(i));return isNaN(o)?n:r?Math.round(o):o}return a.invert=function(i){return e.invert(xS(i))},a.domain=function(i){return arguments.length?(e.domain(i),a):e.domain()},a.range=function(i){return arguments.length?(e.range((t=Array.from(i,bh)).map(xS)),a):t.slice()},a.rangeRound=function(i){return a.range(i).round(!0)},a.round=function(i){return arguments.length?(r=!!i,a):r},a.clamp=function(i){return arguments.length?(e.clamp(i),a):e.clamp()},a.unknown=function(i){return arguments.length?(n=i,a):n},a.copy=function(){return AP(e.domain(),t).round(r).clamp(e.clamp()).unknown(n)},gi.apply(a,arguments),xs(a)}function TP(){var e=[],t=[],r=[],n;function a(){var o=0,s=Math.max(1,t.length);for(r=new Array(s-1);++o<s;)r[o-1]=wz(e,o/s);return i}function i(o){return o==null||isNaN(o=+o)?n:t[sd(r,o)]}return i.invertExtent=function(o){var s=t.indexOf(o);return s<0?[NaN,NaN]:[s>0?r[s-1]:e[0],s<r.length?r[s]:e[e.length-1]]},i.domain=function(o){if(!arguments.length)return e.slice();e=[];for(let s of o)s!=null&&!isNaN(s=+s)&&e.push(s);return e.sort(ls),a()},i.range=function(o){return arguments.length?(t=Array.from(o),a()):t.slice()},i.unknown=function(o){return arguments.length?(n=o,i):n},i.quantiles=function(){return r.slice()},i.copy=function(){return TP().domain(e).range(t).unknown(n)},gi.apply(i,arguments)}function EP(){var e=0,t=1,r=1,n=[.5],a=[0,1],i;function o(l){return l!=null&&l<=l?a[sd(n,l,0,r)]:i}function s(){var l=-1;for(n=new Array(r);++l<r;)n[l]=((l+1)*t-(l-r)*e)/(r+1);return o}return o.domain=function(l){return arguments.length?([e,t]=l,e=+e,t=+t,s()):[e,t]},o.range=function(l){return arguments.length?(r=(a=Array.from(l)).length-1,s()):a.slice()},o.invertExtent=function(l){var u=a.indexOf(l);return u<0?[NaN,NaN]:u<1?[e,n[0]]:u>=r?[n[r-1],t]:[n[u-1],n[u]]},o.unknown=function(l){return arguments.length&&(i=l),o},o.thresholds=function(){return n.slice()},o.copy=function(){return EP().domain([e,t]).range(a).unknown(i)},gi.apply(xs(o),arguments)}function $P(){var e=[.5],t=[0,1],r,n=1;function a(i){return i!=null&&i<=i?t[sd(e,i,0,n)]:r}return a.domain=function(i){return arguments.length?(e=Array.from(i),n=Math.min(e.length,t.length-1),a):e.slice()},a.range=function(i){return arguments.length?(t=Array.from(i),n=Math.min(e.length,t.length-1),a):t.slice()},a.invertExtent=function(i){var o=t.indexOf(i);return[e[o-1],e[o]]},a.unknown=function(i){return arguments.length?(r=i,a):r},a.copy=function(){return $P().domain(e).range(t).unknown(r)},gi.apply(a,arguments)}const $m=new Date,Rm=new Date;function Vn(e,t,r,n){function a(i){return e(i=arguments.length===0?new Date:new Date(+i)),i}return a.floor=i=>(e(i=new Date(+i)),i),a.ceil=i=>(e(i=new Date(i-1)),t(i,1),e(i),i),a.round=i=>{const o=a(i),s=a.ceil(i);return i-o<s-i?o:s},a.offset=(i,o)=>(t(i=new Date(+i),o==null?1:Math.floor(o)),i),a.range=(i,o,s)=>{const l=[];if(i=a.ceil(i),s=s==null?1:Math.floor(s),!(i<o)||!(s>0))return l;let u;do l.push(u=new Date(+i)),t(i,s),e(i);while(u<i&&i<o);return l},a.filter=i=>Vn(o=>{if(o>=o)for(;e(o),!i(o);)o.setTime(o-1)},(o,s)=>{if(o>=o)if(s<0)for(;++s<=0;)for(;t(o,-1),!i(o););else for(;--s>=0;)for(;t(o,1),!i(o););}),r&&(a.count=(i,o)=>($m.setTime(+i),Rm.setTime(+o),e($m),e(Rm),Math.floor(r($m,Rm))),a.every=i=>(i=Math.floor(i),!isFinite(i)||!(i>0)?null:i>1?a.filter(n?o=>n(o)%i===0:o=>a.count(0,o)%i===0):a)),a}const jh=Vn(()=>{},(e,t)=>{e.setTime(+e+t)},(e,t)=>t-e);jh.every=e=>(e=Math.floor(e),!isFinite(e)||!(e>0)?null:e>1?Vn(t=>{t.setTime(Math.floor(t/e)*e)},(t,r)=>{t.setTime(+t+r*e)},(t,r)=>(r-t)/e):jh);jh.range;const fo=1e3,si=fo*60,ho=si*60,So=ho*24,yb=So*7,bS=So*30,Dm=So*365,Ws=Vn(e=>{e.setTime(e-e.getMilliseconds())},(e,t)=>{e.setTime(+e+t*fo)},(e,t)=>(t-e)/fo,e=>e.getUTCSeconds());Ws.range;const vb=Vn(e=>{e.setTime(e-e.getMilliseconds()-e.getSeconds()*fo)},(e,t)=>{e.setTime(+e+t*si)},(e,t)=>(t-e)/si,e=>e.getMinutes());vb.range;const xb=Vn(e=>{e.setUTCSeconds(0,0)},(e,t)=>{e.setTime(+e+t*si)},(e,t)=>(t-e)/si,e=>e.getUTCMinutes());xb.range;const bb=Vn(e=>{e.setTime(e-e.getMilliseconds()-e.getSeconds()*fo-e.getMinutes()*si)},(e,t)=>{e.setTime(+e+t*ho)},(e,t)=>(t-e)/ho,e=>e.getHours());bb.range;const wb=Vn(e=>{e.setUTCMinutes(0,0,0)},(e,t)=>{e.setTime(+e+t*ho)},(e,t)=>(t-e)/ho,e=>e.getUTCHours());wb.range;const ud=Vn(e=>e.setHours(0,0,0,0),(e,t)=>e.setDate(e.getDate()+t),(e,t)=>(t-e-(t.getTimezoneOffset()-e.getTimezoneOffset())*si)/So,e=>e.getDate()-1);ud.range;const qp=Vn(e=>{e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCDate(e.getUTCDate()+t)},(e,t)=>(t-e)/So,e=>e.getUTCDate()-1);qp.range;const RP=Vn(e=>{e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCDate(e.getUTCDate()+t)},(e,t)=>(t-e)/So,e=>Math.floor(e/So));RP.range;function wl(e){return Vn(t=>{t.setDate(t.getDate()-(t.getDay()+7-e)%7),t.setHours(0,0,0,0)},(t,r)=>{t.setDate(t.getDate()+r*7)},(t,r)=>(r-t-(r.getTimezoneOffset()-t.getTimezoneOffset())*si)/yb)}const Yp=wl(0),_h=wl(1),yW=wl(2),vW=wl(3),wc=wl(4),xW=wl(5),bW=wl(6);Yp.range;_h.range;yW.range;vW.range;wc.range;xW.range;bW.range;function kl(e){return Vn(t=>{t.setUTCDate(t.getUTCDate()-(t.getUTCDay()+7-e)%7),t.setUTCHours(0,0,0,0)},(t,r)=>{t.setUTCDate(t.getUTCDate()+r*7)},(t,r)=>(r-t)/yb)}const Zp=kl(0),Ph=kl(1),wW=kl(2),kW=kl(3),kc=kl(4),SW=kl(5),jW=kl(6);Zp.range;Ph.range;wW.range;kW.range;kc.range;SW.range;jW.range;const kb=Vn(e=>{e.setDate(1),e.setHours(0,0,0,0)},(e,t)=>{e.setMonth(e.getMonth()+t)},(e,t)=>t.getMonth()-e.getMonth()+(t.getFullYear()-e.getFullYear())*12,e=>e.getMonth());kb.range;const Sb=Vn(e=>{e.setUTCDate(1),e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCMonth(e.getUTCMonth()+t)},(e,t)=>t.getUTCMonth()-e.getUTCMonth()+(t.getUTCFullYear()-e.getUTCFullYear())*12,e=>e.getUTCMonth());Sb.range;const jo=Vn(e=>{e.setMonth(0,1),e.setHours(0,0,0,0)},(e,t)=>{e.setFullYear(e.getFullYear()+t)},(e,t)=>t.getFullYear()-e.getFullYear(),e=>e.getFullYear());jo.every=e=>!isFinite(e=Math.floor(e))||!(e>0)?null:Vn(t=>{t.setFullYear(Math.floor(t.getFullYear()/e)*e),t.setMonth(0,1),t.setHours(0,0,0,0)},(t,r)=>{t.setFullYear(t.getFullYear()+r*e)});jo.range;const _o=Vn(e=>{e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCFullYear(e.getUTCFullYear()+t)},(e,t)=>t.getUTCFullYear()-e.getUTCFullYear(),e=>e.getUTCFullYear());_o.every=e=>!isFinite(e=Math.floor(e))||!(e>0)?null:Vn(t=>{t.setUTCFullYear(Math.floor(t.getUTCFullYear()/e)*e),t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)},(t,r)=>{t.setUTCFullYear(t.getUTCFullYear()+r*e)});_o.range;function DP(e,t,r,n,a,i){const o=[[Ws,1,fo],[Ws,5,5*fo],[Ws,15,15*fo],[Ws,30,30*fo],[i,1,si],[i,5,5*si],[i,15,15*si],[i,30,30*si],[a,1,ho],[a,3,3*ho],[a,6,6*ho],[a,12,12*ho],[n,1,So],[n,2,2*So],[r,1,yb],[t,1,bS],[t,3,3*bS],[e,1,Dm]];function s(u,f,d){const p=f<u;p&&([u,f]=[f,u]);const m=d&&typeof d.range=="function"?d:l(u,f,d),v=m?m.range(u,+f+1):[];return p?v.reverse():v}function l(u,f,d){const p=Math.abs(f-u)/d,m=ib(([,,k])=>k).right(o,p);if(m===o.length)return e.every(Nv(u/Dm,f/Dm,d));if(m===0)return jh.every(Math.max(Nv(u,f,d),1));const[v,b]=o[p/o[m-1][2]<o[m][2]/p?m-1:m];return v.every(b)}return[s,l]}const[_W,PW]=DP(_o,Sb,Zp,RP,wb,xb),[CW,NW]=DP(jo,kb,Yp,ud,bb,vb);function Im(e){if(0<=e.y&&e.y<100){var t=new Date(-1,e.m,e.d,e.H,e.M,e.S,e.L);return t.setFullYear(e.y),t}return new Date(e.y,e.m,e.d,e.H,e.M,e.S,e.L)}function Lm(e){if(0<=e.y&&e.y<100){var t=new Date(Date.UTC(-1,e.m,e.d,e.H,e.M,e.S,e.L));return t.setUTCFullYear(e.y),t}return new Date(Date.UTC(e.y,e.m,e.d,e.H,e.M,e.S,e.L))}function Su(e,t,r){return{y:e,m:t,d:r,H:0,M:0,S:0,L:0}}function MW(e){var t=e.dateTime,r=e.date,n=e.time,a=e.periods,i=e.days,o=e.shortDays,s=e.months,l=e.shortMonths,u=ju(a),f=_u(a),d=ju(i),p=_u(i),m=ju(o),v=_u(o),b=ju(s),k=_u(s),x=ju(l),y=_u(l),w={a:I,A:F,b:H,B:W,c:null,d:PS,e:PS,f:QW,g:lV,G:uV,H:qW,I:YW,j:ZW,L:IP,m:JW,M:eV,p:Q,q,Q:MS,s:OS,S:tV,u:rV,U:nV,V:aV,w:iV,W:oV,x:null,X:null,y:sV,Y:cV,Z:fV,"%":NS},_={a:re,A:ee,b:fe,B:oe,c:null,d:CS,e:CS,f:gV,g:_V,G:CV,H:dV,I:hV,j:pV,L:BP,m:mV,M:yV,p:ye,q:ae,Q:MS,s:OS,S:vV,u:xV,U:bV,V:wV,w:kV,W:SV,x:null,X:null,y:jV,Y:PV,Z:NV,"%":NS},S={a:E,A:T,b:B,B:U,c:V,d:jS,e:jS,f:VW,g:SS,G:kS,H:_S,I:_S,j:UW,L:WW,m:FW,M:GW,p:$,q:BW,Q:XW,s:KW,S:zW,u:$W,U:RW,V:DW,w:EW,W:IW,x:G,X:D,y:SS,Y:kS,Z:LW,"%":HW};w.x=j(r,w),w.X=j(n,w),w.c=j(t,w),_.x=j(r,_),_.X=j(n,_),_.c=j(t,_);function j(X,se){return function(he){var le=[],je=-1,ke=0,ve=X.length,ge,Me,Oe;for(he instanceof Date||(he=new Date(+he));++je<ve;)X.charCodeAt(je)===37&&(le.push(X.slice(ke,je)),(Me=wS[ge=X.charAt(++je)])!=null?ge=X.charAt(++je):Me=ge==="e"?" ":"0",(Oe=se[ge])&&(ge=Oe(he,Me)),le.push(ge),ke=je+1);return le.push(X.slice(ke,je)),le.join("")}}function M(X,se){return function(he){var le=Su(1900,void 0,1),je=A(le,X,he+="",0),ke,ve;if(je!=he.length)return null;if("Q"in le)return new Date(le.Q);if("s"in le)return new Date(le.s*1e3+("L"in le?le.L:0));if(se&&!("Z"in le)&&(le.Z=0),"p"in le&&(le.H=le.H%12+le.p*12),le.m===void 0&&(le.m="q"in le?le.q:0),"V"in le){if(le.V<1||le.V>53)return null;"w"in le||(le.w=1),"Z"in le?(ke=Lm(Su(le.y,0,1)),ve=ke.getUTCDay(),ke=ve>4||ve===0?Ph.ceil(ke):Ph(ke),ke=qp.offset(ke,(le.V-1)*7),le.y=ke.getUTCFullYear(),le.m=ke.getUTCMonth(),le.d=ke.getUTCDate()+(le.w+6)%7):(ke=Im(Su(le.y,0,1)),ve=ke.getDay(),ke=ve>4||ve===0?_h.ceil(ke):_h(ke),ke=ud.offset(ke,(le.V-1)*7),le.y=ke.getFullYear(),le.m=ke.getMonth(),le.d=ke.getDate()+(le.w+6)%7)}else("W"in le||"U"in le)&&("w"in le||(le.w="u"in le?le.u%7:"W"in le?1:0),ve="Z"in le?Lm(Su(le.y,0,1)).getUTCDay():Im(Su(le.y,0,1)).getDay(),le.m=0,le.d="W"in le?(le.w+6)%7+le.W*7-(ve+5)%7:le.w+le.U*7-(ve+6)%7);return"Z"in le?(le.H+=le.Z/100|0,le.M+=le.Z%100,Lm(le)):Im(le)}}function A(X,se,he,le){for(var je=0,ke=se.length,ve=he.length,ge,Me;je<ke;){if(le>=ve)return-1;if(ge=se.charCodeAt(je++),ge===37){if(ge=se.charAt(je++),Me=S[ge in wS?se.charAt(je++):ge],!Me||(le=Me(X,he,le))<0)return-1}else if(ge!=he.charCodeAt(le++))return-1}return le}function $(X,se,he){var le=u.exec(se.slice(he));return le?(X.p=f.get(le[0].toLowerCase()),he+le[0].length):-1}function E(X,se,he){var le=m.exec(se.slice(he));return le?(X.w=v.get(le[0].toLowerCase()),he+le[0].length):-1}function T(X,se,he){var le=d.exec(se.slice(he));return le?(X.w=p.get(le[0].toLowerCase()),he+le[0].length):-1}function B(X,se,he){var le=x.exec(se.slice(he));return le?(X.m=y.get(le[0].toLowerCase()),he+le[0].length):-1}function U(X,se,he){var le=b.exec(se.slice(he));return le?(X.m=k.get(le[0].toLowerCase()),he+le[0].length):-1}function V(X,se,he){return A(X,t,se,he)}function G(X,se,he){return A(X,r,se,he)}function D(X,se,he){return A(X,n,se,he)}function I(X){return o[X.getDay()]}function F(X){return i[X.getDay()]}function H(X){return l[X.getMonth()]}function W(X){return s[X.getMonth()]}function Q(X){return a[+(X.getHours()>=12)]}function q(X){return 1+~~(X.getMonth()/3)}function re(X){return o[X.getUTCDay()]}function ee(X){return i[X.getUTCDay()]}function fe(X){return l[X.getUTCMonth()]}function oe(X){return s[X.getUTCMonth()]}function ye(X){return a[+(X.getUTCHours()>=12)]}function ae(X){return 1+~~(X.getUTCMonth()/3)}return{format:function(X){var se=j(X+="",w);return se.toString=function(){return X},se},parse:function(X){var se=M(X+="",!1);return se.toString=function(){return X},se},utcFormat:function(X){var se=j(X+="",_);return se.toString=function(){return X},se},utcParse:function(X){var se=M(X+="",!0);return se.toString=function(){return X},se}}}var wS={"-":"",_:" ",0:"0"},Yn=/^\s*\d+/,OW=/^%/,AW=/[\\^$*+?|[\]().{}]/g;function vr(e,t,r){var n=e<0?"-":"",a=(n?-e:e)+"",i=a.length;return n+(i<r?new Array(r-i+1).join(t)+a:a)}function TW(e){return e.replace(AW,"\\$&")}function ju(e){return new RegExp("^(?:"+e.map(TW).join("|")+")","i")}function _u(e){return new Map(e.map((t,r)=>[t.toLowerCase(),r]))}function EW(e,t,r){var n=Yn.exec(t.slice(r,r+1));return n?(e.w=+n[0],r+n[0].length):-1}function $W(e,t,r){var n=Yn.exec(t.slice(r,r+1));return n?(e.u=+n[0],r+n[0].length):-1}function RW(e,t,r){var n=Yn.exec(t.slice(r,r+2));return n?(e.U=+n[0],r+n[0].length):-1}function DW(e,t,r){var n=Yn.exec(t.slice(r,r+2));return n?(e.V=+n[0],r+n[0].length):-1}function IW(e,t,r){var n=Yn.exec(t.slice(r,r+2));return n?(e.W=+n[0],r+n[0].length):-1}function kS(e,t,r){var n=Yn.exec(t.slice(r,r+4));return n?(e.y=+n[0],r+n[0].length):-1}function SS(e,t,r){var n=Yn.exec(t.slice(r,r+2));return n?(e.y=+n[0]+(+n[0]>68?1900:2e3),r+n[0].length):-1}function LW(e,t,r){var n=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(t.slice(r,r+6));return n?(e.Z=n[1]?0:-(n[2]+(n[3]||"00")),r+n[0].length):-1}function BW(e,t,r){var n=Yn.exec(t.slice(r,r+1));return n?(e.q=n[0]*3-3,r+n[0].length):-1}function FW(e,t,r){var n=Yn.exec(t.slice(r,r+2));return n?(e.m=n[0]-1,r+n[0].length):-1}function jS(e,t,r){var n=Yn.exec(t.slice(r,r+2));return n?(e.d=+n[0],r+n[0].length):-1}function UW(e,t,r){var n=Yn.exec(t.slice(r,r+3));return n?(e.m=0,e.d=+n[0],r+n[0].length):-1}function _S(e,t,r){var n=Yn.exec(t.slice(r,r+2));return n?(e.H=+n[0],r+n[0].length):-1}function GW(e,t,r){var n=Yn.exec(t.slice(r,r+2));return n?(e.M=+n[0],r+n[0].length):-1}function zW(e,t,r){var n=Yn.exec(t.slice(r,r+2));return n?(e.S=+n[0],r+n[0].length):-1}function WW(e,t,r){var n=Yn.exec(t.slice(r,r+3));return n?(e.L=+n[0],r+n[0].length):-1}function VW(e,t,r){var n=Yn.exec(t.slice(r,r+6));return n?(e.L=Math.floor(n[0]/1e3),r+n[0].length):-1}function HW(e,t,r){var n=OW.exec(t.slice(r,r+1));return n?r+n[0].length:-1}function XW(e,t,r){var n=Yn.exec(t.slice(r));return n?(e.Q=+n[0],r+n[0].length):-1}function KW(e,t,r){var n=Yn.exec(t.slice(r));return n?(e.s=+n[0],r+n[0].length):-1}function PS(e,t){return vr(e.getDate(),t,2)}function qW(e,t){return vr(e.getHours(),t,2)}function YW(e,t){return vr(e.getHours()%12||12,t,2)}function ZW(e,t){return vr(1+ud.count(jo(e),e),t,3)}function IP(e,t){return vr(e.getMilliseconds(),t,3)}function QW(e,t){return IP(e,t)+"000"}function JW(e,t){return vr(e.getMonth()+1,t,2)}function eV(e,t){return vr(e.getMinutes(),t,2)}function tV(e,t){return vr(e.getSeconds(),t,2)}function rV(e){var t=e.getDay();return t===0?7:t}function nV(e,t){return vr(Yp.count(jo(e)-1,e),t,2)}function LP(e){var t=e.getDay();return t>=4||t===0?wc(e):wc.ceil(e)}function aV(e,t){return e=LP(e),vr(wc.count(jo(e),e)+(jo(e).getDay()===4),t,2)}function iV(e){return e.getDay()}function oV(e,t){return vr(_h.count(jo(e)-1,e),t,2)}function sV(e,t){return vr(e.getFullYear()%100,t,2)}function lV(e,t){return e=LP(e),vr(e.getFullYear()%100,t,2)}function cV(e,t){return vr(e.getFullYear()%1e4,t,4)}function uV(e,t){var r=e.getDay();return e=r>=4||r===0?wc(e):wc.ceil(e),vr(e.getFullYear()%1e4,t,4)}function fV(e){var t=e.getTimezoneOffset();return(t>0?"-":(t*=-1,"+"))+vr(t/60|0,"0",2)+vr(t%60,"0",2)}function CS(e,t){return vr(e.getUTCDate(),t,2)}function dV(e,t){return vr(e.getUTCHours(),t,2)}function hV(e,t){return vr(e.getUTCHours()%12||12,t,2)}function pV(e,t){return vr(1+qp.count(_o(e),e),t,3)}function BP(e,t){return vr(e.getUTCMilliseconds(),t,3)}function gV(e,t){return BP(e,t)+"000"}function mV(e,t){return vr(e.getUTCMonth()+1,t,2)}function yV(e,t){return vr(e.getUTCMinutes(),t,2)}function vV(e,t){return vr(e.getUTCSeconds(),t,2)}function xV(e){var t=e.getUTCDay();return t===0?7:t}function bV(e,t){return vr(Zp.count(_o(e)-1,e),t,2)}function FP(e){var t=e.getUTCDay();return t>=4||t===0?kc(e):kc.ceil(e)}function wV(e,t){return e=FP(e),vr(kc.count(_o(e),e)+(_o(e).getUTCDay()===4),t,2)}function kV(e){return e.getUTCDay()}function SV(e,t){return vr(Ph.count(_o(e)-1,e),t,2)}function jV(e,t){return vr(e.getUTCFullYear()%100,t,2)}function _V(e,t){return e=FP(e),vr(e.getUTCFullYear()%100,t,2)}function PV(e,t){return vr(e.getUTCFullYear()%1e4,t,4)}function CV(e,t){var r=e.getUTCDay();return e=r>=4||r===0?kc(e):kc.ceil(e),vr(e.getUTCFullYear()%1e4,t,4)}function NV(){return"+0000"}function NS(){return"%"}function MS(e){return+e}function OS(e){return Math.floor(+e/1e3)}var Al,UP,GP;MV({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});function MV(e){return Al=MW(e),UP=Al.format,Al.parse,GP=Al.utcFormat,Al.utcParse,Al}function OV(e){return new Date(e)}function AV(e){return e instanceof Date?+e:+new Date(+e)}function jb(e,t,r,n,a,i,o,s,l,u){var f=ub(),d=f.invert,p=f.domain,m=u(".%L"),v=u(":%S"),b=u("%I:%M"),k=u("%I %p"),x=u("%a %d"),y=u("%b %d"),w=u("%B"),_=u("%Y");function S(j){return(l(j)<j?m:s(j)<j?v:o(j)<j?b:i(j)<j?k:n(j)<j?a(j)<j?x:y:r(j)<j?w:_)(j)}return f.invert=function(j){return new Date(d(j))},f.domain=function(j){return arguments.length?p(Array.from(j,AV)):p().map(OV)},f.ticks=function(j){var M=p();return e(M[0],M[M.length-1],j??10)},f.tickFormat=function(j,M){return M==null?S:u(M)},f.nice=function(j){var M=p();return(!j||typeof j.range!="function")&&(j=t(M[0],M[M.length-1],j??10)),j?p(NP(M,j)):f},f.copy=function(){return cd(f,jb(e,t,r,n,a,i,o,s,l,u))},f}function TV(){return gi.apply(jb(CW,NW,jo,kb,Yp,ud,bb,vb,Ws,UP).domain([new Date(2e3,0,1),new Date(2e3,0,2)]),arguments)}function EV(){return gi.apply(jb(_W,PW,_o,Sb,Zp,qp,wb,xb,Ws,GP).domain([Date.UTC(2e3,0,1),Date.UTC(2e3,0,2)]),arguments)}function Qp(){var e=0,t=1,r,n,a,i,o=wa,s=!1,l;function u(d){return d==null||isNaN(d=+d)?l:o(a===0?.5:(d=(i(d)-r)*a,s?Math.max(0,Math.min(1,d)):d))}u.domain=function(d){return arguments.length?([e,t]=d,r=i(e=+e),n=i(t=+t),a=r===n?0:1/(n-r),u):[e,t]},u.clamp=function(d){return arguments.length?(s=!!d,u):s},u.interpolator=function(d){return arguments.length?(o=d,u):o};function f(d){return function(p){var m,v;return arguments.length?([m,v]=p,o=d(m,v),u):[o(0),o(1)]}}return u.range=f(tu),u.rangeRound=f(cb),u.unknown=function(d){return arguments.length?(l=d,u):l},function(d){return i=d,r=d(e),n=d(t),a=r===n?0:1/(n-r),u}}function bs(e,t){return t.domain(e.domain()).interpolator(e.interpolator()).clamp(e.clamp()).unknown(e.unknown())}function zP(){var e=xs(Qp()(wa));return e.copy=function(){return bs(e,zP())},Mo.apply(e,arguments)}function WP(){var e=hb(Qp()).domain([1,10]);return e.copy=function(){return bs(e,WP()).base(e.base())},Mo.apply(e,arguments)}function VP(){var e=pb(Qp());return e.copy=function(){return bs(e,VP()).constant(e.constant())},Mo.apply(e,arguments)}function _b(){var e=gb(Qp());return e.copy=function(){return bs(e,_b()).exponent(e.exponent())},Mo.apply(e,arguments)}function $V(){return _b.apply(null,arguments).exponent(.5)}function HP(){var e=[],t=wa;function r(n){if(n!=null&&!isNaN(n=+n))return t((sd(e,n,1)-1)/(e.length-1))}return r.domain=function(n){if(!arguments.length)return e.slice();e=[];for(let a of n)a!=null&&!isNaN(a=+a)&&e.push(a);return e.sort(ls),r},r.interpolator=function(n){return arguments.length?(t=n,r):t},r.range=function(){return e.map((n,a)=>t(a/(e.length-1)))},r.quantiles=function(n){return Array.from({length:n+1},(a,i)=>bz(e,i/n))},r.copy=function(){return HP(t).domain(e)},Mo.apply(r,arguments)}function Jp(){var e=0,t=.5,r=1,n=1,a,i,o,s,l,u=wa,f,d=!1,p;function m(b){return isNaN(b=+b)?p:(b=.5+((b=+f(b))-i)*(n*b<n*i?s:l),u(d?Math.max(0,Math.min(1,b)):b))}m.domain=function(b){return arguments.length?([e,t,r]=b,a=f(e=+e),i=f(t=+t),o=f(r=+r),s=a===i?0:.5/(i-a),l=i===o?0:.5/(o-i),n=i<a?-1:1,m):[e,t,r]},m.clamp=function(b){return arguments.length?(d=!!b,m):d},m.interpolator=function(b){return arguments.length?(u=b,m):u};function v(b){return function(k){var x,y,w;return arguments.length?([x,y,w]=k,u=Hz(b,[x,y,w]),m):[u(0),u(.5),u(1)]}}return m.range=v(tu),m.rangeRound=v(cb),m.unknown=function(b){return arguments.length?(p=b,m):p},function(b){return f=b,a=b(e),i=b(t),o=b(r),s=a===i?0:.5/(i-a),l=i===o?0:.5/(o-i),n=i<a?-1:1,m}}function XP(){var e=xs(Jp()(wa));return e.copy=function(){return bs(e,XP())},Mo.apply(e,arguments)}function KP(){var e=hb(Jp()).domain([.1,1,10]);return e.copy=function(){return bs(e,KP()).base(e.base())},Mo.apply(e,arguments)}function qP(){var e=pb(Jp());return e.copy=function(){return bs(e,qP()).constant(e.constant())},Mo.apply(e,arguments)}function Pb(){var e=gb(Jp());return e.copy=function(){return bs(e,Pb()).exponent(e.exponent())},Mo.apply(e,arguments)}function RV(){return Pb.apply(null,arguments).exponent(.5)}const AS=Object.freeze(Object.defineProperty({__proto__:null,scaleBand:Pf,scaleDiverging:XP,scaleDivergingLog:KP,scaleDivergingPow:Pb,scaleDivergingSqrt:RV,scaleDivergingSymlog:qP,scaleIdentity:CP,scaleImplicit:Mv,scaleLinear:Sh,scaleLog:MP,scaleOrdinal:ob,scalePoint:Hu,scalePow:mb,scaleQuantile:TP,scaleQuantize:EP,scaleRadial:AP,scaleSequential:zP,scaleSequentialLog:WP,scaleSequentialPow:_b,scaleSequentialQuantile:HP,scaleSequentialSqrt:$V,scaleSequentialSymlog:VP,scaleSqrt:gW,scaleSymlog:OP,scaleThreshold:$P,scaleTime:TV,scaleUtc:EV,tickFormat:PP},Symbol.toStringTag,{value:"Module"}));var DV=Hc;function IV(e,t,r){for(var n=-1,a=e.length;++n<a;){var i=e[n],o=t(i);if(o!=null&&(s===void 0?o===o&&!DV(o):r(o,s)))var s=o,l=i}return l}var YP=IV;function LV(e,t){return e>t}var BV=LV,FV=YP,UV=BV,GV=eu;function zV(e){return e&&e.length?FV(e,GV,UV):void 0}var WV=zV;const Ko=Fr(WV);function VV(e,t){return e<t}var HV=VV,XV=YP,KV=HV,qV=eu;function YV(e){return e&&e.length?XV(e,qV,KV):void 0}var ZV=YV;const eg=Fr(ZV);var QV=F1,JV=ys,eH=oP,tH=Da;function rH(e,t){var r=tH(e)?QV:eH;return r(e,JV(t))}var nH=rH,aH=aP,iH=nH;function oH(e,t){return aH(iH(e,t),1)}var sH=oH;const lH=Fr(sH);var cH=eb;function uH(e,t){return cH(e,t)}var fH=uH;const dl=Fr(fH);var ru=1e9,dH={precision:20,rounding:4,toExpNeg:-7,toExpPos:21,LN10:"2.302585092994045684017991454684364207601101488628772976033327900967572609677352480235997205089598298341967784042286"},Nb,on=!0,hi="[DecimalError] ",Zs=hi+"Invalid argument: ",Cb=hi+"Exponent out of range: ",nu=Math.floor,Rs=Math.pow,hH=/^(\d+(\.\d*)?|\.\d+)(e[+-]?\d+)?$/i,za,Hn=1e7,Jr=7,ZP=9007199254740991,Ch=nu(ZP/Jr),qe={};qe.absoluteValue=qe.abs=function(){var e=new this.constructor(this);return e.s&&(e.s=1),e};qe.comparedTo=qe.cmp=function(e){var t,r,n,a,i=this;if(e=new i.constructor(e),i.s!==e.s)return i.s||-e.s;if(i.e!==e.e)return i.e>e.e^i.s<0?1:-1;for(n=i.d.length,a=e.d.length,t=0,r=n<a?n:a;t<r;++t)if(i.d[t]!==e.d[t])return i.d[t]>e.d[t]^i.s<0?1:-1;return n===a?0:n>a^i.s<0?1:-1};qe.decimalPlaces=qe.dp=function(){var e=this,t=e.d.length-1,r=(t-e.e)*Jr;if(t=e.d[t],t)for(;t%10==0;t/=10)r--;return r<0?0:r};qe.dividedBy=qe.div=function(e){return vo(this,new this.constructor(e))};qe.dividedToIntegerBy=qe.idiv=function(e){var t=this,r=t.constructor;return Br(vo(t,new r(e),0,1),r.precision)};qe.equals=qe.eq=function(e){return!this.cmp(e)};qe.exponent=function(){return Rn(this)};qe.greaterThan=qe.gt=function(e){return this.cmp(e)>0};qe.greaterThanOrEqualTo=qe.gte=function(e){return this.cmp(e)>=0};qe.isInteger=qe.isint=function(){return this.e>this.d.length-2};qe.isNegative=qe.isneg=function(){return this.s<0};qe.isPositive=qe.ispos=function(){return this.s>0};qe.isZero=function(){return this.s===0};qe.lessThan=qe.lt=function(e){return this.cmp(e)<0};qe.lessThanOrEqualTo=qe.lte=function(e){return this.cmp(e)<1};qe.logarithm=qe.log=function(e){var t,r=this,n=r.constructor,a=n.precision,i=a+5;if(e===void 0)e=new n(10);else if(e=new n(e),e.s<1||e.eq(za))throw Error(hi+"NaN");if(r.s<1)throw Error(hi+(r.s?"NaN":"-Infinity"));return r.eq(za)?new n(0):(on=!1,t=vo(Af(r,i),Af(e,i),i),on=!0,Br(t,a))};qe.minus=qe.sub=function(e){var t=this;return e=new t.constructor(e),t.s==e.s?eC(t,e):QP(t,(e.s=-e.s,e))};qe.modulo=qe.mod=function(e){var t,r=this,n=r.constructor,a=n.precision;if(e=new n(e),!e.s)throw Error(hi+"NaN");return r.s?(on=!1,t=vo(r,e,0,1).times(e),on=!0,r.minus(t)):Br(new n(r),a)};qe.naturalExponential=qe.exp=function(){return JP(this)};qe.naturalLogarithm=qe.ln=function(){return Af(this)};qe.negated=qe.neg=function(){var e=new this.constructor(this);return e.s=-e.s||0,e};qe.plus=qe.add=function(e){var t=this;return e=new t.constructor(e),t.s==e.s?QP(t,e):eC(t,(e.s=-e.s,e))};qe.precision=qe.sd=function(e){var t,r,n,a=this;if(e!==void 0&&e!==!!e&&e!==1&&e!==0)throw Error(Zs+e);if(t=Rn(a)+1,n=a.d.length-1,r=n*Jr+1,n=a.d[n],n){for(;n%10==0;n/=10)r--;for(n=a.d[0];n>=10;n/=10)r++}return e&&t>r?t:r};qe.squareRoot=qe.sqrt=function(){var e,t,r,n,a,i,o,s=this,l=s.constructor;if(s.s<1){if(!s.s)return new l(0);throw Error(hi+"NaN")}for(e=Rn(s),on=!1,a=Math.sqrt(+s),a==0||a==1/0?(t=Gi(s.d),(t.length+e)%2==0&&(t+="0"),a=Math.sqrt(t),e=nu((e+1)/2)-(e<0||e%2),a==1/0?t="5e"+e:(t=a.toExponential(),t=t.slice(0,t.indexOf("e")+1)+e),n=new l(t)):n=new l(a.toString()),r=l.precision,a=o=r+3;;)if(i=n,n=i.plus(vo(s,i,o+2)).times(.5),Gi(i.d).slice(0,o)===(t=Gi(n.d)).slice(0,o)){if(t=t.slice(o-3,o+1),a==o&&t=="4999"){if(Br(i,r+1,0),i.times(i).eq(s)){n=i;break}}else if(t!="9999")break;o+=4}return on=!0,Br(n,r)};qe.times=qe.mul=function(e){var t,r,n,a,i,o,s,l,u,f=this,d=f.constructor,p=f.d,m=(e=new d(e)).d;if(!f.s||!e.s)return new d(0);for(e.s*=f.s,r=f.e+e.e,l=p.length,u=m.length,l<u&&(i=p,p=m,m=i,o=l,l=u,u=o),i=[],o=l+u,n=o;n--;)i.push(0);for(n=u;--n>=0;){for(t=0,a=l+n;a>n;)s=i[a]+m[n]*p[a-n-1]+t,i[a--]=s%Hn|0,t=s/Hn|0;i[a]=(i[a]+t)%Hn|0}for(;!i[--o];)i.pop();return t?++r:i.shift(),e.d=i,e.e=r,on?Br(e,d.precision):e};qe.toDecimalPlaces=qe.todp=function(e,t){var r=this,n=r.constructor;return r=new n(r),e===void 0?r:(Qi(e,0,ru),t===void 0?t=n.rounding:Qi(t,0,8),Br(r,e+Rn(r)+1,t))};qe.toExponential=function(e,t){var r,n=this,a=n.constructor;return e===void 0?r=hl(n,!0):(Qi(e,0,ru),t===void 0?t=a.rounding:Qi(t,0,8),n=Br(new a(n),e+1,t),r=hl(n,!0,e+1)),r};qe.toFixed=function(e,t){var r,n,a=this,i=a.constructor;return e===void 0?hl(a):(Qi(e,0,ru),t===void 0?t=i.rounding:Qi(t,0,8),n=Br(new i(a),e+Rn(a)+1,t),r=hl(n.abs(),!1,e+Rn(n)+1),a.isneg()&&!a.isZero()?"-"+r:r)};qe.toInteger=qe.toint=function(){var e=this,t=e.constructor;return Br(new t(e),Rn(e)+1,t.rounding)};qe.toNumber=function(){return+this};qe.toPower=qe.pow=function(e){var t,r,n,a,i,o,s=this,l=s.constructor,u=12,f=+(e=new l(e));if(!e.s)return new l(za);if(s=new l(s),!s.s){if(e.s<1)throw Error(hi+"Infinity");return s}if(s.eq(za))return s;if(n=l.precision,e.eq(za))return Br(s,n);if(t=e.e,r=e.d.length-1,o=t>=r,i=s.s,o){if((r=f<0?-f:f)<=ZP){for(a=new l(za),t=Math.ceil(n/Jr+4),on=!1;r%2&&(a=a.times(s),ES(a.d,t)),r=nu(r/2),r!==0;)s=s.times(s),ES(s.d,t);return on=!0,e.s<0?new l(za).div(a):Br(a,n)}}else if(i<0)throw Error(hi+"NaN");return i=i<0&&e.d[Math.max(t,r)]&1?-1:1,s.s=1,on=!1,a=e.times(Af(s,n+u)),on=!0,a=JP(a),a.s=i,a};qe.toPrecision=function(e,t){var r,n,a=this,i=a.constructor;return e===void 0?(r=Rn(a),n=hl(a,r<=i.toExpNeg||r>=i.toExpPos)):(Qi(e,1,ru),t===void 0?t=i.rounding:Qi(t,0,8),a=Br(new i(a),e,t),r=Rn(a),n=hl(a,e<=r||r<=i.toExpNeg,e)),n};qe.toSignificantDigits=qe.tosd=function(e,t){var r=this,n=r.constructor;return e===void 0?(e=n.precision,t=n.rounding):(Qi(e,1,ru),t===void 0?t=n.rounding:Qi(t,0,8)),Br(new n(r),e,t)};qe.toString=qe.valueOf=qe.val=qe.toJSON=qe[Symbol.for("nodejs.util.inspect.custom")]=function(){var e=this,t=Rn(e),r=e.constructor;return hl(e,t<=r.toExpNeg||t>=r.toExpPos)};function QP(e,t){var r,n,a,i,o,s,l,u,f=e.constructor,d=f.precision;if(!e.s||!t.s)return t.s||(t=new f(e)),on?Br(t,d):t;if(l=e.d,u=t.d,o=e.e,a=t.e,l=l.slice(),i=o-a,i){for(i<0?(n=l,i=-i,s=u.length):(n=u,a=o,s=l.length),o=Math.ceil(d/Jr),s=o>s?o+1:s+1,i>s&&(i=s,n.length=1),n.reverse();i--;)n.push(0);n.reverse()}for(s=l.length,i=u.length,s-i<0&&(i=s,n=u,u=l,l=n),r=0;i;)r=(l[--i]=l[i]+u[i]+r)/Hn|0,l[i]%=Hn;for(r&&(l.unshift(r),++a),s=l.length;l[--s]==0;)l.pop();return t.d=l,t.e=a,on?Br(t,d):t}function Qi(e,t,r){if(e!==~~e||e<t||e>r)throw Error(Zs+e)}function Gi(e){var t,r,n,a=e.length-1,i="",o=e[0];if(a>0){for(i+=o,t=1;t<a;t++)n=e[t]+"",r=Jr-n.length,r&&(i+=Lo(r)),i+=n;o=e[t],n=o+"",r=Jr-n.length,r&&(i+=Lo(r))}else if(o===0)return"0";for(;o%10===0;)o/=10;return i+o}var vo=function(){function e(n,a){var i,o=0,s=n.length;for(n=n.slice();s--;)i=n[s]*a+o,n[s]=i%Hn|0,o=i/Hn|0;return o&&n.unshift(o),n}function t(n,a,i,o){var s,l;if(i!=o)l=i>o?1:-1;else for(s=l=0;s<i;s++)if(n[s]!=a[s]){l=n[s]>a[s]?1:-1;break}return l}function r(n,a,i){for(var o=0;i--;)n[i]-=o,o=n[i]<a[i]?1:0,n[i]=o*Hn+n[i]-a[i];for(;!n[0]&&n.length>1;)n.shift()}return function(n,a,i,o){var s,l,u,f,d,p,m,v,b,k,x,y,w,_,S,j,M,A,$=n.constructor,E=n.s==a.s?1:-1,T=n.d,B=a.d;if(!n.s)return new $(n);if(!a.s)throw Error(hi+"Division by zero");for(l=n.e-a.e,M=B.length,S=T.length,m=new $(E),v=m.d=[],u=0;B[u]==(T[u]||0);)++u;if(B[u]>(T[u]||0)&&--l,i==null?y=i=$.precision:o?y=i+(Rn(n)-Rn(a))+1:y=i,y<0)return new $(0);if(y=y/Jr+2|0,u=0,M==1)for(f=0,B=B[0],y++;(u<S||f)&&y--;u++)w=f*Hn+(T[u]||0),v[u]=w/B|0,f=w%B|0;else{for(f=Hn/(B[0]+1)|0,f>1&&(B=e(B,f),T=e(T,f),M=B.length,S=T.length),_=M,b=T.slice(0,M),k=b.length;k<M;)b[k++]=0;A=B.slice(),A.unshift(0),j=B[0],B[1]>=Hn/2&&++j;do f=0,s=t(B,b,M,k),s<0?(x=b[0],M!=k&&(x=x*Hn+(b[1]||0)),f=x/j|0,f>1?(f>=Hn&&(f=Hn-1),d=e(B,f),p=d.length,k=b.length,s=t(d,b,p,k),s==1&&(f--,r(d,M<p?A:B,p))):(f==0&&(s=f=1),d=B.slice()),p=d.length,p<k&&d.unshift(0),r(b,d,k),s==-1&&(k=b.length,s=t(B,b,M,k),s<1&&(f++,r(b,M<k?A:B,k))),k=b.length):s===0&&(f++,b=[0]),v[u++]=f,s&&b[0]?b[k++]=T[_]||0:(b=[T[_]],k=1);while((_++<S||b[0]!==void 0)&&y--)}return v[0]||v.shift(),m.e=l,Br(m,o?i+Rn(m)+1:i)}}();function JP(e,t){var r,n,a,i,o,s,l=0,u=0,f=e.constructor,d=f.precision;if(Rn(e)>16)throw Error(Cb+Rn(e));if(!e.s)return new f(za);for(on=!1,s=d,o=new f(.03125);e.abs().gte(.1);)e=e.times(o),u+=5;for(n=Math.log(Rs(2,u))/Math.LN10*2+5|0,s+=n,r=a=i=new f(za),f.precision=s;;){if(a=Br(a.times(e),s),r=r.times(++l),o=i.plus(vo(a,r,s)),Gi(o.d).slice(0,s)===Gi(i.d).slice(0,s)){for(;u--;)i=Br(i.times(i),s);return f.precision=d,t==null?(on=!0,Br(i,d)):i}i=o}}function Rn(e){for(var t=e.e*Jr,r=e.d[0];r>=10;r/=10)t++;return t}function Bm(e,t,r){if(t>e.LN10.sd())throw on=!0,r&&(e.precision=r),Error(hi+"LN10 precision limit exceeded");return Br(new e(e.LN10),t)}function Lo(e){for(var t="";e--;)t+="0";return t}function Af(e,t){var r,n,a,i,o,s,l,u,f,d=1,p=10,m=e,v=m.d,b=m.constructor,k=b.precision;if(m.s<1)throw Error(hi+(m.s?"NaN":"-Infinity"));if(m.eq(za))return new b(0);if(t==null?(on=!1,u=k):u=t,m.eq(10))return t==null&&(on=!0),Bm(b,u);if(u+=p,b.precision=u,r=Gi(v),n=r.charAt(0),i=Rn(m),Math.abs(i)<15e14){for(;n<7&&n!=1||n==1&&r.charAt(1)>3;)m=m.times(e),r=Gi(m.d),n=r.charAt(0),d++;i=Rn(m),n>1?(m=new b("0."+r),i++):m=new b(n+"."+r.slice(1))}else return l=Bm(b,u+2,k).times(i+""),m=Af(new b(n+"."+r.slice(1)),u-p).plus(l),b.precision=k,t==null?(on=!0,Br(m,k)):m;for(s=o=m=vo(m.minus(za),m.plus(za),u),f=Br(m.times(m),u),a=3;;){if(o=Br(o.times(f),u),l=s.plus(vo(o,new b(a),u)),Gi(l.d).slice(0,u)===Gi(s.d).slice(0,u))return s=s.times(2),i!==0&&(s=s.plus(Bm(b,u+2,k).times(i+""))),s=vo(s,new b(d),u),b.precision=k,t==null?(on=!0,Br(s,k)):s;s=l,a+=2}}function TS(e,t){var r,n,a;for((r=t.indexOf("."))>-1&&(t=t.replace(".","")),(n=t.search(/e/i))>0?(r<0&&(r=n),r+=+t.slice(n+1),t=t.substring(0,n)):r<0&&(r=t.length),n=0;t.charCodeAt(n)===48;)++n;for(a=t.length;t.charCodeAt(a-1)===48;)--a;if(t=t.slice(n,a),t){if(a-=n,r=r-n-1,e.e=nu(r/Jr),e.d=[],n=(r+1)%Jr,r<0&&(n+=Jr),n<a){for(n&&e.d.push(+t.slice(0,n)),a-=Jr;n<a;)e.d.push(+t.slice(n,n+=Jr));t=t.slice(n),n=Jr-t.length}else n-=a;for(;n--;)t+="0";if(e.d.push(+t),on&&(e.e>Ch||e.e<-Ch))throw Error(Cb+r)}else e.s=0,e.e=0,e.d=[0];return e}function Br(e,t,r){var n,a,i,o,s,l,u,f,d=e.d;for(o=1,i=d[0];i>=10;i/=10)o++;if(n=t-o,n<0)n+=Jr,a=t,u=d[f=0];else{if(f=Math.ceil((n+1)/Jr),i=d.length,f>=i)return e;for(u=i=d[f],o=1;i>=10;i/=10)o++;n%=Jr,a=n-Jr+o}if(r!==void 0&&(i=Rs(10,o-a-1),s=u/i%10|0,l=t<0||d[f+1]!==void 0||u%i,l=r<4?(s||l)&&(r==0||r==(e.s<0?3:2)):s>5||s==5&&(r==4||l||r==6&&(n>0?a>0?u/Rs(10,o-a):0:d[f-1])%10&1||r==(e.s<0?8:7))),t<1||!d[0])return l?(i=Rn(e),d.length=1,t=t-i-1,d[0]=Rs(10,(Jr-t%Jr)%Jr),e.e=nu(-t/Jr)||0):(d.length=1,d[0]=e.e=e.s=0),e;if(n==0?(d.length=f,i=1,f--):(d.length=f+1,i=Rs(10,Jr-n),d[f]=a>0?(u/Rs(10,o-a)%Rs(10,a)|0)*i:0),l)for(;;)if(f==0){(d[0]+=i)==Hn&&(d[0]=1,++e.e);break}else{if(d[f]+=i,d[f]!=Hn)break;d[f--]=0,i=1}for(n=d.length;d[--n]===0;)d.pop();if(on&&(e.e>Ch||e.e<-Ch))throw Error(Cb+Rn(e));return e}function eC(e,t){var r,n,a,i,o,s,l,u,f,d,p=e.constructor,m=p.precision;if(!e.s||!t.s)return t.s?t.s=-t.s:t=new p(e),on?Br(t,m):t;if(l=e.d,d=t.d,n=t.e,u=e.e,l=l.slice(),o=u-n,o){for(f=o<0,f?(r=l,o=-o,s=d.length):(r=d,n=u,s=l.length),a=Math.max(Math.ceil(m/Jr),s)+2,o>a&&(o=a,r.length=1),r.reverse(),a=o;a--;)r.push(0);r.reverse()}else{for(a=l.length,s=d.length,f=a<s,f&&(s=a),a=0;a<s;a++)if(l[a]!=d[a]){f=l[a]<d[a];break}o=0}for(f&&(r=l,l=d,d=r,t.s=-t.s),s=l.length,a=d.length-s;a>0;--a)l[s++]=0;for(a=d.length;a>o;){if(l[--a]<d[a]){for(i=a;i&&l[--i]===0;)l[i]=Hn-1;--l[i],l[a]+=Hn}l[a]-=d[a]}for(;l[--s]===0;)l.pop();for(;l[0]===0;l.shift())--n;return l[0]?(t.d=l,t.e=n,on?Br(t,m):t):new p(0)}function hl(e,t,r){var n,a=Rn(e),i=Gi(e.d),o=i.length;return t?(r&&(n=r-o)>0?i=i.charAt(0)+"."+i.slice(1)+Lo(n):o>1&&(i=i.charAt(0)+"."+i.slice(1)),i=i+(a<0?"e":"e+")+a):a<0?(i="0."+Lo(-a-1)+i,r&&(n=r-o)>0&&(i+=Lo(n))):a>=o?(i+=Lo(a+1-o),r&&(n=r-a-1)>0&&(i=i+"."+Lo(n))):((n=a+1)<o&&(i=i.slice(0,n)+"."+i.slice(n)),r&&(n=r-o)>0&&(a+1===o&&(i+="."),i+=Lo(n))),e.s<0?"-"+i:i}function ES(e,t){if(e.length>t)return e.length=t,!0}function tC(e){var t,r,n;function a(i){var o=this;if(!(o instanceof a))return new a(i);if(o.constructor=a,i instanceof a){o.s=i.s,o.e=i.e,o.d=(i=i.d)?i.slice():i;return}if(typeof i=="number"){if(i*0!==0)throw Error(Zs+i);if(i>0)o.s=1;else if(i<0)i=-i,o.s=-1;else{o.s=0,o.e=0,o.d=[0];return}if(i===~~i&&i<1e7){o.e=0,o.d=[i];return}return TS(o,i.toString())}else if(typeof i!="string")throw Error(Zs+i);if(i.charCodeAt(0)===45?(i=i.slice(1),o.s=-1):o.s=1,hH.test(i))TS(o,i);else throw Error(Zs+i)}if(a.prototype=qe,a.ROUND_UP=0,a.ROUND_DOWN=1,a.ROUND_CEIL=2,a.ROUND_FLOOR=3,a.ROUND_HALF_UP=4,a.ROUND_HALF_DOWN=5,a.ROUND_HALF_EVEN=6,a.ROUND_HALF_CEIL=7,a.ROUND_HALF_FLOOR=8,a.clone=tC,a.config=a.set=pH,e===void 0&&(e={}),e)for(n=["precision","rounding","toExpNeg","toExpPos","LN10"],t=0;t<n.length;)e.hasOwnProperty(r=n[t++])||(e[r]=this[r]);return a.config(e),a}function pH(e){if(!e||typeof e!="object")throw Error(hi+"Object expected");var t,r,n,a=["precision",1,ru,"rounding",0,8,"toExpNeg",-1/0,0,"toExpPos",0,1/0];for(t=0;t<a.length;t+=3)if((n=e[r=a[t]])!==void 0)if(nu(n)===n&&n>=a[t+1]&&n<=a[t+2])this[r]=n;else throw Error(Zs+r+": "+n);if((n=e[r="LN10"])!==void 0)if(n==Math.LN10)this[r]=new this(n);else throw Error(Zs+r+": "+n);return this}var Nb=tC(dH);za=new Nb(1);const Rr=Nb;function gH(e){return xH(e)||vH(e)||yH(e)||mH()}function mH(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function yH(e,t){if(e){if(typeof e=="string")return Ev(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Ev(e,t)}}function vH(e){if(typeof Symbol<"u"&&Symbol.iterator in Object(e))return Array.from(e)}function xH(e){if(Array.isArray(e))return Ev(e)}function Ev(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var bH=function(t){return t},rC={},nC=function(t){return t===rC},$S=function(t){return function r(){return arguments.length===0||arguments.length===1&&nC(arguments.length<=0?void 0:arguments[0])?r:t.apply(void 0,arguments)}},wH=function e(t,r){return t===1?r:$S(function(){for(var n=arguments.length,a=new Array(n),i=0;i<n;i++)a[i]=arguments[i];var o=a.filter(function(s){return s!==rC}).length;return o>=t?r.apply(void 0,a):e(t-o,$S(function(){for(var s=arguments.length,l=new Array(s),u=0;u<s;u++)l[u]=arguments[u];var f=a.map(function(d){return nC(d)?l.shift():d});return r.apply(void 0,gH(f).concat(l))}))})},tg=function(t){return wH(t.length,t)},$v=function(t,r){for(var n=[],a=t;a<r;++a)n[a-t]=a;return n},kH=tg(function(e,t){return Array.isArray(t)?t.map(e):Object.keys(t).map(function(r){return t[r]}).map(e)}),SH=function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];if(!r.length)return bH;var a=r.reverse(),i=a[0],o=a.slice(1);return function(){return o.reduce(function(s,l){return l(s)},i.apply(void 0,arguments))}},Rv=function(t){return Array.isArray(t)?t.reverse():t.split("").reverse.join("")},aC=function(t){var r=null,n=null;return function(){for(var a=arguments.length,i=new Array(a),o=0;o<a;o++)i[o]=arguments[o];return r&&i.every(function(s,l){return s===r[l]})||(r=i,n=t.apply(void 0,i)),n}};function jH(e){var t;return e===0?t=1:t=Math.floor(new Rr(e).abs().log(10).toNumber())+1,t}function _H(e,t,r){for(var n=new Rr(e),a=0,i=[];n.lt(t)&&a<1e5;)i.push(n.toNumber()),n=n.add(r),a++;return i}var PH=tg(function(e,t,r){var n=+e,a=+t;return n+r*(a-n)}),CH=tg(function(e,t,r){var n=t-+e;return n=n||1/0,(r-e)/n}),NH=tg(function(e,t,r){var n=t-+e;return n=n||1/0,Math.max(0,Math.min(1,(r-e)/n))});const rg={rangeStep:_H,getDigitCount:jH,interpolateNumber:PH,uninterpolateNumber:CH,uninterpolateTruncation:NH};function Dv(e){return AH(e)||OH(e)||iC(e)||MH()}function MH(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function OH(e){if(typeof Symbol<"u"&&Symbol.iterator in Object(e))return Array.from(e)}function AH(e){if(Array.isArray(e))return Iv(e)}function Tf(e,t){return $H(e)||EH(e,t)||iC(e,t)||TH()}function TH(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function iC(e,t){if(e){if(typeof e=="string")return Iv(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Iv(e,t)}}function Iv(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function EH(e,t){if(!(typeof Symbol>"u"||!(Symbol.iterator in Object(e)))){var r=[],n=!0,a=!1,i=void 0;try{for(var o=e[Symbol.iterator](),s;!(n=(s=o.next()).done)&&(r.push(s.value),!(t&&r.length===t));n=!0);}catch(l){a=!0,i=l}finally{try{!n&&o.return!=null&&o.return()}finally{if(a)throw i}}return r}}function $H(e){if(Array.isArray(e))return e}function oC(e){var t=Tf(e,2),r=t[0],n=t[1],a=r,i=n;return r>n&&(a=n,i=r),[a,i]}function sC(e,t,r){if(e.lte(0))return new Rr(0);var n=rg.getDigitCount(e.toNumber()),a=new Rr(10).pow(n),i=e.div(a),o=n!==1?.05:.1,s=new Rr(Math.ceil(i.div(o).toNumber())).add(r).mul(o),l=s.mul(a);return t?l:new Rr(Math.ceil(l))}function RH(e,t,r){var n=1,a=new Rr(e);if(!a.isint()&&r){var i=Math.abs(e);i<1?(n=new Rr(10).pow(rg.getDigitCount(e)-1),a=new Rr(Math.floor(a.div(n).toNumber())).mul(n)):i>1&&(a=new Rr(Math.floor(e)))}else e===0?a=new Rr(Math.floor((t-1)/2)):r||(a=new Rr(Math.floor(e)));var o=Math.floor((t-1)/2),s=SH(kH(function(l){return a.add(new Rr(l-o).mul(n)).toNumber()}),$v);return s(0,t)}function lC(e,t,r,n){var a=arguments.length>4&&arguments[4]!==void 0?arguments[4]:0;if(!Number.isFinite((t-e)/(r-1)))return{step:new Rr(0),tickMin:new Rr(0),tickMax:new Rr(0)};var i=sC(new Rr(t).sub(e).div(r-1),n,a),o;e<=0&&t>=0?o=new Rr(0):(o=new Rr(e).add(t).div(2),o=o.sub(new Rr(o).mod(i)));var s=Math.ceil(o.sub(e).div(i).toNumber()),l=Math.ceil(new Rr(t).sub(o).div(i).toNumber()),u=s+l+1;return u>r?lC(e,t,r,n,a+1):(u<r&&(l=t>0?l+(r-u):l,s=t>0?s:s+(r-u)),{step:i,tickMin:o.sub(new Rr(s).mul(i)),tickMax:o.add(new Rr(l).mul(i))})}function DH(e){var t=Tf(e,2),r=t[0],n=t[1],a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:6,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,o=Math.max(a,2),s=oC([r,n]),l=Tf(s,2),u=l[0],f=l[1];if(u===-1/0||f===1/0){var d=f===1/0?[u].concat(Dv($v(0,a-1).map(function(){return 1/0}))):[].concat(Dv($v(0,a-1).map(function(){return-1/0})),[f]);return r>n?Rv(d):d}if(u===f)return RH(u,a,i);var p=lC(u,f,o,i),m=p.step,v=p.tickMin,b=p.tickMax,k=rg.rangeStep(v,b.add(new Rr(.1).mul(m)),m);return r>n?Rv(k):k}function IH(e,t){var r=Tf(e,2),n=r[0],a=r[1],i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,o=oC([n,a]),s=Tf(o,2),l=s[0],u=s[1];if(l===-1/0||u===1/0)return[n,a];if(l===u)return[l];var f=Math.max(t,2),d=sC(new Rr(u).sub(l).div(f-1),i,0),p=[].concat(Dv(rg.rangeStep(new Rr(l),new Rr(u).sub(new Rr(.99).mul(d)),d)),[u]);return n>a?Rv(p):p}var LH=aC(DH),BH=aC(IH),FH="Invariant failed";function pl(e,t){throw new Error(FH)}var UH=["offset","layout","width","dataKey","data","dataPointFormatter","xAxis","yAxis"];function Sc(e){"@babel/helpers - typeof";return Sc=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Sc(e)}function Nh(){return Nh=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Nh.apply(this,arguments)}function GH(e,t){return HH(e)||VH(e,t)||WH(e,t)||zH()}function zH(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function WH(e,t){if(e){if(typeof e=="string")return RS(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return RS(e,t)}}function RS(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function VH(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,a,i,o,s=[],l=!0,u=!1;try{if(i=(r=r.call(e)).next,t!==0)for(;!(l=(n=i.call(r)).done)&&(s.push(n.value),s.length!==t);l=!0);}catch(f){u=!0,a=f}finally{try{if(!l&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(u)throw a}}return s}}function HH(e){if(Array.isArray(e))return e}function XH(e,t){if(e==null)return{};var r=KH(e,t),n,a;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function KH(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function qH(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function YH(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,fC(n.key),n)}}function ZH(e,t,r){return t&&YH(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function QH(e,t,r){return t=Mh(t),JH(e,cC()?Reflect.construct(t,r||[],Mh(e).constructor):t.apply(e,r))}function JH(e,t){if(t&&(Sc(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return eX(e)}function eX(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function cC(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(cC=function(){return!!e})()}function Mh(e){return Mh=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Mh(e)}function tX(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Lv(e,t)}function Lv(e,t){return Lv=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},Lv(e,t)}function uC(e,t,r){return t=fC(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function fC(e){var t=rX(e,"string");return Sc(t)=="symbol"?t:t+""}function rX(e,t){if(Sc(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(Sc(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var au=function(e){function t(){return qH(this,t),QH(this,t,arguments)}return tX(t,e),ZH(t,[{key:"render",value:function(){var n=this.props,a=n.offset,i=n.layout,o=n.width,s=n.dataKey,l=n.data,u=n.dataPointFormatter,f=n.xAxis,d=n.yAxis,p=XH(n,UH),m=At(p,!1);this.props.direction==="x"&&f.type!=="number"&&pl();var v=l.map(function(b){var k=u(b,s),x=k.x,y=k.y,w=k.value,_=k.errorVal;if(!_)return null;var S=[],j,M;if(Array.isArray(_)){var A=GH(_,2);j=A[0],M=A[1]}else j=M=_;if(i==="vertical"){var $=f.scale,E=y+a,T=E+o,B=E-o,U=$(w-j),V=$(w+M);S.push({x1:V,y1:T,x2:V,y2:B}),S.push({x1:U,y1:E,x2:V,y2:E}),S.push({x1:U,y1:T,x2:U,y2:B})}else if(i==="horizontal"){var G=d.scale,D=x+a,I=D-o,F=D+o,H=G(w-j),W=G(w+M);S.push({x1:I,y1:W,x2:F,y2:W}),S.push({x1:D,y1:H,x2:D,y2:W}),S.push({x1:I,y1:H,x2:F,y2:H})}return J.createElement(kr,Nh({className:"recharts-errorBar",key:"bar-".concat(S.map(function(Q){return"".concat(Q.x1,"-").concat(Q.x2,"-").concat(Q.y1,"-").concat(Q.y2)}))},m),S.map(function(Q){return J.createElement("line",Nh({},Q,{key:"line-".concat(Q.x1,"-").concat(Q.x2,"-").concat(Q.y1,"-").concat(Q.y2)}))}))});return J.createElement(kr,{className:"recharts-errorBars"},v)}}])}(J.Component);uC(au,"defaultProps",{stroke:"black",strokeWidth:1.5,width:5,offset:0,layout:"horizontal"});uC(au,"displayName","ErrorBar");function Ef(e){"@babel/helpers - typeof";return Ef=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ef(e)}function DS(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Os(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?DS(Object(r),!0).forEach(function(n){nX(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):DS(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function nX(e,t,r){return t=aX(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function aX(e){var t=iX(e,"string");return Ef(t)=="symbol"?t:t+""}function iX(e,t){if(Ef(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(Ef(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var dC=function(t){var r=t.children,n=t.formattedGraphicalItems,a=t.legendWidth,i=t.legendContent,o=Ga(r,Xi);if(!o)return null;var s=Xi.defaultProps,l=s!==void 0?Os(Os({},s),o.props):{},u;return o.props&&o.props.payload?u=o.props&&o.props.payload:i==="children"?u=(n||[]).reduce(function(f,d){var p=d.item,m=d.props,v=m.sectors||m.data||[];return f.concat(v.map(function(b){return{type:o.props.iconType||p.props.legendType,value:b.name,color:b.fill,payload:b}}))},[]):u=(n||[]).map(function(f){var d=f.item,p=d.type.defaultProps,m=p!==void 0?Os(Os({},p),d.props):{},v=m.dataKey,b=m.name,k=m.legendType,x=m.hide;return{inactive:x,dataKey:v,type:l.iconType||k||"square",color:Mb(d),value:b||v,payload:m}}),Os(Os(Os({},l),Xi.getWithHeight(o,a)),{},{payload:u,item:o})};function $f(e){"@babel/helpers - typeof";return $f=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},$f(e)}function IS(e){return cX(e)||lX(e)||sX(e)||oX()}function oX(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function sX(e,t){if(e){if(typeof e=="string")return Bv(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Bv(e,t)}}function lX(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function cX(e){if(Array.isArray(e))return Bv(e)}function Bv(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function LS(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function vn(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?LS(Object(r),!0).forEach(function(n){ic(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):LS(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function ic(e,t,r){return t=uX(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function uX(e){var t=fX(e,"string");return $f(t)=="symbol"?t:t+""}function fX(e,t){if($f(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if($f(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Wn(e,t,r){return Ot(e)||Ot(t)?r:zn(t)?ui(e,t,r):Rt(t)?t(e):r}function Xu(e,t,r,n){var a=lH(e,function(s){return Wn(s,t)});if(r==="number"){var i=a.filter(function(s){return $e(s)||parseFloat(s)});return i.length?[eg(i),Ko(i)]:[1/0,-1/0]}var o=n?a.filter(function(s){return!Ot(s)}):a;return o.map(function(s){return zn(s)||s instanceof Date?s:""})}var dX=function(t){var r,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],a=arguments.length>2?arguments[2]:void 0,i=arguments.length>3?arguments[3]:void 0,o=-1,s=(r=n==null?void 0:n.length)!==null&&r!==void 0?r:0;if(s<=1)return 0;if(i&&i.axisType==="angleAxis"&&Math.abs(Math.abs(i.range[1]-i.range[0])-360)<=1e-6)for(var l=i.range,u=0;u<s;u++){var f=u>0?a[u-1].coordinate:a[s-1].coordinate,d=a[u].coordinate,p=u>=s-1?a[0].coordinate:a[u+1].coordinate,m=void 0;if(Ci(d-f)!==Ci(p-d)){var v=[];if(Ci(p-d)===Ci(l[1]-l[0])){m=p;var b=d+l[1]-l[0];v[0]=Math.min(b,(b+f)/2),v[1]=Math.max(b,(b+f)/2)}else{m=f;var k=p+l[1]-l[0];v[0]=Math.min(d,(k+d)/2),v[1]=Math.max(d,(k+d)/2)}var x=[Math.min(d,(m+d)/2),Math.max(d,(m+d)/2)];if(t>x[0]&&t<=x[1]||t>=v[0]&&t<=v[1]){o=a[u].index;break}}else{var y=Math.min(f,p),w=Math.max(f,p);if(t>(y+d)/2&&t<=(w+d)/2){o=a[u].index;break}}}else for(var _=0;_<s;_++)if(_===0&&t<=(n[_].coordinate+n[_+1].coordinate)/2||_>0&&_<s-1&&t>(n[_].coordinate+n[_-1].coordinate)/2&&t<=(n[_].coordinate+n[_+1].coordinate)/2||_===s-1&&t>(n[_].coordinate+n[_-1].coordinate)/2){o=n[_].index;break}return o},Mb=function(t){var r,n=t,a=n.type.displayName,i=(r=t.type)!==null&&r!==void 0&&r.defaultProps?vn(vn({},t.type.defaultProps),t.props):t.props,o=i.stroke,s=i.fill,l;switch(a){case"Line":l=o;break;case"Area":case"Radar":l=o&&o!=="none"?o:s;break;default:l=s;break}return l},hX=function(t){var r=t.barSize,n=t.totalSize,a=t.stackGroups,i=a===void 0?{}:a;if(!i)return{};for(var o={},s=Object.keys(i),l=0,u=s.length;l<u;l++)for(var f=i[s[l]].stackGroups,d=Object.keys(f),p=0,m=d.length;p<m;p++){var v=f[d[p]],b=v.items,k=v.cateAxisId,x=b.filter(function(M){return mo(M.type).indexOf("Bar")>=0});if(x&&x.length){var y=x[0].type.defaultProps,w=y!==void 0?vn(vn({},y),x[0].props):x[0].props,_=w.barSize,S=w[k];o[S]||(o[S]=[]);var j=Ot(_)?r:_;o[S].push({item:x[0],stackList:x.slice(1),barSize:Ot(j)?void 0:fl(j,n,0)})}}return o},pX=function(t){var r=t.barGap,n=t.barCategoryGap,a=t.bandSize,i=t.sizeList,o=i===void 0?[]:i,s=t.maxBarSize,l=o.length;if(l<1)return null;var u=fl(r,a,0,!0),f,d=[];if(o[0].barSize===+o[0].barSize){var p=!1,m=a/l,v=o.reduce(function(_,S){return _+S.barSize||0},0);v+=(l-1)*u,v>=a&&(v-=(l-1)*u,u=0),v>=a&&m>0&&(p=!0,m*=.9,v=l*m);var b=(a-v)/2>>0,k={offset:b-u,size:0};f=o.reduce(function(_,S){var j={item:S.item,position:{offset:k.offset+k.size+u,size:p?m:S.barSize}},M=[].concat(IS(_),[j]);return k=M[M.length-1].position,S.stackList&&S.stackList.length&&S.stackList.forEach(function(A){M.push({item:A,position:k})}),M},d)}else{var x=fl(n,a,0,!0);a-2*x-(l-1)*u<=0&&(u=0);var y=(a-2*x-(l-1)*u)/l;y>1&&(y>>=0);var w=s===+s?Math.min(y,s):y;f=o.reduce(function(_,S,j){var M=[].concat(IS(_),[{item:S.item,position:{offset:x+(y+u)*j+(y-w)/2,size:w}}]);return S.stackList&&S.stackList.length&&S.stackList.forEach(function(A){M.push({item:A,position:M[M.length-1].position})}),M},d)}return f},gX=function(t,r,n,a){var i=n.children,o=n.width,s=n.margin,l=o-(s.left||0)-(s.right||0),u=dC({children:i,legendWidth:l});if(u){var f=a||{},d=f.width,p=f.height,m=u.align,v=u.verticalAlign,b=u.layout;if((b==="vertical"||b==="horizontal"&&v==="middle")&&m!=="center"&&$e(t[m]))return vn(vn({},t),{},ic({},m,t[m]+(d||0)));if((b==="horizontal"||b==="vertical"&&m==="center")&&v!=="middle"&&$e(t[v]))return vn(vn({},t),{},ic({},v,t[v]+(p||0)))}return t},mX=function(t,r,n){return Ot(r)?!0:t==="horizontal"?r==="yAxis":t==="vertical"||n==="x"?r==="xAxis":n==="y"?r==="yAxis":!0},hC=function(t,r,n,a,i){var o=r.props.children,s=Ra(o,au).filter(function(u){return mX(a,i,u.props.direction)});if(s&&s.length){var l=s.map(function(u){return u.props.dataKey});return t.reduce(function(u,f){var d=Wn(f,n);if(Ot(d))return u;var p=Array.isArray(d)?[eg(d),Ko(d)]:[d,d],m=l.reduce(function(v,b){var k=Wn(f,b,0),x=p[0]-Math.abs(Array.isArray(k)?k[0]:k),y=p[1]+Math.abs(Array.isArray(k)?k[1]:k);return[Math.min(x,v[0]),Math.max(y,v[1])]},[1/0,-1/0]);return[Math.min(m[0],u[0]),Math.max(m[1],u[1])]},[1/0,-1/0])}return null},yX=function(t,r,n,a,i){var o=r.map(function(s){return hC(t,s,n,i,a)}).filter(function(s){return!Ot(s)});return o&&o.length?o.reduce(function(s,l){return[Math.min(s[0],l[0]),Math.max(s[1],l[1])]},[1/0,-1/0]):null},pC=function(t,r,n,a,i){var o=r.map(function(l){var u=l.props.dataKey;return n==="number"&&u&&hC(t,l,u,a)||Xu(t,u,n,i)});if(n==="number")return o.reduce(function(l,u){return[Math.min(l[0],u[0]),Math.max(l[1],u[1])]},[1/0,-1/0]);var s={};return o.reduce(function(l,u){for(var f=0,d=u.length;f<d;f++)s[u[f]]||(s[u[f]]=!0,l.push(u[f]));return l},[])},gC=function(t,r){return t==="horizontal"&&r==="xAxis"||t==="vertical"&&r==="yAxis"||t==="centric"&&r==="angleAxis"||t==="radial"&&r==="radiusAxis"},mC=function(t,r,n,a){if(a)return t.map(function(l){return l.coordinate});var i,o,s=t.map(function(l){return l.coordinate===r&&(i=!0),l.coordinate===n&&(o=!0),l.coordinate});return i||s.push(r),o||s.push(n),s},po=function(t,r,n){if(!t)return null;var a=t.scale,i=t.duplicateDomain,o=t.type,s=t.range,l=t.realScaleType==="scaleBand"?a.bandwidth()/2:2,u=(r||n)&&o==="category"&&a.bandwidth?a.bandwidth()/l:0;if(u=t.axisType==="angleAxis"&&(s==null?void 0:s.length)>=2?Ci(s[0]-s[1])*2*u:u,r&&(t.ticks||t.niceTicks)){var f=(t.ticks||t.niceTicks).map(function(d){var p=i?i.indexOf(d):d;return{coordinate:a(p)+u,value:d,offset:u}});return f.filter(function(d){return!Zc(d.coordinate)})}return t.isCategorical&&t.categoricalDomain?t.categoricalDomain.map(function(d,p){return{coordinate:a(d)+u,value:d,index:p,offset:u}}):a.ticks&&!n?a.ticks(t.tickCount).map(function(d){return{coordinate:a(d)+u,value:d,offset:u}}):a.domain().map(function(d,p){return{coordinate:a(d)+u,value:i?i[d]:d,index:p,offset:u}})},Fm=new WeakMap,r0=function(t,r){if(typeof r!="function")return t;Fm.has(t)||Fm.set(t,new WeakMap);var n=Fm.get(t);if(n.has(r))return n.get(r);var a=function(){t.apply(void 0,arguments),r.apply(void 0,arguments)};return n.set(r,a),a},vX=function(t,r,n){var a=t.scale,i=t.type,o=t.layout,s=t.axisType;if(a==="auto")return o==="radial"&&s==="radiusAxis"?{scale:Pf(),realScaleType:"band"}:o==="radial"&&s==="angleAxis"?{scale:Sh(),realScaleType:"linear"}:i==="category"&&r&&(r.indexOf("LineChart")>=0||r.indexOf("AreaChart")>=0||r.indexOf("ComposedChart")>=0&&!n)?{scale:Hu(),realScaleType:"point"}:i==="category"?{scale:Pf(),realScaleType:"band"}:{scale:Sh(),realScaleType:"linear"};if(ul(a)){var l="scale".concat(Fp(a));return{scale:(AS[l]||Hu)(),realScaleType:AS[l]?l:"point"}}return Rt(a)?{scale:a}:{scale:Hu(),realScaleType:"point"}},BS=1e-4,xX=function(t){var r=t.domain();if(!(!r||r.length<=2)){var n=r.length,a=t.range(),i=Math.min(a[0],a[1])-BS,o=Math.max(a[0],a[1])+BS,s=t(r[0]),l=t(r[n-1]);(s<i||s>o||l<i||l>o)&&t.domain([r[0],r[n-1]])}},bX=function(t,r){if(!t)return null;for(var n=0,a=t.length;n<a;n++)if(t[n].item===r)return t[n].position;return null},wX=function(t,r){if(!r||r.length!==2||!$e(r[0])||!$e(r[1]))return t;var n=Math.min(r[0],r[1]),a=Math.max(r[0],r[1]),i=[t[0],t[1]];return(!$e(t[0])||t[0]<n)&&(i[0]=n),(!$e(t[1])||t[1]>a)&&(i[1]=a),i[0]>a&&(i[0]=a),i[1]<n&&(i[1]=n),i},kX=function(t){var r=t.length;if(!(r<=0))for(var n=0,a=t[0].length;n<a;++n)for(var i=0,o=0,s=0;s<r;++s){var l=Zc(t[s][n][1])?t[s][n][0]:t[s][n][1];l>=0?(t[s][n][0]=i,t[s][n][1]=i+l,i=t[s][n][1]):(t[s][n][0]=o,t[s][n][1]=o+l,o=t[s][n][1])}},SX=function(t){var r=t.length;if(!(r<=0))for(var n=0,a=t[0].length;n<a;++n)for(var i=0,o=0;o<r;++o){var s=Zc(t[o][n][1])?t[o][n][0]:t[o][n][1];s>=0?(t[o][n][0]=i,t[o][n][1]=i+s,i=t[o][n][1]):(t[o][n][0]=0,t[o][n][1]=0)}},jX={sign:kX,expand:B7,none:gc,silhouette:F7,wiggle:U7,positive:SX},_X=function(t,r,n){var a=r.map(function(s){return s.props.dataKey}),i=jX[n],o=L7().keys(a).value(function(s,l){return+Wn(s,l,0)}).order(uv).offset(i);return o(t)},PX=function(t,r,n,a,i,o){if(!t)return null;var s=o?r.reverse():r,l={},u=s.reduce(function(d,p){var m,v=(m=p.type)!==null&&m!==void 0&&m.defaultProps?vn(vn({},p.type.defaultProps),p.props):p.props,b=v.stackId,k=v.hide;if(k)return d;var x=v[n],y=d[x]||{hasStack:!1,stackGroups:{}};if(zn(b)){var w=y.stackGroups[b]||{numericAxisId:n,cateAxisId:a,items:[]};w.items.push(p),y.hasStack=!0,y.stackGroups[b]=w}else y.stackGroups[bl("_stackId_")]={numericAxisId:n,cateAxisId:a,items:[p]};return vn(vn({},d),{},ic({},x,y))},l),f={};return Object.keys(u).reduce(function(d,p){var m=u[p];if(m.hasStack){var v={};m.stackGroups=Object.keys(m.stackGroups).reduce(function(b,k){var x=m.stackGroups[k];return vn(vn({},b),{},ic({},k,{numericAxisId:n,cateAxisId:a,items:x.items,stackedData:_X(t,x.items,i)}))},v)}return vn(vn({},d),{},ic({},p,m))},f)},CX=function(t,r){var n=r.realScaleType,a=r.type,i=r.tickCount,o=r.originalDomain,s=r.allowDecimals,l=n||r.scale;if(l!=="auto"&&l!=="linear")return null;if(i&&a==="number"&&o&&(o[0]==="auto"||o[1]==="auto")){var u=t.domain();if(!u.length)return null;var f=LH(u,i,s);return t.domain([eg(f),Ko(f)]),{niceTicks:f}}if(i&&a==="number"){var d=t.domain(),p=BH(d,i,s);return{niceTicks:p}}return null};function jc(e){var t=e.axis,r=e.ticks,n=e.bandSize,a=e.entry,i=e.index,o=e.dataKey;if(t.type==="category"){if(!t.allowDuplicatedCategory&&t.dataKey&&!Ot(a[t.dataKey])){var s=eh(r,"value",a[t.dataKey]);if(s)return s.coordinate+n/2}return r[i]?r[i].coordinate+n/2:null}var l=Wn(a,Ot(o)?t.dataKey:o);return Ot(l)?null:t.scale(l)}var FS=function(t){var r=t.axis,n=t.ticks,a=t.offset,i=t.bandSize,o=t.entry,s=t.index;if(r.type==="category")return n[s]?n[s].coordinate+a:null;var l=Wn(o,r.dataKey,r.domain[s]);return Ot(l)?null:r.scale(l)-i/2+a},NX=function(t){var r=t.numericAxis,n=r.scale.domain();if(r.type==="number"){var a=Math.min(n[0],n[1]),i=Math.max(n[0],n[1]);return a<=0&&i>=0?0:i<0?i:a}return n[0]},MX=function(t,r){var n,a=(n=t.type)!==null&&n!==void 0&&n.defaultProps?vn(vn({},t.type.defaultProps),t.props):t.props,i=a.stackId;if(zn(i)){var o=r[i];if(o){var s=o.items.indexOf(t);return s>=0?o.stackedData[s]:null}}return null},OX=function(t){return t.reduce(function(r,n){return[eg(n.concat([r[0]]).filter($e)),Ko(n.concat([r[1]]).filter($e))]},[1/0,-1/0])},yC=function(t,r,n){return Object.keys(t).reduce(function(a,i){var o=t[i],s=o.stackedData,l=s.reduce(function(u,f){var d=OX(f.slice(r,n+1));return[Math.min(u[0],d[0]),Math.max(u[1],d[1])]},[1/0,-1/0]);return[Math.min(l[0],a[0]),Math.max(l[1],a[1])]},[1/0,-1/0]).map(function(a){return a===1/0||a===-1/0?0:a})},US=/^dataMin[\s]*-[\s]*([0-9]+([.]{1}[0-9]+){0,1})$/,GS=/^dataMax[\s]*\+[\s]*([0-9]+([.]{1}[0-9]+){0,1})$/,Fv=function(t,r,n){if(Rt(t))return t(r,n);if(!Array.isArray(t))return r;var a=[];if($e(t[0]))a[0]=n?t[0]:Math.min(t[0],r[0]);else if(US.test(t[0])){var i=+US.exec(t[0])[1];a[0]=r[0]-i}else Rt(t[0])?a[0]=t[0](r[0]):a[0]=r[0];if($e(t[1]))a[1]=n?t[1]:Math.max(t[1],r[1]);else if(GS.test(t[1])){var o=+GS.exec(t[1])[1];a[1]=r[1]+o}else Rt(t[1])?a[1]=t[1](r[1]):a[1]=r[1];return a},Oh=function(t,r,n){if(t&&t.scale&&t.scale.bandwidth){var a=t.scale.bandwidth();if(!n||a>0)return a}if(t&&r&&r.length>=2){for(var i=rb(r,function(d){return d.coordinate}),o=1/0,s=1,l=i.length;s<l;s++){var u=i[s],f=i[s-1];o=Math.min((u.coordinate||0)-(f.coordinate||0),o)}return o===1/0?0:o}return n?void 0:0},zS=function(t,r,n){return!t||!t.length||dl(t,ui(n,"type.defaultProps.domain"))?r:t},vC=function(t,r){var n=t.type.defaultProps?vn(vn({},t.type.defaultProps),t.props):t.props,a=n.dataKey,i=n.name,o=n.unit,s=n.formatter,l=n.tooltipType,u=n.chartType,f=n.hide;return vn(vn({},At(t,!1)),{},{dataKey:a,unit:o,formatter:s,name:i||a,color:Mb(t),value:Wn(r,a),type:l,payload:r,chartType:u,hide:f})};function Rf(e){"@babel/helpers - typeof";return Rf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Rf(e)}function WS(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function VS(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?WS(Object(r),!0).forEach(function(n){AX(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):WS(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function AX(e,t,r){return t=TX(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function TX(e){var t=EX(e,"string");return Rf(t)=="symbol"?t:t+""}function EX(e,t){if(Rf(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(Rf(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Ah=Math.PI/180,$X=function(t){return t*180/Math.PI},oa=function(t,r,n,a){return{x:t+Math.cos(-Ah*a)*n,y:r+Math.sin(-Ah*a)*n}},RX=function(t,r){var n=t.x,a=t.y,i=r.x,o=r.y;return Math.sqrt(Math.pow(n-i,2)+Math.pow(a-o,2))},DX=function(t,r){var n=t.x,a=t.y,i=r.cx,o=r.cy,s=RX({x:n,y:a},{x:i,y:o});if(s<=0)return{radius:s};var l=(n-i)/s,u=Math.acos(l);return a>o&&(u=2*Math.PI-u),{radius:s,angle:$X(u),angleInRadian:u}},IX=function(t){var r=t.startAngle,n=t.endAngle,a=Math.floor(r/360),i=Math.floor(n/360),o=Math.min(a,i);return{startAngle:r-o*360,endAngle:n-o*360}},LX=function(t,r){var n=r.startAngle,a=r.endAngle,i=Math.floor(n/360),o=Math.floor(a/360),s=Math.min(i,o);return t+s*360},HS=function(t,r){var n=t.x,a=t.y,i=DX({x:n,y:a},r),o=i.radius,s=i.angle,l=r.innerRadius,u=r.outerRadius;if(o<l||o>u)return!1;if(o===0)return!0;var f=IX(r),d=f.startAngle,p=f.endAngle,m=s,v;if(d<=p){for(;m>p;)m-=360;for(;m<d;)m+=360;v=m>=d&&m<=p}else{for(;m>d;)m-=360;for(;m<p;)m+=360;v=m>=p&&m<=d}return v?VS(VS({},r),{},{radius:o,angle:LX(m,r)}):null};function Df(e){"@babel/helpers - typeof";return Df=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Df(e)}var BX=["offset"];function FX(e){return WX(e)||zX(e)||GX(e)||UX()}function UX(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function GX(e,t){if(e){if(typeof e=="string")return Uv(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Uv(e,t)}}function zX(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function WX(e){if(Array.isArray(e))return Uv(e)}function Uv(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function VX(e,t){if(e==null)return{};var r=HX(e,t),n,a;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function HX(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function XS(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Bn(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?XS(Object(r),!0).forEach(function(n){XX(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):XS(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function XX(e,t,r){return t=KX(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function KX(e){var t=qX(e,"string");return Df(t)=="symbol"?t:t+""}function qX(e,t){if(Df(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(Df(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function If(){return If=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},If.apply(this,arguments)}var YX=function(t){var r=t.value,n=t.formatter,a=Ot(t.children)?r:t.children;return Rt(n)?n(a):a},ZX=function(t,r){var n=Ci(r-t),a=Math.min(Math.abs(r-t),360);return n*a},QX=function(t,r,n){var a=t.position,i=t.viewBox,o=t.offset,s=t.className,l=i,u=l.cx,f=l.cy,d=l.innerRadius,p=l.outerRadius,m=l.startAngle,v=l.endAngle,b=l.clockWise,k=(d+p)/2,x=ZX(m,v),y=x>=0?1:-1,w,_;a==="insideStart"?(w=m+y*o,_=b):a==="insideEnd"?(w=v-y*o,_=!b):a==="end"&&(w=v+y*o,_=b),_=x<=0?_:!_;var S=oa(u,f,k,w),j=oa(u,f,k,w+(_?1:-1)*359),M="M".concat(S.x,",").concat(S.y,`
    A`).concat(k,",").concat(k,",0,1,").concat(_?0:1,`,
    `).concat(j.x,",").concat(j.y),A=Ot(t.id)?bl("recharts-radial-line-"):t.id;return J.createElement("text",If({},n,{dominantBaseline:"central",className:lr("recharts-radial-bar-label",s)}),J.createElement("defs",null,J.createElement("path",{id:A,d:M})),J.createElement("textPath",{xlinkHref:"#".concat(A)},r))},JX=function(t){var r=t.viewBox,n=t.offset,a=t.position,i=r,o=i.cx,s=i.cy,l=i.innerRadius,u=i.outerRadius,f=i.startAngle,d=i.endAngle,p=(f+d)/2;if(a==="outside"){var m=oa(o,s,u+n,p),v=m.x,b=m.y;return{x:v,y:b,textAnchor:v>=o?"start":"end",verticalAnchor:"middle"}}if(a==="center")return{x:o,y:s,textAnchor:"middle",verticalAnchor:"middle"};if(a==="centerTop")return{x:o,y:s,textAnchor:"middle",verticalAnchor:"start"};if(a==="centerBottom")return{x:o,y:s,textAnchor:"middle",verticalAnchor:"end"};var k=(l+u)/2,x=oa(o,s,k,p),y=x.x,w=x.y;return{x:y,y:w,textAnchor:"middle",verticalAnchor:"middle"}},eK=function(t){var r=t.viewBox,n=t.parentViewBox,a=t.offset,i=t.position,o=r,s=o.x,l=o.y,u=o.width,f=o.height,d=f>=0?1:-1,p=d*a,m=d>0?"end":"start",v=d>0?"start":"end",b=u>=0?1:-1,k=b*a,x=b>0?"end":"start",y=b>0?"start":"end";if(i==="top"){var w={x:s+u/2,y:l-d*a,textAnchor:"middle",verticalAnchor:m};return Bn(Bn({},w),n?{height:Math.max(l-n.y,0),width:u}:{})}if(i==="bottom"){var _={x:s+u/2,y:l+f+p,textAnchor:"middle",verticalAnchor:v};return Bn(Bn({},_),n?{height:Math.max(n.y+n.height-(l+f),0),width:u}:{})}if(i==="left"){var S={x:s-k,y:l+f/2,textAnchor:x,verticalAnchor:"middle"};return Bn(Bn({},S),n?{width:Math.max(S.x-n.x,0),height:f}:{})}if(i==="right"){var j={x:s+u+k,y:l+f/2,textAnchor:y,verticalAnchor:"middle"};return Bn(Bn({},j),n?{width:Math.max(n.x+n.width-j.x,0),height:f}:{})}var M=n?{width:u,height:f}:{};return i==="insideLeft"?Bn({x:s+k,y:l+f/2,textAnchor:y,verticalAnchor:"middle"},M):i==="insideRight"?Bn({x:s+u-k,y:l+f/2,textAnchor:x,verticalAnchor:"middle"},M):i==="insideTop"?Bn({x:s+u/2,y:l+p,textAnchor:"middle",verticalAnchor:v},M):i==="insideBottom"?Bn({x:s+u/2,y:l+f-p,textAnchor:"middle",verticalAnchor:m},M):i==="insideTopLeft"?Bn({x:s+k,y:l+p,textAnchor:y,verticalAnchor:v},M):i==="insideTopRight"?Bn({x:s+u-k,y:l+p,textAnchor:x,verticalAnchor:v},M):i==="insideBottomLeft"?Bn({x:s+k,y:l+f-p,textAnchor:y,verticalAnchor:m},M):i==="insideBottomRight"?Bn({x:s+u-k,y:l+f-p,textAnchor:x,verticalAnchor:m},M):Xc(i)&&($e(i.x)||Gs(i.x))&&($e(i.y)||Gs(i.y))?Bn({x:s+fl(i.x,u),y:l+fl(i.y,f),textAnchor:"end",verticalAnchor:"end"},M):Bn({x:s+u/2,y:l+f/2,textAnchor:"middle",verticalAnchor:"middle"},M)},tK=function(t){return"cx"in t&&$e(t.cx)};function ia(e){var t=e.offset,r=t===void 0?5:t,n=VX(e,BX),a=Bn({offset:r},n),i=a.viewBox,o=a.position,s=a.value,l=a.children,u=a.content,f=a.className,d=f===void 0?"":f,p=a.textBreakAll;if(!i||Ot(s)&&Ot(l)&&!C.isValidElement(u)&&!Rt(u))return null;if(C.isValidElement(u))return C.cloneElement(u,a);var m;if(Rt(u)){if(m=C.createElement(u,a),C.isValidElement(m))return m}else m=YX(a);var v=tK(i),b=At(a,!0);if(v&&(o==="insideStart"||o==="insideEnd"||o==="end"))return QX(a,m,b);var k=v?JX(a):eK(a);return J.createElement(gh,If({className:lr("recharts-label",d)},b,k,{breakAll:p}),m)}ia.displayName="Label";var xC=function(t){var r=t.cx,n=t.cy,a=t.angle,i=t.startAngle,o=t.endAngle,s=t.r,l=t.radius,u=t.innerRadius,f=t.outerRadius,d=t.x,p=t.y,m=t.top,v=t.left,b=t.width,k=t.height,x=t.clockWise,y=t.labelViewBox;if(y)return y;if($e(b)&&$e(k)){if($e(d)&&$e(p))return{x:d,y:p,width:b,height:k};if($e(m)&&$e(v))return{x:m,y:v,width:b,height:k}}return $e(d)&&$e(p)?{x:d,y:p,width:0,height:0}:$e(r)&&$e(n)?{cx:r,cy:n,startAngle:i||a||0,endAngle:o||a||0,innerRadius:u||0,outerRadius:f||l||s||0,clockWise:x}:t.viewBox?t.viewBox:{}},rK=function(t,r){return t?t===!0?J.createElement(ia,{key:"label-implicit",viewBox:r}):zn(t)?J.createElement(ia,{key:"label-implicit",viewBox:r,value:t}):C.isValidElement(t)?t.type===ia?C.cloneElement(t,{key:"label-implicit",viewBox:r}):J.createElement(ia,{key:"label-implicit",content:t,viewBox:r}):Rt(t)?J.createElement(ia,{key:"label-implicit",content:t,viewBox:r}):Xc(t)?J.createElement(ia,If({viewBox:r},t,{key:"label-implicit"})):null:null},nK=function(t,r){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;if(!t||!t.children&&n&&!t.label)return null;var a=t.children,i=xC(t),o=Ra(a,ia).map(function(l,u){return C.cloneElement(l,{viewBox:r||i,key:"label-".concat(u)})});if(!n)return o;var s=rK(t.label,r||i);return[s].concat(FX(o))};ia.parseViewBox=xC;ia.renderCallByParent=nK;function aK(e){var t=e==null?0:e.length;return t?e[t-1]:void 0}var iK=aK;const oK=Fr(iK);function Lf(e){"@babel/helpers - typeof";return Lf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Lf(e)}var sK=["valueAccessor"],lK=["data","dataKey","clockWise","id","textBreakAll"];function cK(e){return hK(e)||dK(e)||fK(e)||uK()}function uK(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function fK(e,t){if(e){if(typeof e=="string")return Gv(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Gv(e,t)}}function dK(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function hK(e){if(Array.isArray(e))return Gv(e)}function Gv(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Th(){return Th=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Th.apply(this,arguments)}function KS(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function qS(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?KS(Object(r),!0).forEach(function(n){pK(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):KS(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function pK(e,t,r){return t=gK(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function gK(e){var t=mK(e,"string");return Lf(t)=="symbol"?t:t+""}function mK(e,t){if(Lf(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(Lf(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function YS(e,t){if(e==null)return{};var r=yK(e,t),n,a;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function yK(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}var vK=function(t){return Array.isArray(t.value)?oK(t.value):t.value};function qi(e){var t=e.valueAccessor,r=t===void 0?vK:t,n=YS(e,sK),a=n.data,i=n.dataKey,o=n.clockWise,s=n.id,l=n.textBreakAll,u=YS(n,lK);return!a||!a.length?null:J.createElement(kr,{className:"recharts-label-list"},a.map(function(f,d){var p=Ot(i)?r(f,d):Wn(f&&f.payload,i),m=Ot(s)?{}:{id:"".concat(s,"-").concat(d)};return J.createElement(ia,Th({},At(f,!0),u,m,{parentViewBox:f.parentViewBox,value:p,textBreakAll:l,viewBox:ia.parseViewBox(Ot(o)?f:qS(qS({},f),{},{clockWise:o})),key:"label-".concat(d),index:d}))}))}qi.displayName="LabelList";function xK(e,t){return e?e===!0?J.createElement(qi,{key:"labelList-implicit",data:t}):J.isValidElement(e)||Rt(e)?J.createElement(qi,{key:"labelList-implicit",data:t,content:e}):Xc(e)?J.createElement(qi,Th({data:t},e,{key:"labelList-implicit"})):null:null}function bK(e,t){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;if(!e||!e.children&&r&&!e.label)return null;var n=e.children,a=Ra(n,qi).map(function(o,s){return C.cloneElement(o,{data:t,key:"labelList-".concat(s)})});if(!r)return a;var i=xK(e.label,t);return[i].concat(cK(a))}qi.renderCallByParent=bK;function Bf(e){"@babel/helpers - typeof";return Bf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Bf(e)}function zv(){return zv=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},zv.apply(this,arguments)}function ZS(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function QS(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?ZS(Object(r),!0).forEach(function(n){wK(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ZS(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function wK(e,t,r){return t=kK(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function kK(e){var t=SK(e,"string");return Bf(t)=="symbol"?t:t+""}function SK(e,t){if(Bf(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(Bf(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var jK=function(t,r){var n=Ci(r-t),a=Math.min(Math.abs(r-t),359.999);return n*a},n0=function(t){var r=t.cx,n=t.cy,a=t.radius,i=t.angle,o=t.sign,s=t.isExternal,l=t.cornerRadius,u=t.cornerIsExternal,f=l*(s?1:-1)+a,d=Math.asin(l/f)/Ah,p=u?i:i+o*d,m=oa(r,n,f,p),v=oa(r,n,a,p),b=u?i-o*d:i,k=oa(r,n,f*Math.cos(d*Ah),b);return{center:m,circleTangency:v,lineTangency:k,theta:d}},bC=function(t){var r=t.cx,n=t.cy,a=t.innerRadius,i=t.outerRadius,o=t.startAngle,s=t.endAngle,l=jK(o,s),u=o+l,f=oa(r,n,i,o),d=oa(r,n,i,u),p="M ".concat(f.x,",").concat(f.y,`
    A `).concat(i,",").concat(i,`,0,
    `).concat(+(Math.abs(l)>180),",").concat(+(o>u),`,
    `).concat(d.x,",").concat(d.y,`
  `);if(a>0){var m=oa(r,n,a,o),v=oa(r,n,a,u);p+="L ".concat(v.x,",").concat(v.y,`
            A `).concat(a,",").concat(a,`,0,
            `).concat(+(Math.abs(l)>180),",").concat(+(o<=u),`,
            `).concat(m.x,",").concat(m.y," Z")}else p+="L ".concat(r,",").concat(n," Z");return p},_K=function(t){var r=t.cx,n=t.cy,a=t.innerRadius,i=t.outerRadius,o=t.cornerRadius,s=t.forceCornerRadius,l=t.cornerIsExternal,u=t.startAngle,f=t.endAngle,d=Ci(f-u),p=n0({cx:r,cy:n,radius:i,angle:u,sign:d,cornerRadius:o,cornerIsExternal:l}),m=p.circleTangency,v=p.lineTangency,b=p.theta,k=n0({cx:r,cy:n,radius:i,angle:f,sign:-d,cornerRadius:o,cornerIsExternal:l}),x=k.circleTangency,y=k.lineTangency,w=k.theta,_=l?Math.abs(u-f):Math.abs(u-f)-b-w;if(_<0)return s?"M ".concat(v.x,",").concat(v.y,`
        a`).concat(o,",").concat(o,",0,0,1,").concat(o*2,`,0
        a`).concat(o,",").concat(o,",0,0,1,").concat(-o*2,`,0
      `):bC({cx:r,cy:n,innerRadius:a,outerRadius:i,startAngle:u,endAngle:f});var S="M ".concat(v.x,",").concat(v.y,`
    A`).concat(o,",").concat(o,",0,0,").concat(+(d<0),",").concat(m.x,",").concat(m.y,`
    A`).concat(i,",").concat(i,",0,").concat(+(_>180),",").concat(+(d<0),",").concat(x.x,",").concat(x.y,`
    A`).concat(o,",").concat(o,",0,0,").concat(+(d<0),",").concat(y.x,",").concat(y.y,`
  `);if(a>0){var j=n0({cx:r,cy:n,radius:a,angle:u,sign:d,isExternal:!0,cornerRadius:o,cornerIsExternal:l}),M=j.circleTangency,A=j.lineTangency,$=j.theta,E=n0({cx:r,cy:n,radius:a,angle:f,sign:-d,isExternal:!0,cornerRadius:o,cornerIsExternal:l}),T=E.circleTangency,B=E.lineTangency,U=E.theta,V=l?Math.abs(u-f):Math.abs(u-f)-$-U;if(V<0&&o===0)return"".concat(S,"L").concat(r,",").concat(n,"Z");S+="L".concat(B.x,",").concat(B.y,`
      A`).concat(o,",").concat(o,",0,0,").concat(+(d<0),",").concat(T.x,",").concat(T.y,`
      A`).concat(a,",").concat(a,",0,").concat(+(V>180),",").concat(+(d>0),",").concat(M.x,",").concat(M.y,`
      A`).concat(o,",").concat(o,",0,0,").concat(+(d<0),",").concat(A.x,",").concat(A.y,"Z")}else S+="L".concat(r,",").concat(n,"Z");return S},PK={cx:0,cy:0,innerRadius:0,outerRadius:0,startAngle:0,endAngle:0,cornerRadius:0,forceCornerRadius:!1,cornerIsExternal:!1},wC=function(t){var r=QS(QS({},PK),t),n=r.cx,a=r.cy,i=r.innerRadius,o=r.outerRadius,s=r.cornerRadius,l=r.forceCornerRadius,u=r.cornerIsExternal,f=r.startAngle,d=r.endAngle,p=r.className;if(o<i||f===d)return null;var m=lr("recharts-sector",p),v=o-i,b=fl(s,v,0,!0),k;return b>0&&Math.abs(f-d)<360?k=_K({cx:n,cy:a,innerRadius:i,outerRadius:o,cornerRadius:Math.min(b,v/2),forceCornerRadius:l,cornerIsExternal:u,startAngle:f,endAngle:d}):k=bC({cx:n,cy:a,innerRadius:i,outerRadius:o,startAngle:f,endAngle:d}),J.createElement("path",zv({},At(r,!0),{className:m,d:k,role:"img"}))};function Ff(e){"@babel/helpers - typeof";return Ff=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ff(e)}function Wv(){return Wv=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Wv.apply(this,arguments)}function JS(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function e5(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?JS(Object(r),!0).forEach(function(n){CK(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):JS(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function CK(e,t,r){return t=NK(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function NK(e){var t=MK(e,"string");return Ff(t)=="symbol"?t:t+""}function MK(e,t){if(Ff(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(Ff(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var t5={curveBasisClosed:C7,curveBasisOpen:N7,curveBasis:P7,curveBumpX:d7,curveBumpY:h7,curveLinearClosed:M7,curveLinear:Gp,curveMonotoneX:O7,curveMonotoneY:A7,curveNatural:T7,curveStep:E7,curveStepAfter:R7,curveStepBefore:$7},a0=function(t){return t.x===+t.x&&t.y===+t.y},Pu=function(t){return t.x},Cu=function(t){return t.y},OK=function(t,r){if(Rt(t))return t;var n="curve".concat(Fp(t));return(n==="curveMonotone"||n==="curveBump")&&r?t5["".concat(n).concat(r==="vertical"?"Y":"X")]:t5[n]||Gp},AK=function(t){var r=t.type,n=r===void 0?"linear":r,a=t.points,i=a===void 0?[]:a,o=t.baseLine,s=t.layout,l=t.connectNulls,u=l===void 0?!1:l,f=OK(n,s),d=u?i.filter(function(b){return a0(b)}):i,p;if(Array.isArray(o)){var m=u?o.filter(function(b){return a0(b)}):o,v=d.map(function(b,k){return e5(e5({},b),{},{base:m[k]})});return s==="vertical"?p=Kd().y(Cu).x1(Pu).x0(function(b){return b.base.x}):p=Kd().x(Pu).y1(Cu).y0(function(b){return b.base.y}),p.defined(a0).curve(f),p(v)}return s==="vertical"&&$e(o)?p=Kd().y(Cu).x1(Pu).x0(o):$e(o)?p=Kd().x(Pu).y1(Cu).y0(o):p=S_().x(Pu).y(Cu),p.defined(a0).curve(f),p(d)},Qs=function(t){var r=t.className,n=t.points,a=t.path,i=t.pathRef;if((!n||!n.length)&&!a)return null;var o=n&&n.length?AK(t):a;return C.createElement("path",Wv({},At(t,!1),th(t),{className:lr("recharts-curve",r),d:o,ref:i}))},kC={exports:{}},TK="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED",EK=TK,$K=EK;function SC(){}function jC(){}jC.resetWarningCache=SC;var RK=function(){function e(n,a,i,o,s,l){if(l!==$K){var u=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw u.name="Invariant Violation",u}}e.isRequired=e;function t(){return e}var r={array:e,bigint:e,bool:e,func:e,number:e,object:e,string:e,symbol:e,any:e,arrayOf:t,element:e,elementType:e,instanceOf:t,node:e,objectOf:t,oneOf:t,oneOfType:t,shape:t,exact:t,checkPropTypes:jC,resetWarningCache:SC};return r.PropTypes=r,r};kC.exports=RK();var DK=kC.exports;const Pr=Fr(DK),{getOwnPropertyNames:IK,getOwnPropertySymbols:LK}=Object,{hasOwnProperty:BK}=Object.prototype;function Um(e,t){return function(n,a,i){return e(n,a,i)&&t(n,a,i)}}function i0(e){return function(r,n,a){if(!r||!n||typeof r!="object"||typeof n!="object")return e(r,n,a);const{cache:i}=a,o=i.get(r),s=i.get(n);if(o&&s)return o===n&&s===r;i.set(r,n),i.set(n,r);const l=e(r,n,a);return i.delete(r),i.delete(n),l}}function FK(e){return e!=null?e[Symbol.toStringTag]:void 0}function r5(e){return IK(e).concat(LK(e))}const UK=Object.hasOwn||((e,t)=>BK.call(e,t));function Sl(e,t){return e===t||!e&&!t&&e!==e&&t!==t}const GK="__v",zK="__o",WK="_owner",{getOwnPropertyDescriptor:n5,keys:a5}=Object;function VK(e,t){return e.byteLength===t.byteLength&&Eh(new Uint8Array(e),new Uint8Array(t))}function HK(e,t,r){let n=e.length;if(t.length!==n)return!1;for(;n-- >0;)if(!r.equals(e[n],t[n],n,n,e,t,r))return!1;return!0}function XK(e,t){return e.byteLength===t.byteLength&&Eh(new Uint8Array(e.buffer,e.byteOffset,e.byteLength),new Uint8Array(t.buffer,t.byteOffset,t.byteLength))}function KK(e,t){return Sl(e.getTime(),t.getTime())}function qK(e,t){return e.name===t.name&&e.message===t.message&&e.cause===t.cause&&e.stack===t.stack}function YK(e,t){return e===t}function i5(e,t,r){const n=e.size;if(n!==t.size)return!1;if(!n)return!0;const a=new Array(n),i=e.entries();let o,s,l=0;for(;(o=i.next())&&!o.done;){const u=t.entries();let f=!1,d=0;for(;(s=u.next())&&!s.done;){if(a[d]){d++;continue}const p=o.value,m=s.value;if(r.equals(p[0],m[0],l,d,e,t,r)&&r.equals(p[1],m[1],p[0],m[0],e,t,r)){f=a[d]=!0;break}d++}if(!f)return!1;l++}return!0}const ZK=Sl;function QK(e,t,r){const n=a5(e);let a=n.length;if(a5(t).length!==a)return!1;for(;a-- >0;)if(!_C(e,t,r,n[a]))return!1;return!0}function Nu(e,t,r){const n=r5(e);let a=n.length;if(r5(t).length!==a)return!1;let i,o,s;for(;a-- >0;)if(i=n[a],!_C(e,t,r,i)||(o=n5(e,i),s=n5(t,i),(o||s)&&(!o||!s||o.configurable!==s.configurable||o.enumerable!==s.enumerable||o.writable!==s.writable)))return!1;return!0}function JK(e,t){return Sl(e.valueOf(),t.valueOf())}function eq(e,t){return e.source===t.source&&e.flags===t.flags}function o5(e,t,r){const n=e.size;if(n!==t.size)return!1;if(!n)return!0;const a=new Array(n),i=e.values();let o,s;for(;(o=i.next())&&!o.done;){const l=t.values();let u=!1,f=0;for(;(s=l.next())&&!s.done;){if(!a[f]&&r.equals(o.value,s.value,o.value,s.value,e,t,r)){u=a[f]=!0;break}f++}if(!u)return!1}return!0}function Eh(e,t){let r=e.byteLength;if(t.byteLength!==r||e.byteOffset!==t.byteOffset)return!1;for(;r-- >0;)if(e[r]!==t[r])return!1;return!0}function tq(e,t){return e.hostname===t.hostname&&e.pathname===t.pathname&&e.protocol===t.protocol&&e.port===t.port&&e.hash===t.hash&&e.username===t.username&&e.password===t.password}function _C(e,t,r,n){return(n===WK||n===zK||n===GK)&&(e.$$typeof||t.$$typeof)?!0:UK(t,n)&&r.equals(e[n],t[n],n,n,e,t,r)}const rq="[object ArrayBuffer]",nq="[object Arguments]",aq="[object Boolean]",iq="[object DataView]",oq="[object Date]",sq="[object Error]",lq="[object Map]",cq="[object Number]",uq="[object Object]",fq="[object RegExp]",dq="[object Set]",hq="[object String]",pq={"[object Int8Array]":!0,"[object Uint8Array]":!0,"[object Uint8ClampedArray]":!0,"[object Int16Array]":!0,"[object Uint16Array]":!0,"[object Int32Array]":!0,"[object Uint32Array]":!0,"[object Float16Array]":!0,"[object Float32Array]":!0,"[object Float64Array]":!0,"[object BigInt64Array]":!0,"[object BigUint64Array]":!0},gq="[object URL]",mq=Object.prototype.toString;function yq({areArrayBuffersEqual:e,areArraysEqual:t,areDataViewsEqual:r,areDatesEqual:n,areErrorsEqual:a,areFunctionsEqual:i,areMapsEqual:o,areNumbersEqual:s,areObjectsEqual:l,arePrimitiveWrappersEqual:u,areRegExpsEqual:f,areSetsEqual:d,areTypedArraysEqual:p,areUrlsEqual:m,unknownTagComparators:v}){return function(k,x,y){if(k===x)return!0;if(k==null||x==null)return!1;const w=typeof k;if(w!==typeof x)return!1;if(w!=="object")return w==="number"?s(k,x,y):w==="function"?i(k,x,y):!1;const _=k.constructor;if(_!==x.constructor)return!1;if(_===Object)return l(k,x,y);if(Array.isArray(k))return t(k,x,y);if(_===Date)return n(k,x,y);if(_===RegExp)return f(k,x,y);if(_===Map)return o(k,x,y);if(_===Set)return d(k,x,y);const S=mq.call(k);if(S===oq)return n(k,x,y);if(S===fq)return f(k,x,y);if(S===lq)return o(k,x,y);if(S===dq)return d(k,x,y);if(S===uq)return typeof k.then!="function"&&typeof x.then!="function"&&l(k,x,y);if(S===gq)return m(k,x,y);if(S===sq)return a(k,x,y);if(S===nq)return l(k,x,y);if(pq[S])return p(k,x,y);if(S===rq)return e(k,x,y);if(S===iq)return r(k,x,y);if(S===aq||S===cq||S===hq)return u(k,x,y);if(v){let j=v[S];if(!j){const M=FK(k);M&&(j=v[M])}if(j)return j(k,x,y)}return!1}}function vq({circular:e,createCustomConfig:t,strict:r}){let n={areArrayBuffersEqual:VK,areArraysEqual:r?Nu:HK,areDataViewsEqual:XK,areDatesEqual:KK,areErrorsEqual:qK,areFunctionsEqual:YK,areMapsEqual:r?Um(i5,Nu):i5,areNumbersEqual:ZK,areObjectsEqual:r?Nu:QK,arePrimitiveWrappersEqual:JK,areRegExpsEqual:eq,areSetsEqual:r?Um(o5,Nu):o5,areTypedArraysEqual:r?Um(Eh,Nu):Eh,areUrlsEqual:tq,unknownTagComparators:void 0};if(t&&(n=Object.assign({},n,t(n))),e){const a=i0(n.areArraysEqual),i=i0(n.areMapsEqual),o=i0(n.areObjectsEqual),s=i0(n.areSetsEqual);n=Object.assign({},n,{areArraysEqual:a,areMapsEqual:i,areObjectsEqual:o,areSetsEqual:s})}return n}function xq(e){return function(t,r,n,a,i,o,s){return e(t,r,s)}}function bq({circular:e,comparator:t,createState:r,equals:n,strict:a}){if(r)return function(s,l){const{cache:u=e?new WeakMap:void 0,meta:f}=r();return t(s,l,{cache:u,equals:n,meta:f,strict:a})};if(e)return function(s,l){return t(s,l,{cache:new WeakMap,equals:n,meta:void 0,strict:a})};const i={cache:void 0,equals:n,meta:void 0,strict:a};return function(s,l){return t(s,l,i)}}const wq=ws();ws({strict:!0});ws({circular:!0});ws({circular:!0,strict:!0});ws({createInternalComparator:()=>Sl});ws({strict:!0,createInternalComparator:()=>Sl});ws({circular:!0,createInternalComparator:()=>Sl});ws({circular:!0,createInternalComparator:()=>Sl,strict:!0});function ws(e={}){const{circular:t=!1,createInternalComparator:r,createState:n,strict:a=!1}=e,i=vq(e),o=yq(i),s=r?r(o):xq(o);return bq({circular:t,comparator:o,createState:n,equals:s,strict:a})}function kq(e){typeof requestAnimationFrame<"u"&&requestAnimationFrame(e)}function s5(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,r=-1,n=function a(i){r<0&&(r=i),i-r>t?(e(i),r=-1):kq(a)};requestAnimationFrame(n)}function Vv(e){"@babel/helpers - typeof";return Vv=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Vv(e)}function Sq(e){return Cq(e)||Pq(e)||_q(e)||jq()}function jq(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function _q(e,t){if(e){if(typeof e=="string")return l5(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return l5(e,t)}}function l5(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Pq(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function Cq(e){if(Array.isArray(e))return e}function Nq(){var e={},t=function(){return null},r=!1,n=function a(i){if(!r){if(Array.isArray(i)){if(!i.length)return;var o=i,s=Sq(o),l=s[0],u=s.slice(1);if(typeof l=="number"){s5(a.bind(null,u),l);return}a(l),s5(a.bind(null,u));return}Vv(i)==="object"&&(e=i,t(e)),typeof i=="function"&&i()}};return{stop:function(){r=!0},start:function(i){r=!1,n(i)},subscribe:function(i){return t=i,function(){t=function(){return null}}}}}function Uf(e){"@babel/helpers - typeof";return Uf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Uf(e)}function c5(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function u5(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?c5(Object(r),!0).forEach(function(n){PC(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):c5(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function PC(e,t,r){return t=Mq(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Mq(e){var t=Oq(e,"string");return Uf(t)==="symbol"?t:String(t)}function Oq(e,t){if(Uf(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(Uf(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Aq=function(t,r){return[Object.keys(t),Object.keys(r)].reduce(function(n,a){return n.filter(function(i){return a.includes(i)})})},Tq=function(t){return t},Eq=function(t){return t.replace(/([A-Z])/g,function(r){return"-".concat(r.toLowerCase())})},Ku=function(t,r){return Object.keys(r).reduce(function(n,a){return u5(u5({},n),{},PC({},a,t(a,r[a])))},{})},f5=function(t,r,n){return t.map(function(a){return"".concat(Eq(a)," ").concat(r,"ms ").concat(n)}).join(",")};function $q(e,t){return Iq(e)||Dq(e,t)||CC(e,t)||Rq()}function Rq(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Dq(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,a,i,o,s=[],l=!0,u=!1;try{if(i=(r=r.call(e)).next,t!==0)for(;!(l=(n=i.call(r)).done)&&(s.push(n.value),s.length!==t);l=!0);}catch(f){u=!0,a=f}finally{try{if(!l&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(u)throw a}}return s}}function Iq(e){if(Array.isArray(e))return e}function Lq(e){return Uq(e)||Fq(e)||CC(e)||Bq()}function Bq(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function CC(e,t){if(e){if(typeof e=="string")return Hv(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Hv(e,t)}}function Fq(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function Uq(e){if(Array.isArray(e))return Hv(e)}function Hv(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var $h=1e-4,NC=function(t,r){return[0,3*t,3*r-6*t,3*t-3*r+1]},MC=function(t,r){return t.map(function(n,a){return n*Math.pow(r,a)}).reduce(function(n,a){return n+a})},d5=function(t,r){return function(n){var a=NC(t,r);return MC(a,n)}},Gq=function(t,r){return function(n){var a=NC(t,r),i=[].concat(Lq(a.map(function(o,s){return o*s}).slice(1)),[0]);return MC(i,n)}},h5=function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];var a=r[0],i=r[1],o=r[2],s=r[3];if(r.length===1)switch(r[0]){case"linear":a=0,i=0,o=1,s=1;break;case"ease":a=.25,i=.1,o=.25,s=1;break;case"ease-in":a=.42,i=0,o=1,s=1;break;case"ease-out":a=.42,i=0,o=.58,s=1;break;case"ease-in-out":a=0,i=0,o=.58,s=1;break;default:{var l=r[0].split("(");if(l[0]==="cubic-bezier"&&l[1].split(")")[0].split(",").length===4){var u=l[1].split(")")[0].split(",").map(function(k){return parseFloat(k)}),f=$q(u,4);a=f[0],i=f[1],o=f[2],s=f[3]}}}var d=d5(a,o),p=d5(i,s),m=Gq(a,o),v=function(x){return x>1?1:x<0?0:x},b=function(x){for(var y=x>1?1:x,w=y,_=0;_<8;++_){var S=d(w)-y,j=m(w);if(Math.abs(S-y)<$h||j<$h)return p(w);w=v(w-S/j)}return p(w)};return b.isStepper=!1,b},zq=function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},r=t.stiff,n=r===void 0?100:r,a=t.damping,i=a===void 0?8:a,o=t.dt,s=o===void 0?17:o,l=function(f,d,p){var m=-(f-d)*n,v=p*i,b=p+(m-v)*s/1e3,k=p*s/1e3+f;return Math.abs(k-d)<$h&&Math.abs(b)<$h?[d,0]:[k,b]};return l.isStepper=!0,l.dt=s,l},Wq=function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];var a=r[0];if(typeof a=="string")switch(a){case"ease":case"ease-in-out":case"ease-out":case"ease-in":case"linear":return h5(a);case"spring":return zq();default:if(a.split("(")[0]==="cubic-bezier")return h5(a)}return typeof a=="function"?a:null};function Gf(e){"@babel/helpers - typeof";return Gf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Gf(e)}function p5(e){return Xq(e)||Hq(e)||OC(e)||Vq()}function Vq(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Hq(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function Xq(e){if(Array.isArray(e))return Kv(e)}function g5(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function na(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?g5(Object(r),!0).forEach(function(n){Xv(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):g5(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Xv(e,t,r){return t=Kq(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Kq(e){var t=qq(e,"string");return Gf(t)==="symbol"?t:String(t)}function qq(e,t){if(Gf(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(Gf(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Yq(e,t){return Jq(e)||Qq(e,t)||OC(e,t)||Zq()}function Zq(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function OC(e,t){if(e){if(typeof e=="string")return Kv(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Kv(e,t)}}function Kv(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Qq(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,a,i,o,s=[],l=!0,u=!1;try{if(i=(r=r.call(e)).next,t!==0)for(;!(l=(n=i.call(r)).done)&&(s.push(n.value),s.length!==t);l=!0);}catch(f){u=!0,a=f}finally{try{if(!l&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(u)throw a}}return s}}function Jq(e){if(Array.isArray(e))return e}var Rh=function(t,r,n){return t+(r-t)*n},qv=function(t){var r=t.from,n=t.to;return r!==n},eY=function e(t,r,n){var a=Ku(function(i,o){if(qv(o)){var s=t(o.from,o.to,o.velocity),l=Yq(s,2),u=l[0],f=l[1];return na(na({},o),{},{from:u,velocity:f})}return o},r);return n<1?Ku(function(i,o){return qv(o)?na(na({},o),{},{velocity:Rh(o.velocity,a[i].velocity,n),from:Rh(o.from,a[i].from,n)}):o},r):e(t,a,n-1)};const tY=function(e,t,r,n,a){var i=Aq(e,t),o=i.reduce(function(k,x){return na(na({},k),{},Xv({},x,[e[x],t[x]]))},{}),s=i.reduce(function(k,x){return na(na({},k),{},Xv({},x,{from:e[x],velocity:0,to:t[x]}))},{}),l=-1,u,f,d=function(){return null},p=function(){return Ku(function(x,y){return y.from},s)},m=function(){return!Object.values(s).filter(qv).length},v=function(x){u||(u=x);var y=x-u,w=y/r.dt;s=eY(r,s,w),a(na(na(na({},e),t),p())),u=x,m()||(l=requestAnimationFrame(d))},b=function(x){f||(f=x);var y=(x-f)/n,w=Ku(function(S,j){return Rh.apply(void 0,p5(j).concat([r(y)]))},o);if(a(na(na(na({},e),t),w)),y<1)l=requestAnimationFrame(d);else{var _=Ku(function(S,j){return Rh.apply(void 0,p5(j).concat([r(1)]))},o);a(na(na(na({},e),t),_))}};return d=r.isStepper?v:b,function(){return requestAnimationFrame(d),function(){cancelAnimationFrame(l)}}};function _c(e){"@babel/helpers - typeof";return _c=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_c(e)}var rY=["children","begin","duration","attributeName","easing","isActive","steps","from","to","canBegin","onAnimationEnd","shouldReAnimate","onAnimationReStart"];function nY(e,t){if(e==null)return{};var r=aY(e,t),n,a;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function aY(e,t){if(e==null)return{};var r={},n=Object.keys(e),a,i;for(i=0;i<n.length;i++)a=n[i],!(t.indexOf(a)>=0)&&(r[a]=e[a]);return r}function Gm(e){return lY(e)||sY(e)||oY(e)||iY()}function iY(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function oY(e,t){if(e){if(typeof e=="string")return Yv(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Yv(e,t)}}function sY(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function lY(e){if(Array.isArray(e))return Yv(e)}function Yv(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function m5(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function xi(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?m5(Object(r),!0).forEach(function(n){$u(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):m5(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function $u(e,t,r){return t=AC(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function cY(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function uY(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,AC(n.key),n)}}function fY(e,t,r){return t&&uY(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function AC(e){var t=dY(e,"string");return _c(t)==="symbol"?t:String(t)}function dY(e,t){if(_c(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(_c(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function hY(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Zv(e,t)}function Zv(e,t){return Zv=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},Zv(e,t)}function pY(e){var t=gY();return function(){var n=Dh(e),a;if(t){var i=Dh(this).constructor;a=Reflect.construct(n,arguments,i)}else a=n.apply(this,arguments);return Qv(this,a)}}function Qv(e,t){if(t&&(_c(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Jv(e)}function Jv(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function gY(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Dh(e){return Dh=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Dh(e)}var Ti=function(e){hY(r,e);var t=pY(r);function r(n,a){var i;cY(this,r),i=t.call(this,n,a);var o=i.props,s=o.isActive,l=o.attributeName,u=o.from,f=o.to,d=o.steps,p=o.children,m=o.duration;if(i.handleStyleChange=i.handleStyleChange.bind(Jv(i)),i.changeStyle=i.changeStyle.bind(Jv(i)),!s||m<=0)return i.state={style:{}},typeof p=="function"&&(i.state={style:f}),Qv(i);if(d&&d.length)i.state={style:d[0].style};else if(u){if(typeof p=="function")return i.state={style:u},Qv(i);i.state={style:l?$u({},l,u):u}}else i.state={style:{}};return i}return fY(r,[{key:"componentDidMount",value:function(){var a=this.props,i=a.isActive,o=a.canBegin;this.mounted=!0,!(!i||!o)&&this.runAnimation(this.props)}},{key:"componentDidUpdate",value:function(a){var i=this.props,o=i.isActive,s=i.canBegin,l=i.attributeName,u=i.shouldReAnimate,f=i.to,d=i.from,p=this.state.style;if(s){if(!o){var m={style:l?$u({},l,f):f};this.state&&p&&(l&&p[l]!==f||!l&&p!==f)&&this.setState(m);return}if(!(wq(a.to,f)&&a.canBegin&&a.isActive)){var v=!a.canBegin||!a.isActive;this.manager&&this.manager.stop(),this.stopJSAnimation&&this.stopJSAnimation();var b=v||u?d:a.to;if(this.state&&p){var k={style:l?$u({},l,b):b};(l&&p[l]!==b||!l&&p!==b)&&this.setState(k)}this.runAnimation(xi(xi({},this.props),{},{from:b,begin:0}))}}}},{key:"componentWillUnmount",value:function(){this.mounted=!1;var a=this.props.onAnimationEnd;this.unSubscribe&&this.unSubscribe(),this.manager&&(this.manager.stop(),this.manager=null),this.stopJSAnimation&&this.stopJSAnimation(),a&&a()}},{key:"handleStyleChange",value:function(a){this.changeStyle(a)}},{key:"changeStyle",value:function(a){this.mounted&&this.setState({style:a})}},{key:"runJSAnimation",value:function(a){var i=this,o=a.from,s=a.to,l=a.duration,u=a.easing,f=a.begin,d=a.onAnimationEnd,p=a.onAnimationStart,m=tY(o,s,Wq(u),l,this.changeStyle),v=function(){i.stopJSAnimation=m()};this.manager.start([p,f,v,l,d])}},{key:"runStepAnimation",value:function(a){var i=this,o=a.steps,s=a.begin,l=a.onAnimationStart,u=o[0],f=u.style,d=u.duration,p=d===void 0?0:d,m=function(b,k,x){if(x===0)return b;var y=k.duration,w=k.easing,_=w===void 0?"ease":w,S=k.style,j=k.properties,M=k.onAnimationEnd,A=x>0?o[x-1]:k,$=j||Object.keys(S);if(typeof _=="function"||_==="spring")return[].concat(Gm(b),[i.runJSAnimation.bind(i,{from:A.style,to:S,duration:y,easing:_}),y]);var E=f5($,y,_),T=xi(xi(xi({},A.style),S),{},{transition:E});return[].concat(Gm(b),[T,y,M]).filter(Tq)};return this.manager.start([l].concat(Gm(o.reduce(m,[f,Math.max(p,s)])),[a.onAnimationEnd]))}},{key:"runAnimation",value:function(a){this.manager||(this.manager=Nq());var i=a.begin,o=a.duration,s=a.attributeName,l=a.to,u=a.easing,f=a.onAnimationStart,d=a.onAnimationEnd,p=a.steps,m=a.children,v=this.manager;if(this.unSubscribe=v.subscribe(this.handleStyleChange),typeof u=="function"||typeof m=="function"||u==="spring"){this.runJSAnimation(a);return}if(p.length>1){this.runStepAnimation(a);return}var b=s?$u({},s,l):l,k=f5(Object.keys(b),o,u);v.start([f,i,xi(xi({},b),{},{transition:k}),o,d])}},{key:"render",value:function(){var a=this.props,i=a.children;a.begin;var o=a.duration;a.attributeName,a.easing;var s=a.isActive;a.steps,a.from,a.to,a.canBegin,a.onAnimationEnd,a.shouldReAnimate,a.onAnimationReStart;var l=nY(a,rY),u=C.Children.count(i),f=this.state.style;if(typeof i=="function")return i(f);if(!s||u===0||o<=0)return i;var d=function(m){var v=m.props,b=v.style,k=b===void 0?{}:b,x=v.className,y=C.cloneElement(m,xi(xi({},l),{},{style:xi(xi({},k),f),className:x}));return y};return u===1?d(C.Children.only(i)):J.createElement("div",null,C.Children.map(i,function(p){return d(p)}))}}]),r}(C.PureComponent);Ti.displayName="Animate";Ti.defaultProps={begin:0,duration:1e3,from:"",to:"",attributeName:"",easing:"ease",isActive:!0,canBegin:!0,steps:[],onAnimationEnd:function(){},onAnimationStart:function(){}};Ti.propTypes={from:Pr.oneOfType([Pr.object,Pr.string]),to:Pr.oneOfType([Pr.object,Pr.string]),attributeName:Pr.string,duration:Pr.number,begin:Pr.number,easing:Pr.oneOfType([Pr.string,Pr.func]),steps:Pr.arrayOf(Pr.shape({duration:Pr.number.isRequired,style:Pr.object.isRequired,easing:Pr.oneOfType([Pr.oneOf(["ease","ease-in","ease-out","ease-in-out","linear"]),Pr.func]),properties:Pr.arrayOf("string"),onAnimationEnd:Pr.func})),children:Pr.oneOfType([Pr.node,Pr.func]),isActive:Pr.bool,canBegin:Pr.bool,onAnimationEnd:Pr.func,shouldReAnimate:Pr.bool,onAnimationStart:Pr.func,onAnimationReStart:Pr.func};function zf(e){"@babel/helpers - typeof";return zf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},zf(e)}function Ih(){return Ih=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Ih.apply(this,arguments)}function mY(e,t){return bY(e)||xY(e,t)||vY(e,t)||yY()}function yY(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function vY(e,t){if(e){if(typeof e=="string")return y5(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return y5(e,t)}}function y5(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function xY(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,a,i,o,s=[],l=!0,u=!1;try{if(i=(r=r.call(e)).next,t!==0)for(;!(l=(n=i.call(r)).done)&&(s.push(n.value),s.length!==t);l=!0);}catch(f){u=!0,a=f}finally{try{if(!l&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(u)throw a}}return s}}function bY(e){if(Array.isArray(e))return e}function v5(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function x5(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?v5(Object(r),!0).forEach(function(n){wY(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):v5(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function wY(e,t,r){return t=kY(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function kY(e){var t=SY(e,"string");return zf(t)=="symbol"?t:t+""}function SY(e,t){if(zf(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(zf(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var b5=function(t,r,n,a,i){var o=Math.min(Math.abs(n)/2,Math.abs(a)/2),s=a>=0?1:-1,l=n>=0?1:-1,u=a>=0&&n>=0||a<0&&n<0?1:0,f;if(o>0&&i instanceof Array){for(var d=[0,0,0,0],p=0,m=4;p<m;p++)d[p]=i[p]>o?o:i[p];f="M".concat(t,",").concat(r+s*d[0]),d[0]>0&&(f+="A ".concat(d[0],",").concat(d[0],",0,0,").concat(u,",").concat(t+l*d[0],",").concat(r)),f+="L ".concat(t+n-l*d[1],",").concat(r),d[1]>0&&(f+="A ".concat(d[1],",").concat(d[1],",0,0,").concat(u,`,
        `).concat(t+n,",").concat(r+s*d[1])),f+="L ".concat(t+n,",").concat(r+a-s*d[2]),d[2]>0&&(f+="A ".concat(d[2],",").concat(d[2],",0,0,").concat(u,`,
        `).concat(t+n-l*d[2],",").concat(r+a)),f+="L ".concat(t+l*d[3],",").concat(r+a),d[3]>0&&(f+="A ".concat(d[3],",").concat(d[3],",0,0,").concat(u,`,
        `).concat(t,",").concat(r+a-s*d[3])),f+="Z"}else if(o>0&&i===+i&&i>0){var v=Math.min(o,i);f="M ".concat(t,",").concat(r+s*v,`
            A `).concat(v,",").concat(v,",0,0,").concat(u,",").concat(t+l*v,",").concat(r,`
            L `).concat(t+n-l*v,",").concat(r,`
            A `).concat(v,",").concat(v,",0,0,").concat(u,",").concat(t+n,",").concat(r+s*v,`
            L `).concat(t+n,",").concat(r+a-s*v,`
            A `).concat(v,",").concat(v,",0,0,").concat(u,",").concat(t+n-l*v,",").concat(r+a,`
            L `).concat(t+l*v,",").concat(r+a,`
            A `).concat(v,",").concat(v,",0,0,").concat(u,",").concat(t,",").concat(r+a-s*v," Z")}else f="M ".concat(t,",").concat(r," h ").concat(n," v ").concat(a," h ").concat(-n," Z");return f},jY=function(t,r){if(!t||!r)return!1;var n=t.x,a=t.y,i=r.x,o=r.y,s=r.width,l=r.height;if(Math.abs(s)>0&&Math.abs(l)>0){var u=Math.min(i,i+s),f=Math.max(i,i+s),d=Math.min(o,o+l),p=Math.max(o,o+l);return n>=u&&n<=f&&a>=d&&a<=p}return!1},_Y={x:0,y:0,width:0,height:0,radius:0,isAnimationActive:!1,isUpdateAnimationActive:!1,animationBegin:0,animationDuration:1500,animationEasing:"ease"},Ob=function(t){var r=x5(x5({},_Y),t),n=C.useRef(),a=C.useState(-1),i=mY(a,2),o=i[0],s=i[1];C.useEffect(function(){if(n.current&&n.current.getTotalLength)try{var _=n.current.getTotalLength();_&&s(_)}catch{}},[]);var l=r.x,u=r.y,f=r.width,d=r.height,p=r.radius,m=r.className,v=r.animationEasing,b=r.animationDuration,k=r.animationBegin,x=r.isAnimationActive,y=r.isUpdateAnimationActive;if(l!==+l||u!==+u||f!==+f||d!==+d||f===0||d===0)return null;var w=lr("recharts-rectangle",m);return y?J.createElement(Ti,{canBegin:o>0,from:{width:f,height:d,x:l,y:u},to:{width:f,height:d,x:l,y:u},duration:b,animationEasing:v,isActive:y},function(_){var S=_.width,j=_.height,M=_.x,A=_.y;return J.createElement(Ti,{canBegin:o>0,from:"0px ".concat(o===-1?1:o,"px"),to:"".concat(o,"px 0px"),attributeName:"strokeDasharray",begin:k,duration:b,isActive:x,easing:v},J.createElement("path",Ih({},At(r,!0),{className:w,d:b5(M,A,S,j,p),ref:n})))}):J.createElement("path",Ih({},At(r,!0),{className:w,d:b5(l,u,f,d,p)}))};function ex(){return ex=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},ex.apply(this,arguments)}var ng=function(t){var r=t.cx,n=t.cy,a=t.r,i=t.className,o=lr("recharts-dot",i);return r===+r&&n===+n&&a===+a?C.createElement("circle",ex({},At(t,!1),th(t),{className:o,cx:r,cy:n,r:a})):null};function Wf(e){"@babel/helpers - typeof";return Wf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Wf(e)}var PY=["x","y","top","left","width","height","className"];function tx(){return tx=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},tx.apply(this,arguments)}function w5(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function CY(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?w5(Object(r),!0).forEach(function(n){NY(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):w5(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function NY(e,t,r){return t=MY(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function MY(e){var t=OY(e,"string");return Wf(t)=="symbol"?t:t+""}function OY(e,t){if(Wf(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(Wf(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function AY(e,t){if(e==null)return{};var r=TY(e,t),n,a;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function TY(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}var EY=function(t,r,n,a,i,o){return"M".concat(t,",").concat(i,"v").concat(a,"M").concat(o,",").concat(r,"h").concat(n)},$Y=function(t){var r=t.x,n=r===void 0?0:r,a=t.y,i=a===void 0?0:a,o=t.top,s=o===void 0?0:o,l=t.left,u=l===void 0?0:l,f=t.width,d=f===void 0?0:f,p=t.height,m=p===void 0?0:p,v=t.className,b=AY(t,PY),k=CY({x:n,y:i,top:s,left:u,width:d,height:m},b);return!$e(n)||!$e(i)||!$e(d)||!$e(m)||!$e(s)||!$e(u)?null:J.createElement("path",tx({},At(k,!0),{className:lr("recharts-cross",v),d:EY(n,i,d,m,s,u)}))},RY=X_,DY=RY(Object.getPrototypeOf,Object),IY=DY,LY=Co,BY=IY,FY=No,UY="[object Object]",GY=Function.prototype,zY=Object.prototype,TC=GY.toString,WY=zY.hasOwnProperty,VY=TC.call(Object);function HY(e){if(!FY(e)||LY(e)!=UY)return!1;var t=BY(e);if(t===null)return!0;var r=WY.call(t,"constructor")&&t.constructor;return typeof r=="function"&&r instanceof r&&TC.call(r)==VY}var XY=HY;const KY=Fr(XY);var qY=Co,YY=No,ZY="[object Boolean]";function QY(e){return e===!0||e===!1||YY(e)&&qY(e)==ZY}var JY=QY;const eZ=Fr(JY);function Vf(e){"@babel/helpers - typeof";return Vf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Vf(e)}function Lh(){return Lh=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Lh.apply(this,arguments)}function tZ(e,t){return iZ(e)||aZ(e,t)||nZ(e,t)||rZ()}function rZ(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function nZ(e,t){if(e){if(typeof e=="string")return k5(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return k5(e,t)}}function k5(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function aZ(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,a,i,o,s=[],l=!0,u=!1;try{if(i=(r=r.call(e)).next,t!==0)for(;!(l=(n=i.call(r)).done)&&(s.push(n.value),s.length!==t);l=!0);}catch(f){u=!0,a=f}finally{try{if(!l&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(u)throw a}}return s}}function iZ(e){if(Array.isArray(e))return e}function S5(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function j5(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?S5(Object(r),!0).forEach(function(n){oZ(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):S5(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function oZ(e,t,r){return t=sZ(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function sZ(e){var t=lZ(e,"string");return Vf(t)=="symbol"?t:t+""}function lZ(e,t){if(Vf(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(Vf(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var _5=function(t,r,n,a,i){var o=n-a,s;return s="M ".concat(t,",").concat(r),s+="L ".concat(t+n,",").concat(r),s+="L ".concat(t+n-o/2,",").concat(r+i),s+="L ".concat(t+n-o/2-a,",").concat(r+i),s+="L ".concat(t,",").concat(r," Z"),s},cZ={x:0,y:0,upperWidth:0,lowerWidth:0,height:0,isUpdateAnimationActive:!1,animationBegin:0,animationDuration:1500,animationEasing:"ease"},uZ=function(t){var r=j5(j5({},cZ),t),n=C.useRef(),a=C.useState(-1),i=tZ(a,2),o=i[0],s=i[1];C.useEffect(function(){if(n.current&&n.current.getTotalLength)try{var w=n.current.getTotalLength();w&&s(w)}catch{}},[]);var l=r.x,u=r.y,f=r.upperWidth,d=r.lowerWidth,p=r.height,m=r.className,v=r.animationEasing,b=r.animationDuration,k=r.animationBegin,x=r.isUpdateAnimationActive;if(l!==+l||u!==+u||f!==+f||d!==+d||p!==+p||f===0&&d===0||p===0)return null;var y=lr("recharts-trapezoid",m);return x?J.createElement(Ti,{canBegin:o>0,from:{upperWidth:0,lowerWidth:0,height:p,x:l,y:u},to:{upperWidth:f,lowerWidth:d,height:p,x:l,y:u},duration:b,animationEasing:v,isActive:x},function(w){var _=w.upperWidth,S=w.lowerWidth,j=w.height,M=w.x,A=w.y;return J.createElement(Ti,{canBegin:o>0,from:"0px ".concat(o===-1?1:o,"px"),to:"".concat(o,"px 0px"),attributeName:"strokeDasharray",begin:k,duration:b,easing:v},J.createElement("path",Lh({},At(r,!0),{className:y,d:_5(M,A,_,S,j),ref:n})))}):J.createElement("g",null,J.createElement("path",Lh({},At(r,!0),{className:y,d:_5(l,u,f,d,p)})))},fZ=["option","shapeType","propTransformer","activeClassName","isActive"];function Hf(e){"@babel/helpers - typeof";return Hf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Hf(e)}function dZ(e,t){if(e==null)return{};var r=hZ(e,t),n,a;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function hZ(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function P5(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Bh(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?P5(Object(r),!0).forEach(function(n){pZ(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):P5(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function pZ(e,t,r){return t=gZ(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function gZ(e){var t=mZ(e,"string");return Hf(t)=="symbol"?t:t+""}function mZ(e,t){if(Hf(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(Hf(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function yZ(e,t){return Bh(Bh({},t),e)}function vZ(e,t){return e==="symbols"}function C5(e){var t=e.shapeType,r=e.elementProps;switch(t){case"rectangle":return J.createElement(Ob,r);case"trapezoid":return J.createElement(uZ,r);case"sector":return J.createElement(wC,r);case"symbols":if(vZ(t))return J.createElement(Wp,r);break;default:return null}}function xZ(e){return C.isValidElement(e)?e.props:e}function rx(e){var t=e.option,r=e.shapeType,n=e.propTransformer,a=n===void 0?yZ:n,i=e.activeClassName,o=i===void 0?"recharts-active-shape":i,s=e.isActive,l=dZ(e,fZ),u;if(C.isValidElement(t))u=C.cloneElement(t,Bh(Bh({},l),xZ(t)));else if(Rt(t))u=t(l);else if(KY(t)&&!eZ(t)){var f=a(t,l);u=J.createElement(C5,{shapeType:r,elementProps:f})}else{var d=l;u=J.createElement(C5,{shapeType:r,elementProps:d})}return s?J.createElement(kr,{className:o},u):u}function ag(e,t){return t!=null&&"trapezoids"in e.props}function ig(e,t){return t!=null&&"sectors"in e.props}function Xf(e,t){return t!=null&&"points"in e.props}function bZ(e,t){var r,n,a=e.x===(t==null||(r=t.labelViewBox)===null||r===void 0?void 0:r.x)||e.x===t.x,i=e.y===(t==null||(n=t.labelViewBox)===null||n===void 0?void 0:n.y)||e.y===t.y;return a&&i}function wZ(e,t){var r=e.endAngle===t.endAngle,n=e.startAngle===t.startAngle;return r&&n}function kZ(e,t){var r=e.x===t.x,n=e.y===t.y,a=e.z===t.z;return r&&n&&a}function SZ(e,t){var r;return ag(e,t)?r=bZ:ig(e,t)?r=wZ:Xf(e,t)&&(r=kZ),r}function jZ(e,t){var r;return ag(e,t)?r="trapezoids":ig(e,t)?r="sectors":Xf(e,t)&&(r="points"),r}function _Z(e,t){if(ag(e,t)){var r;return(r=t.tooltipPayload)===null||r===void 0||(r=r[0])===null||r===void 0||(r=r.payload)===null||r===void 0?void 0:r.payload}if(ig(e,t)){var n;return(n=t.tooltipPayload)===null||n===void 0||(n=n[0])===null||n===void 0||(n=n.payload)===null||n===void 0?void 0:n.payload}return Xf(e,t)?t.payload:{}}function PZ(e){var t=e.activeTooltipItem,r=e.graphicalItem,n=e.itemData,a=jZ(r,t),i=_Z(r,t),o=n.filter(function(l,u){var f=dl(i,l),d=r.props[a].filter(function(v){var b=SZ(r,t);return b(v,t)}),p=r.props[a].indexOf(d[d.length-1]),m=u===p;return f&&m}),s=n.indexOf(o[o.length-1]);return s}var CZ=Math.ceil,NZ=Math.max;function MZ(e,t,r,n){for(var a=-1,i=NZ(CZ((t-e)/(r||1)),0),o=Array(i);i--;)o[n?i:++a]=e,e+=r;return o}var OZ=MZ,AZ=dP,N5=1/0,TZ=17976931348623157e292;function EZ(e){if(!e)return e===0?e:0;if(e=AZ(e),e===N5||e===-N5){var t=e<0?-1:1;return t*TZ}return e===e?e:0}var EC=EZ,$Z=OZ,RZ=Xp,zm=EC;function DZ(e){return function(t,r,n){return n&&typeof n!="number"&&RZ(t,r,n)&&(r=n=void 0),t=zm(t),r===void 0?(r=t,t=0):r=zm(r),n=n===void 0?t<r?1:-1:zm(n),$Z(t,r,n,e)}}var IZ=DZ,LZ=IZ,BZ=LZ(),FZ=BZ;const Fh=Fr(FZ);function Kf(e){"@babel/helpers - typeof";return Kf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Kf(e)}function M5(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function O5(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?M5(Object(r),!0).forEach(function(n){$C(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):M5(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function $C(e,t,r){return t=UZ(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function UZ(e){var t=GZ(e,"string");return Kf(t)=="symbol"?t:t+""}function GZ(e,t){if(Kf(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(Kf(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var zZ=["Webkit","Moz","O","ms"],WZ=function(t,r){var n=t.replace(/(\w)/,function(i){return i.toUpperCase()}),a=zZ.reduce(function(i,o){return O5(O5({},i),{},$C({},o+n,r))},{});return a[t]=r,a};function Pc(e){"@babel/helpers - typeof";return Pc=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Pc(e)}function Uh(){return Uh=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Uh.apply(this,arguments)}function A5(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Wm(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?A5(Object(r),!0).forEach(function(n){Fa(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):A5(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function VZ(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function T5(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,DC(n.key),n)}}function HZ(e,t,r){return t&&T5(e.prototype,t),r&&T5(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function XZ(e,t,r){return t=Gh(t),KZ(e,RC()?Reflect.construct(t,r||[],Gh(e).constructor):t.apply(e,r))}function KZ(e,t){if(t&&(Pc(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return qZ(e)}function qZ(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function RC(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(RC=function(){return!!e})()}function Gh(e){return Gh=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Gh(e)}function YZ(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&nx(e,t)}function nx(e,t){return nx=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},nx(e,t)}function Fa(e,t,r){return t=DC(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function DC(e){var t=ZZ(e,"string");return Pc(t)=="symbol"?t:t+""}function ZZ(e,t){if(Pc(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(Pc(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var QZ=function(t){var r=t.data,n=t.startIndex,a=t.endIndex,i=t.x,o=t.width,s=t.travellerWidth;if(!r||!r.length)return{};var l=r.length,u=Hu().domain(Fh(0,l)).range([i,i+o-s]),f=u.domain().map(function(d){return u(d)});return{isTextActive:!1,isSlideMoving:!1,isTravellerMoving:!1,isTravellerFocused:!1,startX:u(n),endX:u(a),scale:u,scaleValues:f}},E5=function(t){return t.changedTouches&&!!t.changedTouches.length},Cc=function(e){function t(r){var n;return VZ(this,t),n=XZ(this,t,[r]),Fa(n,"handleDrag",function(a){n.leaveTimer&&(clearTimeout(n.leaveTimer),n.leaveTimer=null),n.state.isTravellerMoving?n.handleTravellerMove(a):n.state.isSlideMoving&&n.handleSlideDrag(a)}),Fa(n,"handleTouchMove",function(a){a.changedTouches!=null&&a.changedTouches.length>0&&n.handleDrag(a.changedTouches[0])}),Fa(n,"handleDragEnd",function(){n.setState({isTravellerMoving:!1,isSlideMoving:!1},function(){var a=n.props,i=a.endIndex,o=a.onDragEnd,s=a.startIndex;o==null||o({endIndex:i,startIndex:s})}),n.detachDragEndListener()}),Fa(n,"handleLeaveWrapper",function(){(n.state.isTravellerMoving||n.state.isSlideMoving)&&(n.leaveTimer=window.setTimeout(n.handleDragEnd,n.props.leaveTimeOut))}),Fa(n,"handleEnterSlideOrTraveller",function(){n.setState({isTextActive:!0})}),Fa(n,"handleLeaveSlideOrTraveller",function(){n.setState({isTextActive:!1})}),Fa(n,"handleSlideDragStart",function(a){var i=E5(a)?a.changedTouches[0]:a;n.setState({isTravellerMoving:!1,isSlideMoving:!0,slideMoveStartX:i.pageX}),n.attachDragEndListener()}),n.travellerDragStartHandlers={startX:n.handleTravellerDragStart.bind(n,"startX"),endX:n.handleTravellerDragStart.bind(n,"endX")},n.state={},n}return YZ(t,e),HZ(t,[{key:"componentWillUnmount",value:function(){this.leaveTimer&&(clearTimeout(this.leaveTimer),this.leaveTimer=null),this.detachDragEndListener()}},{key:"getIndex",value:function(n){var a=n.startX,i=n.endX,o=this.state.scaleValues,s=this.props,l=s.gap,u=s.data,f=u.length-1,d=Math.min(a,i),p=Math.max(a,i),m=t.getIndexInRange(o,d),v=t.getIndexInRange(o,p);return{startIndex:m-m%l,endIndex:v===f?f:v-v%l}}},{key:"getTextOfTick",value:function(n){var a=this.props,i=a.data,o=a.tickFormatter,s=a.dataKey,l=Wn(i[n],s,n);return Rt(o)?o(l,n):l}},{key:"attachDragEndListener",value:function(){window.addEventListener("mouseup",this.handleDragEnd,!0),window.addEventListener("touchend",this.handleDragEnd,!0),window.addEventListener("mousemove",this.handleDrag,!0)}},{key:"detachDragEndListener",value:function(){window.removeEventListener("mouseup",this.handleDragEnd,!0),window.removeEventListener("touchend",this.handleDragEnd,!0),window.removeEventListener("mousemove",this.handleDrag,!0)}},{key:"handleSlideDrag",value:function(n){var a=this.state,i=a.slideMoveStartX,o=a.startX,s=a.endX,l=this.props,u=l.x,f=l.width,d=l.travellerWidth,p=l.startIndex,m=l.endIndex,v=l.onChange,b=n.pageX-i;b>0?b=Math.min(b,u+f-d-s,u+f-d-o):b<0&&(b=Math.max(b,u-o,u-s));var k=this.getIndex({startX:o+b,endX:s+b});(k.startIndex!==p||k.endIndex!==m)&&v&&v(k),this.setState({startX:o+b,endX:s+b,slideMoveStartX:n.pageX})}},{key:"handleTravellerDragStart",value:function(n,a){var i=E5(a)?a.changedTouches[0]:a;this.setState({isSlideMoving:!1,isTravellerMoving:!0,movingTravellerId:n,brushMoveStartX:i.pageX}),this.attachDragEndListener()}},{key:"handleTravellerMove",value:function(n){var a=this.state,i=a.brushMoveStartX,o=a.movingTravellerId,s=a.endX,l=a.startX,u=this.state[o],f=this.props,d=f.x,p=f.width,m=f.travellerWidth,v=f.onChange,b=f.gap,k=f.data,x={startX:this.state.startX,endX:this.state.endX},y=n.pageX-i;y>0?y=Math.min(y,d+p-m-u):y<0&&(y=Math.max(y,d-u)),x[o]=u+y;var w=this.getIndex(x),_=w.startIndex,S=w.endIndex,j=function(){var A=k.length-1;return o==="startX"&&(s>l?_%b===0:S%b===0)||s<l&&S===A||o==="endX"&&(s>l?S%b===0:_%b===0)||s>l&&S===A};this.setState(Fa(Fa({},o,u+y),"brushMoveStartX",n.pageX),function(){v&&j()&&v(w)})}},{key:"handleTravellerMoveKeyboard",value:function(n,a){var i=this,o=this.state,s=o.scaleValues,l=o.startX,u=o.endX,f=this.state[a],d=s.indexOf(f);if(d!==-1){var p=d+n;if(!(p===-1||p>=s.length)){var m=s[p];a==="startX"&&m>=u||a==="endX"&&m<=l||this.setState(Fa({},a,m),function(){i.props.onChange(i.getIndex({startX:i.state.startX,endX:i.state.endX}))})}}}},{key:"renderBackground",value:function(){var n=this.props,a=n.x,i=n.y,o=n.width,s=n.height,l=n.fill,u=n.stroke;return J.createElement("rect",{stroke:u,fill:l,x:a,y:i,width:o,height:s})}},{key:"renderPanorama",value:function(){var n=this.props,a=n.x,i=n.y,o=n.width,s=n.height,l=n.data,u=n.children,f=n.padding,d=C.Children.only(u);return d?J.cloneElement(d,{x:a,y:i,width:o,height:s,margin:f,compact:!0,data:l}):null}},{key:"renderTravellerLayer",value:function(n,a){var i,o,s=this,l=this.props,u=l.y,f=l.travellerWidth,d=l.height,p=l.traveller,m=l.ariaLabel,v=l.data,b=l.startIndex,k=l.endIndex,x=Math.max(n,this.props.x),y=Wm(Wm({},At(this.props,!1)),{},{x,y:u,width:f,height:d}),w=m||"Min value: ".concat((i=v[b])===null||i===void 0?void 0:i.name,", Max value: ").concat((o=v[k])===null||o===void 0?void 0:o.name);return J.createElement(kr,{tabIndex:0,role:"slider","aria-label":w,"aria-valuenow":n,className:"recharts-brush-traveller",onMouseEnter:this.handleEnterSlideOrTraveller,onMouseLeave:this.handleLeaveSlideOrTraveller,onMouseDown:this.travellerDragStartHandlers[a],onTouchStart:this.travellerDragStartHandlers[a],onKeyDown:function(S){["ArrowLeft","ArrowRight"].includes(S.key)&&(S.preventDefault(),S.stopPropagation(),s.handleTravellerMoveKeyboard(S.key==="ArrowRight"?1:-1,a))},onFocus:function(){s.setState({isTravellerFocused:!0})},onBlur:function(){s.setState({isTravellerFocused:!1})},style:{cursor:"col-resize"}},t.renderTraveller(p,y))}},{key:"renderSlide",value:function(n,a){var i=this.props,o=i.y,s=i.height,l=i.stroke,u=i.travellerWidth,f=Math.min(n,a)+u,d=Math.max(Math.abs(a-n)-u,0);return J.createElement("rect",{className:"recharts-brush-slide",onMouseEnter:this.handleEnterSlideOrTraveller,onMouseLeave:this.handleLeaveSlideOrTraveller,onMouseDown:this.handleSlideDragStart,onTouchStart:this.handleSlideDragStart,style:{cursor:"move"},stroke:"none",fill:l,fillOpacity:.2,x:f,y:o,width:d,height:s})}},{key:"renderText",value:function(){var n=this.props,a=n.startIndex,i=n.endIndex,o=n.y,s=n.height,l=n.travellerWidth,u=n.stroke,f=this.state,d=f.startX,p=f.endX,m=5,v={pointerEvents:"none",fill:u};return J.createElement(kr,{className:"recharts-brush-texts"},J.createElement(gh,Uh({textAnchor:"end",verticalAnchor:"middle",x:Math.min(d,p)-m,y:o+s/2},v),this.getTextOfTick(a)),J.createElement(gh,Uh({textAnchor:"start",verticalAnchor:"middle",x:Math.max(d,p)+l+m,y:o+s/2},v),this.getTextOfTick(i)))}},{key:"render",value:function(){var n=this.props,a=n.data,i=n.className,o=n.children,s=n.x,l=n.y,u=n.width,f=n.height,d=n.alwaysShowText,p=this.state,m=p.startX,v=p.endX,b=p.isTextActive,k=p.isSlideMoving,x=p.isTravellerMoving,y=p.isTravellerFocused;if(!a||!a.length||!$e(s)||!$e(l)||!$e(u)||!$e(f)||u<=0||f<=0)return null;var w=lr("recharts-brush",i),_=J.Children.count(o)===1,S=WZ("userSelect","none");return J.createElement(kr,{className:w,onMouseLeave:this.handleLeaveWrapper,onTouchMove:this.handleTouchMove,style:S},this.renderBackground(),_&&this.renderPanorama(),this.renderSlide(m,v),this.renderTravellerLayer(m,"startX"),this.renderTravellerLayer(v,"endX"),(b||k||x||y||d)&&this.renderText())}}],[{key:"renderDefaultTraveller",value:function(n){var a=n.x,i=n.y,o=n.width,s=n.height,l=n.stroke,u=Math.floor(i+s/2)-1;return J.createElement(J.Fragment,null,J.createElement("rect",{x:a,y:i,width:o,height:s,fill:l,stroke:"none"}),J.createElement("line",{x1:a+1,y1:u,x2:a+o-1,y2:u,fill:"none",stroke:"#fff"}),J.createElement("line",{x1:a+1,y1:u+2,x2:a+o-1,y2:u+2,fill:"none",stroke:"#fff"}))}},{key:"renderTraveller",value:function(n,a){var i;return J.isValidElement(n)?i=J.cloneElement(n,a):Rt(n)?i=n(a):i=t.renderDefaultTraveller(a),i}},{key:"getDerivedStateFromProps",value:function(n,a){var i=n.data,o=n.width,s=n.x,l=n.travellerWidth,u=n.updateId,f=n.startIndex,d=n.endIndex;if(i!==a.prevData||u!==a.prevUpdateId)return Wm({prevData:i,prevTravellerWidth:l,prevUpdateId:u,prevX:s,prevWidth:o},i&&i.length?QZ({data:i,width:o,x:s,travellerWidth:l,startIndex:f,endIndex:d}):{scale:null,scaleValues:null});if(a.scale&&(o!==a.prevWidth||s!==a.prevX||l!==a.prevTravellerWidth)){a.scale.range([s,s+o-l]);var p=a.scale.domain().map(function(m){return a.scale(m)});return{prevData:i,prevTravellerWidth:l,prevUpdateId:u,prevX:s,prevWidth:o,startX:a.scale(n.startIndex),endX:a.scale(n.endIndex),scaleValues:p}}return null}},{key:"getIndexInRange",value:function(n,a){for(var i=n.length,o=0,s=i-1;s-o>1;){var l=Math.floor((o+s)/2);n[l]>a?s=l:o=l}return a>=n[s]?s:o}}])}(C.PureComponent);Fa(Cc,"displayName","Brush");Fa(Cc,"defaultProps",{height:40,travellerWidth:5,gap:1,fill:"#fff",stroke:"#666",padding:{top:1,right:1,bottom:1,left:1},leaveTimeOut:1e3,alwaysShowText:!1});var JZ=tb;function eQ(e,t){var r;return JZ(e,function(n,a,i){return r=t(n,a,i),!r}),!!r}var tQ=eQ,rQ=B_,nQ=ys,aQ=tQ,iQ=Da,oQ=Xp;function sQ(e,t,r){var n=iQ(e)?rQ:aQ;return r&&oQ(e,t,r)&&(t=void 0),n(e,nQ(t))}var lQ=sQ;const cQ=Fr(lQ);var Yi=function(t,r){var n=t.alwaysShow,a=t.ifOverflow;return n&&(a="extendDomain"),a===r},$5=sP;function uQ(e,t,r){t=="__proto__"&&$5?$5(e,t,{configurable:!0,enumerable:!0,value:r,writable:!0}):e[t]=r}var fQ=uQ,dQ=fQ,hQ=iP,pQ=ys;function gQ(e,t){var r={};return t=pQ(t),hQ(e,function(n,a,i){dQ(r,a,t(n,a,i))}),r}var mQ=gQ;const yQ=Fr(mQ);function vQ(e,t){for(var r=-1,n=e==null?0:e.length;++r<n;)if(!t(e[r],r,e))return!1;return!0}var xQ=vQ,bQ=tb;function wQ(e,t){var r=!0;return bQ(e,function(n,a,i){return r=!!t(n,a,i),r}),r}var kQ=wQ,SQ=xQ,jQ=kQ,_Q=ys,PQ=Da,CQ=Xp;function NQ(e,t,r){var n=PQ(e)?SQ:jQ;return r&&CQ(e,t,r)&&(t=void 0),n(e,_Q(t))}var MQ=NQ;const IC=Fr(MQ);var OQ=["x","y"];function qf(e){"@babel/helpers - typeof";return qf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},qf(e)}function ax(){return ax=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},ax.apply(this,arguments)}function R5(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Mu(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?R5(Object(r),!0).forEach(function(n){AQ(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):R5(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function AQ(e,t,r){return t=TQ(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function TQ(e){var t=EQ(e,"string");return qf(t)=="symbol"?t:t+""}function EQ(e,t){if(qf(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(qf(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function $Q(e,t){if(e==null)return{};var r=RQ(e,t),n,a;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function RQ(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function DQ(e,t){var r=e.x,n=e.y,a=$Q(e,OQ),i="".concat(r),o=parseInt(i,10),s="".concat(n),l=parseInt(s,10),u="".concat(t.height||a.height),f=parseInt(u,10),d="".concat(t.width||a.width),p=parseInt(d,10);return Mu(Mu(Mu(Mu(Mu({},t),a),o?{x:o}:{}),l?{y:l}:{}),{},{height:f,width:p,name:t.name,radius:t.radius})}function D5(e){return J.createElement(rx,ax({shapeType:"rectangle",propTransformer:DQ,activeClassName:"recharts-active-bar"},e))}var IQ=function(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return function(n,a){if(typeof t=="number")return t;var i=$e(n)||ZE(n);return i?t(n,a):(i||pl(),r)}},LQ=["value","background"],LC;function Nc(e){"@babel/helpers - typeof";return Nc=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Nc(e)}function BQ(e,t){if(e==null)return{};var r=FQ(e,t),n,a;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function FQ(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function zh(){return zh=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},zh.apply(this,arguments)}function I5(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function An(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?I5(Object(r),!0).forEach(function(n){qo(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):I5(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function UQ(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function L5(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,FC(n.key),n)}}function GQ(e,t,r){return t&&L5(e.prototype,t),r&&L5(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function zQ(e,t,r){return t=Wh(t),WQ(e,BC()?Reflect.construct(t,r||[],Wh(e).constructor):t.apply(e,r))}function WQ(e,t){if(t&&(Nc(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return VQ(e)}function VQ(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function BC(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(BC=function(){return!!e})()}function Wh(e){return Wh=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Wh(e)}function HQ(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&ix(e,t)}function ix(e,t){return ix=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},ix(e,t)}function qo(e,t,r){return t=FC(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function FC(e){var t=XQ(e,"string");return Nc(t)=="symbol"?t:t+""}function XQ(e,t){if(Nc(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(Nc(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var fd=function(e){function t(){var r;UQ(this,t);for(var n=arguments.length,a=new Array(n),i=0;i<n;i++)a[i]=arguments[i];return r=zQ(this,t,[].concat(a)),qo(r,"state",{isAnimationFinished:!1}),qo(r,"id",bl("recharts-bar-")),qo(r,"handleAnimationEnd",function(){var o=r.props.onAnimationEnd;r.setState({isAnimationFinished:!0}),o&&o()}),qo(r,"handleAnimationStart",function(){var o=r.props.onAnimationStart;r.setState({isAnimationFinished:!1}),o&&o()}),r}return HQ(t,e),GQ(t,[{key:"renderRectanglesStatically",value:function(n){var a=this,i=this.props,o=i.shape,s=i.dataKey,l=i.activeIndex,u=i.activeBar,f=At(this.props,!1);return n&&n.map(function(d,p){var m=p===l,v=m?u:o,b=An(An(An({},f),d),{},{isActive:m,option:v,index:p,dataKey:s,onAnimationStart:a.handleAnimationStart,onAnimationEnd:a.handleAnimationEnd});return J.createElement(kr,zh({className:"recharts-bar-rectangle"},vf(a.props,d,p),{key:"rectangle-".concat(d==null?void 0:d.x,"-").concat(d==null?void 0:d.y,"-").concat(d==null?void 0:d.value,"-").concat(p)}),J.createElement(D5,b))})}},{key:"renderRectanglesWithAnimation",value:function(){var n=this,a=this.props,i=a.data,o=a.layout,s=a.isAnimationActive,l=a.animationBegin,u=a.animationDuration,f=a.animationEasing,d=a.animationId,p=this.state.prevData;return J.createElement(Ti,{begin:l,duration:u,isActive:s,easing:f,from:{t:0},to:{t:1},key:"bar-".concat(d),onAnimationEnd:this.handleAnimationEnd,onAnimationStart:this.handleAnimationStart},function(m){var v=m.t,b=i.map(function(k,x){var y=p&&p[x];if(y){var w=Cn(y.x,k.x),_=Cn(y.y,k.y),S=Cn(y.width,k.width),j=Cn(y.height,k.height);return An(An({},k),{},{x:w(v),y:_(v),width:S(v),height:j(v)})}if(o==="horizontal"){var M=Cn(0,k.height),A=M(v);return An(An({},k),{},{y:k.y+k.height-A,height:A})}var $=Cn(0,k.width),E=$(v);return An(An({},k),{},{width:E})});return J.createElement(kr,null,n.renderRectanglesStatically(b))})}},{key:"renderRectangles",value:function(){var n=this.props,a=n.data,i=n.isAnimationActive,o=this.state.prevData;return i&&a&&a.length&&(!o||!dl(o,a))?this.renderRectanglesWithAnimation():this.renderRectanglesStatically(a)}},{key:"renderBackground",value:function(){var n=this,a=this.props,i=a.data,o=a.dataKey,s=a.activeIndex,l=At(this.props.background,!1);return i.map(function(u,f){u.value;var d=u.background,p=BQ(u,LQ);if(!d)return null;var m=An(An(An(An(An({},p),{},{fill:"#eee"},d),l),vf(n.props,u,f)),{},{onAnimationStart:n.handleAnimationStart,onAnimationEnd:n.handleAnimationEnd,dataKey:o,index:f,className:"recharts-bar-background-rectangle"});return J.createElement(D5,zh({key:"background-bar-".concat(f),option:n.props.background,isActive:f===s},m))})}},{key:"renderErrorBar",value:function(n,a){if(this.props.isAnimationActive&&!this.state.isAnimationFinished)return null;var i=this.props,o=i.data,s=i.xAxis,l=i.yAxis,u=i.layout,f=i.children,d=Ra(f,au);if(!d)return null;var p=u==="vertical"?o[0].height/2:o[0].width/2,m=function(k,x){var y=Array.isArray(k.value)?k.value[1]:k.value;return{x:k.x,y:k.y,value:y,errorVal:Wn(k,x)}},v={clipPath:n?"url(#clipPath-".concat(a,")"):null};return J.createElement(kr,v,d.map(function(b){return J.cloneElement(b,{key:"error-bar-".concat(a,"-").concat(b.props.dataKey),data:o,xAxis:s,yAxis:l,layout:u,offset:p,dataPointFormatter:m})}))}},{key:"render",value:function(){var n=this.props,a=n.hide,i=n.data,o=n.className,s=n.xAxis,l=n.yAxis,u=n.left,f=n.top,d=n.width,p=n.height,m=n.isAnimationActive,v=n.background,b=n.id;if(a||!i||!i.length)return null;var k=this.state.isAnimationFinished,x=lr("recharts-bar",o),y=s&&s.allowDataOverflow,w=l&&l.allowDataOverflow,_=y||w,S=Ot(b)?this.id:b;return J.createElement(kr,{className:x},y||w?J.createElement("defs",null,J.createElement("clipPath",{id:"clipPath-".concat(S)},J.createElement("rect",{x:y?u:u-d/2,y:w?f:f-p/2,width:y?d:d*2,height:w?p:p*2}))):null,J.createElement(kr,{className:"recharts-bar-rectangles",clipPath:_?"url(#clipPath-".concat(S,")"):null},v?this.renderBackground():null,this.renderRectangles()),this.renderErrorBar(_,S),(!m||k)&&qi.renderCallByParent(this.props,i))}}],[{key:"getDerivedStateFromProps",value:function(n,a){return n.animationId!==a.prevAnimationId?{prevAnimationId:n.animationId,curData:n.data,prevData:a.curData}:n.data!==a.curData?{curData:n.data}:null}}])}(C.PureComponent);LC=fd;qo(fd,"displayName","Bar");qo(fd,"defaultProps",{xAxisId:0,yAxisId:0,legendType:"rect",minPointSize:0,hide:!1,data:[],layout:"vertical",activeBar:!1,isAnimationActive:!vs.isSsr,animationBegin:0,animationDuration:400,animationEasing:"ease"});qo(fd,"getComposedData",function(e){var t=e.props,r=e.item,n=e.barPosition,a=e.bandSize,i=e.xAxis,o=e.yAxis,s=e.xAxisTicks,l=e.yAxisTicks,u=e.stackedData,f=e.dataStartIndex,d=e.displayedData,p=e.offset,m=bX(n,r);if(!m)return null;var v=t.layout,b=r.type.defaultProps,k=b!==void 0?An(An({},b),r.props):r.props,x=k.dataKey,y=k.children,w=k.minPointSize,_=v==="horizontal"?o:i,S=u?_.scale.domain():null,j=NX({numericAxis:_}),M=Ra(y,ab),A=d.map(function($,E){var T,B,U,V,G,D;u?T=wX(u[f+E],S):(T=Wn($,x),Array.isArray(T)||(T=[j,T]));var I=IQ(w,LC.defaultProps.minPointSize)(T[1],E);if(v==="horizontal"){var F,H=[o.scale(T[0]),o.scale(T[1])],W=H[0],Q=H[1];B=FS({axis:i,ticks:s,bandSize:a,offset:m.offset,entry:$,index:E}),U=(F=Q??W)!==null&&F!==void 0?F:void 0,V=m.size;var q=W-Q;if(G=Number.isNaN(q)?0:q,D={x:B,y:o.y,width:V,height:o.height},Math.abs(I)>0&&Math.abs(G)<Math.abs(I)){var re=Ci(G||I)*(Math.abs(I)-Math.abs(G));U-=re,G+=re}}else{var ee=[i.scale(T[0]),i.scale(T[1])],fe=ee[0],oe=ee[1];if(B=fe,U=FS({axis:o,ticks:l,bandSize:a,offset:m.offset,entry:$,index:E}),V=oe-fe,G=m.size,D={x:i.x,y:U,width:i.width,height:G},Math.abs(I)>0&&Math.abs(V)<Math.abs(I)){var ye=Ci(V||I)*(Math.abs(I)-Math.abs(V));V+=ye}}return An(An(An({},$),{},{x:B,y:U,width:V,height:G,value:u?T:T[1],payload:$,background:D},M&&M[E]&&M[E].props),{},{tooltipPayload:[vC(r,$)],tooltipPosition:{x:B+V/2,y:U+G/2}})});return An({data:A,layout:v},p)});function Yf(e){"@babel/helpers - typeof";return Yf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Yf(e)}function KQ(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function B5(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,UC(n.key),n)}}function qQ(e,t,r){return t&&B5(e.prototype,t),r&&B5(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function F5(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function ki(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?F5(Object(r),!0).forEach(function(n){og(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):F5(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function og(e,t,r){return t=UC(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function UC(e){var t=YQ(e,"string");return Yf(t)=="symbol"?t:t+""}function YQ(e,t){if(Yf(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(Yf(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Ab=function(t,r,n,a,i){var o=t.width,s=t.height,l=t.layout,u=t.children,f=Object.keys(r),d={left:n.left,leftMirror:n.left,right:o-n.right,rightMirror:o-n.right,top:n.top,topMirror:n.top,bottom:s-n.bottom,bottomMirror:s-n.bottom},p=!!Ga(u,fd);return f.reduce(function(m,v){var b=r[v],k=b.orientation,x=b.domain,y=b.padding,w=y===void 0?{}:y,_=b.mirror,S=b.reversed,j="".concat(k).concat(_?"Mirror":""),M,A,$,E,T;if(b.type==="number"&&(b.padding==="gap"||b.padding==="no-gap")){var B=x[1]-x[0],U=1/0,V=b.categoricalDomain.sort(t$);if(V.forEach(function(ee,fe){fe>0&&(U=Math.min((ee||0)-(V[fe-1]||0),U))}),Number.isFinite(U)){var G=U/B,D=b.layout==="vertical"?n.height:n.width;if(b.padding==="gap"&&(M=G*D/2),b.padding==="no-gap"){var I=fl(t.barCategoryGap,G*D),F=G*D/2;M=F-I-(F-I)/D*I}}}a==="xAxis"?A=[n.left+(w.left||0)+(M||0),n.left+n.width-(w.right||0)-(M||0)]:a==="yAxis"?A=l==="horizontal"?[n.top+n.height-(w.bottom||0),n.top+(w.top||0)]:[n.top+(w.top||0)+(M||0),n.top+n.height-(w.bottom||0)-(M||0)]:A=b.range,S&&(A=[A[1],A[0]]);var H=vX(b,i,p),W=H.scale,Q=H.realScaleType;W.domain(x).range(A),xX(W);var q=CX(W,ki(ki({},b),{},{realScaleType:Q}));a==="xAxis"?(T=k==="top"&&!_||k==="bottom"&&_,$=n.left,E=d[j]-T*b.height):a==="yAxis"&&(T=k==="left"&&!_||k==="right"&&_,$=d[j]-T*b.width,E=n.top);var re=ki(ki(ki({},b),q),{},{realScaleType:Q,x:$,y:E,scale:W,width:a==="xAxis"?n.width:b.width,height:a==="yAxis"?n.height:b.height});return re.bandSize=Oh(re,q),!b.hide&&a==="xAxis"?d[j]+=(T?-1:1)*re.height:b.hide||(d[j]+=(T?-1:1)*re.width),ki(ki({},m),{},og({},v,re))},{})},GC=function(t,r){var n=t.x,a=t.y,i=r.x,o=r.y;return{x:Math.min(n,i),y:Math.min(a,o),width:Math.abs(i-n),height:Math.abs(o-a)}},ZQ=function(t){var r=t.x1,n=t.y1,a=t.x2,i=t.y2;return GC({x:r,y:n},{x:a,y:i})},zC=function(){function e(t){KQ(this,e),this.scale=t}return qQ(e,[{key:"domain",get:function(){return this.scale.domain}},{key:"range",get:function(){return this.scale.range}},{key:"rangeMin",get:function(){return this.range()[0]}},{key:"rangeMax",get:function(){return this.range()[1]}},{key:"bandwidth",get:function(){return this.scale.bandwidth}},{key:"apply",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},a=n.bandAware,i=n.position;if(r!==void 0){if(i)switch(i){case"start":return this.scale(r);case"middle":{var o=this.bandwidth?this.bandwidth()/2:0;return this.scale(r)+o}case"end":{var s=this.bandwidth?this.bandwidth():0;return this.scale(r)+s}default:return this.scale(r)}if(a){var l=this.bandwidth?this.bandwidth()/2:0;return this.scale(r)+l}return this.scale(r)}}},{key:"isInRange",value:function(r){var n=this.range(),a=n[0],i=n[n.length-1];return a<=i?r>=a&&r<=i:r>=i&&r<=a}}],[{key:"create",value:function(r){return new e(r)}}])}();og(zC,"EPS",1e-4);var Tb=function(t){var r=Object.keys(t).reduce(function(n,a){return ki(ki({},n),{},og({},a,zC.create(t[a])))},{});return ki(ki({},r),{},{apply:function(a){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},o=i.bandAware,s=i.position;return yQ(a,function(l,u){return r[u].apply(l,{bandAware:o,position:s})})},isInRange:function(a){return IC(a,function(i,o){return r[o].isInRange(i)})}})};function QQ(e){return(e%180+180)%180}var JQ=function(t){var r=t.width,n=t.height,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,i=QQ(a),o=i*Math.PI/180,s=Math.atan(n/r),l=o>s&&o<Math.PI-s?n/Math.sin(o):r/Math.cos(o);return Math.abs(l)},eJ=ys,tJ=od,rJ=Vp;function nJ(e){return function(t,r,n){var a=Object(t);if(!tJ(t)){var i=eJ(r);t=rJ(t),r=function(s){return i(a[s],s,a)}}var o=e(t,r,n);return o>-1?a[i?t[o]:o]:void 0}}var aJ=nJ,iJ=EC;function oJ(e){var t=iJ(e),r=t%1;return t===t?r?t-r:t:0}var sJ=oJ,lJ=J_,cJ=ys,uJ=sJ,fJ=Math.max;function dJ(e,t,r){var n=e==null?0:e.length;if(!n)return-1;var a=r==null?0:uJ(r);return a<0&&(a=fJ(n+a,0)),lJ(e,cJ(t),a)}var hJ=dJ,pJ=aJ,gJ=hJ,mJ=pJ(gJ),yJ=mJ;const vJ=Fr(yJ);var xJ=nE(function(e){return{x:e.left,y:e.top,width:e.width,height:e.height}},function(e){return["l",e.left,"t",e.top,"w",e.width,"h",e.height].join("")}),Eb=C.createContext(void 0),$b=C.createContext(void 0),WC=C.createContext(void 0),VC=C.createContext({}),HC=C.createContext(void 0),XC=C.createContext(0),KC=C.createContext(0),U5=function(t){var r=t.state,n=r.xAxisMap,a=r.yAxisMap,i=r.offset,o=t.clipPathId,s=t.children,l=t.width,u=t.height,f=xJ(i);return J.createElement(Eb.Provider,{value:n},J.createElement($b.Provider,{value:a},J.createElement(VC.Provider,{value:i},J.createElement(WC.Provider,{value:f},J.createElement(HC.Provider,{value:o},J.createElement(XC.Provider,{value:u},J.createElement(KC.Provider,{value:l},s)))))))},bJ=function(){return C.useContext(HC)},qC=function(t){var r=C.useContext(Eb);r==null&&pl();var n=r[t];return n==null&&pl(),n},wJ=function(){var t=C.useContext(Eb);return Uo(t)},kJ=function(){var t=C.useContext($b),r=vJ(t,function(n){return IC(n.domain,Number.isFinite)});return r||Uo(t)},YC=function(t){var r=C.useContext($b);r==null&&pl();var n=r[t];return n==null&&pl(),n},SJ=function(){var t=C.useContext(WC);return t},jJ=function(){return C.useContext(VC)},Rb=function(){return C.useContext(KC)},Db=function(){return C.useContext(XC)};function Mc(e){"@babel/helpers - typeof";return Mc=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Mc(e)}function _J(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function PJ(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,QC(n.key),n)}}function CJ(e,t,r){return t&&PJ(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function NJ(e,t,r){return t=Vh(t),MJ(e,ZC()?Reflect.construct(t,r||[],Vh(e).constructor):t.apply(e,r))}function MJ(e,t){if(t&&(Mc(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return OJ(e)}function OJ(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function ZC(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(ZC=function(){return!!e})()}function Vh(e){return Vh=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Vh(e)}function AJ(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&ox(e,t)}function ox(e,t){return ox=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},ox(e,t)}function G5(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function z5(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?G5(Object(r),!0).forEach(function(n){Ib(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):G5(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Ib(e,t,r){return t=QC(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function QC(e){var t=TJ(e,"string");return Mc(t)=="symbol"?t:t+""}function TJ(e,t){if(Mc(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(Mc(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}function EJ(e,t){return IJ(e)||DJ(e,t)||RJ(e,t)||$J()}function $J(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function RJ(e,t){if(e){if(typeof e=="string")return W5(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return W5(e,t)}}function W5(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function DJ(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,a,i,o,s=[],l=!0,u=!1;try{if(i=(r=r.call(e)).next,t!==0)for(;!(l=(n=i.call(r)).done)&&(s.push(n.value),s.length!==t);l=!0);}catch(f){u=!0,a=f}finally{try{if(!l&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(u)throw a}}return s}}function IJ(e){if(Array.isArray(e))return e}function sx(){return sx=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},sx.apply(this,arguments)}var LJ=function(t,r){var n;return J.isValidElement(t)?n=J.cloneElement(t,r):Rt(t)?n=t(r):n=J.createElement("line",sx({},r,{className:"recharts-reference-line-line"})),n},BJ=function(t,r,n,a,i,o,s,l,u){var f=i.x,d=i.y,p=i.width,m=i.height;if(n){var v=u.y,b=t.y.apply(v,{position:o});if(Yi(u,"discard")&&!t.y.isInRange(b))return null;var k=[{x:f+p,y:b},{x:f,y:b}];return l==="left"?k.reverse():k}if(r){var x=u.x,y=t.x.apply(x,{position:o});if(Yi(u,"discard")&&!t.x.isInRange(y))return null;var w=[{x:y,y:d+m},{x:y,y:d}];return s==="top"?w.reverse():w}if(a){var _=u.segment,S=_.map(function(j){return t.apply(j,{position:o})});return Yi(u,"discard")&&cQ(S,function(j){return!t.isInRange(j)})?null:S}return null};function FJ(e){var t=e.x,r=e.y,n=e.segment,a=e.xAxisId,i=e.yAxisId,o=e.shape,s=e.className,l=e.alwaysShow,u=bJ(),f=qC(a),d=YC(i),p=SJ();if(!u||!p)return null;yo(l===void 0,'The alwaysShow prop is deprecated. Please use ifOverflow="extendDomain" instead.');var m=Tb({x:f.scale,y:d.scale}),v=zn(t),b=zn(r),k=n&&n.length===2,x=BJ(m,v,b,k,p,e.position,f.orientation,d.orientation,e);if(!x)return null;var y=EJ(x,2),w=y[0],_=w.x,S=w.y,j=y[1],M=j.x,A=j.y,$=Yi(e,"hidden")?"url(#".concat(u,")"):void 0,E=z5(z5({clipPath:$},At(e,!0)),{},{x1:_,y1:S,x2:M,y2:A});return J.createElement(kr,{className:lr("recharts-reference-line",s)},LJ(o,E),ia.renderCallByParent(e,ZQ({x1:_,y1:S,x2:M,y2:A})))}var Yo=function(e){function t(){return _J(this,t),NJ(this,t,arguments)}return AJ(t,e),CJ(t,[{key:"render",value:function(){return J.createElement(FJ,this.props)}}])}(J.Component);Ib(Yo,"displayName","ReferenceLine");Ib(Yo,"defaultProps",{isFront:!1,ifOverflow:"discard",xAxisId:0,yAxisId:0,fill:"none",stroke:"#ccc",fillOpacity:1,strokeWidth:1,position:"middle"});function lx(){return lx=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},lx.apply(this,arguments)}function Oc(e){"@babel/helpers - typeof";return Oc=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Oc(e)}function V5(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function H5(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?V5(Object(r),!0).forEach(function(n){sg(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):V5(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function UJ(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function GJ(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,eN(n.key),n)}}function zJ(e,t,r){return t&&GJ(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function WJ(e,t,r){return t=Hh(t),VJ(e,JC()?Reflect.construct(t,r||[],Hh(e).constructor):t.apply(e,r))}function VJ(e,t){if(t&&(Oc(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return HJ(e)}function HJ(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function JC(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(JC=function(){return!!e})()}function Hh(e){return Hh=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Hh(e)}function XJ(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&cx(e,t)}function cx(e,t){return cx=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},cx(e,t)}function sg(e,t,r){return t=eN(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function eN(e){var t=KJ(e,"string");return Oc(t)=="symbol"?t:t+""}function KJ(e,t){if(Oc(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(Oc(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var qJ=function(t){var r=t.x,n=t.y,a=t.xAxis,i=t.yAxis,o=Tb({x:a.scale,y:i.scale}),s=o.apply({x:r,y:n},{bandAware:!0});return Yi(t,"discard")&&!o.isInRange(s)?null:s},dd=function(e){function t(){return UJ(this,t),WJ(this,t,arguments)}return XJ(t,e),zJ(t,[{key:"render",value:function(){var n=this.props,a=n.x,i=n.y,o=n.r,s=n.alwaysShow,l=n.clipPathId,u=zn(a),f=zn(i);if(yo(s===void 0,'The alwaysShow prop is deprecated. Please use ifOverflow="extendDomain" instead.'),!u||!f)return null;var d=qJ(this.props);if(!d)return null;var p=d.x,m=d.y,v=this.props,b=v.shape,k=v.className,x=Yi(this.props,"hidden")?"url(#".concat(l,")"):void 0,y=H5(H5({clipPath:x},At(this.props,!0)),{},{cx:p,cy:m});return J.createElement(kr,{className:lr("recharts-reference-dot",k)},t.renderDot(b,y),ia.renderCallByParent(this.props,{x:p-o,y:m-o,width:2*o,height:2*o}))}}])}(J.Component);sg(dd,"displayName","ReferenceDot");sg(dd,"defaultProps",{isFront:!1,ifOverflow:"discard",xAxisId:0,yAxisId:0,r:10,fill:"#fff",stroke:"#ccc",fillOpacity:1,strokeWidth:1});sg(dd,"renderDot",function(e,t){var r;return J.isValidElement(e)?r=J.cloneElement(e,t):Rt(e)?r=e(t):r=J.createElement(ng,lx({},t,{cx:t.cx,cy:t.cy,className:"recharts-reference-dot-dot"})),r});function ux(){return ux=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},ux.apply(this,arguments)}function Ac(e){"@babel/helpers - typeof";return Ac=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ac(e)}function X5(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function K5(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?X5(Object(r),!0).forEach(function(n){lg(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):X5(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function YJ(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function ZJ(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,rN(n.key),n)}}function QJ(e,t,r){return t&&ZJ(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function JJ(e,t,r){return t=Xh(t),eee(e,tN()?Reflect.construct(t,r||[],Xh(e).constructor):t.apply(e,r))}function eee(e,t){if(t&&(Ac(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return tee(e)}function tee(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function tN(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(tN=function(){return!!e})()}function Xh(e){return Xh=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Xh(e)}function ree(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&fx(e,t)}function fx(e,t){return fx=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},fx(e,t)}function lg(e,t,r){return t=rN(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function rN(e){var t=nee(e,"string");return Ac(t)=="symbol"?t:t+""}function nee(e,t){if(Ac(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(Ac(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var aee=function(t,r,n,a,i){var o=i.x1,s=i.x2,l=i.y1,u=i.y2,f=i.xAxis,d=i.yAxis;if(!f||!d)return null;var p=Tb({x:f.scale,y:d.scale}),m={x:t?p.x.apply(o,{position:"start"}):p.x.rangeMin,y:n?p.y.apply(l,{position:"start"}):p.y.rangeMin},v={x:r?p.x.apply(s,{position:"end"}):p.x.rangeMax,y:a?p.y.apply(u,{position:"end"}):p.y.rangeMax};return Yi(i,"discard")&&(!p.isInRange(m)||!p.isInRange(v))?null:GC(m,v)},hd=function(e){function t(){return YJ(this,t),JJ(this,t,arguments)}return ree(t,e),QJ(t,[{key:"render",value:function(){var n=this.props,a=n.x1,i=n.x2,o=n.y1,s=n.y2,l=n.className,u=n.alwaysShow,f=n.clipPathId;yo(u===void 0,'The alwaysShow prop is deprecated. Please use ifOverflow="extendDomain" instead.');var d=zn(a),p=zn(i),m=zn(o),v=zn(s),b=this.props.shape;if(!d&&!p&&!m&&!v&&!b)return null;var k=aee(d,p,m,v,this.props);if(!k&&!b)return null;var x=Yi(this.props,"hidden")?"url(#".concat(f,")"):void 0;return J.createElement(kr,{className:lr("recharts-reference-area",l)},t.renderRect(b,K5(K5({clipPath:x},At(this.props,!0)),k)),ia.renderCallByParent(this.props,k))}}])}(J.Component);lg(hd,"displayName","ReferenceArea");lg(hd,"defaultProps",{isFront:!1,ifOverflow:"discard",xAxisId:0,yAxisId:0,r:10,fill:"#ccc",fillOpacity:.5,stroke:"none",strokeWidth:1});lg(hd,"renderRect",function(e,t){var r;return J.isValidElement(e)?r=J.cloneElement(e,t):Rt(e)?r=e(t):r=J.createElement(Ob,ux({},t,{className:"recharts-reference-area-rect"})),r});function nN(e,t,r){if(t<1)return[];if(t===1&&r===void 0)return e;for(var n=[],a=0;a<e.length;a+=t)n.push(e[a]);return n}function iee(e,t,r){var n={width:e.width+t.width,height:e.height+t.height};return JQ(n,r)}function oee(e,t,r){var n=r==="width",a=e.x,i=e.y,o=e.width,s=e.height;return t===1?{start:n?a:i,end:n?a+o:i+s}:{start:n?a+o:i+s,end:n?a:i}}function Kh(e,t,r,n,a){if(e*t<e*n||e*t>e*a)return!1;var i=r();return e*(t-e*i/2-n)>=0&&e*(t+e*i/2-a)<=0}function see(e,t){return nN(e,t+1)}function lee(e,t,r,n,a){for(var i=(n||[]).slice(),o=t.start,s=t.end,l=0,u=1,f=o,d=function(){var v=n==null?void 0:n[l];if(v===void 0)return{v:nN(n,u)};var b=l,k,x=function(){return k===void 0&&(k=r(v,b)),k},y=v.coordinate,w=l===0||Kh(e,y,x,f,s);w||(l=0,f=o,u+=1),w&&(f=y+e*(x()/2+a),l+=u)},p;u<=i.length;)if(p=d(),p)return p.v;return[]}function Zf(e){"@babel/helpers - typeof";return Zf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Zf(e)}function q5(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function da(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?q5(Object(r),!0).forEach(function(n){cee(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):q5(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function cee(e,t,r){return t=uee(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function uee(e){var t=fee(e,"string");return Zf(t)=="symbol"?t:t+""}function fee(e,t){if(Zf(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(Zf(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function dee(e,t,r,n,a){for(var i=(n||[]).slice(),o=i.length,s=t.start,l=t.end,u=function(p){var m=i[p],v,b=function(){return v===void 0&&(v=r(m,p)),v};if(p===o-1){var k=e*(m.coordinate+e*b()/2-l);i[p]=m=da(da({},m),{},{tickCoord:k>0?m.coordinate-k*e:m.coordinate})}else i[p]=m=da(da({},m),{},{tickCoord:m.coordinate});var x=Kh(e,m.tickCoord,b,s,l);x&&(l=m.tickCoord-e*(b()/2+a),i[p]=da(da({},m),{},{isShow:!0}))},f=o-1;f>=0;f--)u(f);return i}function hee(e,t,r,n,a,i){var o=(n||[]).slice(),s=o.length,l=t.start,u=t.end;if(i){var f=n[s-1],d=r(f,s-1),p=e*(f.coordinate+e*d/2-u);o[s-1]=f=da(da({},f),{},{tickCoord:p>0?f.coordinate-p*e:f.coordinate});var m=Kh(e,f.tickCoord,function(){return d},l,u);m&&(u=f.tickCoord-e*(d/2+a),o[s-1]=da(da({},f),{},{isShow:!0}))}for(var v=i?s-1:s,b=function(y){var w=o[y],_,S=function(){return _===void 0&&(_=r(w,y)),_};if(y===0){var j=e*(w.coordinate-e*S()/2-l);o[y]=w=da(da({},w),{},{tickCoord:j<0?w.coordinate-j*e:w.coordinate})}else o[y]=w=da(da({},w),{},{tickCoord:w.coordinate});var M=Kh(e,w.tickCoord,S,l,u);M&&(l=w.tickCoord+e*(S()/2+a),o[y]=da(da({},w),{},{isShow:!0}))},k=0;k<v;k++)b(k);return o}function Lb(e,t,r){var n=e.tick,a=e.ticks,i=e.viewBox,o=e.minTickGap,s=e.orientation,l=e.interval,u=e.tickFormatter,f=e.unit,d=e.angle;if(!a||!a.length||!n)return[];if($e(l)||vs.isSsr)return see(a,typeof l=="number"&&$e(l)?l:0);var p=[],m=s==="top"||s==="bottom"?"width":"height",v=f&&m==="width"?Vu(f,{fontSize:t,letterSpacing:r}):{width:0,height:0},b=function(w,_){var S=Rt(u)?u(w.value,_):w.value;return m==="width"?iee(Vu(S,{fontSize:t,letterSpacing:r}),v,d):Vu(S,{fontSize:t,letterSpacing:r})[m]},k=a.length>=2?Ci(a[1].coordinate-a[0].coordinate):1,x=oee(i,k,m);return l==="equidistantPreserveStart"?lee(k,x,b,a,o):(l==="preserveStart"||l==="preserveStartEnd"?p=hee(k,x,b,a,o,l==="preserveStartEnd"):p=dee(k,x,b,a,o),p.filter(function(y){return y.isShow}))}var pee=["viewBox"],gee=["viewBox"],mee=["ticks"];function Tc(e){"@babel/helpers - typeof";return Tc=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Tc(e)}function Kl(){return Kl=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Kl.apply(this,arguments)}function Y5(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Ln(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Y5(Object(r),!0).forEach(function(n){Bb(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Y5(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Vm(e,t){if(e==null)return{};var r=yee(e,t),n,a;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function yee(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function vee(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Z5(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,iN(n.key),n)}}function xee(e,t,r){return t&&Z5(e.prototype,t),r&&Z5(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function bee(e,t,r){return t=qh(t),wee(e,aN()?Reflect.construct(t,r||[],qh(e).constructor):t.apply(e,r))}function wee(e,t){if(t&&(Tc(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return kee(e)}function kee(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function aN(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(aN=function(){return!!e})()}function qh(e){return qh=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},qh(e)}function See(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&dx(e,t)}function dx(e,t){return dx=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},dx(e,t)}function Bb(e,t,r){return t=iN(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function iN(e){var t=jee(e,"string");return Tc(t)=="symbol"?t:t+""}function jee(e,t){if(Tc(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(Tc(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var iu=function(e){function t(r){var n;return vee(this,t),n=bee(this,t,[r]),n.state={fontSize:"",letterSpacing:""},n}return See(t,e),xee(t,[{key:"shouldComponentUpdate",value:function(n,a){var i=n.viewBox,o=Vm(n,pee),s=this.props,l=s.viewBox,u=Vm(s,gee);return!nc(i,l)||!nc(o,u)||!nc(a,this.state)}},{key:"componentDidMount",value:function(){var n=this.layerReference;if(n){var a=n.getElementsByClassName("recharts-cartesian-axis-tick-value")[0];a&&this.setState({fontSize:window.getComputedStyle(a).fontSize,letterSpacing:window.getComputedStyle(a).letterSpacing})}}},{key:"getTickLineCoord",value:function(n){var a=this.props,i=a.x,o=a.y,s=a.width,l=a.height,u=a.orientation,f=a.tickSize,d=a.mirror,p=a.tickMargin,m,v,b,k,x,y,w=d?-1:1,_=n.tickSize||f,S=$e(n.tickCoord)?n.tickCoord:n.coordinate;switch(u){case"top":m=v=n.coordinate,k=o+ +!d*l,b=k-w*_,y=b-w*p,x=S;break;case"left":b=k=n.coordinate,v=i+ +!d*s,m=v-w*_,x=m-w*p,y=S;break;case"right":b=k=n.coordinate,v=i+ +d*s,m=v+w*_,x=m+w*p,y=S;break;default:m=v=n.coordinate,k=o+ +d*l,b=k+w*_,y=b+w*p,x=S;break}return{line:{x1:m,y1:b,x2:v,y2:k},tick:{x,y}}}},{key:"getTickTextAnchor",value:function(){var n=this.props,a=n.orientation,i=n.mirror,o;switch(a){case"left":o=i?"start":"end";break;case"right":o=i?"end":"start";break;default:o="middle";break}return o}},{key:"getTickVerticalAnchor",value:function(){var n=this.props,a=n.orientation,i=n.mirror,o="end";switch(a){case"left":case"right":o="middle";break;case"top":o=i?"start":"end";break;default:o=i?"end":"start";break}return o}},{key:"renderAxisLine",value:function(){var n=this.props,a=n.x,i=n.y,o=n.width,s=n.height,l=n.orientation,u=n.mirror,f=n.axisLine,d=Ln(Ln(Ln({},At(this.props,!1)),At(f,!1)),{},{fill:"none"});if(l==="top"||l==="bottom"){var p=+(l==="top"&&!u||l==="bottom"&&u);d=Ln(Ln({},d),{},{x1:a,y1:i+p*s,x2:a+o,y2:i+p*s})}else{var m=+(l==="left"&&!u||l==="right"&&u);d=Ln(Ln({},d),{},{x1:a+m*o,y1:i,x2:a+m*o,y2:i+s})}return J.createElement("line",Kl({},d,{className:lr("recharts-cartesian-axis-line",ui(f,"className"))}))}},{key:"renderTicks",value:function(n,a,i){var o=this,s=this.props,l=s.tickLine,u=s.stroke,f=s.tick,d=s.tickFormatter,p=s.unit,m=Lb(Ln(Ln({},this.props),{},{ticks:n}),a,i),v=this.getTickTextAnchor(),b=this.getTickVerticalAnchor(),k=At(this.props,!1),x=At(f,!1),y=Ln(Ln({},k),{},{fill:"none"},At(l,!1)),w=m.map(function(_,S){var j=o.getTickLineCoord(_),M=j.line,A=j.tick,$=Ln(Ln(Ln(Ln({textAnchor:v,verticalAnchor:b},k),{},{stroke:"none",fill:u},x),A),{},{index:S,payload:_,visibleTicksCount:m.length,tickFormatter:d});return J.createElement(kr,Kl({className:"recharts-cartesian-axis-tick",key:"tick-".concat(_.value,"-").concat(_.coordinate,"-").concat(_.tickCoord)},vf(o.props,_,S)),l&&J.createElement("line",Kl({},y,M,{className:lr("recharts-cartesian-axis-tick-line",ui(l,"className"))})),f&&t.renderTickItem(f,$,"".concat(Rt(d)?d(_.value,S):_.value).concat(p||"")))});return J.createElement("g",{className:"recharts-cartesian-axis-ticks"},w)}},{key:"render",value:function(){var n=this,a=this.props,i=a.axisLine,o=a.width,s=a.height,l=a.ticksGenerator,u=a.className,f=a.hide;if(f)return null;var d=this.props,p=d.ticks,m=Vm(d,mee),v=p;return Rt(l)&&(v=p&&p.length>0?l(this.props):l(m)),o<=0||s<=0||!v||!v.length?null:J.createElement(kr,{className:lr("recharts-cartesian-axis",u),ref:function(k){n.layerReference=k}},i&&this.renderAxisLine(),this.renderTicks(v,this.state.fontSize,this.state.letterSpacing),ia.renderCallByParent(this.props))}}],[{key:"renderTickItem",value:function(n,a,i){var o,s=lr(a.className,"recharts-cartesian-axis-tick-value");return J.isValidElement(n)?o=J.cloneElement(n,Ln(Ln({},a),{},{className:s})):Rt(n)?o=n(Ln(Ln({},a),{},{className:s})):o=J.createElement(gh,Kl({},a,{className:"recharts-cartesian-axis-tick-value"}),i),o}}])}(C.Component);Bb(iu,"displayName","CartesianAxis");Bb(iu,"defaultProps",{x:0,y:0,width:0,height:0,viewBox:{x:0,y:0,width:0,height:0},orientation:"bottom",ticks:[],stroke:"#666",tickLine:!0,axisLine:!0,tick:!0,mirror:!1,minTickGap:5,tickSize:6,tickMargin:2,interval:"preserveEnd"});var _ee=["x1","y1","x2","y2","key"],Pee=["offset"];function gl(e){"@babel/helpers - typeof";return gl=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},gl(e)}function Q5(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function pa(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Q5(Object(r),!0).forEach(function(n){Cee(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Q5(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Cee(e,t,r){return t=Nee(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Nee(e){var t=Mee(e,"string");return gl(t)=="symbol"?t:t+""}function Mee(e,t){if(gl(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(gl(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Vs(){return Vs=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Vs.apply(this,arguments)}function J5(e,t){if(e==null)return{};var r=Oee(e,t),n,a;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function Oee(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}var Aee=function(t){var r=t.fill;if(!r||r==="none")return null;var n=t.fillOpacity,a=t.x,i=t.y,o=t.width,s=t.height,l=t.ry;return J.createElement("rect",{x:a,y:i,ry:l,width:o,height:s,stroke:"none",fill:r,fillOpacity:n,className:"recharts-cartesian-grid-bg"})};function oN(e,t){var r;if(J.isValidElement(e))r=J.cloneElement(e,t);else if(Rt(e))r=e(t);else{var n=t.x1,a=t.y1,i=t.x2,o=t.y2,s=t.key,l=J5(t,_ee),u=At(l,!1);u.offset;var f=J5(u,Pee);r=J.createElement("line",Vs({},f,{x1:n,y1:a,x2:i,y2:o,fill:"none",key:s}))}return r}function Tee(e){var t=e.x,r=e.width,n=e.horizontal,a=n===void 0?!0:n,i=e.horizontalPoints;if(!a||!i||!i.length)return null;var o=i.map(function(s,l){var u=pa(pa({},e),{},{x1:t,y1:s,x2:t+r,y2:s,key:"line-".concat(l),index:l});return oN(a,u)});return J.createElement("g",{className:"recharts-cartesian-grid-horizontal"},o)}function Eee(e){var t=e.y,r=e.height,n=e.vertical,a=n===void 0?!0:n,i=e.verticalPoints;if(!a||!i||!i.length)return null;var o=i.map(function(s,l){var u=pa(pa({},e),{},{x1:s,y1:t,x2:s,y2:t+r,key:"line-".concat(l),index:l});return oN(a,u)});return J.createElement("g",{className:"recharts-cartesian-grid-vertical"},o)}function $ee(e){var t=e.horizontalFill,r=e.fillOpacity,n=e.x,a=e.y,i=e.width,o=e.height,s=e.horizontalPoints,l=e.horizontal,u=l===void 0?!0:l;if(!u||!t||!t.length)return null;var f=s.map(function(p){return Math.round(p+a-a)}).sort(function(p,m){return p-m});a!==f[0]&&f.unshift(0);var d=f.map(function(p,m){var v=!f[m+1],b=v?a+o-p:f[m+1]-p;if(b<=0)return null;var k=m%t.length;return J.createElement("rect",{key:"react-".concat(m),y:p,x:n,height:b,width:i,stroke:"none",fill:t[k],fillOpacity:r,className:"recharts-cartesian-grid-bg"})});return J.createElement("g",{className:"recharts-cartesian-gridstripes-horizontal"},d)}function Ree(e){var t=e.vertical,r=t===void 0?!0:t,n=e.verticalFill,a=e.fillOpacity,i=e.x,o=e.y,s=e.width,l=e.height,u=e.verticalPoints;if(!r||!n||!n.length)return null;var f=u.map(function(p){return Math.round(p+i-i)}).sort(function(p,m){return p-m});i!==f[0]&&f.unshift(0);var d=f.map(function(p,m){var v=!f[m+1],b=v?i+s-p:f[m+1]-p;if(b<=0)return null;var k=m%n.length;return J.createElement("rect",{key:"react-".concat(m),x:p,y:o,width:b,height:l,stroke:"none",fill:n[k],fillOpacity:a,className:"recharts-cartesian-grid-bg"})});return J.createElement("g",{className:"recharts-cartesian-gridstripes-vertical"},d)}var Dee=function(t,r){var n=t.xAxis,a=t.width,i=t.height,o=t.offset;return mC(Lb(pa(pa(pa({},iu.defaultProps),n),{},{ticks:po(n,!0),viewBox:{x:0,y:0,width:a,height:i}})),o.left,o.left+o.width,r)},Iee=function(t,r){var n=t.yAxis,a=t.width,i=t.height,o=t.offset;return mC(Lb(pa(pa(pa({},iu.defaultProps),n),{},{ticks:po(n,!0),viewBox:{x:0,y:0,width:a,height:i}})),o.top,o.top+o.height,r)},Tl={horizontal:!0,vertical:!0,stroke:"#ccc",fill:"none",verticalFill:[],horizontalFill:[]};function Ni(e){var t,r,n,a,i,o,s=Rb(),l=Db(),u=jJ(),f=pa(pa({},e),{},{stroke:(t=e.stroke)!==null&&t!==void 0?t:Tl.stroke,fill:(r=e.fill)!==null&&r!==void 0?r:Tl.fill,horizontal:(n=e.horizontal)!==null&&n!==void 0?n:Tl.horizontal,horizontalFill:(a=e.horizontalFill)!==null&&a!==void 0?a:Tl.horizontalFill,vertical:(i=e.vertical)!==null&&i!==void 0?i:Tl.vertical,verticalFill:(o=e.verticalFill)!==null&&o!==void 0?o:Tl.verticalFill,x:$e(e.x)?e.x:u.left,y:$e(e.y)?e.y:u.top,width:$e(e.width)?e.width:u.width,height:$e(e.height)?e.height:u.height}),d=f.x,p=f.y,m=f.width,v=f.height,b=f.syncWithTicks,k=f.horizontalValues,x=f.verticalValues,y=wJ(),w=kJ();if(!$e(m)||m<=0||!$e(v)||v<=0||!$e(d)||d!==+d||!$e(p)||p!==+p)return null;var _=f.verticalCoordinatesGenerator||Dee,S=f.horizontalCoordinatesGenerator||Iee,j=f.horizontalPoints,M=f.verticalPoints;if((!j||!j.length)&&Rt(S)){var A=k&&k.length,$=S({yAxis:w?pa(pa({},w),{},{ticks:A?k:w.ticks}):void 0,width:s,height:l,offset:u},A?!0:b);yo(Array.isArray($),"horizontalCoordinatesGenerator should return Array but instead it returned [".concat(gl($),"]")),Array.isArray($)&&(j=$)}if((!M||!M.length)&&Rt(_)){var E=x&&x.length,T=_({xAxis:y?pa(pa({},y),{},{ticks:E?x:y.ticks}):void 0,width:s,height:l,offset:u},E?!0:b);yo(Array.isArray(T),"verticalCoordinatesGenerator should return Array but instead it returned [".concat(gl(T),"]")),Array.isArray(T)&&(M=T)}return J.createElement("g",{className:"recharts-cartesian-grid"},J.createElement(Aee,{fill:f.fill,fillOpacity:f.fillOpacity,x:f.x,y:f.y,width:f.width,height:f.height,ry:f.ry}),J.createElement(Tee,Vs({},f,{offset:u,horizontalPoints:j,xAxis:y,yAxis:w})),J.createElement(Eee,Vs({},f,{offset:u,verticalPoints:M,xAxis:y,yAxis:w})),J.createElement($ee,Vs({},f,{horizontalPoints:j})),J.createElement(Ree,Vs({},f,{verticalPoints:M})))}Ni.displayName="CartesianGrid";var Lee=["type","layout","connectNulls","ref"],Bee=["key"];function Ec(e){"@babel/helpers - typeof";return Ec=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ec(e)}function e3(e,t){if(e==null)return{};var r=Fee(e,t),n,a;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function Fee(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function qu(){return qu=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},qu.apply(this,arguments)}function t3(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Ba(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?t3(Object(r),!0).forEach(function(n){Si(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):t3(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function El(e){return Wee(e)||zee(e)||Gee(e)||Uee()}function Uee(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Gee(e,t){if(e){if(typeof e=="string")return hx(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return hx(e,t)}}function zee(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function Wee(e){if(Array.isArray(e))return hx(e)}function hx(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Vee(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r3(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,lN(n.key),n)}}function Hee(e,t,r){return t&&r3(e.prototype,t),r&&r3(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Xee(e,t,r){return t=Yh(t),Kee(e,sN()?Reflect.construct(t,r||[],Yh(e).constructor):t.apply(e,r))}function Kee(e,t){if(t&&(Ec(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return qee(e)}function qee(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function sN(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(sN=function(){return!!e})()}function Yh(e){return Yh=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Yh(e)}function Yee(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&px(e,t)}function px(e,t){return px=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},px(e,t)}function Si(e,t,r){return t=lN(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function lN(e){var t=Zee(e,"string");return Ec(t)=="symbol"?t:t+""}function Zee(e,t){if(Ec(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(Ec(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var xn=function(e){function t(){var r;Vee(this,t);for(var n=arguments.length,a=new Array(n),i=0;i<n;i++)a[i]=arguments[i];return r=Xee(this,t,[].concat(a)),Si(r,"state",{isAnimationFinished:!0,totalLength:0}),Si(r,"generateSimpleStrokeDasharray",function(o,s){return"".concat(s,"px ").concat(o-s,"px")}),Si(r,"getStrokeDasharray",function(o,s,l){var u=l.reduce(function(x,y){return x+y});if(!u)return r.generateSimpleStrokeDasharray(s,o);for(var f=Math.floor(o/u),d=o%u,p=s-o,m=[],v=0,b=0;v<l.length;b+=l[v],++v)if(b+l[v]>d){m=[].concat(El(l.slice(0,v)),[d-b]);break}var k=m.length%2===0?[0,p]:[p];return[].concat(El(t.repeat(l,f)),El(m),k).map(function(x){return"".concat(x,"px")}).join(", ")}),Si(r,"id",bl("recharts-line-")),Si(r,"pathRef",function(o){r.mainCurve=o}),Si(r,"handleAnimationEnd",function(){r.setState({isAnimationFinished:!0}),r.props.onAnimationEnd&&r.props.onAnimationEnd()}),Si(r,"handleAnimationStart",function(){r.setState({isAnimationFinished:!1}),r.props.onAnimationStart&&r.props.onAnimationStart()}),r}return Yee(t,e),Hee(t,[{key:"componentDidMount",value:function(){if(this.props.isAnimationActive){var n=this.getTotalLength();this.setState({totalLength:n})}}},{key:"componentDidUpdate",value:function(){if(this.props.isAnimationActive){var n=this.getTotalLength();n!==this.state.totalLength&&this.setState({totalLength:n})}}},{key:"getTotalLength",value:function(){var n=this.mainCurve;try{return n&&n.getTotalLength&&n.getTotalLength()||0}catch{return 0}}},{key:"renderErrorBar",value:function(n,a){if(this.props.isAnimationActive&&!this.state.isAnimationFinished)return null;var i=this.props,o=i.points,s=i.xAxis,l=i.yAxis,u=i.layout,f=i.children,d=Ra(f,au);if(!d)return null;var p=function(b,k){return{x:b.x,y:b.y,value:b.value,errorVal:Wn(b.payload,k)}},m={clipPath:n?"url(#clipPath-".concat(a,")"):null};return J.createElement(kr,m,d.map(function(v){return J.cloneElement(v,{key:"bar-".concat(v.props.dataKey),data:o,xAxis:s,yAxis:l,layout:u,dataPointFormatter:p})}))}},{key:"renderDots",value:function(n,a,i){var o=this.props.isAnimationActive;if(o&&!this.state.isAnimationFinished)return null;var s=this.props,l=s.dot,u=s.points,f=s.dataKey,d=At(this.props,!1),p=At(l,!0),m=u.map(function(b,k){var x=Ba(Ba(Ba({key:"dot-".concat(k),r:3},d),p),{},{index:k,cx:b.x,cy:b.y,value:b.value,dataKey:f,payload:b.payload,points:u});return t.renderDotItem(l,x)}),v={clipPath:n?"url(#clipPath-".concat(a?"":"dots-").concat(i,")"):null};return J.createElement(kr,qu({className:"recharts-line-dots",key:"dots"},v),m)}},{key:"renderCurveStatically",value:function(n,a,i,o){var s=this.props,l=s.type,u=s.layout,f=s.connectNulls;s.ref;var d=e3(s,Lee),p=Ba(Ba(Ba({},At(d,!0)),{},{fill:"none",className:"recharts-line-curve",clipPath:a?"url(#clipPath-".concat(i,")"):null,points:n},o),{},{type:l,layout:u,connectNulls:f});return J.createElement(Qs,qu({},p,{pathRef:this.pathRef}))}},{key:"renderCurveWithAnimation",value:function(n,a){var i=this,o=this.props,s=o.points,l=o.strokeDasharray,u=o.isAnimationActive,f=o.animationBegin,d=o.animationDuration,p=o.animationEasing,m=o.animationId,v=o.animateNewValues,b=o.width,k=o.height,x=this.state,y=x.prevPoints,w=x.totalLength;return J.createElement(Ti,{begin:f,duration:d,isActive:u,easing:p,from:{t:0},to:{t:1},key:"line-".concat(m),onAnimationEnd:this.handleAnimationEnd,onAnimationStart:this.handleAnimationStart},function(_){var S=_.t;if(y){var j=y.length/s.length,M=s.map(function(B,U){var V=Math.floor(U*j);if(y[V]){var G=y[V],D=Cn(G.x,B.x),I=Cn(G.y,B.y);return Ba(Ba({},B),{},{x:D(S),y:I(S)})}if(v){var F=Cn(b*2,B.x),H=Cn(k/2,B.y);return Ba(Ba({},B),{},{x:F(S),y:H(S)})}return Ba(Ba({},B),{},{x:B.x,y:B.y})});return i.renderCurveStatically(M,n,a)}var A=Cn(0,w),$=A(S),E;if(l){var T="".concat(l).split(/[,\s]+/gim).map(function(B){return parseFloat(B)});E=i.getStrokeDasharray($,w,T)}else E=i.generateSimpleStrokeDasharray(w,$);return i.renderCurveStatically(s,n,a,{strokeDasharray:E})})}},{key:"renderCurve",value:function(n,a){var i=this.props,o=i.points,s=i.isAnimationActive,l=this.state,u=l.prevPoints,f=l.totalLength;return s&&o&&o.length&&(!u&&f>0||!dl(u,o))?this.renderCurveWithAnimation(n,a):this.renderCurveStatically(o,n,a)}},{key:"render",value:function(){var n,a=this.props,i=a.hide,o=a.dot,s=a.points,l=a.className,u=a.xAxis,f=a.yAxis,d=a.top,p=a.left,m=a.width,v=a.height,b=a.isAnimationActive,k=a.id;if(i||!s||!s.length)return null;var x=this.state.isAnimationFinished,y=s.length===1,w=lr("recharts-line",l),_=u&&u.allowDataOverflow,S=f&&f.allowDataOverflow,j=_||S,M=Ot(k)?this.id:k,A=(n=At(o,!1))!==null&&n!==void 0?n:{r:3,strokeWidth:2},$=A.r,E=$===void 0?3:$,T=A.strokeWidth,B=T===void 0?2:T,U=u_(o)?o:{},V=U.clipDot,G=V===void 0?!0:V,D=E*2+B;return J.createElement(kr,{className:w},_||S?J.createElement("defs",null,J.createElement("clipPath",{id:"clipPath-".concat(M)},J.createElement("rect",{x:_?p:p-m/2,y:S?d:d-v/2,width:_?m:m*2,height:S?v:v*2})),!G&&J.createElement("clipPath",{id:"clipPath-dots-".concat(M)},J.createElement("rect",{x:p-D/2,y:d-D/2,width:m+D,height:v+D}))):null,!y&&this.renderCurve(j,M),this.renderErrorBar(j,M),(y||o)&&this.renderDots(j,G,M),(!b||x)&&qi.renderCallByParent(this.props,s))}}],[{key:"getDerivedStateFromProps",value:function(n,a){return n.animationId!==a.prevAnimationId?{prevAnimationId:n.animationId,curPoints:n.points,prevPoints:a.curPoints}:n.points!==a.curPoints?{curPoints:n.points}:null}},{key:"repeat",value:function(n,a){for(var i=n.length%2!==0?[].concat(El(n),[0]):n,o=[],s=0;s<a;++s)o=[].concat(El(o),El(i));return o}},{key:"renderDotItem",value:function(n,a){var i;if(J.isValidElement(n))i=J.cloneElement(n,a);else if(Rt(n))i=n(a);else{var o=a.key,s=e3(a,Bee),l=lr("recharts-line-dot",typeof n!="boolean"?n.className:"");i=J.createElement(ng,qu({key:o},s,{className:l}))}return i}}])}(C.PureComponent);Si(xn,"displayName","Line");Si(xn,"defaultProps",{xAxisId:0,yAxisId:0,connectNulls:!1,activeDot:!0,dot:!0,legendType:"line",stroke:"#3182bd",strokeWidth:1,fill:"#fff",points:[],isAnimationActive:!vs.isSsr,animateNewValues:!0,animationBegin:0,animationDuration:1500,animationEasing:"ease",hide:!1,label:!1});Si(xn,"getComposedData",function(e){var t=e.props,r=e.xAxis,n=e.yAxis,a=e.xAxisTicks,i=e.yAxisTicks,o=e.dataKey,s=e.bandSize,l=e.displayedData,u=e.offset,f=t.layout,d=l.map(function(p,m){var v=Wn(p,o);return f==="horizontal"?{x:jc({axis:r,ticks:a,bandSize:s,entry:p,index:m}),y:Ot(v)?null:n.scale(v),value:v,payload:p}:{x:Ot(v)?null:r.scale(v),y:jc({axis:n,ticks:i,bandSize:s,entry:p,index:m}),value:v,payload:p}});return Ba({points:d,layout:f},u)});var Qee=["layout","type","stroke","connectNulls","isRange","ref"],Jee=["key"],cN;function $c(e){"@babel/helpers - typeof";return $c=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},$c(e)}function uN(e,t){if(e==null)return{};var r=ete(e,t),n,a;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function ete(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function Hs(){return Hs=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Hs.apply(this,arguments)}function n3(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Ro(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?n3(Object(r),!0).forEach(function(n){zi(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):n3(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function tte(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a3(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,dN(n.key),n)}}function rte(e,t,r){return t&&a3(e.prototype,t),r&&a3(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function nte(e,t,r){return t=Zh(t),ate(e,fN()?Reflect.construct(t,r||[],Zh(e).constructor):t.apply(e,r))}function ate(e,t){if(t&&($c(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return ite(e)}function ite(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function fN(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(fN=function(){return!!e})()}function Zh(e){return Zh=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Zh(e)}function ote(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&gx(e,t)}function gx(e,t){return gx=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},gx(e,t)}function zi(e,t,r){return t=dN(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function dN(e){var t=ste(e,"string");return $c(t)=="symbol"?t:t+""}function ste(e,t){if($c(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if($c(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var li=function(e){function t(){var r;tte(this,t);for(var n=arguments.length,a=new Array(n),i=0;i<n;i++)a[i]=arguments[i];return r=nte(this,t,[].concat(a)),zi(r,"state",{isAnimationFinished:!0}),zi(r,"id",bl("recharts-area-")),zi(r,"handleAnimationEnd",function(){var o=r.props.onAnimationEnd;r.setState({isAnimationFinished:!0}),Rt(o)&&o()}),zi(r,"handleAnimationStart",function(){var o=r.props.onAnimationStart;r.setState({isAnimationFinished:!1}),Rt(o)&&o()}),r}return ote(t,e),rte(t,[{key:"renderDots",value:function(n,a,i){var o=this.props.isAnimationActive,s=this.state.isAnimationFinished;if(o&&!s)return null;var l=this.props,u=l.dot,f=l.points,d=l.dataKey,p=At(this.props,!1),m=At(u,!0),v=f.map(function(k,x){var y=Ro(Ro(Ro({key:"dot-".concat(x),r:3},p),m),{},{index:x,cx:k.x,cy:k.y,dataKey:d,value:k.value,payload:k.payload,points:f});return t.renderDotItem(u,y)}),b={clipPath:n?"url(#clipPath-".concat(a?"":"dots-").concat(i,")"):null};return J.createElement(kr,Hs({className:"recharts-area-dots"},b),v)}},{key:"renderHorizontalRect",value:function(n){var a=this.props,i=a.baseLine,o=a.points,s=a.strokeWidth,l=o[0].x,u=o[o.length-1].x,f=n*Math.abs(l-u),d=Ko(o.map(function(p){return p.y||0}));return $e(i)&&typeof i=="number"?d=Math.max(i,d):i&&Array.isArray(i)&&i.length&&(d=Math.max(Ko(i.map(function(p){return p.y||0})),d)),$e(d)?J.createElement("rect",{x:l<u?l:l-f,y:0,width:f,height:Math.floor(d+(s?parseInt("".concat(s),10):1))}):null}},{key:"renderVerticalRect",value:function(n){var a=this.props,i=a.baseLine,o=a.points,s=a.strokeWidth,l=o[0].y,u=o[o.length-1].y,f=n*Math.abs(l-u),d=Ko(o.map(function(p){return p.x||0}));return $e(i)&&typeof i=="number"?d=Math.max(i,d):i&&Array.isArray(i)&&i.length&&(d=Math.max(Ko(i.map(function(p){return p.x||0})),d)),$e(d)?J.createElement("rect",{x:0,y:l<u?l:l-f,width:d+(s?parseInt("".concat(s),10):1),height:Math.floor(f)}):null}},{key:"renderClipRect",value:function(n){var a=this.props.layout;return a==="vertical"?this.renderVerticalRect(n):this.renderHorizontalRect(n)}},{key:"renderAreaStatically",value:function(n,a,i,o){var s=this.props,l=s.layout,u=s.type,f=s.stroke,d=s.connectNulls,p=s.isRange;s.ref;var m=uN(s,Qee);return J.createElement(kr,{clipPath:i?"url(#clipPath-".concat(o,")"):null},J.createElement(Qs,Hs({},At(m,!0),{points:n,connectNulls:d,type:u,baseLine:a,layout:l,stroke:"none",className:"recharts-area-area"})),f!=="none"&&J.createElement(Qs,Hs({},At(this.props,!1),{className:"recharts-area-curve",layout:l,type:u,connectNulls:d,fill:"none",points:n})),f!=="none"&&p&&J.createElement(Qs,Hs({},At(this.props,!1),{className:"recharts-area-curve",layout:l,type:u,connectNulls:d,fill:"none",points:a})))}},{key:"renderAreaWithAnimation",value:function(n,a){var i=this,o=this.props,s=o.points,l=o.baseLine,u=o.isAnimationActive,f=o.animationBegin,d=o.animationDuration,p=o.animationEasing,m=o.animationId,v=this.state,b=v.prevPoints,k=v.prevBaseLine;return J.createElement(Ti,{begin:f,duration:d,isActive:u,easing:p,from:{t:0},to:{t:1},key:"area-".concat(m),onAnimationEnd:this.handleAnimationEnd,onAnimationStart:this.handleAnimationStart},function(x){var y=x.t;if(b){var w=b.length/s.length,_=s.map(function(A,$){var E=Math.floor($*w);if(b[E]){var T=b[E],B=Cn(T.x,A.x),U=Cn(T.y,A.y);return Ro(Ro({},A),{},{x:B(y),y:U(y)})}return A}),S;if($e(l)&&typeof l=="number"){var j=Cn(k,l);S=j(y)}else if(Ot(l)||Zc(l)){var M=Cn(k,0);S=M(y)}else S=l.map(function(A,$){var E=Math.floor($*w);if(k[E]){var T=k[E],B=Cn(T.x,A.x),U=Cn(T.y,A.y);return Ro(Ro({},A),{},{x:B(y),y:U(y)})}return A});return i.renderAreaStatically(_,S,n,a)}return J.createElement(kr,null,J.createElement("defs",null,J.createElement("clipPath",{id:"animationClipPath-".concat(a)},i.renderClipRect(y))),J.createElement(kr,{clipPath:"url(#animationClipPath-".concat(a,")")},i.renderAreaStatically(s,l,n,a)))})}},{key:"renderArea",value:function(n,a){var i=this.props,o=i.points,s=i.baseLine,l=i.isAnimationActive,u=this.state,f=u.prevPoints,d=u.prevBaseLine,p=u.totalLength;return l&&o&&o.length&&(!f&&p>0||!dl(f,o)||!dl(d,s))?this.renderAreaWithAnimation(n,a):this.renderAreaStatically(o,s,n,a)}},{key:"render",value:function(){var n,a=this.props,i=a.hide,o=a.dot,s=a.points,l=a.className,u=a.top,f=a.left,d=a.xAxis,p=a.yAxis,m=a.width,v=a.height,b=a.isAnimationActive,k=a.id;if(i||!s||!s.length)return null;var x=this.state.isAnimationFinished,y=s.length===1,w=lr("recharts-area",l),_=d&&d.allowDataOverflow,S=p&&p.allowDataOverflow,j=_||S,M=Ot(k)?this.id:k,A=(n=At(o,!1))!==null&&n!==void 0?n:{r:3,strokeWidth:2},$=A.r,E=$===void 0?3:$,T=A.strokeWidth,B=T===void 0?2:T,U=u_(o)?o:{},V=U.clipDot,G=V===void 0?!0:V,D=E*2+B;return J.createElement(kr,{className:w},_||S?J.createElement("defs",null,J.createElement("clipPath",{id:"clipPath-".concat(M)},J.createElement("rect",{x:_?f:f-m/2,y:S?u:u-v/2,width:_?m:m*2,height:S?v:v*2})),!G&&J.createElement("clipPath",{id:"clipPath-dots-".concat(M)},J.createElement("rect",{x:f-D/2,y:u-D/2,width:m+D,height:v+D}))):null,y?null:this.renderArea(j,M),(o||y)&&this.renderDots(j,G,M),(!b||x)&&qi.renderCallByParent(this.props,s))}}],[{key:"getDerivedStateFromProps",value:function(n,a){return n.animationId!==a.prevAnimationId?{prevAnimationId:n.animationId,curPoints:n.points,curBaseLine:n.baseLine,prevPoints:a.curPoints,prevBaseLine:a.curBaseLine}:n.points!==a.curPoints||n.baseLine!==a.curBaseLine?{curPoints:n.points,curBaseLine:n.baseLine}:null}}])}(C.PureComponent);cN=li;zi(li,"displayName","Area");zi(li,"defaultProps",{stroke:"#3182bd",fill:"#3182bd",fillOpacity:.6,xAxisId:0,yAxisId:0,legendType:"line",connectNulls:!1,points:[],dot:!1,activeDot:!0,hide:!1,isAnimationActive:!vs.isSsr,animationBegin:0,animationDuration:1500,animationEasing:"ease"});zi(li,"getBaseValue",function(e,t,r,n){var a=e.layout,i=e.baseValue,o=t.props.baseValue,s=o??i;if($e(s)&&typeof s=="number")return s;var l=a==="horizontal"?n:r,u=l.scale.domain();if(l.type==="number"){var f=Math.max(u[0],u[1]),d=Math.min(u[0],u[1]);return s==="dataMin"?d:s==="dataMax"||f<0?f:Math.max(Math.min(u[0],u[1]),0)}return s==="dataMin"?u[0]:s==="dataMax"?u[1]:u[0]});zi(li,"getComposedData",function(e){var t=e.props,r=e.item,n=e.xAxis,a=e.yAxis,i=e.xAxisTicks,o=e.yAxisTicks,s=e.bandSize,l=e.dataKey,u=e.stackedData,f=e.dataStartIndex,d=e.displayedData,p=e.offset,m=t.layout,v=u&&u.length,b=cN.getBaseValue(t,r,n,a),k=m==="horizontal",x=!1,y=d.map(function(_,S){var j;v?j=u[f+S]:(j=Wn(_,l),Array.isArray(j)?x=!0:j=[b,j]);var M=j[1]==null||v&&Wn(_,l)==null;return k?{x:jc({axis:n,ticks:i,bandSize:s,entry:_,index:S}),y:M?null:a.scale(j[1]),value:j,payload:_}:{x:M?null:n.scale(j[1]),y:jc({axis:a,ticks:o,bandSize:s,entry:_,index:S}),value:j,payload:_}}),w;return v||x?w=y.map(function(_){var S=Array.isArray(_.value)?_.value[0]:null;return k?{x:_.x,y:S!=null&&_.y!=null?a.scale(S):null}:{x:S!=null?n.scale(S):null,y:_.y}}):w=k?a.scale(b):n.scale(b),Ro({points:y,baseLine:w,layout:m,isRange:x},p)});zi(li,"renderDotItem",function(e,t){var r;if(J.isValidElement(e))r=J.cloneElement(e,t);else if(Rt(e))r=e(t);else{var n=lr("recharts-area-dot",typeof e!="boolean"?e.className:""),a=t.key,i=uN(t,Jee);r=J.createElement(ng,Hs({},i,{key:a,className:n}))}return r});function Rc(e){"@babel/helpers - typeof";return Rc=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Rc(e)}function lte(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function cte(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,gN(n.key),n)}}function ute(e,t,r){return t&&cte(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function fte(e,t,r){return t=Qh(t),dte(e,hN()?Reflect.construct(t,r||[],Qh(e).constructor):t.apply(e,r))}function dte(e,t){if(t&&(Rc(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return hte(e)}function hte(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function hN(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(hN=function(){return!!e})()}function Qh(e){return Qh=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Qh(e)}function pte(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&mx(e,t)}function mx(e,t){return mx=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},mx(e,t)}function pN(e,t,r){return t=gN(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function gN(e){var t=gte(e,"string");return Rc(t)=="symbol"?t:t+""}function gte(e,t){if(Rc(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(Rc(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var cg=function(e){function t(){return lte(this,t),fte(this,t,arguments)}return pte(t,e),ute(t,[{key:"render",value:function(){return null}}])}(C.Component);pN(cg,"displayName","ZAxis");pN(cg,"defaultProps",{zAxisId:0,range:[64,64],scale:"auto",type:"number"});var mte=["option","isActive"];function Yu(){return Yu=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Yu.apply(this,arguments)}function yte(e,t){if(e==null)return{};var r=vte(e,t),n,a;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function vte(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function xte(e){var t=e.option,r=e.isActive,n=yte(e,mte);return typeof t=="string"?C.createElement(rx,Yu({option:C.createElement(Wp,Yu({type:t},n)),isActive:r,shapeType:"symbols"},n)):C.createElement(rx,Yu({option:t,isActive:r,shapeType:"symbols"},n))}function Dc(e){"@babel/helpers - typeof";return Dc=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Dc(e)}function Zu(){return Zu=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Zu.apply(this,arguments)}function i3(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function ni(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?i3(Object(r),!0).forEach(function(n){Zo(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):i3(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function bte(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o3(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,yN(n.key),n)}}function wte(e,t,r){return t&&o3(e.prototype,t),r&&o3(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function kte(e,t,r){return t=Jh(t),Ste(e,mN()?Reflect.construct(t,r||[],Jh(e).constructor):t.apply(e,r))}function Ste(e,t){if(t&&(Dc(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return jte(e)}function jte(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function mN(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(mN=function(){return!!e})()}function Jh(e){return Jh=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Jh(e)}function _te(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&yx(e,t)}function yx(e,t){return yx=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},yx(e,t)}function Zo(e,t,r){return t=yN(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function yN(e){var t=Pte(e,"string");return Dc(t)=="symbol"?t:t+""}function Pte(e,t){if(Dc(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(Dc(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var xa=function(e){function t(){var r;bte(this,t);for(var n=arguments.length,a=new Array(n),i=0;i<n;i++)a[i]=arguments[i];return r=kte(this,t,[].concat(a)),Zo(r,"state",{isAnimationFinished:!1}),Zo(r,"handleAnimationEnd",function(){r.setState({isAnimationFinished:!0})}),Zo(r,"handleAnimationStart",function(){r.setState({isAnimationFinished:!1})}),Zo(r,"id",bl("recharts-scatter-")),r}return _te(t,e),wte(t,[{key:"renderSymbolsStatically",value:function(n){var a=this,i=this.props,o=i.shape,s=i.activeShape,l=i.activeIndex,u=At(this.props,!1);return n.map(function(f,d){var p=l===d,m=p?s:o,v=ni(ni({},u),f);return J.createElement(kr,Zu({className:"recharts-scatter-symbol",key:"symbol-".concat(f==null?void 0:f.cx,"-").concat(f==null?void 0:f.cy,"-").concat(f==null?void 0:f.size,"-").concat(d)},vf(a.props,f,d),{role:"img"}),J.createElement(xte,Zu({option:m,isActive:p,key:"symbol-".concat(d)},v)))})}},{key:"renderSymbolsWithAnimation",value:function(){var n=this,a=this.props,i=a.points,o=a.isAnimationActive,s=a.animationBegin,l=a.animationDuration,u=a.animationEasing,f=a.animationId,d=this.state.prevPoints;return J.createElement(Ti,{begin:s,duration:l,isActive:o,easing:u,from:{t:0},to:{t:1},key:"pie-".concat(f),onAnimationEnd:this.handleAnimationEnd,onAnimationStart:this.handleAnimationStart},function(p){var m=p.t,v=i.map(function(b,k){var x=d&&d[k];if(x){var y=Cn(x.cx,b.cx),w=Cn(x.cy,b.cy),_=Cn(x.size,b.size);return ni(ni({},b),{},{cx:y(m),cy:w(m),size:_(m)})}var S=Cn(0,b.size);return ni(ni({},b),{},{size:S(m)})});return J.createElement(kr,null,n.renderSymbolsStatically(v))})}},{key:"renderSymbols",value:function(){var n=this.props,a=n.points,i=n.isAnimationActive,o=this.state.prevPoints;return i&&a&&a.length&&(!o||!dl(o,a))?this.renderSymbolsWithAnimation():this.renderSymbolsStatically(a)}},{key:"renderErrorBar",value:function(){var n=this.props.isAnimationActive;if(n&&!this.state.isAnimationFinished)return null;var a=this.props,i=a.points,o=a.xAxis,s=a.yAxis,l=a.children,u=Ra(l,au);return u?u.map(function(f,d){var p=f.props,m=p.direction,v=p.dataKey;return J.cloneElement(f,{key:"".concat(m,"-").concat(v,"-").concat(i[d]),data:i,xAxis:o,yAxis:s,layout:m==="x"?"vertical":"horizontal",dataPointFormatter:function(k,x){return{x:k.cx,y:k.cy,value:m==="x"?+k.node.x:+k.node.y,errorVal:Wn(k,x)}}})}):null}},{key:"renderLine",value:function(){var n=this.props,a=n.points,i=n.line,o=n.lineType,s=n.lineJointType,l=At(this.props,!1),u=At(i,!1),f,d;if(o==="joint")f=a.map(function(w){return{x:w.cx,y:w.cy}});else if(o==="fitting"){var p=e$(a),m=p.xmin,v=p.xmax,b=p.a,k=p.b,x=function(_){return b*_+k};f=[{x:m,y:x(m)},{x:v,y:x(v)}]}var y=ni(ni(ni({},l),{},{fill:"none",stroke:l&&l.fill},u),{},{points:f});return J.isValidElement(i)?d=J.cloneElement(i,y):Rt(i)?d=i(y):d=J.createElement(Qs,Zu({},y,{type:s})),J.createElement(kr,{className:"recharts-scatter-line",key:"recharts-scatter-line"},d)}},{key:"render",value:function(){var n=this.props,a=n.hide,i=n.points,o=n.line,s=n.className,l=n.xAxis,u=n.yAxis,f=n.left,d=n.top,p=n.width,m=n.height,v=n.id,b=n.isAnimationActive;if(a||!i||!i.length)return null;var k=this.state.isAnimationFinished,x=lr("recharts-scatter",s),y=l&&l.allowDataOverflow,w=u&&u.allowDataOverflow,_=y||w,S=Ot(v)?this.id:v;return J.createElement(kr,{className:x,clipPath:_?"url(#clipPath-".concat(S,")"):null},y||w?J.createElement("defs",null,J.createElement("clipPath",{id:"clipPath-".concat(S)},J.createElement("rect",{x:y?f:f-p/2,y:w?d:d-m/2,width:y?p:p*2,height:w?m:m*2}))):null,o&&this.renderLine(),this.renderErrorBar(),J.createElement(kr,{key:"recharts-scatter-symbols"},this.renderSymbols()),(!b||k)&&qi.renderCallByParent(this.props,i))}}],[{key:"getDerivedStateFromProps",value:function(n,a){return n.animationId!==a.prevAnimationId?{prevAnimationId:n.animationId,curPoints:n.points,prevPoints:a.curPoints}:n.points!==a.curPoints?{curPoints:n.points}:null}}])}(C.PureComponent);Zo(xa,"displayName","Scatter");Zo(xa,"defaultProps",{xAxisId:0,yAxisId:0,zAxisId:0,legendType:"circle",lineType:"joint",lineJointType:"linear",data:[],shape:"circle",hide:!1,isAnimationActive:!vs.isSsr,animationBegin:0,animationDuration:400,animationEasing:"linear"});Zo(xa,"getComposedData",function(e){var t=e.xAxis,r=e.yAxis,n=e.zAxis,a=e.item,i=e.displayedData,o=e.xAxisTicks,s=e.yAxisTicks,l=e.offset,u=a.props.tooltipType,f=Ra(a.props.children,ab),d=Ot(t.dataKey)?a.props.dataKey:t.dataKey,p=Ot(r.dataKey)?a.props.dataKey:r.dataKey,m=n&&n.dataKey,v=n?n.range:cg.defaultProps.range,b=v&&v[0],k=t.scale.bandwidth?t.scale.bandwidth():0,x=r.scale.bandwidth?r.scale.bandwidth():0,y=i.map(function(w,_){var S=Wn(w,d),j=Wn(w,p),M=!Ot(m)&&Wn(w,m)||"-",A=[{name:Ot(t.dataKey)?a.props.name:t.name||t.dataKey,unit:t.unit||"",value:S,payload:w,dataKey:d,type:u},{name:Ot(r.dataKey)?a.props.name:r.name||r.dataKey,unit:r.unit||"",value:j,payload:w,dataKey:p,type:u}];M!=="-"&&A.push({name:n.name||n.dataKey,unit:n.unit||"",value:M,payload:w,dataKey:m,type:u});var $=jc({axis:t,ticks:o,bandSize:k,entry:w,index:_,dataKey:d}),E=jc({axis:r,ticks:s,bandSize:x,entry:w,index:_,dataKey:p}),T=M!=="-"?n.scale(M):b,B=Math.sqrt(Math.max(T,0)/Math.PI);return ni(ni({},w),{},{cx:$,cy:E,x:$-B,y:E-B,xAxis:t,yAxis:r,zAxis:n,width:2*B,height:2*B,size:T,node:{x:S,y:j,z:M},tooltipPayload:A,tooltipPosition:{x:$,y:E},payload:w},f&&f[_]&&f[_].props)});return ni({points:y},l)});function Ic(e){"@babel/helpers - typeof";return Ic=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ic(e)}function Cte(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Nte(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,bN(n.key),n)}}function Mte(e,t,r){return t&&Nte(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function Ote(e,t,r){return t=ep(t),Ate(e,vN()?Reflect.construct(t,r||[],ep(e).constructor):t.apply(e,r))}function Ate(e,t){if(t&&(Ic(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Tte(e)}function Tte(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function vN(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(vN=function(){return!!e})()}function ep(e){return ep=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},ep(e)}function Ete(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&vx(e,t)}function vx(e,t){return vx=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},vx(e,t)}function xN(e,t,r){return t=bN(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function bN(e){var t=$te(e,"string");return Ic(t)=="symbol"?t:t+""}function $te(e,t){if(Ic(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(Ic(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}function xx(){return xx=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},xx.apply(this,arguments)}function Rte(e){var t=e.xAxisId,r=Rb(),n=Db(),a=qC(t);return a==null?null:C.createElement(iu,xx({},a,{className:lr("recharts-".concat(a.axisType," ").concat(a.axisType),a.className),viewBox:{x:0,y:0,width:r,height:n},ticksGenerator:function(o){return po(o,!0)}}))}var ka=function(e){function t(){return Cte(this,t),Ote(this,t,arguments)}return Ete(t,e),Mte(t,[{key:"render",value:function(){return C.createElement(Rte,this.props)}}])}(C.Component);xN(ka,"displayName","XAxis");xN(ka,"defaultProps",{allowDecimals:!0,hide:!1,orientation:"bottom",width:0,height:30,mirror:!1,xAxisId:0,tickCount:5,type:"category",padding:{left:0,right:0},allowDataOverflow:!1,scale:"auto",reversed:!1,allowDuplicatedCategory:!0});function Lc(e){"@babel/helpers - typeof";return Lc=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Lc(e)}function Dte(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Ite(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,SN(n.key),n)}}function Lte(e,t,r){return t&&Ite(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function Bte(e,t,r){return t=tp(t),Fte(e,wN()?Reflect.construct(t,r||[],tp(e).constructor):t.apply(e,r))}function Fte(e,t){if(t&&(Lc(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Ute(e)}function Ute(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function wN(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(wN=function(){return!!e})()}function tp(e){return tp=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},tp(e)}function Gte(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&bx(e,t)}function bx(e,t){return bx=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},bx(e,t)}function kN(e,t,r){return t=SN(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function SN(e){var t=zte(e,"string");return Lc(t)=="symbol"?t:t+""}function zte(e,t){if(Lc(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(Lc(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}function wx(){return wx=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},wx.apply(this,arguments)}var Wte=function(t){var r=t.yAxisId,n=Rb(),a=Db(),i=YC(r);return i==null?null:C.createElement(iu,wx({},i,{className:lr("recharts-".concat(i.axisType," ").concat(i.axisType),i.className),viewBox:{x:0,y:0,width:n,height:a},ticksGenerator:function(s){return po(s,!0)}}))},Sa=function(e){function t(){return Dte(this,t),Bte(this,t,arguments)}return Gte(t,e),Lte(t,[{key:"render",value:function(){return C.createElement(Wte,this.props)}}])}(C.Component);kN(Sa,"displayName","YAxis");kN(Sa,"defaultProps",{allowDuplicatedCategory:!0,allowDecimals:!0,hide:!1,orientation:"left",width:60,height:0,mirror:!1,yAxisId:0,tickCount:5,type:"number",padding:{top:0,bottom:0},allowDataOverflow:!1,scale:"auto",reversed:!1});function s3(e){return Kte(e)||Xte(e)||Hte(e)||Vte()}function Vte(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Hte(e,t){if(e){if(typeof e=="string")return kx(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return kx(e,t)}}function Xte(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function Kte(e){if(Array.isArray(e))return kx(e)}function kx(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var Sx=function(t,r,n,a,i){var o=Ra(t,Yo),s=Ra(t,dd),l=[].concat(s3(o),s3(s)),u=Ra(t,hd),f="".concat(a,"Id"),d=a[0],p=r;if(l.length&&(p=l.reduce(function(b,k){if(k.props[f]===n&&Yi(k.props,"extendDomain")&&$e(k.props[d])){var x=k.props[d];return[Math.min(b[0],x),Math.max(b[1],x)]}return b},p)),u.length){var m="".concat(d,"1"),v="".concat(d,"2");p=u.reduce(function(b,k){if(k.props[f]===n&&Yi(k.props,"extendDomain")&&$e(k.props[m])&&$e(k.props[v])){var x=k.props[m],y=k.props[v];return[Math.min(b[0],x,y),Math.max(b[1],x,y)]}return b},p)}return i&&i.length&&(p=i.reduce(function(b,k){return $e(k)?[Math.min(b[0],k),Math.max(b[1],k)]:b},p)),p},jN={exports:{}};(function(e){var t=Object.prototype.hasOwnProperty,r="~";function n(){}Object.create&&(n.prototype=Object.create(null),new n().__proto__||(r=!1));function a(l,u,f){this.fn=l,this.context=u,this.once=f||!1}function i(l,u,f,d,p){if(typeof f!="function")throw new TypeError("The listener must be a function");var m=new a(f,d||l,p),v=r?r+u:u;return l._events[v]?l._events[v].fn?l._events[v]=[l._events[v],m]:l._events[v].push(m):(l._events[v]=m,l._eventsCount++),l}function o(l,u){--l._eventsCount===0?l._events=new n:delete l._events[u]}function s(){this._events=new n,this._eventsCount=0}s.prototype.eventNames=function(){var u=[],f,d;if(this._eventsCount===0)return u;for(d in f=this._events)t.call(f,d)&&u.push(r?d.slice(1):d);return Object.getOwnPropertySymbols?u.concat(Object.getOwnPropertySymbols(f)):u},s.prototype.listeners=function(u){var f=r?r+u:u,d=this._events[f];if(!d)return[];if(d.fn)return[d.fn];for(var p=0,m=d.length,v=new Array(m);p<m;p++)v[p]=d[p].fn;return v},s.prototype.listenerCount=function(u){var f=r?r+u:u,d=this._events[f];return d?d.fn?1:d.length:0},s.prototype.emit=function(u,f,d,p,m,v){var b=r?r+u:u;if(!this._events[b])return!1;var k=this._events[b],x=arguments.length,y,w;if(k.fn){switch(k.once&&this.removeListener(u,k.fn,void 0,!0),x){case 1:return k.fn.call(k.context),!0;case 2:return k.fn.call(k.context,f),!0;case 3:return k.fn.call(k.context,f,d),!0;case 4:return k.fn.call(k.context,f,d,p),!0;case 5:return k.fn.call(k.context,f,d,p,m),!0;case 6:return k.fn.call(k.context,f,d,p,m,v),!0}for(w=1,y=new Array(x-1);w<x;w++)y[w-1]=arguments[w];k.fn.apply(k.context,y)}else{var _=k.length,S;for(w=0;w<_;w++)switch(k[w].once&&this.removeListener(u,k[w].fn,void 0,!0),x){case 1:k[w].fn.call(k[w].context);break;case 2:k[w].fn.call(k[w].context,f);break;case 3:k[w].fn.call(k[w].context,f,d);break;case 4:k[w].fn.call(k[w].context,f,d,p);break;default:if(!y)for(S=1,y=new Array(x-1);S<x;S++)y[S-1]=arguments[S];k[w].fn.apply(k[w].context,y)}}return!0},s.prototype.on=function(u,f,d){return i(this,u,f,d,!1)},s.prototype.once=function(u,f,d){return i(this,u,f,d,!0)},s.prototype.removeListener=function(u,f,d,p){var m=r?r+u:u;if(!this._events[m])return this;if(!f)return o(this,m),this;var v=this._events[m];if(v.fn)v.fn===f&&(!p||v.once)&&(!d||v.context===d)&&o(this,m);else{for(var b=0,k=[],x=v.length;b<x;b++)(v[b].fn!==f||p&&!v[b].once||d&&v[b].context!==d)&&k.push(v[b]);k.length?this._events[m]=k.length===1?k[0]:k:o(this,m)}return this},s.prototype.removeAllListeners=function(u){var f;return u?(f=r?r+u:u,this._events[f]&&o(this,f)):(this._events=new n,this._eventsCount=0),this},s.prototype.off=s.prototype.removeListener,s.prototype.addListener=s.prototype.on,s.prefixed=r,s.EventEmitter=s,e.exports=s})(jN);var qte=jN.exports;const Yte=Fr(qte);var Hm=new Yte,Xm="recharts.syncMouseEvents";function Qf(e){"@babel/helpers - typeof";return Qf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Qf(e)}function Zte(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Qte(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_N(n.key),n)}}function Jte(e,t,r){return t&&Qte(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function Km(e,t,r){return t=_N(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _N(e){var t=ere(e,"string");return Qf(t)=="symbol"?t:t+""}function ere(e,t){if(Qf(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(Qf(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var tre=function(){function e(){Zte(this,e),Km(this,"activeIndex",0),Km(this,"coordinateList",[]),Km(this,"layout","horizontal")}return Jte(e,[{key:"setDetails",value:function(r){var n,a=r.coordinateList,i=a===void 0?null:a,o=r.container,s=o===void 0?null:o,l=r.layout,u=l===void 0?null:l,f=r.offset,d=f===void 0?null:f,p=r.mouseHandlerCallback,m=p===void 0?null:p;this.coordinateList=(n=i??this.coordinateList)!==null&&n!==void 0?n:[],this.container=s??this.container,this.layout=u??this.layout,this.offset=d??this.offset,this.mouseHandlerCallback=m??this.mouseHandlerCallback,this.activeIndex=Math.min(Math.max(this.activeIndex,0),this.coordinateList.length-1)}},{key:"focus",value:function(){this.spoofMouse()}},{key:"keyboardEvent",value:function(r){if(this.coordinateList.length!==0)switch(r.key){case"ArrowRight":{if(this.layout!=="horizontal")return;this.activeIndex=Math.min(this.activeIndex+1,this.coordinateList.length-1),this.spoofMouse();break}case"ArrowLeft":{if(this.layout!=="horizontal")return;this.activeIndex=Math.max(this.activeIndex-1,0),this.spoofMouse();break}}}},{key:"setIndex",value:function(r){this.activeIndex=r}},{key:"spoofMouse",value:function(){var r,n;if(this.layout==="horizontal"&&this.coordinateList.length!==0){var a=this.container.getBoundingClientRect(),i=a.x,o=a.y,s=a.height,l=this.coordinateList[this.activeIndex].coordinate,u=((r=window)===null||r===void 0?void 0:r.scrollX)||0,f=((n=window)===null||n===void 0?void 0:n.scrollY)||0,d=i+l+u,p=o+this.offset.top+s/2+f;this.mouseHandlerCallback({pageX:d,pageY:p})}}}])}();function rre(e,t,r){if(r==="number"&&t===!0&&Array.isArray(e)){var n=e==null?void 0:e[0],a=e==null?void 0:e[1];if(n&&a&&$e(n)&&$e(a))return!0}return!1}function nre(e,t,r,n){var a=n/2;return{stroke:"none",fill:"#ccc",x:e==="horizontal"?t.x-a:r.left+.5,y:e==="horizontal"?r.top+.5:t.y-a,width:e==="horizontal"?n:r.width-1,height:e==="horizontal"?r.height-1:n}}function PN(e){var t=e.cx,r=e.cy,n=e.radius,a=e.startAngle,i=e.endAngle,o=oa(t,r,n,a),s=oa(t,r,n,i);return{points:[o,s],cx:t,cy:r,radius:n,startAngle:a,endAngle:i}}function are(e,t,r){var n,a,i,o;if(e==="horizontal")n=t.x,i=n,a=r.top,o=r.top+r.height;else if(e==="vertical")a=t.y,o=a,n=r.left,i=r.left+r.width;else if(t.cx!=null&&t.cy!=null)if(e==="centric"){var s=t.cx,l=t.cy,u=t.innerRadius,f=t.outerRadius,d=t.angle,p=oa(s,l,u,d),m=oa(s,l,f,d);n=p.x,a=p.y,i=m.x,o=m.y}else return PN(t);return[{x:n,y:a},{x:i,y:o}]}function Jf(e){"@babel/helpers - typeof";return Jf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Jf(e)}function l3(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function o0(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?l3(Object(r),!0).forEach(function(n){ire(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):l3(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function ire(e,t,r){return t=ore(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function ore(e){var t=sre(e,"string");return Jf(t)=="symbol"?t:t+""}function sre(e,t){if(Jf(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(Jf(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function lre(e){var t,r,n=e.element,a=e.tooltipEventType,i=e.isActive,o=e.activeCoordinate,s=e.activePayload,l=e.offset,u=e.activeTooltipIndex,f=e.tooltipAxisBandSize,d=e.layout,p=e.chartName,m=(t=n.props.cursor)!==null&&t!==void 0?t:(r=n.type.defaultProps)===null||r===void 0?void 0:r.cursor;if(!n||!m||!i||!o||p!=="ScatterChart"&&a!=="axis")return null;var v,b=Qs;if(p==="ScatterChart")v=o,b=$Y;else if(p==="BarChart")v=nre(d,o,l,f),b=Ob;else if(d==="radial"){var k=PN(o),x=k.cx,y=k.cy,w=k.radius,_=k.startAngle,S=k.endAngle;v={cx:x,cy:y,startAngle:_,endAngle:S,innerRadius:w,outerRadius:w},b=wC}else v={points:are(d,o,l)},b=Qs;var j=o0(o0(o0(o0({stroke:"#ccc",pointerEvents:"none"},l),v),At(m,!1)),{},{payload:s,payloadIndex:u,className:lr("recharts-tooltip-cursor",m.className)});return C.isValidElement(m)?C.cloneElement(m,j):C.createElement(b,j)}var cre=["item"],ure=["children","className","width","height","style","compact","title","desc"];function Bc(e){"@babel/helpers - typeof";return Bc=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Bc(e)}function ql(){return ql=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},ql.apply(this,arguments)}function c3(e,t){return hre(e)||dre(e,t)||NN(e,t)||fre()}function fre(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function dre(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,a,i,o,s=[],l=!0,u=!1;try{if(i=(r=r.call(e)).next,t!==0)for(;!(l=(n=i.call(r)).done)&&(s.push(n.value),s.length!==t);l=!0);}catch(f){u=!0,a=f}finally{try{if(!l&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(u)throw a}}return s}}function hre(e){if(Array.isArray(e))return e}function u3(e,t){if(e==null)return{};var r=pre(e,t),n,a;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function pre(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function gre(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function mre(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,MN(n.key),n)}}function yre(e,t,r){return t&&mre(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function vre(e,t,r){return t=rp(t),xre(e,CN()?Reflect.construct(t,r||[],rp(e).constructor):t.apply(e,r))}function xre(e,t){if(t&&(Bc(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return bre(e)}function bre(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function CN(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(CN=function(){return!!e})()}function rp(e){return rp=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},rp(e)}function wre(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&jx(e,t)}function jx(e,t){return jx=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},jx(e,t)}function Fc(e){return jre(e)||Sre(e)||NN(e)||kre()}function kre(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function NN(e,t){if(e){if(typeof e=="string")return _x(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return _x(e,t)}}function Sre(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function jre(e){if(Array.isArray(e))return _x(e)}function _x(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function f3(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function xe(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?f3(Object(r),!0).forEach(function(n){bt(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):f3(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function bt(e,t,r){return t=MN(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function MN(e){var t=_re(e,"string");return Bc(t)=="symbol"?t:t+""}function _re(e,t){if(Bc(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(Bc(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Pre={xAxis:["bottom","top"],yAxis:["left","right"]},Cre={width:"100%",height:"100%"},ON={x:0,y:0};function s0(e){return e}var Nre=function(t,r){return r==="horizontal"?t.x:r==="vertical"?t.y:r==="centric"?t.angle:t.radius},Mre=function(t,r,n,a){var i=r.find(function(f){return f&&f.index===n});if(i){if(t==="horizontal")return{x:i.coordinate,y:a.y};if(t==="vertical")return{x:a.x,y:i.coordinate};if(t==="centric"){var o=i.coordinate,s=a.radius;return xe(xe(xe({},a),oa(a.cx,a.cy,s,o)),{},{angle:o,radius:s})}var l=i.coordinate,u=a.angle;return xe(xe(xe({},a),oa(a.cx,a.cy,l,u)),{},{angle:u,radius:l})}return ON},ug=function(t,r){var n=r.graphicalItems,a=r.dataStartIndex,i=r.dataEndIndex,o=(n??[]).reduce(function(s,l){var u=l.props.data;return u&&u.length?[].concat(Fc(s),Fc(u)):s},[]);return o.length>0?o:t&&t.length&&$e(a)&&$e(i)?t.slice(a,i+1):[]};function AN(e){return e==="number"?[0,"auto"]:void 0}var Px=function(t,r,n,a){var i=t.graphicalItems,o=t.tooltipAxis,s=ug(r,t);return n<0||!i||!i.length||n>=s.length?null:i.reduce(function(l,u){var f,d=(f=u.props.data)!==null&&f!==void 0?f:r;d&&t.dataStartIndex+t.dataEndIndex!==0&&t.dataEndIndex-t.dataStartIndex>=n&&(d=d.slice(t.dataStartIndex,t.dataEndIndex+1));var p;if(o.dataKey&&!o.allowDuplicatedCategory){var m=d===void 0?s:d;p=eh(m,o.dataKey,a)}else p=d&&d[n]||s[n];return p?[].concat(Fc(l),[vC(u,p)]):l},[])},d3=function(t,r,n,a){var i=a||{x:t.chartX,y:t.chartY},o=Nre(i,n),s=t.orderedTooltipTicks,l=t.tooltipAxis,u=t.tooltipTicks,f=dX(o,s,u,l);if(f>=0&&u){var d=u[f]&&u[f].value,p=Px(t,r,f,d),m=Mre(n,s,f,i);return{activeTooltipIndex:f,activeLabel:d,activePayload:p,activeCoordinate:m}}return null},Ore=function(t,r){var n=r.axes,a=r.graphicalItems,i=r.axisType,o=r.axisIdKey,s=r.stackGroups,l=r.dataStartIndex,u=r.dataEndIndex,f=t.layout,d=t.children,p=t.stackOffset,m=gC(f,i);return n.reduce(function(v,b){var k,x=b.type.defaultProps!==void 0?xe(xe({},b.type.defaultProps),b.props):b.props,y=x.type,w=x.dataKey,_=x.allowDataOverflow,S=x.allowDuplicatedCategory,j=x.scale,M=x.ticks,A=x.includeHidden,$=x[o];if(v[$])return v;var E=ug(t.data,{graphicalItems:a.filter(function(q){var re,ee=o in q.props?q.props[o]:(re=q.type.defaultProps)===null||re===void 0?void 0:re[o];return ee===$}),dataStartIndex:l,dataEndIndex:u}),T=E.length,B,U,V;rre(x.domain,_,y)&&(B=Fv(x.domain,null,_),m&&(y==="number"||j!=="auto")&&(V=Xu(E,w,"category")));var G=AN(y);if(!B||B.length===0){var D,I=(D=x.domain)!==null&&D!==void 0?D:G;if(w){if(B=Xu(E,w,y),y==="category"&&m){var F=JE(B);S&&F?(U=B,B=Fh(0,T)):S||(B=zS(I,B,b).reduce(function(q,re){return q.indexOf(re)>=0?q:[].concat(Fc(q),[re])},[]))}else if(y==="category")S?B=B.filter(function(q){return q!==""&&!Ot(q)}):B=zS(I,B,b).reduce(function(q,re){return q.indexOf(re)>=0||re===""||Ot(re)?q:[].concat(Fc(q),[re])},[]);else if(y==="number"){var H=yX(E,a.filter(function(q){var re,ee,fe=o in q.props?q.props[o]:(re=q.type.defaultProps)===null||re===void 0?void 0:re[o],oe="hide"in q.props?q.props.hide:(ee=q.type.defaultProps)===null||ee===void 0?void 0:ee.hide;return fe===$&&(A||!oe)}),w,i,f);H&&(B=H)}m&&(y==="number"||j!=="auto")&&(V=Xu(E,w,"category"))}else m?B=Fh(0,T):s&&s[$]&&s[$].hasStack&&y==="number"?B=p==="expand"?[0,1]:yC(s[$].stackGroups,l,u):B=pC(E,a.filter(function(q){var re=o in q.props?q.props[o]:q.type.defaultProps[o],ee="hide"in q.props?q.props.hide:q.type.defaultProps.hide;return re===$&&(A||!ee)}),y,f,!0);if(y==="number")B=Sx(d,B,$,i,M),I&&(B=Fv(I,B,_));else if(y==="category"&&I){var W=I,Q=B.every(function(q){return W.indexOf(q)>=0});Q&&(B=W)}}return xe(xe({},v),{},bt({},$,xe(xe({},x),{},{axisType:i,domain:B,categoricalDomain:V,duplicateDomain:U,originalDomain:(k=x.domain)!==null&&k!==void 0?k:G,isCategorical:m,layout:f})))},{})},Are=function(t,r){var n=r.graphicalItems,a=r.Axis,i=r.axisType,o=r.axisIdKey,s=r.stackGroups,l=r.dataStartIndex,u=r.dataEndIndex,f=t.layout,d=t.children,p=ug(t.data,{graphicalItems:n,dataStartIndex:l,dataEndIndex:u}),m=p.length,v=gC(f,i),b=-1;return n.reduce(function(k,x){var y=x.type.defaultProps!==void 0?xe(xe({},x.type.defaultProps),x.props):x.props,w=y[o],_=AN("number");if(!k[w]){b++;var S;return v?S=Fh(0,m):s&&s[w]&&s[w].hasStack?(S=yC(s[w].stackGroups,l,u),S=Sx(d,S,w,i)):(S=Fv(_,pC(p,n.filter(function(j){var M,A,$=o in j.props?j.props[o]:(M=j.type.defaultProps)===null||M===void 0?void 0:M[o],E="hide"in j.props?j.props.hide:(A=j.type.defaultProps)===null||A===void 0?void 0:A.hide;return $===w&&!E}),"number",f),a.defaultProps.allowDataOverflow),S=Sx(d,S,w,i)),xe(xe({},k),{},bt({},w,xe(xe({axisType:i},a.defaultProps),{},{hide:!0,orientation:ui(Pre,"".concat(i,".").concat(b%2),null),domain:S,originalDomain:_,isCategorical:v,layout:f})))}return k},{})},Tre=function(t,r){var n=r.axisType,a=n===void 0?"xAxis":n,i=r.AxisComp,o=r.graphicalItems,s=r.stackGroups,l=r.dataStartIndex,u=r.dataEndIndex,f=t.children,d="".concat(a,"Id"),p=Ra(f,i),m={};return p&&p.length?m=Ore(t,{axes:p,graphicalItems:o,axisType:a,axisIdKey:d,stackGroups:s,dataStartIndex:l,dataEndIndex:u}):o&&o.length&&(m=Are(t,{Axis:i,graphicalItems:o,axisType:a,axisIdKey:d,stackGroups:s,dataStartIndex:l,dataEndIndex:u})),m},Ere=function(t){var r=Uo(t),n=po(r,!1,!0);return{tooltipTicks:n,orderedTooltipTicks:rb(n,function(a){return a.coordinate}),tooltipAxis:r,tooltipAxisBandSize:Oh(r,n)}},h3=function(t){var r=t.children,n=t.defaultShowTooltip,a=Ga(r,Cc),i=0,o=0;return t.data&&t.data.length!==0&&(o=t.data.length-1),a&&a.props&&(a.props.startIndex>=0&&(i=a.props.startIndex),a.props.endIndex>=0&&(o=a.props.endIndex)),{chartX:0,chartY:0,dataStartIndex:i,dataEndIndex:o,activeTooltipIndex:-1,isTooltipActive:!!n}},$re=function(t){return!t||!t.length?!1:t.some(function(r){var n=mo(r&&r.type);return n&&n.indexOf("Bar")>=0})},p3=function(t){return t==="horizontal"?{numericAxisName:"yAxis",cateAxisName:"xAxis"}:t==="vertical"?{numericAxisName:"xAxis",cateAxisName:"yAxis"}:t==="centric"?{numericAxisName:"radiusAxis",cateAxisName:"angleAxis"}:{numericAxisName:"angleAxis",cateAxisName:"radiusAxis"}},Rre=function(t,r){var n=t.props,a=t.graphicalItems,i=t.xAxisMap,o=i===void 0?{}:i,s=t.yAxisMap,l=s===void 0?{}:s,u=n.width,f=n.height,d=n.children,p=n.margin||{},m=Ga(d,Cc),v=Ga(d,Xi),b=Object.keys(l).reduce(function(S,j){var M=l[j],A=M.orientation;return!M.mirror&&!M.hide?xe(xe({},S),{},bt({},A,S[A]+M.width)):S},{left:p.left||0,right:p.right||0}),k=Object.keys(o).reduce(function(S,j){var M=o[j],A=M.orientation;return!M.mirror&&!M.hide?xe(xe({},S),{},bt({},A,ui(S,"".concat(A))+M.height)):S},{top:p.top||0,bottom:p.bottom||0}),x=xe(xe({},k),b),y=x.bottom;m&&(x.bottom+=m.props.height||Cc.defaultProps.height),v&&r&&(x=gX(x,a,n,r));var w=u-x.left-x.right,_=f-x.top-x.bottom;return xe(xe({brushBottom:y},x),{},{width:Math.max(w,0),height:Math.max(_,0)})},Dre=function(t,r){if(r==="xAxis")return t[r].width;if(r==="yAxis")return t[r].height},Fb=function(t){var r=t.chartName,n=t.GraphicalChild,a=t.defaultTooltipEventType,i=a===void 0?"axis":a,o=t.validateTooltipEventTypes,s=o===void 0?["axis"]:o,l=t.axisComponents,u=t.legendContent,f=t.formatAxisMap,d=t.defaultProps,p=function(x,y){var w=y.graphicalItems,_=y.stackGroups,S=y.offset,j=y.updateId,M=y.dataStartIndex,A=y.dataEndIndex,$=x.barSize,E=x.layout,T=x.barGap,B=x.barCategoryGap,U=x.maxBarSize,V=p3(E),G=V.numericAxisName,D=V.cateAxisName,I=$re(w),F=[];return w.forEach(function(H,W){var Q=ug(x.data,{graphicalItems:[H],dataStartIndex:M,dataEndIndex:A}),q=H.type.defaultProps!==void 0?xe(xe({},H.type.defaultProps),H.props):H.props,re=q.dataKey,ee=q.maxBarSize,fe=q["".concat(G,"Id")],oe=q["".concat(D,"Id")],ye={},ae=l.reduce(function(tt,mt){var wt=y["".concat(mt.axisType,"Map")],Qt=q["".concat(mt.axisType,"Id")];wt&&wt[Qt]||mt.axisType==="zAxis"||pl();var _t=wt[Qt];return xe(xe({},tt),{},bt(bt({},mt.axisType,_t),"".concat(mt.axisType,"Ticks"),po(_t)))},ye),X=ae[D],se=ae["".concat(D,"Ticks")],he=_&&_[fe]&&_[fe].hasStack&&MX(H,_[fe].stackGroups),le=mo(H.type).indexOf("Bar")>=0,je=Oh(X,se),ke=[],ve=I&&hX({barSize:$,stackGroups:_,totalSize:Dre(ae,D)});if(le){var ge,Me,Oe=Ot(ee)?U:ee,We=(ge=(Me=Oh(X,se,!0))!==null&&Me!==void 0?Me:Oe)!==null&&ge!==void 0?ge:0;ke=pX({barGap:T,barCategoryGap:B,bandSize:We!==je?We:je,sizeList:ve[oe],maxBarSize:Oe}),We!==je&&(ke=ke.map(function(tt){return xe(xe({},tt),{},{position:xe(xe({},tt.position),{},{offset:tt.position.offset-We/2})})}))}var Le=H&&H.type&&H.type.getComposedData;Le&&F.push({props:xe(xe({},Le(xe(xe({},ae),{},{displayedData:Q,props:x,dataKey:re,item:H,bandSize:je,barPosition:ke,offset:S,stackedData:he,layout:E,dataStartIndex:M,dataEndIndex:A}))),{},bt(bt(bt({key:H.key||"item-".concat(W)},G,ae[G]),D,ae[D]),"animationId",j)),childIndex:d$(H,x.children),item:H})}),F},m=function(x,y){var w=x.props,_=x.dataStartIndex,S=x.dataEndIndex,j=x.updateId;if(!Iw({props:w}))return null;var M=w.children,A=w.layout,$=w.stackOffset,E=w.data,T=w.reverseStackOrder,B=p3(A),U=B.numericAxisName,V=B.cateAxisName,G=Ra(M,n),D=PX(E,G,"".concat(U,"Id"),"".concat(V,"Id"),$,T),I=l.reduce(function(q,re){var ee="".concat(re.axisType,"Map");return xe(xe({},q),{},bt({},ee,Tre(w,xe(xe({},re),{},{graphicalItems:G,stackGroups:re.axisType===U&&D,dataStartIndex:_,dataEndIndex:S}))))},{}),F=Rre(xe(xe({},I),{},{props:w,graphicalItems:G}),y==null?void 0:y.legendBBox);Object.keys(I).forEach(function(q){I[q]=f(w,I[q],F,q.replace("Map",""),r)});var H=I["".concat(V,"Map")],W=Ere(H),Q=p(w,xe(xe({},I),{},{dataStartIndex:_,dataEndIndex:S,updateId:j,graphicalItems:G,stackGroups:D,offset:F}));return xe(xe({formattedGraphicalItems:Q,graphicalItems:G,offset:F,stackGroups:D},W),I)},v=function(k){function x(y){var w,_,S;return gre(this,x),S=vre(this,x,[y]),bt(S,"eventEmitterSymbol",Symbol("rechartsEventEmitter")),bt(S,"accessibilityManager",new tre),bt(S,"handleLegendBBoxUpdate",function(j){if(j){var M=S.state,A=M.dataStartIndex,$=M.dataEndIndex,E=M.updateId;S.setState(xe({legendBBox:j},m({props:S.props,dataStartIndex:A,dataEndIndex:$,updateId:E},xe(xe({},S.state),{},{legendBBox:j}))))}}),bt(S,"handleReceiveSyncEvent",function(j,M,A){if(S.props.syncId===j){if(A===S.eventEmitterSymbol&&typeof S.props.syncMethod!="function")return;S.applySyncEvent(M)}}),bt(S,"handleBrushChange",function(j){var M=j.startIndex,A=j.endIndex;if(M!==S.state.dataStartIndex||A!==S.state.dataEndIndex){var $=S.state.updateId;S.setState(function(){return xe({dataStartIndex:M,dataEndIndex:A},m({props:S.props,dataStartIndex:M,dataEndIndex:A,updateId:$},S.state))}),S.triggerSyncEvent({dataStartIndex:M,dataEndIndex:A})}}),bt(S,"handleMouseEnter",function(j){var M=S.getMouseInfo(j);if(M){var A=xe(xe({},M),{},{isTooltipActive:!0});S.setState(A),S.triggerSyncEvent(A);var $=S.props.onMouseEnter;Rt($)&&$(A,j)}}),bt(S,"triggeredAfterMouseMove",function(j){var M=S.getMouseInfo(j),A=M?xe(xe({},M),{},{isTooltipActive:!0}):{isTooltipActive:!1};S.setState(A),S.triggerSyncEvent(A);var $=S.props.onMouseMove;Rt($)&&$(A,j)}),bt(S,"handleItemMouseEnter",function(j){S.setState(function(){return{isTooltipActive:!0,activeItem:j,activePayload:j.tooltipPayload,activeCoordinate:j.tooltipPosition||{x:j.cx,y:j.cy}}})}),bt(S,"handleItemMouseLeave",function(){S.setState(function(){return{isTooltipActive:!1}})}),bt(S,"handleMouseMove",function(j){j.persist(),S.throttleTriggeredAfterMouseMove(j)}),bt(S,"handleMouseLeave",function(j){S.throttleTriggeredAfterMouseMove.cancel();var M={isTooltipActive:!1};S.setState(M),S.triggerSyncEvent(M);var A=S.props.onMouseLeave;Rt(A)&&A(M,j)}),bt(S,"handleOuterEvent",function(j){var M=f$(j),A=ui(S.props,"".concat(M));if(M&&Rt(A)){var $,E;/.*touch.*/i.test(M)?E=S.getMouseInfo(j.changedTouches[0]):E=S.getMouseInfo(j),A(($=E)!==null&&$!==void 0?$:{},j)}}),bt(S,"handleClick",function(j){var M=S.getMouseInfo(j);if(M){var A=xe(xe({},M),{},{isTooltipActive:!0});S.setState(A),S.triggerSyncEvent(A);var $=S.props.onClick;Rt($)&&$(A,j)}}),bt(S,"handleMouseDown",function(j){var M=S.props.onMouseDown;if(Rt(M)){var A=S.getMouseInfo(j);M(A,j)}}),bt(S,"handleMouseUp",function(j){var M=S.props.onMouseUp;if(Rt(M)){var A=S.getMouseInfo(j);M(A,j)}}),bt(S,"handleTouchMove",function(j){j.changedTouches!=null&&j.changedTouches.length>0&&S.throttleTriggeredAfterMouseMove(j.changedTouches[0])}),bt(S,"handleTouchStart",function(j){j.changedTouches!=null&&j.changedTouches.length>0&&S.handleMouseDown(j.changedTouches[0])}),bt(S,"handleTouchEnd",function(j){j.changedTouches!=null&&j.changedTouches.length>0&&S.handleMouseUp(j.changedTouches[0])}),bt(S,"handleDoubleClick",function(j){var M=S.props.onDoubleClick;if(Rt(M)){var A=S.getMouseInfo(j);M(A,j)}}),bt(S,"handleContextMenu",function(j){var M=S.props.onContextMenu;if(Rt(M)){var A=S.getMouseInfo(j);M(A,j)}}),bt(S,"triggerSyncEvent",function(j){S.props.syncId!==void 0&&Hm.emit(Xm,S.props.syncId,j,S.eventEmitterSymbol)}),bt(S,"applySyncEvent",function(j){var M=S.props,A=M.layout,$=M.syncMethod,E=S.state.updateId,T=j.dataStartIndex,B=j.dataEndIndex;if(j.dataStartIndex!==void 0||j.dataEndIndex!==void 0)S.setState(xe({dataStartIndex:T,dataEndIndex:B},m({props:S.props,dataStartIndex:T,dataEndIndex:B,updateId:E},S.state)));else if(j.activeTooltipIndex!==void 0){var U=j.chartX,V=j.chartY,G=j.activeTooltipIndex,D=S.state,I=D.offset,F=D.tooltipTicks;if(!I)return;if(typeof $=="function")G=$(F,j);else if($==="value"){G=-1;for(var H=0;H<F.length;H++)if(F[H].value===j.activeLabel){G=H;break}}var W=xe(xe({},I),{},{x:I.left,y:I.top}),Q=Math.min(U,W.x+W.width),q=Math.min(V,W.y+W.height),re=F[G]&&F[G].value,ee=Px(S.state,S.props.data,G),fe=F[G]?{x:A==="horizontal"?F[G].coordinate:Q,y:A==="horizontal"?q:F[G].coordinate}:ON;S.setState(xe(xe({},j),{},{activeLabel:re,activeCoordinate:fe,activePayload:ee,activeTooltipIndex:G}))}else S.setState(j)}),bt(S,"renderCursor",function(j){var M,A=S.state,$=A.isTooltipActive,E=A.activeCoordinate,T=A.activePayload,B=A.offset,U=A.activeTooltipIndex,V=A.tooltipAxisBandSize,G=S.getTooltipEventType(),D=(M=j.props.active)!==null&&M!==void 0?M:$,I=S.props.layout,F=j.key||"_recharts-cursor";return J.createElement(lre,{key:F,activeCoordinate:E,activePayload:T,activeTooltipIndex:U,chartName:r,element:j,isActive:D,layout:I,offset:B,tooltipAxisBandSize:V,tooltipEventType:G})}),bt(S,"renderPolarAxis",function(j,M,A){var $=ui(j,"type.axisType"),E=ui(S.state,"".concat($,"Map")),T=j.type.defaultProps,B=T!==void 0?xe(xe({},T),j.props):j.props,U=E&&E[B["".concat($,"Id")]];return C.cloneElement(j,xe(xe({},U),{},{className:lr($,U.className),key:j.key||"".concat(M,"-").concat(A),ticks:po(U,!0)}))}),bt(S,"renderPolarGrid",function(j){var M=j.props,A=M.radialLines,$=M.polarAngles,E=M.polarRadius,T=S.state,B=T.radiusAxisMap,U=T.angleAxisMap,V=Uo(B),G=Uo(U),D=G.cx,I=G.cy,F=G.innerRadius,H=G.outerRadius;return C.cloneElement(j,{polarAngles:Array.isArray($)?$:po(G,!0).map(function(W){return W.coordinate}),polarRadius:Array.isArray(E)?E:po(V,!0).map(function(W){return W.coordinate}),cx:D,cy:I,innerRadius:F,outerRadius:H,key:j.key||"polar-grid",radialLines:A})}),bt(S,"renderLegend",function(){var j=S.state.formattedGraphicalItems,M=S.props,A=M.children,$=M.width,E=M.height,T=S.props.margin||{},B=$-(T.left||0)-(T.right||0),U=dC({children:A,formattedGraphicalItems:j,legendWidth:B,legendContent:u});if(!U)return null;var V=U.item,G=u3(U,cre);return C.cloneElement(V,xe(xe({},G),{},{chartWidth:$,chartHeight:E,margin:T,onBBoxUpdate:S.handleLegendBBoxUpdate}))}),bt(S,"renderTooltip",function(){var j,M=S.props,A=M.children,$=M.accessibilityLayer,E=Ga(A,Un);if(!E)return null;var T=S.state,B=T.isTooltipActive,U=T.activeCoordinate,V=T.activePayload,G=T.activeLabel,D=T.offset,I=(j=E.props.active)!==null&&j!==void 0?j:B;return C.cloneElement(E,{viewBox:xe(xe({},D),{},{x:D.left,y:D.top}),active:I,label:G,payload:I?V:[],coordinate:U,accessibilityLayer:$})}),bt(S,"renderBrush",function(j){var M=S.props,A=M.margin,$=M.data,E=S.state,T=E.offset,B=E.dataStartIndex,U=E.dataEndIndex,V=E.updateId;return C.cloneElement(j,{key:j.key||"_recharts-brush",onChange:r0(S.handleBrushChange,j.props.onChange),data:$,x:$e(j.props.x)?j.props.x:T.left,y:$e(j.props.y)?j.props.y:T.top+T.height+T.brushBottom-(A.bottom||0),width:$e(j.props.width)?j.props.width:T.width,startIndex:B,endIndex:U,updateId:"brush-".concat(V)})}),bt(S,"renderReferenceElement",function(j,M,A){if(!j)return null;var $=S,E=$.clipPathId,T=S.state,B=T.xAxisMap,U=T.yAxisMap,V=T.offset,G=j.type.defaultProps||{},D=j.props,I=D.xAxisId,F=I===void 0?G.xAxisId:I,H=D.yAxisId,W=H===void 0?G.yAxisId:H;return C.cloneElement(j,{key:j.key||"".concat(M,"-").concat(A),xAxis:B[F],yAxis:U[W],viewBox:{x:V.left,y:V.top,width:V.width,height:V.height},clipPathId:E})}),bt(S,"renderActivePoints",function(j){var M=j.item,A=j.activePoint,$=j.basePoint,E=j.childIndex,T=j.isRange,B=[],U=M.props.key,V=M.item.type.defaultProps!==void 0?xe(xe({},M.item.type.defaultProps),M.item.props):M.item.props,G=V.activeDot,D=V.dataKey,I=xe(xe({index:E,dataKey:D,cx:A.x,cy:A.y,r:4,fill:Mb(M.item),strokeWidth:2,stroke:"#fff",payload:A.payload,value:A.value},At(G,!1)),th(G));return B.push(x.renderActiveDot(G,I,"".concat(U,"-activePoint-").concat(E))),$?B.push(x.renderActiveDot(G,xe(xe({},I),{},{cx:$.x,cy:$.y}),"".concat(U,"-basePoint-").concat(E))):T&&B.push(null),B}),bt(S,"renderGraphicChild",function(j,M,A){var $=S.filterFormatItem(j,M,A);if(!$)return null;var E=S.getTooltipEventType(),T=S.state,B=T.isTooltipActive,U=T.tooltipAxis,V=T.activeTooltipIndex,G=T.activeLabel,D=S.props.children,I=Ga(D,Un),F=$.props,H=F.points,W=F.isRange,Q=F.baseLine,q=$.item.type.defaultProps!==void 0?xe(xe({},$.item.type.defaultProps),$.item.props):$.item.props,re=q.activeDot,ee=q.hide,fe=q.activeBar,oe=q.activeShape,ye=!!(!ee&&B&&I&&(re||fe||oe)),ae={};E!=="axis"&&I&&I.props.trigger==="click"?ae={onClick:r0(S.handleItemMouseEnter,j.props.onClick)}:E!=="axis"&&(ae={onMouseLeave:r0(S.handleItemMouseLeave,j.props.onMouseLeave),onMouseEnter:r0(S.handleItemMouseEnter,j.props.onMouseEnter)});var X=C.cloneElement(j,xe(xe({},$.props),ae));function se(mt){return typeof U.dataKey=="function"?U.dataKey(mt.payload):null}if(ye)if(V>=0){var he,le;if(U.dataKey&&!U.allowDuplicatedCategory){var je=typeof U.dataKey=="function"?se:"payload.".concat(U.dataKey.toString());he=eh(H,je,G),le=W&&Q&&eh(Q,je,G)}else he=H==null?void 0:H[V],le=W&&Q&&Q[V];if(oe||fe){var ke=j.props.activeIndex!==void 0?j.props.activeIndex:V;return[C.cloneElement(j,xe(xe(xe({},$.props),ae),{},{activeIndex:ke})),null,null]}if(!Ot(he))return[X].concat(Fc(S.renderActivePoints({item:$,activePoint:he,basePoint:le,childIndex:V,isRange:W})))}else{var ve,ge=(ve=S.getItemByXY(S.state.activeCoordinate))!==null&&ve!==void 0?ve:{graphicalItem:X},Me=ge.graphicalItem,Oe=Me.item,We=Oe===void 0?j:Oe,Le=Me.childIndex,tt=xe(xe(xe({},$.props),ae),{},{activeIndex:Le});return[C.cloneElement(We,tt),null,null]}return W?[X,null,null]:[X,null]}),bt(S,"renderCustomized",function(j,M,A){return C.cloneElement(j,xe(xe({key:"recharts-customized-".concat(A)},S.props),S.state))}),bt(S,"renderMap",{CartesianGrid:{handler:s0,once:!0},ReferenceArea:{handler:S.renderReferenceElement},ReferenceLine:{handler:s0},ReferenceDot:{handler:S.renderReferenceElement},XAxis:{handler:s0},YAxis:{handler:s0},Brush:{handler:S.renderBrush,once:!0},Bar:{handler:S.renderGraphicChild},Line:{handler:S.renderGraphicChild},Area:{handler:S.renderGraphicChild},Radar:{handler:S.renderGraphicChild},RadialBar:{handler:S.renderGraphicChild},Scatter:{handler:S.renderGraphicChild},Pie:{handler:S.renderGraphicChild},Funnel:{handler:S.renderGraphicChild},Tooltip:{handler:S.renderCursor,once:!0},PolarGrid:{handler:S.renderPolarGrid,once:!0},PolarAngleAxis:{handler:S.renderPolarAxis},PolarRadiusAxis:{handler:S.renderPolarAxis},Customized:{handler:S.renderCustomized}}),S.clipPathId="".concat((w=y.id)!==null&&w!==void 0?w:bl("recharts"),"-clip"),S.throttleTriggeredAfterMouseMove=hP(S.triggeredAfterMouseMove,(_=y.throttleDelay)!==null&&_!==void 0?_:1e3/60),S.state={},S}return wre(x,k),yre(x,[{key:"componentDidMount",value:function(){var w,_;this.addListener(),this.accessibilityManager.setDetails({container:this.container,offset:{left:(w=this.props.margin.left)!==null&&w!==void 0?w:0,top:(_=this.props.margin.top)!==null&&_!==void 0?_:0},coordinateList:this.state.tooltipTicks,mouseHandlerCallback:this.triggeredAfterMouseMove,layout:this.props.layout}),this.displayDefaultTooltip()}},{key:"displayDefaultTooltip",value:function(){var w=this.props,_=w.children,S=w.data,j=w.height,M=w.layout,A=Ga(_,Un);if(A){var $=A.props.defaultIndex;if(!(typeof $!="number"||$<0||$>this.state.tooltipTicks.length-1)){var E=this.state.tooltipTicks[$]&&this.state.tooltipTicks[$].value,T=Px(this.state,S,$,E),B=this.state.tooltipTicks[$].coordinate,U=(this.state.offset.top+j)/2,V=M==="horizontal",G=V?{x:B,y:U}:{y:B,x:U},D=this.state.formattedGraphicalItems.find(function(F){var H=F.item;return H.type.name==="Scatter"});D&&(G=xe(xe({},G),D.props.points[$].tooltipPosition),T=D.props.points[$].tooltipPayload);var I={activeTooltipIndex:$,isTooltipActive:!0,activeLabel:E,activePayload:T,activeCoordinate:G};this.setState(I),this.renderCursor(A),this.accessibilityManager.setIndex($)}}}},{key:"getSnapshotBeforeUpdate",value:function(w,_){if(!this.props.accessibilityLayer)return null;if(this.state.tooltipTicks!==_.tooltipTicks&&this.accessibilityManager.setDetails({coordinateList:this.state.tooltipTicks}),this.props.layout!==w.layout&&this.accessibilityManager.setDetails({layout:this.props.layout}),this.props.margin!==w.margin){var S,j;this.accessibilityManager.setDetails({offset:{left:(S=this.props.margin.left)!==null&&S!==void 0?S:0,top:(j=this.props.margin.top)!==null&&j!==void 0?j:0}})}return null}},{key:"componentDidUpdate",value:function(w){tv([Ga(w.children,Un)],[Ga(this.props.children,Un)])||this.displayDefaultTooltip()}},{key:"componentWillUnmount",value:function(){this.removeListener(),this.throttleTriggeredAfterMouseMove.cancel()}},{key:"getTooltipEventType",value:function(){var w=Ga(this.props.children,Un);if(w&&typeof w.props.shared=="boolean"){var _=w.props.shared?"axis":"item";return s.indexOf(_)>=0?_:i}return i}},{key:"getMouseInfo",value:function(w){if(!this.container)return null;var _=this.container,S=_.getBoundingClientRect(),j=LG(S),M={chartX:Math.round(w.pageX-j.left),chartY:Math.round(w.pageY-j.top)},A=S.width/_.offsetWidth||1,$=this.inRange(M.chartX,M.chartY,A);if(!$)return null;var E=this.state,T=E.xAxisMap,B=E.yAxisMap,U=this.getTooltipEventType(),V=d3(this.state,this.props.data,this.props.layout,$);if(U!=="axis"&&T&&B){var G=Uo(T).scale,D=Uo(B).scale,I=G&&G.invert?G.invert(M.chartX):null,F=D&&D.invert?D.invert(M.chartY):null;return xe(xe({},M),{},{xValue:I,yValue:F},V)}return V?xe(xe({},M),V):null}},{key:"inRange",value:function(w,_){var S=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1,j=this.props.layout,M=w/S,A=_/S;if(j==="horizontal"||j==="vertical"){var $=this.state.offset,E=M>=$.left&&M<=$.left+$.width&&A>=$.top&&A<=$.top+$.height;return E?{x:M,y:A}:null}var T=this.state,B=T.angleAxisMap,U=T.radiusAxisMap;if(B&&U){var V=Uo(B);return HS({x:M,y:A},V)}return null}},{key:"parseEventsOfWrapper",value:function(){var w=this.props.children,_=this.getTooltipEventType(),S=Ga(w,Un),j={};S&&_==="axis"&&(S.props.trigger==="click"?j={onClick:this.handleClick}:j={onMouseEnter:this.handleMouseEnter,onDoubleClick:this.handleDoubleClick,onMouseMove:this.handleMouseMove,onMouseLeave:this.handleMouseLeave,onTouchMove:this.handleTouchMove,onTouchStart:this.handleTouchStart,onTouchEnd:this.handleTouchEnd,onContextMenu:this.handleContextMenu});var M=th(this.props,this.handleOuterEvent);return xe(xe({},M),j)}},{key:"addListener",value:function(){Hm.on(Xm,this.handleReceiveSyncEvent)}},{key:"removeListener",value:function(){Hm.removeListener(Xm,this.handleReceiveSyncEvent)}},{key:"filterFormatItem",value:function(w,_,S){for(var j=this.state.formattedGraphicalItems,M=0,A=j.length;M<A;M++){var $=j[M];if($.item===w||$.props.key===w.key||_===mo($.item.type)&&S===$.childIndex)return $}return null}},{key:"renderClipPath",value:function(){var w=this.clipPathId,_=this.state.offset,S=_.left,j=_.top,M=_.height,A=_.width;return J.createElement("defs",null,J.createElement("clipPath",{id:w},J.createElement("rect",{x:S,y:j,height:M,width:A})))}},{key:"getXScales",value:function(){var w=this.state.xAxisMap;return w?Object.entries(w).reduce(function(_,S){var j=c3(S,2),M=j[0],A=j[1];return xe(xe({},_),{},bt({},M,A.scale))},{}):null}},{key:"getYScales",value:function(){var w=this.state.yAxisMap;return w?Object.entries(w).reduce(function(_,S){var j=c3(S,2),M=j[0],A=j[1];return xe(xe({},_),{},bt({},M,A.scale))},{}):null}},{key:"getXScaleByAxisId",value:function(w){var _;return(_=this.state.xAxisMap)===null||_===void 0||(_=_[w])===null||_===void 0?void 0:_.scale}},{key:"getYScaleByAxisId",value:function(w){var _;return(_=this.state.yAxisMap)===null||_===void 0||(_=_[w])===null||_===void 0?void 0:_.scale}},{key:"getItemByXY",value:function(w){var _=this.state,S=_.formattedGraphicalItems,j=_.activeItem;if(S&&S.length)for(var M=0,A=S.length;M<A;M++){var $=S[M],E=$.props,T=$.item,B=T.type.defaultProps!==void 0?xe(xe({},T.type.defaultProps),T.props):T.props,U=mo(T.type);if(U==="Bar"){var V=(E.data||[]).find(function(F){return jY(w,F)});if(V)return{graphicalItem:$,payload:V}}else if(U==="RadialBar"){var G=(E.data||[]).find(function(F){return HS(w,F)});if(G)return{graphicalItem:$,payload:G}}else if(ag($,j)||ig($,j)||Xf($,j)){var D=PZ({graphicalItem:$,activeTooltipItem:j,itemData:B.data}),I=B.activeIndex===void 0?D:B.activeIndex;return{graphicalItem:xe(xe({},$),{},{childIndex:I}),payload:Xf($,j)?B.data[D]:$.props.data[D]}}}return null}},{key:"render",value:function(){var w=this;if(!Iw(this))return null;var _=this.props,S=_.children,j=_.className,M=_.width,A=_.height,$=_.style,E=_.compact,T=_.title,B=_.desc,U=u3(_,ure),V=At(U,!1);if(E)return J.createElement(U5,{state:this.state,width:this.props.width,height:this.props.height,clipPathId:this.clipPathId},J.createElement(nv,ql({},V,{width:M,height:A,title:T,desc:B}),this.renderClipPath(),Bw(S,this.renderMap)));if(this.props.accessibilityLayer){var G,D;V.tabIndex=(G=this.props.tabIndex)!==null&&G!==void 0?G:0,V.role=(D=this.props.role)!==null&&D!==void 0?D:"application",V.onKeyDown=function(F){w.accessibilityManager.keyboardEvent(F)},V.onFocus=function(){w.accessibilityManager.focus()}}var I=this.parseEventsOfWrapper();return J.createElement(U5,{state:this.state,width:this.props.width,height:this.props.height,clipPathId:this.clipPathId},J.createElement("div",ql({className:lr("recharts-wrapper",j),style:xe({position:"relative",cursor:"default",width:M,height:A},$)},I,{ref:function(H){w.container=H}}),J.createElement(nv,ql({},V,{width:M,height:A,title:T,desc:B,style:Cre}),this.renderClipPath(),Bw(S,this.renderMap)),this.renderLegend(),this.renderTooltip()))}}])}(C.Component);bt(v,"displayName",r),bt(v,"defaultProps",xe({layout:"horizontal",stackOffset:"none",barCategoryGap:"10%",barGap:4,margin:{top:5,right:5,bottom:5,left:5},reverseStackOrder:!1,syncMethod:"index"},d)),bt(v,"getDerivedStateFromProps",function(k,x){var y=k.dataKey,w=k.data,_=k.children,S=k.width,j=k.height,M=k.layout,A=k.stackOffset,$=k.margin,E=x.dataStartIndex,T=x.dataEndIndex;if(x.updateId===void 0){var B=h3(k);return xe(xe(xe({},B),{},{updateId:0},m(xe(xe({props:k},B),{},{updateId:0}),x)),{},{prevDataKey:y,prevData:w,prevWidth:S,prevHeight:j,prevLayout:M,prevStackOffset:A,prevMargin:$,prevChildren:_})}if(y!==x.prevDataKey||w!==x.prevData||S!==x.prevWidth||j!==x.prevHeight||M!==x.prevLayout||A!==x.prevStackOffset||!nc($,x.prevMargin)){var U=h3(k),V={chartX:x.chartX,chartY:x.chartY,isTooltipActive:x.isTooltipActive},G=xe(xe({},d3(x,w,M)),{},{updateId:x.updateId+1}),D=xe(xe(xe({},U),V),G);return xe(xe(xe({},D),m(xe({props:k},D),x)),{},{prevDataKey:y,prevData:w,prevWidth:S,prevHeight:j,prevLayout:M,prevStackOffset:A,prevMargin:$,prevChildren:_})}if(!tv(_,x.prevChildren)){var I,F,H,W,Q=Ga(_,Cc),q=Q&&(I=(F=Q.props)===null||F===void 0?void 0:F.startIndex)!==null&&I!==void 0?I:E,re=Q&&(H=(W=Q.props)===null||W===void 0?void 0:W.endIndex)!==null&&H!==void 0?H:T,ee=q!==E||re!==T,fe=!Ot(w),oe=fe&&!ee?x.updateId:x.updateId+1;return xe(xe({updateId:oe},m(xe(xe({props:k},x),{},{updateId:oe,dataStartIndex:q,dataEndIndex:re}),x)),{},{prevChildren:_,dataStartIndex:q,dataEndIndex:re})}return null}),bt(v,"renderActiveDot",function(k,x,y){var w;return C.isValidElement(k)?w=C.cloneElement(k,x):Rt(k)?w=k(x):w=J.createElement(ng,x),J.createElement(kr,{className:"recharts-active-dot",key:y},w)});var b=C.forwardRef(function(x,y){return J.createElement(v,ql({},x,{ref:y}))});return b.displayName=v.displayName,b},Xs=Fb({chartName:"LineChart",GraphicalChild:xn,axisComponents:[{axisType:"xAxis",AxisComp:ka},{axisType:"yAxis",AxisComp:Sa}],formatAxisMap:Ab}),Ire=Fb({chartName:"ScatterChart",GraphicalChild:xa,defaultTooltipEventType:"item",validateTooltipEventTypes:["item"],axisComponents:[{axisType:"xAxis",AxisComp:ka},{axisType:"yAxis",AxisComp:Sa},{axisType:"zAxis",AxisComp:cg}],formatAxisMap:Ab}),TN=Fb({chartName:"AreaChart",GraphicalChild:li,axisComponents:[{axisType:"xAxis",AxisComp:ka},{axisType:"yAxis",AxisComp:Sa}],formatAxisMap:Ab});const oo=(e,t)=>{const r=localStorage.getItem(e);return r===null?t:typeof t=="boolean"?r==="true":typeof t=="number"?Number(r):r},Lre=({isOpen:e,onClose:t,onMinimize:r,rawImageData:n,roi:a,isBGGR:i,zIndex:o,onFocus:s,initialPosition:l,initialInternalState:u,onUpdateState:f,stackFiles:d})=>{const[p,m]=C.useState(()=>(u==null?void 0:u.channelMode)??oo("hist_mode","All")),[v,b]=C.useState(()=>(u==null?void 0:u.minVal)??oo("hist_min",0)),[k,x]=C.useState(()=>(u==null?void 0:u.maxVal)??oo("hist_max",16383)),[y,w]=C.useState(()=>(u==null?void 0:u.binCount)??oo("hist_bins",100)),[_,S]=C.useState(()=>(u==null?void 0:u.pointToPoint)??oo("hist_ptp",!1)),[j,M]=C.useState(()=>(u==null?void 0:u.showTheo)??oo("hist_show_theo",!1)),[A,$]=C.useState(()=>(u==null?void 0:u.theoMean)??oo("hist_theo_mean","512")),[E,T]=C.useState(()=>(u==null?void 0:u.theoSigma)??oo("hist_theo_sigma","10")),[B,U]=C.useState(()=>(u==null?void 0:u.theoAmp)??oo("hist_theo_amp","1000")),[V,G]=C.useState(!1),[D,I]=C.useState(0),[F,H]=C.useState([]),[W,Q]=C.useState(null),[q,re]=C.useState(l||{x:100,y:100}),[ee,fe]=C.useState(!1),oe=C.useRef({x:0,y:0});C.useEffect(()=>{localStorage.setItem("hist_mode",p),localStorage.setItem("hist_min",String(v)),localStorage.setItem("hist_max",String(k)),localStorage.setItem("hist_bins",String(y)),localStorage.setItem("hist_ptp",String(_)),localStorage.setItem("hist_show_theo",String(j)),localStorage.setItem("hist_theo_mean",A),localStorage.setItem("hist_theo_sigma",E),localStorage.setItem("hist_theo_amp",B),f&&f({channelMode:p,minVal:v,maxVal:k,binCount:y,pointToPoint:_,showTheo:j,theoMean:A,theoSigma:E,theoAmp:B})},[p,v,k,y,_,j,A,E,B]),C.useEffect(()=>{if(!e||!a||!n&&(!d||d.length===0))return;if(k<=v){Q("Invalid range: Max must be greater than Min");return}Q(null),G(!0),I(0);const ve=new AbortController,ge=[],Oe=setTimeout(async()=>{try{let We=[];if(d&&d.length>1){const Le=Math.min(d.length,navigator.hardwareConcurrency||4);for(let _t=0;_t<Le;_t++){const Jt=new Worker(new URL("/assets/histogramWorker-CC48bXVX.js",import.meta.url),{type:"module"});ge.push(Jt)}let tt=0,mt=0;const wt=[],Qt=async _t=>{for(;tt<d.length;){if(ve.signal.aborted)return;const Jt=tt++,Nt=d[Jt];try{const er=await Nt.arrayBuffer();await new Promise((Vr,Tt)=>{_t.onmessage=Sr=>{const{success:Ve,hist:Pt,error:Bt}=Sr.data;Ve?(wt.push(Pt),mt++,I(mt),Vr()):(console.error(`Error processing ${Nt.name}:`,Bt),Vr())},_t.onerror=Sr=>{console.error("Worker Error",Sr),Vr()},_t.postMessage({buffer:er,roi:a,binCount:y,minVal:v,maxVal:k,pointToPoint:_},[er])})}catch(er){console.error("File Read Error",er)}}};if(await Promise.all(ge.map(_t=>Qt(_t))),ge.forEach(_t=>_t.terminate()),ge.length=0,wt.length>0){We=wt[0];for(let _t=1;_t<wt.length;_t++){const Jt=wt[_t];for(let Nt=0;Nt<Jt.length;Nt++)We[Nt]&&(We[Nt].c0+=Jt[Nt].c0,We[Nt].c1+=Jt[Nt].c1,We[Nt].c2+=Jt[Nt].c2,We[Nt].c3+=Jt[Nt].c3)}}}else n&&(We=Y6(n.data,n.width,n.height,a.x,a.y,a.w,a.h,y,v,k,_));ve.signal.aborted||H(We)}catch(We){console.error("Histogram calc error:",We),Q("Error calculating histogram")}finally{ve.signal.aborted||G(!1)}},50);return()=>{clearTimeout(Oe),ve.abort(),ge.length>0&&(console.log(`Terminating ${ge.length} active histogram workers...`),ge.forEach(We=>We.terminate()))}},[e,n,a==null?void 0:a.x,a==null?void 0:a.y,a==null?void 0:a.w,a==null?void 0:a.h,y,v,k,_,d]);const ye=C.useMemo(()=>{if(!j)return F;const ve=parseFloat(A),ge=parseFloat(E),Me=parseFloat(B);return isNaN(ve)||isNaN(ge)||isNaN(Me)||ge<=0?F:F.map(Oe=>{const We=Oe.binStart,Le=-Math.pow(We-ve,2)/(2*Math.pow(ge,2)),tt=Me*Math.exp(Le);return{...Oe,theory:tt}})},[F,j,A,E,B]),ae=()=>{if(F.length===0)return;let ve=0,ge=0;if(F.forEach(Me=>{const Oe=Math.max(Me.c0||0,Me.c1||0,Me.c2||0,Me.c3||0);Oe>ve&&(ve=Oe,ge=Me.binStart)}),$(ge.toFixed(2)),U(ve.toString()),parseFloat(E)===0||isNaN(parseFloat(E))){const Me=k-v;T((Me/20).toFixed(2))}},X=(ve,ge,Me)=>{s&&s(),!(Me.closest("button")||Me.closest("input")||Me.closest("select"))&&(fe(!0),oe.current={x:ve-q.x,y:ge-q.y})},se=ve=>{X(ve.clientX,ve.clientY,ve.target)},he=ve=>{const ge=ve.touches[0];X(ge.clientX,ge.clientY,ve.target)};if(C.useEffect(()=>{const ve=Me=>{if(ee){const Oe="touches"in Me?Me.touches[0].clientX:Me.clientX,We="touches"in Me?Me.touches[0].clientY:Me.clientY;re({x:Oe-oe.current.x,y:We-oe.current.y})}},ge=()=>fe(!1);return ee&&(window.addEventListener("mousemove",ve),window.addEventListener("mouseup",ge),window.addEventListener("touchmove",ve,{passive:!1}),window.addEventListener("touchend",ge)),()=>{window.removeEventListener("mousemove",ve),window.removeEventListener("mouseup",ge),window.removeEventListener("touchmove",ve),window.removeEventListener("touchend",ge)}},[ee]),!e)return null;const le=i?{c0:"Blue",c1:"Green 1",c2:"Green 2",c3:"Red"}:{c0:"Red",c1:"Green 1",c2:"Green 2",c3:"Blue"},je=i?{c0:"#3b82f6",c1:"#22c55e",c2:"#4ade80",c3:"#ef4444"}:{c0:"#ef4444",c1:"#22c55e",c2:"#4ade80",c3:"#3b82f6"},ke="step";return c.jsxs("div",{className:"fixed flex flex-col bg-white dark:bg-slate-900 border border-gray-200 dark:border-slate-700 shadow-2xl rounded-xl resize-both overflow-hidden min-w-[500px] min-h-[400px] w-[900px] h-[650px]",style:{left:q.x,top:q.y,zIndex:o??100},onMouseDownCapture:s,children:[c.jsxs("div",{className:`flex justify-between items-center p-4 border-b border-gray-200 dark:border-slate-700 flex-shrink-0 bg-white dark:bg-slate-900 select-none touch-none ${ee?"cursor-grabbing":"cursor-grab"}`,onMouseDown:se,onTouchStart:he,children:[c.jsxs("h2",{className:"text-xl font-bold text-gray-900 dark:text-slate-100 pointer-events-none flex items-center gap-2",children:["ROI Histogram",d&&d.length>1&&c.jsxs("span",{className:"text-[10px] font-normal bg-purple-100 dark:bg-purple-900/30 text-purple-700 dark:text-purple-300 px-2 py-0.5 rounded border border-purple-200 dark:border-purple-800 shadow-sm",children:["Stack Count: ",d.length]})]}),c.jsxs("div",{className:"flex items-center gap-1",children:[r&&c.jsx("button",{onClick:r,className:"text-gray-400 hover:text-gray-600 dark:hover:text-slate-300 p-2 rounded-lg hover:bg-gray-100 dark:hover:bg-slate-800 transition-colors",children:c.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M20 12H4"})})}),c.jsx("button",{onClick:t,className:"text-gray-400 hover:text-red-500 dark:hover:text-red-400 p-2 rounded-lg hover:bg-gray-100 dark:hover:bg-slate-800 transition-colors",children:c.jsx("svg",{className:"w-6 h-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]})]}),c.jsxs("div",{className:"p-3 bg-gray-50 dark:bg-slate-800/50 flex flex-wrap gap-x-6 gap-y-3 items-center border-b border-gray-200 dark:border-slate-700 text-xs flex-shrink-0 relative z-10",children:[c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx("span",{className:"text-gray-500 dark:text-slate-400 font-bold uppercase tracking-tight",children:"Channel:"}),c.jsxs("select",{value:p,onChange:ve=>m(ve.target.value),className:"bg-white dark:bg-slate-700 border border-gray-300 dark:border-slate-600 rounded px-2 py-1 text-gray-900 dark:text-slate-100 outline-none focus:ring-1 focus:ring-cyan-500",children:[c.jsx("option",{value:"All",children:"All Colors"}),c.jsx("option",{value:"0",children:le.c0}),c.jsx("option",{value:"1",children:le.c1}),c.jsx("option",{value:"2",children:le.c2}),c.jsx("option",{value:"3",children:le.c3})]})]}),c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx("span",{className:"text-gray-500 dark:text-slate-400 font-bold uppercase tracking-tight",children:"Range:"}),c.jsx("input",{type:"number",value:v,onChange:ve=>b(Number(ve.target.value)),className:"w-16 px-1.5 py-1 bg-white dark:bg-slate-700 border border-gray-300 dark:border-slate-600 rounded outline-none text-gray-900 dark:text-slate-100 text-right font-mono"}),c.jsx("span",{className:"text-gray-400",children:"-"}),c.jsx("input",{type:"number",value:k,onChange:ve=>x(Number(ve.target.value)),className:"w-16 px-1.5 py-1 bg-white dark:bg-slate-700 border border-gray-300 dark:border-slate-600 rounded outline-none text-gray-900 dark:text-slate-100 text-right font-mono"})]}),c.jsxs("div",{className:"flex items-center gap-4",children:[c.jsxs("label",{className:"flex items-center gap-1.5 cursor-pointer",children:[c.jsx("input",{type:"checkbox",checked:_,onChange:ve=>S(ve.target.checked),className:"w-3.5 h-3.5 text-cyan-600 rounded border-gray-300 focus:ring-cyan-500"}),c.jsx("span",{className:"text-gray-700 dark:text-slate-300 select-none font-semibold",children:"PTP"})]}),!_&&c.jsxs("div",{className:"flex items-center gap-1.5",children:[c.jsx("span",{className:"text-gray-500 dark:text-slate-400 font-bold",children:"Bins:"}),c.jsx("input",{type:"number",value:y,onChange:ve=>w(Math.max(1,Number(ve.target.value))),className:"w-12 px-1.5 py-1 bg-white dark:bg-slate-700 border border-gray-300 dark:border-slate-600 rounded outline-none text-gray-900 dark:text-slate-100 text-right font-mono"})]})]}),c.jsx("div",{className:"h-6 w-px bg-gray-200 dark:bg-slate-700"}),c.jsxs("div",{className:`flex items-center gap-3 p-1.5 rounded-lg border transition-all ${j?"bg-amber-50/30 dark:bg-amber-900/10 border-amber-200/50 dark:border-amber-800/50":"bg-transparent border-transparent"}`,children:[c.jsxs("label",{className:"flex items-center gap-1.5 cursor-pointer select-none",children:[c.jsx("input",{type:"checkbox",checked:j,onChange:ve=>M(ve.target.checked),className:"w-3.5 h-3.5 text-amber-500 rounded border-gray-300 focus:ring-amber-500 bg-white dark:bg-slate-700"}),c.jsx("span",{className:`font-bold uppercase tracking-tight ${j?"text-amber-600 dark:text-amber-400":"text-gray-400"}`,children:"Theoretical Bell"})]}),j&&c.jsxs("div",{className:"flex items-center gap-2 animate-in fade-in slide-in-from-left-2 duration-200",children:[c.jsxs("div",{className:"flex flex-col items-center",children:[c.jsx("span",{className:"text-[8px] text-gray-400 uppercase font-bold",children:"Mean()"}),c.jsx("input",{type:"text",value:A,onChange:ve=>$(ve.target.value),className:"w-14 bg-white dark:bg-slate-900 border border-gray-300 dark:border-slate-600 rounded text-center text-[10px] py-0.5 outline-none focus:border-amber-500"})]}),c.jsxs("div",{className:"flex flex-col items-center",children:[c.jsx("span",{className:"text-[8px] text-gray-400 uppercase font-bold",children:"Sigma()"}),c.jsx("input",{type:"text",value:E,onChange:ve=>T(ve.target.value),className:"w-12 bg-white dark:bg-slate-900 border border-gray-300 dark:border-slate-600 rounded text-center text-[10px] py-0.5 outline-none focus:border-amber-500"})]}),c.jsxs("div",{className:"flex flex-col items-center",children:[c.jsx("span",{className:"text-[8px] text-gray-400 uppercase font-bold",children:"Scale(A)"}),c.jsx("input",{type:"text",value:B,onChange:ve=>U(ve.target.value),className:"w-16 bg-white dark:bg-slate-900 border border-gray-300 dark:border-slate-600 rounded text-center text-[10px] py-0.5 outline-none focus:border-amber-500"})]}),c.jsx("button",{onClick:ae,className:"mt-3 px-2 py-0.5 bg-amber-600 hover:bg-amber-500 text-white text-[9px] font-bold rounded shadow-sm active:scale-95 transition-all",title:"Set Mean and Amplitude based on current peak",children:"AUTO FIT"})]})]})]}),c.jsxs("div",{className:"flex-1 p-4 relative bg-white dark:bg-slate-900 overflow-hidden min-h-0",children:[c.jsx("div",{className:"absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 z-0 pointer-events-none select-none opacity-10 mix-blend-normal dark:mix-blend-plus-lighter",children:c.jsx("svg",{viewBox:"0 0 500 60",className:"w-96 h-auto",children:c.jsx("text",{x:"50%",y:"50%",dominantBaseline:"middle",textAnchor:"middle",className:"fill-gray-900 dark:fill-white",fontSize:"36",fontWeight:"bold",style:{fontFamily:"sans-serif",letterSpacing:"0.05em"},children:" y-g-jiang.github.io"})})}),V&&c.jsxs("div",{className:"absolute inset-0 flex flex-col items-center justify-center z-20 bg-white/50 dark:bg-slate-900/50 backdrop-blur-[1px]",children:[c.jsx("div",{className:"w-8 h-8 border-4 border-cyan-500 border-t-transparent rounded-full animate-spin mb-2"}),c.jsx("span",{className:"text-sm text-cyan-600 dark:text-cyan-400 font-semibold",children:d&&d.length>1?`Stacking Histogram... ${D}/${d.length}`:"Calculating Histogram..."})]}),W?c.jsx("div",{className:"flex items-center justify-center h-full text-red-500 relative z-10",children:W}):c.jsx("div",{className:"relative z-10 w-full h-full",children:c.jsx(Ui,{width:"100%",height:"100%",children:c.jsxs(Xs,{data:ye,children:[c.jsx(Ni,{strokeDasharray:"3 3",stroke:"#374151",opacity:.3}),c.jsx(ka,{dataKey:"binStart",type:"number",domain:[v,k],tickFormatter:ve=>Math.floor(ve).toString(),tick:{fill:"#9ca3af",fontSize:12},allowDataOverflow:!0,label:{value:"DN Value",position:"insideBottom",offset:-5,fill:"#9ca3af",fontSize:12}}),c.jsx(Sa,{tick:{fill:"#9ca3af",fontSize:12},label:{value:"Count",angle:-90,position:"insideLeft",fill:"#9ca3af",fontSize:12}}),c.jsx(Un,{contentStyle:{backgroundColor:"#1f2937",border:"1px solid #374151",borderRadius:"0.5rem",color:"#f3f4f6"},itemStyle:{fontSize:"12px"},labelFormatter:ve=>`DN: ${Math.round(Number(ve))}`,formatter:(ve,ge)=>[Math.round(ve),ge]}),c.jsx(Xi,{wrapperStyle:{paddingTop:"10px"}}),j&&c.jsx(xn,{type:"monotone",dataKey:"theory",name:"Ideal Bell (Gaussian)",stroke:"#f59e0b",strokeWidth:2.5,strokeDasharray:"5 5",dot:!1,isAnimationActive:!1}),(p==="All"||p==="0")&&c.jsx(xn,{type:ke,dataKey:"c0",name:le.c0,stroke:je.c0,dot:!1,strokeWidth:1.5,activeDot:{r:4},isAnimationActive:!1}),(p==="All"||p==="1")&&c.jsx(xn,{type:ke,dataKey:"c1",name:le.c1,stroke:je.c1,dot:!1,strokeWidth:1.5,activeDot:{r:4},isAnimationActive:!1}),(p==="All"||p==="2")&&c.jsx(xn,{type:ke,dataKey:"c2",name:le.c2,stroke:je.c2,dot:!1,strokeWidth:1.5,activeDot:{r:4},isAnimationActive:!1}),(p==="All"||p==="3")&&c.jsx(xn,{type:ke,dataKey:"c3",name:le.c3,stroke:je.c3,dot:!1,strokeWidth:1.5,activeDot:{r:4},isAnimationActive:!1})]})})})]})]})},ks=({initialPosition:e={x:20,y:80},children:t,className:r="",onClose:n,zIndex:a,onFocus:i})=>{const[o,s]=C.useState(e),[l,u]=C.useState(!1),[f,d]=C.useState({x:0,y:0}),p=C.useRef(null),m=(k,x,y)=>{i&&i(),!(y.closest("button")||y.closest("input"))&&(u(!0),d({x:k-o.x,y:x-o.y}))},v=k=>{m(k.clientX,k.clientY,k.target)},b=k=>{const x=k.touches[0];m(x.clientX,x.clientY,k.target)};return C.useEffect(()=>{const k=y=>{var w,_;if(l){y.cancelable&&y.preventDefault();const S="touches"in y?y.touches[0].clientX:y.clientX,j="touches"in y?y.touches[0].clientY:y.clientY,M=S-f.x,A=j-f.y,$=window.innerWidth-(((w=p.current)==null?void 0:w.offsetWidth)||100),E=window.innerHeight-(((_=p.current)==null?void 0:_.offsetHeight)||100);s({x:Math.max(0,Math.min(M,$)),y:Math.max(0,Math.min(A,E))})}},x=()=>{u(!1)};return l&&(window.addEventListener("mousemove",k),window.addEventListener("mouseup",x),window.addEventListener("touchmove",k,{passive:!1}),window.addEventListener("touchend",x)),()=>{window.removeEventListener("mousemove",k),window.removeEventListener("mouseup",x),window.removeEventListener("touchmove",k),window.removeEventListener("touchend",x)}},[l,f]),c.jsxs("div",{ref:p,style:{left:o.x,top:o.y,zIndex:a??90},onMouseDownCapture:i,className:`fixed border-2 border-black dark:border-gray-500 bg-white dark:bg-black shadow-[8px_8px_0px_rgba(0,0,0,0.5)] dark:shadow-[8px_8px_0px_rgba(255,255,255,0.2)] transition-shadow duration-200 ${l?"cursor-grabbing shadow-[4px_4px_0px_rgba(0,0,0,0.5)]":""} ${r}`,children:[c.jsx("div",{onMouseDown:v,onTouchStart:b,className:"absolute inset-0 w-full h-8 cursor-grab active:cursor-grabbing z-0 touch-none bg-gray-200 dark:bg-gray-800 border-b-2 border-black dark:border-gray-500",title:"Drag to move"}),c.jsx("div",{className:"relative z-10 pointer-events-none",children:c.jsx("div",{className:"pointer-events-auto",children:t})})]})},Bre=({isOpen:e,onClose:t,rawImageData:r,roi:n,selectedChannel:a,channelName:i,zIndex:o,onFocus:s,initialPosition:l})=>{const u=C.useRef(null),[f,d]=C.useState(!1),[p,m]=C.useState(null),[v,b]=C.useState(null),[k,x]=C.useState(!0),[y,w]=C.useState(!0),[_,S]=C.useState("-1"),[j,M]=C.useState("8"),[A,$]=C.useState(64),[E,T]=C.useState(45),[B,U]=C.useState(60),V=C.useRef(!1),G=C.useRef({x:0,y:0});C.useEffect(()=>{!e||!r||!n||(d(!0),b(null),setTimeout(()=>{try{const H=Q6(r.data,r.width,r.height,n,a,y);H?m(H):b("Could not extract valid data from ROI.")}catch(H){console.error("2D FFT Error",H),b("Calculation Error: "+H.message)}finally{d(!1)}},50))},[e,r,n,a,y]),C.useEffect(()=>{if(!p||!u.current)return;const H=u.current,W=H.getContext("2d");if(!W)return;const Q=H.width,q=H.height;W.clearRect(0,0,Q,q),W.fillStyle="#0f172a",W.fillRect(0,0,Q,q);const re=p.width,ee=p.height,fe=p.data,oe=Math.pow(10,parseFloat(_)||-1),ye=Math.pow(10,parseFloat(j)||8);let ae=oe,X=ye;k&&(ae=Math.log10(Math.max(1e-10,oe)),X=Math.log10(Math.max(1e-10,ye)));const se=X-ae||1,he=Q/2,le=q/2+50,je=Math.min(Q,q)*.4,ke=.6,ve=E*Math.PI/180,ge=B*Math.PI/180,Me=Math.cos(ve),Oe=Math.sin(ve),We=Math.cos(ge),Le=Math.sin(ge),tt=(Pt,Bt,Dt)=>{const tr=Pt*Me-Bt*Oe,rr=Pt*Oe+Bt*Me,Hr=rr*We-Dt*Le,Ft=rr*Le+Dt*We;return{x:he+tr*je,y:le-Hr*je,depth:Ft}},mt=Math.max(16,A),wt=Math.max(1,Math.floor(re/mt)),Qt=Math.max(1,Math.floor(ee/mt)),_t=(Pt,Bt)=>{let Dt=fe[Bt*re+Pt];return k&&(Dt=Math.log10(Math.max(1e-10,Dt))),Dt=Math.max(ae,Math.min(X,Dt)),(Dt-ae)/se},Jt=Pt=>`hsl(${(1-Pt)*240}, 80%, 50%)`,Nt=[];for(let Pt=0;Pt<ee-Qt;Pt+=Qt)for(let Bt=0;Bt<re-wt;Bt+=wt){const Dt=Bt,tr=Pt,rr=Bt+wt,Hr=Pt,Ft=Bt+wt,bn=Pt+Qt,Ct=Bt,tn=Pt+Qt,Ge=_t(Dt,tr),rn=_t(rr,Hr),Ar=_t(Ft,bn),sn=_t(Ct,tn),Xr=(Ge+rn+Ar+sn)/4,Tr=tt(Dt/(re-1)-.5,tr/(ee-1)-.5,Ge*ke),Cr=tt(rr/(re-1)-.5,Hr/(ee-1)-.5,rn*ke),Er=tt(Ft/(re-1)-.5,bn/(ee-1)-.5,Ar*ke),wn=tt(Ct/(re-1)-.5,tn/(ee-1)-.5,sn*ke),kn=(Tr.depth+Cr.depth+Er.depth+wn.depth)/4;Nt.push({pts:[{x:Tr.x,y:Tr.y},{x:Cr.x,y:Cr.y},{x:Er.x,y:Er.y},{x:wn.x,y:wn.y}],avgDepth:kn,avgZ:Xr})}Nt.sort((Pt,Bt)=>Pt.avgDepth-Bt.avgDepth),W.lineWidth=.5,Nt.forEach(Pt=>{W.fillStyle=Jt(Pt.avgZ),W.beginPath(),W.moveTo(Pt.pts[0].x,Pt.pts[0].y),W.lineTo(Pt.pts[1].x,Pt.pts[1].y),W.lineTo(Pt.pts[2].x,Pt.pts[2].y),W.lineTo(Pt.pts[3].x,Pt.pts[3].y),W.closePath(),W.fill()}),W.fillStyle="#aaa",W.font="10px monospace";const er=tt(-.5,-.5,0),Vr=tt(.5,-.5,0),Tt=tt(-.5,.5,0),Sr=tt(.5,.5,0);W.strokeStyle="#666",W.beginPath(),W.moveTo(er.x,er.y),W.lineTo(Vr.x,Vr.y),W.lineTo(Sr.x,Sr.y),W.lineTo(Tt.x,Tt.y),W.closePath(),W.stroke(),W.fillText("0",er.x-10,er.y+10),W.fillText("Fx",Vr.x+5,Vr.y),W.fillText("Fy",Tt.x-15,Tt.y);const Ve=tt(-.5,-.5,ke);W.strokeStyle="#fff",W.beginPath(),W.moveTo(er.x,er.y),W.lineTo(Ve.x,Ve.y),W.stroke(),W.fillText(`10^${j}`,Ve.x-25,Ve.y),W.fillText(`10^${_}`,er.x-25,er.y)},[p,k,E,B,_,j,A]);const D=H=>{V.current=!0,G.current={x:H.clientX,y:H.clientY}},I=H=>{if(!V.current)return;const W=H.clientX-G.current.x,Q=H.clientY-G.current.y;T(q=>q-W*.5),U(q=>Math.max(0,Math.min(90,q+Q*.5))),G.current={x:H.clientX,y:H.clientY}},F=()=>{V.current=!1};return e?c.jsxs(ks,{initialPosition:l||{x:100,y:100},onClose:t,zIndex:o,onFocus:s,className:"w-[700px] h-[600px] bg-slate-900 border border-slate-700 flex flex-col overflow-hidden shadow-2xl",children:[c.jsxs("div",{className:"flex justify-between items-center px-4 py-2 border-b border-slate-700 bg-slate-800",children:[c.jsxs("h3",{className:"text-sm font-bold text-slate-200 flex items-center gap-2",children:["2D FFT Power Spectrum - ",i,p&&c.jsxs("span",{className:"text-[10px] font-normal text-slate-400 bg-slate-700 px-2 py-0.5 rounded",children:[p.width,"x",p.height," (Chirp-Z)"]})]}),c.jsx("div",{className:"flex items-center gap-2",children:c.jsx("button",{onClick:t,className:"text-slate-400 hover:text-red-400 transition-colors",children:c.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})})]}),c.jsxs("div",{className:"p-3 bg-slate-800/80 flex flex-wrap gap-4 text-xs items-center border-b border-slate-700",children:[c.jsxs("div",{className:"flex items-center gap-2 bg-slate-900 px-2 py-1 rounded border border-slate-600",children:[c.jsx("span",{className:"text-slate-400 font-bold",children:"Range (10^x):"}),c.jsx("input",{type:"number",value:_,onChange:H=>S(H.target.value),className:"w-10 bg-transparent text-slate-200 text-center border-b border-slate-600 focus:border-cyan-500 outline-none"}),c.jsx("span",{className:"text-slate-500",children:"to"}),c.jsx("input",{type:"number",value:j,onChange:H=>M(H.target.value),className:"w-10 bg-transparent text-slate-200 text-center border-b border-slate-600 focus:border-cyan-500 outline-none"})]}),c.jsxs("div",{className:"flex items-center gap-2 bg-slate-900 px-2 py-1 rounded border border-slate-600",children:[c.jsx("span",{className:"text-slate-400 font-bold",children:"Density:"}),c.jsx("input",{type:"range",min:"16",max:"128",step:"16",value:A,onChange:H=>$(Number(H.target.value)),className:"w-20 h-1.5 bg-slate-700 rounded-lg appearance-none cursor-pointer accent-cyan-500"}),c.jsx("span",{className:"text-slate-300 w-6 text-right",children:A})]}),c.jsxs("label",{className:"flex items-center gap-1 cursor-pointer select-none text-slate-300 hover:text-white",children:[c.jsx("input",{type:"checkbox",checked:k,onChange:H=>x(H.target.checked),className:"rounded bg-slate-700 border-slate-600 accent-cyan-500"}),"Log Z"]}),c.jsxs("label",{className:"flex items-center gap-1 cursor-pointer select-none text-slate-300 hover:text-white",children:[c.jsx("input",{type:"checkbox",checked:y,onChange:H=>w(H.target.checked),className:"rounded bg-slate-700 border-slate-600 accent-fuchsia-500"}),"Hanning"]})]}),c.jsxs("div",{className:"flex-1 relative bg-slate-900 cursor-move",children:[f&&c.jsx("div",{className:"absolute inset-0 flex items-center justify-center bg-slate-900/80 z-20 backdrop-blur-sm",children:c.jsxs("div",{className:"flex flex-col items-center gap-2",children:[c.jsx("div",{className:"w-8 h-8 border-4 border-cyan-500 border-t-transparent rounded-full animate-spin"}),c.jsx("span",{className:"text-cyan-400 font-bold animate-pulse text-sm",children:"Computing full-size 2D FFT..."})]})}),v&&c.jsx("div",{className:"absolute inset-0 flex items-center justify-center bg-slate-900/80 z-20 text-red-400 p-4 text-center",children:v}),c.jsx("canvas",{ref:u,width:700,height:500,className:"w-full h-full block",onMouseDown:D,onMouseMove:I,onMouseUp:F,onMouseLeave:F}),c.jsx("div",{className:"absolute bottom-2 right-2 text-[9px] text-slate-600 pointer-events-none",children:"Drag to Rotate"})]})]}):null},Fre=.5,Cx=1e-10,g3=(e,t)=>{const r=e.length-1;if(r<0)return Cx;const n=t/Fre*r,a=Math.round(n),i=e[Math.min(Math.max(0,a),r)]||0;return Math.max(i,Cx)},Ure=(e,t)=>{if(t<=0)return[1];const r=new Array(e);let n=0;for(let a=0;a<e;a++){const i=a-(e-1)/2,o=Math.exp(-(i*i)/(2*t*t));r[a]=o,n+=o}for(let a=0;a<e;a++)r[a]/=n;return r},Gre=({isOpen:e,onClose:t,onMinimize:r,rawImageData:n,roi:a,isBGGR:i,onUpdateROI:o,zIndex:s,onFocus:l,initialPosition:u,initialInternalState:f,onUpdateState:d,stackFiles:p})=>{const[m,v]=C.useState((f==null?void 0:f.selectedChannel)??0),[b,k]=C.useState(()=>(f==null?void 0:f.yMinExp)||localStorage.getItem("fft_y_min")||"1.73"),[x,y]=C.useState(()=>(f==null?void 0:f.yMaxExp)||localStorage.getItem("fft_y_max")||"8.00"),[w,_]=C.useState((f==null?void 0:f.useHanning)??!0),[S,j]=C.useState((f==null?void 0:f.doAverage)??!0),[M,A]=C.useState((f==null?void 0:f.welchSegments)??1),[$,E]=C.useState((f==null?void 0:f.showH)??!0),[T,B]=C.useState((f==null?void 0:f.showV)??!0),[U,V]=C.useState((f==null?void 0:f.interlaceRows)??!1),[G,D]=C.useState((f==null?void 0:f.rowGroup)??0),[I,F]=C.useState((f==null?void 0:f.interlaceCols)??!1),[H,W]=C.useState((f==null?void 0:f.colGroup)??0),[Q,q]=C.useState(()=>(f==null?void 0:f.theoSigma)||localStorage.getItem("fft_theo_sigma")||"0.00"),[re,ee]=C.useState(()=>(f==null?void 0:f.theoKernelSize)||localStorage.getItem("fft_theo_ksize")||"3"),[fe,oe]=C.useState(()=>(f==null?void 0:f.theoNoiseStd)||localStorage.getItem("fft_theo_noise")||"7.5"),[ye,ae]=C.useState(()=>(f==null?void 0:f.theoScale)||localStorage.getItem("fft_theo_scale")||"1.0"),[X,se]=C.useState((f==null?void 0:f.intStart)||"0"),[he,le]=C.useState((f==null?void 0:f.intEnd)||"0.5"),[je,ke]=C.useState(!1),[ve,ge]=C.useState([]),[Me,Oe]=C.useState(!1),[We,Le]=C.useState(0),[tt,mt]=C.useState(null),[wt,Qt]=C.useState(!1),[_t,Jt]=C.useState(!1),[Nt,er]=C.useState(null),[Vr,Tt]=C.useState(!1),[Sr,Ve]=C.useState(null),[Pt,Bt]=C.useState(u||{x:50,y:50}),[Dt,tr]=C.useState(!1),[rr,Hr]=C.useState(null),[Ft,bn]=C.useState({}),Ct=C.useRef({x:0,y:0}),tn=i?{c0:"#3b82f6",c1:"#22c55e",c2:"#4ade80",c3:"#ef4444"}:{c0:"#ef4444",c1:"#22c55e",c2:"#4ade80",c3:"#3b82f6"},Ge=C.useMemo(()=>i?{0:"Blue",1:"Green 1",2:"Green 2",3:"Red"}:{0:"Red",1:"Green 1",2:"Green 2",3:"Blue"},[i]);C.useEffect(()=>{localStorage.setItem("fft_y_min",b),localStorage.setItem("fft_y_max",x),localStorage.setItem("fft_theo_sigma",Q),localStorage.setItem("fft_theo_ksize",re),localStorage.setItem("fft_theo_noise",fe),localStorage.setItem("fft_theo_scale",ye)},[b,x,Q,re,fe,ye]),C.useEffect(()=>{if(!e||!n||!a)return;Oe(!0),mt(null),Le(0);const O=setTimeout(async()=>{try{const De=m===-1?[0,1,2,3]:[m],ht=p&&p.length>1?p:[null],Vt=ht.length,$t={};let mr={h:0,v:0};for(let He=0;He<Vt;He++){Le(He+1);let pt;if(ht[He]){const It=await ht[He].arrayBuffer();pt=await pc(It)}else pt=n;for(const It of De){const Ht=Z6(pt.data,pt.width,pt.height,a,It,!1,w,{rows:U,rowGroup:G,cols:I,colGroup:H},S,M);Ht&&($t[It]||($t[It]={h:new Array(Ht.avgHoriz.length).fill(0),v:new Array(Ht.avgVert.length).fill(0)}),Ht.avgHoriz.forEach((Ut,Se)=>$t[It].h[Se]+=Ut/Vt),Ht.avgVert.forEach((Ut,Se)=>$t[It].v[Se]+=Ut/Vt),mr=Ht.sampleCount)}}if(Object.keys($t).length===0)throw new Error("ROI too small or no data found.");const $r=1024,nr=[];for(let He=0;He<$r;He++){const pt=He/($r-1)*.5,It={freq:parseFloat(pt.toFixed(6))};for(const Ht of De)$t[Ht]&&(It[`c${Ht}_h`]=g3($t[Ht].h,pt),It[`c${Ht}_v`]=g3($t[Ht].v,pt));nr.push(It)}Hr(mr),ge(nr)}catch(De){console.error("FFT Loop Failed:",De),mt(De.message||"Unknown error during FFT processing")}finally{Oe(!1)}},100);return()=>clearTimeout(O)},[e,n,a==null?void 0:a.x,a==null?void 0:a.y,a==null?void 0:a.w,a==null?void 0:a.h,m,w,S,M,U,G,I,H,p]);const rn=()=>{const O=parseFloat(X),De=parseFloat(he);if(isNaN(O)||isNaN(De))return;const ht={},Vt=m===-1?[0,1,2,3]:[m],$t=ve.filter(mr=>mr.freq>=O&&mr.freq<=De);if($t.length===0){bn({});return}Vt.forEach(mr=>{let $r=0,nr=0;$t.forEach(He=>{const pt=He[`c${mr}_h`],It=He[`c${mr}_v`];typeof pt=="number"&&($r+=pt),typeof It=="number"&&(nr+=It)}),ht[mr]={h:$r/$t.length,v:nr/$t.length,count:$t.length}}),bn(ht)},Ar=C.useMemo(()=>{const O=parseFloat(Q),De=parseInt(re),ht=parseFloat(fe),Vt=parseFloat(ye);if(isNaN(O)||isNaN(De)||isNaN(ht)||isNaN(Vt)||ve.length===0)return ve;const $t=Ure(De,O),mr=$t.reduce((He,pt)=>He+pt*pt,0),$r=(De-1)/2,nr=ht*ht*Vt;return ve.map(He=>{const pt=He.freq,It=2*Math.PI*pt;let Ht=0,Ut=0;for(let ln=0;ln<De;ln++){const L=ln-$r,we=$t[ln],Ne=-It*L;Ht+=we*Math.cos(Ne),Ut+=we*Math.sin(Ne)}const Se=Ht*Ht+Ut*Ut;return{...He,theory:Math.max(Cx,nr*mr*Se)}})},[ve,Q,re,fe,ye]),sn=O=>{O&&O.activeLabel!==void 0&&(Tt(!0),Ve(Number(O.activeLabel)),er(null))},Xr=O=>{if(Vr&&Sr!==null&&O&&O.activeLabel!==void 0){const De=Number(O.activeLabel);er([Math.min(Sr,De),Math.max(Sr,De)])}},Tr=()=>Tt(!1),Cr=(O,De,ht)=>{l&&l(),!(ht.closest("button")||ht.closest("input"))&&(tr(!0),Ct.current={x:O-Pt.x,y:De-Pt.y})},Er=O=>{Cr(O.clientX,O.clientY,O.target)},wn=O=>{const De=O.touches[0];Cr(De.clientX,De.clientY,O.target)};C.useEffect(()=>{const O=ht=>{if(Dt){const Vt="touches"in ht?ht.touches[0].clientX:ht.clientX,$t="touches"in ht?ht.touches[0].clientY:ht.clientY;Bt({x:Vt-Ct.current.x,y:$t-Ct.current.y})}},De=()=>tr(!1);return Dt&&(window.addEventListener("mousemove",O),window.addEventListener("mouseup",De),window.addEventListener("touchmove",O,{passive:!1}),window.addEventListener("touchend",De)),()=>{window.removeEventListener("mousemove",O),window.removeEventListener("mouseup",De),window.removeEventListener("touchmove",O),window.removeEventListener("touchend",De)}},[Dt]);const kn=C.useMemo(()=>{if(!Nt||ve.length===0)return null;const[O,De]=Nt,ht=ve.filter(mr=>mr.freq>=O&&mr.freq<=De);if(ht.length===0)return null;const Vt=m===-1?[0,1,2,3]:[m],$t={};return Vt.forEach(mr=>{["h","v"].forEach($r=>{const nr=`c${mr}_${$r}`;let He=0,pt=0;for(const It of ht){const Ht=It[nr];typeof Ht=="number"&&(He+=Ht,pt++)}pt>0&&($t[`${nr}_sigma`]=Math.sqrt(He/pt))})}),{count:ht.length,stats:$t}},[Nt,ve,m]),qt=()=>{if(ve.length===0)return;let O=1/0,De=-1/0;if(ve.forEach($r=>{$r.freq<.01||$r.freq>.49||Object.keys($r).forEach(nr=>{if(nr==="freq"||nr==="theory")return;const He=$r[nr];typeof He=="number"&&He>0&&(He<O&&(O=He),He>De&&(De=He))})}),O===1/0)return;const ht=Math.log10(O),Vt=Math.log10(De),$t=Vt-ht,mr=($t===0?1:$t)*.1;k((ht-mr).toFixed(2)),y((Vt+mr).toFixed(2))},Et=(O,De)=>{a&&o&&o({...a,x:a.x+O,y:a.y+De})},fr=(O,De)=>{a&&o&&o({...a,w:Math.max(2,a.w+O),h:Math.max(2,a.h+De)})};return e?c.jsxs("div",{className:"fixed flex flex-col bg-white dark:bg-slate-900 border border-gray-200 dark:border-slate-700 shadow-2xl rounded-xl overflow-hidden resize-both min-w-[750px] min-h-[500px]",style:{left:Pt.x,top:Pt.y,width:"1000px",height:"850px",zIndex:s??100},onMouseDownCapture:l,children:[c.jsxs("div",{className:`flex justify-between items-center p-3 border-b border-gray-200 dark:border-slate-700 flex-shrink-0 bg-gray-50 dark:bg-slate-800 z-50 relative select-none touch-none ${Dt?"cursor-grabbing":"cursor-grab"}`,onMouseDown:Er,onTouchStart:wn,children:[c.jsxs("h2",{className:"text-lg font-bold text-gray-900 dark:text-slate-100 flex items-center gap-2 pointer-events-none",children:["Power Spectrum Analysis",c.jsx("span",{className:"text-[10px] font-normal bg-white dark:bg-slate-700 px-2 py-1 rounded text-gray-500 border border-gray-200 dark:border-slate-600 shadow-sm",children:p&&p.length>1?`Stack Avg (${p.length} frames)`:"Single Mode"})]}),c.jsxs("div",{className:"flex items-center gap-1",children:[r&&c.jsx("button",{onClick:r,className:"text-gray-400 hover:text-gray-600 dark:hover:text-slate-300 p-2 rounded-lg hover:bg-gray-200 dark:hover:bg-slate-700 transition-colors",children:c.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M20 12H4"})})}),c.jsx("button",{onClick:t,className:"text-gray-400 hover:text-red-500 dark:hover:text-red-400 p-2 rounded-lg hover:bg-gray-200 dark:hover:bg-slate-700 transition-colors",children:c.jsx("svg",{className:"w-6 h-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]})]}),c.jsxs("div",{className:"flex flex-col bg-gray-50 dark:bg-slate-900/80 border-b border-gray-200 dark:border-slate-800 flex-shrink-0 z-40 relative px-4 py-3 gap-3 overflow-x-auto",children:[c.jsxs("div",{className:"flex items-center gap-6",children:[c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx("span",{className:"text-[10px] font-bold text-gray-500 dark:text-slate-400 uppercase tracking-widest",children:"Channel"}),c.jsxs("div",{className:"flex bg-gray-100 dark:bg-slate-800 rounded-lg p-0.5 border border-gray-200 dark:border-slate-700 shadow-inner",children:[c.jsx("button",{onClick:()=>v(-1),className:`px-3 py-1 rounded text-[10px] font-bold transition-all ${m===-1?"bg-slate-700 text-white shadow-md":"text-gray-500 dark:text-slate-500 hover:bg-white dark:hover:bg-slate-700"}`,children:"All"}),[0,1,2,3].map(O=>c.jsx("button",{onClick:()=>v(O),className:`px-3 py-1 rounded text-[10px] font-bold transition-all ${m===O?"bg-cyan-600 text-white shadow-md":"text-gray-500 dark:text-slate-500 hover:bg-white dark:hover:bg-slate-700"}`,children:Ge[O]},O))]})]}),c.jsx("div",{className:"h-6 w-px bg-gray-200 dark:bg-slate-700 mx-2"}),c.jsxs("button",{onClick:()=>ke(!0),className:"flex items-center gap-1.5 px-4 py-1.5 bg-indigo-600 hover:bg-indigo-500 text-white text-[10px] font-bold rounded-lg shadow-lg shadow-indigo-500/30 transition-all active:scale-95 group border border-indigo-400/30",children:[c.jsx("svg",{className:"w-3.5 h-3.5 group-hover:animate-pulse",fill:"currentColor",viewBox:"0 0 24 24",children:c.jsx("path",{d:"M13 10V3L4 14h7v7l9-11h-7z"})}),"2D Diagonal"]}),c.jsx("div",{className:"h-6 w-px bg-gray-200 dark:bg-slate-700 mx-2"}),c.jsxs("div",{className:"flex items-center gap-3",children:[c.jsx("span",{className:"text-[10px] font-bold text-indigo-500 dark:text-indigo-400 uppercase tracking-widest",children:"Model"}),c.jsx("div",{className:"flex gap-2",children:[{label:"KSize",val:re,set:ee,w:"w-10"},{label:"Sigma",val:Q,set:q,w:"w-12"},{label:"Noise()",val:fe,set:oe,w:"w-12"},{label:"Scale",val:ye,set:ae,w:"w-12"}].map(O=>c.jsxs("div",{className:"flex flex-col items-center",children:[c.jsx("label",{className:"text-[8px] text-gray-400 dark:text-slate-500 uppercase font-bold mb-0.5",children:O.label}),c.jsx("input",{type:"text",value:O.val,onChange:De=>O.set(De.target.value),className:`${O.w} text-[11px] bg-white dark:bg-slate-800 border border-gray-200 dark:border-slate-700 rounded px-1.5 py-0.5 text-center text-gray-900 dark:text-slate-100 outline-none focus:border-indigo-500 shadow-sm`})]},O.label))})]})]}),c.jsxs("div",{className:"flex items-center gap-4 flex-wrap",children:[c.jsxs("div",{className:"flex items-center gap-3 mr-2",children:[c.jsx("span",{className:"text-[10px] font-bold text-fuchsia-600 dark:text-fuchsia-500 uppercase tracking-widest",children:"Welch"}),c.jsx("input",{type:"range",min:"1",max:"16",step:"1",value:M,onChange:O=>A(parseInt(O.target.value)),className:"w-24 h-1.5 bg-gray-300 dark:bg-slate-700 rounded-lg appearance-none cursor-pointer accent-fuchsia-500"}),c.jsx("span",{className:"text-[10px] font-mono text-fuchsia-600 dark:text-fuchsia-400 w-4 font-bold",children:M})]}),c.jsx("div",{className:"h-6 w-px bg-gray-200 dark:bg-slate-700"}),c.jsxs("div",{className:"flex flex-col gap-1 px-2",children:[c.jsxs("label",{className:"flex items-center gap-1.5 cursor-pointer text-[10px] text-gray-500 dark:text-slate-400 hover:text-gray-900 dark:hover:text-slate-200 select-none",children:[c.jsx("input",{type:"checkbox",checked:U,onChange:O=>V(O.target.checked),className:"w-3 h-3 rounded text-cyan-600 border-gray-300 dark:border-slate-700 bg-white dark:bg-slate-800"})," Row Int."]}),c.jsxs("label",{className:"flex items-center gap-1.5 cursor-pointer text-[10px] text-gray-500 dark:text-slate-400 hover:text-gray-900 dark:hover:text-slate-200 select-none",children:[c.jsx("input",{type:"checkbox",checked:I,onChange:O=>F(O.target.checked),className:"w-3 h-3 rounded text-cyan-600 border-gray-300 dark:border-slate-700 bg-white dark:bg-slate-800"})," Col Int."]})]}),c.jsxs("div",{className:"flex flex-col gap-1.5 bg-gray-100 dark:bg-slate-800/60 p-1.5 rounded-lg border border-gray-200 dark:border-slate-700",children:[c.jsxs("label",{className:"flex items-center gap-2 cursor-pointer select-none",children:[c.jsx("div",{className:`w-3.5 h-3.5 rounded-md border flex items-center justify-center transition-colors ${w?"bg-fuchsia-600 border-fuchsia-600":"bg-white dark:bg-slate-900 border-gray-300 dark:border-slate-600"}`,children:w&&c.jsx("svg",{className:"w-2.5 h-2.5 text-white",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:4,children:c.jsx("path",{d:"M5 13l4 4L19 7"})})}),c.jsx("input",{type:"checkbox",checked:w,onChange:O=>_(O.target.checked),className:"hidden"}),c.jsx("span",{className:"text-[10px] font-bold text-gray-700 dark:text-slate-300",children:"Hanning"})]}),c.jsxs("label",{className:"flex items-center gap-2 cursor-pointer select-none",children:[c.jsx("div",{className:`w-3.5 h-3.5 rounded-md border flex items-center justify-center transition-colors ${S?"bg-cyan-600 border-cyan-600":"bg-white dark:bg-slate-900 border-gray-300 dark:border-slate-600"}`,children:S&&c.jsx("svg",{className:"w-2.5 h-2.5 text-white",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:4,children:c.jsx("path",{d:"M5 13l4 4L19 7"})})}),c.jsx("input",{type:"checkbox",checked:S,onChange:O=>j(O.target.checked),className:"hidden"}),c.jsx("span",{className:"text-[10px] font-bold text-gray-700 dark:text-slate-300",children:"Average"})]})]}),c.jsxs("div",{className:"flex gap-2 bg-gray-100 dark:bg-slate-800 p-1 rounded-lg border border-gray-200 dark:border-slate-700",children:[c.jsxs("button",{onClick:()=>E(!$),className:`px-2.5 py-1 rounded-md border text-[11px] font-bold transition-all flex items-center gap-1.5 ${$?"bg-cyan-900/40 text-cyan-400 border-cyan-500 shadow-[0_0_8px_rgba(6,182,212,0.3)]":"bg-white dark:bg-slate-900 text-gray-400 border-gray-300 dark:border-slate-700"}`,children:[c.jsx("div",{className:`w-2 h-2 rounded-full ${$?"bg-cyan-400":"bg-gray-400"}`})," H"]}),c.jsxs("button",{onClick:()=>B(!T),className:`px-2.5 py-1 rounded-md border text-[11px] font-bold transition-all flex items-center gap-1.5 ${T?"bg-cyan-900/40 text-cyan-400 border-cyan-500 shadow-[0_0_8px_rgba(6,182,212,0.3)]":"bg-white dark:bg-slate-900 text-gray-400 border-gray-300 dark:border-slate-700"}`,children:[c.jsx("div",{className:`w-2 h-2 rounded-full ${$?"bg-cyan-400":"bg-gray-400"}`})," V"]})]}),c.jsxs("div",{className:"ml-auto flex gap-2",children:[c.jsx("button",{onClick:()=>Jt(!_t),className:`px-3 py-1.5 rounded-lg text-[10px] font-bold transition-all border ${_t?"bg-emerald-600 text-white border-emerald-600 shadow-md":"bg-white dark:bg-slate-900 text-emerald-600 dark:text-emerald-400 border-emerald-200 dark:border-emerald-800 hover:bg-emerald-50"}`,children:""}),c.jsx("button",{onClick:()=>Qt(!wt),className:`px-3 py-1.5 rounded-lg text-[10px] font-bold transition-all border ${wt?"bg-indigo-600 text-white border-indigo-600 shadow-md":"bg-white dark:bg-slate-900 text-indigo-600 dark:text-indigo-400 border-indigo-200 dark:border-indigo-800 hover:bg-indigo-50"}`,children:"ROI"})]})]}),c.jsxs("div",{className:"flex items-center gap-4 justify-end border-t border-gray-200 dark:border-slate-800/50 pt-2.5",children:[c.jsx("button",{onClick:qt,className:"px-4 py-1 text-[10px] font-bold bg-cyan-600/10 text-cyan-600 dark:text-cyan-400 hover:bg-cyan-600/20 rounded-md border border-cyan-500/30 transition-all uppercase tracking-widest shadow-sm",children:"Auto"}),c.jsxs("div",{className:"flex items-center gap-2 text-[10px] font-bold text-gray-500 dark:text-slate-400 uppercase",children:["Y-AXIS (LOG)",c.jsxs("div",{className:"flex items-center bg-white dark:bg-slate-800 border border-gray-200 dark:border-slate-700 rounded-md overflow-hidden shadow-sm",children:[c.jsx("input",{type:"text",value:b,onChange:O=>k(O.target.value),className:"w-14 px-2 py-1 bg-transparent text-center outline-none text-gray-900 dark:text-slate-100 border-r border-gray-200 dark:border-slate-700"}),c.jsx("span",{className:"px-2 text-gray-400",children:"to"}),c.jsx("input",{type:"text",value:x,onChange:O=>y(O.target.value),className:"w-14 px-2 py-1 bg-transparent text-center outline-none text-gray-900 dark:text-slate-100"})]})]})]})]}),c.jsxs("div",{className:"flex-1 p-4 overflow-hidden flex flex-col gap-2 relative bg-gray-50/30 dark:bg-slate-900/30",children:[c.jsx("div",{className:"absolute inset-0 flex items-center justify-center pointer-events-none z-[50] select-none opacity-10",children:c.jsx("svg",{viewBox:"0 0 500 100",className:"w-3/4 h-auto drop-shadow-lg",children:c.jsx("text",{x:"50%",y:"50%",dominantBaseline:"middle",textAnchor:"middle",className:"fill-gray-900 dark:fill-white",fontSize:"24",fontWeight:"bold",style:{fontFamily:"sans-serif",letterSpacing:"0.05em"},children:" y-g-jiang.github.io"})})}),Me&&c.jsxs("div",{className:"absolute inset-0 flex flex-col items-center justify-center z-[55] bg-white/90 dark:bg-slate-900/90 backdrop-blur-[2px]",children:[c.jsx("div",{className:"w-10 h-10 border-4 border-cyan-500 border-t-transparent rounded-full animate-spin mb-4"}),c.jsx("span",{className:"text-cyan-600 dark:text-cyan-400 font-bold",children:"Computing FFT Stack..."}),p&&p.length>1&&c.jsxs("span",{className:"text-xs text-gray-500 mt-2 font-mono",children:["Processing frame ",We," / ",p.length]})]}),tt?c.jsx("div",{className:"flex items-center justify-center h-full text-red-500 font-semibold",children:tt}):c.jsxs("div",{className:"flex-1 bg-white dark:bg-slate-950 border border-gray-200 dark:border-slate-800 rounded-xl p-2 flex flex-col relative z-20 shadow-xl overflow-hidden",children:[c.jsx("div",{className:"flex-1 relative z-10",onMouseDown:sn,onMouseMove:Xr,onMouseUp:Tr,style:{cursor:Vr?"col-resize":"crosshair"},children:c.jsx(Ui,{width:"100%",height:"100%",children:c.jsxs(Xs,{data:Ar,margin:{top:10,right:10,bottom:20,left:0},children:[c.jsx(Ni,{strokeDasharray:"3 3",stroke:"#374151",opacity:.08}),c.jsx(ka,{dataKey:"freq",type:"number",domain:[0,.5],tickCount:6,tick:{fill:"#6b7280",fontSize:10},label:{value:"Frequency (cy/px)",position:"insideBottom",offset:-10,fill:"#6b7280",fontSize:11}}),c.jsx(Sa,{scale:"log",domain:[Math.pow(10,parseFloat(b)),Math.pow(10,parseFloat(x))],allowDataOverflow:!0,tick:{fill:"#6b7280",fontSize:10},tickFormatter:O=>Number(O).toExponential(0),width:45}),c.jsx(Un,{contentStyle:{backgroundColor:"rgba(15, 23, 42, 0.95)",border:"1px solid #334155",color:"#f3f4f6",fontSize:"11px",borderRadius:"8px"},formatter:O=>[Number(O).toExponential(3),""],labelFormatter:O=>`Freq: ${Number(O).toFixed(4)}`}),c.jsx(Xi,{wrapperStyle:{fontSize:"10px"}}),c.jsx(xn,{type:"monotone",dataKey:"theory",name:"Theory Model",stroke:"#6366f1",strokeWidth:2,dot:!1,isAnimationActive:!1}),[0,1,2,3].flatMap(O=>{if(m!==-1&&m!==O)return[];const De=`c${O}_h`,ht=`c${O}_v`,Vt=tn[`c${O}`],$t=[];return $&&$t.push(c.jsx(xn,{type:"linear",dataKey:De,name:`${Ge[O]} (H)`,stroke:Vt,strokeWidth:1,dot:!1,isAnimationActive:!1},`${O}_h`)),T&&$t.push(c.jsx(xn,{type:"linear",dataKey:ht,name:`${Ge[O]} (V)`,stroke:Vt,strokeWidth:1,strokeDasharray:"3 3",dot:!1,isAnimationActive:!1},`${O}_v`)),$t}),Nt&&c.jsx(hd,{x1:Nt[0],x2:Nt[1],fill:"#8884d8",fillOpacity:.15})]})})}),kn&&Nt&&c.jsxs("div",{className:"absolute bottom-12 left-12 bg-slate-900/90 backdrop-blur-md p-3 rounded-lg border border-indigo-500/50 shadow-2xl z-30 text-[10px] font-mono text-slate-100",children:[c.jsxs("div",{className:"text-indigo-400 font-bold mb-1 border-b border-indigo-500/30 pb-1",children:["Range: ",Nt[0].toFixed(3),"-",Nt[1].toFixed(3)]}),Object.entries(kn.stats).map(([O,De])=>c.jsxs("div",{className:"flex justify-between gap-4",children:[c.jsxs("span",{className:"text-slate-400",children:[O,":"]}),c.jsx("span",{className:"font-bold text-cyan-400",children:De.toFixed(5)})]},O))]})]})]}),_t&&c.jsxs("div",{className:"absolute top-48 right-8 z-[55] w-72 bg-white dark:bg-slate-900 rounded-xl shadow-2xl border border-gray-200 dark:border-slate-700 p-4 animate-in slide-in-from-top-2",children:[c.jsx("h4",{className:"text-[10px] uppercase font-bold text-emerald-600 dark:text-emerald-400 mb-2 border-b border-gray-100 dark:border-slate-800 pb-1",children:"Range Averaging"}),c.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[c.jsx("input",{type:"number",step:"0.01",value:X,onChange:O=>se(O.target.value),className:"w-16 px-1 py-0.5 text-xs border rounded bg-transparent dark:border-slate-600 dark:text-white"}),c.jsx("span",{className:"text-gray-400",children:"-"}),c.jsx("input",{type:"number",step:"0.01",value:he,onChange:O=>le(O.target.value),className:"w-16 px-1 py-0.5 text-xs border rounded bg-transparent dark:border-slate-600 dark:text-white"}),c.jsx("button",{onClick:rn,className:"flex-1 bg-emerald-600 text-white text-[10px] font-bold py-1 rounded",children:"Avg"})]}),c.jsx("div",{className:"flex flex-col gap-2 max-h-48 overflow-y-auto",children:[0,1,2,3].map(O=>{const De=Ft[O];if(!De)return null;const ht=tn[`c${O}`];return c.jsxs("div",{className:"bg-gray-50 dark:bg-slate-800/50 p-2 rounded text-[10px] border border-gray-100 dark:border-slate-800",children:[c.jsxs("div",{className:"flex items-center gap-2 font-bold mb-1",style:{color:ht},children:[Ge[O]," ",c.jsxs("span",{className:"text-gray-400 font-normal",children:["(",De.count," pts)"]})]}),c.jsxs("div",{className:"grid grid-cols-2 gap-x-2 text-gray-700 dark:text-slate-300 font-mono",children:[c.jsxs("div",{children:["H: ",De.h.toExponential(3)]}),c.jsxs("div",{children:["V: ",De.v.toExponential(3)]})]})]},O)})})]}),wt&&c.jsx("div",{className:"absolute top-48 right-8 z-[55] w-56 bg-white dark:bg-slate-900 rounded-xl shadow-2xl border border-gray-200 dark:border-slate-700 p-4 animate-in slide-in-from-top-2",children:c.jsxs("div",{className:"flex flex-col gap-3",children:[c.jsxs("div",{children:[c.jsx("h4",{className:"text-[9px] uppercase font-bold text-gray-400 mb-1",children:"Move"}),c.jsxs("div",{className:"grid grid-cols-3 gap-1",children:[c.jsx("div",{}),c.jsx("button",{onClick:()=>Et(0,-1),className:"p-1.5 bg-gray-100 dark:bg-slate-800 rounded",children:""}),c.jsx("div",{}),c.jsx("button",{onClick:()=>Et(-1,0),className:"p-1.5 bg-gray-100 dark:bg-slate-800 rounded",children:""}),c.jsx("div",{}),c.jsx("button",{onClick:()=>Et(1,0),className:"p-1.5 bg-gray-100 dark:bg-slate-800 rounded",children:""}),c.jsx("div",{}),c.jsx("button",{onClick:()=>Et(0,1),className:"p-1.5 bg-gray-100 dark:bg-slate-800 rounded",children:""}),c.jsx("div",{})]})]}),c.jsxs("div",{children:[c.jsx("h4",{className:"text-[9px] uppercase font-bold text-gray-400 mb-1",children:"Size"}),c.jsxs("div",{className:"grid grid-cols-2 gap-1",children:[c.jsx("button",{onClick:()=>fr(2,0),className:"p-1 bg-gray-100 dark:bg-slate-800 rounded",children:"W+"}),c.jsx("button",{onClick:()=>fr(-2,0),className:"p-1 bg-gray-100 dark:bg-slate-800 rounded",children:"W-"}),c.jsx("button",{onClick:()=>fr(0,2),className:"p-1 bg-gray-100 dark:bg-slate-800 rounded",children:"H+"}),c.jsx("button",{onClick:()=>fr(0,-2),className:"p-1 bg-gray-100 dark:bg-slate-800 rounded",children:"H-"})]})]})]})}),c.jsx(Bre,{isOpen:je,onClose:()=>ke(!1),rawImageData:n,roi:a,selectedChannel:m===-1?0:m,channelName:m===-1?"Red (Default)":Ge[m],zIndex:s?s+2:102,onFocus:l})]}):null},zre=({isOpen:e,onClose:t,onMinimize:r,rawImageData:n,roi:a,isBGGR:i,zIndex:o,onFocus:s,initialPosition:l,initialInternalState:u,onUpdateState:f})=>{const[d,p]=C.useState((u==null?void 0:u.selectedChannelKey)||"G1"),[m,v]=C.useState((u==null?void 0:u.blackLevel)??0),[b,k]=C.useState((u==null?void 0:u.whiteLevel)??16383),[x,y]=C.useState(null),[w,_]=C.useState(!1),[S,j]=C.useState(null),[M,A]=C.useState(l||{x:150,y:150}),[$,E]=C.useState(!1),T=C.useRef({x:0,y:0});C.useEffect(()=>{f&&f({selectedChannelKey:d,blackLevel:m,whiteLevel:b})},[d,m,b]),C.useEffect(()=>{if(e&&n&&!u){const I=n.blackLevels?Math.floor(n.blackLevels[1]):0;v(I),k(n.whiteLevel||16383),y(null)}},[e,n]);const B=()=>{if(!n||!a)return;j(null),_(!0);const F=(i?{B:0,G1:1,G2:2,R:3}:{R:0,G1:1,G2:2,B:3})[d];setTimeout(()=>{try{const H=J6(n.data,n.width,n.height,a,F,m,b);H?y(H):(j("No data found in selection with current filters."),y(null))}catch(H){console.error("Analysis failed:",H),j(H.message||"Analysis error")}finally{_(!1)}},50)},U=(I,F,H)=>{s&&s(),!(H.closest("button")||H.closest("input")||H.closest("select"))&&(E(!0),T.current={x:I-M.x,y:F-M.y})},V=I=>{U(I.clientX,I.clientY,I.target)},G=I=>{const F=I.touches[0];U(F.clientX,F.clientY,I.target)};if(C.useEffect(()=>{const I=H=>{if($){const W="touches"in H?H.touches[0].clientX:H.clientX,Q="touches"in H?H.touches[0].clientY:H.clientY;A({x:W-T.current.x,y:Q-T.current.y})}},F=()=>E(!1);return $&&(window.addEventListener("mousemove",I),window.addEventListener("mouseup",F),window.addEventListener("touchmove",I,{passive:!1}),window.addEventListener("touchend",F)),()=>{window.removeEventListener("mousemove",I),window.removeEventListener("mouseup",F),window.removeEventListener("touchmove",I),window.removeEventListener("touchend",F)}},[$]),!e)return null;const D=i?["B","G1","G2","R"]:["R","G1","G2","B"];return c.jsxs("div",{className:"fixed flex flex-col bg-white dark:bg-slate-900 border border-gray-200 dark:border-slate-700 shadow-2xl rounded-xl resize-both overflow-hidden min-w-[500px] min-h-[400px] w-[900px] h-[700px]",style:{left:M.x,top:M.y,zIndex:o??100},onMouseDownCapture:s,children:[c.jsxs("div",{className:`flex justify-between items-center p-4 border-b border-gray-200 dark:border-slate-700 bg-white dark:bg-slate-900 select-none touch-none ${$?"cursor-grabbing":"cursor-grab"}`,onMouseDown:V,onTouchStart:G,children:[c.jsx("h2",{className:"text-xl font-bold text-gray-900 dark:text-slate-100 flex items-center gap-2 pointer-events-none",children:"Quantization Step Analysis"}),c.jsxs("div",{className:"flex items-center gap-1",children:[r&&c.jsx("button",{onClick:r,className:"text-gray-400 hover:text-gray-600 dark:hover:text-slate-300 p-2 rounded-lg hover:bg-gray-100 dark:hover:bg-slate-800 transition-colors",children:c.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M20 12H4"})})}),c.jsx("button",{onClick:t,className:"text-gray-400 hover:text-gray-600 dark:hover:text-slate-200 p-2",children:c.jsx("svg",{className:"w-6 h-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]})]}),c.jsxs("div",{className:"p-4 bg-gray-50 dark:bg-slate-800/50 border-b border-gray-200 dark:border-slate-700 flex flex-wrap gap-4 items-end flex-shrink-0",children:[c.jsxs("div",{className:"flex flex-col gap-1",children:[c.jsx("label",{className:"text-xs font-bold text-gray-500 dark:text-slate-400 uppercase",children:"Channel"}),c.jsx("select",{value:d,onChange:I=>p(I.target.value),className:"bg-white dark:bg-slate-700 border border-gray-300 dark:border-slate-600 rounded px-3 py-1.5 text-sm text-gray-900 dark:text-slate-100 outline-none focus:ring-1 focus:ring-cyan-500 min-w-[80px]",children:D.map(I=>c.jsx("option",{value:I,children:I},I))})]}),c.jsxs("div",{className:"flex flex-col gap-1",children:[c.jsx("label",{className:"text-xs font-bold text-gray-500 dark:text-slate-400 uppercase",children:"Black Level"}),c.jsx("input",{type:"number",value:m,onChange:I=>v(Number(I.target.value)),className:"w-24 px-3 py-1.5 bg-white dark:bg-slate-700 border border-gray-300 dark:border-slate-600 rounded outline-none text-sm text-gray-900 dark:text-slate-100"})]}),c.jsxs("div",{className:"flex flex-col gap-1",children:[c.jsx("label",{className:"text-xs font-bold text-gray-500 dark:text-slate-400 uppercase",children:"White Level"}),c.jsx("input",{type:"number",value:b,onChange:I=>k(Number(I.target.value)),className:"w-24 px-3 py-1.5 bg-white dark:bg-slate-700 border border-gray-300 dark:border-slate-600 rounded outline-none text-sm text-gray-900 dark:text-slate-100"})]}),c.jsx("button",{onClick:B,disabled:w,className:"mb-0.5 px-5 py-1.5 bg-cyan-600 hover:bg-cyan-500 text-white font-bold rounded shadow-sm hover:shadow transition-colors disabled:opacity-50 text-sm",children:w?"Analyzing...":"Run Analysis"})]}),c.jsxs("div",{className:"flex-1 overflow-y-auto p-4 flex flex-col gap-4 bg-white dark:bg-slate-900 min-h-0",children:[S&&c.jsx("div",{className:"p-3 bg-red-100 dark:bg-red-900/30 text-red-700 dark:text-red-300 rounded text-sm text-center flex-shrink-0",children:S}),!x&&!w&&!S&&c.jsx("div",{className:"flex-1 flex flex-col items-center justify-center text-gray-400 dark:text-slate-500 h-full",children:c.jsx("p",{children:"Configure parameters and click Run Analysis"})}),x&&c.jsxs(c.Fragment,{children:[c.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 flex-shrink-0",children:[c.jsxs("div",{className:"bg-gray-100 dark:bg-slate-800 p-3 rounded-lg border border-gray-200 dark:border-slate-700 text-center",children:[c.jsx("div",{className:"text-xs text-gray-500 dark:text-slate-400 uppercase mb-1",children:"Unique Codes"}),c.jsx("div",{className:"text-xl font-bold text-gray-900 dark:text-slate-100",children:x.uniqueCount})]}),c.jsxs("div",{className:"bg-gray-100 dark:bg-slate-800 p-3 rounded-lg border border-gray-200 dark:border-slate-700 text-center",children:[c.jsx("div",{className:"text-xs text-gray-500 dark:text-slate-400 uppercase mb-1",children:"Total Diffs"}),c.jsx("div",{className:"text-xl font-bold text-gray-900 dark:text-slate-100",children:x.diffCount})]})]}),c.jsxs("div",{className:"bg-white dark:bg-slate-800/50 rounded-xl border border-gray-200 dark:border-slate-700 overflow-hidden flex-shrink-0",children:[c.jsx("div",{className:"px-4 py-2 bg-gray-50 dark:bg-slate-800 border-b border-gray-200 dark:border-slate-700 text-xs font-bold text-gray-500 dark:text-slate-400 uppercase",children:"Step Distribution"}),c.jsx("div",{className:"p-4 flex flex-wrap gap-x-8 gap-y-2 text-sm font-mono max-h-32 overflow-y-auto",children:Object.entries(x.stepCounts).sort((I,F)=>parseFloat(I[0])-parseFloat(F[0])).map(([I,F])=>c.jsxs("div",{className:"flex gap-2",children:[c.jsxs("span",{className:"text-gray-500 dark:text-slate-400",children:["Step ",I,":"]}),c.jsx("span",{className:"text-cyan-600 dark:text-cyan-400 font-bold",children:String(F)})]},I))})]}),c.jsxs("div",{className:"flex-1 bg-white dark:bg-slate-900 border border-gray-200 dark:border-slate-700 rounded-xl p-2 relative overflow-hidden min-h-[300px]",children:[c.jsx("div",{className:"absolute top-2 left-4 text-xs font-bold text-gray-400 dark:text-slate-500 pointer-events-none z-20 bg-white/80 dark:bg-slate-900/80 px-2 rounded",children:"Step Size vs Code Value"}),c.jsx("div",{className:"absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 z-0 pointer-events-none select-none opacity-10 mix-blend-normal dark:mix-blend-plus-lighter",children:c.jsx("svg",{viewBox:"0 0 500 60",className:"w-96 h-auto",children:c.jsx("text",{x:"50%",y:"50%",dominantBaseline:"middle",textAnchor:"middle",className:"fill-gray-900 dark:fill-white",fontSize:"36",fontWeight:"bold",style:{fontFamily:"sans-serif",letterSpacing:"0.05em"},children:" y-g-jiang.github.io"})})}),c.jsx("div",{className:"relative z-10 w-full h-full",children:c.jsx(Ui,{width:"100%",height:"100%",children:c.jsxs(Xs,{data:x.plotData,margin:{top:20,right:20,bottom:20,left:10},children:[c.jsx(Ni,{strokeDasharray:"3 3",stroke:"#374151",opacity:.1}),c.jsx(ka,{dataKey:"x",type:"number",domain:["auto","auto"],tick:{fill:"#9ca3af",fontSize:10},label:{value:"Code Value (Shifted)",position:"insideBottom",offset:-10,fill:"#9ca3af",fontSize:11}}),c.jsx(Sa,{tick:{fill:"#9ca3af",fontSize:10},domain:[0,"auto"],allowDataOverflow:!1,label:{value:"Step Size (Delta)",angle:-90,position:"insideLeft",fill:"#9ca3af",fontSize:11}}),c.jsx(Un,{contentStyle:{backgroundColor:"rgba(17, 24, 39, 0.95)",border:"1px solid #374151",borderRadius:"0.5rem",color:"#f3f4f6",fontSize:"12px"},labelFormatter:I=>`Val: ${I}`,formatter:I=>[I,"Step Size"]}),c.jsx(xn,{type:"stepAfter",dataKey:"y",stroke:"#0891b2",strokeWidth:1.5,dot:{r:1.5,fill:"#0891b2",strokeWidth:0},activeDot:{r:4},isAnimationActive:!1})]})})})]})]})]})]})},Wre=({isOpen:e,onClose:t,rawImageData:r,roi:n,isBGGR:a,zIndex:i,onFocus:o,initialPosition:s,stackFiles:l})=>{const[u,f]=C.useState("cross"),[d,p]=C.useState("R"),[m,v]=C.useState("B"),[b,k]=C.useState("H"),[x,y]=C.useState(null),[w,_]=C.useState(!1),[S,j]=C.useState(0),[M,A]=C.useState(0),[$,E]=C.useState("single"),T=a?{B:0,G1:1,G2:2,R:3}:{R:0,G1:1,G2:2,B:3},B=a?["B","G1","G2","R"]:["R","G1","G2","B"],U=async V=>{if(!r||!n)return;_(!0),E(V),j(0),y(null);let G=T[d],D=u==="cross"?T[m]:G,I=0,F=0;u==="self"&&(b==="H"?F=2:I=2),setTimeout(async()=>{try{let H={sumCov:0,sumVar1:0,sumVar2:0,n:0};if(V==="single")H=kw(r.data,r.width,r.height,n,G,D,I,F);else if(l&&l.length>0)for(let W=0;W<l.length;W++){j(W+1);const Q=await l[W].arrayBuffer(),q=await pc(Q),re=kw(q.data,q.width,q.height,n,G,D,I,F);H.sumCov+=re.sumCov,H.sumVar1+=re.sumVar1,H.sumVar2+=re.sumVar2,H.n+=re.n}A(H.n),y(q6(H))}catch(H){console.error("Pearson calculation failed",H),alert("Calculation error: "+H.message)}finally{_(!1)}},50)};return e?c.jsxs(ks,{initialPosition:s||{x:200,y:200},onClose:t,zIndex:i,onFocus:o,className:"w-80 bg-white dark:bg-slate-900 border border-gray-200 dark:border-slate-700 flex flex-col shadow-2xl overflow-hidden",children:[c.jsxs("div",{className:"flex justify-between items-center px-4 py-3 border-b border-gray-200 dark:border-slate-700 bg-gray-50 dark:bg-slate-800",children:[c.jsxs("h3",{className:"text-sm font-bold text-gray-700 dark:text-slate-200 flex items-center gap-2",children:["Pearson Correlation",c.jsx("span",{className:"text-[10px] font-normal bg-white dark:bg-slate-700 px-1.5 py-0.5 rounded border border-gray-200 dark:border-slate-600",children:"r"})]}),c.jsx("button",{onClick:t,className:"text-gray-400 hover:text-red-500 transition-colors",children:c.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),c.jsxs("div",{className:"p-4 flex flex-col gap-4",children:[c.jsxs("div",{className:"flex bg-gray-100 dark:bg-slate-800 p-1 rounded-lg border border-gray-200 dark:border-slate-700",children:[c.jsx("button",{onClick:()=>f("cross"),className:`flex-1 py-1 text-[10px] font-bold rounded transition-all ${u==="cross"?"bg-indigo-600 text-white shadow":"text-gray-500 dark:text-slate-400 hover:bg-gray-200 dark:hover:bg-slate-700"}`,children:"Cross-Channel"}),c.jsx("button",{onClick:()=>f("self"),className:`flex-1 py-1 text-[10px] font-bold rounded transition-all ${u==="self"?"bg-indigo-600 text-white shadow":"text-gray-500 dark:text-slate-400 hover:bg-gray-200 dark:hover:bg-slate-700"}`,children:"Self-Adjacent"})]}),c.jsxs("div",{className:"flex items-center gap-3",children:[c.jsxs("div",{className:"flex-1 flex flex-col gap-1",children:[c.jsx("label",{className:"text-[9px] uppercase font-bold text-gray-400",children:u==="cross"?"Channel 1":"Channel"}),c.jsx("select",{value:d,onChange:V=>p(V.target.value),className:"bg-gray-100 dark:bg-slate-800 border border-gray-200 dark:border-slate-700 rounded px-2 py-1.5 text-xs text-gray-700 dark:text-slate-200 outline-none focus:ring-1 focus:ring-indigo-500",children:B.map(V=>c.jsx("option",{value:V,children:V},V))})]}),c.jsx("div",{className:"text-gray-300 dark:text-slate-600 mt-4 font-mono",children:u==="cross"?"":""}),c.jsxs("div",{className:"flex-1 flex flex-col gap-1",children:[c.jsx("label",{className:"text-[9px] uppercase font-bold text-gray-400",children:u==="cross"?"Channel 2":"Direction"}),u==="cross"?c.jsx("select",{value:m,onChange:V=>v(V.target.value),className:"bg-gray-100 dark:bg-slate-800 border border-gray-200 dark:border-slate-700 rounded px-2 py-1.5 text-xs text-gray-700 dark:text-slate-200 outline-none focus:ring-1 focus:ring-indigo-500",children:B.map(V=>c.jsx("option",{value:V,children:V},V))}):c.jsxs("div",{className:"flex h-[28px] bg-gray-100 dark:bg-slate-800 rounded border border-gray-200 dark:border-slate-700 p-0.5",children:[c.jsx("button",{onClick:()=>k("H"),className:`flex-1 text-[9px] font-bold rounded ${b==="H"?"bg-slate-300 dark:bg-slate-600 text-indigo-600 dark:text-indigo-400":"text-gray-400"}`,children:"Horiz"}),c.jsx("button",{onClick:()=>k("V"),className:`flex-1 text-[9px] font-bold rounded ${b==="V"?"bg-slate-300 dark:bg-slate-600 text-indigo-600 dark:text-indigo-400":"text-gray-400"}`,children:"Vert"})]})]})]}),c.jsxs("div",{className:"grid grid-cols-1 gap-2",children:[c.jsx("button",{onClick:()=>U("single"),disabled:w,className:"w-full py-2 bg-indigo-600 hover:bg-indigo-500 disabled:bg-gray-400 text-white font-bold rounded shadow-md transition-all active:scale-95 text-xs",children:w&&$==="single"?"Calculating...":"Calc Current Frame"}),l&&l.length>0&&c.jsxs("button",{onClick:()=>U("stack"),disabled:w,className:"w-full py-2 bg-emerald-600 hover:bg-emerald-500 disabled:bg-gray-400 text-white font-bold rounded shadow-md transition-all active:scale-95 text-xs flex flex-col items-center justify-center",children:[c.jsx("span",{children:"Calc Stack Concatenated"}),w&&$==="stack"&&c.jsxs("span",{className:"text-[9px] font-normal opacity-80",children:["Progress: ",S," / ",l.length]})]})]}),x!==null&&c.jsxs("div",{className:"mt-2 p-4 bg-gray-50 dark:bg-slate-800/50 rounded-xl border border-gray-200 dark:border-slate-700 text-center animate-in fade-in slide-in-from-top-2",children:[c.jsxs("div",{className:"text-[10px] uppercase font-bold text-gray-400 dark:text-slate-500 mb-1",children:[u==="cross"?"Cross-Channel":`Self-Adj (${b})`," r"]}),c.jsx("div",{className:"text-2xl font-mono font-bold text-indigo-600 dark:text-indigo-400 select-all",style:{fontSize:"24px"},children:x.toFixed(5)}),c.jsxs("div",{className:"text-[9px] text-gray-400 mt-2 font-mono",children:["N = ",M.toLocaleString()," pairs"]}),c.jsx("div",{className:"mt-3 text-[10px] font-bold",children:Math.abs(x)>.5?c.jsx("span",{className:"text-red-500",children:"Significant Correlation"}):Math.abs(x)>.1?c.jsx("span",{className:"text-amber-500",children:"Weak Correlation"}):c.jsx("span",{className:"text-emerald-500",children:"Near-Zero (Uncorrelated)"})})]})]}),c.jsx("div",{className:"p-3 bg-gray-50/50 dark:bg-slate-800/30 text-[9px] text-gray-400 dark:text-slate-600 italic border-t border-gray-100 dark:border-slate-800",children:u==="cross"?"Comparing two color channels in the same Bayer 2x2 cells.":`Comparing pixel (r,c) with (r${b==="V"?"+2":""}, c${b==="H"?"+2":""}) in the same channel.`})]}):null},Vre=[{href:"https://y-g-jiang.github.io/CBLD.html",text:" (Primary Source)",abbr:"CBLD",description:"ISO",highlight:!0},{href:"https://y-G-jiang.github.io/LAC.html",text:"",abbr:"LAC",description:""},{href:"https://y-G-jiang.github.io/CCGV.html",text:"adobeIECMF",abbr:"CCGV",description:"acrRAWxy"},{href:"https://y-G-jiang.github.io/JTJS.html",text:"",abbr:"JTJS",description:"CMF/"},{href:"https://y-G-jiang.github.io/XJZS.html",text:"",abbr:"XJZS",description:""}],Hre=["5","9","0","8","2","1","4","7","3","6"],m3=e=>!e||e==="--"?"--":String(e).split("").map(t=>{const r=parseInt(t);return isNaN(r)?t:Hre[r]}).join(""),Xre=({isOpen:e,onClose:t})=>{const[r,n]=C.useState({pv:"--",uv:"--"});return C.useEffect(()=>{if(e){const a=()=>{const o=document.getElementById("vercount_value_site_pv"),s=document.getElementById("vercount_value_site_uv");o&&s&&n({pv:o.innerText||"--",uv:s.innerText||"--"})};a();const i=setTimeout(a,1e3);return()=>clearTimeout(i)}},[e]),e?c.jsx("div",{className:"fixed inset-0 z-[100] flex items-center justify-center bg-black/60 backdrop-blur-sm p-4 animate-in fade-in duration-200",onClick:t,children:c.jsxs("div",{className:"bg-white dark:bg-slate-900 w-full max-w-3xl rounded-2xl shadow-2xl border border-gray-200 dark:border-slate-700 overflow-hidden flex flex-col max-h-[90vh]",onClick:a=>a.stopPropagation(),children:[c.jsxs("div",{className:"flex justify-between items-center p-5 border-b border-gray-200 dark:border-slate-700 bg-gray-50 dark:bg-slate-800/50",children:[c.jsx("h2",{className:"text-xl font-bold text-gray-900 dark:text-white",children:"About / Tools"}),c.jsx("button",{onClick:t,className:"text-gray-400 hover:text-gray-600 dark:hover:text-slate-200 transition-colors p-1 rounded hover:bg-gray-200 dark:hover:bg-slate-700",children:c.jsx("svg",{className:"w-6 h-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),c.jsxs("div",{className:"p-6 overflow-y-auto scrollbar-thin scrollbar-thumb-gray-300 dark:scrollbar-thumb-slate-700 relative",children:[c.jsx("div",{className:"mb-8 p-4 bg-gray-50 dark:bg-slate-800/50 rounded-xl border border-gray-100 dark:border-slate-700 text-center",children:c.jsxs("p",{className:"text-lg text-gray-700 dark:text-slate-300",children:[c.jsx("span",{className:"font-bold mr-2",children:"about:"}),c.jsx("a",{href:"https://y-g-jiang.github.io/JOindex.html",target:"_blank",rel:"noopener noreferrer",className:"text-cyan-600 dark:text-cyan-400 hover:underline break-all font-mono",children:"https://y-g-jiang.github.io/JOindex.html"})]})}),c.jsxs("div",{className:"flex items-center gap-4 mb-6",children:[c.jsx("div",{className:"h-px bg-gray-200 dark:bg-slate-700 flex-1"}),c.jsx("span",{className:"text-sm font-bold text-gray-400 dark:text-slate-500 uppercase tracking-wider",children:"Primary Resources"}),c.jsx("div",{className:"h-px bg-gray-200 dark:bg-slate-700 flex-1"})]}),c.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4 mb-8",children:Vre.map(a=>c.jsxs("a",{href:a.href,target:"_blank",rel:"noopener noreferrer",className:`group block p-4 rounded-xl border transition-all duration-200 relative overflow-hidden ${a.highlight?"border-cyan-500 dark:border-cyan-400 bg-cyan-50/30 dark:bg-cyan-900/10 shadow-lg scale-[1.02] ring-2 ring-cyan-500/20":"border-gray-200 dark:border-slate-700 bg-white dark:bg-slate-800/30 hover:bg-gray-50 dark:hover:bg-slate-800 hover:border-cyan-500"}`,children:[c.jsx("div",{className:"absolute top-0 right-0 w-16 h-16 bg-gradient-to-bl from-cyan-500/5 to-transparent -mr-8 -mt-8 rounded-full pointer-events-none group-hover:from-cyan-500/10 transition-colors"}),c.jsxs("div",{className:"flex items-center gap-3 mb-2 relative z-10",children:[c.jsx("span",{className:`px-2 py-1 text-xs font-bold rounded transition-colors border ${a.highlight?"bg-cyan-600 text-white border-cyan-500":"bg-gray-100 dark:bg-slate-700 text-gray-600 dark:text-slate-300 border-gray-200 dark:border-slate-600 group-hover:border-cyan-200"}`,children:a.abbr}),c.jsx("h3",{className:`font-bold transition-colors ${a.highlight?"text-cyan-700 dark:text-cyan-300":"text-gray-800 dark:text-slate-200 group-hover:text-cyan-600"}`,children:a.text})]}),c.jsx("p",{className:`text-xs pl-1 transition-colors relative z-10 ${a.highlight?"text-cyan-600/80 dark:text-cyan-400/80":"text-gray-500 dark:text-slate-400"}`,children:a.description})]},a.abbr))}),c.jsx("div",{className:"flex justify-end mt-4",children:c.jsx("div",{className:"bg-gray-50 dark:bg-slate-900/50 rounded border border-gray-200 dark:border-slate-800 p-1.5 opacity-40 hover:opacity-100 transition-opacity cursor-default select-none group",children:c.jsxs("div",{className:"font-mono text-[10px] text-gray-400 dark:text-slate-600 leading-tight text-right flex flex-col",children:[c.jsx("span",{className:"group-hover:text-indigo-400 transition-colors",children:m3(r.pv)}),c.jsx("span",{className:"group-hover:text-emerald-400 transition-colors",children:m3(r.uv)})]})})})]})]})}):null},Kre=({isOpen:e,onClose:t,data:r,fileName:n,warning:a})=>{const[i,o]=C.useState(""),s=f=>{const d=new WeakSet;try{return JSON.stringify(f,(p,m)=>{if(typeof m=="bigint")return m.toString()+"n";if(typeof m=="object"&&m!==null){if(d.has(m))return"[Circular]";if(d.add(m),ArrayBuffer.isView(m))return`[${m.constructor.name}]`}return m})}catch{return"[Unable to serialize object]"}},l=C.useMemo(()=>{if(!r)return[];const f=[],d=(p,m=0)=>{if(m>5)return"...";if(p==null)return String(p);if(p instanceof Date)return p.toLocaleString();if(typeof p=="number")return p.toString();if(typeof p=="string")return p;if(typeof p=="bigint")return p.toString()+"n";if(ArrayBuffer.isView(p))return`<${p.constructor.name} len=${p.length} bytes=${p.byteLength}>`;if(p instanceof ArrayBuffer)return`<ArrayBuffer bytes=${p.byteLength}>`;if(typeof p=="object"){if(Array.isArray(p))return p.length===0?"[]":p.length>20?`[${p.slice(0,10).map(k=>typeof k=="number"?k.toFixed(2):d(k,m+1)).join(", ")}, ... (+${p.length-10} more)]`:`[${p.map(b=>typeof b=="number"?Number.isInteger(b)?b:b.toFixed(4):d(b,m+1)).join(", ")}]`;try{const v=Object.keys(p);return v.length>5?`{Object with ${v.length} keys}`:s(p)}catch{return"<Complex Object>"}}return String(p)};try{if(typeof r!="object")return[{key:"Value",value:String(r)}];Object.keys(r).sort().forEach(m=>{if(m==="MakerNote"||m==="UserComment"||m.includes("Strip")||m.includes("Offset")){f.push({key:m,value:"<Binary/Internal Data>"});return}const v=r[m];f.push({key:m,value:d(v)})})}catch(p){console.error("Error processing EXIF data:",p),f.push({key:"Error",value:"Failed to process metadata structure."})}return f},[r]);if(!e)return null;const u=l.filter(f=>f.key.toLowerCase().includes(i.toLowerCase())||f.value.toLowerCase().includes(i.toLowerCase()));return c.jsx("div",{className:"fixed inset-0 z-[100] flex items-center justify-center bg-black/60 backdrop-blur-sm p-4 animate-in fade-in duration-200",onClick:t,children:c.jsxs("div",{className:"bg-white dark:bg-slate-900 w-full max-w-3xl max-h-[90vh] rounded-2xl shadow-2xl flex flex-col border border-gray-200 dark:border-slate-700",onClick:f=>f.stopPropagation(),children:[c.jsxs("div",{className:"flex justify-between items-center p-5 border-b border-gray-200 dark:border-slate-700",children:[c.jsxs("div",{className:"overflow-hidden",children:[c.jsx("h2",{className:"text-xl font-bold text-gray-900 dark:text-slate-100",children:"EXIF Data"}),c.jsx("p",{className:"text-sm text-gray-500 dark:text-slate-400 mt-1 font-mono truncate",children:n})]}),c.jsx("button",{onClick:t,className:"text-gray-400 hover:text-gray-600 dark:hover:text-slate-200 transition-colors p-2 rounded-full hover:bg-gray-100 dark:hover:bg-slate-800",children:c.jsx("svg",{className:"w-6 h-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),a&&c.jsx("div",{className:"bg-amber-50 dark:bg-amber-900/20 px-4 py-2 border-b border-amber-100 dark:border-amber-800/50 text-center",children:c.jsx("p",{className:"text-xs text-amber-600 dark:text-amber-400 whitespace-pre-line font-medium leading-relaxed",children:a})}),c.jsx("div",{className:"p-4 border-b border-gray-200 dark:border-slate-700 bg-gray-50 dark:bg-slate-800/50",children:c.jsxs("div",{className:"relative",children:[c.jsx("svg",{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-gray-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})}),c.jsx("input",{type:"text",placeholder:"Search tags...",value:i,onChange:f=>o(f.target.value),className:"w-full pl-9 pr-4 py-2 bg-white dark:bg-slate-900 border border-gray-300 dark:border-slate-600 rounded-lg text-sm focus:ring-2 focus:ring-cyan-500 outline-none text-gray-900 dark:text-slate-100 transition-colors placeholder-gray-400"})]})}),c.jsx("div",{className:"overflow-y-auto flex-1 p-0 scrollbar-thin scrollbar-thumb-gray-300 dark:scrollbar-thumb-slate-700",children:u.length>0?c.jsxs("table",{className:"w-full text-left border-collapse table-fixed",children:[c.jsx("thead",{className:"bg-gray-50 dark:bg-slate-800 sticky top-0 shadow-sm z-10",children:c.jsxs("tr",{children:[c.jsx("th",{className:"py-3 px-5 font-semibold text-xs text-gray-500 dark:text-slate-400 uppercase tracking-wider w-1/3 border-b border-gray-200 dark:border-slate-700",children:"Tag Name"}),c.jsx("th",{className:"py-3 px-5 font-semibold text-xs text-gray-500 dark:text-slate-400 uppercase tracking-wider w-2/3 border-b border-gray-200 dark:border-slate-700",children:"Value"})]})}),c.jsx("tbody",{className:"divide-y divide-gray-100 dark:divide-slate-800",children:u.map(f=>c.jsxs("tr",{className:"hover:bg-gray-50 dark:hover:bg-slate-800/50 transition-colors group",children:[c.jsx("td",{className:"py-2 px-5 text-sm font-medium text-cyan-600 dark:text-cyan-400 font-mono break-words align-top",children:f.key}),c.jsx("td",{className:"py-2 px-5 text-sm text-gray-700 dark:text-slate-300 font-mono break-words align-top group-hover:text-gray-900 dark:group-hover:text-slate-100",children:f.value})]},f.key))})]}):c.jsx("div",{className:"flex flex-col items-center justify-center h-64 text-gray-400 dark:text-slate-500",children:c.jsxs("p",{children:['No tags found matching "',i,'"']})})}),c.jsx("div",{className:"p-4 border-t border-gray-200 dark:border-slate-700 bg-gray-50 dark:bg-slate-800/50 flex justify-end rounded-b-2xl",children:c.jsx("button",{onClick:t,className:"px-4 py-2 bg-gray-200 hover:bg-gray-300 dark:bg-slate-700 dark:hover:bg-slate-600 text-gray-800 dark:text-white rounded-lg text-sm font-semibold transition-colors",children:"Close"})})]})})},qre=100,qm=e=>{if(e.length===0)return 0;if(e.length===1)return e[0];if(e.length===2)return .5*(e[0]+e[1]);let t=[...e].sort((r,n)=>r-n);for(;t.length>4;){let r=1/0,n=0;const a=t.length,i=Math.floor(a/2);for(let o=0;o<=a-i;o++){const s=t[o+i-1]-t[o];s<r&&(r=s,n=o)}t=t.slice(n,n+i)}return t.reduce((r,n)=>r+n,0)/t.length},y3=({min:e,max:t,value:r,onChange:n,vertical:a=!1,logScale:i=!1})=>{const o=C.useRef(null),s=C.useRef(null),l=C.useCallback(y=>{const w=i?Math.max(1e-6,e):e,_=i?Math.max(w*1.0001,t):t,S=Math.max(w,Math.min(_,y));if(i){const j=Math.log10(w),M=Math.log10(_);return(Math.log10(S)-j)/(M-j)}return(S-w)/(_-w)},[e,t,i]),u=C.useCallback(y=>{const w=i?Math.max(1e-6,e):e,_=i?Math.max(w*1.0001,t):t;if(i){const S=Math.log10(w),j=Math.log10(_);return Math.pow(10,S+y*(j-S))}return w+y*(_-w)},[e,t,i]),f=(y,w)=>{y.preventDefault(),y.stopPropagation(),s.current=w;const _=j=>{if(!s.current||!o.current)return;const M=o.current.getBoundingClientRect();let A=0;a?A=(M.bottom-j.clientY)/M.height:A=(j.clientX-M.left)/M.width,A=Math.max(0,Math.min(1,A));const $=u(A);if(s.current==="min"){const E=r[1];n([Math.min($,E),E])}else{const E=r[0];n([E,Math.max($,E)])}},S=()=>{s.current=null,window.removeEventListener("mousemove",_),window.removeEventListener("mouseup",S)};window.addEventListener("mousemove",_),window.addEventListener("mouseup",S)},d=l(r[0])*100,p=l(r[1])*100,m=a?{left:"50%",top:0,bottom:0,width:"4px",transform:"translateX(-50%)"}:{top:"50%",left:0,right:0,height:"4px",transform:"translateY(-50%)"},v=a?{left:"50%",bottom:`${d}%`,height:`${p-d}%`,width:"4px",transform:"translateX(-50%)"}:{top:"50%",left:`${d}%`,width:`${p-d}%`,height:"4px",transform:"translateY(-50%)"},b="absolute w-3 h-3 bg-white border-2 border-cyan-600 rounded-full shadow-md cursor-pointer hover:scale-125 transition-transform z-10",k=a?{left:"50%",bottom:`${d}%`,transform:"translate(-50%, 50%)"}:{top:"50%",left:`${d}%`,transform:"translate(-50%, -50%)"},x=a?{left:"50%",bottom:`${p}%`,transform:"translate(-50%, 50%)"}:{top:"50%",left:`${p}%`,transform:"translate(-50%, -50%)"};return c.jsxs("div",{ref:o,className:`relative select-none ${a?"h-full w-4 py-2":"w-full h-4 px-2"}`,children:[c.jsx("div",{className:"absolute bg-gray-300 dark:bg-slate-600 rounded-full",style:m}),c.jsx("div",{className:"absolute bg-cyan-500 dark:bg-cyan-400 rounded-full",style:v}),c.jsx("div",{className:b,style:k,onMouseDown:y=>f(y,"min")}),c.jsx("div",{className:b,style:x,onMouseDown:y=>f(y,"max")})]})},Yre=({isOpen:e,onClose:t,data:r,blackLevel:n,imageHeight:a,isBGGR:i,importedMetadata:o,theme:s,initialCameraModel:l,initialISO:u})=>{const[f,d]=C.useState("Noise"),[p,m]=C.useState(!0),[v,b]=C.useState(null),[k,x]=C.useState("default"),[y,w]=C.useState(!1),[_,S]=C.useState(!1),[j,M]=C.useState({R:!0,G1:!0,G2:!0,B:!0}),[A,$]=C.useState(""),[E,T]=C.useState(""),[B,U]=C.useState(""),[V,G]=C.useState(""),[D,I]=C.useState("10"),[F,H]=C.useState(""),[W,Q]=C.useState("0 0 0 0"),[q,re]=C.useState("0 0 0 0"),[ee,fe]=C.useState(!1),[oe,ye]=C.useState(null),[ae,X]=C.useState(!1),[se,he]=C.useState(0),[le,je]=C.useState([]),[ke,ve]=C.useState(""),[ge,Me]=C.useState(""),Oe=()=>{const te=parseFloat(ke),me=parseFloat(ge);!isNaN(te)&&!isNaN(me)&&(je([...le,{id:Date.now(),x:te,y:me}]),ve(""),Me(""))},[We,Le]=C.useState(()=>localStorage.getItem("ptc_tester_name")||""),[tt,mt]=C.useState(""),[wt,Qt]=C.useState("");C.useEffect(()=>{localStorage.setItem("ptc_tester_name",We)},[We]);const _t=C.useRef(ee),Jt=C.useRef(ae),Nt=C.useRef(se);C.useEffect(()=>{_t.current=ee,Jt.current=ae,Nt.current=se},[ee,ae,se]);const[er,Vr]=C.useState(null),[Tt,Sr]=C.useState({min:.01,max:90}),[Ve,Pt]=C.useState({readNoise:0,gain:1,prnu:.5}),[Bt,Dt]=C.useState(2e6),tr=C.useRef(Ve),rr=C.useRef(Tt),Hr=C.useRef(Bt);C.useEffect(()=>{tr.current=Ve,rr.current=Tt,Hr.current=Bt},[Ve,Tt,Bt]);const[Ft,bn]=C.useState({read:"0",gain:"1.0",prnu:"0.5",rangeMin:"0.01",rangeMax:"90"}),[Ct,tn]=C.useState({read:!0,shot:!0,prnu:!0,total:!0,fitRange:!0}),[Ge,rn]=C.useState(!1),[Ar,sn]=C.useState([]),[Xr,Tr]=C.useState(null),[Cr,Er]=C.useState(""),wn=C.useMemo(()=>n?n.join(","):"",[n]);C.useEffect(()=>{if(e){let te="0 0 0 0";o&&o.blackLevel?te=o.blackLevel.join(" "):te=n&&n.length===4?n.join(" "):"0 0 0 0",Q(te),re(te);let me="";if(o&&o.height?me=o.height.toString():a&&(me=a.toString()),H(me),me){const Y=parseFloat(me);!isNaN(Y)&&Y>0?I((2309.4/Y).toFixed(2)):I("10")}else I("10");ye(null),fe(!1),X(!1),he(0),sn([]),Tr(null),Sr({min:.01,max:90}),bn({read:"0",gain:"0",prnu:"0",rangeMin:"0.01",rangeMax:"90"});const be={readNoise:0,gain:0,prnu:0};Pt(be),tr.current=be,$(""),T(""),U(""),G(""),d("Noise"),Vr(null),Dt(2e6),Er(""),S(!1),je([]),mt(Y=>Y.trim()===""&&l?l:Y),Qt(Y=>Y.trim()===""&&u?u:Y)}},[e,wn,o,a,r,l,u]);const kn=te=>{if(te.key==="Enter"){const me=parseFloat(F);if(!isNaN(me)&&me>0){const be=(2309.4/me).toFixed(2);I(be)}te.target.blur()}},qt=C.useMemo(()=>{let me=q.trim().split(/[\s,]+/).filter(Boolean).map(Number);for(me.length===1&&(me=[me[0],me[0],me[0],me[0]]);me.length<4;)me.push(0);const be=Y=>{switch(Y){case"R":return me[0];case"G1":return me[1];case"G2":return me[2];case"B":return me[3];default:return 0}};return r.map(Y=>{const Ae=Y.mean-be(Y.channel),at=Y.std>0?Ae/Y.std:0;return{...Y,x:Ae,std:Y.std,snr:at}}).filter(Y=>Y.std>0)},[r,q]),Et=C.useMemo(()=>{const te=Ve.readNoise,me=te*te;return qt.map(be=>{let Y=0;if(f==="Noise")Y=be.std;else if(f==="SNR")Y=be.snr;else if(f==="Linear"){const at=be.std*be.std-me;Y=be.x!==0?at/be.x:0}return{...be,y:Y}})},[qt,f,Ve.readNoise]),fr=C.useMemo(()=>{if(qt.length===0)return"G1";const te={R:0,G1:0,G2:0,B:0},me={R:0,G1:0,G2:0,B:0};for(const Ae of qt)te[Ae.channel]+=Ae.x,me[Ae.channel]++;let be="G1",Y=-1/0;return Object.keys(te).forEach(Ae=>{const at=me[Ae],rt=at>0?te[Ae]/at:-1/0;rt>Y&&(Y=rt,be=Ae)}),be},[qt]),O=C.useCallback(()=>{let te=1/0,me=-1/0;if(qt.length===0)return{min:.1,max:1};for(let be=0;be<qt.length;be++){const Y=qt[be].x;p&&Y<=0||(Y<te&&(te=Y),Y>me&&(me=Y))}return te===1/0?{min:.1,max:1}:{min:te,max:me}},[qt,p]),De=C.useCallback(()=>{let te=1/0,me=-1/0;if(Et.length===0)return{min:.1,max:1};for(let be=0;be<Et.length;be++){const Y=Et[be].y;p&&Y<=0||(Y<te&&(te=Y),Y>me&&(me=Y))}return te===1/0?{min:.1,max:1}:{min:te*.9,max:me*1.1}},[Et,p]),{min:ht,max:Vt}=O(),{min:$t,max:mr}=De(),$r=Vt*(Tt.min/100),nr=Vt*(Tt.max/100),He=C.useMemo(()=>{if(!p&&Et.length===0)return{shot:[],read:[],prnu:[],total:[]};const te=A?parseFloat(A):ht,me=E?parseFloat(E):Vt,be=100,Y=Math.max(.1,te),Ae=Math.max(1,me);if(Y>=Ae)return{shot:[],read:[],prnu:[],total:[]};const at=Math.log10(Y),Lt=(Math.log10(Ae)-at)/be,dt=Ve.readNoise,yt=Ve.gain>0?Ve.gain:1,dr=Ve.prnu/100,ar=[],cr=[],hr=[],Pe=[];for(let ut=0;ut<=be;ut++){const Qe=Math.pow(10,at+ut*Lt);if(f==="Linear"){const Je=1/yt,Xt=dr*dr,lt=Je+Xt*Qe;Pe.push({x:Qe,y:lt}),ar.push({x:Qe,y:Je}),hr.push({x:Qe,y:Xt*Qe})}else{const Je=dt,Xt=Math.sqrt(Qe/yt),lt=dr*Qe,zt=Math.sqrt(Je*Je+Xt*Xt+lt*lt);f==="Noise"?(ar.push({x:Qe,y:Xt}),cr.push({x:Qe,y:Je}),hr.push({x:Qe,y:lt}),Pe.push({x:Qe,y:zt})):(Xt>0&&ar.push({x:Qe,y:Qe/Xt}),Je>0&&cr.push({x:Qe,y:Qe/Je}),lt>0&&hr.push({x:Qe,y:Qe/lt}),zt>0&&Pe.push({x:Qe,y:Qe/zt}))}}return{shot:ar,read:cr,prnu:hr,total:Pe}},[Et,p,A,E,Ve,f,ht,Vt]),pt=C.useMemo(()=>{if(f==="Linear")return[];const te=parseFloat(D);if(isNaN(te)||te<=0)return[];const me=A?parseFloat(A):ht,be=E?parseFloat(E):Vt;return f==="SNR"?[{x:me,y:te},{x:be,y:te}]:[{x:me,y:me/te},{x:be,y:be/te}]},[Et,D,f,A,E,ht,Vt]),It=C.useCallback((te,me)=>{if(!me||me.length===0)return null;const be=[...me].sort((Y,Ae)=>Y.x-Ae.x);for(let Y=0;Y<be.length-1;Y++){const Ae=be[Y],at=be[Y+1];if(Ae.snr<=te&&at.snr>=te||Ae.snr>=te&&at.snr<=te){const rt=(te-Ae.snr)/(at.snr-Ae.snr);return Ae.x+rt*(at.x-Ae.x)}}return null},[]),Ht=C.useMemo(()=>{const te=qt,me=1e3,be=Ae=>{if(Ae.length===0)return[];if(Ae.length<=me)return Ae;const at=[...Ae].sort((dt,yt)=>dt.x-yt.x),rt=[],Lt=at.length/me;for(let dt=0;dt<me;dt++){const yt=Math.floor(dt*Lt),dr=Math.floor((dt+1)*Lt),ar=at.slice(yt,dr);if(ar.length===0)continue;ar.sort((hr,Pe)=>hr.std-Pe.std);const cr=Math.floor(ar.length/2);rt.push(ar[cr])}return rt},Y={R:[],G1:[],G2:[],B:[]};return te.forEach(Ae=>{Y[Ae.channel]&&Y[Ae.channel].push(Ae)}),{R:be(Y.R),G1:be(Y.G1),G2:be(Y.G2),B:be(Y.B)}},[qt]),Ut=C.useMemo(()=>oe&&Ve.gain?oe*Ve.gain:null,[oe,Ve.gain]),Se=C.useMemo(()=>{if(oe===null||oe===0)return null;const te=parseFloat(D);let me=null;if(!isNaN(te)&&te>0){let rt=0,Lt=0;if(["R","G1","G2","B"].forEach(dt=>{const yt=It(te,Ht[dt]);yt!==null&&(rt+=yt,Lt++)}),Lt>0){const dt=rt/Lt;me=Math.log2(oe/dt)}}const be=parseFloat(F);let Y=null,Ae=NaN;if(!isNaN(be)&&be>0){Ae=16e3/be;let rt=0,Lt=0;if(["R","G1","G2","B"].forEach(dt=>{const yt=It(Ae,Ht[dt]);yt!==null&&(rt+=yt,Lt++)}),Lt>0){const dt=rt/Lt;Y=Math.log2(oe/dt)}}let at=null;if(!isNaN(be)&&be>0){const rt=It(Ae,Ht[fr]);rt!==null&&(at=Math.log2(oe/rt))}return{manualDR:me,ptpDR:Y,d55DR:at,manualTarget:te,ptpTarget:Ae,saturationSignal:oe,dominantChannel:fr}},[oe,D,F,Ht,It,fr]),ln=C.useMemo(()=>{if(f==="Linear"||!Se||!Se.ptpTarget||isNaN(Se.ptpTarget))return[];const te=Se.ptpTarget,me=A?parseFloat(A):ht,be=E?parseFloat(E):Vt;return f==="SNR"?[{x:me,y:te},{x:be,y:te}]:[{x:me,y:me/te},{x:be,y:be/te}]},[f,Se,A,E,ht,Vt]),L=C.useCallback(()=>{const be=document.createElement("canvas");be.width=2048,be.height=1536;const Y=be.getContext("2d");if(!Y)return;const Ae=s==="dark",at=Ae?"#0f172a":"#ffffff",rt=Ae?"#ffffff":"#000000",Lt=Ae?"#475569":"#cbd5e1",dt=Ae?"#1e293b":"#f1f5f9",yt=i?{R:"#ef4444",G1:"#22c55e",G2:"#4ade80",B:"#3b82f6"}:{R:"#ef4444",G1:"#22c55e",G2:"#4ade80",B:"#3b82f6"};Y.fillStyle=at,Y.fillRect(0,0,2048,1536);let dr=A?parseFloat(A):ht,ar=E?parseFloat(E):Vt,cr=B?parseFloat(B):$t,hr=V?parseFloat(V):mr;isNaN(dr)&&(dr=.1),isNaN(ar)&&(ar=1e4),isNaN(cr)&&(cr=.1),isNaN(hr)&&(hr=1e3);const Pe={top:80,right:80,bottom:100,left:120},ut=2048-Pe.left-Pe.right,Qe=1536-Pe.top-Pe.bottom,Je=Ie=>{if(p){const Mt=Math.log10(Math.max(1e-9,dr)),St=Math.log10(Math.max(1e-9,ar)),xt=Math.log10(Math.max(1e-9,Ie));return Pe.left+(xt-Mt)/(St-Mt)*ut}else return Pe.left+(Ie-dr)/(ar-dr)*ut},Xt=Ie=>{if(p){const Mt=Math.log10(Math.max(1e-9,cr)),St=Math.log10(Math.max(1e-9,hr)),xt=Math.log10(Math.max(1e-9,Ie));return Pe.top+Qe-(xt-Mt)/(St-Mt)*Qe}else return Pe.top+Qe-(Ie-cr)/(hr-cr)*Qe};if(Y.beginPath(),p){const Ie=(Mt,St,xt)=>{const qr=Math.log10(Math.max(1e-9,Mt)),Kt=Math.log10(Math.max(1e-9,St)),ea=Math.floor(qr),Za=Math.ceil(Kt);for(let Di=ea;Di<=Za;Di++){const Qa=Math.pow(10,Di);let Yr=xt?Je(Qa):Xt(Qa);(xt?Yr>=Pe.left-1&&Yr<=Pe.left+ut+1:Yr>=Pe.top-1&&Yr<=Pe.top+Qe+1)&&(Y.lineWidth=1.5,Y.strokeStyle=Lt,Y.beginPath(),xt?(Y.moveTo(Yr,Pe.top),Y.lineTo(Yr,Pe.top+Qe)):(Y.moveTo(Pe.left,Yr),Y.lineTo(Pe.left+ut,Yr)),Y.stroke()),Y.lineWidth=.5,Y.strokeStyle=dt;for(let js=2;js<10;js++){const jl=js*Qa;Yr=xt?Je(jl):Xt(jl),(xt?Yr>=Pe.left&&Yr<=Pe.left+ut:Yr>=Pe.top&&Yr<=Pe.top+Qe)&&(Y.beginPath(),xt?(Y.moveTo(Yr,Pe.top),Y.lineTo(Yr,Pe.top+Qe)):(Y.moveTo(Pe.left,Yr),Y.lineTo(Pe.left+ut,Yr)),Y.stroke())}}};Ie(dr,ar,!0),Ie(cr,hr,!1)}else{Y.strokeStyle=Lt,Y.lineWidth=1;for(let Ie=0;Ie<=5;Ie++){const Mt=Pe.left+ut*Ie/5;Y.beginPath(),Y.moveTo(Mt,Pe.top),Y.lineTo(Mt,Pe.top+Qe),Y.stroke();const St=Pe.top+Qe*Ie/5;Y.beginPath(),Y.moveTo(Pe.left,St),Y.lineTo(Pe.left+ut,St),Y.stroke()}}Y.strokeStyle=rt,Y.lineWidth=2,Y.strokeRect(Pe.left,Pe.top,ut,Qe);const lt=(Ie,Mt,St)=>{Ie<Pe.left||Ie>Pe.left+ut||Mt<Pe.top||Mt>Pe.top+Qe||(Y.fillStyle=St,Y.fillRect(Ie-1.5,Mt-1.5,3,3))},zt=Et.filter(Ie=>!(p&&(Ie.x<=0||Ie.y<=0)));zt.forEach(Ie=>{j[Ie.channel]&&Ie.channel!==fr&&lt(Je(Ie.x),Xt(Ie.y),yt[Ie.channel])}),zt.forEach(Ie=>{j[Ie.channel]&&Ie.channel===fr&&lt(Je(Ie.x),Xt(Ie.y),yt[Ie.channel])}),le.forEach(Ie=>{const Mt=Je(Ie.x),St=Xt(Ie.y);if(Mt<Pe.left||Mt>Pe.left+ut||St<Pe.top||St>Pe.top+Qe)return;Y.strokeStyle="#d946ef",Y.lineWidth=2.5;const xt=6;Y.beginPath(),Y.moveTo(Mt-xt,St-xt),Y.lineTo(Mt+xt,St+xt),Y.moveTo(Mt+xt,St-xt),Y.lineTo(Mt-xt,St+xt),Y.stroke()});const Nr=(Ie,Mt,St=[])=>{if(Ie.length<2)return;Y.beginPath(),Y.strokeStyle=Mt,Y.lineWidth=3,Y.setLineDash(St);let xt=!1;for(const qr of Ie){const Kt=Je(qr.x),ea=Xt(qr.y);if(Kt<Pe.left-100||Kt>Pe.left+ut+100||ea<Pe.top-100||ea>Pe.top+Qe+100){xt=!1;continue}xt?Y.lineTo(Kt,ea):(Y.moveTo(Kt,ea),xt=!0)}Y.stroke(),Y.setLineDash([])},Dr=Ae?"#ffffff":"#000000";if(Ct.shot&&Nr(He.shot,"#94a3b8",[5,5]),Ct.read&&Nr(He.read,"#f43f5e",[3,3]),Ct.prnu&&Nr(He.prnu,"#f59e0b",[3,3]),Ct.total&&Nr(He.total,Dr,[]),pt.length===2){const Ie="#6366f1";Nr(pt,Ie,[4,2]);const Mt=pt[1],St=Xt(Mt.y);St>=Pe.top&&St<=Pe.top+Qe&&(Y.fillStyle=Ie,Y.font="bold 20px sans-serif",Y.textAlign="right",Y.textBaseline="bottom",Y.fillText(`M.Tgt=${D}`,Pe.left+ut-10,St-8))}if(ln.length===2&&(Se!=null&&Se.ptpTarget)){const Ie="#10b981";Nr(ln,Ie,[4,4]);const Mt=ln[1],St=Xt(Mt.y);if(St>=Pe.top&&St<=Pe.top+Qe){Y.fillStyle=Ie,Y.font="bold 20px sans-serif",Y.textAlign="right",Y.textBaseline="bottom";const xt=Se.ptpTarget.toFixed(1),qr=pt.length===2?Xt(pt[1].y):-100,Kt=Math.abs(St-qr)<25?25:0;Y.fillText(`PTP=${xt}`,Pe.left+ut-10,St-8-Kt)}}if(Ct.fitRange||ae){const Ie=(Mt,St)=>{const xt=Je(Mt);xt>=Pe.left&&xt<=Pe.left+ut&&(Y.beginPath(),Y.strokeStyle=St,Y.lineWidth=2,Y.setLineDash([8,8]),Y.moveTo(xt,Pe.top),Y.lineTo(xt,Pe.top+Qe),Y.stroke(),Y.setLineDash([]))};Ie($r,"#22d3ee"),Ie(nr,"#22d3ee")}if(oe){const Ie=Je(oe);Ie>=Pe.left&&Ie<=Pe.left+ut&&(Y.strokeStyle="#ef4444",Y.lineWidth=3,Y.setLineDash([10,10]),Y.beginPath(),Y.moveTo(Ie,Pe.top),Y.lineTo(Ie,Pe.top+Qe),Y.stroke(),Y.setLineDash([]),Y.fillStyle="#ef4444",Y.font="bold 24px sans-serif",Y.textAlign="center",Y.fillText("Sat",Ie,Pe.top-10))}Y.fillStyle=rt,Y.font="28px monospace",Y.textAlign="center",Y.fillText(dr.toExponential(1),Pe.left,Pe.top+Qe+40),Y.fillText(ar.toExponential(1),Pe.left+ut,Pe.top+Qe+40),Y.fillText("Signal (DN)",Pe.left+ut/2,Pe.top+Qe+80),Y.textAlign="right",Y.textBaseline="middle",Y.fillText(cr.toExponential(1),Pe.left-20,Pe.top+Qe),Y.fillText(hr.toExponential(1),Pe.left-20,Pe.top),Y.save(),Y.translate(Pe.left-80,Pe.top+Qe/2),Y.rotate(-Math.PI/2),Y.textAlign="center",Y.fillText(f==="Linear"?"(Var - RN) / Mean":f,0,0),Y.restore(),Y.save(),Y.translate(2048/2,1536/2),Y.rotate(-Math.PI/6),Y.textAlign="center",Y.textBaseline="middle",Y.fillStyle=Ae?"rgba(255, 255, 255, 0.1)":"rgba(0, 0, 0, 0.1)",Y.font="bold 150px sans-serif",Y.fillText(" y-g-jiang.github.io",0,0),Y.restore(),Y.fillStyle=rt,Y.font="bold 36px sans-serif",Y.textAlign="left",Y.textBaseline="top",Y.fillText(`PTC Export: ${f} Mode`,Pe.left,20),Y.font="24px sans-serif",Y.fillStyle=Ae?"#94a3b8":"#64748b",Y.fillText(`Points: ${Et.length} | Sat Channel: ${fr}`,Pe.left,65);const ma=Pe.left+30,mi=Pe.top+30,Oo=70,yi=Ie=>{if(!oe||Ie<=0)return"--";const Mt=Ve.readNoise,St=Ve.gain,xt=Ve.prnu/100;if(St<=0)return"--";const qr=Ie*Ie,Kt=Mt*Mt,ea=1-qr*xt*xt,Za=-(qr/St),Di=-(qr*Kt);let Qa=0;if(Math.abs(ea)<1e-8)Math.abs(Za)>1e-8&&(Qa=-Di/Za);else{const Yr=Za*Za-4*ea*Di;Yr>=0&&(Qa=(-Za+Math.sqrt(Yr))/(2*ea))}return Qa>0?Math.log2(oe/Qa).toFixed(2)+" EV":"--"},Ya=Se!=null&&Se.ptpTarget&&!isNaN(Se.ptpTarget)?yi(Se.ptpTarget):"--",Ia=D?yi(parseFloat(D)):"--";Y.font="bold 48px monospace",Y.textAlign="left",Y.textBaseline="top",Y.shadowColor=Ae?"rgba(0,0,0,0.8)":"rgba(255,255,255,0.8)",Y.shadowBlur=4,Y.shadowOffsetX=1,Y.shadowOffsetY=1;const Dn=(Ie,Mt,St,xt)=>{const qr=mi+St*Oo;Y.fillStyle=rt,Y.fillText(Ie,ma,qr);const Kt=Y.measureText(Ie).width;Y.fillStyle=xt||rt,Y.fillText(Mt,ma+Kt,qr)},Ss=Ft.read,Ri=parseFloat(Ft.gain).toFixed(3),ie=parseFloat(Ft.prnu).toFixed(2)+"%";let _e=`M.DR@SNR${D}: `;const kt=parseFloat(F);if(!isNaN(kt)&&kt>0){const Ie=(2309.4/kt).toFixed(2);Math.abs(parseFloat(D)-parseFloat(Ie))<.05&&(_e="8mpSNR=1 DR: ")}Dn("Tester: ",We||"N/A",0),Dn("Model : ",tt||"Unknown",1),Dn("ISO   : ",wt||"N/A",2),Dn("RN/FPN: ",Ss,3,"#f43f5e"),Dn("KADC  : ",Ri,4,"#06b6d4"),Dn("PRNU  : ",ie,5,"#f59e0b"),Dn("PTP DR: ",Se!=null&&Se.ptpDR?Se.ptpDR.toFixed(2)+" EV":"--",6,"#10b981"),Dn("D55 DR: ",Se!=null&&Se.d55DR?Se.d55DR.toFixed(2)+" EV":"--",7,"#8b5cf6"),Dn("FWC   : ",Ut?Ut>1e4?(Ut/1e3).toFixed(1)+"k":Math.round(Ut).toString():"--",8,"#f97316"),Dn(_e,Se!=null&&Se.manualDR?Se.manualDR.toFixed(2)+" EV":"--",9,"#06b6d4"),Dn("PTCFitDR(PTP): ",Ya,10,"#10b981"),Dn("PTCFitDR(Man): ",Ia,11,"#06b6d4"),Y.save(),Y.textAlign="right",Y.textBaseline="bottom",Y.fillStyle="#3b82f6",Y.font="bold 80px sans-serif",Y.shadowColor=Ae?"rgba(0,0,0,0.8)":"rgba(255,255,255,0.8)",Y.shadowBlur=4,Y.shadowOffsetX=2,Y.shadowOffsetY=2;const vt=1988,Ir=1476,_n=90;Y.fillText("Online",vt,Ir),Y.fillText("Jiangtherapee",vt,Ir-_n),Y.restore();const br=document.createElement("a");br.download=`ptc_complete_${f}_${Date.now()}.jpg`,br.href=be.toDataURL("image/jpeg",.9),br.click()},[Et,fr,j,A,E,B,V,ht,Vt,$t,mr,p,s,f,oe,i,Ct,He,$r,nr,Tt,ae,We,tt,wt,Se,Ut,D,pt,ln,Ft,F,le]),we=C.useMemo(()=>{let te=Et;if(p&&(te=te.filter(Ae=>Ae.y>0&&Ae.x>0)),k==="top3"){const Ae=[...te].sort((rt,Lt)=>Lt.x-rt.x),at=Math.max(50,Math.ceil(Ae.length*.03));te=Ae.slice(0,at)}const me={R:[],G1:[],G2:[],B:[]};if(te.forEach(Ae=>{me[Ae.channel]&&me[Ae.channel].push(Ae)}),k==="raw")return me;const be=k==="top3"?500:qre,Y=Ae=>{if(Ae.length<=be)return Ae;const at=[...Ae].sort((dt,yt)=>dt.x-yt.x),rt=[],Lt=at.length/be;for(let dt=0;dt<be;dt++){const yt=Math.floor(dt*Lt),dr=Math.floor((dt+1)*Lt),ar=at.slice(yt,dr);if(ar.length===0)continue;ar.sort((hr,Pe)=>hr.y-Pe.y);const cr=Math.floor(ar.length/2);rt.push(ar[cr])}return rt};return{R:Y(me.R),G1:Y(me.G1),G2:Y(me.G2),B:Y(me.B)}},[Et,k,p]),Ne=C.useMemo(()=>{if(qt.length<5)return[];const te=qt.filter(be=>be.channel===fr);return[...te.length>20?te:qt].sort((be,Y)=>be.x-Y.x).map(be=>({mean:be.x,std:be.std}))},[qt,fr]),gt=te=>{const me=te.length;if(me===0)return[];const be=te.reduce((ut,Qe)=>ut+Qe,0)/me,Y=te.reduce((ut,Qe)=>ut+Math.pow(Qe-be,2),0)/(me-1||1),Ae=Math.sqrt(Y);if(Ae===0)return[{x:be-.001,density:0},{x:be,density:1},{x:be+.001,density:0}];const at=1.06*Ae*Math.pow(me,-.2),rt=Math.min(...te),Lt=Math.max(...te),dt=(Lt-rt)*.2||rt*.1,yt=Math.max(0,rt-dt),dr=Lt+dt,ar=100,cr=(dr-yt)/(ar-1),hr=ut=>1/Math.sqrt(2*Math.PI)*Math.exp(-.5*ut*ut),Pe=[];for(let ut=0;ut<ar;ut++){const Qe=yt+ut*cr;let Je=0;for(let Xt=0;Xt<me;Xt++)Je+=hr((Qe-te[Xt])/at);Je/=me*at,Pe.push({x:Qe,density:Je})}return Pe},Xe=C.useCallback((te,me,be,Y)=>{if(te.length<5)return{gain:0,prnu:0};const Ae=te[te.length-1].mean,at=Ae*(be.min/100),rt=Ae*(be.max/100),Lt=te.filter(zt=>zt.mean>=at&&zt.mean<=rt);if(Lt.length<5)return{gain:0,prnu:0};Vr({nPoints:Lt.length});const dt=me*me,yt=[],dr=[];if(Lt.forEach(zt=>{const Dr=zt.std*zt.std-dt;if(zt.mean>1&&Dr>0){const ma=zt.mean,mi=Dr/zt.mean;yt.push({x:ma,y:mi}),dr.push(zt.mean/Dr)}}),yt.length<5)return{gain:0,prnu:0};const ar=[],cr=yt.length,hr=Y,Pe=cr*(cr-1)/2;if(Pe<=hr)for(let zt=0;zt<cr;zt++)for(let Nr=zt+1;Nr<cr;Nr++){const Dr=yt[Nr].x-yt[zt].x;Math.abs(Dr)>1e-5&&ar.push((yt[Nr].y-yt[zt].y)/Dr)}else{const zt=Math.max(1,Math.floor(Pe/hr));for(let Nr=0;Nr<cr;Nr++)for(let Dr=Nr+1;Dr<cr;Dr+=zt){const ma=yt[Dr].x-yt[Nr].x;Math.abs(ma)>1e-5&&ar.push((yt[Dr].y-yt[Nr].y)/ma)}}const ut=qm(ar),Qe=yt.map(zt=>zt.y-ut*zt.x),Je=qm(Qe);let Xt=0,lt=0;if(Je>1e-6?Xt=1/Je:Xt=qm(dr),ut>0&&(lt=Math.sqrt(ut)*100),dr.length>0){const zt=gt(dr);sn(zt),Tr(Xt)}else sn([]);return{gain:Xt,prnu:lt}},[]),ot=C.useCallback(te=>{let me=te.read??tr.current.readNoise;const be=te.gRange??rr.current,Y=Hr.current;if((te.read!==void 0||te.gRange!==void 0)&&te.gain===void 0&&te.prnu===void 0&&Ne.length>0&&me>=0)S(!0),setTimeout(()=>{const at=Xe(Ne,me,be,Y);let rt=tr.current.gain,Lt=tr.current.prnu;at.gain>0&&(rt=at.gain,Lt=at.prnu),Pt({readNoise:me,gain:rt,prnu:Lt}),te.gRange!==void 0&&Sr(te.gRange),bn(dt=>{var yt,dr;return{...dt,read:me.toString(),gain:rt>0?rt.toFixed(3):"0",prnu:Lt.toFixed(2),rangeMin:(((yt=te.gRange)==null?void 0:yt.min)??dt.rangeMin).toString(),rangeMax:(((dr=te.gRange)==null?void 0:dr.max)??dt.rangeMax).toString()}}),S(!1)},50);else{let at=te.gain!==void 0?te.gain:tr.current.gain,rt=te.prnu!==void 0?te.prnu:tr.current.prnu;Pt({readNoise:me,gain:at,prnu:rt}),te.gRange!==void 0&&Sr(te.gRange),bn(Lt=>{var dt,yt;return{...Lt,read:me.toString(),gain:at>0?at.toFixed(3):"0",prnu:rt.toFixed(2),rangeMin:(((dt=te.gRange)==null?void 0:dt.min)??Lt.rangeMin).toString(),rangeMax:(((yt=te.gRange)==null?void 0:yt.max)??Lt.rangeMax).toString()}})}},[Ne,Xe]),ct=`${q}-${r.length}`;C.useEffect(()=>{if(!e||!r||r.length===0)return;const te=we[fr];if(!te||te.length===0||Cr===ct)return;M({R:fr==="R",G1:fr==="G1",G2:fr==="G2",B:fr==="B"});const me=[...te].sort((at,rt)=>at.x-rt.x);let be=0;me.length>0&&(be=me[0].std);const Y=qt.filter(at=>at.channel===fr);let Ae=-1/0;for(const at of Y)at.x>Ae&&(Ae=at.x);Ae!==-1/0&&ye(Ae),ot({read:be}),Er(ct)},[e,r,Cr,ct,we,fr,ot,qt]);const Yt=(te,me)=>{bn(be=>({...be,[te]:me}))},xr=te=>{let me=parseFloat(Ft[te]);isNaN(me)||me<0||ot({[te]:me})},hn=()=>{re(W),Er("")},Gt=()=>{const te=parseFloat(Ft.rangeMin),me=parseFloat(Ft.rangeMax);!isNaN(te)&&!isNaN(me)&&te<me&&te>=0&&me<=100&&ot({gRange:{min:te,max:me}})},Sn=(te,me)=>{te.key==="Enter"&&(me==="rangeMin"||me==="rangeMax"?Gt():xr(me),te.target.blur())};C.useEffect(()=>{e&&Ne.length>0&&ot({})},[e,Bt,Ne]);const jn=te=>{M(me=>({...me,[te]:!me[te]}))},Zn=()=>{x(te=>te==="top3"?"default":"top3")},or=()=>{k==="raw"?x("default"):w(!0)},sr=()=>{w(!1),x("raw")},yr=(te,me)=>{const be=parseFloat(te),Y=parseFloat(me);let Ae=isNaN(be)?"auto":be,at=isNaN(Y)?"auto":Y;return p&&typeof Ae=="number"&&Ae<=0&&(Ae="auto"),[Ae,at]},Be=te=>{if(!te||!te.payload)return;const me=te.payload;if(b(me),_t.current&&(ye(me.x),fe(!1)),Jt.current){const be=rr.current.min,Y=rr.current.max,{max:Ae}=O();if(Ae<=0)return;const at=Math.max(0,Math.min(100,me.x/Ae*100));if(Nt.current===1){const rt=Math.min(at,Y-.5);ot({gRange:{min:rt,max:Y}}),he(2)}else if(Nt.current===2){const rt=Math.max(at,be+.5);ot({gRange:{min:be,max:rt}}),he(0),X(!1)}}},Zt=C.useCallback(te=>{const{cx:me,cy:be,fill:Y}=te;return c.jsx("circle",{cx:me,cy:be,r:3,fill:Y,stroke:"none",style:{cursor:"pointer"}})},[]),jr=({active:te,payload:me})=>{if(te&&me&&me.length){const be=me[0].payload;return c.jsxs("div",{className:"bg-slate-800 text-white text-xs p-2 rounded border border-slate-600 shadow-xl opacity-90 font-mono z-50",children:[c.jsx("div",{className:"font-bold border-b border-slate-600 pb-1 mb-1",children:be.channel}),c.jsxs("div",{children:["Signal: ",be.x.toFixed(2)]}),c.jsxs("div",{children:[f,": ",be.y.toFixed(4)]}),be.row!==void 0&&be.col!==void 0&&!isNaN(be.row)&&!isNaN(be.col)&&c.jsxs("div",{className:"text-cyan-400 mt-0.5",children:["Loc: Row ",be.row,", Col ",be.col]}),be.filename&&c.jsx("div",{className:"text-gray-400 mt-1 max-w-[200px] truncate",title:be.filename,children:be.filename})]})}return null},Qn=te=>{d(te),te==="Linear"&&m(!1)};if(!e)return null;const Jn=s==="dark"?"#ffffff":"#000000";let Kr=f;f==="Linear"&&(Kr="(Var - RN) / Mean");const qa=W!==q;return c.jsx("div",{className:"fixed inset-0 z-[60] flex items-center justify-center bg-black/60 backdrop-blur-sm p-4 animate-in fade-in",onClick:te=>{te.stopPropagation()},children:c.jsxs("div",{className:"bg-white dark:bg-slate-900 w-[98vw] max-w-[2200px] h-[95vh] rounded-2xl shadow-2xl flex flex-col border border-gray-200 dark:border-slate-700 overflow-hidden relative",onClick:te=>te.stopPropagation(),children:[c.jsx(os,{isOpen:y,onClose:()=>w(!1),onConfirm:sr,title:"Warning: High Performance Cost",message:"Displaying all data points may cause the browser to freeze or become unresponsive, especially with large datasets. Are you sure you want to continue?",confirmText:"Yes, Show All"}),v&&c.jsxs("div",{className:"absolute top-20 right-8 z-30 bg-white/90 dark:bg-slate-800/90 border border-cyan-500 rounded-xl p-4 shadow-xl backdrop-blur-md max-w-xs animate-in fade-in zoom-in-95 duration-200",children:[c.jsxs("div",{className:"flex justify-between items-start mb-2 border-b border-gray-200 dark:border-slate-700 pb-2",children:[c.jsx("h4",{className:"font-bold text-gray-900 dark:text-white text-sm",children:"Selected Point"}),c.jsx("button",{onClick:()=>b(null),className:"text-gray-400 hover:text-gray-600 dark:hover:text-slate-200",children:c.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),c.jsx("div",{className:"space-y-1 text-xs font-mono text-gray-700 dark:text-slate-300",children:c.jsxs("div",{className:"grid grid-cols-2 gap-x-4 gap-y-1.5",children:[c.jsx("span",{className:"text-gray-500 dark:text-slate-500",children:"Channel:"}),c.jsx("span",{className:"font-bold",children:v.channel}),c.jsx("span",{className:"text-gray-500 dark:text-slate-500",children:"Signal (DN):"}),c.jsx("span",{children:v.x.toFixed(4)}),c.jsx("span",{className:"text-gray-500 dark:text-slate-500",children:"Noise (Std):"}),c.jsx("span",{children:v.std.toFixed(4)}),c.jsx("span",{className:"text-gray-500 dark:text-slate-500",children:"SNR:"}),c.jsx("span",{className:"text-purple-600 dark:text-purple-400 font-bold",children:(v.x/v.std).toFixed(2)})]})})]}),Ge&&c.jsx("div",{className:"absolute inset-0 z-40 bg-white/95 dark:bg-slate-900/95 backdrop-blur-sm flex flex-col items-center justify-center p-8 animate-in fade-in zoom-in-95 duration-200",children:c.jsxs("div",{className:"w-full max-w-2xl h-[60vh] bg-gray-50 dark:bg-slate-800 rounded-xl border border-gray-200 dark:border-slate-700 shadow-2xl p-4 flex flex-col relative",children:[c.jsx("button",{onClick:()=>rn(!1),className:"absolute top-4 right-4 text-gray-400 hover:text-red-500 transition-colors",children:c.jsx("svg",{className:"w-6 h-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})}),c.jsxs("div",{className:"mb-4 text-center",children:[c.jsx("h3",{className:"text-lg font-bold text-gray-800 dark:text-slate-200",children:"Gain Density Estimation"}),c.jsxs("p",{className:"text-xs text-gray-500 dark:text-slate-400",children:["HSM Mode: ",c.jsx("span",{className:"text-cyan-600 dark:text-cyan-400 font-bold",children:Xr==null?void 0:Xr.toFixed(4)}),c.jsx("span",{className:"mx-2",children:"|"}),"Data Points: ",Ar.length>0?"Density Curve Generated":"No Data"]})]}),c.jsx("div",{className:"flex-1 min-h-0",children:Ar.length>0?c.jsx(Ui,{width:"100%",height:"100%",children:c.jsxs(TN,{data:Ar,margin:{top:10,right:30,left:0,bottom:20},children:[c.jsx(Ni,{strokeDasharray:"3 3",stroke:"#374151",opacity:.3,vertical:!1}),c.jsx(ka,{dataKey:"x",tickFormatter:te=>te.toFixed(2),tick:{fill:"#9ca3af",fontSize:10},label:{value:"Gain (e/ADU)",position:"insideBottom",offset:-15,fill:"#9ca3af",fontSize:12}}),c.jsx(Sa,{tick:{fill:"#9ca3af",fontSize:10}}),c.jsx(Un,{cursor:{stroke:"rgba(255,255,255,0.2)"},contentStyle:{backgroundColor:"#1f2937",border:"1px solid #374151",borderRadius:"0.5rem",color:"#f3f4f6"}}),c.jsx(li,{type:"monotone",dataKey:"density",stroke:"#0ea5e9",fill:"#0ea5e9",fillOpacity:.3,strokeWidth:2}),Xr!==null&&c.jsx(Yo,{x:Xr,stroke:"#ef4444",strokeWidth:2,label:{value:"HSM",fill:"#ef4444",fontSize:10,position:"top"}})]})}):c.jsx("div",{className:"flex items-center justify-center h-full text-gray-400",children:"No data in selected range"})})]})}),c.jsxs("div",{className:"flex flex-wrap justify-between items-center p-3 border-b border-gray-200 dark:border-slate-700 bg-gray-50 dark:bg-slate-800/50 gap-4 flex-shrink-0",children:[c.jsxs("h2",{className:"text-lg font-bold text-gray-900 dark:text-slate-100 flex items-center gap-2",children:["Photon Transfer Curve",c.jsxs("span",{className:"text-xs font-normal bg-purple-100 dark:bg-purple-900/30 text-purple-600 dark:text-purple-300 px-2 py-0.5 rounded border border-purple-200 dark:border-purple-800",children:[r.length," Pts"]})]}),c.jsxs("div",{className:"flex gap-4 items-center flex-wrap",children:[c.jsxs("button",{onClick:L,className:"bg-green-600 hover:bg-green-500 text-white font-bold py-1 px-3 rounded text-xs shadow-md transition-all active:scale-95 flex items-center gap-1",title:"Render all points, target lines, and metadata to a high-res JPG",children:[c.jsx("svg",{className:"w-3 h-3",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"})}),"Export Complete Result"]}),c.jsxs("div",{className:"flex bg-white dark:bg-slate-700 rounded-lg p-1 border border-gray-200 dark:border-slate-600",children:[c.jsx("button",{onClick:()=>Qn("Noise"),className:`px-3 py-1 text-xs font-bold rounded transition-colors ${f==="Noise"?"bg-cyan-600 text-white shadow":"text-gray-600 dark:text-slate-300 hover:bg-gray-100 dark:hover:bg-slate-600"}`,children:"Noise ()"}),c.jsx("button",{onClick:()=>Qn("SNR"),className:`px-3 py-1 text-xs font-bold rounded transition-colors ${f==="SNR"?"bg-purple-600 text-white shadow":"text-gray-600 dark:text-slate-300 hover:bg-gray-100 dark:hover:bg-slate-600"}`,children:"SNR"}),c.jsx("button",{onClick:()=>Qn("Linear"),className:`px-3 py-1 text-xs font-bold rounded transition-colors ${f==="Linear"?"bg-indigo-600 text-white shadow":"text-gray-600 dark:text-slate-300 hover:bg-gray-100 dark:hover:bg-slate-600"}`,children:"Linear (PTC)"})]}),c.jsxs("label",{className:"flex items-center gap-2 text-xs text-gray-600 dark:text-slate-300 cursor-pointer select-none",children:[c.jsx("input",{type:"checkbox",checked:p,onChange:te=>m(te.target.checked),className:"rounded border-gray-300 text-cyan-600 focus:ring-cyan-500 bg-gray-100 dark:bg-slate-700 dark:border-slate-600"}),"Log-Log"]}),c.jsx("button",{onClick:t,className:"text-gray-400 hover:text-red-500 transition-colors p-1",children:c.jsx("svg",{className:"w-6 h-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]})]}),c.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-12 gap-0 border-b border-gray-200 dark:border-slate-700 bg-white dark:bg-slate-900 text-sm flex-shrink-0",children:[c.jsxs("div",{className:"lg:col-span-9 p-5 flex flex-col gap-5 border-r border-gray-200 dark:border-slate-700",children:[c.jsxs("div",{className:"flex flex-wrap gap-4 items-center justify-between text-xs",children:[c.jsxs("div",{className:"flex gap-4 items-center",children:[c.jsxs("div",{className:"flex items-center gap-1.5 bg-gray-50 dark:bg-slate-800 rounded-md p-1 border border-gray-200 dark:border-slate-700",children:[c.jsx("span",{className:"font-bold text-gray-500 dark:text-slate-400 pl-1",children:"X:"}),c.jsx("input",{type:"number",placeholder:"Min",value:A,onChange:te=>$(te.target.value),className:"w-12 px-1 py-0.5 bg-white dark:bg-slate-900 border border-gray-300 dark:border-slate-600 rounded text-center outline-none"}),c.jsx("span",{className:"text-gray-400",children:"-"}),c.jsx("input",{type:"number",placeholder:"Max",value:E,onChange:te=>T(te.target.value),className:"w-12 px-1 py-0.5 bg-white dark:bg-slate-900 border border-gray-300 dark:border-slate-600 rounded text-center outline-none"})]}),c.jsxs("div",{className:"flex items-center gap-1.5 bg-gray-50 dark:bg-slate-800 rounded-md p-1 border border-gray-200 dark:border-slate-700",children:[c.jsx("span",{className:"font-bold text-gray-500 dark:text-slate-400 pl-1",children:"Y:"}),c.jsx("input",{type:"number",placeholder:"Min",value:B,onChange:te=>U(te.target.value),className:"w-12 px-1 py-0.5 bg-white dark:bg-slate-900 border border-gray-300 dark:border-slate-600 rounded text-center outline-none"}),c.jsx("span",{className:"text-gray-400",children:"-"}),c.jsx("input",{type:"number",placeholder:"Max",value:V,onChange:te=>G(te.target.value),className:"w-12 px-1 py-0.5 bg-white dark:bg-slate-900 border border-gray-300 dark:border-slate-600 rounded text-center outline-none"})]}),c.jsx("button",{onClick:()=>{$(""),T(""),U(""),G("")},className:"text-xs text-cyan-600 dark:text-cyan-400 hover:underline",children:"Auto"})]}),c.jsxs("div",{className:"flex items-center gap-1 bg-white dark:bg-slate-700 p-1 rounded-lg border border-gray-200 dark:border-slate-600",children:[c.jsx("button",{onClick:()=>jn("R"),className:`w-6 h-6 text-[10px] font-bold rounded flex items-center justify-center transition-colors ${j.R?"bg-red-500 text-white":"bg-gray-100 dark:bg-slate-600 text-gray-400"}`,children:"R"}),c.jsx("button",{onClick:()=>jn("G1"),className:`w-6 h-6 text-[10px] font-bold rounded flex items-center justify-center transition-colors ${j.G1?"bg-green-500 text-white":"bg-gray-100 dark:bg-slate-600 text-gray-400"}`,children:"G1"}),c.jsx("button",{onClick:()=>jn("G2"),className:`w-6 h-6 text-[10px] font-bold rounded flex items-center justify-center transition-colors ${j.G2?"bg-green-400 text-white":"bg-gray-100 dark:bg-slate-600 text-gray-400"}`,children:"G2"}),c.jsx("button",{onClick:()=>jn("B"),className:`w-6 h-6 text-[10px] font-bold rounded flex items-center justify-center transition-colors ${j.B?"bg-blue-500 text-white":"bg-gray-100 dark:bg-slate-600 text-gray-400"}`,children:"B"})]})]}),c.jsxs("div",{className:"flex flex-wrap items-end gap-8",children:[c.jsxs("div",{className:"flex flex-col bg-gray-50 dark:bg-slate-800/50 p-2 rounded border border-gray-100 dark:border-slate-700",children:[c.jsx("span",{className:"text-[9px] uppercase font-bold text-gray-500 dark:text-slate-400 mb-1",children:"Black Level (0,0 0,1 1,0 1,1)"}),c.jsx("input",{type:"text",value:W,onChange:te=>Q(te.target.value),className:"w-32 text-xs px-2 py-1 bg-white dark:bg-slate-900 border border-gray-300 dark:border-slate-600 rounded outline-none focus:border-cyan-500 font-mono",placeholder:"0 0 0 0"})]}),c.jsxs("div",{className:"flex flex-col justify-between bg-gray-50 dark:bg-slate-800/50 p-2 rounded border border-gray-100 dark:border-slate-700",children:[c.jsxs("div",{className:"flex justify-between items-center mb-1",children:[c.jsx("span",{className:"text-[9px] uppercase font-bold text-gray-500 dark:text-slate-400 mr-2",children:"Fit Range % (Robust)"}),c.jsx("button",{onClick:()=>{X(!ae),he(ae?0:1)},className:`px-1.5 py-0.5 text-[9px] rounded border transition-colors ${ae?"bg-cyan-100 text-cyan-700 border-cyan-300 animate-pulse":"bg-white dark:bg-slate-700 border-gray-300 dark:border-slate-600 text-gray-600 dark:text-slate-300 hover:bg-gray-50"}`,children:ae?se===1?"Pick Min":"Pick Max":"Select"})]}),c.jsxs("div",{className:"flex items-center gap-1 text-xs",children:[c.jsx("input",{type:"number",step:"0.1",value:Ft.rangeMin,onChange:te=>Yt("rangeMin",te.target.value),onBlur:Gt,onKeyDown:te=>Sn(te,"rangeMin"),className:"w-10 bg-white dark:bg-slate-900 border border-gray-300 dark:border-slate-600 rounded px-1 py-0.5 text-center font-bold"}),c.jsx("span",{className:"text-gray-400",children:"-"}),c.jsx("input",{type:"number",step:"0.1",value:Ft.rangeMax,onChange:te=>Yt("rangeMax",te.target.value),onBlur:Gt,onKeyDown:te=>Sn(te,"rangeMax"),className:"w-10 bg-white dark:bg-slate-900 border border-gray-300 dark:border-slate-600 rounded px-1 py-0.5 text-center font-bold"})]})]}),c.jsxs("div",{className:"flex flex-col bg-indigo-50 dark:bg-indigo-900/20 p-2 rounded border border-indigo-100 dark:border-indigo-800/50",children:[c.jsx("span",{className:"text-[9px] uppercase font-bold text-indigo-600 dark:text-indigo-400 mb-1",children:"DR Params"}),c.jsxs("div",{className:"flex items-center gap-3",children:[c.jsxs("div",{className:"flex items-center gap-1",children:[c.jsx("span",{className:"text-[10px] font-bold text-indigo-500 dark:text-indigo-300",children:"Img H:"}),c.jsx("input",{type:"number",value:F,onChange:te=>H(te.target.value),onKeyDown:kn,placeholder:"Empty",className:"w-14 px-1 py-0.5 bg-white dark:bg-slate-900 border border-indigo-200 dark:border-indigo-800 rounded text-center font-bold text-indigo-700 dark:text-indigo-300 text-xs placeholder:font-normal placeholder:text-gray-300"})]}),c.jsxs("div",{className:"flex items-center gap-1",children:[c.jsx("span",{className:"text-[10px] font-bold text-indigo-500 dark:text-indigo-300",children:"Tgt SNR:"}),c.jsx("input",{type:"number",value:D,onChange:te=>I(te.target.value),className:"w-10 px-1 py-0.5 bg-white dark:bg-slate-900 border border-indigo-200 dark:border-indigo-800 rounded text-center font-bold text-indigo-700 dark:text-indigo-300 text-xs"})]})]})]}),c.jsxs("div",{className:"flex flex-col gap-1 text-[10px] justify-end pb-0.5",children:[c.jsx("button",{onClick:()=>{fe(!ee),oe&&ye(null)},disabled:ae,className:`font-bold rounded border shadow-sm transition-all px-3 py-1.5 ${ee?"bg-amber-100 dark:bg-amber-900/30 text-amber-700 dark:text-amber-400 border-amber-500 animate-pulse":"bg-white dark:bg-slate-800 text-gray-600 dark:text-slate-300 border-gray-300 dark:border-slate-600 hover:bg-gray-50 dark:hover:bg-slate-700"}`,children:ee?"Pick Point":"Select Linear Limit"}),c.jsxs("div",{className:"flex gap-1",children:[c.jsx("button",{onClick:Zn,className:`flex-1 font-bold rounded border shadow-sm transition-all px-2 py-1 ${k==="top3"?"bg-indigo-600 text-white border-indigo-700":"bg-white dark:bg-slate-800 text-gray-600 dark:text-slate-300 border-gray-300 dark:border-slate-600 hover:bg-gray-50"}`,children:"Top 3%"}),c.jsx("button",{onClick:or,className:`font-bold rounded border shadow-sm transition-all px-2 py-1 ${k==="raw"?"bg-red-600 text-white border-red-700":"text-red-500 border-red-200 hover:bg-red-50"}`,children:"All"})]})]})]}),c.jsxs("div",{className:"flex flex-wrap gap-4 items-center bg-gray-50/50 dark:bg-slate-800/20 p-2 rounded-lg border border-gray-100 dark:border-slate-800",children:[c.jsx("span",{className:"text-[10px] uppercase font-bold text-gray-400 dark:text-slate-500",children:"Metadata"}),c.jsxs("div",{className:"flex gap-2",children:[c.jsx("input",{type:"text",value:We,onChange:te=>Le(te.target.value),placeholder:"Tester Name",className:"w-24 text-xs bg-white dark:bg-slate-900 border border-gray-300 dark:border-slate-600 rounded px-2 py-1 text-gray-700 dark:text-slate-300 outline-none focus:border-cyan-500 transition-colors"}),c.jsx("input",{type:"text",value:tt,onChange:te=>mt(te.target.value),placeholder:"Camera Model",className:"w-32 text-xs bg-white dark:bg-slate-900 border border-gray-300 dark:border-slate-600 rounded px-2 py-1 text-gray-700 dark:text-slate-300 outline-none focus:border-cyan-500 transition-colors"}),c.jsx("input",{type:"text",value:wt,onChange:te=>Qt(te.target.value),placeholder:"ISO",className:"w-16 text-xs bg-white dark:bg-slate-900 border border-gray-300 dark:border-slate-600 rounded px-2 py-1 text-gray-700 dark:text-slate-300 outline-none focus:border-cyan-500 transition-colors"})]})]}),c.jsxs("div",{className:"flex flex-wrap gap-4 items-center bg-fuchsia-50/50 dark:bg-fuchsia-900/10 p-2 rounded-lg border border-fuchsia-100 dark:border-fuchsia-900/30",children:[c.jsx("span",{className:"text-[10px] uppercase font-bold text-fuchsia-500 dark:text-fuchsia-400",children:"Markers"}),c.jsxs("div",{className:"flex gap-2 items-center",children:[c.jsx("input",{type:"number",value:ke,onChange:te=>ve(te.target.value),placeholder:"X (Signal)",className:"w-20 text-xs bg-white dark:bg-slate-900 border border-gray-300 dark:border-slate-600 rounded px-2 py-1 outline-none focus:border-fuchsia-500 transition-colors"}),c.jsx("input",{type:"number",value:ge,onChange:te=>Me(te.target.value),placeholder:"Y (Value)",className:"w-20 text-xs bg-white dark:bg-slate-900 border border-gray-300 dark:border-slate-600 rounded px-2 py-1 outline-none focus:border-fuchsia-500 transition-colors"}),c.jsx("button",{onClick:Oe,className:"px-3 py-1 bg-fuchsia-600 hover:bg-fuchsia-500 text-white text-xs font-bold rounded shadow-sm transition-colors active:scale-95",children:"+"}),le.length>0&&c.jsx("button",{onClick:()=>je([]),className:"px-2 py-1 bg-gray-200 dark:bg-slate-700 hover:bg-red-500 hover:text-white text-gray-600 dark:text-slate-300 text-xs font-bold rounded shadow-sm transition-colors active:scale-95",children:"Clr"})]}),c.jsxs("div",{className:"text-[10px] text-gray-400 dark:text-slate-500 font-mono",children:[le.length," pts"]})]}),c.jsxs("div",{className:"flex gap-4 text-[10px] pt-1 justify-center sm:justify-start flex-wrap",children:[c.jsxs("label",{className:"flex items-center gap-1 cursor-pointer select-none",children:[c.jsx("input",{type:"checkbox",checked:Ct.shot,onChange:te=>tn({...Ct,shot:te.target.checked}),className:"rounded text-gray-500"})," ",c.jsx("span",{className:"text-gray-500",children:"Shot Noise"})]}),c.jsxs("label",{className:"flex items-center gap-1 cursor-pointer select-none",children:[c.jsx("input",{type:"checkbox",checked:Ct.read,onChange:te=>tn({...Ct,read:te.target.checked}),className:"rounded text-rose-500"})," ",c.jsx("span",{className:"text-rose-500",children:"Read Noise"})]}),c.jsxs("label",{className:"flex items-center gap-1 cursor-pointer select-none",children:[c.jsx("input",{type:"checkbox",checked:Ct.prnu,onChange:te=>tn({...Ct,prnu:te.target.checked}),className:"rounded text-amber-500"})," ",c.jsx("span",{className:"text-amber-500",children:"PRNU"})]}),c.jsxs("label",{className:"flex items-center gap-1 cursor-pointer select-none",children:[c.jsx("input",{type:"checkbox",checked:Ct.total,onChange:te=>tn({...Ct,total:te.target.checked}),className:"rounded text-white"})," ",c.jsx("span",{className:"text-gray-900 dark:text-white font-bold",children:"Model"})]})]})]}),c.jsxs("div",{className:"lg:col-span-3 bg-slate-100 dark:bg-slate-800 p-4 flex flex-col justify-center gap-4",children:[c.jsxs("div",{children:[c.jsxs("div",{className:"flex justify-between items-center mb-1 px-1",children:[c.jsxs("h3",{className:"text-xs font-bold text-gray-500 dark:text-slate-400 uppercase flex items-center gap-2",children:["Fit Parameters (D55 SAT Channel:",fr,")",_&&c.jsx("span",{className:"text-orange-500 animate-pulse text-[10px]",children:"Calculating..."})]}),c.jsxs("div",{className:"flex gap-2 items-center",children:[c.jsx("button",{onClick:hn,disabled:_,className:`px-3 py-1 text-white text-[10px] font-bold rounded shadow-sm transition-all flex items-center gap-1 active:scale-95 
                                            ${_?"bg-gray-400 cursor-wait":qa?"bg-orange-500 hover:bg-orange-600 animate-pulse ring-2 ring-orange-400/50":"bg-cyan-600 hover:bg-cyan-500"}
                                        `,title:"Apply Black Level, Auto-detect Read Noise, then Recalculate Fit",children:_?c.jsxs(c.Fragment,{children:[c.jsxs("svg",{className:"w-3 h-3 animate-spin",viewBox:"0 0 24 24",fill:"none",children:[c.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),c.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4z"})]}),"Fitting..."]}):c.jsxs(c.Fragment,{children:[c.jsxs("svg",{className:"w-3 h-3",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:[c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M14.752 11.168l-3.197-2.132A1 1 0 0010 9.87v4.263a1 1 0 001.555.832l3.197-2.132a1 1 0 000-1.664z"}),c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})]}),"Apply & Calc"]})}),c.jsxs("select",{value:Bt,onChange:te=>Dt(Number(te.target.value)),className:"text-[9px] bg-slate-200 dark:bg-slate-700 text-gray-600 dark:text-slate-300 rounded px-1 py-0.5 border-none outline-none cursor-pointer hover:bg-slate-300 dark:hover:bg-slate-600 transition-colors",title:"Number of point-pairs to sample for robust regression (Theil-Sen)",children:[c.jsx("option",{value:1e5,children:"100k Pairs"}),c.jsx("option",{value:5e5,children:"500k Pairs"}),c.jsx("option",{value:2e6,children:"2M Pairs"}),c.jsx("option",{value:5e6,children:"5M Pairs"}),c.jsx("option",{value:1e7,children:"10M Pairs"})]}),er&&c.jsxs("span",{className:"text-[10px] text-gray-400 dark:text-slate-500 font-mono",title:"Number of points used in regression",children:["N=",er.nPoints]})]})]}),c.jsxs("div",{className:"grid grid-cols-3 gap-2",children:[c.jsxs("div",{className:"flex flex-col items-center",children:[c.jsx("label",{className:"text-[10px] text-gray-500 dark:text-slate-400 uppercase tracking-wide mb-1",children:"rn/fpn"}),c.jsx("input",{type:"text",inputMode:"decimal",value:Ft.read,onChange:te=>Yt("read",te.target.value),onBlur:()=>xr("read"),onKeyDown:te=>Sn(te,"read"),className:"w-full text-center text-2xl font-light bg-transparent text-rose-500 outline-none border-b border-transparent focus:border-rose-500 transition-colors"})]}),c.jsxs("div",{className:"flex flex-col items-center relative group",children:[c.jsxs("label",{className:"text-[10px] text-gray-500 dark:text-slate-400 uppercase tracking-wide mb-1 flex items-center gap-1",children:["Kadc (HSM)",c.jsx("button",{onClick:()=>rn(!0),className:"text-[9px] text-cyan-600 dark:text-cyan-400 hover:underline",children:"Dist."})]}),c.jsx("input",{type:"text",inputMode:"decimal",value:Ft.gain,onChange:te=>Yt("gain",te.target.value),onBlur:()=>xr("gain"),onKeyDown:te=>Sn(te,"gain"),className:"w-full text-center text-2xl font-light bg-transparent text-slate-700 dark:text-slate-200 outline-none border-b border-transparent focus:border-cyan-500 transition-colors"})]}),c.jsxs("div",{className:"flex flex-col items-center",children:[c.jsx("label",{className:"text-[10px] text-gray-500 dark:text-slate-400 uppercase tracking-wide mb-1",children:"PRNU (%)"}),c.jsx("input",{type:"text",inputMode:"decimal",value:Ft.prnu,onChange:te=>Yt("prnu",te.target.value),onBlur:()=>xr("prnu"),onKeyDown:te=>Sn(te,"prnu"),className:"w-full text-center text-2xl font-light bg-transparent text-amber-500 outline-none border-b border-transparent focus:border-amber-500 transition-colors"})]})]})]}),c.jsx("div",{className:"h-px bg-gray-200 dark:bg-slate-700 w-full"}),c.jsxs("div",{className:"grid grid-cols-2 gap-2 text-center",children:[c.jsxs("div",{className:"flex flex-col justify-center bg-cyan-50 dark:bg-cyan-900/10 p-2 rounded-lg border border-cyan-100 dark:border-cyan-900/30",children:[c.jsxs("h4",{className:"text-[10px] font-bold text-cyan-600 dark:text-cyan-500 uppercase tracking-wide mb-1 truncate",title:`Manual DR at SNR=${(Se==null?void 0:Se.manualTarget)||D}`,children:["M.DR @ SNR=",(Se==null?void 0:Se.manualTarget)||D]}),c.jsx("div",{className:"text-base font-bold text-cyan-700 dark:text-cyan-400 whitespace-nowrap",children:Se!=null&&Se.manualDR?`${Se.manualDR.toFixed(2)} EV`:"--"})]}),c.jsxs("div",{className:"flex flex-col justify-center bg-emerald-50 dark:bg-emerald-900/10 p-2 rounded-lg border border-emerald-100 dark:border-emerald-900/30",title:isNaN((Se==null?void 0:Se.ptpTarget)||NaN)?"Requires Image Height":`Standard Point-to-Point DR (Target SNR = 16000/${F||"H"})`,children:[c.jsx("h4",{className:"text-[10px] font-bold text-emerald-600 dark:text-emerald-500 uppercase tracking-wide mb-1",children:"PTP DR"}),c.jsx("div",{className:"text-base font-bold text-emerald-700 dark:text-emerald-400 whitespace-nowrap",children:Se!=null&&Se.ptpDR?`${Se.ptpDR.toFixed(2)} EV`:"--"})]}),c.jsxs("div",{className:"flex flex-col justify-center bg-purple-50 dark:bg-purple-900/10 p-2 rounded-lg border border-purple-100 dark:border-purple-900/30",title:isNaN((Se==null?void 0:Se.ptpTarget)||NaN)?"Requires Image Height":`D55 Saturation DR (Target SNR = 16000/${F||"H"} on ${Se==null?void 0:Se.dominantChannel} Channel)`,children:[c.jsxs("h4",{className:"text-[10px] font-bold text-purple-600 dark:text-purple-400 uppercase tracking-wide mb-1 truncate",children:["D55 DR (",Se==null?void 0:Se.dominantChannel,")"]}),c.jsx("div",{className:"text-base font-bold text-purple-700 dark:text-purple-400 whitespace-nowrap",children:Se!=null&&Se.d55DR?`${Se.d55DR.toFixed(2)} EV`:"--"})]}),c.jsxs("div",{className:"flex flex-col justify-center bg-orange-50 dark:bg-orange-900/10 p-2 rounded-lg border border-orange-100 dark:border-orange-900/30",children:[c.jsx("h4",{className:"text-[10px] font-bold text-orange-600 dark:text-orange-400 uppercase tracking-wide mb-1",children:"FWC"}),c.jsx("div",{className:"text-base font-bold text-orange-600 dark:text-orange-400 font-mono whitespace-nowrap truncate",title:Ut!==null?`${Math.round(Ut)}`:"",children:Ut!==null?Ut>1e4?`${(Ut/1e3).toFixed(1)}k`:`${Math.round(Ut)}`:"--"})]})]}),oe===null&&c.jsx("div",{className:"text-center text-[10px] text-red-500 animate-pulse font-bold mt-[-10px]",children:"Please select Linear Limit on chart to calc DR"})]})]}),c.jsxs("div",{className:`flex-1 p-4 bg-white dark:bg-slate-900 relative grid grid-cols-[auto_1fr] grid-rows-[1fr_auto] gap-2 ${ee||ae?"cursor-crosshair":""}`,children:[c.jsx("div",{className:"row-start-1 col-start-1 h-full",children:c.jsx(y3,{vertical:!0,min:$t,max:mr,value:[B?parseFloat(B):$t,V?parseFloat(V):mr],onChange:([te,me])=>{U(te.toString()),G(me.toString())},logScale:p})}),c.jsxs("div",{className:"row-start-1 col-start-2 relative",children:[Et.length===0?c.jsx("div",{className:"flex h-full items-center justify-center text-gray-400",children:"No valid data points found."}):c.jsx(Ui,{width:"100%",height:"100%",children:c.jsxs(Ire,{margin:{top:20,right:20,bottom:0,left:0},onClick:Be,children:[c.jsx("defs",{children:c.jsxs("filter",{id:"glow",height:"300%",width:"300%",x:"-100%",y:"-100%",children:[c.jsx("feGaussianBlur",{stdDeviation:"2",result:"coloredBlur"}),c.jsxs("feMerge",{children:[c.jsx("feMergeNode",{in:"coloredBlur"}),c.jsx("feMergeNode",{in:"SourceGraphic"})]})]})}),c.jsx(Ni,{strokeDasharray:"3 3",stroke:"#374151",opacity:.2}),c.jsx(ka,{type:"number",dataKey:"x",name:"Signal",scale:p?"log":"linear",domain:yr(A,E),allowDataOverflow:!0,hide:!0}),c.jsx(Sa,{type:"number",dataKey:"y",name:f,scale:p?"log":"linear",domain:yr(B,V),label:{value:Kr,angle:-90,position:"insideLeft",fill:"#9ca3af",fontSize:12},tick:{fill:"#9ca3af",fontSize:10},allowDataOverflow:!0}),c.jsx(Un,{content:c.jsx(jr,{}),cursor:{strokeDasharray:"3 3"}}),oe&&c.jsx(Yo,{x:oe,stroke:"red",strokeDasharray:"3 3",label:{position:"top",value:"Sat",fill:"red",fontSize:10}}),(Ct.fitRange||ae)&&c.jsxs(c.Fragment,{children:[c.jsx(Yo,{x:$r,stroke:"#22d3ee",strokeDasharray:"5 5",label:{position:"insideTopLeft",value:`Min: ${Tt.min}%`,fill:"#22d3ee",fontSize:9}}),c.jsx(Yo,{x:nr,stroke:"#22d3ee",strokeDasharray:"5 5",label:{position:"insideTopLeft",value:`Max: ${Tt.max}%`,fill:"#22d3ee",fontSize:9}})]}),j.R&&c.jsx(xa,{name:"Red",data:we.R,fill:"#ef4444",shape:Zt,onClick:Be,style:s==="dark"?{filter:"url(#glow)"}:void 0},"scatter-R"),j.G1&&c.jsx(xa,{name:"Green 1",data:we.G1,fill:"#22c55e",shape:Zt,onClick:Be,style:s==="dark"?{filter:"url(#glow)"}:void 0},"scatter-G1"),j.G2&&c.jsx(xa,{name:"Green 2",data:we.G2,fill:"#4ade80",shape:Zt,onClick:Be,style:s==="dark"?{filter:"url(#glow)"}:void 0},"scatter-G2"),j.B&&c.jsx(xa,{name:"Blue",data:we.B,fill:"#3b82f6",shape:Zt,onClick:Be,style:s==="dark"?{filter:"url(#glow)"}:void 0},"scatter-B"),Ct.shot&&He.shot.length>0&&c.jsx(xa,{name:"Shot Noise (Ideal)",data:He.shot,line:{stroke:"#94a3b8",strokeWidth:1,strokeDasharray:"5 5"},shape:()=>c.jsx(c.Fragment,{}),legendType:"none",isAnimationActive:!1},"line-shot"),Ct.read&&He.read.length>0&&c.jsx(xa,{name:"Read Noise Floor",data:He.read,line:{stroke:"#f43f5e",strokeWidth:1,strokeDasharray:"3 3"},shape:()=>c.jsx(c.Fragment,{}),legendType:"none",isAnimationActive:!1},"line-read"),Ct.prnu&&He.prnu.length>0&&c.jsx(xa,{name:"PRNU (Non-uniformity)",data:He.prnu,line:{stroke:"#f59e0b",strokeWidth:1,strokeDasharray:"3 3"},shape:()=>c.jsx(c.Fragment,{}),legendType:"none",isAnimationActive:!1},"line-prnu"),Ct.total&&He.total.length>0&&c.jsx(xa,{name:"Total Noise Model",data:He.total,line:{stroke:Jn,strokeWidth:2},shape:()=>c.jsx(c.Fragment,{}),legendType:"none",isAnimationActive:!1},"line-total"),pt.length>0&&c.jsx(xa,{name:`Target SNR=${D}`,data:pt,line:{stroke:"#6366f1",strokeWidth:2,strokeDasharray:"4 2"},shape:()=>c.jsx(c.Fragment,{}),legendType:"none",isAnimationActive:!1},"line-target"),ln.length>0&&c.jsx(xa,{name:`PTP Target SNR=${Se!=null&&Se.ptpTarget?Se.ptpTarget.toFixed(1):"?"}`,data:ln,line:{stroke:"#10b981",strokeWidth:2,strokeDasharray:"4 4"},shape:()=>c.jsx(c.Fragment,{}),legendType:"none",isAnimationActive:!1},"line-ptp"),le.length>0&&c.jsx(xa,{name:"Manual Markers",data:le,fill:"#d946ef",shape:"star",legendType:"star"},"manual-points")]})}),c.jsx("div",{className:"absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 pointer-events-none select-none opacity-25 mix-blend-normal dark:mix-blend-plus-lighter",children:c.jsx("svg",{viewBox:"0 0 500 60",className:"w-96 h-auto",children:c.jsx("text",{x:"50%",y:"50%",dominantBaseline:"middle",textAnchor:"middle",className:"fill-gray-900 dark:fill-white",fontSize:"36",fontWeight:"bold",style:{fontFamily:"sans-serif",letterSpacing:"0.05em"},children:" y-g-jiang.github.io"})})})]}),c.jsx("div",{className:"row-start-2 col-start-2 w-full",children:c.jsx(y3,{min:ht,max:Vt,value:[A?parseFloat(A):ht,E?parseFloat(E):Vt],onChange:([te,me])=>{$(te.toString()),T(me.toString())},logScale:p})})]})]})})},Zre=({searchTerm:e,onSearchChange:t,manufacturers:r,selectedManufacturer:n,onManufacturerChange:a,cameras:i,onCameraSelect:o})=>c.jsx("div",{className:"sticky top-4 z-10 bg-white/80 dark:bg-slate-900/80 backdrop-blur-sm p-4 rounded-xl border border-gray-200 dark:border-slate-700 shadow-sm",children:c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-5 gap-4",children:[c.jsxs("div",{className:"relative md:col-span-3",children:[c.jsx("input",{type:"text",placeholder:"Search camera model...",value:e,onChange:s=>t(s.target.value),className:"w-full pl-10 pr-4 py-2 bg-gray-50 dark:bg-slate-800 border border-gray-300 dark:border-slate-600 rounded-lg focus:ring-2 focus:ring-cyan-500 focus:border-cyan-500 outline-none transition-all duration-300 text-gray-900 dark:text-slate-200 placeholder-gray-500 dark:placeholder-slate-400"}),c.jsx("svg",{className:"w-5 h-5 text-gray-400 dark:text-slate-400 absolute top-1/2 left-3 transform -translate-y-1/2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})})]}),c.jsx("select",{value:n,onChange:s=>a(s.target.value),className:"w-full md:col-span-1 bg-gray-50 dark:bg-slate-800 border border-gray-300 dark:border-slate-600 rounded-lg px-4 py-2 focus:ring-2 focus:ring-cyan-500 focus:border-cyan-500 outline-none transition-all duration-300 appearance-none text-gray-900 dark:text-slate-200",children:r.map(s=>c.jsx("option",{value:s,children:s},s))}),c.jsxs("select",{onChange:s=>o(s.target.value),className:"w-full md:col-span-1 bg-gray-50 dark:bg-slate-800 border border-gray-300 dark:border-slate-600 rounded-lg px-4 py-2 focus:ring-2 focus:ring-cyan-500 focus:border-cyan-500 outline-none transition-all duration-300 appearance-none text-gray-900 dark:text-slate-200",value:"","aria-label":"Jump to camera model",children:[c.jsx("option",{value:"",disabled:!0,children:"Jump to model..."}),i.map(s=>c.jsx("option",{value:s.id,children:s.name},s.id))]})]})}),Qre=({active:e,payload:t,label:r,theme:n})=>{if(e&&t&&t.length){const a=t[0].payload,i=n==="dark"?"bg-slate-800/80 border-slate-600 text-slate-300":"bg-white/90 border-gray-200 text-gray-700";return c.jsxs("div",{className:`${i} backdrop-blur-sm border p-3 rounded-lg shadow-lg`,children:[c.jsx("p",{className:"label font-bold",children:`ISO ${r}`}),c.jsx("div",{className:"mt-2 space-y-1 text-sm",children:c.jsxs(c.Fragment,{children:[c.jsxs("div",{style:{color:"#f87171"},children:["Red: ",a.R_avg.toFixed(2)," (Range: ",a.R_range[0]," - ",a.R_range[1],")"]}),c.jsxs("div",{style:{color:"#4ade80"},children:["Green 1: ",a.G1_avg.toFixed(2)," (Range: ",a.G1_range[0]," - ",a.G1_range[1],")"]}),c.jsxs("div",{style:{color:"#60a5fa"},children:["Blue: ",a.B_avg.toFixed(2)," (Range: ",a.B_range[0]," - ",a.B_range[1],")"]}),c.jsxs("div",{style:{color:"#86efac"},children:["Green 2: ",a.G2_avg.toFixed(2)," (Range: ",a.G2_range[0]," - ",a.G2_range[1],")"]})]})})]})}return null},Jre=({data:e,theme:t="dark"})=>{const r=C.useMemo(()=>!e||e.length===0?[]:[...new Set(e.map(o=>o.iso))].sort((o,s)=>Number(o)-Number(s)),[e]),n=C.useMemo(()=>{if(!e||e.length===0)return[0,4096];const o=e.flatMap(v=>[...v.R_range,...v.G1_range,...v.G2_range,...v.B_range]);if(o.length===0)return[0,4096];let s=Math.min(...o),l=Math.max(...o);const u=.25,f=l-s;if(f<u){const v=u-f;s-=v/2,l+=v/2}const d=(l-s)*.1,p=s-d,m=l+d;return[p,m]},[e]),a=t==="dark"?"#475569":"#e5e7eb",i=t==="dark"?"#94a3b8":"#6b7280";return!e||e.length===0?c.jsx("div",{className:"flex items-center justify-center h-full text-gray-500 dark:text-slate-500",children:c.jsx("p",{children:"No data available for this mode."})}):c.jsx(Ui,{width:"100%",height:"100%",children:c.jsxs(TN,{data:e,margin:{top:5,right:20,left:0,bottom:5},children:[c.jsx(Ni,{strokeDasharray:"3 3",stroke:a}),c.jsx(ka,{dataKey:"iso",type:"number",domain:["dataMin","dataMax"],tick:{fill:i,fontSize:12},scale:"log",allowDuplicatedCategory:!1,ticks:r}),c.jsx(Sa,{tick:{fill:i,fontSize:12},domain:n,allowDecimals:!0,tickFormatter:o=>Number(o).toFixed(3)}),c.jsx(Un,{content:c.jsx(Qre,{theme:t})}),c.jsx(Xi,{wrapperStyle:{fontSize:"14px",color:i}}),c.jsx(li,{type:"monotone",dataKey:"R_range",fill:"#f87171",stroke:"none",fillOpacity:.2,name:"Red",legendType:"none"}),c.jsx(xn,{type:"monotone",dataKey:"R_avg",stroke:"#f87171",strokeWidth:2,dot:!1,activeDot:{r:5},name:"Red"}),c.jsx(li,{type:"monotone",dataKey:"G1_range",fill:"#4ade80",stroke:"none",fillOpacity:.2,name:"Green 1",legendType:"none"}),c.jsx(xn,{type:"monotone",dataKey:"G1_avg",stroke:"#4ade80",strokeWidth:2,dot:!1,activeDot:{r:5},name:"Green 1"}),c.jsx(li,{type:"monotone",dataKey:"B_range",fill:"#60a5fa",stroke:"none",fillOpacity:.2,name:"Blue",legendType:"none"}),c.jsx(xn,{type:"monotone",dataKey:"B_avg",stroke:"#60a5fa",strokeWidth:2,dot:!1,activeDot:{r:5},name:"Blue"}),c.jsx(li,{type:"monotone",dataKey:"G2_range",fill:"#86efac",stroke:"none",fillOpacity:.2,name:"Green 2",legendType:"none"}),c.jsx(xn,{type:"monotone",dataKey:"G2_avg",stroke:"#86efac",strokeWidth:2,dot:!1,activeDot:{r:5},name:"Green 2"})]})})},ene=J.forwardRef(({camera:e,theme:t="dark"},r)=>{const n=C.useMemo(()=>e.shootingModes.map(d=>d.modeName),[e.shootingModes]),[a,i]=C.useState(n[0]||""),{chartData:o,tableData:s}=C.useMemo(()=>{const d=e.shootingModes.find(v=>v.modeName===a);if(!(d!=null&&d.data))return{chartData:[],tableData:[]};const p=d.data.map(v=>({iso:v.iso,R_range:v.r.range,R_avg:v.r.avg,G1_range:v.g1.range,G1_avg:v.g1.avg,B_range:v.b.range,B_avg:v.b.avg,G2_range:v.g2.range,G2_avg:v.g2.avg})),m=d.data.map(v=>({iso:v.iso,levels:[v.r.avg,v.g1.avg,v.g2.avg,v.b.avg],clipping:v.clipping}));return{chartData:p,tableData:m}},[e.shootingModes,a]),l=`Raw Data (${a})`,u=C.useRef(null),f=C.useRef(null);return C.useEffect(()=>{const d=u.current,p=f.current;if(!d||!p)return;const m=new ResizeObserver(v=>{for(let b of v){const{width:k}=b.contentRect,y=Math.max(8,k/35);p.style.fontSize=`${y}px`}});return m.observe(d),()=>m.disconnect()},[]),c.jsxs("div",{ref:r,className:"bg-white dark:bg-slate-800/50 border border-gray-200 dark:border-slate-700 rounded-xl shadow-lg p-6 flex flex-col gap-6 transform hover:scale-[1.02] hover:border-cyan-500/50 transition-all duration-500 ease-in-out",children:[c.jsxs("div",{className:"border-b border-gray-200 dark:border-slate-700 pb-4",children:[c.jsx("h2",{className:"text-2xl font-bold text-gray-900 dark:text-slate-100",children:e.name}),c.jsx("p",{className:"text-cyan-600 dark:text-cyan-400",children:e.manufacturer})]}),c.jsxs("div",{children:[c.jsxs("div",{className:"flex flex-col sm:flex-row justify-between sm:items-center gap-4 mb-4",children:[c.jsx("h3",{className:"text-lg font-semibold text-gray-800 dark:text-slate-300",children:"Black Level vs. ISO"}),c.jsx("select",{value:a,onChange:d=>i(d.target.value),className:"w-full sm:w-auto bg-gray-50 dark:bg-slate-700 border border-gray-300 dark:border-slate-600 rounded-md px-3 py-1 text-sm outline-none focus:ring-2 focus:ring-cyan-500 transition-all duration-300 text-gray-900 dark:text-slate-200","aria-label":`Select shooting mode for ${e.name}`,children:n.map(d=>c.jsx("option",{value:d,children:d},d))})]}),c.jsxs("div",{ref:u,className:"h-64 relative",children:[c.jsx(Jre,{data:o,theme:t},a),c.jsx("div",{className:"absolute top-1/2 left-[52%] transform -translate-x-1/2 -translate-y-1/2 -rotate-30 pointer-events-none",children:c.jsx("p",{ref:f,className:"font-bold text-gray-900/10 dark:text-slate-200/40 whitespace-nowrap",children:" y-g-jiang.github.io"})})]})]}),c.jsxs("div",{className:"overflow-x-auto",children:[c.jsx("div",{className:"flex justify-between items-center mb-4",children:c.jsx("h3",{className:"text-lg font-semibold text-gray-800 dark:text-slate-300",children:l})}),c.jsxs("table",{className:"w-full text-left border-collapse",children:[c.jsx("thead",{className:"bg-gray-100 dark:bg-slate-700/50",children:c.jsxs("tr",{children:[c.jsx("th",{className:"p-3 font-semibold text-sm text-gray-700 dark:text-slate-300",children:"ISO"}),c.jsx("th",{className:"p-3 font-semibold text-sm text-red-500 dark:text-red-400",children:"Red"}),c.jsx("th",{className:"p-3 font-semibold text-sm text-green-600 dark:text-green-400",children:"Green 1"}),c.jsx("th",{className:"p-3 font-semibold text-sm text-blue-500 dark:text-blue-400",children:"Blue"}),c.jsx("th",{className:"p-3 font-semibold text-sm text-green-500 dark:text-green-300",children:"Green 2"})]})}),c.jsx("tbody",{children:s.map(({iso:d,levels:p,clipping:m})=>c.jsxs("tr",{className:"border-b border-gray-200 dark:border-slate-700/50 last:border-b-0",children:[c.jsxs("td",{className:"p-3 font-mono text-gray-700 dark:text-slate-300 whitespace-nowrap",children:[d,m&&c.jsx("span",{className:"ml-3 text-xs font-semibold text-amber-600 dark:text-amber-400 bg-amber-100 dark:bg-amber-900/50 px-2 py-1 rounded-full align-middle",children:"Clipping"})]}),c.jsx("td",{className:"p-3 font-mono text-red-500 dark:text-red-400",children:p[0].toFixed(2)}),c.jsx("td",{className:"p-3 font-mono text-green-600 dark:text-green-400",children:p[1].toFixed(2)}),c.jsx("td",{className:"p-3 font-mono text-blue-500 dark:text-blue-400",children:p[3].toFixed(2)}),c.jsx("td",{className:"p-3 font-mono text-green-500 dark:text-green-300",children:p[2].toFixed(2)})]},d))})]})]})]})}),Ue=(e,t,r)=>({avg:e,range:[t,r]}),Ym=[{id:"sony-a7r2",name:"Sony ILCE-7RM2 (A7R II)",manufacturer:"Sony",shootingModes:[{modeName:"Still (Mechanical Shutter)",data:[{iso:100,r:Ue(512.1,511.95,512.25),g1:Ue(512.05,511.9,512.2),b:Ue(512.12,511.98,512.28),g2:Ue(512.06,511.92,512.22)},{iso:200,r:Ue(512.15,512,512.3),g1:Ue(512.1,511.95,512.25),b:Ue(512.18,512.05,512.35),g2:Ue(512.12,511.98,512.28)},{iso:400,r:Ue(512.25,512.1,512.45),g1:Ue(512.2,512.05,512.4),b:Ue(512.3,512.15,512.5),g2:Ue(512.22,512.08,512.42)},{iso:800,r:Ue(512.5,512.2,512.8),g1:Ue(512.45,512.15,512.75),b:Ue(512.55,512.25,512.85),g2:Ue(512.48,512.18,512.78)},{iso:1600,r:Ue(513.1,512.8,513.4),g1:Ue(513.05,512.75,513.35),b:Ue(513.15,512.85,513.45),g2:Ue(513.08,512.78,513.38)}]}]},{id:"sony-a7c",name:"Sony ILCE-7C",manufacturer:"Sony",shootingModes:[{modeName:"Still (Mechanical)",data:[{iso:100,r:Ue(512.02,511.98,512.05),g1:Ue(512.01,511.97,512.04),b:Ue(512.03,511.99,512.06),g2:Ue(512.01,511.97,512.04)},{iso:640,r:Ue(512.15,512.05,512.25),g1:Ue(512.12,512.02,512.22),b:Ue(512.18,512.08,512.28),g2:Ue(512.13,512.03,512.23)}]}]},{id:"canon-r5",name:"Canon EOS R5",manufacturer:"Canon",shootingModes:[{modeName:"Mechanical Shutter",data:[{iso:100,r:Ue(512,511.8,512.2),g1:Ue(512,511.8,512.2),b:Ue(512,511.8,512.2),g2:Ue(512,511.8,512.2)},{iso:400,r:Ue(512,511.7,512.3),g1:Ue(512,511.7,512.3),b:Ue(512,511.7,512.3),g2:Ue(512,511.7,512.3)},{iso:1600,r:Ue(512.2,511.5,512.8),g1:Ue(512.2,511.5,512.8),b:Ue(512.2,511.5,512.8),g2:Ue(512.2,511.5,512.8)}]}]},{id:"canon-r6",name:"Canon EOS R6",manufacturer:"Canon",shootingModes:[{modeName:"Mechanical Shutter",data:[{iso:100,r:Ue(511.95,511.8,512.1),g1:Ue(511.95,511.8,512.1),b:Ue(511.95,511.8,512.1),g2:Ue(511.95,511.8,512.1)},{iso:800,r:Ue(512.1,511.9,512.3),g1:Ue(512.1,511.9,512.3),b:Ue(512.1,511.9,512.3),g2:Ue(512.1,511.9,512.3)}]}]},{id:"nikon-z9",name:"Nikon Z9",manufacturer:"Nikon",shootingModes:[{modeName:"Electronic Shutter",data:[{iso:64,r:Ue(400,399.9,400.1),g1:Ue(400,399.9,400.1),b:Ue(400,399.9,400.1),g2:Ue(400,399.9,400.1)},{iso:100,r:Ue(400,399.9,400.1),g1:Ue(400,399.9,400.1),b:Ue(400,399.9,400.1),g2:Ue(400,399.9,400.1)}]}]},{id:"nikon-z6-2",name:"Nikon Z 6II",manufacturer:"Nikon",shootingModes:[{modeName:"Still (Lossless)",data:[{iso:100,r:Ue(400.1,399.8,400.3),g1:Ue(400.1,399.8,400.3),b:Ue(400.1,399.8,400.3),g2:Ue(400.1,399.8,400.3)},{iso:800,r:Ue(400.3,399.5,401.1),g1:Ue(400.3,399.5,401.1),b:Ue(400.3,399.5,401.1),g2:Ue(400.3,399.5,401.1)}]}]},{id:"fujifilm-xt4",name:"Fujifilm X-T4",manufacturer:"Fujifilm",shootingModes:[{modeName:"Still (RAF)",data:[{iso:160,r:Ue(1024,1023.8,1024.2),g1:Ue(1024,1023.8,1024.2),b:Ue(1024,1023.8,1024.2),g2:Ue(1024,1023.8,1024.2)},{iso:800,r:Ue(1024.2,1023.5,1025),g1:Ue(1024.2,1023.5,1025),b:Ue(1024.2,1023.5,1025),g2:Ue(1024.2,1023.5,1025)}]}]}],tne=({isOpen:e,onClose:t,theme:r})=>{const[n,a]=C.useState(""),[i,o]=C.useState("All"),s=C.useMemo(()=>["All",...Array.from(new Set(Ym.map(d=>d.manufacturer))).sort()],[]),l=C.useMemo(()=>Ym.filter(f=>{const d=f.name.toLowerCase().includes(n.toLowerCase()),p=i==="All"||f.manufacturer===i;return d&&p}),[n,i]),u=f=>{const d=document.getElementById(`camera-${f}`);d&&d.scrollIntoView({behavior:"smooth"})};return e?c.jsx("div",{className:"fixed inset-0 z-[100] flex items-center justify-center bg-black/60 backdrop-blur-sm p-4 animate-in fade-in duration-200",onClick:t,children:c.jsxs("div",{className:"bg-white dark:bg-slate-900 w-full max-w-6xl h-[90vh] rounded-2xl shadow-2xl flex flex-col border border-gray-200 dark:border-slate-700 overflow-hidden",onClick:f=>f.stopPropagation(),children:[c.jsxs("div",{className:"flex justify-between items-center p-5 border-b border-gray-200 dark:border-slate-700 bg-gray-50 dark:bg-slate-800/50",children:[c.jsxs("h2",{className:"text-xl font-bold text-gray-900 dark:text-slate-100 flex items-center gap-2",children:["Camera Black Level Database",c.jsxs("span",{className:"text-xs font-normal bg-cyan-100 dark:bg-cyan-900/30 text-cyan-600 dark:text-cyan-400 px-2 py-0.5 rounded border border-cyan-200 dark:border-cyan-800",children:[Ym.length," Models"]})]}),c.jsx("button",{onClick:t,className:"text-gray-400 hover:text-gray-600 dark:hover:text-slate-200 transition-colors p-2 rounded-full hover:bg-gray-100 dark:hover:bg-slate-800",children:c.jsx("svg",{className:"w-6 h-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),c.jsx("div",{className:"p-4 border-b border-gray-200 dark:border-slate-700 bg-gray-50/50 dark:bg-slate-800/30",children:c.jsx(Zre,{searchTerm:n,onSearchChange:a,manufacturers:s,selectedManufacturer:i,onManufacturerChange:o,cameras:l,onCameraSelect:u})}),c.jsx("div",{className:"flex-1 overflow-y-auto p-6 scrollbar-thin scrollbar-thumb-gray-300 dark:scrollbar-thumb-slate-700 bg-gray-100 dark:bg-slate-950",children:c.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 xl:grid-cols-2 gap-6",children:[l.map(f=>c.jsx("div",{id:`camera-${f.id}`,children:c.jsx(ene,{camera:f,theme:r})},f.id)),l.length===0&&c.jsx("div",{className:"col-span-full flex flex-col items-center justify-center py-20 text-gray-400 dark:text-slate-600",children:c.jsx("p",{className:"text-lg",children:"No cameras found matching your criteria."})})]})})]})}):null},rne=({isOpen:e,onClose:t,zIndex:r=150})=>{const[n,a]=C.useState(""),[i,o]=C.useState(""),[s,l]=C.useState(""),[u,f]=C.useState(""),[d,p]=C.useState(null),m=()=>{const v=parseFloat(n),b=parseFloat(i),k=parseFloat(s),x=parseFloat(u);if(isNaN(v)||isNaN(b)||isNaN(k)||isNaN(x)){p(null);return}const y=v,w=b,_=k*k,S=x*x,j=(y+w)/2;if(j<=1e-9){p(0);return}const M=_*S/j,A=Math.sqrt(M);p(A)};return e?c.jsxs(ks,{initialPosition:{x:window.innerWidth/2-160,y:window.innerHeight/2-200},onClose:t,zIndex:r,className:"w-80 bg-white dark:bg-slate-900 border border-gray-200 dark:border-slate-700 flex flex-col shadow-2xl",children:[c.jsxs("div",{className:"flex justify-between items-center px-4 py-3 border-b border-gray-200 dark:border-slate-700 bg-gray-50 dark:bg-slate-800",children:[c.jsx("h3",{className:"text-sm font-bold text-gray-700 dark:text-slate-200",children:"Cross-Compensation Calc"}),c.jsx("button",{onClick:t,className:"text-gray-400 hover:text-red-500 transition-colors",children:c.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),c.jsxs("div",{className:"p-4 flex flex-col gap-3 text-xs",children:[c.jsxs("div",{className:"flex flex-col gap-1",children:[c.jsx("label",{className:"text-gray-500 dark:text-slate-400 font-bold",children:"H Mean (Power/Var)"}),c.jsx("input",{type:"number",step:"any",value:n,onChange:v=>a(v.target.value),className:"p-2 rounded bg-gray-100 dark:bg-slate-800 border border-gray-300 dark:border-slate-600 outline-none focus:border-indigo-500 text-gray-900 dark:text-slate-100 font-mono"})]}),c.jsxs("div",{className:"flex flex-col gap-1",children:[c.jsx("label",{className:"text-gray-500 dark:text-slate-400 font-bold",children:"V Mean (Power/Var)"}),c.jsx("input",{type:"number",step:"any",value:i,onChange:v=>o(v.target.value),className:"p-2 rounded bg-gray-100 dark:bg-slate-800 border border-gray-300 dark:border-slate-600 outline-none focus:border-indigo-500 text-gray-900 dark:text-slate-100 font-mono"})]}),c.jsxs("div",{className:"flex flex-col gap-1",children:[c.jsx("label",{className:"text-gray-500 dark:text-slate-400 font-bold",children:"H RMS 0 (Sigma)"}),c.jsx("input",{type:"number",step:"any",value:s,onChange:v=>l(v.target.value),className:"p-2 rounded bg-gray-100 dark:bg-slate-800 border border-gray-300 dark:border-slate-600 outline-none focus:border-indigo-500 text-gray-900 dark:text-slate-100 font-mono"})]}),c.jsxs("div",{className:"flex flex-col gap-1",children:[c.jsx("label",{className:"text-gray-500 dark:text-slate-400 font-bold",children:"V RMS 0 (Sigma)"}),c.jsx("input",{type:"number",step:"any",value:u,onChange:v=>f(v.target.value),className:"p-2 rounded bg-gray-100 dark:bg-slate-800 border border-gray-300 dark:border-slate-600 outline-none focus:border-indigo-500 text-gray-900 dark:text-slate-100 font-mono"})]}),c.jsx("button",{onClick:m,className:"mt-2 w-full py-2 bg-indigo-600 hover:bg-indigo-500 text-white font-bold rounded shadow transition-colors active:scale-95",children:"Calculate Sigma"}),d!==null&&c.jsxs("div",{className:"mt-2 p-3 bg-indigo-50 dark:bg-indigo-900/30 border border-indigo-200 dark:border-indigo-800 rounded text-center animate-in fade-in slide-in-from-top-1",children:[c.jsx("span",{className:"block text-[10px] uppercase font-bold text-gray-500 dark:text-slate-400 mb-1",children:"Original White Noise Sigma"}),c.jsx("span",{className:"text-lg font-mono font-bold text-indigo-700 dark:text-indigo-300 select-all",children:d.toFixed(5)})]})]})]}):null},Nx=[[.1725,.0838,.0576],[.5481,.2985,.217],[.1103,.1968,.3359],[.1038,.1502,.0521],[.2244,.2177,.4302],[.1232,.519,.4044],[.7168,.199,.0271],[.065,.1063,.3924],[.5417,.0884,.1203],[.1042,.0438,.1396],[.3547,.5078,.0482],[.7805,.3541,.0215],[.0234,.0492,.2916],[.0653,.3019,.0645],[.4294,.0319,.0402],[.8568,.5754,.0079],[.5032,.0889,.3055],[0,.249,.383],[.9163,.9155,.8705],[.5819,.5911,.5839],[.3552,.361,.359],[.1876,.1924,.1917],[.0871,.0901,.0908],[.0321,.0319,.0326]],nne=[[3.2404542,-1.5371385,-.4985314],[-.969266,1.8760108,.041556],[.0556434,-.2040259,1.0572252]];function ane(e,t,r,n,a,i,o=.5){const u=[],f=Math.max(.1,Math.min(.9,o)),d=Math.hypot(t.x-e.x,t.y-e.y),p=Math.hypot(n.x-r.x,n.y-r.y),m=Math.hypot(r.x-e.x,r.y-e.y),v=Math.hypot(n.x-t.x,n.y-t.y),b=(d+p)/2/5,k=(m+v)/2/3,x=b*f,y=k*f;for(let w=0;w<4;w++)for(let _=0;_<6;_++){const S=_/5,j=w/3,M=(1-S)*(1-j)*e.x+S*(1-j)*t.x+(1-S)*j*r.x+S*j*n.x,A=(1-S)*(1-j)*e.y+S*(1-j)*t.y+(1-S)*j*r.y+S*j*n.y;u.push({x:M-x/2,y:A-y/2,w:x,h:y})}return u}function EN(e){e.length;const t=e[0].length;return Array(t).fill(0).map((r,n)=>e.map(a=>a[n]))}function S0(e,t){const r=e.length,n=e[0].length,a=t.length,i=t[0].length;if(n!==a)throw new Error("Matrix dimensions mismatch");const o=Array(r).fill(0).map(()=>Array(i).fill(0));for(let s=0;s<r;s++)for(let l=0;l<i;l++)for(let u=0;u<n;u++)o[s][l]+=e[s][u]*t[u][l];return o}function ine(e,t){const r=EN(e),n=S0(r,e);for(let u=0;u<3;u++)n[u][u]+=1e-9;const a=[[n[0][0],n[0][1],n[0][2]],[n[1][0],n[1][1],n[1][2]],[n[2][0],n[2][1],n[2][2]]],i=al(a);if(!i)throw new Error("Singular Matrix (Check Input Data)");const o=[[i[0][0],i[0][1],i[0][2]],[i[1][0],i[1][1],i[1][2]],[i[2][0],i[2][1],i[2][2]]],s=S0(r,t);return S0(o,s)}function one(e){const t=e.length,r=e.map((n,a)=>[...n,...Array(t).fill(0).map((i,o)=>a===o?1:0)]);for(let n=0;n<t;n++){let a=n;for(let s=n+1;s<t;s++)Math.abs(r[s][n])>Math.abs(r[a][n])&&(a=s);const i=r[n];r[n]=r[a],r[a]=i;const o=r[n][n];if(Math.abs(o)<1e-12)throw new Error("Singular Matrix");for(let s=n;s<2*t;s++)r[n][s]/=o;for(let s=0;s<t;s++)if(s!==n){const l=r[s][n];for(let u=n;u<2*t;u++)r[s][u]-=l*r[n][u]}}return r.map(n=>n.slice(t))}function sne(e,t,r){const n=[...e].sort((b,k)=>b.id-k.id);if(n.length!==24)throw new Error("Requires exactly 24 patches");const a=[];n.forEach(b=>{const k=b.rawMeans,x=[k[0]-t[0],k[1]-t[1],k[2]-t[2],k[3]-t[3]];let y,w,_;r?(_=x[0],w=(x[1]+x[2])/2,y=x[3]):(y=x[0],w=(x[1]+x[2])/2,_=x[3]),y=Math.max(0,y),w=Math.max(0,w),_=Math.max(0,_),a.push([y,w,_])});const o=a[18],s=(o[0]+o[1]+o[2])/3,l=1/Math.max(1e-9,s),u=a.map(b=>[b[0]*l,b[1]*l,b[2]*l]),d=ine(u,Nx),p=EN(d);let m;try{m=one(p)}catch{throw new Error("CCM Inversion Failed. Input data might be too dark or clipped.")}return{matrix:S0(m,nne)}}const lne=({isOpen:e,onClose:t,patchStats:r,initialIsBGGR:n,zIndex:a=200,sizeRatio:i,onSizeChange:o})=>{const[s,l]=C.useState(n),[u,f]=C.useState(["0","0","0","0"]),[d,p]=C.useState(null),[m,v]=C.useState(null);if(C.useEffect(()=>{if(e&&r&&r.length===24){const j=r[23].rawMeans;u[0]==="0"&&u[1]==="0"&&f([j[0].toFixed(2),j[1].toFixed(2),j[2].toFixed(2),j[3].toFixed(2)])}},[e,r]),C.useEffect(()=>{if(!e||!r||r.length!==24)return;const S=u.map(j=>parseFloat(j));if(!S.some(isNaN))try{const j=sne(r,S,s);p(j),v(null)}catch(j){v(j.message)}},[e,r,s,u]),!e)return null;const b=(S,j)=>{f(M=>{const A=[...M];return A[S]=j,A})},k=S=>{navigator.clipboard.writeText(S)},x=S=>S?S.map(j=>j.map(M=>M.toFixed(4))):[],y=d?x(d.matrix).flat().join(" "):"",w=s?["B","G1","G2","R"]:["R","G1","G2","B"],_=s?["text-blue-500","text-green-500","text-green-500","text-red-500"]:["text-red-500","text-green-500","text-green-500","text-blue-500"];return c.jsxs(ks,{initialPosition:{x:window.innerWidth/2-200,y:100},onClose:t,zIndex:a,className:"w-[500px] bg-white dark:bg-slate-900 border border-gray-200 dark:border-slate-700 flex flex-col shadow-2xl rounded-xl overflow-hidden",children:[c.jsxs("div",{className:"flex justify-between items-center px-4 py-3 border-b border-gray-200 dark:border-slate-700 bg-gray-50 dark:bg-slate-800",children:[c.jsxs("h3",{className:"text-sm font-bold text-gray-800 dark:text-slate-100 flex items-center gap-2",children:[c.jsx("span",{className:"w-2 h-2 rounded-full bg-yellow-500"}),"Color Lab Result"]}),c.jsx("button",{onClick:t,className:"text-gray-400 hover:text-red-500 transition-colors",children:c.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),c.jsxs("div",{className:"p-5 flex flex-col gap-5",children:[c.jsxs("div",{className:"bg-gray-100 dark:bg-slate-800 p-3 rounded-lg border border-gray-200 dark:border-slate-700",children:[c.jsxs("div",{className:"flex justify-between items-center mb-1",children:[c.jsx("span",{className:"text-[10px] font-bold text-gray-500 dark:text-slate-400 uppercase",children:"Patch Sampling Size"}),c.jsxs("span",{className:"text-xs font-mono font-bold text-cyan-600 dark:text-cyan-400",children:[Math.round(i*100),"%"]})]}),c.jsx("input",{type:"range",min:"0.1",max:"0.9",step:"0.05",value:i,onChange:S=>o(parseFloat(S.target.value)),className:"w-full h-1.5 bg-gray-300 dark:bg-slate-600 rounded-lg appearance-none cursor-pointer accent-cyan-500"})]}),c.jsx("div",{className:"flex justify-center",children:c.jsxs("div",{className:"flex bg-gray-100 dark:bg-slate-800 p-1 rounded-lg border border-gray-200 dark:border-slate-700",children:[c.jsx("button",{onClick:()=>l(!1),className:`px-4 py-1.5 text-xs font-bold rounded transition-all ${s?"text-gray-500 dark:text-slate-400 hover:text-gray-700":"bg-white dark:bg-slate-600 text-indigo-600 dark:text-indigo-300 shadow-sm"}`,children:"RGGB Mode"}),c.jsx("button",{onClick:()=>l(!0),className:`px-4 py-1.5 text-xs font-bold rounded transition-all ${s?"bg-white dark:bg-slate-600 text-indigo-600 dark:text-indigo-300 shadow-sm":"text-gray-500 dark:text-slate-400 hover:text-gray-700"}`,children:"BGGR Mode"})]})}),c.jsxs("div",{className:"bg-gray-50 dark:bg-slate-800/50 p-3 rounded-lg border border-gray-100 dark:border-slate-700",children:[c.jsx("h4",{className:"text-[10px] font-bold text-gray-400 dark:text-slate-500 uppercase mb-2",children:"Input Black Levels ()"}),c.jsx("div",{className:"grid grid-cols-4 gap-2",children:[0,1,2,3].map(S=>c.jsxs("div",{className:"flex flex-col",children:[c.jsx("label",{className:`text-[10px] font-bold mb-1 ${_[S]}`,children:w[S]}),c.jsx("input",{type:"number",step:"0.01",value:u[S],onChange:j=>b(S,j.target.value),className:"w-full px-2 py-1 text-sm font-mono border border-gray-300 dark:border-slate-600 rounded bg-white dark:bg-slate-900 text-gray-900 dark:text-slate-100 outline-none focus:ring-1 focus:ring-yellow-500"})]},S))})]}),m?c.jsx("div",{className:"text-red-500 text-sm text-center bg-red-50 dark:bg-red-900/20 p-2 rounded",children:m}):d?c.jsx(c.Fragment,{children:c.jsxs("div",{className:"bg-gray-50 dark:bg-slate-800/50 p-3 rounded-lg border border-gray-100 dark:border-slate-700",children:[c.jsx("h4",{className:"text-[10px] font-bold text-gray-400 dark:text-slate-500 uppercase mb-2",children:"Calculated Color Matrix (XYZ  Camera RGB)"}),c.jsx("div",{className:"font-mono text-xs text-gray-700 dark:text-slate-300 grid grid-rows-3 gap-1 mb-3",children:x(d.matrix).map((S,j)=>c.jsxs("div",{className:"flex justify-between bg-white dark:bg-slate-900 px-2 py-1 rounded",children:[c.jsx("span",{className:"text-red-500/80 w-1/3 text-right",children:S[0]}),c.jsx("span",{className:"text-green-500/80 w-1/3 text-right",children:S[1]}),c.jsx("span",{className:"text-blue-500/80 w-1/3 text-right",children:S[2]})]},j))}),c.jsx("button",{onClick:()=>k(y),className:"w-full py-1.5 bg-indigo-600 hover:bg-indigo-500 text-white text-xs font-bold rounded shadow transition-transform active:scale-95 flex items-center justify-center gap-2",children:"Copy Matrix String (for customMatrix)"})]})}):c.jsx("div",{className:"text-gray-400 text-sm text-center",children:"Calculating..."})]})]})};function Ub(e,t){const r=e.length;let n=0,a=0,i=0,o=0;for(let l=0;l<r;l++)n+=e[l],a+=t[l],i+=e[l]*t[l],o+=e[l]*e[l];const s=r*o-n*n;return s===0?{slope:0,intercept:0}:{slope:(r*i-n*a)/s,intercept:(a*o-n*i)/s}}function cne(e,t){const r=e.length,n=new Array(r).fill(0),a=2*t;for(let i=0;i<r;i++){const o=i>0?e[i-1]:e[0],s=i<r-1?e[i+1]:e[r-1];n[i]=(s-o)/a}return n}function une(e){const t=new Array(e.length).fill(0);t[0]=e[0];for(let r=1;r<e.length;r++){let n=e[r]-e[r-1];n>Math.PI?n-=2*Math.PI:n<-Math.PI&&(n+=2*Math.PI),t[r]=t[r-1]+n}return t}function fne(e){const t=e.length,r=new Array(t).fill(0).map((i,o)=>o),{slope:n,intercept:a}=Ub(r,e);return e.map((i,o)=>i-(n*o+a))}function dne(e,t,r="RGGB"){const n=r.toUpperCase(),a=t%2,i=e%2;return n==="RGGB"||n==="BGGR"?(a+i)%2!==0:n==="GBRG"||n==="GRBG"?(a+i)%2===0:(a+i)%2!==0}function Mx(e,t,r,n,a){const i=Math.floor(n.x),o=Math.floor(n.y),s=Math.floor(n.w),l=Math.floor(n.h);if(s<8||l<8)return null;let u=[];for(let X=0;X<l;X++){const se=[],he=(o+X)*t;for(let le=0;le<s;le++)se.push(e[he+i+le]);u.push(se)}let f=0,d=0;for(let X=1;X<l-1;X+=2)for(let se=1;se<s-1;se+=2)f+=Math.abs(u[X][se+1]-u[X][se-1]),d+=Math.abs(u[X+1][se]-u[X-1][se]);let p=s,m=l,v=u,b=2,k=!1;if(d>f){b=1,k=!0,v=Array(s).fill(0).map(()=>Array(l).fill(0));for(let X=0;X<l;X++)for(let se=0;se<s;se++)v[se][l-1-X]=u[X][se];p=l,m=s}else b=2;const x=[],y=[];for(let X=0;X<m;X++){const se=v[X],he=se.map((ke,ve)=>ve===0?0:Math.abs(ke-se[ve-1])),le=Math.max(...he),je=he.indexOf(le);if(le>1){const ke=Math.max(0,je-3),ve=Math.min(p,je+4);let ge=0,Me=0;for(let Oe=ke;Oe<ve;Oe++)ge+=he[Oe],Me+=Oe*he[Oe];ge>0&&(x.push(Me/ge),y.push(X))}}if(x.length<m*.4)return null;const{slope:w,intercept:_}=Ub(y,x),S=Math.cos(Math.atan(w)),j=[],M=[],A=(a==null?void 0:a.greenOnly)??!1,$=(a==null?void 0:a.globalX)??0,E=(a==null?void 0:a.globalY)??0,T=(a==null?void 0:a.bayerPattern)||"RGGB";for(let X=0;X<m;X++){const se=w*X+_;for(let he=0;he<p;he++){if(A){let le,je;if(k){const ke=l-1-he,ve=X;le=$+i+ve,je=E+o+ke}else le=$+i+he,je=E+o+X;if(!dne(le,je,T))continue}j.push((he-se)*S),M.push(v[X][he])}}const U=Math.min(s,l)/2;let V=0;for(const X of j)Math.abs(X)<=U&&V++;let G=.125;if(a!=null&&a.manualBinSize&&a.manualBinSize>0)G=Math.max(.01,Math.min(.5,a.manualBinSize));else if(V>0){const X=40*U/V;G=Math.max(.01,Math.min(.125,X))}const D=G,I=Array.from(j.keys()).sort((X,se)=>j[X]-j[se]),F=I.map(X=>j[X]),H=I.map(X=>M[X]);if(F.length===0)return null;const W=F[0],Q=F[F.length-1],q=Math.floor((Q-W)/D),re=new Array(q).fill(0),ee=new Array(q).fill(0);for(let X=0;X<F.length;X++){const se=Math.floor((F[X]-W)/D);se>=0&&se<q&&(re[se]+=H[X],ee[se]++)}let fe=H[0];for(let X=0;X<q;X++)ee[X]>0?(re[X]/=ee[X],fe=re[X]):re[X]=fe;const oe=re.slice(0,10).reduce((X,se)=>X+se,0)/10,ye=re.slice(-10).reduce((X,se)=>X+se,0)/10;if(oe>ye){const X=Math.max(...re),se=Math.min(...re);for(let he=0;he<re.length;he++)re[he]=X-re[he]+se}const ae=cne(re,D);return{esf:re,lsfFull:ae,binSize:D,orientation:b}}function $N(e,t,r,n=!1,a=0,i=!1){if(e.length===0)return null;const o=4096,s=new il(o),l=r?1e3/r:1,u=new Float32Array(501);for(let y=0;y<=500;y++)u[y]=y/500*l*2;const f=new Float32Array(501).fill(0);let d=0,p=[],m=[],v=0,b=[];for(const y of e){let w=[...y.lsfFull];const _=y.binSize;let S=0,j=-1/0;for(let ee=0;ee<w.length;ee++)w[ee]>j&&(j=w[ee],S=ee);const M=j*.2;let A=0,$=w.length-1;for(let ee=S;ee>=0;ee--)if(w[ee]<M){A=ee;break}for(let ee=S;ee<w.length;ee++)if(w[ee]<M){$=ee;break}const E=$-A;let T=!1;if(n&&E>0){const ee=E*4,fe=[],oe=[];if(a>0){const ye=Math.max(0,S-ee-a),ae=Math.max(0,S-ee);for(let he=ye;he<ae;he++)fe.push(he),oe.push(w[he]);const X=Math.min(w.length,S+ee),se=Math.min(w.length,S+ee+a);for(let he=X;he<se;he++)fe.push(he),oe.push(w[he])}else{for(let ye=0;ye<Math.max(0,S-ee);ye++)fe.push(ye),oe.push(w[ye]);for(let ye=Math.min(w.length,S+ee);ye<w.length;ye++)fe.push(ye),oe.push(w[ye])}if(fe.length>2){const{slope:ye,intercept:ae}=Ub(fe,oe);for(let X=0;X<w.length;X++)w[X]=w[X]-(ye*X+ae);j=-1/0;for(let X=0;X<w.length;X++)w[X]>j&&(j=w[X],S=X);T=!0}}let B=0,U=0;if(t>0)U=t,B=Math.round(t/_);else{const ee=j*.2;let fe=0,oe=w.length-1;for(let se=S;se>=0;se--)if(w[se]<ee){fe=se;break}for(let se=S;se<w.length;se++)if(w[se]<ee){oe=se;break}const ae=(oe-fe)*_;let X=Math.max(2,ae*8);U=X,B=Math.round(X/_)}v+=U;const V=Math.max(0,S-B),G=Math.min(w.length,S+B),D=w.slice(V,G);if(D.length<8)continue;const I=new Float32Array(o).fill(0);let F=-1/0,H=0;for(let ee=0;ee<D.length;ee++)D[ee]>F&&(F=D[ee],H=ee);for(let ee=0;ee<D.length;ee++){let fe=1;i&&(fe=.5*(1-Math.cos(2*Math.PI*ee/(D.length-1))));const oe=D[ee]*fe,ye=(ee-H+o)%o;I[ye]=oe}s.transform(I);const W=[],Q=[],q=[];for(let ee=0;ee<=o/2;ee++){const fe=s._real[ee],oe=s._imag[ee],ye=Math.sqrt(fe*fe+oe*oe);W.push(ye),Q.push(ee/(o*_)*l),q.push(Math.atan2(oe,fe))}const re=W[0];if(re>0){for(let ee=0;ee<=500;ee++){const fe=u[ee];f[ee]+=v3(fe,Q,W)/re}if(d++,p.length===0){p=D,m=T?hne(w):y.esf;const ee=une(q),fe=fne(ee);for(let oe=0;oe<=500;oe++){const ye=u[oe];b.push(v3(ye,Q,fe))}}}}if(d===0)return null;const k=Array.from(f).map(y=>y/d);let x=null;for(let y=0;y<k.length-1;y++)if(k[y]>=.5&&k[y+1]<.5){x=u[y]+(.5-k[y])*(u[y+1]-u[y])/(k[y+1]-k[y]);break}return{esf:m,lsf:[],lsfCropped:p,mtf:k,ptf:b,freqs:Array.from(u),mtf50:x,calcRadius:v/d}}function hne(e){const t=new Array(e.length).fill(0);let r=0;for(let n=0;n<e.length;n++)r+=e[n],t[n]=r;return t}function v3(e,t,r){if(e<=t[0])return r[0];if(e>=t[t.length-1])return r[r.length-1];let n=0;for(;e>t[n+1];)n++;const a=(e-t[n])/(t[n+1]-t[n]);return r[n]+a*(r[n+1]-r[n])}const $o=({locked:e,onToggle:t,title:r})=>c.jsx("span",{className:"inline-flex items-center justify-center p-1 rounded hover:bg-gray-200 dark:hover:bg-slate-700 transition-colors cursor-pointer select-none",title:r??(e?"Locked (Auto Fit will NOT change)":"Unlocked (Auto Fit may change)"),onMouseDown:n=>{n.stopPropagation()},onClick:n=>{n.stopPropagation(),t()},children:c.jsx("span",{className:`w-4 h-4 rounded-full border-2 transition-all active:scale-90 flex items-center justify-center ${e?"border-indigo-600 bg-indigo-600":"border-gray-400 dark:border-slate-500 bg-transparent hover:border-gray-500"}`,children:e&&c.jsx("span",{className:"w-2 h-2 rounded-full bg-white"})})}),pne=({isOpen:e,onClose:t,rawImageData:r,roi:n,zIndex:a=110,onFocus:i,displaySettings:o,isSfrLabOpen:s})=>{const[l,u]=C.useState([]),[f,d]=C.useState(""),[p,m]=C.useState(""),[v,b]=C.useState(12),[k,x]=C.useState(!0),[y,w]=C.useState(!0),[_,S]=C.useState(!0),[j,M]=C.useState(!1),[A,$]=C.useState(!1),[E,T]=C.useState(!1),[B,U]=C.useState(!1),[V,G]=C.useState("50"),[D,I]=C.useState(!1),[F,H]=C.useState("0.125"),[W,Q]=C.useState(!1),[q,re]=C.useState({aperture:4,olpfSeparationPx:.7,fillFactor:.9,coreSigmaPx:.15,haloSigmaPx:.8,haloWeight:.25,wavelengthUm:.55,rolloff:1}),[ee,fe]=C.useState({aperture:!1,olpfSeparationPx:!1,fillFactor:!1,coreSigmaPx:!1,haloSigmaPx:!1,haloWeight:!1,wavelengthUm:!1,rolloff:!1}),[oe,ye]=C.useState("0"),[ae,X]=C.useState(""),[se,he]=C.useState(!1),[le,je]=C.useState(""),[ke,ve]=C.useState(1),[ge,Me]=C.useState(null),[Oe,We]=C.useState({x:100,y:50}),[Le,tt]=C.useState({w:1e3,h:800}),[mt,wt]=C.useState(!1),[Qt,_t]=C.useState(!1),Jt=C.useRef({x:0,y:0}),Nt=C.useRef({w:0,h:0}),[er,Vr]=C.useState(!1),[Tt,Sr]=C.useState(!1),Ve=l.length>0?l[l.length-1].binSize:null,Pt=Ve?(1/Ve).toFixed(1):"-",Bt=C.useMemo(()=>n?Math.max(n.w,n.h):100,[n]),tr=(o==null?void 0:o.renderMode)==="advanced-zero-dep",rr=C.useMemo(()=>{const L=parseFloat(f);return Number.isFinite(L)&&L>0?L:null},[f]),Hr=rr!==null,Ft=Hr?"lp/mm":"cy/px",bn=(L,we,Ne)=>Math.min(Ne,Math.max(we,L)),Ct=L=>{if(Math.abs(L)<1e-12)return 1;const we=Math.PI*L;return Math.sin(we)/we},tn=L=>L<=0?1:L>=1?0:2/Math.PI*(Math.acos(L)-L*Math.sqrt(1-L*L)),Ge=(L,we,Ne,gt)=>{const Xe=bn(gt,0,1),ot=Math.max(0,we),ct=Math.max(0,Ne),Yt=Math.exp(-2*Math.PI*Math.PI*ot*ot*L*L),xr=Math.exp(-2*Math.PI*Math.PI*ct*ct*L*L);return(1-Xe)*Yt+Xe*xr},rn=C.useMemo(()=>Hr&&rr?1e3/rr:1,[Hr,rr]),Ar=(L,we)=>{const{aperture:Ne,olpfSeparationPx:gt,fillFactor:Xe,coreSigmaPx:ot,haloSigmaPx:ct,haloWeight:Yt,wavelengthUm:xr,rolloff:hn}=we,Gt=Hr?L/rn:L,Sn=Math.max(1e-9,xr)/1e3,jn=Hr&&rr?rr/1e3:5/1e3,Zn=Math.max(1e-6,Ne),sr=1/(Sn*Zn)*jn,yr=sr>0?Gt/sr:1e9,Be=tn(yr),Zt=Math.max(0,gt),jr=Math.abs(Math.cos(Math.PI*Gt*Zt)),Qn=bn(Xe,0,1),Jn=Math.abs(Ct(Gt*Qn)),Kr=Math.max(0,ot),qa=Math.max(0,ct),te=Ge(Gt,Kr,qa,Yt);let me=Be*jr*Jn*te;const be=Math.max(.1,hn);return me=Math.pow(Math.max(0,me),be),Math.min(1.2,Math.max(0,me))},sn=()=>{if(!(!r||!n)){if(!tr){alert("Scalar Unmixing is required. Please configure Background/Foreground/BlackLevel in the Sidebar and click 'RUN UNMIXING' first.");return}try{let L=null;const we=D?parseFloat(F):void 0;if(o!=null&&o.advancedZeroDep){const Ne=E1(r,n,o);L=Mx(Ne.data,Ne.width,Ne.height,{x:0,y:0,w:Ne.width,h:Ne.height},{greenOnly:_,globalX:n.x,globalY:n.y,bayerPattern:r.bayerPattern,manualBinSize:we})}else L=Mx(r.data,r.width,r.height,n,{greenOnly:_,globalX:n.x,globalY:n.y,bayerPattern:r.bayerPattern,manualBinSize:we});L?u(Ne=>[...Ne,L]):alert("Could not detect valid edge.")}catch(L){console.error(L),alert("Error processing ROI")}}},Xr=()=>{u([]),Me(null),ve(1)},Tr=()=>{if(!ge)return;const L=parseFloat(f),gt=`data:text/csv;charset=utf-8,Frequency (${!isNaN(L)&&L>0?"lp/mm":"cy/px"}),MTF,Phase(Rad)
`+ge.freqs.map((ct,Yt)=>{const xr=ge.ptf?ge.ptf[Yt]:0;return`${ct.toFixed(6)},${ge.mtf[Yt].toFixed(6)},${xr?xr.toFixed(6):0}`}).join(`
`),Xe=encodeURI(gt),ot=document.createElement("a");ot.setAttribute("href",Xe),ot.setAttribute("download",`sfr_data_${Date.now()}.csv`),document.body.appendChild(ot),ot.click(),document.body.removeChild(ot)},Cr=()=>{if(!(ge!=null&&ge.mtf50)||!n)return;const L=n.x+n.w/2,we=n.y+n.h/2,Ne=`{${L.toFixed(1)},${we.toFixed(1)},${ge.mtf50.toFixed(4)}}`;navigator.clipboard.writeText(Ne)};C.useEffect(()=>{if(l.length===0){Me(null);return}const L=parseFloat(f),we=!isNaN(L)&&L>0?L:null,Ne=k?-1:v,gt=B&&parseFloat(V)||0,Xe=$N(l,Ne,we,y,gt,j);Me(Xe)},[l,v,k,y,f,B,V,j]),C.useEffect(()=>{e&&tr&&l.length===0&&n&&r&&sn()},[e]);const Er=L=>{i&&i(),!Tt&&(L.target.closest("button")||L.target.closest("input")||L.target.closest("select")||L.target.closest("label")||(wt(!0),Jt.current={x:L.clientX-Oe.x,y:L.clientY-Oe.y}))},wn=L=>{Tt||(L.stopPropagation(),L.preventDefault(),_t(!0),Jt.current={x:L.clientX,y:L.clientY},Nt.current={w:Le.w,h:Le.h})};C.useEffect(()=>{const L=Ne=>{if(mt)We({x:Ne.clientX-Jt.current.x,y:Ne.clientY-Jt.current.y});else if(Qt){const gt=Ne.clientX-Jt.current.x,Xe=Ne.clientX-Jt.current.y;tt({w:Math.max(600,Nt.current.w+gt),h:Math.max(500,Nt.current.h+Xe)})}},we=()=>{wt(!1),_t(!1)};return(mt||Qt)&&(window.addEventListener("mousemove",L),window.addEventListener("mouseup",we)),()=>{window.removeEventListener("mousemove",L),window.removeEventListener("mouseup",we)}},[mt,Qt]);const kn=C.useMemo(()=>{if(!(ge!=null&&ge.mtf50)||!p)return null;const L=parseFloat(p);if(isNaN(L)||L<=0)return null;let we=ge.mtf50;const Ne=parseFloat(f);return!isNaN(Ne)&&Ne>0&&(we=ge.mtf50*(Ne/1e3)),we*2*L},[ge,p,f]),qt=A?2:1,Et=qt*rn,fr=.004,O=C.useMemo(()=>{if(!W)return[];const L=[];for(let we=0;we<=qt+1e-12;we+=fr){const Ne=we*rn;L.push({freq:Ne,modelMtf:Ar(Ne,q)})}return L},[W,q,qt,rn]),De=C.useMemo(()=>{const L=ge?ge.mtf.map((Ne,gt)=>({freq:ge.freqs[gt],mtf:Ne})).filter(Ne=>Ne.freq<=Et):[];if(!W||O.length===0)return L.map(Ne=>({freq:Ne.freq,mtf:Ne.mtf,modelMtf:null}));const we=new Map;for(const Ne of O){const gt=Ne.freq.toFixed(6);we.set(gt,{freq:Ne.freq,mtf:null,modelMtf:Ne.modelMtf})}for(const Ne of L){const gt=Ne.freq.toFixed(6),Xe=we.get(gt);Xe?Xe.mtf=Ne.mtf:we.set(gt,{freq:Ne.freq,mtf:Ne.mtf,modelMtf:null})}return Array.from(we.values()).sort((Ne,gt)=>Ne.freq-gt.freq)},[ge,Et,W,O]),ht=ge?ge.lsfCropped.map((L,we)=>({x:we,y:L})):[],Vt=ge?ge.esf.map((L,we)=>({x:we,y:L})):[],$t=C.useMemo(()=>ge!=null&&ge.ptf?ge.ptf.map((L,we)=>({freq:ge.freqs[we],ptf:L})).filter(L=>L.freq<=Et):[],[ge,Et]);if(!e)return null;const mr={aperture:[.7,64],olpfSeparationPx:[0,5],fillFactor:[.05,1],coreSigmaPx:[0,3],haloSigmaPx:[0,50],haloWeight:[0,1],wavelengthUm:[.4,.7],rolloff:[.2,6]},$r={aperture:.2,olpfSeparationPx:.05,fillFactor:.03,coreSigmaPx:.03,haloSigmaPx:.2,haloWeight:.05,wavelengthUm:.01,rolloff:.1},nr=()=>{let L=0,we=0;for(;L===0;)L=Math.random();for(;we===0;)we=Math.random();return Math.sqrt(-2*Math.log(L))*Math.cos(2*Math.PI*we)},He=()=>["aperture","olpfSeparationPx","fillFactor","coreSigmaPx","haloSigmaPx","haloWeight","wavelengthUm","rolloff"].filter(we=>!ee[we]),pt=(L,we)=>we.map(Ne=>L[Ne]),It=(L,we,Ne,gt)=>{const Xe={...we};for(let Yt=0;Yt<Ne.length;Yt++){const xr=Ne[Yt],[hn,Gt]=mr[xr];Xe[xr]=bn(L[Yt],hn,Gt)}Object.keys(gt).forEach(Yt=>{gt[Yt]&&(Xe[Yt]=we[Yt])});const ot=gt.coreSigmaPx,ct=gt.haloSigmaPx;return ct&&!ot?Xe.coreSigmaPx=Math.min(Xe.coreSigmaPx,we.haloSigmaPx):ot&&!ct?Xe.haloSigmaPx=Math.max(Xe.haloSigmaPx,we.coreSigmaPx):!ot&&!ct&&(Xe.haloSigmaPx=Math.max(Xe.haloSigmaPx,Xe.coreSigmaPx)),Xe},Ht=(L,we)=>{const Ne=[...L];for(let gt=0;gt<we.length;gt++){const Xe=we[gt],ot=$r[Xe],ct=Xe==="aperture"?.1:Xe==="wavelengthUm"?.02:.2;Ne[gt]=Ne[gt]+ct*ot*nr()}return Ne},Ut=(L,we,Ne,gt)=>{const Xe=L.map(ot=>1/(1+.5*ot*ot));return ot=>{const ct=It(ot,Ne,gt,ee);let Yt=0;for(let Gt=0;Gt<L.length;Gt++){const Sn=we[Gt],Zn=Ar(L[Gt],ct)-Sn;Yt+=Xe[Gt]*Zn*Zn}const hn=1e-4*((ee.olpfSeparationPx?0:ct.olpfSeparationPx*ct.olpfSeparationPx)+(ee.coreSigmaPx?0:ct.coreSigmaPx*ct.coreSigmaPx)+(ee.haloSigmaPx?0:ct.haloSigmaPx*ct.haloSigmaPx)+(ee.rolloff?0:(ct.rolloff-1)*(ct.rolloff-1)));return Yt+hn}},Se=(L,we,Ne,gt=320)=>{const Xe=we.length,ot=new Array(Xe+1);ot[0]=[...we];for(let or=0;or<Xe;or++){const sr=[...we];sr[or]=sr[or]+Ne[or],ot[or+1]=sr}const ct=ot.map(or=>L(or)),Yt=()=>{const or=ct.map((Be,Zt)=>[Be,Zt]).sort((Be,Zt)=>Be[0]-Zt[0]).map(Be=>Be[1]),sr=or.map(Be=>ot[Be]),yr=or.map(Be=>ct[Be]);for(let Be=0;Be<ot.length;Be++)ot[Be]=sr[Be];for(let Be=0;Be<ct.length;Be++)ct[Be]=yr[Be]},xr=()=>{const or=new Array(Xe).fill(0);for(let sr=0;sr<Xe;sr++){const yr=ot[sr];for(let Be=0;Be<Xe;Be++)or[Be]+=yr[Be]}for(let sr=0;sr<Xe;sr++)or[sr]/=Xe;return or},hn=(or,sr,yr=1)=>or.map((Be,Zt)=>Be+yr*sr[Zt]),Gt=(or,sr)=>or.map((yr,Be)=>yr-sr[Be]),Sn=1,jn=2,Zn=.5;for(let or=0;or<gt;or++){Yt();const sr=ot[0],yr=ot[Xe],Be=xr(),Zt=hn(Be,Gt(Be,yr),Sn),jr=L(Zt);if(jr<ct[0]){const Kr=hn(Be,Gt(Zt,Be),jn),qa=L(Kr);qa<jr?(ot[Xe]=Kr,ct[Xe]=qa):(ot[Xe]=Zt,ct[Xe]=jr);continue}if(jr<ct[Xe-1]){ot[Xe]=Zt,ct[Xe]=jr;continue}const Qn=hn(Be,Gt(yr,Be),-.5),Jn=L(Qn);if(Jn<ct[Xe]){ot[Xe]=Qn,ct[Xe]=Jn;continue}for(let Kr=1;Kr<Xe+1;Kr++)ot[Kr]=hn(sr,Gt(ot[Kr],sr),Zn),ct[Kr]=L(ot[Kr])}return Yt(),{x:ot[0],fx:ct[0]}},ln=async()=>{if(!(ge!=null&&ge.freqs)||!(ge!=null&&ge.mtf)||ge.freqs.length<10){je("No enough MTF data to fit.");return}const L=He();if(L.length===0){je("All parameters are locked.");return}const we=Math.max(0,parseFloat(oe||"0")||0),Ne=Et,gt=(()=>{const Be=parseFloat(ae||"");return Number.isFinite(Be)&&Be>0?Be:Ne})(),Xe=[];for(let Be=0;Be<ge.freqs.length;Be++){const Zt=ge.freqs[Be],jr=ge.mtf[Be];Zt>=we&&Zt<=gt&&Number.isFinite(jr)&&Xe.push([Zt,jr])}if(Xe.length<10){je("Fit range too narrow (need >= 10 points).");return}const ct=Math.max(1,Math.floor(Xe.length/300)),Yt=Xe.filter((Be,Zt)=>Zt%ct===0).map(Be=>Be[0]),xr=Xe.filter((Be,Zt)=>Zt%ct===0).map(Be=>Be[1]);he(!0),je(`Fitting ${L.length} params (${Yt.length} pts) in [${we.toFixed(3)}, ${gt.toFixed(3)}] ${Ft} ...`);const hn=q,Gt=pt(hn,L),Sn=L.map(Be=>$r[Be]),jn=Ut(Yt,xr,hn,L),Zn=7;let or=Gt,sr=jn(Gt);for(let Be=0;Be<Zn;Be++){const Zt=Be===0?Gt:Ht(Gt,L),jr=Se(jn,Zt,Sn,320);jr.fx<sr&&(sr=jr.fx,or=jr.x),await new Promise(requestAnimationFrame)}const yr=It(or,hn,L,ee);re(yr),je(`Fit done. SSE=${sr.toExponential(3)}  unlocked=${L.length}  range=[${we.toFixed(3)}, ${gt.toFixed(3)}] ${Ft}`),he(!1)};return c.jsxs("div",{className:`fixed flex flex-col bg-white dark:bg-slate-900 border border-gray-200 dark:border-slate-700 shadow-2xl overflow-hidden ${Tt?"rounded-none":"rounded-xl"}`,style:Tt?{inset:0,width:"100vw",height:"100vh",zIndex:a??100}:{left:Oe.x,top:Oe.y,width:Le.w,height:er?"auto":Le.h,zIndex:a??100},onMouseDownCapture:i,children:[c.jsxs("div",{className:`flex justify-between items-center px-4 py-2 border-b border-gray-200 dark:border-slate-700 bg-gray-50 dark:bg-slate-800 select-none ${!Tt&&mt?"cursor-grabbing":Tt?"":"cursor-grab"}`,onMouseDown:Er,onDoubleClick:()=>Sr(!Tt),children:[c.jsxs("h3",{className:"text-sm font-bold text-orange-600 dark:text-orange-400 flex items-center gap-2 pointer-events-none",children:["SFR Expert (Adaptive Edge Method)",c.jsxs("span",{className:"text-xs bg-orange-100 dark:bg-orange-900/30 text-orange-700 dark:text-orange-300 px-2 py-0.5 rounded border border-orange-200 dark:border-orange-800",children:[l.length," ROI",l.length!==1?"s":""]})]}),c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx("button",{onClick:()=>Sr(!Tt),className:"text-gray-400 hover:text-orange-500 transition-colors",title:Tt?"Restore":"Maximize",children:Tt?c.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 14h6v6M20 10h-6V4"})}):c.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 8V4m0 0h4M20 8V4m0 0h-4M4 16v4m0 0h4M20 16v4m0 0h-4"})})}),c.jsx("button",{onClick:()=>Vr(!er),className:"text-gray-400 hover:text-orange-500 transition-colors",children:c.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M20 12H4"})})})]})]}),!er&&c.jsxs(c.Fragment,{children:[c.jsxs("div",{className:"p-3 bg-gray-50/50 dark:bg-slate-800/30 border-b border-gray-200 dark:border-slate-700 flex items-center gap-4 flex-wrap text-xs flex-shrink-0",children:[c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx("span",{className:"font-bold text-gray-500 dark:text-slate-400",children:"Pixel Pitch (m):"}),c.jsx("input",{type:"number",value:f,onMouseDown:L=>L.stopPropagation(),onClick:L=>L.stopPropagation(),onChange:L=>d(L.target.value),placeholder:"Default (cy/px)",className:"w-20 px-2 py-1 bg-white dark:bg-slate-900 border border-gray-300 dark:border-slate-600 rounded outline-none focus:border-orange-500"})]}),c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx("span",{className:"font-bold text-gray-500 dark:text-slate-400",children:"Image Height:"}),c.jsx("input",{type:"number",value:p,onMouseDown:L=>L.stopPropagation(),onClick:L=>L.stopPropagation(),onChange:L=>m(L.target.value),placeholder:"px",className:"w-16 px-2 py-1 bg-white dark:bg-slate-900 border border-gray-300 dark:border-slate-600 rounded outline-none focus:border-orange-500"})]}),c.jsxs("div",{className:"flex items-center gap-2 bg-blue-50 dark:bg-blue-900/20 px-2 py-1 rounded border border-blue-100 dark:border-blue-800",children:[c.jsx("span",{className:"font-bold text-blue-600 dark:text-blue-400",children:"Bin:"}),Ve?c.jsxs("span",{className:"font-mono text-gray-700 dark:text-gray-300",children:[Ve.toFixed(3),"px",c.jsxs("span",{className:"text-[10px] ml-1 text-gray-500",children:["(",Pt,"x)"]})]}):c.jsx("span",{className:"text-gray-400 italic",children:"..."}),c.jsxs("label",{className:"flex items-center gap-1 cursor-pointer select-none ml-2 border-l border-blue-200 dark:border-blue-700 pl-2",onMouseDown:L=>L.stopPropagation(),onClick:L=>L.stopPropagation(),children:[c.jsx("input",{type:"checkbox",checked:D,onChange:L=>{L.stopPropagation(),I(L.target.checked)},className:"w-3 h-3 text-blue-600 rounded focus:ring-blue-500 border-gray-300"}),c.jsx("span",{className:"text-[10px] font-bold text-blue-600 dark:text-blue-400",children:"Manual"})]}),D&&c.jsx("input",{type:"number",value:F,onMouseDown:L=>L.stopPropagation(),onClick:L=>L.stopPropagation(),onChange:L=>H(L.target.value),step:"0.001",min:"0.01",max:"0.5",className:"w-16 px-1 py-0.5 text-xs bg-white dark:bg-slate-900 border border-blue-300 dark:border-blue-600 rounded outline-none focus:border-orange-500",placeholder:"0.125"})]}),c.jsxs("div",{className:"flex items-center gap-4 flex-1 min-w-[500px] border-l border-gray-300 dark:border-slate-600 pl-3",children:[c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsxs("label",{className:"flex items-center gap-1 cursor-pointer select-none",title:"Linear detrending with limited fitting width",onMouseDown:L=>L.stopPropagation(),onClick:L=>L.stopPropagation(),children:[c.jsx("input",{type:"checkbox",checked:y,onChange:L=>{L.stopPropagation(),w(L.target.checked)},className:"w-4 h-4 text-purple-600 rounded focus:ring-purple-500 border-gray-300"}),c.jsx("span",{className:"font-bold text-purple-600 dark:text-purple-400",children:"Deshading"})]}),y&&c.jsxs(c.Fragment,{children:[c.jsxs("label",{className:"flex items-center gap-1 cursor-pointer select-none border-l border-purple-200 dark:border-purple-800 pl-2",onMouseDown:L=>L.stopPropagation(),onClick:L=>L.stopPropagation(),children:[c.jsx("input",{type:"checkbox",checked:B,onChange:L=>{L.stopPropagation(),U(L.target.checked)},className:"w-3 h-3 text-purple-600 rounded focus:ring-purple-500 border-gray-300"}),c.jsx("span",{className:"text-[10px] font-bold text-purple-600 dark:text-purple-400",children:"Limit Fit"})]}),B&&c.jsxs("div",{className:"flex items-center gap-1",title:"Width of data used for fitting (pixels)",children:[c.jsx("input",{type:"number",value:V,onMouseDown:L=>L.stopPropagation(),onClick:L=>L.stopPropagation(),onChange:L=>G(L.target.value),step:"5",min:"10",max:"500",className:"w-14 px-1 py-0.5 text-xs bg-white dark:bg-slate-900 border border-purple-300 dark:border-purple-600 rounded outline-none focus:border-orange-500"}),c.jsx("span",{className:"text-[10px] text-gray-500",children:"px"})]})]})]}),c.jsxs("label",{className:"flex items-center gap-1 cursor-pointer select-none",onMouseDown:L=>L.stopPropagation(),onClick:L=>L.stopPropagation(),children:[c.jsx("input",{type:"checkbox",checked:_,onChange:L=>{L.stopPropagation(),S(L.target.checked)},className:"w-4 h-4 text-emerald-600 rounded focus:ring-emerald-500 border-gray-300"}),c.jsx("span",{className:"font-bold text-emerald-600 dark:text-emerald-400",children:"G-Only"})]}),c.jsxs("label",{className:"flex items-center gap-1 cursor-pointer select-none",onMouseDown:L=>L.stopPropagation(),onClick:L=>L.stopPropagation(),title:"Apply Hann windowing before FFT",children:[c.jsx("input",{type:"checkbox",checked:j,onChange:L=>{L.stopPropagation(),M(L.target.checked)},className:"w-4 h-4 text-amber-600 rounded focus:ring-amber-500 border-gray-300"}),c.jsx("span",{className:"font-bold text-amber-600 dark:text-amber-400",children:"Hann On"})]}),c.jsxs("label",{className:"flex items-center gap-1 cursor-pointer select-none",onMouseDown:L=>L.stopPropagation(),onClick:L=>L.stopPropagation(),children:[c.jsx("input",{type:"checkbox",checked:A,onChange:L=>{L.stopPropagation(),$(L.target.checked)},className:"w-4 h-4 text-blue-600 rounded focus:ring-blue-500 border-gray-300"}),c.jsx("span",{className:"font-bold text-blue-600 dark:text-blue-400",children:"2 Freq"})]}),c.jsxs("label",{className:"flex items-center gap-1 cursor-pointer select-none",onMouseDown:L=>L.stopPropagation(),onClick:L=>L.stopPropagation(),children:[c.jsx("input",{type:"checkbox",checked:E,onChange:L=>{L.stopPropagation(),T(L.target.checked)},className:"w-4 h-4 text-teal-600 rounded focus:ring-teal-500 border-gray-300"}),c.jsx("span",{className:"font-bold text-teal-600 dark:text-teal-400",children:"Show PTF"})]}),c.jsxs("label",{className:"flex items-center gap-1 cursor-pointer select-none",onMouseDown:L=>L.stopPropagation(),onClick:L=>L.stopPropagation(),children:[c.jsx("input",{type:"checkbox",checked:k,onChange:L=>{L.stopPropagation();const we=L.target.checked;x(we),we||b(Bt)},className:"w-4 h-4 text-orange-600 rounded focus:ring-orange-500 border-gray-300"}),c.jsx("span",{className:"font-bold text-gray-600 dark:text-slate-300",children:"Jiang's official NR"})]}),c.jsxs("div",{className:"flex-1 flex flex-col justify-center",children:[c.jsxs("div",{className:"flex justify-between items-baseline",children:[c.jsx("span",{className:"font-bold text-gray-500 dark:text-slate-400",children:k?"Calculated:":"Manual:"}),c.jsxs("span",{className:`font-mono font-bold ${k?"text-green-600 dark:text-green-400":"text-gray-700 dark:text-gray-300"}`,children:[k&&(ge!=null&&ge.calcRadius)?ge.calcRadius.toFixed(2):v.toFixed(1)," px"]})]}),c.jsx("input",{type:"range",min:"2",max:Bt,step:"0.5",value:v,onMouseDown:L=>L.stopPropagation(),onChange:L=>{b(parseFloat(L.target.value)),x(!1)},disabled:k,className:`w-full h-1.5 rounded-lg appearance-none cursor-pointer ${k?"bg-gray-200 dark:bg-slate-800":"bg-gray-300 dark:bg-slate-600 accent-orange-500"}`})]})]}),c.jsxs("div",{className:"flex gap-2",children:[c.jsx("button",{onMouseDown:L=>L.stopPropagation(),onClick:L=>{L.stopPropagation(),sn()},disabled:!tr,title:tr?"":"Scalar Unmixing must be active. Run Unmixing in Sidebar first.",className:`px-3 py-1.5 text-white font-bold rounded shadow-sm transition-transform active:scale-95 ${tr?"bg-orange-600 hover:bg-orange-500":"bg-gray-400 cursor-not-allowed"}`,children:tr?"Add Current ROI":"Unmixing Required"}),c.jsx("button",{onMouseDown:L=>L.stopPropagation(),onClick:L=>{L.stopPropagation(),Cr()},disabled:!ge||!ge.mtf50||!n,className:"px-3 py-1.5 bg-cyan-600 hover:bg-cyan-500 disabled:bg-gray-300 disabled:text-gray-500 text-white font-bold rounded shadow-sm transition-transform active:scale-95",children:"Copy Pos/MTF50"}),c.jsx("button",{onMouseDown:L=>L.stopPropagation(),onClick:L=>{L.stopPropagation(),Tr()},disabled:!ge,className:"px-3 py-1.5 bg-indigo-600 hover:bg-indigo-500 disabled:bg-gray-300 disabled:text-gray-500 text-white font-bold rounded shadow-sm transition-transform active:scale-95",children:"Export CSV"}),c.jsx("button",{onMouseDown:L=>L.stopPropagation(),onClick:L=>{L.stopPropagation(),Xr()},className:"px-3 py-1.5 bg-gray-200 hover:bg-gray-300 dark:bg-slate-700 dark:hover:bg-slate-600 text-gray-600 dark:text-slate-300 font-bold rounded transition-colors",children:"Clear"})]})]}),c.jsxs("div",{className:"px-3 py-2 bg-indigo-50 dark:bg-indigo-900/20 border-b border-indigo-200 dark:border-indigo-800 flex items-center gap-4 flex-wrap text-xs",children:[c.jsxs("label",{className:"flex items-center gap-2 cursor-pointer select-none",onMouseDown:L=>L.stopPropagation(),onClick:L=>L.stopPropagation(),children:[c.jsx("input",{type:"checkbox",checked:W,onChange:L=>{L.stopPropagation(),Q(L.target.checked)},className:"w-4 h-4 text-indigo-600 rounded focus:ring-indigo-500 border-gray-300"}),c.jsx("span",{className:"font-bold text-indigo-700 dark:text-indigo-400 text-sm",children:"Show Model Line"})]}),c.jsxs("div",{className:"flex items-center gap-2",title:"F-number (Aperture)",children:[c.jsx($o,{locked:ee.aperture,onToggle:()=>fe(L=>({...L,aperture:!L.aperture}))}),c.jsx("span",{className:"font-bold text-gray-600 dark:text-slate-300",children:"F/"}),c.jsx("input",{type:"number",value:q.aperture,step:"0.05",min:"0.7",max:"64",onMouseDown:L=>L.stopPropagation(),onClick:L=>L.stopPropagation(),onChange:L=>{const we=parseFloat(L.target.value);Number.isFinite(we)&&re(Ne=>({...Ne,aperture:we}))},className:"w-20 px-1 py-0.5 bg-white dark:bg-slate-900 border border-indigo-300 dark:border-indigo-600 rounded text-xs"})]}),c.jsxs("div",{className:"flex items-center gap-2",title:"OLPF two-image split separation d (px)",children:[c.jsx($o,{locked:ee.olpfSeparationPx,onToggle:()=>fe(L=>({...L,olpfSeparationPx:!L.olpfSeparationPx}))}),c.jsx("span",{className:"font-bold text-gray-600 dark:text-slate-300",children:"OLPF d:"}),c.jsx("input",{type:"number",value:q.olpfSeparationPx,step:"0.01",min:"0",max:"5",onMouseDown:L=>L.stopPropagation(),onClick:L=>L.stopPropagation(),onChange:L=>{const we=parseFloat(L.target.value);Number.isFinite(we)&&re(Ne=>({...Ne,olpfSeparationPx:we}))},className:"w-20 px-1 py-0.5 bg-white dark:bg-slate-900 border border-indigo-300 dark:border-indigo-600 rounded text-xs"}),c.jsx("span",{className:"text-[10px] text-gray-500",children:"px"})]}),c.jsxs("div",{className:"flex items-center gap-2",title:"Pixel Fill Factor (0..1)",children:[c.jsx($o,{locked:ee.fillFactor,onToggle:()=>fe(L=>({...L,fillFactor:!L.fillFactor}))}),c.jsx("span",{className:"font-bold text-gray-600 dark:text-slate-300",children:"Fill:"}),c.jsx("input",{type:"number",value:q.fillFactor,step:"0.01",min:"0",max:"1",onMouseDown:L=>L.stopPropagation(),onClick:L=>L.stopPropagation(),onChange:L=>{const we=parseFloat(L.target.value);Number.isFinite(we)&&re(Ne=>({...Ne,fillFactor:we}))},className:"w-20 px-1 py-0.5 bg-white dark:bg-slate-900 border border-indigo-300 dark:border-indigo-600 rounded text-xs"})]}),c.jsxs("div",{className:"flex items-center gap-2",title:"Spherical core sigma (px)",children:[c.jsx($o,{locked:ee.coreSigmaPx,onToggle:()=>fe(L=>({...L,coreSigmaPx:!L.coreSigmaPx}))}),c.jsx("span",{className:"font-bold text-gray-600 dark:text-slate-300",children:"Core :"}),c.jsx("input",{type:"number",value:q.coreSigmaPx,step:"0.01",min:"0",max:"10",onMouseDown:L=>L.stopPropagation(),onClick:L=>L.stopPropagation(),onChange:L=>{const we=parseFloat(L.target.value);Number.isFinite(we)&&re(Ne=>({...Ne,coreSigmaPx:we}))},className:"w-20 px-1 py-0.5 bg-white dark:bg-slate-900 border border-indigo-300 dark:border-indigo-600 rounded text-xs"}),c.jsx("span",{className:"text-[10px] text-gray-500",children:"px"})]}),c.jsxs("div",{className:"flex items-center gap-2",title:"Spherical halo sigma (px)",children:[c.jsx($o,{locked:ee.haloSigmaPx,onToggle:()=>fe(L=>({...L,haloSigmaPx:!L.haloSigmaPx}))}),c.jsx("span",{className:"font-bold text-gray-600 dark:text-slate-300",children:"Halo :"}),c.jsx("input",{type:"number",value:q.haloSigmaPx,step:"0.01",min:"0",max:"50",onMouseDown:L=>L.stopPropagation(),onClick:L=>L.stopPropagation(),onChange:L=>{const we=parseFloat(L.target.value);Number.isFinite(we)&&re(Ne=>({...Ne,haloSigmaPx:we}))},className:"w-20 px-1 py-0.5 bg-white dark:bg-slate-900 border border-indigo-300 dark:border-indigo-600 rounded text-xs"}),c.jsx("span",{className:"text-[10px] text-gray-500",children:"px"})]}),c.jsxs("div",{className:"flex items-center gap-2",title:"Halo weight 0..1",children:[c.jsx($o,{locked:ee.haloWeight,onToggle:()=>fe(L=>({...L,haloWeight:!L.haloWeight}))}),c.jsx("span",{className:"font-bold text-gray-600 dark:text-slate-300",children:"Halo w:"}),c.jsx("input",{type:"number",value:q.haloWeight,step:"0.01",min:"0",max:"1",onMouseDown:L=>L.stopPropagation(),onClick:L=>L.stopPropagation(),onChange:L=>{const we=parseFloat(L.target.value);Number.isFinite(we)&&re(Ne=>({...Ne,haloWeight:we}))},className:"w-20 px-1 py-0.5 bg-white dark:bg-slate-900 border border-indigo-300 dark:border-indigo-600 rounded text-xs"})]}),c.jsxs("div",{className:"flex items-center gap-2",title:"Wavelength (m) for diffraction model",children:[c.jsx($o,{locked:ee.wavelengthUm,onToggle:()=>fe(L=>({...L,wavelengthUm:!L.wavelengthUm}))}),c.jsx("span",{className:"font-bold text-gray-600 dark:text-slate-300",children:":"}),c.jsx("input",{type:"number",value:q.wavelengthUm,step:"0.01",min:"0.35",max:"0.75",onMouseDown:L=>L.stopPropagation(),onClick:L=>L.stopPropagation(),onChange:L=>{const we=parseFloat(L.target.value);Number.isFinite(we)&&re(Ne=>({...Ne,wavelengthUm:we}))},className:"w-20 px-1 py-0.5 bg-white dark:bg-slate-900 border border-indigo-300 dark:border-indigo-600 rounded text-xs"}),c.jsx("span",{className:"text-[10px] text-gray-500",children:"m"})]}),c.jsxs("div",{className:"flex items-center gap-2",title:"Manual rolloff exponent",children:[c.jsx($o,{locked:ee.rolloff,onToggle:()=>fe(L=>({...L,rolloff:!L.rolloff}))}),c.jsx("span",{className:"font-bold text-gray-600 dark:text-slate-300",children:"Rolloff:"}),c.jsx("input",{type:"number",value:q.rolloff,step:"0.01",min:"0.1",max:"10",onMouseDown:L=>L.stopPropagation(),onClick:L=>L.stopPropagation(),onChange:L=>{const we=parseFloat(L.target.value);Number.isFinite(we)&&re(Ne=>({...Ne,rolloff:we}))},className:"w-20 px-1 py-0.5 bg-white dark:bg-slate-900 border border-indigo-300 dark:border-indigo-600 rounded text-xs"})]}),c.jsxs("div",{className:"flex items-center gap-2 ml-2",children:[c.jsx("span",{className:"font-bold text-gray-600 dark:text-slate-300",children:"Fit:"}),c.jsx("input",{type:"number",value:oe,step:"0.001",min:"0",onMouseDown:L=>L.stopPropagation(),onClick:L=>L.stopPropagation(),onChange:L=>ye(L.target.value),className:"w-20 px-1 py-0.5 bg-white dark:bg-slate-900 border border-indigo-300 dark:border-indigo-600 rounded text-xs",title:`Fit range min (${Ft})`}),c.jsx("span",{className:"text-[10px] text-gray-500",children:"to"}),c.jsx("input",{type:"number",value:ae,step:"0.001",min:"0",onMouseDown:L=>L.stopPropagation(),onClick:L=>L.stopPropagation(),onChange:L=>X(L.target.value),className:"w-20 px-1 py-0.5 bg-white dark:bg-slate-900 border border-indigo-300 dark:border-indigo-600 rounded text-xs",placeholder:`${Et.toFixed(2)}`,title:`Fit range max (${Ft}), blank = current max`}),c.jsx("button",{onMouseDown:L=>L.stopPropagation(),onClick:L=>{L.stopPropagation(),se||ln()},disabled:se||!ge,className:`px-2 py-1 rounded font-bold text-white text-xs transition-transform active:scale-95 ${se?"bg-gray-400":"bg-indigo-600 hover:bg-indigo-500"}`,title:"Auto fit UNLOCKED params to measured MTF in the given frequency range",children:se?"Fitting":"Auto Fit"})]}),c.jsx("span",{className:"text-[10px] text-gray-500 dark:text-slate-400 italic ml-2",children:"Dot filled = locked. Auto Fit only changes unlocked params."}),le&&c.jsx("span",{className:"text-[10px] text-gray-500 dark:text-slate-400 italic ml-2",children:le})]}),c.jsxs("div",{className:"flex-1 p-4 overflow-hidden flex flex-col gap-4 bg-white dark:bg-slate-950",children:[c.jsxs("div",{className:"h-[35%] min-h-[180px] flex gap-4",children:[c.jsxs("div",{className:"flex-1 bg-gray-50 dark:bg-slate-900/50 border border-gray-200 dark:border-slate-800 rounded-xl p-2 relative flex flex-col",children:[c.jsx("h4",{className:"text-[10px] font-bold text-gray-500 dark:text-slate-400 absolute top-2 left-3 z-10 bg-white/80 dark:bg-slate-900/80 px-1 rounded",children:"ESF"}),c.jsx("div",{className:"flex-1 min-h-0 w-full",children:c.jsx(Ui,{width:"100%",height:"100%",children:c.jsxs(Xs,{data:Vt,children:[c.jsx(Ni,{strokeDasharray:"3 3",stroke:"#374151",opacity:.1}),c.jsx(ka,{dataKey:"x",hide:!0}),c.jsx(Sa,{hide:!0,domain:["auto","auto"]}),c.jsx(Un,{contentStyle:{fontSize:"10px"}}),c.jsx(xn,{type:"monotone",dataKey:"y",stroke:"#3b82f6",strokeWidth:1,dot:!1,isAnimationActive:!1})]})})})]}),c.jsxs("div",{className:"flex-1 bg-gray-50 dark:bg-slate-900/50 border border-gray-200 dark:border-slate-800 rounded-xl p-2 relative flex flex-col",children:[c.jsxs("div",{className:"absolute top-2 left-3 z-10 flex items-center gap-3",children:[c.jsxs("h4",{className:"text-[10px] font-bold text-gray-500 dark:text-slate-400 bg-white/80 dark:bg-slate-900/80 px-1 rounded",children:["LSF ",ke>1?`(x${ke.toFixed(0)})`:""]}),c.jsxs("div",{className:"flex items-center gap-1 bg-white/80 dark:bg-slate-900/80 px-1 rounded border border-gray-200 dark:border-slate-700",children:[c.jsx("span",{className:"text-[9px] text-gray-400 font-bold",children:"Zoom"}),c.jsx("input",{type:"range",min:"1",max:"50",step:"1",value:ke,onMouseDown:L=>L.stopPropagation(),onChange:L=>ve(parseFloat(L.target.value)),className:"w-16 h-1 bg-gray-300 dark:bg-slate-600 rounded-lg appearance-none cursor-pointer accent-red-500"})]})]}),c.jsx("div",{className:"flex-1 min-h-0 w-full",children:c.jsx(Ui,{width:"100%",height:"100%",children:c.jsxs(Xs,{data:ht,children:[c.jsx(Ni,{strokeDasharray:"3 3",stroke:"#374151",opacity:.1}),c.jsx(Yo,{y:0,stroke:"#9ca3af",strokeOpacity:.5,strokeDasharray:"3 3"}),c.jsx(ka,{dataKey:"x",hide:!0}),c.jsx(Sa,{hide:!1,width:30,tick:{fontSize:9,fill:"#888"},domain:[L=>L,L=>L/ke],allowDataOverflow:!0,tickFormatter:L=>L.toFixed(3)}),c.jsx(Un,{contentStyle:{fontSize:"10px"},formatter:L=>[L.toFixed(5),"Amplitude"]}),c.jsx(xn,{type:"monotone",dataKey:"y",stroke:"#ef4444",strokeWidth:2,dot:!1,isAnimationActive:!1})]})})})]})]}),c.jsxs("div",{className:"flex-1 flex gap-4 min-h-[250px]",children:[c.jsxs("div",{className:"flex-1 bg-white dark:bg-slate-900 border border-gray-200 dark:border-slate-800 rounded-xl p-2 relative flex flex-col",children:[c.jsxs("div",{className:"flex justify-between items-start px-2 mb-1",children:[c.jsx("h4",{className:"text-xs font-bold text-gray-500 dark:text-slate-400 uppercase",children:"MTF"}),c.jsxs("div",{className:"flex gap-4 items-center",children:[(ge==null?void 0:ge.mtf50)&&c.jsxs("div",{className:"text-sm font-bold text-gray-600 dark:text-slate-300",children:["MTF50 = ",c.jsxs("span",{className:"text-orange-600 dark:text-orange-400",children:[ge.mtf50.toFixed(2)," ",Ft]})]}),kn!==null&&c.jsxs("div",{className:"text-lg font-bold text-white bg-orange-500 px-3 py-0.5 rounded shadow-lg animate-in fade-in",children:[Math.round(kn)," LW/PH"]})]})]}),c.jsxs("div",{className:"flex-1 relative min-h-0 w-full",children:[c.jsx("div",{className:"absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 pointer-events-none select-none opacity-10",children:c.jsx("svg",{viewBox:"0 0 400 60",className:"w-[30rem] h-auto",children:c.jsx("text",{x:"50%",y:"50%",dominantBaseline:"middle",textAnchor:"middle",className:"fill-gray-900 dark:fill-white",fontSize:"24",fontWeight:"bold",children:" y-g-jiang.github.io"})})}),c.jsx(Ui,{width:"100%",height:"100%",children:c.jsxs(Xs,{data:De,margin:{top:10,right:30,left:10,bottom:20},children:[c.jsx(Ni,{strokeDasharray:"3 3",stroke:"#374151",opacity:.15}),c.jsx(ka,{dataKey:"freq",type:"number",domain:[0,Et],tick:{fontSize:10,fill:"#9ca3af"},label:{value:`Frequency (${Ft})`,position:"insideBottom",offset:-10,fontSize:11,fill:"#9ca3af"}}),c.jsx(Sa,{domain:[0,1.1],tick:{fontSize:10,fill:"#9ca3af"},label:{value:"MTF",angle:-90,position:"insideLeft",fontSize:11,fill:"#9ca3af"}}),c.jsx(Un,{contentStyle:{backgroundColor:"rgba(15, 23, 42, 0.9)",border:"none",color:"#fff",fontSize:"11px",borderRadius:"4px"},labelFormatter:L=>`Freq: ${Number(L).toFixed(3)} ${Ft}`,formatter:(L,we)=>we==="Model"?[L==null?void 0:L.toFixed(4),"Model"]:[L==null?void 0:L.toFixed(4),"Measured"]}),c.jsx(Xi,{verticalAlign:"top",height:20}),c.jsx(xn,{type:"monotone",dataKey:"mtf",name:"Measured",stroke:"#000000",strokeWidth:2,className:"dark:stroke-white",dot:!1,isAnimationActive:!1,connectNulls:!1}),W&&c.jsx(xn,{type:"monotone",dataKey:"modelMtf",name:"Model",stroke:"#0066cc",strokeWidth:2,strokeDasharray:"5 5",dot:!1,isAnimationActive:!1,connectNulls:!0}),(ge==null?void 0:ge.mtf50)&&c.jsx(dd,{x:ge.mtf50,y:.5,r:4,fill:"#f97316",stroke:"none",children:c.jsx(ia,{value:"MTF50",position:"top",fill:"#f97316",fontSize:10,fontWeight:"bold"})})]})})]})]}),E&&c.jsxs("div",{className:"flex-1 bg-white dark:bg-slate-900 border border-gray-200 dark:border-slate-800 rounded-xl p-2 relative flex flex-col",children:[c.jsx("div",{className:"flex justify-between items-start px-2 mb-1",children:c.jsx("h4",{className:"text-xs font-bold text-teal-600 dark:text-teal-400 uppercase",children:"PTF / Phase"})}),c.jsx("div",{className:"flex-1 relative min-h-0 w-full",children:c.jsx(Ui,{width:"100%",height:"100%",children:c.jsxs(Xs,{data:$t,margin:{top:10,right:30,left:10,bottom:20},children:[c.jsx(Ni,{strokeDasharray:"3 3",stroke:"#374151",opacity:.15}),c.jsx(ka,{dataKey:"freq",type:"number",domain:[0,Et],tick:{fontSize:10,fill:"#9ca3af"},label:{value:`Frequency (${Ft})`,position:"insideBottom",offset:-10,fontSize:11,fill:"#9ca3af"}}),c.jsx(Sa,{tick:{fontSize:10,fill:"#9ca3af"},label:{value:"Phase (Rad)",angle:-90,position:"insideLeft",fontSize:11,fill:"#9ca3af"}}),c.jsx(Un,{contentStyle:{backgroundColor:"rgba(15, 23, 42, 0.9)",border:"none",color:"#fff",fontSize:"11px",borderRadius:"4px"},labelFormatter:L=>`Freq: ${Number(L).toFixed(3)} ${Ft}`,formatter:L=>[L==null?void 0:L.toFixed(4),"Phase (Rad)"]}),c.jsx(xn,{type:"monotone",dataKey:"ptf",name:"Phase",stroke:"#0d9488",strokeWidth:2,dot:!1,isAnimationActive:!1})]})})})]})]})]})]}),!Tt&&c.jsx("div",{className:"absolute bottom-0 right-0 w-4 h-4 cursor-nwse-resize z-50 bg-gray-300 dark:bg-slate-600 rounded-tl hover:bg-orange-500 transition-colors",onMouseDown:wn})]})},gne=`
import struct
import numpy as np

class Type:
    Short = (3,2); Long = (4,4); Rational = (5,8); Ascii = (2,1); Byte = (1,1)
    Undefined = (7,1); Srational = (10,8); IFD = (13,4)

class Tag:
    NewSubfileType = (254, Type.Long); ImageWidth = (256, Type.Long); ImageLength = (257, Type.Long)
    BitsPerSample = (258, Type.Short); Compression = (259, Type.Short)
    PhotometricInterpretation = (262, Type.Short); Make = (271, Type.Ascii); Model = (272, Type.Ascii)
    StripOffsets = (273, Type.Long); Orientation = (274, Type.Short); SamplesPerPixel = (277, Type.Short)
    RowsPerStrip = (278, Type.Short); StripByteCounts = (279, Type.Long)
    CFARepeatPatternDim = (33421, Type.Short); CFAPattern = (33422, Type.Byte)
    DNGVersion = (50706, Type.Byte); UniqueCameraModel = (50708, Type.Ascii)
    BlackLevel = (50714, Type.Short); WhiteLevel = (50717, Type.Short)
    ColorMatrix1 = (50721, Type.Srational); CalibrationIlluminant1 = (50778, Type.Short)
    BlackLevelRepeatDim = (50713, Type.Short)

class Compression: Uncompressed = 1
class PhotometricInterpretation: Color_Filter_Array = 32803
class CFAPattern: BGGR=[2,1,1,0]; GBRG=[1,2,0,1]; GRBG=[1,0,2,1]; RGGB=[0,1,1,2]

class dngTag(object):
    def __init__(self, tagType, value=[]):
        self.TagId = tagType[0]
        self.DataType = tagType[1]
        self.DataCount = len(value) if not isinstance(value, str) else len(value) + 1
        self.Value = self._pack_value(tagType[1], value)
        self.DataLength = len(self.Value)
        self.selfContained = (self.DataLength <= 4)
        self.DataOffset = 0

    def _pack_value(self, dtype, value):
        tid = dtype[0]
        if tid == 1: return struct.pack('<%sB' % len(value), *value)
        elif tid == 3: return struct.pack('<%sH' % len(value), *value)
        elif tid == 4: return struct.pack('<%sL' % len(value), *value)
        elif tid == 2: return struct.pack('<%ss' % len(value), value.encode("ascii")) + b'\\x00'
        elif tid == 5 or tid == 10: 
            flat = [item for sublist in value for item in sublist]
            fmt = 'L' if tid == 5 else 'l'
            return struct.pack('<%s%s' % (len(flat), fmt), *flat)
        return b''

    def write_directory(self, buf, offset):
        if self.selfContained:
            val = self.Value + b'\\x00' * (4 - len(self.Value))
            struct.pack_into("<HHI4s", buf, offset, self.TagId, self.DataType[0], self.DataCount, val)
        else:
            struct.pack_into("<HHII", buf, offset, self.TagId, self.DataType[0], self.DataCount, self.DataOffset)

    def write_data(self, buf):
        if not self.selfContained:
            struct.pack_into(f"<{len(self.Value)}s", buf, self.DataOffset, self.Value)

def convert_to_dng(raw_bytes, width, height, cfa_str, black_level_list, shift, linear_shift, cm_flat):
    # 1. Pixel Data Processing
    # Ensure raw_bytes is a bytes-like object
    raw_data = np.frombuffer(raw_bytes, dtype=np.uint16).copy()
    
    # Use int32 for calculations to prevent premature overflow and allow negative offsets
    raw_data = raw_data.astype(np.int32)

    # Apply Bit Shift (<<)
    if shift > 0:
        raw_data = raw_data * (1 << shift)
    
    # Apply Linear Offset (+)
    if linear_shift != 0:
        raw_data = raw_data + linear_shift

    # Clip to 16-bit range
    raw_data = np.clip(raw_data, 0, 65535).astype(np.uint16)

    # 2. Metadata Preparation
    white_level = 65019
    # Format Color Matrix for Srational (Value, Denominator)
    color_matrix = [[int(x * 10000), 10000] for x in cm_flat]

    cfa_map = {"BGGR": CFAPattern.BGGR, "GBRG": CFAPattern.GBRG, "GRBG": CFAPattern.GRBG, "RGGB": CFAPattern.RGGB}
    
    tags = [
        dngTag(Tag.NewSubfileType, [0]),
        dngTag(Tag.ImageWidth, [width]),
        dngTag(Tag.ImageLength, [height]),
        dngTag(Tag.BitsPerSample, [16]), 
        dngTag(Tag.Compression, [Compression.Uncompressed]),
        dngTag(Tag.PhotometricInterpretation, [PhotometricInterpretation.Color_Filter_Array]),
        dngTag(Tag.Make, "JO-Workstation"),
        dngTag(Tag.Model, "Manual-16bit"),
        dngTag(Tag.SamplesPerPixel, [1]),
        dngTag(Tag.RowsPerStrip, [height]), 
        dngTag(Tag.CFARepeatPatternDim, [2, 2]),
        dngTag(Tag.CFAPattern, cfa_map.get(cfa_str.upper(), CFAPattern.RGGB)),
        dngTag(Tag.BlackLevelRepeatDim, [2, 2]),
        dngTag(Tag.BlackLevel, [int(x) for x in black_level_list]),
        dngTag(Tag.WhiteLevel, [white_level]),
        dngTag(Tag.ColorMatrix1, color_matrix),
        dngTag(Tag.CalibrationIlluminant1, [21]),
        dngTag(Tag.DNGVersion, [1, 4, 0, 0]),
        dngTag(Tag.UniqueCameraModel, "Generic 16bit Raw")
    ]
    
    pixel_bytes = raw_data.tobytes()
    tags.append(dngTag(Tag.StripOffsets, [0])) 
    tags.append(dngTag(Tag.StripByteCounts, [len(pixel_bytes)]))
    tags.sort(key=lambda x: x.TagId)
    
    ifd_size = 2 + (len(tags) * 12) + 4
    current_data_offset = 8 + ifd_size
    
    for tag in tags:
        if not tag.selfContained:
            tag.DataOffset = current_data_offset
            current_data_offset = (current_data_offset + tag.DataLength + 3) & 0xFFFFFFFC
            
    img_offset = current_data_offset
    for tag in tags:
        if tag.TagId == Tag.StripOffsets[0]:
            tag.Value = struct.pack('<L', img_offset)
            break
            
    buf = bytearray(img_offset + len(pixel_bytes))
    struct.pack_into("<ccbbI", buf, 0, b'I', b'I', 0x2A, 0x00, 8)
    struct.pack_into("<H", buf, 8, len(tags))
    
    offset = 10
    for tag in tags:
        tag.write_directory(buf, offset)
        offset += 12
        
    struct.pack_into("<I", buf, offset, 0)
    for tag in tags:
        tag.write_data(buf)
        
    buf[img_offset:img_offset+len(pixel_bytes)] = pixel_bytes
    return bytes(buf)
`,mne=({isOpen:e,onClose:t,rawImageData:r,fileName:n,zIndex:a=200,onFocus:i})=>{const[o,s]=C.useState(!0),[l,u]=C.useState(!1),[f,d]=C.useState(""),p=C.useRef(null),m=C.useRef(null),[v,b]=C.useState(4),[k,x]=C.useState(0),[y,w]=C.useState(""),[_,S]=C.useState(""),[j,M]=C.useState("RGGB"),[A,$]=C.useState(!1),[E,T]=C.useState(100),[B,U]=C.useState(4e3),[V,G]=C.useState(0),[D,I]=C.useState(0),F=C.useMemo(()=>Object.keys(hc).sort(),[]);C.useEffect(()=>{e&&!p.current&&(async()=>{try{const q=await window.loadPyodide();await q.loadPackage("numpy"),await q.runPythonAsync(gne),p.current=q,s(!1)}catch(q){console.error("Pyodide Init Failed",q)}})()},[e]),C.useEffect(()=>{if(e&&r){const Q=r.whiteLevel;Q>1e4?b(2):Q>3e3?b(4):Q>6e4&&b(0);const q=r.bayerPattern?r.bayerPattern.toUpperCase():"RGGB";["RGGB","BGGR","GBRG","GRBG"].includes(q)?M(q):M("RGGB");const re=Math.min(r.width,r.height),ee=Math.max(48,Math.round(re/40));T(ee),G(Math.round(ee*10)),I(Math.round(r.height-ee*2))}},[e,r]);const H=async Q=>{if(!Q.target.files||Q.target.files.length===0||!p.current)return;const q=Array.from(Q.target.files);u(!0);const re=y.trim()?y.trim().split(/\s+/).map(Number):[0,0,0,0];for(re.length===1&&!isNaN(re[0])&&re.push(re[0],re[0],re[0]);re.length<4;)re.push(0);const ee=_.trim()?_.trim().split(/[\s,\n]+/).map(Number):[1,0,0,0,1,0,0,0,1];if(ee.length!==9){alert("Color Matrix must contain exactly 9 numeric values."),u(!1);return}const fe=p.current;for(let oe=0;oe<q.length;oe++){const ye=q[oe];d(`Processing ${oe+1}/${q.length}: ${ye.name}`);try{const ae=await ye.arrayBuffer(),X=await pc(ae);let se;if(A){const Oe=document.createElement("canvas");Oe.width=X.width,Oe.height=X.height;const We=Oe.getContext("2d");if(We){We.fillStyle="black",We.fillRect(0,0,Oe.width,Oe.height),We.font=`bold ${E}px sans-serif`,We.fillStyle="white",We.textBaseline="middle",We.textAlign="center",We.fillText("(C)  y-g-jiang.github.io",V,D);const Le=We.getImageData(0,0,Oe.width,Oe.height).data;se=new Uint16Array(X.data);const tt=se.length;for(let mt=0;mt<tt;mt++)if(Le[mt*4]>128){let wt=se[mt]+B;wt<0&&(wt=0),wt>65535&&(wt=65535),se[mt]=wt}}else se=new Uint16Array(X.data)}else se=X.data;fe.globals.set("js_raw_bytes",new Uint8Array(se.buffer,se.byteOffset,se.byteLength)),fe.globals.set("js_width",X.width),fe.globals.set("js_height",X.height),fe.globals.set("js_cfa",j),fe.globals.set("js_bl_list",re),fe.globals.set("js_shift",v),fe.globals.set("js_linear_shift",k),fe.globals.set("js_cm_flat",ee);const he=await fe.runPythonAsync(`
                    convert_to_dng(
                        js_raw_bytes.to_py(), 
                        js_width, 
                        js_height, 
                        js_cfa, 
                        js_bl_list.to_py(), 
                        js_shift,
                        js_linear_shift,
                        js_cm_flat.to_py()
                    )
                `),le=he.toJs();he.destroy();const je=new Blob([le],{type:"image/x-adobe-dng"}),ke=URL.createObjectURL(je),ve=document.createElement("a");ve.href=ke;const ge=ye.name.substring(0,ye.name.lastIndexOf("."))||"image",Me=A?"_wm":"";ve.download=`${ge}_16bit_manual${Me}.dng`,document.body.appendChild(ve),ve.click(),document.body.removeChild(ve),URL.revokeObjectURL(ke),await new Promise(Oe=>setTimeout(Oe,200))}catch(ae){console.error(`Failed to batch process ${ye.name}`,ae)}}u(!1),d(""),Q.target.value=""},W=async()=>{if(!(!r||!p.current)){u(!0);try{const Q=p.current,q=y.trim()?y.trim().split(/\s+/).map(Number):[0,0,0,0];if(q.length===1&&!isNaN(q[0])&&q.push(q[0],q[0],q[0]),q.length<4)for(;q.length<4;)q.push(0);const re=_.trim()?_.trim().split(/[\s,\n]+/).map(Number):[1,0,0,0,1,0,0,0,1];if(re.length!==9)throw new Error("Color Matrix must contain exactly 9 numeric values.");const ee=j;let fe;if(A){const je=document.createElement("canvas");je.width=r.width,je.height=r.height;const ke=je.getContext("2d");if(ke){ke.fillStyle="black",ke.fillRect(0,0,je.width,je.height),ke.font=`bold ${E}px sans-serif`,ke.fillStyle="white",ke.textBaseline="middle",ke.textAlign="center",ke.fillText("(C)  y-g-jiang.github.io",V,D);const ve=ke.getImageData(0,0,je.width,je.height).data;fe=new Uint16Array(r.data);const ge=fe.length;for(let Me=0;Me<ge;Me++)if(ve[Me*4]>128){let Oe=fe[Me]+B;Oe<0&&(Oe=0),Oe>65535&&(Oe=65535),fe[Me]=Oe}}else fe=new Uint16Array(r.data)}else fe=r.data;Q.globals.set("js_raw_bytes",new Uint8Array(fe.buffer,fe.byteOffset,fe.byteLength)),Q.globals.set("js_width",r.width),Q.globals.set("js_height",r.height),Q.globals.set("js_cfa",ee),Q.globals.set("js_bl_list",q),Q.globals.set("js_shift",v),Q.globals.set("js_linear_shift",k),Q.globals.set("js_cm_flat",re);const oe=await Q.runPythonAsync(`
                convert_to_dng(
                    js_raw_bytes.to_py(), 
                    js_width, 
                    js_height, 
                    js_cfa, 
                    js_bl_list.to_py(), 
                    js_shift,
                    js_linear_shift,
                    js_cm_flat.to_py()
                )
            `),ye=oe.toJs();oe.destroy();const ae=new Blob([ye],{type:"image/x-adobe-dng"}),X=URL.createObjectURL(ae),se=document.createElement("a");se.href=X;const he=n.substring(0,n.lastIndexOf("."))||"image",le=A?"_wm":"";se.download=`${he}_16bit_manual${le}.dng`,document.body.appendChild(se),se.click(),document.body.removeChild(se),URL.revokeObjectURL(X)}catch(Q){console.error(Q),alert("Export Failed: "+Q.message)}finally{u(!1)}}};return e?c.jsxs(ks,{initialPosition:{x:window.innerWidth/2-250,y:50},onClose:t,zIndex:a,onFocus:i,className:"w-[500px] bg-white dark:bg-black border-2 border-black dark:border-white shadow-2xl rounded-none flex flex-col font-mono max-h-[90vh] overflow-y-auto",children:[c.jsxs("div",{className:"flex justify-between items-center px-4 py-2 border-b-2 border-black dark:border-gray-500 bg-gray-200 dark:bg-gray-800",children:[c.jsx("h3",{className:"text-sm font-bold text-black dark:text-white uppercase tracking-widest",children:"16-bit DNG Workstation"}),c.jsx("button",{onClick:t,className:"text-black dark:text-white hover:text-red-600 transition-colors",children:c.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:3,d:"M6 18L18 6M6 6l12 12"})})})]}),c.jsx("div",{className:"p-6 flex flex-col gap-6",children:o?c.jsxs("div",{className:"flex flex-col items-center justify-center py-10 gap-4",children:[c.jsx("div",{className:"w-8 h-8 border-4 border-black dark:border-white border-t-transparent animate-spin"}),c.jsx("p",{className:"text-xs font-bold text-gray-500 animate-pulse"})]}):c.jsxs(c.Fragment,{children:[c.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[c.jsxs("div",{className:"flex flex-col gap-1",children:[c.jsx("label",{className:"text-[10px] font-bold text-gray-500 dark:text-gray-400 uppercase",children:"Width (Read Only)"}),c.jsx("input",{type:"text",readOnly:!0,value:(r==null?void 0:r.width)||0,className:"w-full bg-gray-100 dark:bg-gray-900 border border-black dark:border-gray-600 px-2 py-1 text-sm text-gray-400"})]}),c.jsxs("div",{className:"flex flex-col gap-1",children:[c.jsx("label",{className:"text-[10px] font-bold text-gray-500 dark:text-gray-400 uppercase",children:"Height (Read Only)"}),c.jsx("input",{type:"text",readOnly:!0,value:(r==null?void 0:r.height)||0,className:"w-full bg-gray-100 dark:bg-gray-900 border border-black dark:border-gray-600 px-2 py-1 text-sm text-gray-400"})]})]}),c.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[c.jsxs("div",{className:"col-span-1 flex flex-col gap-1",children:[c.jsx("label",{className:"text-[10px] font-bold text-cyan-600 dark:text-cyan-400 uppercase",children:"Bit Shift (<<)"}),c.jsx("input",{type:"number",value:v,onChange:Q=>b(parseInt(Q.target.value)||0),className:"w-full bg-white dark:bg-gray-800 border-2 border-black dark:border-gray-500 px-2 py-1 text-sm font-bold"})]}),c.jsxs("div",{className:"col-span-1 flex flex-col gap-1",children:[c.jsx("label",{className:"text-[10px] font-bold text-emerald-600 dark:text-emerald-400 uppercase",children:"Offset (+)"}),c.jsx("input",{type:"number",value:k,onChange:Q=>x(parseInt(Q.target.value)||0),className:"w-full bg-white dark:bg-gray-800 border-2 border-black dark:border-gray-500 px-2 py-1 text-sm font-bold"})]}),c.jsxs("div",{className:"col-span-1 flex flex-col gap-1",children:[c.jsx("label",{className:"text-[10px] font-bold text-gray-600 dark:text-gray-400 uppercase",children:"Pattern"}),c.jsxs("select",{value:j,onChange:Q=>M(Q.target.value),className:"w-full bg-white dark:bg-gray-800 border-2 border-black dark:border-gray-500 px-1 py-1 text-sm font-bold",children:[c.jsx("option",{value:"RGGB",children:"RGGB"}),c.jsx("option",{value:"BGGR",children:"BGGR"}),c.jsx("option",{value:"GBRG",children:"GBRG"}),c.jsx("option",{value:"GRBG",children:"GRBG"})]})]})]}),c.jsx("div",{className:"mt-[-10px] grid grid-cols-3 gap-4",children:c.jsx("div",{className:"text-[9px] text-gray-400 dark:text-gray-500 col-span-2",children:"Shift: 4=12bit(x16), 2=14bit(x4). Added after shift."})}),c.jsxs("div",{className:"flex flex-col gap-1",children:[c.jsx("label",{className:"text-[10px] font-bold text-indigo-600 dark:text-indigo-400 uppercase",children:"16bit Black Level (Manual Fill)"}),c.jsx("input",{type:"text",value:y,onChange:Q=>w(Q.target.value),placeholder:"R G1 B G2",className:"w-full bg-white dark:bg-gray-800 border-2 border-black dark:border-gray-500 px-2 py-1 text-sm font-bold font-mono placeholder:font-normal placeholder:text-gray-400"})]}),c.jsxs("div",{className:"flex flex-col gap-1",children:[c.jsxs("div",{className:"flex justify-between items-end",children:[c.jsx("label",{className:"text-[10px] font-bold text-gray-500 dark:text-gray-400 uppercase",children:"Color Matrix (XYZ to Raw - 9 Values)"}),c.jsxs("select",{className:"text-[10px] bg-gray-100 dark:bg-gray-800 border border-black dark:border-gray-500 rounded-none px-1 py-0.5 max-w-[180px] cursor-pointer",onChange:Q=>{const q=hc[Q.target.value];q&&S(q),Q.target.value=""},defaultValue:"",children:[c.jsx("option",{value:"",disabled:!0,children:"Select Camera Preset..."}),F.map(Q=>c.jsx("option",{value:Q,children:Q},Q))]})]}),c.jsx("textarea",{value:_,onChange:Q=>S(Q.target.value),placeholder:"e.g. 0.94 -0.39 -0.07 -0.28 1.09 0.22 -0.01 0.09 0.57",className:"w-full h-20 bg-white dark:bg-gray-800 border-2 border-black dark:border-gray-500 px-2 py-1 text-xs font-mono resize-none placeholder:font-normal placeholder:text-gray-400"}),c.jsx("span",{className:"text-[8px] text-gray-400 mt-0.5",children:"Enter 9 numbers separated by space or comma."})]}),c.jsxs("div",{className:"border border-gray-300 dark:border-gray-700 bg-gray-50 dark:bg-gray-900 rounded p-3",children:[c.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[c.jsx("input",{type:"checkbox",id:"enableWatermark",checked:A,onChange:Q=>$(Q.target.checked),className:"rounded border-gray-300 text-indigo-600 focus:ring-indigo-500"}),c.jsx("label",{htmlFor:"enableWatermark",className:"text-xs font-bold text-gray-700 dark:text-gray-300 select-none",children:"Add Watermark: (C)  y-g-jiang.github.io"})]}),A&&c.jsxs("div",{className:"space-y-2 animate-in slide-in-from-top-1",children:[c.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[c.jsxs("div",{className:"flex flex-col gap-1",children:[c.jsx("label",{className:"text-[9px] font-bold text-gray-500 dark:text-gray-400 uppercase",children:"Size (px)"}),c.jsx("input",{type:"number",value:E,onChange:Q=>T(Math.max(10,parseInt(Q.target.value)||10)),className:"w-full bg-white dark:bg-gray-800 border border-gray-400 dark:border-gray-600 px-2 py-1 text-xs"})]}),c.jsxs("div",{className:"flex flex-col gap-1",children:[c.jsx("label",{className:"text-[9px] font-bold text-gray-500 dark:text-gray-400 uppercase",children:"Depth (Shift DN)"}),c.jsx("input",{type:"number",value:B,onChange:Q=>U(parseInt(Q.target.value)||0),className:"w-full bg-white dark:bg-gray-800 border border-gray-400 dark:border-gray-600 px-2 py-1 text-xs",placeholder:"+/- value"})]})]}),c.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[c.jsxs("div",{className:"flex flex-col gap-1",children:[c.jsx("label",{className:"text-[9px] font-bold text-gray-500 dark:text-gray-400 uppercase",children:"Center X"}),c.jsx("input",{type:"number",value:V,onChange:Q=>G(parseInt(Q.target.value)||0),className:"w-full bg-white dark:bg-gray-800 border border-gray-400 dark:border-gray-600 px-2 py-1 text-xs"})]}),c.jsxs("div",{className:"flex flex-col gap-1",children:[c.jsx("label",{className:"text-[9px] font-bold text-gray-500 dark:text-gray-400 uppercase",children:"Center Y"}),c.jsx("input",{type:"number",value:D,onChange:Q=>I(parseInt(Q.target.value)||0),className:"w-full bg-white dark:bg-gray-800 border border-gray-400 dark:border-gray-600 px-2 py-1 text-xs"})]})]})]})]}),c.jsxs("div",{className:"flex gap-2",children:[c.jsx("input",{type:"file",ref:m,multiple:!0,className:"hidden",accept:".arw,.cr2,.cr3,.dng,.nef,.orf,.raf,.rw2,.pef,.srw,.sr2,.srf,.x3f,.erf,.mef,.mos,.mrw,.kdc,.dcr,.iiq,.3fr,.fff,.rwl,.nrw,.raw,.tif,.tiff",onChange:H}),c.jsx("button",{onClick:()=>{var Q;return(Q=m.current)==null?void 0:Q.click()},disabled:l,className:"flex-1 py-4 text-sm font-bold uppercase tracking-widest transition-all shadow-[4px_4px_0px_black] active:shadow-none active:translate-x-1 active:translate-y-1 bg-white dark:bg-slate-800 border-2 border-black dark:border-white text-black dark:text-white hover:bg-gray-100 dark:hover:bg-slate-700",children:"Batch Export (Files)"}),c.jsx("button",{onClick:W,disabled:l,className:`flex-[2] py-4 text-sm font-bold uppercase tracking-widest transition-all shadow-[4px_4px_0px_black] active:shadow-none active:translate-x-1 active:translate-y-1 ${l?"bg-gray-400 cursor-wait":"bg-cyan-600 hover:bg-cyan-500 text-white border-2 border-black"}`,children:l?"Processing...":"Export Single"})]}),f&&c.jsx("div",{className:"text-center text-xs font-bold text-cyan-600 dark:text-cyan-400 animate-pulse",children:f})]})})]}):null};async function RN(e={}){var Gb,zb,Wb;var t,r=e,n=!!globalThis.window,a=!!globalThis.WorkerGlobalScope,i=((zb=(Gb=globalThis.process)==null?void 0:Gb.versions)==null?void 0:zb.node)&&((Wb=globalThis.process)==null?void 0:Wb.type)!="renderer";if(i){const{createRequire:h}=await Dj(()=>import("./__vite-browser-external-BIHI7g3E.js"),[]);var o=h(import.meta.url)}var s="./this.program",l=(h,g)=>{throw g},u=import.meta.url,f="";function d(h){return r.locateFile?r.locateFile(h,f):f+h}var p,m;if(i){var v=o("fs");u.startsWith("file:")&&(f=o("path").dirname(o("url").fileURLToPath(u))+"/"),m=h=>{h=w(h)?new URL(h):h;var g=v.readFileSync(h);return g},p=async(h,g=!0)=>{h=w(h)?new URL(h):h;var P=v.readFileSync(h,g?void 0:"utf8");return P},process.argv.length>1&&(s=process.argv[1].replace(/\\/g,"/")),process.argv.slice(2),l=(h,g)=>{throw process.exitCode=h,g}}else if(n||a){try{f=new URL(".",u).href}catch{}a&&(m=h=>{var g=new XMLHttpRequest;return g.open("GET",h,!1),g.responseType="arraybuffer",g.send(null),new Uint8Array(g.response)}),p=async h=>{if(w(h))return new Promise((P,N)=>{var R=new XMLHttpRequest;R.open("GET",h,!0),R.responseType="arraybuffer",R.onload=()=>{if(R.status==200||R.status==0&&R.response){P(R.response);return}N(R.status)},R.onerror=N,R.send(null)});var g=await fetch(h,{credentials:"same-origin"});if(g.ok)return g.arrayBuffer();throw new Error(g.status+" : "+g.url)}}var b=console.log.bind(console),k=console.error.bind(console),x,y=!1,w=h=>h.startsWith("file://"),_,S,j,M,A,$,E,T,B,U,V,G,D=!1;function I(){var h=Ii.buffer;j=new Int8Array(h),A=new Int16Array(h),M=new Uint8Array(h),$=new Uint16Array(h),E=new Int32Array(h),T=new Uint32Array(h),B=new Float32Array(h),U=new Float64Array(h),V=new BigInt64Array(h),G=new BigUint64Array(h)}function F(){if(r.preRun)for(typeof r.preRun=="function"&&(r.preRun=[r.preRun]);r.preRun.length;)ve(r.preRun.shift());he(ke)}function H(){D=!0,!r.noFSInit&&!O.initialized&&O.init(),Cs.da(),O.ignorePermissions=!1}function W(){if(r.postRun)for(typeof r.postRun=="function"&&(r.postRun=[r.postRun]);r.postRun.length;)je(r.postRun.shift());he(le)}function Q(h){var P;(P=r.onAbort)==null||P.call(r,h),h="Aborted("+h+")",k(h),y=!0,h+=". Build with -sASSERTIONS for more info.";var g=new WebAssembly.RuntimeError(h);throw S==null||S(g),g}var q;function re(){return r.locateFile?d("joraw.wasm"):new URL("/assets/joraw-DraTMNgX.wasm",import.meta.url).href}function ee(h){if(h==q&&x)return new Uint8Array(x);if(m)return m(h);throw"both async and sync fetching of the wasm failed"}async function fe(h){if(!x)try{var g=await p(h);return new Uint8Array(g)}catch{}return ee(h)}async function oe(h,g){try{var P=await fe(h),N=await WebAssembly.instantiate(P,g);return N}catch(R){k(`failed to asynchronously prepare wasm: ${R}`),Q(R)}}async function ye(h,g,P){if(!h&&!w(g)&&!i)try{var N=fetch(g,{credentials:"same-origin"}),R=await WebAssembly.instantiateStreaming(N,P);return R}catch(z){k(`wasm streaming compile failed: ${z}`),k("falling back to ArrayBuffer instantiation")}return oe(g,P)}function ae(){var h={a:Ao};return h}async function X(){function h(z,K){return Cs=z.exports,Cs=BN(Cs),Ps(Cs),I(),Cs}function g(z){return h(z.instance)}var P=ae();if(r.instantiateWasm)return new Promise((z,K)=>{r.instantiateWasm(P,(ne,de)=>{z(h(ne))})});q??(q=re());var N=await ye(x,q,P),R=g(N);return R}class se{constructor(g){pr(this,"name","ExitStatus");this.message=`Program terminated with exit(${g})`,this.status=g}}var he=h=>{for(;h.length>0;)h.shift()(r)},le=[],je=h=>le.push(h),ke=[],ve=h=>ke.push(h),ge=!0,Me=h=>ra(h),Oe=()=>ro(),We=9007199254740992,Le=-9007199254740992,tt=h=>h<Le||h>We?NaN:Number(h),mt=globalThis.TextDecoder&&new TextDecoder,wt=(h,g,P,N)=>{var R=g+P;if(N)return R;for(;h[g]&&!(g>=R);)++g;return g},Qt=(h,g=0,P,N)=>{g>>>=0;var R=wt(h,g,P,N);if(R-g>16&&h.buffer&&mt)return mt.decode(h.subarray(g,R));for(var z="";g<R;){var K=h[g++];if(!(K&128)){z+=String.fromCharCode(K);continue}var ne=h[g++]&63;if((K&224)==192){z+=String.fromCharCode((K&31)<<6|ne);continue}var de=h[g++]&63;if((K&240)==224?K=(K&15)<<12|ne<<6|de:K=(K&7)<<18|ne<<12|de<<6|h[g++]&63,K<65536)z+=String.fromCharCode(K);else{var Ee=K-65536;z+=String.fromCharCode(55296|Ee>>10,56320|Ee&1023)}}return z},_t=(h,g,P)=>(h>>>=0,h?Qt(M,h,g,P):"");function Jt(h,g,P,N){return h>>>=0,g>>>=0,N>>>=0,Q(`Assertion failed: ${_t(h)}, at: `+[g?_t(g):"unknown filename",P,N?_t(N):"unknown function"])}class Nt{constructor(g){this.excPtr=g,this.ptr=g-24}set_type(g){T[this.ptr+4>>>2>>>0]=g}get_type(){return T[this.ptr+4>>>2>>>0]}set_destructor(g){T[this.ptr+8>>>2>>>0]=g}get_destructor(){return T[this.ptr+8>>>2>>>0]}set_caught(g){g=g?1:0,j[this.ptr+12>>>0]=g}get_caught(){return j[this.ptr+12>>>0]!=0}set_rethrown(g){g=g?1:0,j[this.ptr+13>>>0]=g}get_rethrown(){return j[this.ptr+13>>>0]!=0}init(g,P){this.set_adjusted_ptr(0),this.set_type(g),this.set_destructor(P)}set_adjusted_ptr(g){T[this.ptr+16>>>2>>>0]=g}get_adjusted_ptr(){return T[this.ptr+16>>>2>>>0]}}var er=0;function Vr(h,g,P){h>>>=0,g>>>=0,P>>>=0;var N=new Nt(h);throw N.init(g,P),er=h,er}var Tt=()=>{var h=E[+De.varargs>>>2>>>0];return De.varargs+=4,h},Sr=Tt,Ve={isAbs:h=>h.charAt(0)==="/",splitPath:h=>{var g=/^(\/?|)([\s\S]*?)((?:\.{1,2}|[^\/]+?|)(\.[^.\/]*|))(?:[\/]*)$/;return g.exec(h).slice(1)},normalizeArray:(h,g)=>{for(var P=0,N=h.length-1;N>=0;N--){var R=h[N];R==="."?h.splice(N,1):R===".."?(h.splice(N,1),P++):P&&(h.splice(N,1),P--)}if(g)for(;P;P--)h.unshift("..");return h},normalize:h=>{var g=Ve.isAbs(h),P=h.slice(-1)==="/";return h=Ve.normalizeArray(h.split("/").filter(N=>!!N),!g).join("/"),!h&&!g&&(h="."),h&&P&&(h+="/"),(g?"/":"")+h},dirname:h=>{var g=Ve.splitPath(h),P=g[0],N=g[1];return!P&&!N?".":(N&&(N=N.slice(0,-1)),P+N)},basename:h=>h&&h.match(/([^\/]+|\/)\/*$/)[1],join:(...h)=>Ve.normalize(h.join("/")),join2:(h,g)=>Ve.normalize(h+"/"+g)},Pt=()=>{if(i){var h=o("crypto");return g=>h.randomFillSync(g)}return g=>crypto.getRandomValues(g)},Bt=h=>{(Bt=Pt())(h)},Dt={resolve:(...h)=>{for(var g="",P=!1,N=h.length-1;N>=-1&&!P;N--){var R=N>=0?h[N]:O.cwd();if(typeof R!="string")throw new TypeError("Arguments to path.resolve must be strings");if(!R)return"";g=R+"/"+g,P=Ve.isAbs(R)}return g=Ve.normalizeArray(g.split("/").filter(z=>!!z),!P).join("/"),(P?"/":"")+g||"."},relative:(h,g)=>{h=Dt.resolve(h).slice(1),g=Dt.resolve(g).slice(1);function P(Ee){for(var Ye=0;Ye<Ee.length&&Ee[Ye]==="";Ye++);for(var it=Ee.length-1;it>=0&&Ee[it]==="";it--);return Ye>it?[]:Ee.slice(Ye,it-Ye+1)}for(var N=P(h.split("/")),R=P(g.split("/")),z=Math.min(N.length,R.length),K=z,ne=0;ne<z;ne++)if(N[ne]!==R[ne]){K=ne;break}for(var de=[],ne=K;ne<N.length;ne++)de.push("..");return de=de.concat(R.slice(K)),de.join("/")}},tr=[],rr=h=>{for(var g=0,P=0;P<h.length;++P){var N=h.charCodeAt(P);N<=127?g++:N<=2047?g+=2:N>=55296&&N<=57343?(g+=4,++P):g+=3}return g},Hr=(h,g,P,N)=>{if(P>>>=0,!(N>0))return 0;for(var R=P,z=P+N-1,K=0;K<h.length;++K){var ne=h.codePointAt(K);if(ne<=127){if(P>=z)break;g[P++>>>0]=ne}else if(ne<=2047){if(P+1>=z)break;g[P++>>>0]=192|ne>>6,g[P++>>>0]=128|ne&63}else if(ne<=65535){if(P+2>=z)break;g[P++>>>0]=224|ne>>12,g[P++>>>0]=128|ne>>6&63,g[P++>>>0]=128|ne&63}else{if(P+3>=z)break;g[P++>>>0]=240|ne>>18,g[P++>>>0]=128|ne>>12&63,g[P++>>>0]=128|ne>>6&63,g[P++>>>0]=128|ne&63,K++}}return g[P>>>0]=0,P-R},Ft=(h,g,P)=>{var N=rr(h)+1,R=new Array(N),z=Hr(h,R,0,R.length);return R.length=z,R},bn=()=>{var z;if(!tr.length){var h=null;if(i){var g=256,P=Buffer.alloc(g),N=0,R=process.stdin.fd;try{N=v.readSync(R,P,0,g)}catch(K){if(K.toString().includes("EOF"))N=0;else throw K}N>0&&(h=P.slice(0,N).toString("utf-8"))}else(z=globalThis.window)!=null&&z.prompt&&(h=window.prompt("Input: "),h!==null&&(h+=`
`));if(!h)return null;tr=Ft(h)}return tr.shift()},Ct={ttys:[],init(){},shutdown(){},register(h,g){Ct.ttys[h]={input:[],output:[],ops:g},O.registerDevice(h,Ct.stream_ops)},stream_ops:{open(h){var g=Ct.ttys[h.node.rdev];if(!g)throw new O.ErrnoError(43);h.tty=g,h.seekable=!1},close(h){h.tty.ops.fsync(h.tty)},fsync(h){h.tty.ops.fsync(h.tty)},read(h,g,P,N,R){if(!h.tty||!h.tty.ops.get_char)throw new O.ErrnoError(60);for(var z=0,K=0;K<N;K++){var ne;try{ne=h.tty.ops.get_char(h.tty)}catch{throw new O.ErrnoError(29)}if(ne===void 0&&z===0)throw new O.ErrnoError(6);if(ne==null)break;z++,g[P+K]=ne}return z&&(h.node.atime=Date.now()),z},write(h,g,P,N,R){if(!h.tty||!h.tty.ops.put_char)throw new O.ErrnoError(60);try{for(var z=0;z<N;z++)h.tty.ops.put_char(h.tty,g[P+z])}catch{throw new O.ErrnoError(29)}return N&&(h.node.mtime=h.node.ctime=Date.now()),z}},default_tty_ops:{get_char(h){return bn()},put_char(h,g){g===null||g===10?(b(Qt(h.output)),h.output=[]):g!=0&&h.output.push(g)},fsync(h){var g;((g=h.output)==null?void 0:g.length)>0&&(b(Qt(h.output)),h.output=[])},ioctl_tcgets(h){return{c_iflag:25856,c_oflag:5,c_cflag:191,c_lflag:35387,c_cc:[3,28,127,21,4,0,1,0,17,19,26,0,18,15,23,22,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]}},ioctl_tcsets(h,g,P){return 0},ioctl_tiocgwinsz(h){return[24,80]}},default_tty1_ops:{put_char(h,g){g===null||g===10?(k(Qt(h.output)),h.output=[]):g!=0&&h.output.push(g)},fsync(h){var g;((g=h.output)==null?void 0:g.length)>0&&(k(Qt(h.output)),h.output=[])}}},tn=h=>{Q()},Ge={ops_table:null,mount(h){return Ge.createNode(null,"/",16895,0)},createNode(h,g,P,N){if(O.isBlkdev(P)||O.isFIFO(P))throw new O.ErrnoError(63);Ge.ops_table||(Ge.ops_table={dir:{node:{getattr:Ge.node_ops.getattr,setattr:Ge.node_ops.setattr,lookup:Ge.node_ops.lookup,mknod:Ge.node_ops.mknod,rename:Ge.node_ops.rename,unlink:Ge.node_ops.unlink,rmdir:Ge.node_ops.rmdir,readdir:Ge.node_ops.readdir,symlink:Ge.node_ops.symlink},stream:{llseek:Ge.stream_ops.llseek}},file:{node:{getattr:Ge.node_ops.getattr,setattr:Ge.node_ops.setattr},stream:{llseek:Ge.stream_ops.llseek,read:Ge.stream_ops.read,write:Ge.stream_ops.write,mmap:Ge.stream_ops.mmap,msync:Ge.stream_ops.msync}},link:{node:{getattr:Ge.node_ops.getattr,setattr:Ge.node_ops.setattr,readlink:Ge.node_ops.readlink},stream:{}},chrdev:{node:{getattr:Ge.node_ops.getattr,setattr:Ge.node_ops.setattr},stream:O.chrdev_stream_ops}});var R=O.createNode(h,g,P,N);return O.isDir(R.mode)?(R.node_ops=Ge.ops_table.dir.node,R.stream_ops=Ge.ops_table.dir.stream,R.contents={}):O.isFile(R.mode)?(R.node_ops=Ge.ops_table.file.node,R.stream_ops=Ge.ops_table.file.stream,R.usedBytes=0,R.contents=null):O.isLink(R.mode)?(R.node_ops=Ge.ops_table.link.node,R.stream_ops=Ge.ops_table.link.stream):O.isChrdev(R.mode)&&(R.node_ops=Ge.ops_table.chrdev.node,R.stream_ops=Ge.ops_table.chrdev.stream),R.atime=R.mtime=R.ctime=Date.now(),h&&(h.contents[g]=R,h.atime=h.mtime=h.ctime=R.atime),R},getFileDataAsTypedArray(h){return h.contents?h.contents.subarray?h.contents.subarray(0,h.usedBytes):new Uint8Array(h.contents):new Uint8Array(0)},expandFileStorage(h,g){var P=h.contents?h.contents.length:0;if(!(P>=g)){var N=1024*1024;g=Math.max(g,P*(P<N?2:1.125)>>>0),P!=0&&(g=Math.max(g,256));var R=h.contents;h.contents=new Uint8Array(g),h.usedBytes>0&&h.contents.set(R.subarray(0,h.usedBytes),0)}},resizeFileStorage(h,g){if(h.usedBytes!=g)if(g==0)h.contents=null,h.usedBytes=0;else{var P=h.contents;h.contents=new Uint8Array(g),P&&h.contents.set(P.subarray(0,Math.min(g,h.usedBytes))),h.usedBytes=g}},node_ops:{getattr(h){var g={};return g.dev=O.isChrdev(h.mode)?h.id:1,g.ino=h.id,g.mode=h.mode,g.nlink=1,g.uid=0,g.gid=0,g.rdev=h.rdev,O.isDir(h.mode)?g.size=4096:O.isFile(h.mode)?g.size=h.usedBytes:O.isLink(h.mode)?g.size=h.link.length:g.size=0,g.atime=new Date(h.atime),g.mtime=new Date(h.mtime),g.ctime=new Date(h.ctime),g.blksize=4096,g.blocks=Math.ceil(g.size/g.blksize),g},setattr(h,g){for(const P of["mode","atime","mtime","ctime"])g[P]!=null&&(h[P]=g[P]);g.size!==void 0&&Ge.resizeFileStorage(h,g.size)},lookup(h,g){throw Ge.doesNotExistError||(Ge.doesNotExistError=new O.ErrnoError(44),Ge.doesNotExistError.stack="<generic error, no stack>"),Ge.doesNotExistError},mknod(h,g,P,N){return Ge.createNode(h,g,P,N)},rename(h,g,P){var N;try{N=O.lookupNode(g,P)}catch{}if(N){if(O.isDir(h.mode))for(var R in N.contents)throw new O.ErrnoError(55);O.hashRemoveNode(N)}delete h.parent.contents[h.name],g.contents[P]=h,h.name=P,g.ctime=g.mtime=h.parent.ctime=h.parent.mtime=Date.now()},unlink(h,g){delete h.contents[g],h.ctime=h.mtime=Date.now()},rmdir(h,g){var P=O.lookupNode(h,g);for(var N in P.contents)throw new O.ErrnoError(55);delete h.contents[g],h.ctime=h.mtime=Date.now()},readdir(h){return[".","..",...Object.keys(h.contents)]},symlink(h,g,P){var N=Ge.createNode(h,g,41471,0);return N.link=P,N},readlink(h){if(!O.isLink(h.mode))throw new O.ErrnoError(28);return h.link}},stream_ops:{read(h,g,P,N,R){var z=h.node.contents;if(R>=h.node.usedBytes)return 0;var K=Math.min(h.node.usedBytes-R,N);if(K>8&&z.subarray)g.set(z.subarray(R,R+K),P);else for(var ne=0;ne<K;ne++)g[P+ne]=z[R+ne];return K},write(h,g,P,N,R,z){if(g.buffer===j.buffer&&(z=!1),!N)return 0;var K=h.node;if(K.mtime=K.ctime=Date.now(),g.subarray&&(!K.contents||K.contents.subarray)){if(z)return K.contents=g.subarray(P,P+N),K.usedBytes=N,N;if(K.usedBytes===0&&R===0)return K.contents=g.slice(P,P+N),K.usedBytes=N,N;if(R+N<=K.usedBytes)return K.contents.set(g.subarray(P,P+N),R),N}if(Ge.expandFileStorage(K,R+N),K.contents.subarray&&g.subarray)K.contents.set(g.subarray(P,P+N),R);else for(var ne=0;ne<N;ne++)K.contents[R+ne]=g[P+ne];return K.usedBytes=Math.max(K.usedBytes,R+N),N},llseek(h,g,P){var N=g;if(P===1?N+=h.position:P===2&&O.isFile(h.node.mode)&&(N+=h.node.usedBytes),N<0)throw new O.ErrnoError(28);return N},mmap(h,g,P,N,R){if(!O.isFile(h.node.mode))throw new O.ErrnoError(43);var z,K,ne=h.node.contents;if(!(R&2)&&ne&&ne.buffer===j.buffer)K=!1,z=ne.byteOffset;else{if(K=!0,z=tn(),!z)throw new O.ErrnoError(48);ne&&((P>0||P+g<ne.length)&&(ne.subarray?ne=ne.subarray(P,P+g):ne=Array.prototype.slice.call(ne,P,P+g)),j.set(ne,z>>>0))}return{ptr:z,allocated:K}},msync(h,g,P,N,R){return Ge.stream_ops.write(h,g,0,N,P,!1),0}}},rn=h=>{var g={r:0,"r+":2,w:577,"w+":578,a:1089,"a+":1090},P=g[h];if(typeof P>"u")throw new Error(`Unknown file open mode: ${h}`);return P},Ar=(h,g)=>{var P=0;return h&&(P|=365),g&&(P|=146),P},sn=async h=>{var g=await p(h);return new Uint8Array(g)},Xr=(...h)=>O.createDataFile(...h),Tr=0,Cr=null,Er=h=>{var P;if(Tr--,(P=r.monitorRunDependencies)==null||P.call(r,Tr),Tr==0&&Cr){var g=Cr;Cr=null,g()}},wn=h=>{var g;Tr++,(g=r.monitorRunDependencies)==null||g.call(r,Tr)},kn=[],qt=async(h,g)=>{typeof Browser<"u"&&Browser.init();for(var P of kn)if(P.canHandle(g))return P.handle(h,g);return h},Et=async(h,g,P,N,R,z,K,ne)=>{var de=g?Dt.resolve(Ve.join2(h,g)):h;wn();try{var Ee=P;typeof P=="string"&&(Ee=await sn(P)),Ee=await qt(Ee,de),ne==null||ne(),z||Xr(h,g,Ee,N,R,K)}finally{Er()}},fr=(h,g,P,N,R,z,K,ne,de,Ee)=>{Et(h,g,P,N,R,ne,de,Ee).then(z).catch(K)},O={root:null,mounts:[],devices:{},streams:[],nextInode:1,nameTable:null,currentPath:"/",initialized:!1,ignorePermissions:!0,filesystems:null,syncFSRequests:0,readFiles:{},ErrnoError:class{constructor(h){pr(this,"name","ErrnoError");this.errno=h}},FSStream:class{constructor(){pr(this,"shared",{})}get object(){return this.node}set object(h){this.node=h}get isRead(){return(this.flags&2097155)!==1}get isWrite(){return(this.flags&2097155)!==0}get isAppend(){return this.flags&1024}get flags(){return this.shared.flags}set flags(h){this.shared.flags=h}get position(){return this.shared.position}set position(h){this.shared.position=h}},FSNode:class{constructor(h,g,P,N){pr(this,"node_ops",{});pr(this,"stream_ops",{});pr(this,"readMode",365);pr(this,"writeMode",146);pr(this,"mounted",null);h||(h=this),this.parent=h,this.mount=h.mount,this.id=O.nextInode++,this.name=g,this.mode=P,this.rdev=N,this.atime=this.mtime=this.ctime=Date.now()}get read(){return(this.mode&this.readMode)===this.readMode}set read(h){h?this.mode|=this.readMode:this.mode&=~this.readMode}get write(){return(this.mode&this.writeMode)===this.writeMode}set write(h){h?this.mode|=this.writeMode:this.mode&=~this.writeMode}get isFolder(){return O.isDir(this.mode)}get isDevice(){return O.isChrdev(this.mode)}},lookupPath(h,g={}){if(!h)throw new O.ErrnoError(44);g.follow_mount??(g.follow_mount=!0),Ve.isAbs(h)||(h=O.cwd()+"/"+h);e:for(var P=0;P<40;P++){for(var N=h.split("/").filter(Ee=>!!Ee),R=O.root,z="/",K=0;K<N.length;K++){var ne=K===N.length-1;if(ne&&g.parent)break;if(N[K]!=="."){if(N[K]===".."){if(z=Ve.dirname(z),O.isRoot(R)){h=z+"/"+N.slice(K+1).join("/"),P--;continue e}else R=R.parent;continue}z=Ve.join2(z,N[K]);try{R=O.lookupNode(R,N[K])}catch(Ee){if((Ee==null?void 0:Ee.errno)===44&&ne&&g.noent_okay)return{path:z};throw Ee}if(O.isMountpoint(R)&&(!ne||g.follow_mount)&&(R=R.mounted.root),O.isLink(R.mode)&&(!ne||g.follow)){if(!R.node_ops.readlink)throw new O.ErrnoError(52);var de=R.node_ops.readlink(R);Ve.isAbs(de)||(de=Ve.dirname(z)+"/"+de),h=de+"/"+N.slice(K+1).join("/");continue e}}}return{path:z,node:R}}throw new O.ErrnoError(32)},getPath(h){for(var g;;){if(O.isRoot(h)){var P=h.mount.mountpoint;return g?P[P.length-1]!=="/"?`${P}/${g}`:P+g:P}g=g?`${h.name}/${g}`:h.name,h=h.parent}},hashName(h,g){for(var P=0,N=0;N<g.length;N++)P=(P<<5)-P+g.charCodeAt(N)|0;return(h+P>>>0)%O.nameTable.length},hashAddNode(h){var g=O.hashName(h.parent.id,h.name);h.name_next=O.nameTable[g],O.nameTable[g]=h},hashRemoveNode(h){var g=O.hashName(h.parent.id,h.name);if(O.nameTable[g]===h)O.nameTable[g]=h.name_next;else for(var P=O.nameTable[g];P;){if(P.name_next===h){P.name_next=h.name_next;break}P=P.name_next}},lookupNode(h,g){var P=O.mayLookup(h);if(P)throw new O.ErrnoError(P);for(var N=O.hashName(h.id,g),R=O.nameTable[N];R;R=R.name_next){var z=R.name;if(R.parent.id===h.id&&z===g)return R}return O.lookup(h,g)},createNode(h,g,P,N){var R=new O.FSNode(h,g,P,N);return O.hashAddNode(R),R},destroyNode(h){O.hashRemoveNode(h)},isRoot(h){return h===h.parent},isMountpoint(h){return!!h.mounted},isFile(h){return(h&61440)===32768},isDir(h){return(h&61440)===16384},isLink(h){return(h&61440)===40960},isChrdev(h){return(h&61440)===8192},isBlkdev(h){return(h&61440)===24576},isFIFO(h){return(h&61440)===4096},isSocket(h){return(h&49152)===49152},flagsToPermissionString(h){var g=["r","w","rw"][h&3];return h&512&&(g+="w"),g},nodePermissions(h,g){return O.ignorePermissions?0:g.includes("r")&&!(h.mode&292)||g.includes("w")&&!(h.mode&146)||g.includes("x")&&!(h.mode&73)?2:0},mayLookup(h){if(!O.isDir(h.mode))return 54;var g=O.nodePermissions(h,"x");return g||(h.node_ops.lookup?0:2)},mayCreate(h,g){if(!O.isDir(h.mode))return 54;try{var P=O.lookupNode(h,g);return 20}catch{}return O.nodePermissions(h,"wx")},mayDelete(h,g,P){var N;try{N=O.lookupNode(h,g)}catch(z){return z.errno}var R=O.nodePermissions(h,"wx");if(R)return R;if(P){if(!O.isDir(N.mode))return 54;if(O.isRoot(N)||O.getPath(N)===O.cwd())return 10}else if(O.isDir(N.mode))return 31;return 0},mayOpen(h,g){return h?O.isLink(h.mode)?32:O.isDir(h.mode)&&(O.flagsToPermissionString(g)!=="r"||g&576)?31:O.nodePermissions(h,O.flagsToPermissionString(g)):44},checkOpExists(h,g){if(!h)throw new O.ErrnoError(g);return h},MAX_OPEN_FDS:4096,nextfd(){for(var h=0;h<=O.MAX_OPEN_FDS;h++)if(!O.streams[h])return h;throw new O.ErrnoError(33)},getStreamChecked(h){var g=O.getStream(h);if(!g)throw new O.ErrnoError(8);return g},getStream:h=>O.streams[h],createStream(h,g=-1){return h=Object.assign(new O.FSStream,h),g==-1&&(g=O.nextfd()),h.fd=g,O.streams[g]=h,h},closeStream(h){O.streams[h]=null},dupStream(h,g=-1){var N,R;var P=O.createStream(h,g);return(R=(N=P.stream_ops)==null?void 0:N.dup)==null||R.call(N,P),P},doSetAttr(h,g,P){var N=h==null?void 0:h.stream_ops.setattr,R=N?h:g;N??(N=g.node_ops.setattr),O.checkOpExists(N,63),N(R,P)},chrdev_stream_ops:{open(h){var P,N;var g=O.getDevice(h.node.rdev);h.stream_ops=g.stream_ops,(N=(P=h.stream_ops).open)==null||N.call(P,h)},llseek(){throw new O.ErrnoError(70)}},major:h=>h>>8,minor:h=>h&255,makedev:(h,g)=>h<<8|g,registerDevice(h,g){O.devices[h]={stream_ops:g}},getDevice:h=>O.devices[h],getMounts(h){for(var g=[],P=[h];P.length;){var N=P.pop();g.push(N),P.push(...N.mounts)}return g},syncfs(h,g){typeof h=="function"&&(g=h,h=!1),O.syncFSRequests++,O.syncFSRequests>1&&k(`warning: ${O.syncFSRequests} FS.syncfs operations in flight at once, probably just doing extra work`);var P=O.getMounts(O.root.mount),N=0;function R(ne){return O.syncFSRequests--,g(ne)}function z(ne){if(ne)return z.errored?void 0:(z.errored=!0,R(ne));++N>=P.length&&R(null)}for(var K of P)K.type.syncfs?K.type.syncfs(K,h,z):z(null)},mount(h,g,P){var N=P==="/",R=!P,z;if(N&&O.root)throw new O.ErrnoError(10);if(!N&&!R){var K=O.lookupPath(P,{follow_mount:!1});if(P=K.path,z=K.node,O.isMountpoint(z))throw new O.ErrnoError(10);if(!O.isDir(z.mode))throw new O.ErrnoError(54)}var ne={type:h,opts:g,mountpoint:P,mounts:[]},de=h.mount(ne);return de.mount=ne,ne.root=de,N?O.root=de:z&&(z.mounted=ne,z.mount&&z.mount.mounts.push(ne)),de},unmount(h){var g=O.lookupPath(h,{follow_mount:!1});if(!O.isMountpoint(g.node))throw new O.ErrnoError(28);var P=g.node,N=P.mounted,R=O.getMounts(N);for(var[z,K]of Object.entries(O.nameTable))for(;K;){var ne=K.name_next;R.includes(K.mount)&&O.destroyNode(K),K=ne}P.mounted=null;var de=P.mount.mounts.indexOf(N);P.mount.mounts.splice(de,1)},lookup(h,g){return h.node_ops.lookup(h,g)},mknod(h,g,P){var N=O.lookupPath(h,{parent:!0}),R=N.node,z=Ve.basename(h);if(!z)throw new O.ErrnoError(28);if(z==="."||z==="..")throw new O.ErrnoError(20);var K=O.mayCreate(R,z);if(K)throw new O.ErrnoError(K);if(!R.node_ops.mknod)throw new O.ErrnoError(63);return R.node_ops.mknod(R,z,g,P)},statfs(h){return O.statfsNode(O.lookupPath(h,{follow:!0}).node)},statfsStream(h){return O.statfsNode(h.node)},statfsNode(h){var g={bsize:4096,frsize:4096,blocks:1e6,bfree:5e5,bavail:5e5,files:O.nextInode,ffree:O.nextInode-1,fsid:42,flags:2,namelen:255};return h.node_ops.statfs&&Object.assign(g,h.node_ops.statfs(h.mount.opts.root)),g},create(h,g=438){return g&=4095,g|=32768,O.mknod(h,g,0)},mkdir(h,g=511){return g&=1023,g|=16384,O.mknod(h,g,0)},mkdirTree(h,g){var P=h.split("/"),N="";for(var R of P)if(R){(N||Ve.isAbs(h))&&(N+="/"),N+=R;try{O.mkdir(N,g)}catch(z){if(z.errno!=20)throw z}}},mkdev(h,g,P){return typeof P>"u"&&(P=g,g=438),g|=8192,O.mknod(h,g,P)},symlink(h,g){if(!Dt.resolve(h))throw new O.ErrnoError(44);var P=O.lookupPath(g,{parent:!0}),N=P.node;if(!N)throw new O.ErrnoError(44);var R=Ve.basename(g),z=O.mayCreate(N,R);if(z)throw new O.ErrnoError(z);if(!N.node_ops.symlink)throw new O.ErrnoError(63);return N.node_ops.symlink(N,R,h)},rename(h,g){var P=Ve.dirname(h),N=Ve.dirname(g),R=Ve.basename(h),z=Ve.basename(g),K,ne,de;if(K=O.lookupPath(h,{parent:!0}),ne=K.node,K=O.lookupPath(g,{parent:!0}),de=K.node,!ne||!de)throw new O.ErrnoError(44);if(ne.mount!==de.mount)throw new O.ErrnoError(75);var Ee=O.lookupNode(ne,R),Ye=Dt.relative(h,N);if(Ye.charAt(0)!==".")throw new O.ErrnoError(28);if(Ye=Dt.relative(g,P),Ye.charAt(0)!==".")throw new O.ErrnoError(55);var it;try{it=O.lookupNode(de,z)}catch{}if(Ee!==it){var et=O.isDir(Ee.mode),Fe=O.mayDelete(ne,R,et);if(Fe)throw new O.ErrnoError(Fe);if(Fe=it?O.mayDelete(de,z,et):O.mayCreate(de,z),Fe)throw new O.ErrnoError(Fe);if(!ne.node_ops.rename)throw new O.ErrnoError(63);if(O.isMountpoint(Ee)||it&&O.isMountpoint(it))throw new O.ErrnoError(10);if(de!==ne&&(Fe=O.nodePermissions(ne,"w"),Fe))throw new O.ErrnoError(Fe);O.hashRemoveNode(Ee);try{ne.node_ops.rename(Ee,de,z),Ee.parent=de}catch(Wt){throw Wt}finally{O.hashAddNode(Ee)}}},rmdir(h){var g=O.lookupPath(h,{parent:!0}),P=g.node,N=Ve.basename(h),R=O.lookupNode(P,N),z=O.mayDelete(P,N,!0);if(z)throw new O.ErrnoError(z);if(!P.node_ops.rmdir)throw new O.ErrnoError(63);if(O.isMountpoint(R))throw new O.ErrnoError(10);P.node_ops.rmdir(P,N),O.destroyNode(R)},readdir(h){var g=O.lookupPath(h,{follow:!0}),P=g.node,N=O.checkOpExists(P.node_ops.readdir,54);return N(P)},unlink(h){var g=O.lookupPath(h,{parent:!0}),P=g.node;if(!P)throw new O.ErrnoError(44);var N=Ve.basename(h),R=O.lookupNode(P,N),z=O.mayDelete(P,N,!1);if(z)throw new O.ErrnoError(z);if(!P.node_ops.unlink)throw new O.ErrnoError(63);if(O.isMountpoint(R))throw new O.ErrnoError(10);P.node_ops.unlink(P,N),O.destroyNode(R)},readlink(h){var g=O.lookupPath(h),P=g.node;if(!P)throw new O.ErrnoError(44);if(!P.node_ops.readlink)throw new O.ErrnoError(28);return P.node_ops.readlink(P)},stat(h,g){var P=O.lookupPath(h,{follow:!g}),N=P.node,R=O.checkOpExists(N.node_ops.getattr,63);return R(N)},fstat(h){var g=O.getStreamChecked(h),P=g.node,N=g.stream_ops.getattr,R=N?g:P;return N??(N=P.node_ops.getattr),O.checkOpExists(N,63),N(R)},lstat(h){return O.stat(h,!0)},doChmod(h,g,P,N){O.doSetAttr(h,g,{mode:P&4095|g.mode&-4096,ctime:Date.now(),dontFollow:N})},chmod(h,g,P){var N;if(typeof h=="string"){var R=O.lookupPath(h,{follow:!P});N=R.node}else N=h;O.doChmod(null,N,g,P)},lchmod(h,g){O.chmod(h,g,!0)},fchmod(h,g){var P=O.getStreamChecked(h);O.doChmod(P,P.node,g,!1)},doChown(h,g,P){O.doSetAttr(h,g,{timestamp:Date.now(),dontFollow:P})},chown(h,g,P,N){var R;if(typeof h=="string"){var z=O.lookupPath(h,{follow:!N});R=z.node}else R=h;O.doChown(null,R,N)},lchown(h,g,P){O.chown(h,g,P,!0)},fchown(h,g,P){var N=O.getStreamChecked(h);O.doChown(N,N.node,!1)},doTruncate(h,g,P){if(O.isDir(g.mode))throw new O.ErrnoError(31);if(!O.isFile(g.mode))throw new O.ErrnoError(28);var N=O.nodePermissions(g,"w");if(N)throw new O.ErrnoError(N);O.doSetAttr(h,g,{size:P,timestamp:Date.now()})},truncate(h,g){if(g<0)throw new O.ErrnoError(28);var P;if(typeof h=="string"){var N=O.lookupPath(h,{follow:!0});P=N.node}else P=h;O.doTruncate(null,P,g)},ftruncate(h,g){var P=O.getStreamChecked(h);if(g<0||!(P.flags&2097155))throw new O.ErrnoError(28);O.doTruncate(P,P.node,g)},utime(h,g,P){var N=O.lookupPath(h,{follow:!0}),R=N.node,z=O.checkOpExists(R.node_ops.setattr,63);z(R,{atime:g,mtime:P})},open(h,g,P=438){if(h==="")throw new O.ErrnoError(44);g=typeof g=="string"?rn(g):g,g&64?P=P&4095|32768:P=0;var N,R;if(typeof h=="object")N=h;else{R=h.endsWith("/");var z=O.lookupPath(h,{follow:!(g&131072),noent_okay:!0});N=z.node,h=z.path}var K=!1;if(g&64)if(N){if(g&128)throw new O.ErrnoError(20)}else{if(R)throw new O.ErrnoError(31);N=O.mknod(h,P|511,0),K=!0}if(!N)throw new O.ErrnoError(44);if(O.isChrdev(N.mode)&&(g&=-513),g&65536&&!O.isDir(N.mode))throw new O.ErrnoError(54);if(!K){var ne=O.mayOpen(N,g);if(ne)throw new O.ErrnoError(ne)}g&512&&!K&&O.truncate(N,0),g&=-131713;var de=O.createStream({node:N,path:O.getPath(N),flags:g,seekable:!0,position:0,stream_ops:N.stream_ops,ungotten:[],error:!1});return de.stream_ops.open&&de.stream_ops.open(de),K&&O.chmod(N,P&511),r.logReadFiles&&!(g&1)&&(h in O.readFiles||(O.readFiles[h]=1)),de},close(h){if(O.isClosed(h))throw new O.ErrnoError(8);h.getdents&&(h.getdents=null);try{h.stream_ops.close&&h.stream_ops.close(h)}catch(g){throw g}finally{O.closeStream(h.fd)}h.fd=null},isClosed(h){return h.fd===null},llseek(h,g,P){if(O.isClosed(h))throw new O.ErrnoError(8);if(!h.seekable||!h.stream_ops.llseek)throw new O.ErrnoError(70);if(P!=0&&P!=1&&P!=2)throw new O.ErrnoError(28);return h.position=h.stream_ops.llseek(h,g,P),h.ungotten=[],h.position},read(h,g,P,N,R){if(N<0||R<0)throw new O.ErrnoError(28);if(O.isClosed(h))throw new O.ErrnoError(8);if((h.flags&2097155)===1)throw new O.ErrnoError(8);if(O.isDir(h.node.mode))throw new O.ErrnoError(31);if(!h.stream_ops.read)throw new O.ErrnoError(28);var z=typeof R<"u";if(!z)R=h.position;else if(!h.seekable)throw new O.ErrnoError(70);var K=h.stream_ops.read(h,g,P,N,R);return z||(h.position+=K),K},write(h,g,P,N,R,z){if(N<0||R<0)throw new O.ErrnoError(28);if(O.isClosed(h))throw new O.ErrnoError(8);if(!(h.flags&2097155))throw new O.ErrnoError(8);if(O.isDir(h.node.mode))throw new O.ErrnoError(31);if(!h.stream_ops.write)throw new O.ErrnoError(28);h.seekable&&h.flags&1024&&O.llseek(h,0,2);var K=typeof R<"u";if(!K)R=h.position;else if(!h.seekable)throw new O.ErrnoError(70);var ne=h.stream_ops.write(h,g,P,N,R,z);return K||(h.position+=ne),ne},mmap(h,g,P,N,R){if(N&2&&!(R&2)&&(h.flags&2097155)!==2)throw new O.ErrnoError(2);if((h.flags&2097155)===1)throw new O.ErrnoError(2);if(!h.stream_ops.mmap)throw new O.ErrnoError(43);if(!g)throw new O.ErrnoError(28);return h.stream_ops.mmap(h,g,P,N,R)},msync(h,g,P,N,R){return h.stream_ops.msync?h.stream_ops.msync(h,g,P,N,R):0},ioctl(h,g,P){if(!h.stream_ops.ioctl)throw new O.ErrnoError(59);return h.stream_ops.ioctl(h,g,P)},readFile(h,g={}){g.flags=g.flags||0,g.encoding=g.encoding||"binary",g.encoding!=="utf8"&&g.encoding!=="binary"&&Q(`Invalid encoding type "${g.encoding}"`);var P=O.open(h,g.flags),N=O.stat(h),R=N.size,z=new Uint8Array(R);return O.read(P,z,0,R,0),g.encoding==="utf8"&&(z=Qt(z)),O.close(P),z},writeFile(h,g,P={}){P.flags=P.flags||577;var N=O.open(h,P.flags,P.mode);typeof g=="string"&&(g=new Uint8Array(Ft(g))),ArrayBuffer.isView(g)?O.write(N,g,0,g.byteLength,void 0,P.canOwn):Q("Unsupported data type"),O.close(N)},cwd:()=>O.currentPath,chdir(h){var g=O.lookupPath(h,{follow:!0});if(g.node===null)throw new O.ErrnoError(44);if(!O.isDir(g.node.mode))throw new O.ErrnoError(54);var P=O.nodePermissions(g.node,"x");if(P)throw new O.ErrnoError(P);O.currentPath=g.path},createDefaultDirectories(){O.mkdir("/tmp"),O.mkdir("/home"),O.mkdir("/home/web_user")},createDefaultDevices(){O.mkdir("/dev"),O.registerDevice(O.makedev(1,3),{read:()=>0,write:(N,R,z,K,ne)=>K,llseek:()=>0}),O.mkdev("/dev/null",O.makedev(1,3)),Ct.register(O.makedev(5,0),Ct.default_tty_ops),Ct.register(O.makedev(6,0),Ct.default_tty1_ops),O.mkdev("/dev/tty",O.makedev(5,0)),O.mkdev("/dev/tty1",O.makedev(6,0));var h=new Uint8Array(1024),g=0,P=()=>(g===0&&(Bt(h),g=h.byteLength),h[--g]);O.createDevice("/dev","random",P),O.createDevice("/dev","urandom",P),O.mkdir("/dev/shm"),O.mkdir("/dev/shm/tmp")},createSpecialDirectories(){O.mkdir("/proc");var h=O.mkdir("/proc/self");O.mkdir("/proc/self/fd"),O.mount({mount(){var g=O.createNode(h,"fd",16895,73);return g.stream_ops={llseek:Ge.stream_ops.llseek},g.node_ops={lookup(P,N){var R=+N,z=O.getStreamChecked(R),K={parent:null,mount:{mountpoint:"fake"},node_ops:{readlink:()=>z.path},id:R+1};return K.parent=K,K},readdir(){return Array.from(O.streams.entries()).filter(([P,N])=>N).map(([P,N])=>P.toString())}},g}},{},"/proc/self/fd")},createStandardStreams(h,g,P){h?O.createDevice("/dev","stdin",h):O.symlink("/dev/tty","/dev/stdin"),g?O.createDevice("/dev","stdout",null,g):O.symlink("/dev/tty","/dev/stdout"),P?O.createDevice("/dev","stderr",null,P):O.symlink("/dev/tty1","/dev/stderr"),O.open("/dev/stdin",0),O.open("/dev/stdout",1),O.open("/dev/stderr",1)},staticInit(){O.nameTable=new Array(4096),O.mount(Ge,{},"/"),O.createDefaultDirectories(),O.createDefaultDevices(),O.createSpecialDirectories(),O.filesystems={MEMFS:Ge}},init(h,g,P){O.initialized=!0,h??(h=r.stdin),g??(g=r.stdout),P??(P=r.stderr),O.createStandardStreams(h,g,P)},quit(){O.initialized=!1;for(var h of O.streams)h&&O.close(h)},findObject(h,g){var P=O.analyzePath(h,g);return P.exists?P.object:null},analyzePath(h,g){try{var P=O.lookupPath(h,{follow:!g});h=P.path}catch{}var N={isRoot:!1,exists:!1,error:0,name:null,path:null,object:null,parentExists:!1,parentPath:null,parentObject:null};try{var P=O.lookupPath(h,{parent:!0});N.parentExists=!0,N.parentPath=P.path,N.parentObject=P.node,N.name=Ve.basename(h),P=O.lookupPath(h,{follow:!g}),N.exists=!0,N.path=P.path,N.object=P.node,N.name=P.node.name,N.isRoot=P.path==="/"}catch(R){N.error=R.errno}return N},createPath(h,g,P,N){h=typeof h=="string"?h:O.getPath(h);for(var R=g.split("/").reverse();R.length;){var z=R.pop();if(z){var K=Ve.join2(h,z);try{O.mkdir(K)}catch(ne){if(ne.errno!=20)throw ne}h=K}}return K},createFile(h,g,P,N,R){var z=Ve.join2(typeof h=="string"?h:O.getPath(h),g),K=Ar(N,R);return O.create(z,K)},createDataFile(h,g,P,N,R,z){var K=g;h&&(h=typeof h=="string"?h:O.getPath(h),K=g?Ve.join2(h,g):h);var ne=Ar(N,R),de=O.create(K,ne);if(P){if(typeof P=="string"){for(var Ee=new Array(P.length),Ye=0,it=P.length;Ye<it;++Ye)Ee[Ye]=P.charCodeAt(Ye);P=Ee}O.chmod(de,ne|146);var et=O.open(de,577);O.write(et,P,0,P.length,0,z),O.close(et),O.chmod(de,ne)}},createDevice(h,g,P,N){var ne;var R=Ve.join2(typeof h=="string"?h:O.getPath(h),g),z=Ar(!!P,!!N);(ne=O.createDevice).major??(ne.major=64);var K=O.makedev(O.createDevice.major++,0);return O.registerDevice(K,{open(de){de.seekable=!1},close(de){var Ee;(Ee=N==null?void 0:N.buffer)!=null&&Ee.length&&N(10)},read(de,Ee,Ye,it,et){for(var Fe=0,Wt=0;Wt<it;Wt++){var wr;try{wr=P()}catch{throw new O.ErrnoError(29)}if(wr===void 0&&Fe===0)throw new O.ErrnoError(6);if(wr==null)break;Fe++,Ee[Ye+Wt]=wr}return Fe&&(de.node.atime=Date.now()),Fe},write(de,Ee,Ye,it,et){for(var Fe=0;Fe<it;Fe++)try{N(Ee[Ye+Fe])}catch{throw new O.ErrnoError(29)}return it&&(de.node.mtime=de.node.ctime=Date.now()),Fe}}),O.mkdev(R,z,K)},forceLoadFile(h){if(h.isDevice||h.isFolder||h.link||h.contents)return!0;if(globalThis.XMLHttpRequest)Q("Lazy loading should have been performed (contents set) in createLazyFile, but it was not. Lazy loading only works in web workers. Use --embed-file or --preload-file in emcc on the main thread.");else try{h.contents=m(h.url)}catch{throw new O.ErrnoError(29)}},createLazyFile(h,g,P,N,R){class z{constructor(){pr(this,"lengthKnown",!1);pr(this,"chunks",[])}get(et){if(!(et>this.length-1||et<0)){var Fe=et%this.chunkSize,Wt=et/this.chunkSize|0;return this.getter(Wt)[Fe]}}setDataGetter(et){this.getter=et}cacheLength(){var et=new XMLHttpRequest;et.open("HEAD",P,!1),et.send(null),et.status>=200&&et.status<300||et.status===304||Q("Couldn't load "+P+". Status: "+et.status);var Fe=Number(et.getResponseHeader("Content-length")),Wt,wr=(Wt=et.getResponseHeader("Accept-Ranges"))&&Wt==="bytes",pn=(Wt=et.getResponseHeader("Content-Encoding"))&&Wt==="gzip",gn=1024*1024;wr||(gn=Fe);var ya=(Ja,no)=>{Ja>no&&Q("invalid range ("+Ja+", "+no+") or no bytes requested!"),no>Fe-1&&Q("only "+Fe+" bytes available! programmer error!");var On=new XMLHttpRequest;return On.open("GET",P,!1),Fe!==gn&&On.setRequestHeader("Range","bytes="+Ja+"-"+no),On.responseType="arraybuffer",On.overrideMimeType&&On.overrideMimeType("text/plain; charset=x-user-defined"),On.send(null),On.status>=200&&On.status<300||On.status===304||Q("Couldn't load "+P+". Status: "+On.status),On.response!==void 0?new Uint8Array(On.response||[]):Ft(On.responseText||"")},ca=this;ca.setDataGetter(Ja=>{var no=Ja*gn,On=(Ja+1)*gn-1;return On=Math.min(On,Fe-1),typeof ca.chunks[Ja]>"u"&&(ca.chunks[Ja]=ya(no,On)),typeof ca.chunks[Ja]>"u"&&Q("doXHR failed!"),ca.chunks[Ja]}),(pn||!Fe)&&(gn=Fe=1,Fe=this.getter(0).length,gn=Fe,b("LazyFiles on gzip forces download of the whole file when length is accessed")),this._length=Fe,this._chunkSize=gn,this.lengthKnown=!0}get length(){return this.lengthKnown||this.cacheLength(),this._length}get chunkSize(){return this.lengthKnown||this.cacheLength(),this._chunkSize}}if(globalThis.XMLHttpRequest){a||Q("Cannot do synchronous binary XHRs outside webworkers in modern browsers. Use --embed-file or --preload-file in emcc");var K=new z,ne={isDevice:!1,contents:K}}else var ne={isDevice:!1,url:P};var de=O.createFile(h,g,ne,N,R);ne.contents?de.contents=ne.contents:ne.url&&(de.contents=null,de.url=ne.url),Object.defineProperties(de,{usedBytes:{get:function(){return this.contents.length}}});var Ee={};for(const[it,et]of Object.entries(de.stream_ops))Ee[it]=(...Fe)=>(O.forceLoadFile(de),et(...Fe));function Ye(it,et,Fe,Wt,wr){var pn=it.node.contents;if(wr>=pn.length)return 0;var gn=Math.min(pn.length-wr,Wt);if(pn.slice)for(var ya=0;ya<gn;ya++)et[Fe+ya]=pn[wr+ya];else for(var ya=0;ya<gn;ya++)et[Fe+ya]=pn.get(wr+ya);return gn}return Ee.read=(it,et,Fe,Wt,wr)=>(O.forceLoadFile(de),Ye(it,et,Fe,Wt,wr)),Ee.mmap=(it,et,Fe,Wt,wr)=>{O.forceLoadFile(de);var pn=tn();if(!pn)throw new O.ErrnoError(48);return Ye(it,j,pn,et,Fe),{ptr:pn,allocated:!0}},de.stream_ops=Ee,de}},De={DEFAULT_POLLMASK:5,calculateAt(h,g,P){if(Ve.isAbs(g))return g;var N;if(h===-100)N=O.cwd();else{var R=De.getStreamFromFD(h);N=R.path}if(g.length==0){if(!P)throw new O.ErrnoError(44);return N}return N+"/"+g},writeStat(h,g){T[h>>>2>>>0]=g.dev,T[h+4>>>2>>>0]=g.mode,T[h+8>>>2>>>0]=g.nlink,T[h+12>>>2>>>0]=g.uid,T[h+16>>>2>>>0]=g.gid,T[h+20>>>2>>>0]=g.rdev,V[h+24>>>3>>>0]=BigInt(g.size),E[h+32>>>2>>>0]=4096,E[h+36>>>2>>>0]=g.blocks;var P=g.atime.getTime(),N=g.mtime.getTime(),R=g.ctime.getTime();return V[h+40>>>3>>>0]=BigInt(Math.floor(P/1e3)),T[h+48>>>2>>>0]=P%1e3*1e3*1e3,V[h+56>>>3>>>0]=BigInt(Math.floor(N/1e3)),T[h+64>>>2>>>0]=N%1e3*1e3*1e3,V[h+72>>>3>>>0]=BigInt(Math.floor(R/1e3)),T[h+80>>>2>>>0]=R%1e3*1e3*1e3,V[h+88>>>3>>>0]=BigInt(g.ino),0},writeStatFs(h,g){T[h+4>>>2>>>0]=g.bsize,T[h+60>>>2>>>0]=g.bsize,V[h+8>>>3>>>0]=BigInt(g.blocks),V[h+16>>>3>>>0]=BigInt(g.bfree),V[h+24>>>3>>>0]=BigInt(g.bavail),V[h+32>>>3>>>0]=BigInt(g.files),V[h+40>>>3>>>0]=BigInt(g.ffree),T[h+48>>>2>>>0]=g.fsid,T[h+64>>>2>>>0]=g.flags,T[h+56>>>2>>>0]=g.namelen},doMsync(h,g,P,N,R){if(!O.isFile(g.node.mode))throw new O.ErrnoError(43);if(N&2)return 0;var z=M.slice(h,h+P);O.msync(g,z,R,P,N)},getStreamFromFD(h){var g=O.getStreamChecked(h);return g},varargs:void 0,getStr(h){var g=_t(h);return g}};function ht(h,g,P){P>>>=0,De.varargs=P;try{var N=De.getStreamFromFD(h);switch(g){case 0:{var R=Tt();if(R<0)return-28;for(;O.streams[R];)R++;var z;return z=O.dupStream(N,R),z.fd}case 1:case 2:return 0;case 3:return N.flags;case 4:{var R=Tt();return N.flags|=R,0}case 12:{var R=Sr(),K=0;return A[R+K>>>1>>>0]=2,0}case 13:case 14:return 0}return-28}catch(ne){if(typeof O>"u"||ne.name!=="ErrnoError")throw ne;return-ne.errno}}function Vt(h,g,P){P>>>=0,De.varargs=P;try{var N=De.getStreamFromFD(h);switch(g){case 21509:return N.tty?0:-59;case 21505:{if(!N.tty)return-59;if(N.tty.ops.ioctl_tcgets){var R=N.tty.ops.ioctl_tcgets(N),z=Sr();E[z>>>2>>>0]=R.c_iflag||0,E[z+4>>>2>>>0]=R.c_oflag||0,E[z+8>>>2>>>0]=R.c_cflag||0,E[z+12>>>2>>>0]=R.c_lflag||0;for(var K=0;K<32;K++)j[z+K+17>>>0]=R.c_cc[K]||0;return 0}return 0}case 21510:case 21511:case 21512:return N.tty?0:-59;case 21506:case 21507:case 21508:{if(!N.tty)return-59;if(N.tty.ops.ioctl_tcsets){for(var z=Sr(),ne=E[z>>>2>>>0],de=E[z+4>>>2>>>0],Ee=E[z+8>>>2>>>0],Ye=E[z+12>>>2>>>0],it=[],K=0;K<32;K++)it.push(j[z+K+17>>>0]);return N.tty.ops.ioctl_tcsets(N.tty,g,{c_iflag:ne,c_oflag:de,c_cflag:Ee,c_lflag:Ye,c_cc:it})}return 0}case 21519:{if(!N.tty)return-59;var z=Sr();return E[z>>>2>>>0]=0,0}case 21520:return N.tty?-28:-59;case 21537:case 21531:{var z=Sr();return O.ioctl(N,g,z)}case 21523:{if(!N.tty)return-59;if(N.tty.ops.ioctl_tiocgwinsz){var et=N.tty.ops.ioctl_tiocgwinsz(N.tty),z=Sr();A[z>>>1>>>0]=et[0],A[z+2>>>1>>>0]=et[1]}return 0}case 21524:return N.tty?0:-59;case 21515:return N.tty?0:-59;default:return-28}}catch(Fe){if(typeof O>"u"||Fe.name!=="ErrnoError")throw Fe;return-Fe.errno}}function $t(h,g,P,N){g>>>=0,N>>>=0,De.varargs=N;try{g=De.getStr(g),g=De.calculateAt(h,g);var R=N?Tt():0;return O.open(g,P,R).fd}catch(z){if(typeof O>"u"||z.name!=="ErrnoError")throw z;return-z.errno}}function mr(h){h>>>=0;try{return h=De.getStr(h),O.rmdir(h),0}catch(g){if(typeof O>"u"||g.name!=="ErrnoError")throw g;return-g.errno}}function $r(h,g,P){g>>>=0;try{if(g=De.getStr(g),g=De.calculateAt(h,g),!P)O.unlink(g);else if(P===512)O.rmdir(g);else return-28;return 0}catch(N){if(typeof O>"u"||N.name!=="ErrnoError")throw N;return-N.errno}}var nr=()=>Q(""),He=h=>{h>>>=0;for(var g="";;){var P=M[h++>>>0];if(!P)return g;g+=String.fromCharCode(P)}},pt={},It={},Ht={},Ut=class extends Error{constructor(g){super(g),this.name="BindingError"}},Se=h=>{throw new Ut(h)};function ln(h,g,P={}){var N=g.name;if(h||Se(`type "${N}" must have a positive integer typeid pointer`),It.hasOwnProperty(h)){if(P.ignoreDuplicateRegistrations)return;Se(`Cannot register type '${N}' twice`)}if(It[h]=g,delete Ht[h],pt.hasOwnProperty(h)){var R=pt[h];delete pt[h],R.forEach(z=>z())}}function L(h,g,P={}){return ln(h,g,P)}var we=(h,g,P)=>{switch(g){case 1:return P?N=>j[N>>>0]:N=>M[N>>>0];case 2:return P?N=>A[N>>>1>>>0]:N=>$[N>>>1>>>0];case 4:return P?N=>E[N>>>2>>>0]:N=>T[N>>>2>>>0];case 8:return P?N=>V[N>>>3>>>0]:N=>G[N>>>3>>>0];default:throw new TypeError(`invalid integer width (${g}): ${h}`)}},Ne=function(h,g,P,N,R){h>>>=0,g>>>=0,P>>>=0,g=He(g);const z=N===0n;let K=ne=>ne;if(z){const ne=P*8;K=de=>BigInt.asUintN(ne,de),R=K(R)}L(h,{name:g,fromWireType:K,toWireType:(ne,de)=>(typeof de=="number"&&(de=BigInt(de)),de),readValueFromPointer:we(g,P,!z),destructorFunction:null})};function gt(h,g,P,N){h>>>=0,g>>>=0,g=He(g),L(h,{name:g,fromWireType:function(R){return!!R},toWireType:function(R,z){return z?P:N},readValueFromPointer:function(R){return this.fromWireType(M[R>>>0])},destructorFunction:null})}var Xe=h=>({count:h.count,deleteScheduled:h.deleteScheduled,preservePointerOnDelete:h.preservePointerOnDelete,ptr:h.ptr,ptrType:h.ptrType,smartPtr:h.smartPtr,smartPtrType:h.smartPtrType}),ot=h=>{function g(P){return P.$$.ptrType.registeredClass.name}Se(g(h)+" instance already deleted")},ct=!1,Yt=h=>{},xr=h=>{h.smartPtr?h.smartPtrType.rawDestructor(h.smartPtr):h.ptrType.registeredClass.rawDestructor(h.ptr)},hn=h=>{h.count.value-=1;var g=h.count.value===0;g&&xr(h)},Gt=h=>globalThis.FinalizationRegistry?(ct=new FinalizationRegistry(g=>{hn(g.$$)}),Gt=g=>{var P=g.$$,N=!!P.smartPtr;if(N){var R={$$:P};ct.register(g,R,g)}return g},Yt=g=>ct.unregister(g),Gt(h)):(Gt=g=>g,h),Sn=()=>{let h=jn.prototype;Object.assign(h,{isAliasOf(P){if(!(this instanceof jn)||!(P instanceof jn))return!1;var N=this.$$.ptrType.registeredClass,R=this.$$.ptr;P.$$=P.$$;for(var z=P.$$.ptrType.registeredClass,K=P.$$.ptr;N.baseClass;)R=N.upcast(R),N=N.baseClass;for(;z.baseClass;)K=z.upcast(K),z=z.baseClass;return N===z&&R===K},clone(){if(this.$$.ptr||ot(this),this.$$.preservePointerOnDelete)return this.$$.count.value+=1,this;var P=Gt(Object.create(Object.getPrototypeOf(this),{$$:{value:Xe(this.$$)}}));return P.$$.count.value+=1,P.$$.deleteScheduled=!1,P},delete(){this.$$.ptr||ot(this),this.$$.deleteScheduled&&!this.$$.preservePointerOnDelete&&Se("Object already scheduled for deletion"),Yt(this),hn(this.$$),this.$$.preservePointerOnDelete||(this.$$.smartPtr=void 0,this.$$.ptr=void 0)},isDeleted(){return!this.$$.ptr},deleteLater(){return this.$$.ptr||ot(this),this.$$.deleteScheduled&&!this.$$.preservePointerOnDelete&&Se("Object already scheduled for deletion"),this.$$.deleteScheduled=!0,this}});const g=Symbol.dispose;g&&(h[g]=h.delete)};function jn(){}var Zn=(h,g)=>Object.defineProperty(g,"name",{value:h}),or={},sr=(h,g,P)=>{if(h[g].overloadTable===void 0){var N=h[g];h[g]=function(...R){return h[g].overloadTable.hasOwnProperty(R.length)||Se(`Function '${P}' called with an invalid number of arguments (${R.length}) - expects one of (${h[g].overloadTable})!`),h[g].overloadTable[R.length].apply(this,R)},h[g].overloadTable=[],h[g].overloadTable[N.argCount]=N}},yr=(h,g,P)=>{r.hasOwnProperty(h)?(Se(`Cannot register public name '${h}' twice`),sr(r,h,h),r[h].overloadTable.hasOwnProperty(P)&&Se(`Cannot register multiple overloads of a function with the same number of arguments (${P})!`),r[h].overloadTable[P]=g):(r[h]=g,r[h].argCount=P)},Be=48,Zt=57,jr=h=>{h=h.replace(/[^a-zA-Z0-9_]/g,"$");var g=h.charCodeAt(0);return g>=Be&&g<=Zt?`_${h}`:h};function Qn(h,g,P,N,R,z,K,ne){this.name=h,this.constructor=g,this.instancePrototype=P,this.rawDestructor=N,this.baseClass=R,this.getActualType=z,this.upcast=K,this.downcast=ne,this.pureVirtualFunctions=[]}var Jn=(h,g,P)=>{for(;g!==P;)g.upcast||Se(`Expected null or instance of ${P.name}, got an instance of ${g.name}`),h=g.upcast(h),g=g.baseClass;return h},Kr=h=>{if(h===null)return"null";var g=typeof h;return g==="object"||g==="array"||g==="function"?h.toString():""+h};function qa(h,g){if(g===null)return this.isReference&&Se(`null is not a valid ${this.name}`),0;g.$$||Se(`Cannot pass "${Kr(g)}" as a ${this.name}`),g.$$.ptr||Se(`Cannot pass deleted object as a pointer of type ${this.name}`);var P=g.$$.ptrType.registeredClass,N=Jn(g.$$.ptr,P,this.registeredClass);return N}function te(h,g){var P;if(g===null)return this.isReference&&Se(`null is not a valid ${this.name}`),this.isSmartPointer?(P=this.rawConstructor(),h!==null&&h.push(this.rawDestructor,P),P):0;(!g||!g.$$)&&Se(`Cannot pass "${Kr(g)}" as a ${this.name}`),g.$$.ptr||Se(`Cannot pass deleted object as a pointer of type ${this.name}`),!this.isConst&&g.$$.ptrType.isConst&&Se(`Cannot convert argument of type ${g.$$.smartPtrType?g.$$.smartPtrType.name:g.$$.ptrType.name} to parameter type ${this.name}`);var N=g.$$.ptrType.registeredClass;if(P=Jn(g.$$.ptr,N,this.registeredClass),this.isSmartPointer)switch(g.$$.smartPtr===void 0&&Se("Passing raw pointer to smart pointer is illegal"),this.sharingPolicy){case 0:g.$$.smartPtrType===this?P=g.$$.smartPtr:Se(`Cannot convert argument of type ${g.$$.smartPtrType?g.$$.smartPtrType.name:g.$$.ptrType.name} to parameter type ${this.name}`);break;case 1:P=g.$$.smartPtr;break;case 2:if(g.$$.smartPtrType===this)P=g.$$.smartPtr;else{var R=g.clone();P=this.rawShare(P,vt.toHandle(()=>R.delete())),h!==null&&h.push(this.rawDestructor,P)}break;default:Se("Unsupporting sharing policy")}return P}function me(h,g){if(g===null)return this.isReference&&Se(`null is not a valid ${this.name}`),0;g.$$||Se(`Cannot pass "${Kr(g)}" as a ${this.name}`),g.$$.ptr||Se(`Cannot pass deleted object as a pointer of type ${this.name}`),g.$$.ptrType.isConst&&Se(`Cannot convert argument of type ${g.$$.ptrType.name} to parameter type ${this.name}`);var P=g.$$.ptrType.registeredClass,N=Jn(g.$$.ptr,P,this.registeredClass);return N}function be(h){return this.fromWireType(T[h>>>2>>>0])}var Y=(h,g,P)=>{if(g===P)return h;if(P.baseClass===void 0)return null;var N=Y(h,g,P.baseClass);return N===null?null:P.downcast(N)},Ae={},at=(h,g)=>{for(g===void 0&&Se("ptr should not be undefined");h.baseClass;)g=h.upcast(g),h=h.baseClass;return g},rt=(h,g)=>(g=at(h,g),Ae[g]),Lt=class extends Error{constructor(g){super(g),this.name="InternalError"}},dt=h=>{throw new Lt(h)},yt=(h,g)=>{(!g.ptrType||!g.ptr)&&dt("makeClassHandle requires ptr and ptrType");var P=!!g.smartPtrType,N=!!g.smartPtr;return P!==N&&dt("Both smartPtrType and smartPtr must be specified"),g.count={value:1},Gt(Object.create(h,{$$:{value:g,writable:!0}}))};function dr(h){var g=this.getPointee(h);if(!g)return this.destructor(h),null;var P=rt(this.registeredClass,g);if(P!==void 0){if(P.$$.count.value===0)return P.$$.ptr=g,P.$$.smartPtr=h,P.clone();var N=P.clone();return this.destructor(h),N}function R(){return this.isSmartPointer?yt(this.registeredClass.instancePrototype,{ptrType:this.pointeeType,ptr:g,smartPtrType:this,smartPtr:h}):yt(this.registeredClass.instancePrototype,{ptrType:this,ptr:h})}var z=this.registeredClass.getActualType(g),K=or[z];if(!K)return R.call(this);var ne;this.isConst?ne=K.constPointerType:ne=K.pointerType;var de=Y(g,this.registeredClass,ne.registeredClass);return de===null?R.call(this):this.isSmartPointer?yt(ne.registeredClass.instancePrototype,{ptrType:ne,ptr:de,smartPtrType:this,smartPtr:h}):yt(ne.registeredClass.instancePrototype,{ptrType:ne,ptr:de})}var ar=()=>{Object.assign(cr.prototype,{getPointee(h){return this.rawGetPointee&&(h=this.rawGetPointee(h)),h},destructor(h){var g;(g=this.rawDestructor)==null||g.call(this,h)},readValueFromPointer:be,fromWireType:dr})};function cr(h,g,P,N,R,z,K,ne,de,Ee,Ye){this.name=h,this.registeredClass=g,this.isReference=P,this.isConst=N,this.isSmartPointer=R,this.pointeeType=z,this.sharingPolicy=K,this.rawGetPointee=ne,this.rawConstructor=de,this.rawShare=Ee,this.rawDestructor=Ye,!R&&g.baseClass===void 0?N?(this.toWireType=qa,this.destructorFunction=null):(this.toWireType=me,this.destructorFunction=null):this.toWireType=te}var hr=(h,g,P)=>{r.hasOwnProperty(h)||dt("Replacing nonexistent public symbol"),r[h].overloadTable!==void 0&&P!==void 0||(r[h]=g,r[h].argCount=P)},Pe=[],ut=h=>{var g=Pe[h];return g||(Pe[h]=g=La.get(h)),g},Qe=(h,g,P=[],N=!1)=>{var R=ut(g),z=R(...P);function K(ne){return h[0]=="p"?ne>>>0:ne}return K(z)},Je=(h,g,P=!1)=>(...N)=>Qe(h,g,N,P),Xt=(h,g,P=!1)=>{h=He(h);function N(){if(h.includes("p"))return Je(h,g,P);var z=ut(g);return z}var R=N();return typeof R!="function"&&Se(`unknown function pointer with signature ${h}: ${g}`),R};class lt extends Error{}var zt=h=>{var g=nn(h),P=He(g);return Gr(g),P},Nr=(h,g)=>{var P=[],N={};function R(z){if(!N[z]&&!It[z]){if(Ht[z]){Ht[z].forEach(R);return}P.push(z),N[z]=!0}}throw g.forEach(R),new lt(`${h}: `+P.map(zt).join([", "]))},Dr=(h,g,P)=>{h.forEach(ne=>Ht[ne]=g);function N(ne){var de=P(ne);de.length!==h.length&&dt("Mismatched type converter count");for(var Ee=0;Ee<h.length;++Ee)L(h[Ee],de[Ee])}var R=new Array(g.length),z=[],K=0;for(let[ne,de]of g.entries())It.hasOwnProperty(de)?R[ne]=It[de]:(z.push(de),pt.hasOwnProperty(de)||(pt[de]=[]),pt[de].push(()=>{R[ne]=It[de],++K,K===z.length&&N(R)}));z.length===0&&N(R)};function ma(h,g,P,N,R,z,K,ne,de,Ee,Ye,it,et){h>>>=0,g>>>=0,P>>>=0,N>>>=0,R>>>=0,z>>>=0,K>>>=0,ne>>>=0,de>>>=0,Ee>>>=0,Ye>>>=0,it>>>=0,et>>>=0,Ye=He(Ye),z=Xt(R,z),ne&&(ne=Xt(K,ne)),Ee&&(Ee=Xt(de,Ee)),et=Xt(it,et);var Fe=jr(Ye);yr(Fe,function(){Nr(`Cannot construct ${Ye} due to unbound types`,[N])}),Dr([h,g,P],N?[N]:[],Wt=>{var Vb;Wt=Wt[0];var wr,pn;N?(wr=Wt.registeredClass,pn=wr.instancePrototype):pn=jn.prototype;var gn=Zn(Ye,function(...Ig){if(Object.getPrototypeOf(this)!==ya)throw new Ut(`Use 'new' to construct ${Ye}`);if(ca.constructor_body===void 0)throw new Ut(`${Ye} has no accessible constructor`);var Hb=ca.constructor_body[Ig.length];if(Hb===void 0)throw new Ut(`Tried to invoke ctor of ${Ye} with invalid number of parameters (${Ig.length}) - expected (${Object.keys(ca.constructor_body).toString()}) parameters instead!`);return Hb.apply(this,Ig)}),ya=Object.create(pn,{constructor:{value:gn}});gn.prototype=ya;var ca=new Qn(Ye,gn,ya,et,wr,z,ne,Ee);ca.baseClass&&((Vb=ca.baseClass).__derivedClasses??(Vb.__derivedClasses=[]),ca.baseClass.__derivedClasses.push(ca));var Ja=new cr(Ye,ca,!0,!1,!1),no=new cr(Ye+"*",ca,!1,!1,!1),On=new cr(Ye+" const*",ca,!1,!0,!1);return or[h]={pointerType:no,constPointerType:On},hr(Fe,gn),[Ja,no,On]})}var mi=(h,g)=>{for(var P=[],N=0;N<h;N++)P.push(T[g+N*4>>>2>>>0]);return P},Oo=h=>{for(;h.length;){var g=h.pop(),P=h.pop();P(g)}};function yi(h){for(var g=1;g<h.length;++g)if(h[g]!==null&&h[g].destructorFunction===void 0)return!0;return!1}function Ya(h,g,P,N){var R=yi(h),z=h.length-2,K=[],ne=["fn"];g&&ne.push("thisWired");for(var de=0;de<z;++de)K.push(`arg${de}`),ne.push(`arg${de}Wired`);K=K.join(","),ne=ne.join(",");var Ee=`return function (${K}) {
`;R&&(Ee+=`var destructors = [];
`);var Ye=R?"destructors":"null",it=["humanName","throwBindingError","invoker","fn","runDestructors","fromRetWire","toClassParamWire"];g&&(Ee+=`var thisWired = toClassParamWire(${Ye}, this);
`);for(var de=0;de<z;++de){var et=`toArg${de}Wire`;Ee+=`var arg${de}Wired = ${et}(${Ye}, arg${de});
`,it.push(et)}if(Ee+=(P||N?"var rv = ":"")+`invoker(${ne});
`,R)Ee+=`runDestructors(destructors);
`;else for(var de=g?1:2;de<h.length;++de){var Fe=de===1?"thisWired":"arg"+(de-2)+"Wired";h[de].destructorFunction!==null&&(Ee+=`${Fe}_dtor(${Fe});
`,it.push(`${Fe}_dtor`))}return P&&(Ee+=`var ret = fromRetWire(rv);
return ret;
`),Ee+=`}
`,new Function(it,Ee)}function Ia(h,g,P,N,R,z){var K=g.length;K<2&&Se("argTypes array size mismatch! Must at least get return value and 'this' types!");for(var ne=g[1]!==null&&P!==null,de=yi(g),Ee=!g[0].isVoid,Ye=g[0],it=g[1],et=[h,Se,N,R,Oo,Ye.fromWireType.bind(Ye),it==null?void 0:it.toWireType.bind(it)],Fe=2;Fe<K;++Fe){var Wt=g[Fe];et.push(Wt.toWireType.bind(Wt))}if(!de)for(var Fe=ne?1:2;Fe<g.length;++Fe)g[Fe].destructorFunction!==null&&et.push(g[Fe].destructorFunction);var pn=Ya(g,ne,Ee,z)(...et);return Zn(h,pn)}var Dn=function(h,g,P,N,R,z){h>>>=0,P>>>=0,N>>>=0,R>>>=0,z>>>=0;var K=mi(g,P);R=Xt(N,R),Dr([],[h],ne=>{ne=ne[0];var de=`constructor ${ne.name}`;if(ne.registeredClass.constructor_body===void 0&&(ne.registeredClass.constructor_body=[]),ne.registeredClass.constructor_body[g-1]!==void 0)throw new Ut(`Cannot register multiple constructors with identical number of parameters (${g-1}) for class '${ne.name}'! Overload resolution is currently only performed using the parameter count, not actual type info!`);return ne.registeredClass.constructor_body[g-1]=()=>{Nr(`Cannot construct ${ne.name} due to unbound types`,K)},Dr([],K,Ee=>(Ee.splice(1,0,null),ne.registeredClass.constructor_body[g-1]=Ia(de,Ee,null,R,z),[])),[]})},Ss=h=>{h=h.trim();const g=h.indexOf("(");return g===-1?h:h.slice(0,g)},Ri=function(h,g,P,N,R,z,K,ne,de,Ee){h>>>=0,g>>>=0,N>>>=0,R>>>=0,z>>>=0,K>>>=0;var Ye=mi(P,N);g=He(g),g=Ss(g),z=Xt(R,z,de),Dr([],[h],it=>{it=it[0];var et=`${it.name}.${g}`;g.startsWith("@@")&&(g=Symbol[g.substring(2)]),ne&&it.registeredClass.pureVirtualFunctions.push(g);function Fe(){Nr(`Cannot call ${et} due to unbound types`,Ye)}var Wt=it.registeredClass.instancePrototype,wr=Wt[g];return wr===void 0||wr.overloadTable===void 0&&wr.className!==it.name&&wr.argCount===P-2?(Fe.argCount=P-2,Fe.className=it.name,Wt[g]=Fe):(sr(Wt,g,et),Wt[g].overloadTable[P-2]=Fe),Dr([],Ye,pn=>{var gn=Ia(et,pn,it,z,K,de);return Wt[g].overloadTable===void 0?(gn.argCount=P-2,Wt[g]=gn):Wt[g].overloadTable[P-2]=gn,[]}),[]})},ie=[],_e=[0,1,,1,null,1,!0,1,!1,1];function kt(h){h>>>=0,h>9&&--_e[h+1]===0&&(_e[h]=void 0,ie.push(h))}var vt={toValue:h=>(h||Se(`Cannot use deleted val. handle = ${h}`),_e[h]),toHandle:h=>{switch(h){case void 0:return 2;case null:return 4;case!0:return 6;case!1:return 8;default:{const g=ie.pop()||_e.length;return _e[g]=h,_e[g+1]=1,g}}}},Ir={name:"emscripten::val",fromWireType:h=>{var g=vt.toValue(h);return kt(h),g},toWireType:(h,g)=>vt.toHandle(g),readValueFromPointer:be,destructorFunction:null};function _n(h){return h>>>=0,L(h,Ir)}var br=(h,g)=>{switch(g){case 4:return function(P){return this.fromWireType(B[P>>>2>>>0])};case 8:return function(P){return this.fromWireType(U[P>>>3>>>0])};default:throw new TypeError(`invalid float width (${g}): ${h}`)}},Ie=function(h,g,P){h>>>=0,g>>>=0,P>>>=0,g=He(g),L(h,{name:g,fromWireType:N=>N,toWireType:(N,R)=>R,readValueFromPointer:br(g,P),destructorFunction:null})},Mt=function(h,g,P,N,R){h>>>=0,g>>>=0,P>>>=0,g=He(g);const z=N===0;let K=de=>de;if(z){var ne=32-8*P;K=de=>de<<ne>>>ne,R=K(R)}L(h,{name:g,fromWireType:K,toWireType:(de,Ee)=>Ee,readValueFromPointer:we(g,P,N!==0),destructorFunction:null})};function St(h,g,P){h>>>=0,P>>>=0;var N=[Int8Array,Uint8Array,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array,BigInt64Array,BigUint64Array],R=N[g];function z(K){var ne=T[K>>>2>>>0],de=T[K+4>>>2>>>0];return new R(j.buffer,de,ne)}P=He(P),L(h,{name:P,fromWireType:z,readValueFromPointer:z},{ignoreDuplicateRegistrations:!0})}var xt=Object.assign({optional:!0},Ir);function qr(h,g){h>>>=0,L(h,xt)}var Kt=(h,g,P)=>Hr(h,M,g,P);function ea(h,g){h>>>=0,g>>>=0,g=He(g),L(h,{name:g,fromWireType(P){var N=T[P>>>2>>>0],R=P+4,z;return z=_t(R,N,!0),Gr(P),z},toWireType(P,N){N instanceof ArrayBuffer&&(N=new Uint8Array(N));var R,z=typeof N=="string";z||ArrayBuffer.isView(N)&&N.BYTES_PER_ELEMENT==1||Se("Cannot pass non-string to std::string"),z?R=rr(N):R=N.length;var K=Ca(4+R+1),ne=K+4;return T[K>>>2>>>0]=R,z?Kt(N,ne,R+1):M.set(N,ne>>>0),P!==null&&P.push(Gr,K),K},readValueFromPointer:be,destructorFunction(P){Gr(P)}})}var Za=globalThis.TextDecoder?new TextDecoder("utf-16le"):void 0,Di=(h,g,P)=>{var N=h>>>1,R=wt($,N,g/2,P);if(R-N>16&&Za)return Za.decode($.subarray(N>>>0,R>>>0));for(var z="",K=N;K<R;++K){var ne=$[K>>>0];z+=String.fromCharCode(ne)}return z},Qa=(h,g,P)=>{if(P??(P=2147483647),P<2)return 0;P-=2;for(var N=g,R=P<h.length*2?P/2:h.length,z=0;z<R;++z){var K=h.charCodeAt(z);A[g>>>1>>>0]=K,g+=2}return A[g>>>1>>>0]=0,g-N},Yr=h=>h.length*2,pd=(h,g,P)=>{for(var N="",R=h>>>2,z=0;!(z>=g/4);z++){var K=T[R+z>>>0];if(!K&&!P)break;N+=String.fromCodePoint(K)}return N},js=(h,g,P)=>{if(g>>>=0,P??(P=2147483647),P<4)return 0;for(var N=g,R=N+P-4,z=0;z<h.length;++z){var K=h.codePointAt(z);if(K>65535&&z++,E[g>>>2>>>0]=K,g+=4,g+4>R)break}return E[g>>>2>>>0]=0,g-N},jl=h=>{for(var g=0,P=0;P<h.length;++P){var N=h.codePointAt(P);N>65535&&P++,g+=4}return g};function _s(h,g,P){h>>>=0,g>>>=0,P>>>=0,P=He(P);var N,R,z;g===2?(N=Di,R=Qa,z=Yr):(N=pd,R=js,z=jl),L(h,{name:P,fromWireType:K=>{var ne=T[K>>>2>>>0],de=N(K+4,ne*g,!0);return Gr(K),de},toWireType:(K,ne)=>{typeof ne!="string"&&Se(`Cannot pass non-string to C++ string type ${P}`);var de=z(ne),Ee=Ca(4+de+g);return T[Ee>>>2>>>0]=de/g,R(ne,Ee+4,de+g),K!==null&&K.push(Gr,Ee),Ee},readValueFromPointer:be,destructorFunction(K){Gr(K)}})}var dg=function(h,g){h>>>=0,g>>>=0,g=He(g),L(h,{isVoid:!0,name:g,fromWireType:()=>{},toWireType:(P,N)=>{}})},hg=()=>{throw 1/0},ou=[],pg=h=>{var g=ou.length;return ou.push(h),g},gd=(h,g)=>{var P=It[h];return P===void 0&&Se(`${g} has unknown type ${zt(h)}`),P},md=(h,g)=>{for(var P=new Array(h),N=0;N<h;++N)P[N]=gd(T[g+N*4>>>2>>>0],`parameter ${N}`);return P},gg=(h,g,P)=>{var N=[],R=h(N,P);return N.length&&(T[g>>>2>>>0]=vt.toHandle(N)),R},mg={},su=h=>{var g=mg[h];return g===void 0?He(h):g},yg=function(h,g,P){g>>>=0;var N=8,[R,...z]=md(h,g),K=R.toWireType.bind(R),ne=z.map(Fe=>Fe.readValueFromPointer.bind(Fe));h--;var de={toValue:vt.toValue},Ee=ne.map((Fe,Wt)=>{var wr=`argFromPtr${Wt}`;return de[wr]=Fe,`${wr}(args${Wt?"+"+Wt*N:""})`}),Ye;switch(P){case 0:Ye="toValue(handle)";break;case 2:Ye="new (toValue(handle))";break;case 3:Ye="";break;case 1:de.getStringOrSymbol=su,Ye="toValue(handle)[getStringOrSymbol(methodName)]";break}Ye+=`(${Ee})`,R.isVoid||(de.toReturnWire=K,de.emval_returnValue=gg,Ye=`return emval_returnValue(toReturnWire, destructorsRef, ${Ye})`),Ye=`return function (handle, methodName, destructorsRef, args) {
  ${Ye}
  }`;var it=new Function(Object.keys(de),Ye)(...Object.values(de)),et=`methodCaller<(${z.map(Fe=>Fe.name)}) => ${R.name}>`;return pg(Zn(et,it))};function vg(h){return h>>>=0,h?(h=su(h),vt.toHandle(globalThis[h])):vt.toHandle(globalThis)}function yd(h,g){return h>>>=0,g>>>=0,h=vt.toValue(h),g=vt.toValue(g),vt.toHandle(h[g])}function xg(h){h>>>=0,h>9&&(_e[h+1]+=1)}function vd(h,g){return h>>>=0,g>>>=0,h=vt.toValue(h),g=vt.toValue(g),h instanceof g}function bg(h,g,P,N,R){return h>>>=0,g>>>=0,P>>>=0,N>>>=0,R>>>=0,ou[h](g,P,N,R)}function wg(){return vt.toHandle([])}function kg(h){return h>>>=0,vt.toHandle(su(h))}function Sg(){return vt.toHandle({})}function xd(h){h>>>=0;var g=vt.toValue(h);Oo(g),kt(h)}function jg(h,g,P){h>>>=0,g>>>=0,P>>>=0,h=vt.toValue(h),g=vt.toValue(g),P=vt.toValue(P),h[g]=P}function _g(h){return h>>>=0,h=vt.toValue(h),vt.toHandle(typeof h)}function Pg(h,g){h=tt(h),g>>>=0;var P=new Date(h*1e3);E[g>>>2>>>0]=P.getUTCSeconds(),E[g+4>>>2>>>0]=P.getUTCMinutes(),E[g+8>>>2>>>0]=P.getUTCHours(),E[g+12>>>2>>>0]=P.getUTCDate(),E[g+16>>>2>>>0]=P.getUTCMonth(),E[g+20>>>2>>>0]=P.getUTCFullYear()-1900,E[g+24>>>2>>>0]=P.getUTCDay();var N=Date.UTC(P.getUTCFullYear(),0,1,0,0,0,0),R=(P.getTime()-N)/(1e3*60*60*24)|0;E[g+28>>>2>>>0]=R}var Cg=h=>h%4===0&&(h%100!==0||h%400===0),Ng=[0,31,60,91,121,152,182,213,244,274,305,335],Mg=[0,31,59,90,120,151,181,212,243,273,304,334],lu=h=>{var g=Cg(h.getFullYear()),P=g?Ng:Mg,N=P[h.getMonth()]+h.getDate()-1;return N};function Og(h,g){h=tt(h),g>>>=0;var P=new Date(h*1e3);E[g>>>2>>>0]=P.getSeconds(),E[g+4>>>2>>>0]=P.getMinutes(),E[g+8>>>2>>>0]=P.getHours(),E[g+12>>>2>>>0]=P.getDate(),E[g+16>>>2>>>0]=P.getMonth(),E[g+20>>>2>>>0]=P.getFullYear()-1900,E[g+24>>>2>>>0]=P.getDay();var N=lu(P)|0;E[g+28>>>2>>>0]=N,E[g+36>>>2>>>0]=-(P.getTimezoneOffset()*60);var R=new Date(P.getFullYear(),0,1),z=new Date(P.getFullYear(),6,1).getTimezoneOffset(),K=R.getTimezoneOffset(),ne=(z!=K&&P.getTimezoneOffset()==Math.min(K,z))|0;E[g+32>>>2>>>0]=ne}var Ag=function(h){h>>>=0;var g=(()=>{var P=new Date(E[h+20>>>2>>>0]+1900,E[h+16>>>2>>>0],E[h+12>>>2>>>0],E[h+8>>>2>>>0],E[h+4>>>2>>>0],E[h>>>2>>>0],0),N=E[h+32>>>2>>>0],R=P.getTimezoneOffset(),z=new Date(P.getFullYear(),0,1),K=new Date(P.getFullYear(),6,1).getTimezoneOffset(),ne=z.getTimezoneOffset(),de=Math.min(ne,K);if(N<0)E[h+32>>>2>>>0]=+(K!=ne&&de==R);else if(N>0!=(de==R)){var Ee=Math.max(ne,K),Ye=N>0?de:Ee;P.setTime(P.getTime()+(Ye-R)*6e4)}E[h+24>>>2>>>0]=P.getDay();var it=lu(P)|0;E[h+28>>>2>>>0]=it,E[h>>>2>>>0]=P.getSeconds(),E[h+4>>>2>>>0]=P.getMinutes(),E[h+8>>>2>>>0]=P.getHours(),E[h+12>>>2>>>0]=P.getDate(),E[h+16>>>2>>>0]=P.getMonth(),E[h+20>>>2>>>0]=P.getYear();var et=P.getTime();return isNaN(et)?-1:et/1e3})();return BigInt(g)},Tg=function(h,g,P,N){h>>>=0,g>>>=0,P>>>=0,N>>>=0;var R=new Date().getFullYear(),z=new Date(R,0,1),K=new Date(R,6,1),ne=z.getTimezoneOffset(),de=K.getTimezoneOffset(),Ee=Math.max(ne,de);T[h>>>2>>>0]=Ee*60,E[g>>>2>>>0]=+(ne!=de);var Ye=Fe=>{var Wt=Fe>=0?"-":"+",wr=Math.abs(Fe),pn=String(Math.floor(wr/60)).padStart(2,"0"),gn=String(wr%60).padStart(2,"0");return`UTC${Wt}${pn}${gn}`},it=Ye(ne),et=Ye(de);de<ne?(Kt(it,P,17),Kt(et,N,17)):(Kt(it,N,17),Kt(et,P,17))},_l=()=>Date.now(),bd=()=>4294901760,wd=(h,g)=>Math.ceil(h/g)*g,Z=h=>{var g=Ii.buffer.byteLength,P=(h-g+65535)/65536|0;try{return Ii.grow(P),I(),1}catch{}};function ue(h){h>>>=0;var g=M.length,P=bd();if(h>P)return!1;for(var N=1;N<=4;N*=2){var R=g*(1+.2/N);R=Math.min(R,h+100663296);var z=Math.min(P,wd(Math.max(h,R),65536)),K=Z(z);if(K)return!0}return!1}var ce={},pe=()=>s||"./this.program",Re=()=>{if(!Re.strings){var h=(typeof navigator=="object"&&navigator.language||"C").replace("-","_")+".UTF-8",g={USER:"web_user",LOGNAME:"web_user",PATH:"/",PWD:"/",HOME:"/home/web_user",LANG:h,_:pe()};for(var P in ce)ce[P]===void 0?delete g[P]:g[P]=ce[P];var N=[];for(var P in g)N.push(`${P}=${g[P]}`);Re.strings=N}return Re.strings};function Ce(h,g){h>>>=0,g>>>=0;var P=0,N=0;for(var R of Re()){var z=g+P;T[h+N>>>2>>>0]=z,P+=Kt(R,z,1/0)+1,N+=4}return 0}function Ze(h,g){h>>>=0,g>>>=0;var P=Re();T[h>>>2>>>0]=P.length;var N=0;for(var R of P)N+=rr(R)+1;return T[g>>>2>>>0]=N,0}var ze=0,st=()=>ge||ze>0,nt=h=>{var g;st()||((g=r.onExit)==null||g.call(r,h),y=!0),l(h,new se(h))},ft=(h,g)=>{nt(h)},ur=ft;function _r(h){try{var g=De.getStreamFromFD(h);return O.close(g),0}catch(P){if(typeof O>"u"||P.name!=="ErrnoError")throw P;return P.errno}}var Ur=(h,g,P,N)=>{for(var R=0,z=0;z<P;z++){var K=T[g>>>2>>>0],ne=T[g+4>>>2>>>0];g+=8;var de=O.read(h,j,K,ne,N);if(de<0)return-1;if(R+=de,de<ne)break}return R};function ta(h,g,P,N){g>>>=0,P>>>=0,N>>>=0;try{var R=De.getStreamFromFD(h),z=Ur(R,g,P);return T[N>>>2>>>0]=z,0}catch(K){if(typeof O>"u"||K.name!=="ErrnoError")throw K;return K.errno}}function Mn(h,g,P,N){g=tt(g),N>>>=0;try{if(isNaN(g))return 61;var R=De.getStreamFromFD(h);return O.llseek(R,g,P),V[N>>>3>>>0]=BigInt(R.position),R.getdents&&g===0&&P===0&&(R.getdents=null),0}catch(z){if(typeof O>"u"||z.name!=="ErrnoError")throw z;return z.errno}}var cn=(h,g,P,N)=>{for(var R=0,z=0;z<P;z++){var K=T[g>>>2>>>0],ne=T[g+4>>>2>>>0];g+=8;var de=O.write(h,j,K,ne,N);if(de<0)return-1;if(R+=de,de<ne)break}return R};function Lr(h,g,P,N){g>>>=0,P>>>=0,N>>>=0;try{var R=De.getStreamFromFD(h),z=cn(R,g,P);return T[N>>>2>>>0]=z,0}catch(K){if(typeof O>"u"||K.name!=="ErrnoError")throw K;return K.errno}}if(O.createPreloadedFile=fr,O.preloadFile=Et,O.staticInit(),Sn(),ar(),r.noExitRuntime&&(ge=r.noExitRuntime),r.preloadPlugins&&(kn=r.preloadPlugins),r.print&&(b=r.print),r.printErr&&(k=r.printErr),r.wasmBinary&&(x=r.wasmBinary),r.arguments&&r.arguments,r.thisProgram&&(s=r.thisProgram),r.preInit)for(typeof r.preInit=="function"&&(r.preInit=[r.preInit]);r.preInit.length>0;)r.preInit.shift()();var nn,Gr,Ca,In,ra,ro,Ii,La;function Ps(h){nn=h.ea,Gr=h.fa,Ca=h.ga,In=h.ia,ra=h.ja,ro=h.ka,Ii=h.ca,La=h.ha}var Ao={g:Jt,b:Vr,A:ht,V:Vt,W:$t,L:mr,M:$r,J:nr,C:Ne,aa:gt,F:ma,E:Dn,o:Ri,_:_n,B:Ie,p:Mt,m:St,X:qr,$:ea,x:_s,ba:dg,H:hg,f:yg,a:kt,q:vg,i:yd,j:xg,D:vd,e:bg,k:wg,c:kg,l:Sg,d:xd,h:jg,t:_g,N:Pg,O:Og,P:Ag,Q:Tg,Y:_l,K:ue,S:Ce,T:Ze,Z:ur,y:_r,U:ta,R:Mn,z:Lr,G:LN,u:Rg,n:Eg,s:Pl,v:cu,I:To,r:Cl,w:$g};function To(h){var g=Oe();try{ut(h)()}catch(P){if(Me(g),P!==P+0)throw P;In(1,0)}}function cu(h,g){var P=Oe();try{return ut(h)(g)}catch(N){if(Me(P),N!==N+0)throw N;return In(1,0),0n}}function Eg(h,g,P,N,R){var z=Oe();try{return ut(h)(g,P,N,R)}catch(K){if(Me(z),K!==K+0)throw K;In(1,0)}}function Pl(h,g,P,N){var R=Oe();try{return ut(h)(g,P,N)}catch(z){if(Me(R),z!==z+0)throw z;In(1,0)}}function Cl(h,g){var P=Oe();try{ut(h)(g)}catch(N){if(Me(P),N!==N+0)throw N;In(1,0)}}function $g(h,g,P,N){var R=Oe();try{ut(h)(g,P,N)}catch(z){if(Me(R),z!==z+0)throw z;In(1,0)}}function Rg(h,g,P,N){var R=Oe();try{return ut(h)(g,P,N)}catch(z){if(Me(R),z!==z+0)throw z;In(1,0)}}function LN(h,g,P){var N=Oe();try{return ut(h)(g,P)}catch(R){if(Me(N),R!==R+0)throw R;In(1,0)}}function BN(h){h=Object.assign({},h);var g=N=>R=>N(R)>>>0,P=N=>()=>N()>>>0;return h.ea=g(h.ea),h.ga=g(h.ga),h._emscripten_stack_alloc=g(h._emscripten_stack_alloc),h.ka=P(h.ka),h}function Dg(){if(Tr>0){Cr=Dg;return}if(F(),Tr>0){Cr=Dg;return}function h(){var g;r.calledRun=!0,!y&&(H(),_==null||_(r),(g=r.onRuntimeInitialized)==null||g.call(r),W())}r.setStatus?(r.setStatus("Running..."),setTimeout(()=>{setTimeout(()=>r.setStatus(""),1),h()},1)):h()}var Cs;return Cs=await X(),Dg(),D?t=r:t=new Promise((h,g)=>{_=h,S=g}),t}const yne=Object.freeze(Object.defineProperty({__proto__:null,default:RN},Symbol.toStringTag,{value:"Module"})),vne=`
import struct
import numpy as np

class Type:
    Short = (3,2); Long = (4,4); Ascii = (2,1); Byte = (1,1)
    Srational = (10,8)

class Tag:
    NewSubfileType = (254, Type.Long); ImageWidth = (256, Type.Long); ImageLength = (257, Type.Long)
    BitsPerSample = (258, Type.Short); Compression = (259, Type.Short)
    PhotometricInterpretation = (262, Type.Short); Make = (271, Type.Ascii); Model = (272, Type.Ascii)
    StripOffsets = (273, Type.Long); SamplesPerPixel = (277, Type.Short)
    RowsPerStrip = (278, Type.Short); StripByteCounts = (279, Type.Long)
    CFARepeatPatternDim = (33421, Type.Short); CFAPattern = (33422, Type.Byte)
    DNGVersion = (50706, Type.Byte); UniqueCameraModel = (50708, Type.Ascii)
    BlackLevelRepeatDim = (50713, Type.Short)
    BlackLevel = (50714, Type.Short); WhiteLevel = (50717, Type.Short)
    ColorMatrix1 = (50721, Type.Srational); CalibrationIlluminant1 = (50778, Type.Short)

class Compression: Uncompressed = 1
class PhotometricInterpretation: Color_Filter_Array = 32803
class CFAPattern: BGGR=[2,1,1,0]; GBRG=[1,2,0,1]; GRBG=[1,0,2,1]; RGGB=[0,1,1,2]

class dngTag(object):
    def __init__(self, tagType, value=[]):
        self.TagId = tagType[0]
        self.DataType = tagType[1]
        self.DataCount = len(value) if not isinstance(value, str) else len(value) + 1
        self.Value = self._pack_value(tagType[1], value)
        self.DataLength = len(self.Value)
        self.selfContained = (self.DataLength <= 4)
        self.DataOffset = 0

    def _pack_value(self, dtype, value):
        tid = dtype[0]
        if tid == 1: return struct.pack('<%sB' % len(value), *value)
        elif tid == 3: return struct.pack('<%sH' % len(value), *value)
        elif tid == 4: return struct.pack('<%sL' % len(value), *value)
        elif tid == 2: return struct.pack('<%ss' % len(value), value.encode("ascii")) + b'\\x00'
        elif tid == 10:
            flat = [item for sublist in value for item in sublist]  # [[num,den]...]
            return struct.pack('<%sl' % len(flat), *flat)
        return b''

    def write_directory(self, buf, offset):
        if self.selfContained:
            val = self.Value + b'\\x00' * (4 - len(self.Value))
            struct.pack_into("<HHI4s", buf, offset, self.TagId, self.DataType[0], self.DataCount, val)
        else:
            struct.pack_into("<HHII", buf, offset, self.TagId, self.DataType[0], self.DataCount, self.DataOffset)

    def write_data(self, buf):
        if not self.selfContained:
            struct.pack_into(f"<{len(self.Value)}s", buf, self.DataOffset, self.Value)

def pack_dng_from_u16(raw_u16_bytes_le, width, height, cfa_str, black_level_list, cm_flat, make_str, model_str, unique_model_str):
    raw_data = np.frombuffer(raw_u16_bytes_le, dtype=np.uint16).copy()
    raw_data = raw_data.astype(np.int32)
    raw_data = np.clip(raw_data, 0, 65535).astype(np.uint16)

    white_level = 65019
    color_matrix = [[int(x * 10000), 10000] for x in cm_flat]
    cfa_map = {"BGGR": CFAPattern.BGGR, "GBRG": CFAPattern.GBRG, "GRBG": CFAPattern.GRBG, "RGGB": CFAPattern.RGGB}

    tags = [
        dngTag(Tag.NewSubfileType, [0]),
        dngTag(Tag.ImageWidth, [width]),
        dngTag(Tag.ImageLength, [height]),
        dngTag(Tag.BitsPerSample, [16]),
        dngTag(Tag.Compression, [Compression.Uncompressed]),
        dngTag(Tag.PhotometricInterpretation, [PhotometricInterpretation.Color_Filter_Array]),
        dngTag(Tag.Make, make_str),
        dngTag(Tag.Model, model_str),
        dngTag(Tag.SamplesPerPixel, [1]),
        dngTag(Tag.RowsPerStrip, [height]),
        dngTag(Tag.CFARepeatPatternDim, [2, 2]),
        dngTag(Tag.CFAPattern, cfa_map.get(cfa_str.upper(), CFAPattern.RGGB)),
        dngTag(Tag.BlackLevelRepeatDim, [2, 2]),
        dngTag(Tag.BlackLevel, [int(x) for x in black_level_list]),
        dngTag(Tag.WhiteLevel, [white_level]),
        dngTag(Tag.ColorMatrix1, color_matrix),
        dngTag(Tag.CalibrationIlluminant1, [21]),
        dngTag(Tag.DNGVersion, [1, 4, 0, 0]),
        dngTag(Tag.UniqueCameraModel, unique_model_str),
    ]

    pixel_bytes = raw_data.tobytes()
    tags.append(dngTag(Tag.StripOffsets, [0]))
    tags.append(dngTag(Tag.StripByteCounts, [len(pixel_bytes)]))
    tags.sort(key=lambda x: x.TagId)

    ifd_size = 2 + (len(tags) * 12) + 4
    current_data_offset = 8 + ifd_size

    for tag in tags:
        if not tag.selfContained:
            tag.DataOffset = current_data_offset
            current_data_offset = (current_data_offset + tag.DataLength + 3) & 0xFFFFFFFC

    img_offset = current_data_offset
    for tag in tags:
        if tag.TagId == Tag.StripOffsets[0]:
            tag.Value = struct.pack('<L', img_offset)
            break

    buf = bytearray(img_offset + len(pixel_bytes))
    struct.pack_into("<ccbbI", buf, 0, b'I', b'I', 0x2A, 0x00, 8)
    struct.pack_into("<H", buf, 8, len(tags))

    offset = 10
    for tag in tags:
        tag.write_directory(buf, offset)
        offset += 12

    struct.pack_into("<I", buf, offset, 0)
    for tag in tags:
        tag.write_data(buf)

    buf[img_offset:img_offset+len(pixel_bytes)] = pixel_bytes
    return bytes(buf)
`;let Zm=null;async function xne(e){return Zm||(Zm=(async()=>{if(!window.loadPyodide)throw new Error("Pyodide missing: window.loadPyodide not found.");e==null||e("Loading Pyodide...");const t=await window.loadPyodide();return e==null||e("Loading numpy..."),await t.loadPackage("numpy"),e==null||e("Init DNG writer kernel..."),await t.runPythonAsync(vne),t})()),Zm}let Qm=null;async function bne(){Qm||(Qm=RN({locateFile:(t,r)=>t.endsWith("joraw.wasm")?new URL("/assets/joraw-DraTMNgX.wasm",import.meta.url).href:r+t}));const e=await Qm;return e.LibRaw||e.JoRaw}function wne(e,t,r,n){const a=t*r,i=new Float32Array(a);let o=0;for(let s=0;s<r;s++){const l=(s&1)<<1;for(let u=0;u<t;u++){const f=l|u&1;i[o]=e[o]-n[f],o++}}return i}function kne(e,t,r,n){const a=t*r,i=new Uint16Array(a);let o=0;for(let s=0;s<r;s++){const l=(s&1)<<1;for(let u=0;u<t;u++){const f=l|u&1;let d=e[o]+n[f];d<0&&(d=0),d>65535&&(d=65535),i[o]=d+.5|0,o++}}return i}function Sne(e){const t=new Uint16Array([255]);if(new Uint8Array(t.buffer)[0]===255)return new Uint8Array(e.buffer,e.byteOffset,e.byteLength);const n=new Uint8Array(e.length*2),a=new DataView(n.buffer);for(let i=0;i<e.length;i++)a.setUint16(i*2,e[i],!0);return n}function jne(e){const t=e.trim(),r=[];let n=0;const a=f=>f>="0"&&f<="9",i=f=>f>="A"&&f<="Z"||f>="a"&&f<="z";for(;n<t.length;){const f=t[n];if(f<=" "){n++;continue}if(f==="("){r.push({t:"lp"}),n++;continue}if(f===")"){r.push({t:"rp"}),n++;continue}if(f===","){r.push({t:"comma"}),n++;continue}if(f==="+"&&t[n+1]==="+"){r.push({t:"op",v:"++"}),n+=2;continue}if(f==="+"){r.push({t:"op",v:"+"}),n++;continue}if(f==="-"){r.push({t:"op",v:"-"}),n++;continue}if(f==="*"){r.push({t:"op",v:"*"}),n++;continue}if(f==="/"){r.push({t:"op",v:"/"}),n++;continue}if(a(f)||f==="."){let d=n+1;for(;d<t.length&&(a(t[d])||t[d]===".");)d++;const p=Number(t.slice(n,d));if(!Number.isFinite(p))throw new Error(`Bad number: ${t.slice(n,d)}`);r.push({t:"num",v:p}),n=d;continue}if(i(f)){let d=n+1;for(;d<t.length&&i(t[d]);)d++;const p=t.slice(n,d).toUpperCase();let m=d;for(;m<t.length&&t[m]<=" ";)m++;t[m]==="("&&(p==="MAX"||p==="MIN"||p==="MID")?r.push({t:"func",name:p}):r.push({t:"id",v:p}),n=d;continue}throw new Error(`Unexpected char at ${n}: ${f}`)}const o=[];for(let f=0;f<r.length;f++){const d=r[f],p=o[o.length-1],m=!p||p.t==="op"||p.t==="lp"||p.t==="comma";if(d.t==="op"&&(d.v==="-"||d.v==="+")&&m){o.push({t:"num",v:0}),o.push(d);continue}o.push(d)}const s=[],l=f=>f.t==="num"||f.t==="id"||f.t==="rp",u=f=>f.t==="num"||f.t==="id"||f.t==="lp"||f.t==="func";for(let f=0;f<o.length;f++){const d=o[f],p=s[s.length-1];p&&l(p)&&u(d)&&s.push({t:"op",v:"*"}),s.push(d)}return s}function x3(e){return e==="*"||e==="/"?2:1}function _ne(e){const t=[],r=[],n=[];for(const a of e){if(a.t==="num"||a.t==="id"){t.push(a);continue}if(a.t==="func"){r.push(a),n.push(1);continue}if(a.t==="comma"){for(;r.length&&r[r.length-1].t!=="lp";)t.push(r.pop());if(!r.length)throw new Error("Comma found outside parentheses.");if(!n.length)throw new Error("Comma found but no function context.");n[n.length-1]+=1;continue}if(a.t==="lp"){r.push(a);continue}if(a.t==="rp"){for(;r.length&&r[r.length-1].t!=="lp";)t.push(r.pop());if(!r.length)throw new Error("Mismatched parentheses");if(r.pop(),r.length&&r[r.length-1].t==="func"){const i=r.pop(),o=n.pop()??1;t.push({t:"func",name:i.name,argc:o})}continue}if(a.t==="op"){for(;r.length;){const i=r[r.length-1];if(i.t!=="op")break;const o=x3(a.v);if(x3(i.v)>=o)t.push(r.pop());else break}r.push(a);continue}}for(;r.length;){const a=r.pop();if(a.t==="lp"||a.t==="rp")throw new Error("Mismatched parentheses");if(a.t==="func"){const i=n.pop()??1;t.push({t:"func",name:a.name,argc:i})}else t.push(a)}if(n.length!==0)throw new Error("Internal error: argCountStack not empty.");return t}function Pne(e,t){for(let n=1;n<t;n++){const a=e[n];let i=n-1;for(;i>=0&&e[i]>a;)e[i+1]=e[i],i--;e[i+1]=a}const r=t-1>>1;return e[r]}function Cne(e,t,r){if(t.size===0)throw new Error("No RAW loaded.");const n=t.values().next().value,a=n.width,i=n.height,o=a*i,s=new Map,l=x=>{const y=t.get(x);if(!y)throw new Error(`Unknown RAW key: ${x}`);if(y.width!==a||y.height!==i)throw new Error("Dimension mismatch among RAWs.");let w=s.get(x);if(!w){w=new Float64Array(o);const _=y.workF32;for(let S=0;S<o;S++)w[S]=_[S];s.set(x,w)}return{kind:"img",v:w,w:a,h:i,firstId:x}},u=x=>({kind:"scalar",v:x}),f=x=>{if(x.kind==="img")return x;const y=new Float64Array(o);return y.fill(x.v),{kind:"img",v:y,w:a,h:i,firstId:void 0}},d=(x,y)=>x??y,p=[];for(const x of e){if(x.t==="num"){p.push(u(x.v));continue}if(x.t==="id"){p.push(l(x.v));continue}if(x.t==="func"){const y=x.argc??1;if(y<1)throw new Error(`${x.name.toLowerCase()}(...) requires at least 1 argument.`);const w=[];for(let A=0;A<y;A++){const $=p.pop();if(!$)throw new Error(`${x.name.toLowerCase()}(...) missing argument(s).`);w.push($)}if(w.reverse(),w.every(A=>A.kind==="scalar")){const A=w.map($=>$.v);for(let $=1;$<A.length;$++){const E=A[$];let T=$-1;for(;T>=0&&A[T]>E;)A[T+1]=A[T],T--;A[T+1]=E}if(x.name==="MAX")p.push(u(A[A.length-1]));else if(x.name==="MIN")p.push(u(A[0]));else{const $=A.length-1>>1;p.push(u(A[$]))}continue}const S=w.map(f),j=S.reduce((A,$)=>d(A,$.firstId),void 0),M=new Float64Array(o);if(x.name==="MAX"||x.name==="MIN"){const A=S[0].v;for(let $=0;$<o;$++)M[$]=A[$];if(x.name==="MAX")for(let $=1;$<S.length;$++){const E=S[$].v;for(let T=0;T<o;T++)E[T]>M[T]&&(M[T]=E[T])}else for(let $=1;$<S.length;$++){const E=S[$].v;for(let T=0;T<o;T++)E[T]<M[T]&&(M[T]=E[T])}p.push({kind:"img",v:M,w:a,h:i,firstId:j});continue}if(x.name==="MID"){const A=S.length,$=new Float64Array(A);for(let E=0;E<o;E++){for(let T=0;T<A;T++)$[T]=S[T].v[E];M[E]=Pne($,A)}p.push({kind:"img",v:M,w:a,h:i,firstId:j});continue}throw new Error(`Unknown function: ${x.name}`)}if(x.t==="op"){const y=x.v,w=p.pop(),_=p.pop();if(!_||!w)throw new Error(`Operator ${y} missing operands`);if(y==="++"){if(!r)throw new Error("Formula uses '++' but ppRange is null.");const E=f(_),T=f(w),B=T.firstId;if(!B){p.push(E);continue}const U=t.get(B);if(!U)throw new Error(`Mask source RAW not found: ${B}`);const V=E.v,G=T.v,D=new Float64Array(o),I=r.min,F=r.max,H=U.origU16;for(let W=0;W<o;W++){const Q=H[W];D[W]=Q>=I&&Q<=F?G[W]:V[W]}p.push({kind:"img",v:D,w:a,h:i,firstId:d(E.firstId,B)});continue}if(_.kind==="scalar"&&w.kind==="scalar"){if(y==="+")p.push(u(_.v+w.v));else if(y==="-")p.push(u(_.v-w.v));else if(y==="*")p.push(u(_.v*w.v));else if(y==="/")p.push(u(_.v/w.v));else throw new Error(`Unsupported op ${y}`);continue}const S=f(_),j=f(w),M=S.v,A=j.v,$=new Float64Array(o);if(y==="+")for(let E=0;E<o;E++)$[E]=M[E]+A[E];else if(y==="-")for(let E=0;E<o;E++)$[E]=M[E]-A[E];else if(y==="*")for(let E=0;E<o;E++)$[E]=M[E]*A[E];else if(y==="/")for(let E=0;E<o;E++)$[E]=M[E]/A[E];else throw new Error(`Unsupported op ${y}`);p.push({kind:"img",v:$,w:a,h:i,firstId:d(S.firstId,j.firstId)});continue}}if(p.length!==1)throw new Error("Expression did not reduce to a single value.");const m=p[0],v=m.kind==="img"?m:f(m),b=new Float32Array(o),k=v.v;for(let x=0;x<o;x++)b[x]=k[x];return b}async function Nne(e,t,r,n,a,i,o,s,l){if(Object.keys(e).length===0)throw new Error("No files loaded.");if(!t.trim())throw new Error("Formula empty.");const f=t.includes("++");if(f&&!o)throw new Error("Formula contains '++' but ++Range is not provided.");l==null||l("Parsing formula...");const d=jne(t),p=_ne(d),m=new Set;for(const B of d)B.t==="id"&&m.add(B.v);for(const B of m)if(!e[B])throw new Error(`Formula references "${B}" but it is not loaded.`);l==null||l("Initializing joraw...");const v=await bne(),b=[];let k=0,x=0;const y=Array.from(m);for(let B=0;B<y.length;B++){const U=y[B],V=e[U];l==null||l(`Decoding ${U}: ${V.name} ...`);const G=await V.arrayBuffer(),D=new v;try{await D.open(new Uint8Array(G));const I=D.getRawImage(),F=I.width,H=I.height,W=new Uint16Array(I.data),Q=wne(W,F,H,r);if(b.length===0)k=F,x=H;else if(F!==k||H!==x)throw new Error(`Dimension mismatch: ${U} is ${F}x${H}, expected ${k}x${x}.`);b.push({key:U,file:V,width:F,height:H,origU16:W,workF32:Q})}finally{D.delete?D.delete():D.close&&D.close()}}if(b.length===0)throw new Error("No referenced RAWs loaded.");l==null||l("Evaluating expression (float domain)...");const w=new Map(b.map(B=>[B.key,B])),_=Cne(p,w,f?o:null);if(s){let B=-1/0;for(let U=0;U<_.length;U++)_[U]>B&&(B=_[U]);if(B>1e-6){const G=(65019-Math.max(...n))/B;l==null||l(`Auto-filling 16bit: Max=${B.toFixed(2)}, Factor=${G.toFixed(4)}`);for(let D=0;D<_.length;D++)_[D]*=G}}l==null||l("Finalizing to 16-bit (add OutputBL pedestal + clip)...");const S=kne(_,k,x,n),j=Sne(S),M=a&&a.length===9?a:[1,0,0,0,1,0,0,0,1],A=await xne(l);l==null||l("Packing DNG container..."),A.globals.set("js_raw_u16_le",j),A.globals.set("js_width",k),A.globals.set("js_height",x),A.globals.set("js_cfa",String(i||"RGGB")),A.globals.set("js_bl_out",Array.from(n)),A.globals.set("js_cm_flat",M),A.globals.set("js_make","JO-Workstation"),A.globals.set("js_model","StackingTool"),A.globals.set("js_unique_model","JO StackingTool 16bit");const $=await A.runPythonAsync(`
pack_dng_from_u16(
  js_raw_u16_le.to_py(),
  js_width,
  js_height,
  js_cfa,
  js_bl_out.to_py(),
  js_cm_flat.to_py(),
  js_make,
  js_model,
  js_unique_model
)
  `),E=$.toJs();$.destroy&&$.destroy();const T=new Uint8Array(E.byteLength);return T.set(E),T.buffer}const Mne=({isOpen:e,onClose:t,zIndex:r,onFocus:n})=>{const[a,i]=C.useState({}),[o,s]=C.useState(0),[l,u]=C.useState("0 0 0 0"),[f,d]=C.useState("0 0 0 0"),[p,m]=C.useState(()=>localStorage.getItem("stacking_formula")||""),[v,b]=C.useState(!0),[k,x]=C.useState("0-14000"),[y,w]=C.useState(!0),[_,S]=C.useState(""),[j,M]=C.useState("RGGB"),[A,$]=C.useState("Idle"),[E,T]=C.useState(!1),[B,U]=C.useState(null),V=C.useRef(null),G=C.useMemo(()=>Object.keys(hc).sort(),[]);C.useEffect(()=>{localStorage.setItem("stacking_formula",p)},[p]);const D=q=>{let re="",ee=q;for(;ee>=0;)re=String.fromCharCode(ee%26+65)+re,ee=Math.floor(ee/26)-1;return re},I=q=>{if(q.target.files&&q.target.files.length>0){const re={...a};let ee=o;Array.from(q.target.files).forEach(fe=>{const oe=D(ee++);re[oe]=fe}),i(re),s(ee)}q.target.value=""},F=()=>{i({}),s(0),U(null),$("Idle")},H=(q,re)=>{const ee=q.trim().split(/[\s,]+/).map(Number);if(ee.length<1||ee.some(isNaN))throw new Error(`Invalid ${re} Black Level format.`);return[ee[0],ee.length>1?ee[1]:ee[0],ee.length>2?ee[2]:ee[0],ee.length>3?ee[3]:ee[0]]},W=async()=>{if(Object.keys(a).length===0){U("No files loaded.");return}if(!p.trim()){U("Please enter a formula.");return}let q,re;try{q=H(l,"Input"),re=H(f,"Output")}catch(oe){U(oe.message);return}let ee=null;if(v){const oe=k.split("-").map(ye=>parseFloat(ye.trim()));if(oe.length===2&&!isNaN(oe[0])&&!isNaN(oe[1]))ee={min:Math.min(oe[0],oe[1]),max:Math.max(oe[0],oe[1])};else{U("Invalid ++Range format. Use min-max (e.g., 0-14000).");return}}else if(p.includes("++")){U("Formula contains '++' operator but ++Range is disabled.");return}let fe=null;if(_.trim()&&(fe=_.trim().split(/[\s,\n]+/).map(Number),fe.length!==9||fe.some(isNaN))){U("Color Matrix must be 9 numbers.");return}T(!0),U(null),$("Starting...");try{await new Promise(se=>setTimeout(se,50));const oe=await Nne(a,p,q,re,fe,j,ee,y,se=>$(se));$("Creating Download...");const ye=new Blob([oe],{type:"image/x-adobe-dng"}),ae=URL.createObjectURL(ye),X=document.createElement("a");X.href=ae,X.download=`Stacked_Result_${Date.now()}.dng`,document.body.appendChild(X),X.click(),document.body.removeChild(X),URL.revokeObjectURL(ae),$("Done!")}catch(oe){console.error(oe),U(oe.message),$("Failed")}finally{T(!1)}},Q=()=>{d(l)};return e?c.jsxs(ks,{initialPosition:{x:window.innerWidth/2-250,y:100},onClose:t,zIndex:r,onFocus:n,className:"w-[500px] bg-white dark:bg-slate-900 border-2 border-black dark:border-white shadow-2xl flex flex-col font-mono",children:[c.jsxs("div",{className:"flex justify-between items-center px-4 py-2 border-b-2 border-black dark:border-gray-500 bg-emerald-700 text-white",children:[c.jsx("h3",{className:"text-sm font-bold uppercase tracking-widest",children:"Advanced Math Stacking Tool"}),c.jsx("button",{onClick:t,className:"hover:text-red-300 transition-colors",children:""})]}),c.jsxs("div",{className:"p-4 flex flex-col gap-4 overflow-y-auto max-h-[80vh]",children:[c.jsx("div",{className:"h-28 border border-gray-300 dark:border-slate-700 bg-gray-50 dark:bg-black/30 rounded p-2 overflow-y-auto",children:Object.keys(a).length===0?c.jsx("div",{className:"h-full flex items-center justify-center text-gray-400 text-xs",children:"No files loaded. Click 'Add Files' below."}):c.jsx("div",{className:"space-y-1",children:Object.entries(a).map(([q,re])=>{const ee=re;return c.jsxs("div",{className:"flex justify-between text-xs border-b border-gray-200 dark:border-slate-800 pb-1 last:border-0",children:[c.jsx("span",{className:"font-bold text-emerald-600 dark:text-emerald-400 w-8",children:q}),c.jsx("span",{className:"truncate text-gray-700 dark:text-slate-300 flex-1",children:ee.name}),c.jsxs("span",{className:"text-gray-400",children:[(ee.size/1024/1024).toFixed(1),"MB"]})]},q)})})}),c.jsxs("div",{className:"flex flex-col gap-3 flex-shrink-0",children:[c.jsxs("div",{className:"flex gap-2",children:[c.jsx("input",{type:"file",ref:V,multiple:!0,className:"hidden",onChange:I,accept:".arw,.cr2,.cr3,.dng,.nef,.orf,.raf,.rw2,.pef,.srw,.sr2,.srf,.x3f,.erf,.mef,.mos,.mrw,.kdc,.dcr,.iiq,.3fr,.fff,.rwl,.nrw,.raw,.tif,.tiff"}),c.jsx("button",{onClick:()=>{var q;return(q=V.current)==null?void 0:q.click()},className:"flex-1 bg-gray-200 hover:bg-gray-300 dark:bg-slate-800 dark:hover:bg-slate-700 py-1 rounded text-xs font-bold transition-colors",children:"Add Files"}),c.jsx("button",{onClick:F,className:"px-3 bg-red-100 hover:bg-red-200 dark:bg-red-900/30 dark:hover:bg-red-900/50 text-red-600 dark:text-red-400 py-1 rounded text-xs font-bold transition-colors",children:"Clear"})]}),c.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[c.jsxs("div",{className:"flex flex-col gap-2",children:[c.jsxs("div",{children:[c.jsx("label",{className:"text-[10px] font-bold text-gray-500 dark:text-slate-400 uppercase block mb-1",children:"Input BL (Subtract)"}),c.jsx("input",{type:"text",value:l,onChange:q=>u(q.target.value),className:"w-full text-xs px-2 py-1 bg-white dark:bg-slate-900 border border-gray-300 dark:border-slate-600 rounded outline-none"}),c.jsx("div",{className:"text-[9px] text-gray-400 mt-0.5",children:"(0,0), (0,1), (1,0), (1,1)"})]}),c.jsxs("div",{children:[c.jsx("label",{className:"text-[10px] font-bold text-gray-500 dark:text-slate-400 uppercase block mb-1",children:"Output BL (Add to Result)"}),c.jsxs("div",{className:"flex gap-1",children:[c.jsx("input",{type:"text",value:f,onChange:q=>d(q.target.value),className:"w-full text-xs px-2 py-1 bg-white dark:bg-slate-900 border border-gray-300 dark:border-slate-600 rounded outline-none"}),c.jsx("button",{onClick:Q,className:"px-2 bg-gray-200 dark:bg-slate-700 hover:bg-gray-300 rounded text-[9px]",title:"Copy Input to Output",children:""})]})]})]}),c.jsxs("div",{className:"flex flex-col justify-end",children:[c.jsx("label",{className:"text-[10px] font-bold text-gray-500 dark:text-slate-400 uppercase block mb-1",children:"Options"}),c.jsxs("label",{className:"flex items-center gap-1.5 cursor-pointer mb-2",children:[c.jsx("input",{type:"checkbox",checked:y,onChange:q=>w(q.target.checked),className:"rounded text-emerald-600 focus:ring-emerald-500"}),c.jsx("span",{className:"text-[10px] font-bold uppercase text-emerald-600 dark:text-emerald-400",children:"16bit (Auto Fill)"})]}),c.jsxs("div",{className:"flex items-center gap-1 mt-1",children:[c.jsx("input",{type:"checkbox",checked:v,onChange:q=>b(q.target.checked),className:"rounded",title:"Enable Conditional ++ Operator"}),c.jsx("span",{className:`text-[9px] font-bold uppercase ${v?"text-indigo-600 dark:text-indigo-400":"text-gray-400"}`,children:"++Range:"}),c.jsx("input",{type:"text",value:k,onChange:q=>x(q.target.value),disabled:!v,placeholder:"min-max",className:"w-full text-[10px] px-1 py-0.5 bg-white dark:bg-slate-900 border border-gray-300 dark:border-slate-600 rounded outline-none disabled:opacity-50"})]})]})]}),c.jsxs("div",{children:[c.jsx("label",{className:"text-[10px] font-bold text-gray-500 dark:text-slate-400 uppercase block mb-1",children:"Math Formula ( + - * / and ++ )"}),c.jsx("textarea",{value:p,onChange:q=>m(q.target.value),placeholder:"e.g. (A+B)/2 or A ++ 4*B",className:"w-full h-14 text-xs px-2 py-1 bg-white dark:bg-slate-900 border border-gray-300 dark:border-slate-600 rounded outline-none resize-none font-mono"}),c.jsxs("p",{className:"text-[9px] text-gray-400 mt-1 leading-tight",children:["Operators: +, -, *, /, ( ). ",c.jsx("br",{}),c.jsx("span",{className:"text-indigo-400 font-bold",children:"++"})," Operator: ",c.jsx("code",{children:"A ++ B"}),' means "Use B if B is in range, else use A". ',c.jsx("br",{}),"Inputs are linearized float32 (Raw - InputBL)."]})]}),c.jsxs("div",{className:"grid grid-cols-3 gap-2 items-end",children:[c.jsxs("div",{className:"col-span-2",children:[c.jsxs("div",{className:"flex justify-between items-end",children:[c.jsx("label",{className:"text-[10px] font-bold text-gray-500 dark:text-slate-400 uppercase",children:"Color Matrix (9 vals)"}),c.jsxs("select",{className:"text-[9px] bg-gray-100 dark:bg-slate-800 border border-black dark:border-slate-500 rounded-none px-1 py-0.5 max-w-[120px] cursor-pointer",onChange:q=>{const re=hc[q.target.value];re&&S(re),q.target.value=""},defaultValue:"",children:[c.jsx("option",{value:"",disabled:!0,children:"Presets..."}),G.map(q=>c.jsx("option",{value:q,children:q},q))]})]}),c.jsx("input",{type:"text",value:_,onChange:q=>S(q.target.value),placeholder:"e.g. 1 0 0 0 1 0 0 0 1",className:"w-full text-xs px-2 py-1 bg-white dark:bg-slate-900 border border-gray-300 dark:border-slate-600 rounded outline-none mt-1"})]}),c.jsxs("div",{children:[c.jsx("label",{className:"text-[10px] font-bold text-gray-500 dark:text-slate-400 uppercase block mb-1",children:"CFA Pattern"}),c.jsxs("select",{value:j,onChange:q=>M(q.target.value),className:"w-full bg-white dark:bg-slate-900 border border-gray-300 dark:border-slate-600 rounded px-1 py-1 text-xs font-bold",children:[c.jsx("option",{value:"RGGB",children:"RGGB"}),c.jsx("option",{value:"BGGR",children:"BGGR"}),c.jsx("option",{value:"GBRG",children:"GBRG"}),c.jsx("option",{value:"GRBG",children:"GRBG"})]})]})]}),B&&c.jsx("div",{className:"text-red-500 text-xs bg-red-50 dark:bg-red-900/20 p-2 rounded text-center font-bold",children:B}),c.jsxs("div",{className:"flex items-center gap-2 mt-2",children:[c.jsx("div",{className:"flex-1 text-xs text-emerald-600 dark:text-emerald-400 font-bold truncate",children:A}),c.jsx("button",{onClick:W,disabled:E,className:`px-6 py-2 text-sm font-bold uppercase tracking-wide text-white rounded shadow-md transition-all active:scale-95 ${E?"bg-gray-400 cursor-wait":"bg-emerald-600 hover:bg-emerald-500"}`,children:"Process & Save DNG"})]})]})]})]}):null},One=`
import struct
import numpy as np

class Type:
    Short = (3,2); Long = (4,4); Rational = (5,8); Ascii = (2,1); Byte = (1,1)
    Undefined = (7,1); Srational = (10,8); IFD = (13,4)

class Tag:
    NewSubfileType = (254, Type.Long); ImageWidth = (256, Type.Long); ImageLength = (257, Type.Long)
    BitsPerSample = (258, Type.Short); Compression = (259, Type.Short)
    PhotometricInterpretation = (262, Type.Short); Make = (271, Type.Ascii); Model = (272, Type.Ascii)
    StripOffsets = (273, Type.Long); Orientation = (274, Type.Short); SamplesPerPixel = (277, Type.Short)
    RowsPerStrip = (278, Type.Short); StripByteCounts = (279, Type.Long)
    CFARepeatPatternDim = (33421, Type.Short); CFAPattern = (33422, Type.Byte)
    DNGVersion = (50706, Type.Byte); UniqueCameraModel = (50708, Type.Ascii)
    BlackLevel = (50714, Type.Short); WhiteLevel = (50717, Type.Short)
    ColorMatrix1 = (50721, Type.Srational); CalibrationIlluminant1 = (50778, Type.Short)
    BlackLevelRepeatDim = (50713, Type.Short)

class Compression: Uncompressed = 1
class PhotometricInterpretation: Color_Filter_Array = 32803
class CFAPattern: BGGR=[2,1,1,0]; GBRG=[1,2,0,1]; GRBG=[1,0,2,1]; RGGB=[0,1,1,2]

class dngTag(object):
    def __init__(self, tagType, value=[]):
        self.TagId = tagType[0]
        self.DataType = tagType[1]
        self.DataCount = len(value) if not isinstance(value, str) else len(value) + 1
        self.Value = self._pack_value(tagType[1], value)
        self.DataLength = len(self.Value)
        self.selfContained = (self.DataLength <= 4)
        self.DataOffset = 0

    def _pack_value(self, dtype, value):
        tid = dtype[0]
        if tid == 1: return struct.pack('<%sB' % len(value), *value)
        elif tid == 3: return struct.pack('<%sH' % len(value), *value)
        elif tid == 4: return struct.pack('<%sL' % len(value), *value)
        elif tid == 2: return struct.pack('<%ss' % len(value), value.encode("ascii")) + b'\\x00'
        elif tid == 5 or tid == 10: 
            flat = [item for sublist in value for item in sublist]
            fmt = 'L' if tid == 5 else 'l'
            return struct.pack('<%s%s' % (len(flat), fmt), *flat)
        return b''

    def write_directory(self, buf, offset):
        if self.selfContained:
            val = self.Value + b'\\x00' * (4 - len(self.Value))
            struct.pack_into("<HHI4s", buf, offset, self.TagId, self.DataType[0], self.DataCount, val)
        else:
            struct.pack_into("<HHII", buf, offset, self.TagId, self.DataType[0], self.DataCount, self.DataOffset)

    def write_data(self, buf):
        if not self.selfContained:
            struct.pack_into(f"<{len(self.Value)}s", buf, self.DataOffset, self.Value)

def convert_to_dng(raw_bytes, width, height, cfa_str, black_level_list, shift, linear_shift, cm_flat):
    # 1. Pixel Data Processing
    # Ensure raw_bytes is a bytes-like object
    raw_data = np.frombuffer(raw_bytes, dtype=np.uint16).copy()
    
    # Use int32 for calculations
    raw_data = raw_data.astype(np.int32)

    # Apply Bit Shift (<<)
    if shift > 0:
        raw_data = raw_data * (1 << shift)
    
    # Apply Linear Offset (+)
    if linear_shift != 0:
        raw_data = raw_data + linear_shift

    # Clip to 16-bit range
    raw_data = np.clip(raw_data, 0, 65535).astype(np.uint16)

    # 2. Metadata Preparation
    white_level = 65019
    # Format Color Matrix for Srational (Value, Denominator)
    color_matrix = [[int(x * 10000), 10000] for x in cm_flat]

    cfa_map = {"BGGR": CFAPattern.BGGR, "GBRG": CFAPattern.GBRG, "GRBG": CFAPattern.GRBG, "RGGB": CFAPattern.RGGB}
    
    tags = [
        dngTag(Tag.NewSubfileType, [0]),
        dngTag(Tag.ImageWidth, [width]),
        dngTag(Tag.ImageLength, [height]),
        dngTag(Tag.BitsPerSample, [16]), 
        dngTag(Tag.Compression, [Compression.Uncompressed]),
        dngTag(Tag.PhotometricInterpretation, [PhotometricInterpretation.Color_Filter_Array]),
        dngTag(Tag.Make, "JO-Workstation"),
        dngTag(Tag.Model, "Z8-Rescued"),
        dngTag(Tag.SamplesPerPixel, [1]),
        dngTag(Tag.RowsPerStrip, [height]), 
        dngTag(Tag.CFARepeatPatternDim, [2, 2]),
        dngTag(Tag.CFAPattern, cfa_map.get(cfa_str.upper(), CFAPattern.RGGB)),
        dngTag(Tag.BlackLevelRepeatDim, [2, 2]),
        dngTag(Tag.BlackLevel, [int(x) for x in black_level_list]),
        dngTag(Tag.WhiteLevel, [white_level]),
        dngTag(Tag.ColorMatrix1, color_matrix),
        dngTag(Tag.CalibrationIlluminant1, [21]),
        dngTag(Tag.DNGVersion, [1, 4, 0, 0]),
        dngTag(Tag.UniqueCameraModel, "Nikon Z 8") 
    ]
    
    pixel_bytes = raw_data.tobytes()
    tags.append(dngTag(Tag.StripOffsets, [0])) 
    tags.append(dngTag(Tag.StripByteCounts, [len(pixel_bytes)]))
    tags.sort(key=lambda x: x.TagId)
    
    ifd_size = 2 + (len(tags) * 12) + 4
    current_data_offset = 8 + ifd_size
    
    for tag in tags:
        if not tag.selfContained:
            tag.DataOffset = current_data_offset
            current_data_offset = (current_data_offset + tag.DataLength + 3) & 0xFFFFFFFC
            
    img_offset = current_data_offset
    for tag in tags:
        if tag.TagId == Tag.StripOffsets[0]:
            tag.Value = struct.pack('<L', img_offset)
            break
            
    buf = bytearray(img_offset + len(pixel_bytes))
    struct.pack_into("<ccbbI", buf, 0, b'I', b'I', 0x2A, 0x00, 8)
    struct.pack_into("<H", buf, 8, len(tags))
    
    offset = 10
    for tag in tags:
        tag.write_directory(buf, offset)
        offset += 12
        
    struct.pack_into("<I", buf, offset, 0)
    for tag in tags:
        tag.write_data(buf)
        
    buf[img_offset:img_offset+len(pixel_bytes)] = pixel_bytes
    return bytes(buf)
`,Ane=[1.1423,-.4564,-.1123,-.4816,1.2895,.2119,-.021,.1061,.7282],Tne=[4032,4032,4032,4032],Ene=2,$ne=({isOpen:e,onClose:t,zIndex:r=250,onFocus:n})=>{const[a,i]=C.useState(!0),[o,s]=C.useState(!1),[l,u]=C.useState(""),f=C.useRef(null),d=C.useRef(null);C.useEffect(()=>{e&&!f.current&&(async()=>{try{const v=await window.loadPyodide();await v.loadPackage("numpy"),await v.runPythonAsync(One),f.current=v,i(!1)}catch(v){console.error("Pyodide Init Failed",v),u("Error loading Python environment.")}})()},[e]);const p=async m=>{if(!m.target.files||m.target.files.length===0||!f.current)return;const v=Array.from(m.target.files);s(!0),u("Starting batch...");const b=f.current;for(let k=0;k<v.length;k++){const x=v[k];u(`Processing ${k+1}/${v.length}: ${x.name}`);try{const y=await x.arrayBuffer(),w=await pc(y),{data:_,width:S,height:j}=w,M=[[0,0,0],[0,0,0],[0,0,0],[0,0,0]];for(let D=0;D<j;D+=2){const I=D*S,F=(D+1)*S;for(let H=0;H<S;H+=2){const W=[I+H,I+H+1,F+H,F+H+1];for(let Q=0;Q<4;Q++){const q=_[W[Q]];q>=1006&&q<=1008&&M[Q][q-1006]++}}}const A=[-1,-1,-1,-1];for(let D=0;D<4;D++){const I=M[D][0],F=M[D][1],H=M[D][2];H<F?A[D]=1007:H>F&&F<I&&(A[D]=1006)}let $=!1;if(A.some(D=>D>-1)){$=!0;for(let D=0;D<j;D+=2){const I=D*S,F=(D+1)*S;for(let H=0;H<S;H+=2){const W=[I+H,I+H+1,F+H,F+H+1];for(let Q=0;Q<4;Q++){const q=A[Q];q>-1&&_[W[Q]]<=q&&(_[W[Q]]+=1)}}}}b.globals.set("js_raw_bytes",new Uint8Array(_.buffer,_.byteOffset,_.byteLength)),b.globals.set("js_width",S),b.globals.set("js_height",j),b.globals.set("js_cfa","RGGB"),b.globals.set("js_bl_list",Tne),b.globals.set("js_shift",Ene),b.globals.set("js_linear_shift",0),b.globals.set("js_cm_flat",Ane);const E=await b.runPythonAsync(`
                    convert_to_dng(
                        js_raw_bytes.to_py(), 
                        js_width, 
                        js_height, 
                        js_cfa, 
                        js_bl_list.to_py(), 
                        js_shift,
                        js_linear_shift,
                        js_cm_flat.to_py()
                    )
                `),T=E.toJs();E.destroy();const B=new Blob([T],{type:"image/x-adobe-dng"}),U=URL.createObjectURL(B),V=document.createElement("a");V.href=U;const G=x.name.substring(0,x.name.lastIndexOf("."))||"image";V.download=`${G}_Z8Rescued_16bit.dng`,document.body.appendChild(V),V.click(),document.body.removeChild(V),URL.revokeObjectURL(U),await new Promise(D=>setTimeout(D,100))}catch(y){console.error(`Error processing ${x.name}`,y),u(`Error on ${x.name}: ${y.message}`)}}s(!1),u("Batch Complete."),m.target.value=""};return e?c.jsxs(ks,{initialPosition:{x:window.innerWidth/2-200,y:150},onClose:t,zIndex:r,onFocus:n,className:"w-[400px] bg-white dark:bg-slate-900 border-2 border-red-600 shadow-[8px_8px_0px_rgba(220,38,38,0.3)] rounded-none flex flex-col font-mono",children:[c.jsxs("div",{className:"flex justify-between items-center px-4 py-2 bg-red-600 text-white border-b-2 border-black dark:border-white",children:[c.jsxs("h3",{className:"text-sm font-bold uppercase tracking-widest flex items-center gap-2",children:[c.jsx("span",{className:"text-xl",children:""}),"  Z8 (Z8 Rescue)"]}),c.jsx("button",{onClick:t,className:"hover:text-black transition-colors font-bold",children:""})]}),c.jsx("div",{className:"p-6 flex flex-col gap-4",children:a?c.jsxs("div",{className:"flex flex-col items-center justify-center py-4",children:[c.jsx("div",{className:"w-6 h-6 border-4 border-red-600 border-t-transparent animate-spin rounded-full"}),c.jsx("p",{className:"text-xs mt-2 text-gray-500",children:"Loading Python Kernel..."})]}):c.jsxs(c.Fragment,{children:[c.jsxs("div",{className:"bg-red-50 dark:bg-red-900/10 border border-red-200 dark:border-red-800 p-3 text-[10px] text-gray-700 dark:text-gray-300 leading-relaxed",children:[c.jsx("strong",{className:"block mb-1 text-red-600 dark:text-red-400",children:"Logic:"}),"1. iso64 preferred",c.jsx("br",{}),"2. PTC",c.jsx("br",{}),"3. Apply bit-shift (x4) to 16-bit.",c.jsx("br",{}),"4. Export DNG with BL=4032 & Z8 Matrix."]}),c.jsxs("div",{className:"flex flex-col gap-2",children:[c.jsx("input",{type:"file",ref:d,multiple:!0,accept:".nef,.dng",className:"hidden",onChange:p}),c.jsx("button",{onClick:()=>{var m;return(m=d.current)==null?void 0:m.click()},disabled:o,className:`w-full py-3 font-bold uppercase text-xs tracking-widest shadow-md transition-all active:translate-y-1 ${o?"bg-gray-400 text-gray-700 cursor-wait":"bg-red-600 hover:bg-red-500 text-white border-2 border-black dark:border-white"}`,children:o?"Rescuing...":"Select Z8 Files & Rescue"})]}),l&&c.jsx("div",{className:"text-center text-[10px] font-bold text-red-600 dark:text-red-400 border-t border-gray-200 dark:border-slate-800 pt-2 animate-pulse",children:l})]})})]}):null};function b3(e,t,r,n=3){const i=r.byteLength,o=8,s=o+i,l=[{id:256,type:4,count:1,value:e},{id:257,type:4,count:1,value:t},{id:258,type:3,count:n,value:n===1?16:[16,16,16]},{id:259,type:3,count:1,value:1},{id:262,type:3,count:1,value:n===1?1:2},{id:273,type:4,count:1,value:o},{id:277,type:3,count:1,value:n},{id:278,type:4,count:1,value:t},{id:279,type:4,count:1,value:i}],u=2+l.length*12+4;let f=0;const d=l.map(y=>{let w=y.type===3?2:4;const _=y.count*w,S=_<=4;let j=0;return S||(j=f,f+=_),{...y,fits:S,totalBytes:_,extraOffset:j}}),p=s+u+f,m=new ArrayBuffer(p),v=new DataView(m),b=new Uint8Array(m);v.setUint16(0,18761,!0),v.setUint16(2,42,!0),v.setUint32(4,s,!0),b.set(new Uint8Array(r.buffer,r.byteOffset,r.byteLength),o);let k=s;v.setUint16(k,l.length,!0),k+=2;const x=s+u;return d.forEach(y=>{if(v.setUint16(k,y.id,!0),v.setUint16(k+2,y.type,!0),v.setUint32(k+4,y.count,!0),y.fits)Array.isArray(y.value)||(y.type===3?v.setUint16(k+8,y.value,!0):v.setUint32(k+8,y.value,!0));else{const w=x+y.extraOffset;v.setUint32(k+8,w,!0),Array.isArray(y.value)&&y.value.forEach((_,S)=>{v.setUint16(w+S*2,_,!0)})}k+=12}),v.setUint32(k,0,!0),m}const Rne="http://localhost:5428",Dne=(e=!1)=>{const[t,r]=C.useState({isConnected:!1,message:"Initializing...",hasDngConverter:!1});return C.useEffect(()=>{if(e){r({isConnected:!1,message:"Bridge Paused",hasDngConverter:!1});return}const n=async()=>{try{const i=new AbortController,o=setTimeout(()=>i.abort(),1e3),s=await fetch(`${Rne}/health`,{method:"GET",signal:i.signal});if(clearTimeout(o),s.ok){const l=await s.json(),u=`Connected (${l.exiftool||"Ready"})`;r(f=>f.isConnected===!0&&f.message===u&&f.version===l.exiftool&&f.hasDngConverter===!!l.dng_converter?f:{isConnected:!0,message:u,version:l.exiftool,hasDngConverter:!!l.dng_converter})}else r(l=>l.isConnected===!1&&l.message==="Service Error"?l:{isConnected:!1,message:"Service Error",hasDngConverter:!1})}catch{r(o=>o.isConnected===!1&&o.message==="Not Detected"?o:{isConnected:!1,message:"Not Detected",hasDngConverter:!1})}};n();const a=setInterval(n,2e3);return()=>clearInterval(a)},[e]),t},Ine="JTR_BlobStore",Ji="raw_files",Lne=1,fg=()=>new Promise((e,t)=>{const r=indexedDB.open(Ine,Lne);r.onupgradeneeded=n=>{const a=n.target.result;a.objectStoreNames.contains(Ji)||a.createObjectStore(Ji)},r.onsuccess=()=>e(r.result),r.onerror=()=>t(r.error)}),Bne=async(e,t)=>{const r=await fg();return new Promise((n,a)=>{const i=r.transaction(Ji,"readwrite");i.objectStore(Ji).put(t,e),i.oncomplete=()=>n(),i.onerror=()=>a(i.error)})},Fne=async e=>{const t=await fg();return new Promise((r,n)=>{const o=t.transaction(Ji,"readonly").objectStore(Ji).get(e);o.onsuccess=()=>r(o.result),o.onerror=()=>n(o.error)})},Une=async()=>{const e=await fg();return new Promise((t,r)=>{const n=e.transaction(Ji,"readwrite");n.objectStore(Ji).clear(),n.oncomplete=()=>t(),n.onerror=()=>r(n.error)})},DN="jtr_workspace_index",Gne=e=>{try{const t=JSON.stringify(e);localStorage.setItem(DN,t)}catch(t){console.error("Failed to save workspace index",t)}},zne=()=>{try{const e=localStorage.getItem(DN);return e?JSON.parse(e):null}catch(e){return console.error("Failed to load workspace index",e),null}},Wne=async e=>{const n=(await fg()).transaction(Ji,"readwrite").objectStore(Ji),a=n.getAllKeys();a.onsuccess=()=>{a.result.forEach(o=>{e.includes(o)||n.delete(o)})}},Vne=[{x:3050,y:1973},{x:4245,y:1980},{x:3043,y:2870},{x:4243,y:2876}],Hne=1195,w3=150,k3=50,Xne=[{x:3528,y:2437.5,ori:2},{x:3775,y:2419,ori:2},{x:3638.5,y:2303,ori:1},{x:3653,y:2548.5,ori:1},{x:3082,y:2413,ori:2},{x:2825,y:2427,ori:2},{x:2946,y:2300.5,ori:1},{x:2966,y:2550,ori:1},{x:3638.5,y:3e3,ori:1},{x:3657.5,y:3248.5,ori:1},{x:3521.5,y:3135,ori:2},{x:3770,y:3108.5,ori:2},{x:4375.5,y:3064.5,ori:2},{x:4620.5,y:3040,ori:2},{x:4486.5,y:2934,ori:1},{x:4509.5,y:3182.5,ori:1},{x:2066.5,y:1726,ori:2},{x:2176.5,y:1597,ori:1},{x:2194.5,y:1843,ori:1},{x:2313.5,y:1705,ori:2},{x:2675.5,y:1799.5,ori:2},{x:2789.5,y:1674,ori:1},{x:2926,y:1787.5,ori:2},{x:2810.5,y:1921.5,ori:1},{x:4380.5,y:1816,ori:2},{x:4497.5,y:1687,ori:1},{x:4513,y:1934.5,ori:1},{x:4628,y:1799.5,ori:2},{x:5099,y:1622.5,ori:1},{x:4985.5,y:1751,ori:2},{x:5122,y:1867.5,ori:1},{x:5229,y:1732,ori:2},{x:2194.5,y:2428,ori:2},{x:2305.5,y:2295.5,ori:1},{x:2327,y:2544,ori:1},{x:2442,y:2405,ori:2},{x:3530.5,y:1741.5,ori:2},{x:3640.5,y:1610,ori:1},{x:3777.5,y:1719.5,ori:2},{x:3666,y:1856.5,ori:1},{x:4222,y:2443.5,ori:2},{x:4470.5,y:2422,ori:2},{x:4334.5,y:2309,ori:1},{x:4356.5,y:2554,ori:1},{x:4965,y:2313,ori:1},{x:4852.5,y:2446,ori:2},{x:4987,y:2561,ori:1},{x:5097,y:2427,ori:2},{x:4981.5,y:3141.5,ori:2},{x:5096,y:3009,ori:1},{x:5222.5,y:3122.5,ori:2},{x:5115.5,y:3256.5,ori:1},{x:2779,y:2928,ori:1},{x:2667,y:3064.5,ori:2},{x:2799,y:3173.5,ori:1},{x:2917.5,y:3043,ori:2},{x:2167.5,y:2993,ori:1},{x:2052,y:3130,ori:2},{x:2187.5,y:3243.5,ori:1},{x:2304.5,y:3108.5,ori:2}];function Kne(e,t){let r=[],n=[];for(let o=0;o<4;o++){let s=e[o].x,l=e[o].y,u=t[o].x,f=t[o].y;r.push([s,l,1,0,0,0,-s*u,-l*u]),r.push([0,0,0,s,l,1,-s*f,-l*f]),n.push(u),n.push(f)}const a=8;for(let o=0;o<a;o++){let s=o;for(let l=o+1;l<a;l++)Math.abs(r[l][o])>Math.abs(r[s][o])&&(s=l);[r[o],r[s]]=[r[s],r[o]],[n[o],n[s]]=[n[s],n[o]];for(let l=o+1;l<a;l++){const u=r[l][o]/r[o][o];n[l]-=u*n[o];for(let f=o;f<a;f++)r[l][f]-=u*r[o][f]}}const i=new Array(a).fill(0);for(let o=a-1;o>=0;o--){let s=0;for(let l=o+1;l<a;l++)s+=r[o][l]*i[l];i[o]=(n[o]-s)/r[o][o]}return[[i[0],i[1],i[2]],[i[3],i[4],i[5]],[i[6],i[7],1]]}function qne(e,t,r){const n=e[2][0]*t+e[2][1]*r+e[2][2];return{x:(e[0][0]*t+e[0][1]*r+e[0][2])/n,y:(e[1][0]*t+e[1][1]*r+e[1][2])/n}}function Yne(e){if(e.length!==4)return[];const t=Kne(Vne,e),n=Math.hypot(e[1].x-e[0].x,e[1].y-e[0].y)/Hne;return Xne.map(a=>{const i=qne(t,a.x,a.y);let o,s;return a.ori===1?(o=w3*n,s=k3*n):(o=k3*n,s=w3*n),{x:i.x-o/2,y:i.y-s/2,w:o,h:s,ori:a.ori}})}const Zne=[[3.2404542,-1.5371385,-.4985314],[-.969266,1.8760108,.041556],[.0556434,-.2040259,1.0572252]];function Qne(e){const t=e.length;if(t===0)return 16383;const r=Math.max(1,Math.floor(t/1e6));let n=0;for(let a=0;a<t;a+=r){const i=e[a];i>n&&(n=i)}return n>17e3?65535:16383}const Jne=`
struct Uniforms {
    width: u32,
    height: u32,
    whiteLevel: f32,
    exposureScale: f32,

    bl0: f32, bl1: f32, bl2: f32, bl3: f32,
    wb0: f32, wb1: f32, wb2: f32, wb3: f32,

    cm0: f32, cm1: f32, cm2: f32,
    cm3: f32, cm4: f32, cm5: f32,
    cm6: f32, cm7: f32, cm8: f32,

    renderMode: u32,
    isBGGR: u32,

    neutral0: f32, neutral1: f32, neutral2: f32,

    hlrEnabled: u32,
    
    // Export specific flags (packed into padding or new fields)
    exportStretch: u32, 
    exportSrgb: u32,
};

struct UnmixParams {
    bl0: f32, bl1: f32, bl2: f32, bl3: f32,
    bg0: f32, bg1: f32, bg2: f32, bg3: f32,
    fg0: f32, fg1: f32, fg2: f32, fg3: f32,
};

@group(0) @binding(0) var<uniform> u : Uniforms;
@group(0) @binding(1) var<storage, read> rawData : array<u32>;
@group(0) @binding(3) var<uniform> unmix : UnmixParams;
@group(0) @binding(4) var<storage, read> lut : array<f32>; // 1024 float buffer

fn srgb_gamma(linear: f32) -> f32 {
    if (linear <= 0.0031308) { return 12.92 * linear; }
    return 1.055 * pow(linear, 1.0 / 2.4) - 0.055;
}

fn clamp01(x: f32) -> f32 { return max(0.0, min(1.0, x)); }
fn clamp_i32(v: i32, lo: i32, hi: i32) -> i32 { return max(lo, min(v, hi)); }

fn smootherstep(edge0: f32, edge1: f32, x: f32) -> f32 {
    let t = clamp01((x - edge0) / max(edge1 - edge0, 1e-6));
    return t*t*t*(t*(t*6.0 - 15.0) + 10.0);
}

fn get_raw_val(idx: u32) -> f32 {
    let u32Idx = idx / 2u;
    let shift = (idx % 2u) * 16u;
    let packed = rawData[u32Idx];
    return f32((packed >> shift) & 0xFFFFu);
}

fn get_bayer_idx(x: u32, y: u32) -> u32 {
    let rowIsOdd = (y % 2u);
    let colIsOdd = (x % 2u);
    return (rowIsOdd * 2u) + colIsOdd;
}

fn get_norm_pixel(x: i32, y: i32) -> f32 {
    let w = i32(u.width);
    let h = i32(u.height);
    let sx = clamp_i32(x, 0, w - 1);
    let sy = clamp_i32(y, 0, h - 1);
    let sxu = u32(sx);
    let syu = u32(sy);
    let idx = syu * u.width + sxu;
    let rawVal = get_raw_val(idx);
    let bIdx = get_bayer_idx(sxu, syu);

    var bl = 0.0;
    var wb = 1.0;
    if (bIdx == 0u) { bl = u.bl0; wb = u.wb0; }
    else if (bIdx == 1u) { bl = u.bl1; wb = u.wb1; }
    else if (bIdx == 2u) { bl = u.bl2; wb = u.wb2; }
    else { bl = u.bl3; wb = u.wb3; }

    let denom = max(u.whiteLevel - bl, 1.0);
    let val = max(0.0, rawVal - bl);
    return (val / denom) * wb;
}

fn shoulder_hue_preserve(rgbIn: vec3f) -> vec3f {
    var rgb = rgbIn;
    let knee = 0.90;
    let mx = max(rgb.x, max(rgb.y, rgb.z));
    if (mx <= knee) { return rgb; }
    let d = mx - knee;
    let mx2 = knee + (d * (1.0 - knee)) / (d + (1.0 - knee));
    let s = mx2 / max(mx, 1e-6);
    return rgb * s;
}

fn apply_lut(val: f32, offset: u32) -> f32 {
    let v = clamp01(val);
    let pos = v * 255.0;
    let idx = u32(pos);
    let f = fract(pos);
    let p0 = lut[offset + idx];
    let idxNext = min(idx + 1u, 255u);
    let p1 = lut[offset + idxNext];
    return mix(p0, p1, f);
}
`,eae=`
    let x = global_id.x;
    let y = global_id.y;
    if (x >= u.width || y >= u.height) { return; }
    let idx = y * u.width + x;

    var finalR: f32 = 0.0;
    var finalG: f32 = 0.0;
    var finalB: f32 = 0.0;
    
    // We compute 'linear-ish' float values first. 
    // In standard modes, these are 0..1.

    // MODE 0: mosaic gray
    if (u.renderMode == 0u) {
        let rawVal = get_raw_val(idx);
        let bIdx = get_bayer_idx(x, y);
        var bl = 0.0; var wb = 1.0;
        if (bIdx == 0u) { bl = u.bl0; wb = u.wb0; }
        else if (bIdx == 1u) { bl = u.bl1; wb = u.wb1; }
        else if (bIdx == 2u) { bl = u.bl2; wb = u.wb2; }
        else { bl = u.bl3; wb = u.wb3; }

        let val = max(0.0, rawVal - bl);
        var norm = val / max(u.whiteLevel - bl, 1.0);
        norm = clamp01(norm * u.exposureScale * wb);
        // Note: Gamma is applied at output stage for modularity
        finalR = norm; finalG = norm; finalB = norm;
    }
    // MODE 2: advanced unmix
    else if (u.renderMode == 2u) {
        let rawVal = get_raw_val(idx);
        let bIdx = get_bayer_idx(x, y);
        var bl = 0.0; var bg = 0.0; var fg = 0.0;
        if (bIdx == 0u) { bl = unmix.bl0; bg = unmix.bg0; fg = unmix.fg0; }
        else if (bIdx == 1u) { bl = unmix.bl1; bg = unmix.bg1; fg = unmix.fg1; }
        else if (bIdx == 2u) { bl = unmix.bl2; bg = unmix.bg2; fg = unmix.fg2; }
        else { bl = unmix.bl3; bg = unmix.bg3; fg = unmix.fg3; }

        let ref_bg = (unmix.bg1 + unmix.bg3) * 0.5;
        let ref_fg = (unmix.fg1 + unmix.fg3) * 0.5;
        let img_linear = max(0.0, rawVal - bl);
        let denom = fg - bg;
        var alpha = 0.0;
        if (abs(denom) > 1e-9) { alpha = (img_linear - bg) / denom; }

        var val = 0.0;
        if (alpha < 0.0) { val = img_linear * (ref_bg / max(bg, 1e-9)); }
        else if (alpha > 1.0) { val = img_linear * (ref_fg / max(fg, 1e-9)); }
        else { val = (1.0 - alpha) * ref_bg + alpha * ref_fg; }

        var norm = clamp01((val * u.exposureScale) / 65535.0);
        finalR = norm; finalG = norm; finalB = norm;
    }
    // MODE 1: bilinear color
    else {
        let xi = i32(x); let yi = i32(y);
        let rowIsOdd = (yi & 1); let colIsOdd = (xi & 1);
        var isRed = false; var isBlue = false;
        if (rowIsOdd == 0 && colIsOdd == 0) {
            if (u.isBGGR == 1u) { isBlue = true; } else { isRed = true; }
        } else if (rowIsOdd == 1 && colIsOdd == 1) {
            if (u.isBGGR == 1u) { isRed = true; } else { isBlue = true; }
        }

        var r_lin: f32 = 0.0; var g_lin: f32 = 0.0; var b_lin: f32 = 0.0;
        if (isRed) {
            r_lin = get_norm_pixel(xi, yi);
            g_lin = (get_norm_pixel(xi, yi-1) + get_norm_pixel(xi, yi+1) + get_norm_pixel(xi-1, yi) + get_norm_pixel(xi+1, yi)) * 0.25;
            b_lin = (get_norm_pixel(xi-1, yi-1) + get_norm_pixel(xi+1, yi-1) + get_norm_pixel(xi-1, yi+1) + get_norm_pixel(xi+1, yi+1)) * 0.25;
        } else if (isBlue) {
            b_lin = get_norm_pixel(xi, yi);
            g_lin = (get_norm_pixel(xi, yi-1) + get_norm_pixel(xi, yi+1) + get_norm_pixel(xi-1, yi) + get_norm_pixel(xi+1, yi)) * 0.25;
            r_lin = (get_norm_pixel(xi-1, yi-1) + get_norm_pixel(xi+1, yi-1) + get_norm_pixel(xi-1, yi+1) + get_norm_pixel(xi+1, yi+1)) * 0.25;
        } else {
            g_lin = get_norm_pixel(xi, yi);
            var horizIsRed = false;
            if (rowIsOdd == 0) { horizIsRed = (u.isBGGR == 0u); }
            else { horizIsRed = (u.isBGGR == 1u); }
            let valH = (get_norm_pixel(xi-1, yi) + get_norm_pixel(xi+1, yi)) * 0.5;
            let valV = (get_norm_pixel(xi, yi-1) + get_norm_pixel(xi, yi+1)) * 0.5;
            if (horizIsRed) { r_lin = valH; b_lin = valV; }
            else { b_lin = valH; r_lin = valV; }
        }

        // HLR
        if (u.hlrEnabled == 1u) {
            let targetWhite = vec3f(u.neutral0, u.neutral1, u.neutral2);
            let isBG = (u.isBGGR == 1u);
            let wbR = select(u.wb0, u.wb3, isBG); 
            let wbB = select(u.wb3, u.wb0, isBG);
            let r_s = r_lin / max(wbR, 1e-6);
            let g_s = g_lin;
            let b_s = b_lin / max(wbB, 1e-6);
            let mag_sensor = max(r_s, max(g_s, b_s));
            let mag_wb = max(r_lin, max(g_lin, b_lin));
            let hl_mask = smootherstep(0.85, 1.00, mag_sensor);
            if (hl_mask > 0.0) {
                let corrected = targetWhite * mag_wb;
                r_lin = mix(r_lin, corrected.x, hl_mask);
                g_lin = mix(g_lin, corrected.y, hl_mask);
                b_lin = mix(b_lin, corrected.z, hl_mask);
            }
        }

        // Matrix
        var rr = u.cm0*r_lin + u.cm1*g_lin + u.cm2*b_lin;
        var gg = u.cm3*r_lin + u.cm4*g_lin + u.cm5*b_lin;
        var bb = u.cm6*r_lin + u.cm7*g_lin + u.cm8*b_lin;

        // Exposure
        rr *= u.exposureScale;
        gg *= u.exposureScale;
        bb *= u.exposureScale;

        // Shoulder
        var rgb2 = shoulder_hue_preserve(vec3f(rr, gg, bb));

        // Curves
        let rgbPos = max(rgb2, vec3f(0.0));
        let luma = dot(rgbPos, vec3f(0.2126, 0.7152, 0.0722));
        let luma2 = apply_lut(luma, 0u);
        var masterScale = 1.0;
        if (luma > 1e-6) { masterScale = luma2 / luma; }
        let mr = rgb2.x * masterScale;
        let mg = rgb2.y * masterScale;
        let mb = rgb2.z * masterScale;

        finalR = apply_lut(mr, 256u);
        finalG = apply_lut(mg, 512u);
        finalB = apply_lut(mb, 768u);
    }
`;function S3(e){let t="",r="";return e==="display"?(t="@group(0) @binding(2) var<storage, read_write> output : array<u32>;",r=`
            // Standard Display Output (Always sRGB Gamma + 8-bit Packing)
            let r_gamma = srgb_gamma(clamp01(finalR));
            let g_gamma = srgb_gamma(clamp01(finalG));
            let b_gamma = srgb_gamma(clamp01(finalB));

            let r8 = u32(r_gamma * 255.0 + 0.5);
            let g8 = u32(g_gamma * 255.0 + 0.5);
            let b8 = u32(b_gamma * 255.0 + 0.5);
            let a8 = 255u;
            output[idx] = (a8 << 24u) | (b8 << 16u) | (g8 << 8u) | r8;
        `):(t="@group(0) @binding(2) var<storage, read_write> output : array<u32>;",r=`
            var r_out = clamp01(finalR);
            var g_out = clamp01(finalG);
            var b_out = clamp01(finalB);

            if (u.exportSrgb == 1u) {
                r_out = srgb_gamma(r_out);
                g_out = srgb_gamma(g_out);
                b_out = srgb_gamma(b_out);
            }

            var scale = 65535.0;
            if (u.exportStretch == 0u) {
                // Approximate raw magnitude restoration
                // get_norm_pixel divided by (White - Black)
                // So multiply by that range to restore DNs
                // Average green BL? Just use bl0 for simplicity or max range
                let bl = u.bl0; 
                scale = max(u.whiteLevel - bl, 1.0);
            }

            let r16 = u32(min(65535.0, r_out * scale));
            let g16 = u32(min(65535.0, g_out * scale));
            let b16 = u32(min(65535.0, b_out * scale));
            let a16 = 65535u; // Fully opaque

            // Pack: Little Endian logic
            // RG pack: (G << 16) | R
            // BA pack: (A << 16) | B
            
            let packedRG = (g16 << 16u) | r16;
            let packedBA = (a16 << 16u) | b16;

            output[idx * 2u] = packedRG;
            output[idx * 2u + 1u] = packedBA;
        `),`
        ${Jne}
        ${t}
        @compute @workgroup_size(16, 16)
        fn main(@builtin(global_invocation_id) global_id : vec3u) {
            ${eae}
            ${r}
        }
    `}class tae{constructor(){pr(this,"device",null);pr(this,"displayPipeline",null);pr(this,"exportPipeline",null);pr(this,"resources",new Map);pr(this,"uniformBuffer",null);pr(this,"unmixParamsBuffer",null);pr(this,"lutBuffer",null);pr(this,"isInitialized",!1)}async init(){if(this.isInitialized)return!0;if(!navigator.gpu)return console.warn("WebGPU not supported."),!1;try{const t=await navigator.gpu.requestAdapter();if(!t)throw new Error("No GPU adapter found.");const r={};t.limits.maxStorageBufferBindingSize&&(r.maxStorageBufferBindingSize=1024*1024*1024),t.limits.maxBufferSize&&(r.maxBufferSize=1024*1024*1024),this.device=await t.requestDevice({requiredLimits:r});const n=this.device.createBindGroupLayout({entries:[{binding:0,visibility:GPUShaderStage.COMPUTE,buffer:{type:"uniform"}},{binding:1,visibility:GPUShaderStage.COMPUTE,buffer:{type:"read-only-storage"}},{binding:2,visibility:GPUShaderStage.COMPUTE,buffer:{type:"storage"}},{binding:3,visibility:GPUShaderStage.COMPUTE,buffer:{type:"uniform"}},{binding:4,visibility:GPUShaderStage.COMPUTE,buffer:{type:"read-only-storage"}}]}),a=this.device.createShaderModule({code:S3("display")});this.displayPipeline=this.device.createComputePipeline({layout:this.device.createPipelineLayout({bindGroupLayouts:[n]}),compute:{module:a,entryPoint:"main"}});const i=this.device.createShaderModule({code:S3("export")});return this.exportPipeline=this.device.createComputePipeline({layout:this.device.createPipelineLayout({bindGroupLayouts:[n]}),compute:{module:i,entryPoint:"main"}}),this.uniformBuffer=this.device.createBuffer({size:256,usage:GPUBufferUsage.UNIFORM|GPUBufferUsage.COPY_DST}),this.unmixParamsBuffer=this.device.createBuffer({size:64,usage:GPUBufferUsage.UNIFORM|GPUBufferUsage.COPY_DST}),this.lutBuffer=this.device.createBuffer({size:4096,usage:GPUBufferUsage.STORAGE|GPUBufferUsage.COPY_DST}),this.isInitialized=!0,console.log("WebGPU Renderer Initialized"),!0}catch(t){return console.error("WebGPU Init Failed:",t),!1}}hasImage(t){return this.resources.has(t)}async uploadImage(t,r,n,a,i){if(this.isInitialized||await this.init(),!!this.device){if(this.resources.has(t)){const o=this.resources.get(t);if(o&&o.width===n&&o.height===a)return;this.disposeImage(t)}try{const o=n*a,s=Math.ceil(o*2/4)*4,l=this.device.createBuffer({size:s,usage:GPUBufferUsage.STORAGE|GPUBufferUsage.COPY_DST,mappedAtCreation:!0});new Uint16Array(l.getMappedRange()).set(r),l.unmap();const u=o*4,f=this.device.createBuffer({size:u,usage:GPUBufferUsage.STORAGE|GPUBufferUsage.COPY_SRC}),d=this.device.createBuffer({size:u,usage:GPUBufferUsage.MAP_READ|GPUBufferUsage.COPY_DST}),p=this.device.createBindGroup({layout:this.displayPipeline.getBindGroupLayout(0),entries:[{binding:0,resource:{buffer:this.uniformBuffer}},{binding:1,resource:{buffer:l}},{binding:2,resource:{buffer:f}},{binding:3,resource:{buffer:this.unmixParamsBuffer}},{binding:4,resource:{buffer:this.lutBuffer}}]}),m=i??Qne(r);this.resources.set(t,{width:n,height:a,rawBuffer:l,outputBuffer:f,readBuffer:d,bindGroup:p,whiteLevel:m,busy:!1})}catch(o){console.error("[WebGPU] Buffer creation failed",o)}}}updateUniforms(t,r,n,a){const i=Math.pow(2,r.exposure),o=r.blackLevel||[0,0,0,0],s=r.wbGains||[1,1];let l=65532;r.highlightRecovery&&(l=r.customWhiteLevel??t.whiteLevel??16383);let u=[1,1,1,1];r.isBGGR?u=[s[1],1,1,s[0]]:u=[s[0],1,1,s[1]];let f=[[1,0,0],[0,1,0],[0,0,1]],d=[1,0,0,0,1,0,0,0,1],p=null;if(r.customMatrix&&r.customMatrix.length===9){const S=[[r.customMatrix[0],r.customMatrix[1],r.customMatrix[2]],[r.customMatrix[3],r.customMatrix[4],r.customMatrix[5]],[r.customMatrix[6],r.customMatrix[7],r.customMatrix[8]]],j=al(S);j&&(f=mf(Zne,j),d=[f[0][0],f[0][1],f[0][2],f[1][0],f[1][1],f[1][2],f[2][0],f[2][1],f[2][2]],p=al(f))}const m=d;let v=0;r.renderMode==="zero-dep-color"&&(v=1),r.renderMode==="advanced-zero-dep"&&(v=2);let b=[1,1,1];if(p){b=v6(p,[1,1,1]);const S=Math.max(Math.abs(b[0]),Math.max(Math.abs(b[1]),Math.abs(b[2])));S>1e-6?b=[b[0]/S,b[1]/S,b[2]/S]:b=[1,1,1]}const k=new Float32Array([0,0,l,i,o[0],o[1],o[2],o[3],u[0],u[1],u[2],u[3],m[0],m[1],m[2],m[3],m[4],m[5],m[6],m[7],m[8],0,0,b[0],b[1],b[2],0,0,0]),x=new Uint32Array(k.buffer);x[0]=t.width,x[1]=t.height,x[21]=v,x[22]=r.isBGGR?1:0,x[26]=1,x[27]=a.stretch?1:0,x[28]=a.srgb?1:0,this.device.queue.writeBuffer(this.uniformBuffer,0,k);const y=new Float32Array(16);if(v===2&&r.advancedZeroDep){const S=r.advancedZeroDep;y.set([S.bl[0],S.bl[1],S.bl[2],S.bl[3],Math.max(0,S.bg[0]-S.bl[0]),Math.max(0,S.bg[1]-S.bl[1]),Math.max(0,S.bg[2]-S.bl[2]),Math.max(0,S.bg[3]-S.bl[3]),Math.max(0,S.fg[0]-S.bl[0]),Math.max(0,S.fg[1]-S.bl[1]),Math.max(0,S.fg[2]-S.bl[2]),Math.max(0,S.fg[3]-S.bl[3])])}this.device.queue.writeBuffer(this.unmixParamsBuffer,0,y);const w=new Float32Array(1024),_=r.curves||{master:[{x:0,y:0},{x:1,y:1}],red:[{x:0,y:0},{x:1,y:1}],green:[{x:0,y:0},{x:1,y:1}],blue:[{x:0,y:0},{x:1,y:1}]};w.set(Fd(_.master),0),w.set(Fd(_.red),256),w.set(Fd(_.green),512),w.set(Fd(_.blue),768),this.device.queue.writeBuffer(this.lutBuffer,0,w)}async render(t,r,n){if(this.isInitialized||await this.init(),!this.device||!this.displayPipeline)return null;const a=this.resources.get(t);if(!a||a.busy)return null;a.busy=!0;try{this.updateUniforms(a,r,!1,{stretch:!1,srgb:!0});const i=this.device.createCommandEncoder(),o=i.beginComputePass();o.setPipeline(this.displayPipeline),o.setBindGroup(0,a.bindGroup),o.dispatchWorkgroups(Math.ceil(a.width/16),Math.ceil(a.height/16)),o.end(),i.copyBufferToBuffer(a.outputBuffer,0,a.readBuffer,0,a.width*a.height*4),this.device.queue.submit([i.finish()]),await a.readBuffer.mapAsync(GPUMapMode.READ);const s=new Uint8ClampedArray(a.readBuffer.getMappedRange()),l=new ImageData(new Uint8ClampedArray(s),a.width,a.height);return a.readBuffer.unmap(),l}catch(i){console.error("WebGPU Render Error",i);try{a.readBuffer.unmap()}catch{}return null}finally{a.busy=!1}}async export16Bit(t,r,n,a){if(this.isInitialized||await this.init(),!this.device||!this.exportPipeline)return null;const i=this.resources.get(t);if(!i)return null;const o=i.width*i.height*8,s=this.device.createBuffer({size:o,usage:GPUBufferUsage.STORAGE|GPUBufferUsage.COPY_SRC}),l=this.device.createBuffer({size:o,usage:GPUBufferUsage.MAP_READ|GPUBufferUsage.COPY_DST}),u=this.device.createBindGroup({layout:this.exportPipeline.getBindGroupLayout(0),entries:[{binding:0,resource:{buffer:this.uniformBuffer}},{binding:1,resource:{buffer:i.rawBuffer}},{binding:2,resource:{buffer:s}},{binding:3,resource:{buffer:this.unmixParamsBuffer}},{binding:4,resource:{buffer:this.lutBuffer}}]});this.updateUniforms(i,r,!0,{stretch:n,srgb:a});const f=this.device.createCommandEncoder(),d=f.beginComputePass();d.setPipeline(this.exportPipeline),d.setBindGroup(0,u),d.dispatchWorkgroups(Math.ceil(i.width/16),Math.ceil(i.height/16)),d.end(),f.copyBufferToBuffer(s,0,l,0,o),this.device.queue.submit([f.finish()]),await l.mapAsync(GPUMapMode.READ);const p=new Uint32Array(l.getMappedRange()),m=i.width*i.height,v=new Uint16Array(m*3);for(let b=0;b<m;b++){const k=p[b*2],x=p[b*2+1],y=k&65535,w=k>>>16&65535,_=x&65535;v[b*3]=y,v[b*3+1]=w,v[b*3+2]=_}return l.unmap(),s.destroy(),l.destroy(),v}disposeImage(t){const r=this.resources.get(t);r&&(r.rawBuffer.destroy(),r.outputBuffer.destroy(),r.readBuffer.destroy(),this.resources.delete(t))}disposeAll(){this.resources.forEach(t=>{t.rawBuffer.destroy(),t.outputBuffer.destroy(),t.readBuffer.destroy()}),this.resources.clear()}}const $l=new tae,l0=1024,rae=(e,t,r)=>{const n=e.width,a=e.height,i=new ImageData(t,r),o=e.data,s=i.data,l=n/t,u=a/r;for(let f=0;f<r;f++){const d=Math.floor(f*u),p=f*t*4,m=d*n*4;for(let v=0;v<t;v++){const k=Math.floor(v*l)*4,x=p+v*4,y=m+k;s[x]=o[y],s[x+1]=o[y+1],s[x+2]=o[y+2],s[x+3]=o[y+3]}}return i},nae=(e,t)=>{if(!e)return null;if(t){const r=e.bayerPattern.toUpperCase(),n=l=>{const u=[];for(let f=0;f<4;f++)r[f]===l&&u.push(f);return u},a=t.BlackLevelRed,i=t.BlackLevelGreen,o=t.BlackLevelBlue;if(a!==void 0&&i!==void 0&&o!==void 0){const l=parseFloat(a),u=parseFloat(i),f=parseFloat(o);if(!isNaN(l)&&!isNaN(u)&&!isNaN(f)){const d=[0,0,0,0];if(d.fill(u),n("R").forEach(p=>d[p]=l),n("G").forEach(p=>d[p]=u),n("B").forEach(p=>f),d.some(p=>p>0))return d}}let s=t.BlackLevel;if(s===void 0&&(s=t.BlackLevel2),s!==void 0){let l=[];if(Array.isArray(s)?l=s.map(Number):typeof s=="string"?l=s.trim().split(/\s+/).map(Number):typeof s=="number"&&(l=[s,s,s,s]),l.length===1&&!isNaN(l[0])&&(l=[l[0],l[0],l[0],l[0]]),l.length>=4&&!l.slice(0,4).some(isNaN)&&l.some(u=>u>0))return[l[0],l[1],l[2],l[3]]}}return e.blackLevels&&e.blackLevels.length===4?[e.blackLevels[0],e.blackLevels[1],e.blackLevels[2],e.blackLevels[3]]:null},aae=({stats:e,onClose:t,onMinimize:r,isBGGR:n,onToggleBGGR:a,onOpenWindow:i,displaySettings:o,zIndex:s,onFocus:l,rawImageData:u})=>{if(!e)return null;const f=!!o.showKadc,d=o.blackLevel||[0,0,0,0],p=!!o.subtractBlackLevelFromStats&&!!o.blackLevel,m=C.useMemo(()=>{if(!e||!u||!o.advancedZeroDep||o.renderMode!=="advanced-zero-dep")return null;try{const{x:w,y:_,width:S,height:j}=e,M=E1(u,{x:w,y:_,w:S,h:j},o),A=[0,0,0,0],$=[0,0,0,0],E=Math.floor(_),T=Math.floor(w);for(let B=0;B<M.height;B++){const U=B*M.width;for(let V=0;V<M.width;V++){const G=M.data[U+V],D=E+B,I=T+V,F=D%2,H=I%2,W=F*2+H;A[W]+=G,$[W]++}}return A.map((B,U)=>$[U]>0?B/$[U]:0)}catch(w){return console.error("Unmix calc error",w),null}},[e,u,o]),v=(w,_,S)=>f?_<=1e-4?0:(w-S)/_:null,b=(w,_)=>p?w-d[_]:w,k=()=>{if(!p){alert(`Sub. BL
Please enable 'Sub. BL' in Tools sidebar first.`);return}let w,_,S,j;n?(j=0,_=1,S=2,w=3):(w=0,_=1,S=2,j=3);const M=$=>e.means[$]-d[$],A=$=>e.stdDevs[$];localStorage.setItem("import_signal_r",M(w).toString()),localStorage.setItem("import_signal_g1",M(_).toString()),localStorage.setItem("import_signal_g2",M(S).toString()),localStorage.setItem("import_signal_b",M(j).toString()),localStorage.setItem("import_sigma_r",A(w).toString()),localStorage.setItem("import_sigma_g1",A(_).toString()),localStorage.setItem("import_sigma_g2",A(S).toString()),localStorage.setItem("import_sigma_b",A(j).toString()),window.open("https://y-g-jiang.github.io/XJZS.html","_blank")},x=n?[{name:"B",desc:"(0,0)",mean:b(e.means[0],0),std:e.stdDevs[0],color:"text-blue-500",snr:v(e.means[0],e.stdDevs[0],d[0]),unmixed:m?m[0]:null},{name:"G1",desc:"(0,1)",mean:b(e.means[1],1),std:e.stdDevs[1],color:"text-green-500",snr:v(e.means[1],e.stdDevs[1],d[1]),unmixed:m?m[1]:null},{name:"G2",desc:"(1,0)",mean:b(e.means[2],2),std:e.stdDevs[2],color:"text-green-500",snr:v(e.means[2],e.stdDevs[2],d[2]),unmixed:m?m[2]:null},{name:"R",desc:"(1,1)",mean:b(e.means[3],3),std:e.stdDevs[3],color:"text-red-500",snr:v(e.means[3],e.stdDevs[3],d[3]),unmixed:m?m[3]:null}]:[{name:"R",desc:"(0,0)",mean:b(e.means[0],0),std:e.stdDevs[0],color:"text-red-500",snr:v(e.means[0],e.stdDevs[0],d[0]),unmixed:m?m[0]:null},{name:"G1",desc:"(0,1)",mean:b(e.means[1],1),std:e.stdDevs[1],color:"text-green-500",snr:v(e.means[1],e.stdDevs[1],d[1]),unmixed:m?m[1]:null},{name:"G2",desc:"(1,0)",mean:b(e.means[2],2),std:e.stdDevs[2],color:"text-green-500",snr:v(e.means[2],e.stdDevs[2],d[2]),unmixed:m?m[2]:null},{name:"B",desc:"(1,1)",mean:b(e.means[3],3),std:e.stdDevs[3],color:"text-blue-500",snr:v(e.means[3],e.stdDevs[3],d[3]),unmixed:m?m[3]:null}],y=m?"w-96":f?"w-80":"w-60";return c.jsxs(ks,{className:`${y} p-0 overflow-hidden transition-all duration-300 bg-white dark:bg-black border-2 border-black dark:border-white shadow-[4px_4px_0px_rgba(0,0,0,0.5)] dark:shadow-[4px_4px_0px_rgba(255,255,255,0.2)]`,onClose:t,zIndex:s,onFocus:l,initialPosition:{x:20,y:80},children:[c.jsxs("div",{className:"flex justify-between items-center px-3 py-2 border-b border-gray-100 dark:border-slate-800 bg-gray-50/50 dark:bg-slate-800/50 select-none",children:[c.jsxs("h3",{className:"text-xs font-bold text-gray-700 dark:text-slate-300 uppercase tracking-wider flex items-center gap-2",children:["ROI Analysis",c.jsxs("span",{className:"text-[10px] font-normal text-gray-400 bg-gray-200 dark:bg-slate-700 px-1.5 py-0.5 rounded",children:[Math.round(e.width),"",Math.round(e.height)]})]}),c.jsxs("div",{className:"flex items-center gap-1",children:[c.jsx("button",{onClick:r,className:"text-gray-400 hover:text-gray-600 dark:hover:text-slate-300 transition-colors p-1 rounded-md hover:bg-gray-200 dark:hover:bg-slate-700 relative z-20",children:c.jsx("svg",{className:"w-3.5 h-3.5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M20 12H4"})})}),c.jsx("button",{onClick:t,className:"text-gray-400 hover:text-red-500 dark:hover:text-red-400 transition-colors p-1 rounded-md hover:bg-gray-200 dark:hover:bg-slate-700 relative z-20",children:c.jsx("svg",{className:"w-3.5 h-3.5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]})]}),c.jsxs("div",{className:"p-3",children:[c.jsxs("div",{className:"flex justify-between items-center mb-3",children:[c.jsxs("div",{className:"text-[10px] text-gray-400 dark:text-slate-500 font-mono leading-tight",children:["X: ",Math.round(e.x),c.jsx("br",{}),"Y: ",Math.round(e.y)]}),c.jsx("button",{onClick:()=>a(!n),className:"text-[10px] font-bold px-2 py-1 rounded bg-gray-100 hover:bg-gray-200 dark:bg-slate-800 dark:hover:bg-slate-700 text-gray-600 dark:text-slate-300 transition-colors border border-gray-200 dark:border-slate-700 relative z-20",title:"Toggle Bayer Pattern Interpretation",children:n?"BGGR":"RGGB"})]}),c.jsxs("table",{className:"w-full mb-3",children:[c.jsx("thead",{children:c.jsxs("tr",{className:"text-[10px] text-gray-400 dark:text-slate-500 border-b border-gray-100 dark:border-slate-800",children:[c.jsx("th",{className:"text-left pb-1 font-medium",children:"Ch"}),c.jsxs("th",{className:"text-right pb-1 font-medium",children:["Mean",p?"*":""]}),c.jsx("th",{className:"text-right pb-1 font-medium",children:"Std()"}),f&&c.jsx("th",{className:"text-right pb-1 font-medium text-cyan-600 dark:text-cyan-400",children:"k"}),m&&c.jsx("th",{className:"text-right pb-1 font-medium text-indigo-600 dark:text-indigo-400",children:"Unmix"})]})}),c.jsx("tbody",{className:"font-mono text-xs",children:x.map((w,_)=>c.jsxs("tr",{className:"group hover:bg-gray-50 dark:hover:bg-slate-800/30 transition-colors",children:[c.jsxs("td",{className:"py-1",children:[c.jsx("span",{className:`font-bold ${w.color}`,children:w.name}),c.jsx("span",{className:"text-[9px] text-gray-300 dark:text-slate-600 ml-1 hidden group-hover:inline",children:w.desc})]}),c.jsx("td",{className:"py-1 text-right text-gray-700 dark:text-slate-200 font-semibold",children:w.mean.toFixed(2)}),c.jsx("td",{className:"py-1 text-right text-gray-500 dark:text-slate-400",children:w.std.toFixed(2)}),f&&c.jsx("td",{className:"py-1 text-right text-cyan-600 dark:text-cyan-400 font-bold",children:w.snr!==null?w.snr.toFixed(2):"-"}),m&&c.jsx("td",{className:"py-1 text-right text-indigo-600 dark:text-indigo-400 font-bold",children:w.unmixed!==null?w.unmixed.toFixed(1):"-"})]},_))})]}),p&&c.jsx("div",{className:"mb-2 text-[9px] text-gray-400 dark:text-slate-500 text-right italic",children:"* Mean adjusted by Black Level"}),c.jsxs("div",{className:"flex flex-wrap gap-2",children:[c.jsx("button",{onClick:()=>i("histogram"),className:"relative z-20 flex-1 min-w-[50px] py-1.5 bg-cyan-600 hover:bg-cyan-500 text-white text-[10px] font-bold uppercase tracking-wide rounded shadow-sm hover:shadow transition-all active:scale-95 flex items-center justify-center gap-1",children:"Hist"}),c.jsx("button",{onClick:()=>i("quant"),className:"relative z-20 flex-1 min-w-[50px] py-1.5 bg-teal-600 hover:bg-teal-500 text-white text-[10px] font-bold uppercase tracking-wide rounded shadow-sm hover:shadow transition-all active:scale-95 flex items-center justify-center gap-1",children:"Quant"}),c.jsx("button",{onClick:()=>i("fft"),className:"relative z-20 flex-1 min-w-[50px] py-1.5 bg-purple-600 hover:bg-purple-500 text-white text-[10px] font-bold uppercase tracking-wide rounded shadow-sm hover:shadow transition-all active:scale-95 flex items-center justify-center gap-1",children:"FFT"}),c.jsx("button",{onClick:()=>i("pearson"),className:"relative z-20 flex-1 min-w-[50px] py-1.5 bg-indigo-600 hover:bg-indigo-500 text-white text-[10px] font-bold uppercase tracking-wide rounded shadow-sm hover:shadow transition-all active:scale-95 flex items-center justify-center gap-1",children:"PCC"}),c.jsx("button",{onClick:k,className:"relative z-20 flex-1 min-w-[50px] py-1.5 bg-pink-600 hover:bg-pink-500 text-white text-[10px] font-bold uppercase tracking-wide rounded shadow-sm hover:shadow transition-all active:scale-95 flex items-center justify-center gap-1",children:"ColorN"})]})]})]})},iae=()=>{var wd;const[e,t]=C.useState("init"),[r,n]=C.useState("Checking storage..."),[a,i]=C.useState(null),o=C.useRef(!1),[s,l]=C.useState("dark"),[u,f]=C.useState(!1);C.useEffect(()=>((async()=>{const ue=await $l.init();f(ue),console.log("WebGPU Available:",ue)})(),()=>{$l.disposeAll()}),[]),C.useEffect(()=>{const Z=window.document.documentElement;Z.classList.remove(s==="dark"?"light":"dark"),Z.classList.add(s)},[s]);const[d,p]=C.useState(!1),[m,v]=C.useState(!1),[b,k]=C.useState(!1),[x,y]=C.useState(!1),[w,_]=C.useState(!1),[S,j]=C.useState(!1),M=Dne(d||m||b),[A,$]=C.useState(!1),[E,T]=C.useState([]),[B,U]=C.useState(-1),[V,G]=C.useState([]),D=C.useMemo(()=>E[B],[E,B]),I=C.useRef(null);C.useEffect(()=>{I.current=D||null},[D]);const F=(D==null?void 0:D.file)||null,H=(D==null?void 0:D.imageElement)||null,W=(D==null?void 0:D.rawImageData)||null,Q=(D==null?void 0:D.rawFileBuffer)||null,q=(D==null?void 0:D.renderedRawImageData)||null,re=(D==null?void 0:D.referenceImageData)||null,ee=(D==null?void 0:D.sampledImageData)||null,fe=(D==null?void 0:D.exifData)||null,oe=(D==null?void 0:D.isThreePlane)||!1,ye=(D==null?void 0:D.xtransPhase)||{x:0,y:0},ae=(D==null?void 0:D.displaySettings)||{exposure:0,demosaicMethod:3,blackLevel:void 0,wbGains:[1,1],showKadc:!0,subtractBlackLevelFromStats:!0},[X,se]=C.useState(!1),[he,le]=C.useState(null),[je,ke]=C.useState(!1),[ve,ge]=C.useState(!1),[Me,Oe]=C.useState(null),[We,Le]=C.useState([]),[tt,mt]=C.useState(100),[wt,Qt]=C.useState(!0),[_t,Jt]=C.useState(!1),[Nt,er]=C.useState(null),[Vr,Tt]=C.useState(!1),[Sr,Ve]=C.useState(!1),[Pt,Bt]=C.useState(!1),[Dt,tr]=C.useState(!1),[rr,Hr]=C.useState(!1),[Ft,bn]=C.useState("1.0"),[Ct,tn]=C.useState(!1),[Ge,rn]=C.useState(!1),[Ar,sn]=C.useState(!1),[Xr,Tr]=C.useState(!1),[Cr,Er]=C.useState([]),[wn,kn]=C.useState(!1),[qt,Et]=C.useState(0),[fr,O]=C.useState([]),[De,ht]=C.useState(!1),[Vt,$t]=C.useState({x:0,y:0}),[mr,$r]=C.useState(!1),[nr,He]=C.useState(!1),[pt,It]=C.useState([]),[Ht,Ut]=C.useState(0),[Se,ln]=C.useState(null),[L,we]=C.useState(!1),[Ne,gt]=C.useState([]),[Xe,ot]=C.useState(.5),[ct,Yt]=C.useState(!1),[xr,hn]=C.useState(2),[Gt,Sn]=C.useState(1),[jn,Zn]=C.useState([]),[or,sr]=C.useState(null),[yr,Be]=C.useState(0),[Zt,jr]=C.useState([]),[Qn,Jn]=C.useState([]),[Kr,qa]=C.useState(64),[te,me]=C.useState(10),[be,Y]=C.useState(10),[Ae,at]=C.useState(4),[rt,Lt]=C.useState(1),[dt,yt]=C.useState(0),[dr,ar]=C.useState("processed"),[cr,hr]=C.useState(!1),Pe=C.useMemo(()=>ae.blackLevel?ae.blackLevel:W!=null&&W.blackLevels?[W.blackLevels[0],W.blackLevels[1],W.blackLevels[2],W.blackLevels[3]]:[0,0,0,0],[ae.blackLevel,W]),ut=(fe==null?void 0:fe.ImageHeight)||(fe==null?void 0:fe.ExifImageHeight)||(W==null?void 0:W.height)||0,[Qe,Je]=C.useState(null),[Xt,lt]=C.useState(null),[zt,Nr]=C.useState({x:0,y:0}),[Dr,ma]=C.useState(1),[mi,Oo]=C.useState("pan"),yi=C.useRef(null),Ya=C.useRef(null);C.useEffect(()=>{if(u&&D&&D.rawImageData&&D.id){const{data:Z,width:ue,height:ce}=D.rawImageData;$l.uploadImage(D.id,Z,ue,ce)}},[u,D==null?void 0:D.id]),C.useEffect(()=>{const Z=zne();Z&&Z.sessions.length>0?(i(Z),t("prompt")):t("idle")},[]),C.useCallback(async()=>{o.current=!0,n("Cleaning up..."),localStorage.removeItem("jtr_workspace_index");try{await Une()}catch(Z){console.error("Failed to clear DB",Z)}t("idle"),i(null),o.current=!1},[]),C.useCallback(async()=>{if(!a)return;t("restoring"),n("Restoring layout...");const Z=a;if(l(Z.theme),Qt(Z.sidebarOpen),Z.sessions.length>0){n(`Restoring ${Z.sessions.length} images...`);const ue=[];for(const ce of Z.sessions){if(o.current)return;await new Promise(pe=>setTimeout(pe,50));try{const pe=await Fne(ce.id);if(pe){const Re={id:ce.id,fileName:ce.fileName,file:null,imageElement:null,rawImageData:null,rawFileBuffer:pe,renderedRawImageData:null,referenceImageData:null,sampledImageData:null,exifData:null,isThreePlane:ce.isThreePlane,displaySettings:ce.displaySettings,originalRawFileBuffer:null,isXTransOriginal:!1,isXTransConverted:!1,xtransPhase:{x:0,y:0}},{previewBlob:Ce,analysisData:Ze}=await Ml(pe);let ze=null;if(Ze)try{ce.displaySettings.renderMode==="zero-dependency"?ze=await vm(pe,ce.displaySettings):ce.displaySettings.renderMode==="advanced-zero-dep"?ze=await rA(pe,ce.displaySettings):ce.displaySettings.renderMode==="zero-dep-color"?ze=await tA(pe,ce.displaySettings):ze=await eA(pe,ce.displaySettings)}catch(ft){console.error("Render failed",ft),ze=await vm(pe,ce.displaySettings)}const st=URL.createObjectURL(Ce),nt=new Image;nt.src=st,await new Promise(ft=>{nt.onload=()=>ft()}),ue.push({...Re,rawImageData:Ze,renderedRawImageData:ze,previewUrl:st,imageElement:nt,exifData:Ze.metadata})}}catch(pe){console.error(`Failed to restore session ${ce.id}`,pe)}}if(o.current)return;if(T(ue),Z.activeSessionId){const ce=ue.findIndex(pe=>pe.id===Z.activeSessionId);ce>=0?U(ce):ue.length>0&&U(0)}Le(Z.windows)}o.current||t("idle")},[a]);const Ia=C.useCallback(async()=>{Bt(!1);const Z=D;if(u&&Z&&Z.id&&$l.hasImage(Z.id)&&(Z.displaySettings.renderMode||"standard")!=="standard"){lt("Exporting via WebGPU...");try{const pe=await $l.export16Bit(Z.id,Z.displaySettings,Dt,rr);if(pe){const Re=b3(Z.rawImageData.width,Z.rawImageData.height,pe,3),Ce=new Blob([Re],{type:"image/tiff"}),Ze=URL.createObjectURL(Ce),ze=document.createElement("a");ze.href=Ze,ze.download=`export_webgpu_${Date.now()}.tiff`,document.body.appendChild(ze),ze.click(),document.body.removeChild(ze),URL.revokeObjectURL(Ze),lt(null);return}}catch(pe){console.error("WebGPU Export Failed, falling back to CPU",pe)}}!Q||!D||(lt("Exporting 16-bit TIFF (CPU)..."),setTimeout(async()=>{try{const ue=await nA(Q,ae,Dt,rr),ce=b3(ue.width,ue.height,ue.data,ue.channels),pe=new Blob([ce],{type:"image/tiff"}),Re=URL.createObjectURL(pe),Ce=document.createElement("a");Ce.href=Re,Ce.download=`export_${Date.now()}.tiff`,document.body.appendChild(Ce),Ce.click(),document.body.removeChild(Ce),URL.revokeObjectURL(Re)}catch(ue){Je("Export failed: "+ue.message)}finally{lt(null)}},100))},[Q,D,ae,Dt,rr,u]),Dn=C.useCallback(()=>{!Q||!D||Bt(!0)},[Q,D]),Ss=C.useCallback(async()=>{},[W,D,Ft,Pe]);C.useEffect(()=>{const Z=ue=>{(ue.ctrlKey||ue.metaKey)&&ue.key.toLowerCase()==="s"&&(ue.preventDefault(),Dn())};return window.addEventListener("keydown",Z),()=>window.removeEventListener("keydown",Z)},[Dn]);const Ri=C.useRef(null),ie=C.useCallback(()=>{e==="idle"&&(Ri.current&&clearTimeout(Ri.current),Ri.current=window.setTimeout(async()=>{var ce;const Z={version:1,timestamp:Date.now(),activeSessionId:((ce=E[B])==null?void 0:ce.id)||null,theme:s,sidebarOpen:wt,sessions:E.map(pe=>({id:pe.id,fileName:pe.fileName,fileType:pe.file?pe.file.type:"application/octet-stream",fileSize:pe.rawFileBuffer?pe.rawFileBuffer.byteLength:0,displaySettings:pe.displaySettings,isThreePlane:pe.isThreePlane})),windows:We.map(pe=>({id:pe.id,type:pe.type,roi:pe.roi,zIndex:pe.zIndex,initialPosition:pe.initialPosition,sessionId:pe.sessionId,isBGGR:pe.isBGGR,isMinimized:pe.isMinimized||!1,internalState:pe.internalState}))};Gne(Z);const ue=E.map(pe=>pe.id);Wne(ue)},1e3))},[E,We,B,s,wt,e]);C.useEffect(()=>{ie()},[ie]);const _e=C.useCallback(Z=>{T(ue=>ue.map((ce,pe)=>pe===B?{...ce,...Z}:ce))},[B]),kt=()=>U(Z=>Math.min(Z+1,E.length-1)),vt=()=>U(Z=>Math.max(0,Z-1));C.useEffect(()=>{if(W&&he){const Z=Ns(W.data,W.width,W.height,he.x,he.y,he.width,he.height);le(Z)}},[W]);const Ir=Z=>{if(!he||!D)return;const ue=Date.now().toString()+Math.random().toString().slice(2,5),ce=Math.max(tt,...We.map(Ce=>Ce.zIndex),100),pe=We.length%10*30,Re=Z==="fft"?{x:50,y:50}:Z==="histogram"?{x:100,y:100}:{x:150,y:150};Le(Ce=>[...Ce,{id:ue,type:Z,roi:{x:he.x,y:he.y,w:he.width,h:he.height},zIndex:ce+1,initialPosition:{x:Re.x+pe,y:Re.y+pe},sessionId:D.id,isBGGR:je,isMinimized:!1,stackFiles:(Z==="fft"||Z==="pearson"||Z==="histogram")&&V.length>0?V:void 0}])},_n=Z=>{Le(ue=>ue.filter(ce=>ce.id!==Z))},br=Z=>{Le(ue=>ue.map(ce=>ce.id===Z?{...ce,isMinimized:!0}:ce))},Ie=Z=>{Le(ue=>ue.map(ce=>ce.id===Z?{...ce,isMinimized:!1}:ce)),Mt(Z)},Mt=Z=>{Le(ue=>{const ce=Math.max(tt,...ue.map(pe=>pe.zIndex));return ue.map(pe=>pe.id===Z?{...pe,zIndex:ce+1}:pe)})},St=(Z,ue)=>{Le(ce=>ce.map(pe=>pe.id===Z?{...pe,internalState:{...pe.internalState,...ue}}:pe))},xt=()=>{const Z=Math.max(tt,...We.map(ue=>ue.zIndex));mt(Z+1)},qr=(Z,ue)=>{Le(ce=>ce.map(pe=>pe.id===Z?{...pe,roi:ue}:pe))};C.useEffect(()=>{if(!fe)return;const Z=fe.CFAPattern2||fe.CFAPattern;if(Z){let ue="";Array.isArray(Z)?ue=Z.join(""):typeof Z=="string"?ue=Z.replace(/[\s,]+/g,""):typeof Z=="number"&&(ue=String(Z)),ue==="0112"?ke(!1):ue==="2110"&&ke(!0)}},[fe]),C.useEffect(()=>{let Z;const ue=()=>{if(ct&&De){const ce=Date.now()/1e3,pe=.55+.45*Math.sin(ce*xr);Sn(pe),Z=requestAnimationFrame(ue)}else Sn(1)};return ct&&De?ue():Sn(1),()=>{Z&&cancelAnimationFrame(Z)}},[ct,De,xr]),C.useEffect(()=>{const Z=ue=>{ue.key==="Escape"&&De&&(ht(!1),$t({x:0,y:0}),Yt(!1))};return window.addEventListener("keydown",Z),()=>window.removeEventListener("keydown",Z)},[De]),C.useEffect(()=>()=>{E.forEach(Z=>{Z.previewUrl&&URL.revokeObjectURL(Z.previewUrl)}),Ya.current&&Ya.current.terminate()},[]);const Kt=async(Z,ue=!0)=>{ue&&(Nr({x:0,y:0}),ma(1),Be(0),jr([]),Jn([]),Jt(!1),er(null),se(!1),He(!1),It([]),gt([]),Ut(0),Er([]));let ce=null;if(M.isConnected){const ze=new FormData;ze.append("file",Z);try{const nt=await(await fetch("http://localhost:5428/read",{method:"POST",body:ze})).json();if(nt.success){let ft=nt.data;Array.isArray(ft)&&ft.length===1&&(ft=ft[0]),ce=ft}}catch(st){console.warn("Auto Exif fetch failed",st)}}const pe=Z.name.toLowerCase().match(/\.(arw|cr2|cr3|dng|nef|orf|raf|rw2|pef|srw|sr2|srf|x3f|erf|mef|mos|mrw|kdc|dcr|iiq|3fr|fff|rwl|nrw|raw|tif|tiff)$/);if(!(["image/jpeg","image/png","image/tiff","image/x-adobe-dng"].includes(Z.type)||pe)){Je("Unsupported file type. Please load a JPG, PNG, or a supported RAW file.");return}let Ce={file:Z,exifData:ce};if(pe||Z.type==="image/x-adobe-dng")try{ue?lt("Processing RAW file (this may take a moment)..."):hr(!0);const ze=await Z.arrayBuffer();Ce.rawFileBuffer=ze;const{previewBlob:st,analysisData:nt}=await Ml(ze);Ce.rawImageData=nt,!ce&&nt.metadata&&(Ce.exifData=nt.metadata),Ce.isThreePlane=nt.isThreePlane||!1,nt.isThreePlane&&ue&&se(!0);let ft=!1,ur=null,_r=!1;if(nt.isXTrans){_r=!0,ur=ze;const Mn=(await Wd(ze,0,0)).dngBuffer,cn=await Ml(Mn);Ce.rawFileBuffer=Mn,Ce.rawImageData=cn.analysisData,Ce.previewUrl=URL.createObjectURL(cn.previewBlob),ft=!0}else Ce.previewUrl=URL.createObjectURL(st);Ce.originalRawFileBuffer=ur,Ce.isXTransOriginal=_r,Ce.isXTransConverted=ft,Ce.xtransPhase={x:0,y:0};const Ur=new Image;if(Ur.src=Ce.previewUrl||"",await new Promise((ta,Mn)=>{Ur.onload=()=>{Ce.imageElement=Ur,ta()},Ur.onerror=()=>{ta()}}),ue){const ta=Ce.rawImageData||nt,Mn=nae(ta,ce||ta.metadata);let cn;Mn&&Mn.some(Gr=>Gr>0)&&(cn=Mn);const Lr={exposure:0,demosaicMethod:-1,blackLevel:cn,wbGains:[1,1],showKadc:!1,subtractBlackLevelFromStats:!1,renderMode:"zero-dependency"},nn=Ce.rawFileBuffer;if(nn&&(pe||Z.type==="image/x-adobe-dng"))try{const Gr=await vm(nn,Lr);Ce.renderedRawImageData=Gr,Ce.displaySettings=Lr}catch(Gr){console.error("Initial Zero-Dep Render Failed",Gr)}}}catch(ze){Je(`Failed to process RAW file: ${ze.message}`),lt(null),hr(!1);return}else try{lt("Processing image...");const{previewBlob:ze,analysisData:st}=await H6(Z);Ce.rawImageData=st,!ce&&st.metadata&&(Ce.exifData=st.metadata),Ce.rawFileBuffer=await Z.arrayBuffer(),Ce.isThreePlane=st.isThreePlane||!1,Ce.isXTransOriginal=!1,Ce.isXTransConverted=!1,Ce.originalRawFileBuffer=null;const nt=URL.createObjectURL(ze);Ce.previewUrl=nt;const ft=new Image;ft.src=nt,await new Promise(ur=>{ft.onload=()=>{Ce.imageElement=ft,ur()},ft.onerror=()=>{Je("Could not load the image file."),ur()}})}catch(ze){Je(`Failed to process image: ${ze.message}`),lt(null);return}const Ze=Date.now().toString()+Math.random();if(Ce.rawFileBuffer&&await Bne(Ze,Ce.rawFileBuffer),ue){const ze={exposure:0,demosaicMethod:-1,blackLevel:void 0,wbGains:[1,1],showKadc:!1,subtractBlackLevelFromStats:!1,renderMode:"zero-dependency"},st={id:Ze,fileName:Z.name,file:Z,imageElement:null,rawImageData:null,rawFileBuffer:null,renderedRawImageData:null,referenceImageData:null,sampledImageData:null,exifData:null,isThreePlane:!1,displaySettings:ze,originalRawFileBuffer:null,isXTransOriginal:!1,isXTransConverted:!1,xtransPhase:{x:0,y:0},...Ce};T(nt=>{const ft=[...nt,st];return U(ft.length-1),ft})}else _e(Ce);lt(null),hr(!1)},ea=C.useCallback(async()=>{const Z=l0,ue=l0,ce=new Uint16Array(Z*ue),pe=Math.max(2,Ae),Re=dt*pe;for(let st=0;st<ue;st++)for(let nt=0;nt<Z;nt++){const ft=.5+.5*Math.sin(2*Math.PI*(nt+Re)/pe);ce[st*Z+nt]=Math.round(1e3+ft*9e3)}const Ce=w0(Z,ue,ce,[0,0,0,0],16383,"RGGB"),Ze=new Blob([Ce],{type:"image/x-adobe-dng"}),ze=new File([Ze],"pattern_test.dng",{type:"image/x-adobe-dng"});await Kt(ze,(F==null?void 0:F.name)!=="pattern_test.dng")},[Ae,dt,rt,F]),Za=Z=>{var ce;const ue=(ce=Z.target.files)==null?void 0:ce[0];ue&&Kt(ue,!0)},Di=async(Z,ue)=>{if(ue==="convert"){lt("Converting RAW via Bridge...");try{const ce=new FormData;ce.append("file",Z);const pe=await fetch("http://localhost:5428/convert",{method:"POST",body:ce});if(!pe.ok)throw new Error("Conversion failed on server");const Re=await pe.blob(),Ce=new File([Re],Z.name.replace(/\.[^/.]+$/,"")+".dng",{type:"image/x-adobe-dng"});await Kt(Ce,!0)}catch(ce){Je("DNG Conversion Failed: "+ce.message)}finally{lt(null)}}else Kt(Z,!0)},Qa=async(Z,ue,ce,pe)=>{lt("Processing Pair Difference...");try{const Re=await Z.arrayBuffer(),Ce=await ue.arrayBuffer(),Ze=await ym(Re,Ce,ce,pe),ze=w0(Ze.width,Ze.height,Ze.rawData,[32768,32768,32768,32768],65535,"RGGB"),st=new Blob([ze],{type:"image/x-adobe-dng"}),nt=new File([st],`Diff_${Z.name}_${ue.name}.dng`,{type:"image/x-adobe-dng"});await Kt(nt,!0)}catch(Re){Je("Pair Processing Failed: "+Re.message)}finally{lt(null)}},Yr=async Z=>{const ue=Array.from(Z).sort((ce,pe)=>ce.name.localeCompare(pe.name,void 0,{numeric:!0}));if(ue.length<2){Je("Need at least 2 files for batch diff.");return}lt("Batch Difference Processing...");try{for(let ce=0;ce<ue.length-1;ce+=2){const pe=ue[ce],Re=ue[ce+1];lt(`Processing pair ${ce/2+1}: ${pe.name} - ${Re.name}`);const Ce=await pe.arrayBuffer(),Ze=await Re.arrayBuffer(),ze=await ym(Ce,Ze,!1,!0),st=w0(ze.width,ze.height,ze.rawData,[32768,32768,32768,32768],65535,"RGGB"),nt=new Blob([st],{type:"image/x-adobe-dng"}),ft=URL.createObjectURL(nt),ur=document.createElement("a");ur.href=ft,ur.download=`Diff_${pe.name}_vs_${Re.name}.dng`,document.body.appendChild(ur),ur.click(),document.body.removeChild(ur),URL.revokeObjectURL(ft),await new Promise(_r=>setTimeout(_r,200))}}catch(ce){Je("Batch Diff Failed: "+ce.message)}finally{lt(null)}},pd=Z=>{G(Array.from(Z)),lt(`Loaded ${Z.length} files for Stack FFT. Open Stack Lab to process.`),setTimeout(()=>lt(null),2e3)},js=()=>{Tt(!0)},jl=()=>{Tt(!1),ar("sampled"),lt("Generating..."),setTimeout(()=>ea(),50)},_s=C.useRef({period:Ae,fill:rt,phase:dt});C.useEffect(()=>{(F==null?void 0:F.name)==="pattern_test.dng"&&(_s.current.period!==Ae||_s.current.fill!==rt||_s.current.phase!==dt)&&(_s.current={period:Ae,fill:rt,phase:dt},ea())},[Ae,rt,dt,F]);const dg=C.useCallback(async Z=>{var pe;if(_e({displaySettings:Z}),!I.current)return;const ue=I.current.id;if(Z.renderMode==="zero-dependency"||Z.renderMode==="zero-dep-color"||Z.renderMode==="advanced-zero-dep")if(u)try{hr(!0);const Re=((pe=I.current.rawImageData)==null?void 0:pe.whiteLevel)||16383,Ce=await $l.render(ue,Z,Re);if(Ce){_e({renderedRawImageData:Ce}),hr(!1);return}else throw new Error("WebGPU returned null frame.")}catch(Re){console.error("WebGPU Render failed:",Re),hr(!1);return}else{Je("WebGPU not ready/supported. These modes require WebGPU.");return}if(!Q)return;hr(!0),Ya.current&&Ya.current.terminate();const ce=new Worker(new URL("/assets/renderWorker-DjzFrYUC.js",import.meta.url),{type:"module"});Ya.current=ce,ce.onmessage=Re=>{const{success:Ce,imageData:Ze,error:ze}=Re.data;if(Ce){let st=Ze;(F==null?void 0:F.name)==="pattern_test.dng"&&(st=rae(Ze,l0,l0)),_e({renderedRawImageData:st})}else Je(ze||"Unknown worker error");hr(!1),ce.terminate(),Ya.current=null},ce.postMessage({buffer:Q.slice(0),settings:Z})},[Q,F,_e,u]),hg=async(Z,ue)=>{lt("Re-sampling X-Trans with new Phase...");try{const pe=(await Wd(ue,Z.x,Z.y)).dngBuffer,Re=await Ml(pe),Ce=URL.createObjectURL(Re.previewBlob),Ze=new Image;Ze.src=Ce,await new Promise(ze=>{Ze.onload=()=>ze()}),D!=null&&D.previewUrl&&URL.revokeObjectURL(D.previewUrl),_e({rawFileBuffer:pe,rawImageData:Re.analysisData,previewUrl:Ce,imageElement:Ze,xtransPhase:Z}),le(null)}catch(ce){console.error("X-Trans Phase Update Failed",ce),Je("Phase Update Failed: "+ce.message)}finally{lt(null)}},ou=Z=>{if(!D||!D.originalRawFileBuffer||!D.isXTransConverted)return;const ue={...D.xtransPhase,...Z};hg(ue,D.originalRawFileBuffer)},pg=C.useCallback(async Z=>{if(D)if(Z){if(D.isXTransConverted)return;const ue=D.originalRawFileBuffer||D.rawFileBuffer;if(!ue)return;lt("Converting X-Trans to Pseudo-Bayer DNG...");try{const ce=D.xtransPhase||{x:0,y:0},Re=(await Wd(ue,ce.x,ce.y)).dngBuffer,Ce=await Ml(Re),Ze=URL.createObjectURL(Ce.previewBlob),ze=new Image;ze.src=Ze,await new Promise(st=>{ze.onload=()=>st()}),D.previewUrl&&URL.revokeObjectURL(D.previewUrl),_e({rawFileBuffer:Re,rawImageData:Ce.analysisData,previewUrl:Ze,imageElement:ze,isXTransConverted:!0,originalRawFileBuffer:ue}),le(null)}catch(ce){console.error("X-Trans Conversion Failed",ce),Je("Failed to convert X-Trans: "+ce.message)}finally{lt(null)}}else{if(!D.isXTransConverted)return;const ue=D.originalRawFileBuffer;if(!ue){Je("Original X-Trans buffer lost. Cannot revert.");return}lt("Reverting to Native X-Trans...");try{const ce=await Ml(ue),pe=URL.createObjectURL(ce.previewBlob),Re=new Image;Re.src=pe,await new Promise(Ce=>{Re.onload=()=>Ce()}),D.previewUrl&&URL.revokeObjectURL(D.previewUrl),_e({rawFileBuffer:ue,rawImageData:ce.analysisData,previewUrl:pe,imageElement:Re,isXTransConverted:!1}),le(null)}catch(ce){console.error("X-Trans Revert Failed",ce),Je("Failed to revert X-Trans: "+ce.message)}finally{lt(null)}}},[D,_e]),gd=Z=>{if(yi.current){const ue=yi.current,{width:ce,height:pe}=ue.getBoundingClientRect(),Re=ce/2,Ce=pe/2,Ze=Z/Dr,ze=Re-(Re-zt.x)*Ze,st=Ce-(Ce-zt.y)*Ze;Nr({x:ze,y:st})}ma(Z)},md=Z=>{if(!Z)return;if(!W){le(null);return}if(wn){Z.w>0&&Z.h>0&&Er(ce=>[...ce,Z]);return}ve&&ge(!1);const ue=Ns(W.data,W.width,W.height,Z.x,Z.y,Z.w,Z.h);le(ue)},gg=Z=>{Oe(Z),md(Z)},mg=()=>{Oo(Z=>Z==="pan"?"select":"pan")},su=(Z,ue,ce)=>{Er(pe=>{if(pe.length===0)return pe;if(Z==="move")return pe.map(Re=>({...Re,x:Re.x+ue,y:Re.y+ce}));if(Z==="scale"){const Re=pe.reduce((Ze,ze)=>Ze+ze.x+ze.w/2,0)/pe.length,Ce=pe.reduce((Ze,ze)=>Ze+ze.y+ze.h/2,0)/pe.length;return pe.map(Ze=>{const ze=Ze.x+Ze.w/2,st=Ze.y+Ze.h/2,nt=Re+(ze-Re)*ue,ft=Ce+(st-Ce)*ce,ur=Ze.w*ue,_r=Ze.h*ce;return{...Ze,x:nt-ur/2,y:ft-_r/2,w:ur,h:_r}})}return pe})},yg=()=>{if(Cr.length===0){Je("No ROIs to save.");return}let Z=`Index,X,Y,W,H,Orientation
`;Cr.forEach((Re,Ce)=>{Z+=`${Ce+1},${Re.x.toFixed(2)},${Re.y.toFixed(2)},${Re.w.toFixed(2)},${Re.h.toFixed(2)},${Re.ori||0}
`});const ue=new Blob([Z],{type:"text/csv;charset=utf-8;"}),ce=URL.createObjectURL(ue),pe=document.createElement("a");pe.setAttribute("href",ce),pe.setAttribute("download",`sfr_plate_template_${Date.now()}.csv`),document.body.appendChild(pe),pe.click(),document.body.removeChild(pe),URL.revokeObjectURL(ce)},vg=Z=>{if(!Z||Z.length===0){Je("No valid ROIs found in file.");return}Er(ue=>[...ue,...Z])},yd=Z=>{if(Cr.length===0){Je("ROIs ");return}if(!W||ae.renderMode!=="advanced-zero-dep"){Je("Advanced Zero-Dep (Unmixed) mode required for scalar SFR calc.");return}lt("Computing Batch SFR..."),setTimeout(()=>{try{const ue=[];for(const ce of Cr){const pe=E1(W,ce,ae),Re=Mx(pe.data,pe.width,pe.height,{x:0,y:0,w:pe.width,h:pe.height},{greenOnly:Z.greenOnly,globalX:ce.x,globalY:ce.y,bayerPattern:W.bayerPattern});if(Re){const Ce=Z.useNR?-1:12,Ze=$N([Re],Ce,null,Z.useDeshading);Ze&&Ze.mtf50!==null&&ue.push({x:ce.x+ce.w/2,y:ce.y+ce.h/2,mtf50:Ze.mtf50,orientation:Re.orientation})}}if(ue.length>0){const ce=ue.map(pe=>`{${pe.x.toFixed(1)},${pe.y.toFixed(1)},${pe.mtf50.toFixed(4)},${pe.orientation}}`).join("");navigator.clipboard.writeText(ce).then(()=>alert(`Computed ${ue.length}/${Cr.length} ROIs. Copied results to clipboard.`)).catch(pe=>Je("Failed to copy results: "+pe))}else Je("Failed to compute valid SFR for any selected ROIs.")}catch(ue){Je("Batch Compute Failed: "+ue.message)}finally{lt(null)}},100)},xg=Z=>{if(yr===0||yr>4)return;const ue=[...Zt,Z];jr(ue),yr===4?(bg(ue),Be(0)):Be(yr+1)},vd=(Z,ue,ce,pe)=>{const Re=Z[0],Ce=Z[1],Ze=Z[2],ze=Z[3],st=ue/2,nt=[];for(let ft=0;ft<ce;ft++){const ur=ce>1?ft/(ce-1):.5;for(let _r=0;_r<pe;_r++){const Ur=pe>1?_r/(pe-1):.5,ta=Re.x*(1-Ur)+Ce.x*Ur,Mn=Re.y*(1-Ur)+Ce.y*Ur,cn=Ze.x*(1-Ur)+ze.x*Ur,Lr=Ze.y*(1-Ur)+ze.y*Ur,nn=ta*(1-ur)+cn*ur,Gr=Mn*(1-ur)+Lr*ur,Ca=nn-st,In=Gr-st;nt.push({x:Ca,y:In,w:ue,h:ue})}}return nt},bg=Z=>{!W||!D||(lt("Calculating DR Lab Grid..."),setTimeout(()=>{try{const ue=vd(Z,Kr,te,be);Jn(ue);const Ce=[...[`#BlackLevel: ${(ae.blackLevel||[0,0,0,0]).join(",")}`,`#ImageHeight: ${W.height}`],"Filename,Row,Col,R_Mean,G1_Mean,G2_Mean,B_Mean,R_Std,G1_Std,G2_Std,B_Std"],Ze=`img${D.fileName||"image"}`;ue.forEach((ur,_r)=>{const Ur=Math.floor(_r/be)+1,ta=_r%be+1,Mn=Ns(W.data,W.width,W.height,ur.x,ur.y,ur.w,ur.h),cn=Mn.means,Lr=Mn.stdDevs,nn=`${Ze},${Ur},${ta},${cn[0].toFixed(4)},${cn[1].toFixed(4)},${cn[2].toFixed(4)},${cn[3].toFixed(4)},${Lr[0].toFixed(4)},${Lr[1].toFixed(4)},${Lr[2].toFixed(4)},${Lr[3].toFixed(4)}`;Ce.push(nn)});const ze=Ce.join(`
`),st=new Blob([ze],{type:"text/csv;charset=utf-8;"}),nt=URL.createObjectURL(st),ft=document.createElement("a");ft.setAttribute("href",nt),ft.setAttribute("download","dr_lab_results.csv"),document.body.appendChild(ft),ft.click(),document.body.removeChild(ft),URL.revokeObjectURL(nt),jr([])}catch(ue){Je("DR Lab Error: "+ue.message)}finally{lt(null)}},100))},wg=async(Z,ue)=>{if(Zt.length<4&&Qn.length<1){Je("Please mark the grid on an image first before running batch processing.");return}let ce=Qn;if(ce.length===0&&Zt.length===4&&(ce=vd(Zt,Kr,te,be)),ce.length===0){Je("No grid definitions found. Mark corners first.");return}lt(ue==="pair"?"Batch Pair Difference (Sigma = Diff/sqrt(2))":"Batch Processing...");const Re=(ae.blackLevel||[0,0,0,0]).join(","),Ce=W?W.height:0,ze=[...[`#BlackLevel: ${Re}`,`#ImageHeight: ${Ce}`,ue==="pair"?"#Mode: Pair Difference (Sigma = Diff/sqrt(2), Full Float Stats)":"#Mode: Independent"],"Filename,Row,Col,R_Mean,G1_Mean,G2_Mean,B_Mean,R_Std,G1_Std,G2_Std,B_Std"],st=Array.from(Z).sort((_r,Ur)=>_r.name.localeCompare(Ur.name,void 0,{numeric:!0}));if(ue==="pair"&&st.length<2){Je("Need at least 2 files for Pair processing."),lt(null);return}const nt=I.current,ft=(nt==null?void 0:nt.isXTransConverted)||!1,ur=(nt==null?void 0:nt.xtransPhase)||{x:0,y:0};try{const _r=async Lr=>{let nn=await Lr.arrayBuffer();return ft&&(nn=(await Wd(nn,ur.x,ur.y)).dngBuffer),nn};if(ue==="single")for(let Lr=0;Lr<st.length;Lr++){const nn=st[Lr];lt(`Processing ${Lr+1}/${st.length}: ${nn.name}...`);const Gr=await _r(nn),Ca=await pc(Gr),In=`img${nn.name}`;ce.forEach((ra,ro)=>{const Ii=Math.floor(ro/te)+1,La=ro%be+1,Ps=Ns(Ca.data,Ca.width,Ca.height,ra.x,ra.y,ra.w,ra.h),Ao=Ps.means,To=Ps.stdDevs,cu=`${In},${Ii},${La},${Ao[0].toFixed(4)},${Ao[1].toFixed(4)},${Ao[2].toFixed(4)},${Ao[3].toFixed(4)},${To[0].toFixed(4)},${To[1].toFixed(4)},${To[2].toFixed(4)},${To[3].toFixed(4)}`;ze.push(cu)})}else for(let Lr=0;Lr<st.length-1;Lr+=2){const nn=st[Lr],Gr=st[Lr+1],Ca=`img${nn.name} & ${Gr.name}`;lt(`Processing Pair ${Math.floor(Lr/2)+1}/${Math.floor(st.length/2)}: ${nn.name} & ${Gr.name}...`);const In=await _r(nn),ra=await pc(In),ro=await _r(Gr),Ii=await ym(In,ro,!1,!1);ce.forEach((La,Ps)=>{const Ao=Math.floor(Ps/te)+1,To=Ps%be+1,cu=Ns(ra.data,ra.width,ra.height,La.x,La.y,La.w,La.h),Eg=Ns(Ii.rawData,Ii.width,Ii.height,La.x,La.y,La.w,La.h),Pl=cu.means,Cl=Eg.stdDevs.map(Rg=>Rg/1.41421356),$g=`${Ca},${Ao},${To},${Pl[0].toFixed(4)},${Pl[1].toFixed(4)},${Pl[2].toFixed(4)},${Pl[3].toFixed(4)},${Cl[0].toFixed(4)},${Cl[1].toFixed(4)},${Cl[2].toFixed(4)},${Cl[3].toFixed(4)}`;ze.push($g)})}const Ur=ze.join(`
`),ta=new Blob([Ur],{type:"text/csv;charset=utf-8;"}),Mn=URL.createObjectURL(ta),cn=document.createElement("a");cn.href=Mn,cn.setAttribute("download",`dr_lab_batch_${ue}_${new Date().getTime()}.csv`),document.body.appendChild(cn),cn.click(),document.body.removeChild(cn),URL.revokeObjectURL(Mn)}catch(_r){console.error("Batch Error",_r),Je("Batch Processing Failed: "+_r.message)}finally{lt(null)}},kg=()=>{It([]),Ut(1)},Sg=Z=>{if(!nr||Ht===0)return;const ue=[...pt,Z];It(ue),ue.length===4&&W?(xd(ue,Xe),Ut(0)):Ut(ce=>ce+1)},xd=(Z,ue)=>{W&&(lt("Analyzing Color Chart..."),setTimeout(()=>{try{const ce=ane(Z[0],Z[1],Z[2],Z[3],W.width,W.height,ue);gt(ce);const Re=ce.map((Ce,Ze)=>{const ze=Ns(W.data,W.width,W.height,Ce.x,Ce.y,Ce.w,Ce.h);return{id:Ze,rawMeans:ze.means,refRGB:[0,0,0]}}).map((Ce,Ze)=>({...Ce,refRGB:Nx[Ze]||[0,0,0]}));ln(Re),we(!0)}catch(ce){Je("Color Lab Error: "+ce.message)}finally{lt(null)}},100))},jg=Z=>{ot(Z),pt.length===4&&xd(pt,Z)},_g=()=>{we(!1)},Pg=()=>{fe||er("No EXIF data found. The file might not contain metadata or it was stripped during processing."),Jt(!0)},Cg=async Z=>{lt("Parsing PTC Data...");const ue=[];let ce=null;try{for(let pe=0;pe<Z.length;pe++){const Ce=(await Z[pe].text()).split(`
`);let Ze=!0;for(const ze of Ce){const st=ze.trim();if(!st)continue;if(st.startsWith("#")){if(st.includes("BlackLevel:")){const ra=st.split(":")[1].trim().split(",");if(ra.length>=4){const ro=ra.map(Number);ce||(ce={}),ce.blackLevel=ro}}if(st.includes("ImageHeight:")){const ra=parseInt(st.split(":")[1].trim());isNaN(ra)||(ce||(ce={}),ce.height=ra)}continue}if(Ze){st.toLowerCase().includes("mean")&&st.toLowerCase().includes("std")&&(Ze=!1);continue}const nt=st.split(",");if(nt.length<5)continue;let ft=0,ur;isNaN(parseFloat(nt[0]))&&(ur=nt[0],ft=1);const _r=parseInt(nt[ft]),Ur=parseInt(nt[ft+1]),ta=parseFloat(nt[ft+2]),Mn=parseFloat(nt[ft+3]),cn=parseFloat(nt[ft+4]),Lr=parseFloat(nt[ft+5]),nn=parseFloat(nt[ft+6]),Gr=parseFloat(nt[ft+7]),Ca=parseFloat(nt[ft+8]),In=parseFloat(nt[ft+9]);!isNaN(ta)&&!isNaN(nn)&&ue.push({channel:"R",mean:ta,std:nn,filename:ur,row:_r,col:Ur}),!isNaN(Mn)&&!isNaN(Gr)&&ue.push({channel:"G1",mean:Mn,std:Gr,filename:ur,row:_r,col:Ur}),!isNaN(cn)&&!isNaN(Ca)&&ue.push({channel:"G2",mean:cn,std:Ca,filename:ur,row:_r,col:Ur}),!isNaN(Lr)&&!isNaN(In)&&ue.push({channel:"B",mean:Lr,std:In,filename:ur,row:_r,col:Ur})}}Zn(ue),sr(ce),p(!0)}catch(pe){console.error("PTC Parse Error",pe),Je("Failed to parse CSV files: "+pe.message)}finally{lt(null)}},Ng=()=>{if(!Q||!D)return;const Z=new Blob([Q],{type:"image/x-adobe-dng"}),ue=URL.createObjectURL(Z),ce=document.createElement("a");ce.href=ue;const pe=D.fileName||"image.dng",Re=pe.toLowerCase().endsWith(".dng")?pe:pe.replace(/\.[^/.]+$/,"")+".dng";ce.download=Re,document.body.appendChild(ce),ce.click(),document.body.removeChild(ce),URL.revokeObjectURL(ue)},Mg=()=>{Be(1),jr([]),Jn([])},lu=()=>{window.open("https://github.com/y-g-jiang/y-g-jiang.github.io/blob/main/drtest.png","_blank")},Og=C.useMemo(()=>Se?Se.map((Z,ue)=>({...Z,refRGB:Nx[ue]||[0,0,0]})):[],[Se]),Ag=()=>{Et(1),O([]),Er([])},Tg=Z=>{if(qt===0)return;const ue=[...fr,Z];if(O(ue),ue.length===4){Et(0);try{const ce=Yne(ue);Er(ce),yd({useNR:!0,useDeshading:!0,greenOnly:!1})}catch(ce){console.error("Standard Chart Gen Error",ce),Je("Failed to generate chart ROIs.")}}else Et(ce=>ce+1)};let _l=q||H;dr==="reference"&&re?_l=re:dr==="sampled"&&ee&&(_l=ee);const bd=Xt||cr;return c.jsxs("div",{className:"flex flex-col h-screen bg-[#d4d4d4] dark:bg-[#111111] text-black dark:text-gray-200 font-mono transition-colors duration-300 overflow-hidden",children:[c.jsx("div",{className:"p-4 pb-0 flex-shrink-0",children:c.jsx(p6,{onLoadImage:Za,onFileSelected:Di,onGenerateFakeDng:js,fileName:F?F.name:null,hasGeneratedData:(F==null?void 0:F.name)==="pattern_test.dng",viewMode:dr,onSetViewMode:ar,patternPeriod:Ae,onPatternPeriodChange:at,fillFactor:rt,onFillFactorChange:Lt,patternPhase:dt,onPatternPhaseChange:yt,showPatternControls:(F==null?void 0:F.name)==="pattern_test.dng",onOpenAbout:()=>Ve(!0),onShowExif:Pg,bridgeStatus:M,onBridgeClick:()=>$(!0),isDrLabOpen:Ct,onToggleDrLab:()=>{tn(!Ct),Be(0),jr([]),Jn([]),Ge&&rn(!1),nr&&He(!1),Ar&&sn(!1),Xr&&Tr(!1),Ut(0),gt([]),Er([]),kn(!1),Et(0)},isColorLabOpen:nr,onToggleColorLab:()=>{He(!nr),It([]),Ut(0),gt([]),Ct&&tn(!1),Ge&&rn(!1),Ar&&sn(!1),Xr&&Tr(!1),Er([]),kn(!1),Et(0)},isFftLabOpen:Ge,onToggleFftLab:()=>{rn(!Ge),Ct&&tn(!1),nr&&He(!1),Ar&&sn(!1),Xr&&Tr(!1),Ut(0),gt([]),Er([]),kn(!1),Et(0)},isSfrLabOpen:Ar,onToggleSfrLab:()=>{sn(!Ar),Ct&&tn(!1),nr&&He(!1),Ge&&rn(!1),Xr&&Tr(!1),Ut(0),gt([]),Er([]),kn(!1),Et(0)},isPsModeOpen:Xr,onTogglePsMode:()=>{Tr(!Xr),Ct&&tn(!1),Ge&&rn(!1),nr&&He(!1),Ar&&sn(!1),Ut(0),gt([]),Er([]),kn(!1),Et(0)},onGenerateTestPic:lu,onPTCFilesSelected:Cg,onDownloadDng:Ng,isThreePlane:oe,onOpenDatabase:()=>v(!0),isSidebarOpen:wt,onToggleSidebar:()=>Qt(!wt),stretchMultiplier:Ft,onStretchMultiplierChange:bn,onStretchDngExport:Ss,isRawLoaded:!!W,onOpenSaveZ8:()=>j(!0)})}),c.jsxs("div",{className:"flex flex-1 overflow-hidden p-4 pt-2 gap-4 relative",children:[c.jsxs("div",{className:"flex-1 relative bg-gray-200 dark:bg-black border-4 border-gray-500 dark:border-gray-700 shadow-[inset_2px_2px_8px_rgba(0,0,0,0.2)] overflow-hidden transition-colors duration-300",ref:yi,children:[bd&&c.jsxs("div",{className:"absolute bottom-4 right-4 z-50 flex items-center gap-2 bg-white/90 dark:bg-black/90 px-3 py-1.5 border-2 border-black dark:border-white shadow-[4px_4px_0px_black] dark:shadow-[4px_4px_0px_gray]",children:[c.jsx("div",{className:"w-4 h-4 border-2 border-black dark:border-white border-t-transparent animate-spin"}),c.jsx("span",{className:"text-xs font-bold text-black dark:text-white uppercase",children:Xt||"Processing..."})]}),u&&c.jsx("div",{className:"absolute top-2 left-2 z-30 pointer-events-none opacity-50 hover:opacity-100 transition-opacity",children:c.jsx("span",{className:"text-[9px] font-bold text-cyan-500 bg-black/50 px-1 py-0.5 rounded border border-cyan-500/50",children:" WebGPU"})}),E.length>1&&c.jsxs("div",{className:"absolute bottom-4 left-1/2 -translate-x-1/2 z-50 flex items-center gap-4 bg-white/90 dark:bg-slate-900/90 px-4 py-2 rounded-full shadow-lg border border-gray-200 dark:border-slate-700",children:[c.jsx("button",{onClick:vt,disabled:B===0,className:"p-1 hover:bg-gray-200 dark:hover:bg-slate-700 rounded-full disabled:opacity-30",children:c.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})})}),c.jsxs("span",{className:"font-mono text-xs font-bold text-gray-700 dark:text-gray-300",children:[B+1," / ",E.length]}),c.jsx("button",{onClick:kt,disabled:B===E.length-1,className:"p-1 hover:bg-gray-200 dark:hover:bg-slate-700 rounded-full disabled:opacity-30",children:c.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})})]}),c.jsxs("div",{className:"absolute bottom-4 left-4 z-40 flex flex-col-reverse gap-2 items-start pointer-events-none",children:[ve&&he&&c.jsxs("button",{onClick:()=>ge(!1),className:"pointer-events-auto bg-white dark:bg-slate-800 border-2 border-black dark:border-white shadow-[4px_4px_0px_rgba(0,0,0,0.5)] px-3 py-2 text-xs font-bold uppercase tracking-widest hover:translate-x-1 transition-transform flex items-center gap-2",children:[c.jsx("span",{className:"w-2 h-2 rounded-full bg-green-500 animate-pulse"}),"ROI Stats"]}),We.filter(Z=>Z.isMinimized).map(Z=>c.jsxs("button",{onClick:()=>Ie(Z.id),className:"pointer-events-auto bg-white dark:bg-slate-800 border-2 border-black dark:border-white shadow-[4px_4px_0px_rgba(0,0,0,0.5)] px-3 py-2 text-xs font-bold uppercase tracking-widest hover:translate-x-1 transition-transform flex items-center gap-2",children:[c.jsx("span",{className:`w-2 h-2 rounded-full animate-pulse ${Z.type==="histogram"?"bg-cyan-500":Z.type==="fft"?"bg-purple-500":Z.type==="quant"?"bg-teal-500":"bg-indigo-500"}`}),Z.type==="histogram"?"Histogram":Z.type==="fft"?"Power Spectrum":Z.type==="quant"?"Quantization":"Pearson"]},Z.id))]}),c.jsx(Xre,{isOpen:Sr,onClose:()=>Ve(!1)}),c.jsx(Kre,{isOpen:_t,onClose:()=>Jt(!1),data:fe,fileName:F?F.name:"",warning:Nt}),c.jsx(Yre,{isOpen:d,onClose:()=>p(!1),data:jn,blackLevel:Pe,imageHeight:ut,isBGGR:je,importedMetadata:or||void 0,theme:s,initialCameraModel:(fe==null?void 0:fe.Model)||"",initialISO:(fe==null?void 0:fe.ISO)||((wd=fe==null?void 0:fe.ISOSpeedRatings)==null?void 0:wd.toString())||""}),c.jsx(tne,{isOpen:m,onClose:()=>v(!1),theme:s}),c.jsx(rne,{isOpen:b,onClose:()=>k(!1),zIndex:200}),c.jsx(lne,{isOpen:L,onClose:_g,patchStats:Og,initialIsBGGR:je,sizeRatio:Xe,onSizeChange:jg}),c.jsx(pne,{isOpen:Ar,isSfrLabOpen:Ar,onClose:()=>{},rawImageData:W,roi:he?{x:he.x,y:he.y,w:he.width,h:he.height}:null,zIndex:200,onFocus:xt,displaySettings:ae}),c.jsx(mne,{isOpen:x,onClose:()=>y(!1),rawImageData:W,fileName:(F==null?void 0:F.name)||"image.dng",zIndex:300,onFocus:xt}),c.jsx(Mne,{isOpen:w,onClose:()=>_(!1),zIndex:350,onFocus:xt}),c.jsx($ne,{isOpen:S,onClose:()=>j(!1),zIndex:400,onFocus:xt}),c.jsx(os,{isOpen:Vr,onClose:()=>Tt(!1),onConfirm:jl,title:"High Resource Usage Warning",confirmText:"I know the risk and insist to continue",message:c.jsxs("div",{className:"flex flex-col gap-2",children:[c.jsx("p",{children:"Patter DNG mode involves high-frequency refreshing and heavy computation. Due to current memory management limitations, repeated use may lead to browser memory overflow or crashes. Please proceed with caution."}),c.jsx("p",{className:"text-xs text-gray-500"})]})}),c.jsx(os,{isOpen:A,onClose:()=>$(!1),onConfirm:()=>{window.open("https://y-g-jiang.github.io/jiangbridge.exe","_blank"),$(!1)},title:"JiangBridge Connection / ",confirmText:"Download Bridge App",cancelText:"Cancel",message:c.jsxs("div",{className:"flex flex-col gap-4 text-left",children:[c.jsx("p",{className:"font-bold text-gray-800 dark:text-gray-200",children:"JiangBridge"}),c.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:'JiangBridge is optional for this webpage, but recommended for full functionality. Simply double-click and run it once after system startup. If the indicator light does not turn green after double-clicking, please consider checking whether the web page is allowed to "View and connect to any device on the network".'})]})}),c.jsx(os,{isOpen:Pt,onClose:()=>Bt(!1),onConfirm:Ia,title:"Export 16-bit TIFF Options",confirmText:"Confirm Export",message:c.jsxs("div",{className:"flex flex-col gap-4 text-left",children:[c.jsxs("div",{className:"grid grid-cols-2 gap-4 bg-gray-50 dark:bg-slate-800/80 p-4 border border-gray-400 dark:border-600",children:[c.jsxs("div",{className:"flex flex-col items-center gap-3",children:[c.jsxs("div",{className:"flex flex-col items-center text-center",children:[c.jsx("span",{className:"font-bold text-xs text-gray-800 dark:text-slate-200",children:"Stretch ()"}),c.jsx("span",{className:"text-[9px] text-gray-500 dark:text-slate-400 mt-0.5",children:"Map [0, White] to [0, 65535]"})]}),c.jsx("div",{onClick:()=>tr(!Dt),className:`relative w-12 h-6 border-2 border-black dark:border-white cursor-pointer ${Dt?"bg-black dark:bg-white":"bg-gray-300 dark:bg-slate-600"}`,children:c.jsx("div",{className:`absolute top-0.5 left-0.5 w-4 h-4 bg-white dark:bg-black shadow-sm transition-transform ${Dt?"translate-x-6":""}`})})]}),c.jsxs("div",{className:"flex flex-col items-center gap-3",children:[c.jsxs("div",{className:"flex flex-col items-center text-center",children:[c.jsx("span",{className:"font-bold text-xs text-gray-800 dark:text-slate-200",children:"sRGB Gamma"}),c.jsx("span",{className:"text-[9px] text-gray-500 dark:text-slate-400 mt-0.5",children:"Apply non-linear contrast"})]}),c.jsx("div",{onClick:()=>Hr(!rr),className:`relative w-12 h-6 border-2 border-black dark:border-white cursor-pointer ${rr?"bg-black dark:bg-white":"bg-gray-300 dark:bg-slate-600"}`,children:c.jsx("div",{className:`absolute top-0.5 left-0.5 w-4 h-4 bg-white dark:bg-black shadow-sm transition-transform ${rr?"translate-x-6":""}`})})]})]}),c.jsxs("div",{className:"p-3 bg-gray-200 dark:bg-slate-800 text-[11px] text-black dark:text-white italic border border-gray-400 dark:border-gray-600 text-center font-mono",children:[Dt&&!rr&&"Mode: Stretched Linear. Histogram preserved but range expanded.",!Dt&&rr&&"Mode: Native DN + sRGB. Best for analyzing raw distribution contrast.",Dt&&rr&&"Mode: Ready-to-Use. Conventional 16-bit development.",!Dt&&!rr&&"Mode: Native Linear. Pure physical sensor DN values."]})]})}),!ve&&c.jsx(aae,{stats:he,onClose:()=>{le(null),Oe(null)},onMinimize:()=>ge(!0),isBGGR:je,onToggleBGGR:ke,onOpenWindow:Ir,displaySettings:ae,zIndex:tt,onFocus:xt,rawImageData:W}),We.map(Z=>{if(Z.isMinimized)return null;const ue=E.find(Re=>Re.id===Z.sessionId),ce=ue==null?void 0:ue.rawImageData;if(!ce)return null;const pe={key:Z.id,isOpen:!0,onClose:()=>_n(Z.id),onMinimize:()=>br(Z.id),rawImageData:ce,roi:Z.roi,isBGGR:Z.isBGGR,zIndex:Z.zIndex,onFocus:()=>Mt(Z.id),initialPosition:Z.initialPosition,initialInternalState:Z.internalState,onUpdateState:Re=>St(Z.id,Re),stackFiles:Z.stackFiles};return Z.type==="histogram"?c.jsx(Lre,{...pe}):Z.type==="fft"?c.jsx(Gre,{...pe,onUpdateROI:Re=>qr(Z.id,Re)}):Z.type==="quant"?c.jsx(zre,{...pe}):Z.type==="pearson"?c.jsx(Wre,{...pe}):null}),Qe&&c.jsx("div",{className:"absolute inset-0 z-50 flex items-center justify-center bg-white/90 dark:bg-black/90 p-8",children:c.jsxs("div",{className:"max-w-md text-center p-6 bg-white dark:bg-black rounded-none border-2 border-red-600 shadow-[8px_8px_0px_rgba(200,0,0,0.5)]",children:[c.jsx("h3",{className:"text-xl font-bold text-red-600 uppercase mb-2",children:"Notice"}),c.jsx("p",{className:"text-black dark:text-white mb-6 whitespace-pre-wrap font-mono",children:Qe}),c.jsx("button",{onClick:()=>Je(null),className:"px-4 py-2 bg-gray-200 hover:bg-gray-300 dark:bg-gray-800 dark:hover:bg-gray-700 border-2 border-black dark:border-white text-black dark:text-white transition-colors uppercase font-bold",children:"Dismiss"})]})}),!_l&&!bd&&!Qe&&c.jsx("div",{className:"absolute inset-0 flex flex-col items-center justify-center text-gray-400 dark:text-gray-600 select-none font-mono",children:c.jsx("p",{className:"text-lg",children:"Load an image or generate a pattern"})}),c.jsx(g6,{image:_l,zoom:Dr,pan:zt,onPanChange:Nr,onZoomChange:gd,onSelectionChange:md,forcedSelection:Me,theme:s,touchAction:mi,isMarking:yr>0||nr&&Ht>0||qt>0,onPointClick:Z=>{yr>0?xg(Z):nr&&Ht>0?Sg(Z):qt>0&&Tg(Z)},markers:Zt,gridRects:Qn,colorLabPoints:pt,colorLabRects:Ne,sfrRects:Cr}),qt>0&&fr.map((Z,ue)=>c.jsxs("div",{className:"absolute pointer-events-none z-30",style:{left:Z.x*Dr+zt.x,top:Z.y*Dr+zt.y,transform:"translate(-50%, -50%)"},children:[c.jsx("div",{className:"w-3 h-3 border-2 border-cyan-400 rounded-full flex items-center justify-center bg-transparent",children:c.jsx("div",{className:"w-1 h-1 bg-cyan-400 rounded-full"})}),c.jsx("div",{className:"text-[10px] font-bold text-cyan-400 absolute top-3 left-1/2 -translate-x-1/2 bg-black/50 px-1 rounded",children:ue+1})]},ue)),c.jsx("div",{className:"absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 w-1/2 z-30 pointer-events-none select-none opacity-20 mix-blend-normal dark:mix-blend-plus-lighter",children:c.jsx("svg",{viewBox:"0 0 500 60",className:"w-full h-auto drop-shadow-none",children:c.jsx("text",{x:"50%",y:"50%",dominantBaseline:"middle",textAnchor:"middle",className:"fill-black dark:fill-white",fontSize:"26",fontWeight:"bold",style:{fontFamily:"Courier New, monospace",letterSpacing:"0.05em"},children:" y-g-jiang.github.io"})})}),W&&!yr&&!nr&&!wn&&!qt&&c.jsxs("div",{className:"absolute bottom-4 left-4 z-30 pointer-events-none opacity-60 text-[10px] text-black dark:text-white font-mono bg-white/50 dark:bg-black/50 px-1",children:["Hold ",c.jsx("b",{children:"Shift"})," + Drag to calculate Raw ROI stats"]}),wn&&c.jsx("div",{className:"absolute bottom-4 left-1/2 -translate-x-1/2 z-30 pointer-events-none text-sm font-bold text-red-500 bg-black/80 px-4 py-2 rounded-full border border-red-500 animate-pulse shadow-lg",children:"Manual Batch Marking Active (Shift+Drag to add)"}),qt>0&&c.jsxs("div",{className:"absolute bottom-4 left-1/2 -translate-x-1/2 z-30 pointer-events-none text-sm font-bold text-emerald-500 bg-black/80 px-4 py-2 rounded-full border border-emerald-500 animate-pulse shadow-lg",children:["Calibration: Click Corner ",qt,"/4"]}),nr&&Ht>0&&c.jsxs("div",{className:"absolute top-4 left-1/2 -translate-x-1/2 z-30 pointer-events-none text-sm font-bold text-yellow-500 bg-black/80 px-4 py-2 rounded-full border border-yellow-500 animate-pulse shadow-lg",children:[pt.length===0&&"Click Top-Left Corner of Chart",pt.length===1&&"Click Top-Right Corner",pt.length===2&&"Click Bottom-Left Corner",pt.length===3&&"Click Bottom-Right Corner",pt.length===4&&"Processing..."]}),c.jsx(xA,{zoom:Dr,onZoomChange:gd,onResetView:()=>{ma(1),Nr({x:0,y:0})},touchAction:mi,onToggleTouchAction:mg})]}),wt&&c.jsx("div",{className:"w-80 flex-shrink-0 bg-white dark:bg-black border-4 border-gray-500 dark:border-gray-700 shadow-[inset_2px_2px_8px_rgba(0,0,0,0.2)] overflow-hidden transition-all duration-300",children:c.jsx(fA,{rawImageData:W,displaySettings:ae,onApplyDisplaySettings:dg,onSetSelection:gg,exifData:fe,isBridgeConnected:M.isConnected,isDrLabOpen:Ct,drMarkingStep:yr,onStartMarking:Mg,onGenerateTestPic:lu,drRoiSize:Kr,onDrRoiSizeChange:qa,drGridRows:te,onDrGridRowsChange:me,drGridCols:be,onDrGridColsChange:Y,onBatchDrLab:wg,hasDrMarkers:Qn.length>0,isFftLabOpen:Ge,onProcessPair:Qa,onProcessBatchDiff:Yr,onProcessStackFft:pd,onOpenCrossCalc:()=>k(!0),isThreePlane:oe,onToggleXTrans:pg,xtransPhase:ye,onXTransPhaseChange:ou,isXTransConverted:D==null?void 0:D.isXTransConverted,roiStats:he,isBGGR:je,isColorLabOpen:nr,colorLabMarkingStep:Ht,onStartColorLabMarking:kg,isSfrLabOpen:Ar,onOpenDngExport:()=>y(!0),sfrRectCount:Cr.length,isBatchMarkingMode:wn,onToggleBatchMarking:()=>kn(!wn),onClearBatchMarks:()=>Er([]),onBatchCompute:yd,stdChartStep:qt,onStartStandardCalibration:Ag,onSaveBatchTemplate:yg,onImportBatchTemplate:vg,onBatchTransform:su,onOpenStackingTool:()=>_(!0),isPsModeOpen:Xr})}),c.jsx(bA,{theme:s,setTheme:l})]})]})},IN=document.getElementById("root");if(!IN)throw new Error("Could not find root element to mount to");const oae=Jm.createRoot(IN);oae.render(c.jsx(J.StrictMode,{children:c.jsx(iae,{})}));
